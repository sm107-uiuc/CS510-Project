{"url": "https://towardsdatascience.com/a-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4", "time": 1682997208.449635, "path": "towardsdatascience.com/a-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4/", "webpage": {"metadata": {"title": "A 5-Step Guide on incorporating Differential Privacy into your Deep Learning models | by Ronit Mankad | Towards Data Science", "h1": "A 5-Step Guide on incorporating Differential Privacy into your Deep Learning models", "description": "By now we all know the benefits of Differential Privacy, how it can protect individual privacy while still providing accurate query results over a large dataset. This post will illustrate how to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Laplace_distribution", "anchor_text": "Laplacian Noise", "paragraph_index": 7}, {"url": "https://dl.acm.org/citation.cfm?id=2978318", "anchor_text": "Deep learning with differential privacy", "paragraph_index": 22}, {"url": "https://unsplash.com/@euwars?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Farzad Nazifi", "paragraph_index": 23}, {"url": "https://unsplash.com/search/photos/technology?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1802.08908", "anchor_text": "Scalable Private Learning with PATE", "paragraph_index": 24}], "all_paragraphs": ["By now we all know the benefits of Differential Privacy, how it can protect individual privacy while still providing accurate query results over a large dataset. This post will illustrate how to apply Differential Privacy to the MNIST Digit classification problem and analyze it using a technique called Private Aggregation of Teacher Ensembles (PATE).", "First, we will divide the private data into N number of sets (in this case, 100) and train a classifier on each of the N datasets. These are called Teacher classifiers. We will then use the teacher classifiers to predict the labels for our public data. For each image in the public dataset, the most predicted label by the N classifiers will be considered as the true label for that image.", "Now, using the predictions of the Teacher classifiers as true labels for our public data, we will train a Student classifier which can then be used to classify new unseen images.", "The MNIST Train data will be considered as private data on which we will train our Teacher models. The Student model obtained by combining the predictions of the teacher models will then be trained on the MNIST Test data (90% of test data will be used to train the model and the remaining 10% will be used to test its accuracy)", "Deep Learning models have a tendency to overfit the training data. Instead of learning general features, neural networks can learn features of an individual which then can be exploited by an adversary to obtain the individual\u2019s private information.", "By not training the Student model directly on the private data, we prevent it from directly learning key individual features of a single person from the dataset. Instead, the generalized features and trends learned by the Teacher models are used to train the Student.", "However, there is one small caveat. If the label of an image can be changed by removing the prediction of a single teacher, an adversary can narrow down the search to that model.", "To avoid this we add random Laplacian Noise to the predictions of the teacher models before selecting the most predicted label as the true label for the public data. In this way, we add a bit of randomness and skew the final result so that the true label doesn\u2019t easily change by dropping just one teacher.", "Import the MNIST data from torchvision and define a function to generate the dataloaders.", "Now, generate the student train and test data by splitting the MNIST test set as discussed above.", "Define a simple CNN to classify the MNIST digits.", "Now define the train and predict functions", "Now, we need to choose the epsilon value for which we first define the formal definition of Differential Privacy", "This definition does not create differential privacy, instead, it is a measure of how much privacy is afforded by a query M. Specifically, it\u2019s a comparison between running the query M on a database (x) and a parallel database (y). As you remember, parallel databases are defined to be the same as a full database (x) with one entry/person removed.", "Thus, this definition says that FOR ALL parallel databases, the maximum distance between a query on database (x) and the same query on database (y) will be e^epsilon, but that occasionally this constraint won\u2019t hold with probability delta. Thus, this theorem is called \u201cepsilon-delta\u201d differential privacy.", "The amount of noise necessary to add to the output of a query is a function of four things:", "Thus, for each type of noise we\u2019re adding, we have a different way of calculating how much to add as a function of sensitivity, epsilon, and delta. We\u2019re going to focus on Laplacian noise.", "Laplacian noise is increased/decreased according to a \u201cscale\u201d parameter b. We choose \u201cb\u201d based on the following formula.", "In other words, if we set b to be this value, then we know that we will have a privacy leakage of <= epsilon. Furthermore, the nice thing about Laplace is that it guarantees this with delta == 0. There are some tunings where we can have very low epsilon where delta is non-zero, but we\u2019ll ignore them for now.", "Here\u2019s a snippet of the training loss and accuracy achieved.", "The pate.perform_analysis method returns two values - a data-independent epsilon and a data-dependent epsilon. The data-dependent epsilon is the epsilon value obtained by looking at how much the teachers agree with each other. In a way, the PATE analysis rewards the user for building teacher models which agree with each other because it becomes harder to leak information and track individual information.", "Using the Student-Teacher architecture guided by the PATE analysis method is a great way to introduce Differential Privacy to your deep learning models. However, Differential Privacy is still in its early stage and as more research in the space occurs more sophisticated methods will be developed to reduce the privacy-accuracy tradeoff and the downside that differential privacy only really performs well on large datasets.", "[2] Abadi, Martin, et al, Deep learning with differential privacy (2016), Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security. ACM, 2016.", "[3] Figure 1, Photo by Farzad Nazifi on Unsplash", "[4] Figure 2, Nicolas Papernot, et al, Scalable Private Learning with PATE(2018), Published as a conference paper at ICLR 2018", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Student. Bachelor of Engineering from GEC, Gandhinagar (2015\u201319). Currently learning AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7861c6c822c4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mankadronit.rm?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mankadronit.rm?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": "Ronit Mankad"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe453ce09830&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&user=Ronit+Mankad&userId=e453ce09830&source=post_page-e453ce09830----7861c6c822c4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7861c6c822c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7861c6c822c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@euwars?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Farzad Nazifi"}, {"url": "https://unsplash.com/search/photos/technology?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Laplace_distribution", "anchor_text": "Laplacian Noise"}, {"url": "http://www.nowpublishers.com/article/Details/TCS-042", "anchor_text": "The algorithmic foundations of differential privacy"}, {"url": "https://dl.acm.org/citation.cfm?id=2978318", "anchor_text": "Deep learning with differential privacy"}, {"url": "https://unsplash.com/@euwars?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Farzad Nazifi"}, {"url": "https://unsplash.com/search/photos/technology?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1802.08908", "anchor_text": "Scalable Private Learning with PATE"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7861c6c822c4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7861c6c822c4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----7861c6c822c4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/privacy?source=post_page-----7861c6c822c4---------------privacy-----------------", "anchor_text": "Privacy"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----7861c6c822c4---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7861c6c822c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&user=Ronit+Mankad&userId=e453ce09830&source=-----7861c6c822c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7861c6c822c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&user=Ronit+Mankad&userId=e453ce09830&source=-----7861c6c822c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7861c6c822c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7861c6c822c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7861c6c822c4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7861c6c822c4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7861c6c822c4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7861c6c822c4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7861c6c822c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mankadronit.rm?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mankadronit.rm?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ronit Mankad"}, {"url": "https://medium.com/@mankadronit.rm/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe453ce09830&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&user=Ronit+Mankad&userId=e453ce09830&source=post_page-e453ce09830--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe453ce09830%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-5-step-guide-on-incorporating-differential-privacy-into-your-deep-learning-models-7861c6c822c4&user=Ronit+Mankad&userId=e453ce09830&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}