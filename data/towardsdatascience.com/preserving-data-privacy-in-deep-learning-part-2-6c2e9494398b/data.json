{"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "time": 1683010906.595737, "path": "towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b/", "webpage": {"metadata": {"title": "Preserving Data Privacy in Deep Learning | Part 2 | by Harsh Yadav | Towards Data Science", "h1": "Preserving Data Privacy in Deep Learning | Part 2", "description": "Distribution of a balanced dataset into a non-IID/real-world dataset, further divided into clients for federated learning. Implementation on PyTorch"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/akshay-kulkarni-1a562679/", "anchor_text": "Mr. Akshay Kulkarni", "paragraph_index": 0}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0031320320301862?via%3Dihub", "anchor_text": "NICO", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1", "paragraph_index": 5}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0031320320301862?via%3Dihub", "anchor_text": "Elsevier", "paragraph_index": 23}], "all_paragraphs": ["Many thanks to renowned data scientist Mr. Akshay Kulkarni for his inspiration and guidance on this tutorial.", "The above image resembles the Non-IID (Independent and Identically Distributed) dataset. A collection of random variables (images in our case) is independent and identically distributed if each random variable (image) has a similar probability distribution as the others, and all are mutually independent. In part 1 of this series, we used the CIFAR10 dataset, an example of an IID type, but for the real-world use case, there needs to be a non-IID dataset to represent the real-world scenario. So, What is non-IID data? What changes to make in the current dataset (CIFAR10) to accumulate non-IID data for Federated Learning?", "These are some of the questions which will be answered in this tutorial. This blog is part 2 of the series Preserving Data Privacy in Deep Learning and focuses on the distribution of the CIFAR10 into a non-IID dataset further divided among the clients. After completing this tutorial, you will know:", "Real-life data (referring to objects, values, attributes, and other aspects) is essentially non-independent and identically distributed (non-IID). In contrast, most of the existing analytical or machine learning methods are based on IID data. So, there needs to be a proper approach to handle such type of real-world dataset. This tutorial will lead to a non-IID dataset\u2019s foundations and thus open the stage for implementing various federated learning techniques to handle the problem of getting insights from non-IID data. Non-IIDness is a common problem, causing unstable performances of deep learning models. In literature, the non-IID image classification problem is largely understudied.", "NICO (Non-IID Image dataset with contexts) is one such benchmark dataset that can be further used to develop state-of-the-art machine learning models to tackle non-IID data.", "In this series, CIFAR 10 is used as the benchmark dataset, and further, it is converted into a non-IID dataset. To learn more about the basics of federated learning, please head over to part 1 of this series. In this tutorial, we will create two different types of the dataset, one is replicating the real-life data, i.e. real-world dataset, and another one is the extreme example of a non-iid dataset.", "REAL-WORLD DATASET: CIFAR 10 is randomly divided into the given number of clients. So, a client can have images from any number of classes, say, one client has images from only 1 class and another client has images from 5 classes. This type of dataset replicates the real-world scenario where clients can have different types of images.", "NON-IID DATASET: The real-world dataset also comes into this category. However, for this case, a different type of distribution is done where the CIFAR10 dataset is divided based on the classes per client parameter. E.g., if classes per client=2, all the clients will have images from any two classes randomly selected from all the classes.", "From the above image, one can get to know that all the clients have images from any two classes, but some outliers exist where a few clients have images from more than two classes, while some have very less number of images (client_20) when compared with the rest. Such outliers ensure that all the clients have a unique set of images. Thus an extreme example of a non-IID dataset. We can also divide the CIFAR10 dataset with classes per client = 1, where all the clients will have images from one class only with some outliers.", "Let\u2019s dive deep into the coding part to understand it in more detail.", "The get_cifar10 function downloads the CIFAR10 dataset and returns x_train, y_train for training, and x_test, y_test for test purposes. Lines 5\u20136 downloads the dataset from torchvision, and lines 8\u20139 converts it into NumPy array.", "The clients_rand function creates a random distribution for the clients, such that every client has an arbitrary number of images. It is one of the helper functions to be used in the upcoming code snippets.", "The split_image_data_realwd function splits the given images into n_clients. It returns a split which is further used to create the real-world dataset. This entire snippet has comments to explain what is happening in the sequential order. To understand more about this distribution, please head over to Part 2 of this series.", "Now, we will create a similar split for the non-IID dataset, as explained above (with a diagram). To understand more about this distribution, please head over to Part 2 of this series.", "The shuffle_list function takes the input of the above function(s) (split_image_data_realwd or split_image_data) and shuffles the images of each client respectively.", "The below code snippet converts the split into a data loader(image augmentation is done is this part) for giving this as an input to the model for training.", "The get_data_loader function uses the above helper functions and converts the CIFAR10 dataset into real-world or non-IID type, whichever is required.", "Now, we are ready with all the functions to create a real-world or non-IID dataset, which can be further used by federated learning to develop state of the art models.", "Now that we have successfully created these datasets let us explore some of the potential use cases of object classification, which can be further used by federated learning and ensure personal data safety.", "In this tutorial, you discovered how to prepare a non-IID/real-world dataset for image classification using PyTorch.", "Below is the flow diagram for a quick revision of the entire process of converting the CIFAR10 dataset into clients, which can be further used in federated learning.", "The non-IID data is very difficult to train on, and the same goes for federated learning. The real-world/non-IID dataset is divided into clients (num_clients) which can be further used by federated learning and preserve the data-privacy.", "In the next part of this series, we will be using this dataset with federated learning. Stay tuned for the upcoming part, which will explore the new aggregation and communication techniques used in federated learning on the non-IID dataset. In the upcoming tutorials, you will get to learn about different aggregation techniques for federated learning, homomorphic encryption of the model weights, differential privacy and it\u2019s hybrid with federated learning.", "[2] Yue He, Towards Non-I.I.D. image classification: A dataset and baselines, Elsevier", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Deep Learning enthusiast, with prior experience at Publicis Sapient, National University of Singapore, and SUSTech China."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6c2e9494398b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mailharsh17?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": "Harsh Yadav"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11670cac41ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&user=Harsh+Yadav&userId=11670cac41ec&source=post_page-11670cac41ec----6c2e9494398b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c2e9494398b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c2e9494398b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22"}, {"url": "https://www.instagram.com/yourviewfrommylens/", "anchor_text": "Harsh Yadav"}, {"url": "https://www.linkedin.com/in/akshay-kulkarni-1a562679/", "anchor_text": "Mr. Akshay Kulkarni"}, {"url": "https://www.instagram.com/yourviewfrommylens/", "anchor_text": "Harsh Yadav"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0031320320301862?via%3Dihub", "anchor_text": "NICO"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1"}, {"url": "https://www.linkedin.com/in/harsh-yadav-1bba69127/", "anchor_text": "Harsh Yadav"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22"}, {"url": "https://arxiv.org/abs/1903.02891", "anchor_text": "arXiv:1903.02891"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0031320320301862?via%3Dihub", "anchor_text": "Elsevier"}, {"url": "https://medium.com/tag/federated-learning?source=post_page-----6c2e9494398b---------------federated_learning-----------------", "anchor_text": "Federated Learning"}, {"url": "https://medium.com/tag/privacy?source=post_page-----6c2e9494398b---------------privacy-----------------", "anchor_text": "Privacy"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6c2e9494398b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----6c2e9494398b---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/non-iid?source=post_page-----6c2e9494398b---------------non_iid-----------------", "anchor_text": "Non Iid"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6c2e9494398b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&user=Harsh+Yadav&userId=11670cac41ec&source=-----6c2e9494398b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6c2e9494398b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&user=Harsh+Yadav&userId=11670cac41ec&source=-----6c2e9494398b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c2e9494398b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6c2e9494398b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6c2e9494398b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6c2e9494398b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6c2e9494398b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6c2e9494398b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6c2e9494398b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Harsh Yadav"}, {"url": "https://medium.com/@mailharsh17/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11670cac41ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&user=Harsh+Yadav&userId=11670cac41ec&source=post_page-11670cac41ec--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5ba5c7d18464&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-2-6c2e9494398b&newsletterV3=11670cac41ec&newsletterV3Id=5ba5c7d18464&user=Harsh+Yadav&userId=11670cac41ec&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}