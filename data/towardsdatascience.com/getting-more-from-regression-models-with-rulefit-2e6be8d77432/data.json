{"url": "https://towardsdatascience.com/getting-more-from-regression-models-with-rulefit-2e6be8d77432", "time": 1683017118.2885, "path": "towardsdatascience.com/getting-more-from-regression-models-with-rulefit-2e6be8d77432/", "webpage": {"metadata": {"title": "Getting More From Regression Models with RuleFit | by Casey Whorton | Towards Data Science", "h1": "Getting More From Regression Models with RuleFit", "description": "The interpretable side of machine learning has always been interesting to me. I think it is important to be able to plainly state (to some degree) what the model is doing. Some of the most\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/christophM/rulefit", "anchor_text": "Use the link in the references section", "paragraph_index": 3}, {"url": "https://www.kaggle.com/caseyw/interpretable-regression-with-rulefit/edit", "anchor_text": "Or fork the notebook on kaggle.", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/datasets/index.html#california-housing-dataset", "anchor_text": "Both datasets can be found in scikit-learn.", "paragraph_index": 9}, {"url": "https://www.linkedin.com/in/caseywhorton/", "anchor_text": "add me on LinkedIn", "paragraph_index": 22}], "all_paragraphs": ["The interpretable side of machine learning has always been interesting to me. I think it is important to be able to plainly state (to some degree) what the model is doing. Some of the most explainable machine learning models are also the weakest in terms of accuracy, so we are forced to make decisions in order to strike a balance.", "This article focuses on the RuleFit algorithm, written in Python, to predict a continuous target variable. This topic has been touched on by other authors, and while you can find methods to explain predictions made from more black-box algorithms, they are usually classification problems. I feel the regression side is a topic that deserves much more attention.", "Here, you will see how this algorithm can transform the n-dimensional space of input features into smaller subsets of the space that have an explainable effect on the target variable. The subsets and their effect are called rules. These discovered rules can look like what you find during exploratory data analysis, so the rules themselves are business insights in some cases. You will also see how easy it is to use this algorithm in Python.", "(If you want to use the Python package for the RuleFit algorithm in your own project, install it using git. Use the link in the references section. Or fork the notebook on kaggle.)", "A function with one feature (X) whose mapping to the target, or dependent, variable (y) like the one shown here will not be explained by an OLS linear model. The RuleFit algorithm searches X for subsets and returns rules for what the target will be. In this case, I set the algorithm to find a maximum of 250 rules. You can see that for some subsets the algorithm returns a flat value, and in others a sloped line. We\u2019ll see more of that shortly.", "If you work as a Data Scientist in a business setting, you know that sometimes you come across easily explainable linear relationships. Sometimes. What happens more often is that there is some caveat that your partners are aware of that slightly change the relationship. One type of caveat I find is an expectation for a dramatic increase or \u2018step\u2019 in a dependent variable due to a change in an independent variable. Think about price and demand: once the price decreases past a certain threshold, you expect the demand to jump up to another bracket, not a gradual increase anymore.", "Here is an example of a function that is explained well with an OLS linear model. But, what the linear model will miss is the fact that there is a step at about where X = 50. The RuleFit model has 4 rules to explain what is happening to y over X. Below is a graphical representation and the table of discovered rules.", "Above are the fitted rules from the model. Overall, we expect a linear model, and the first rule suggests that there is a linear relationship over the entire domain of X (support = 1.00) with a high importance. The coefficient overall is 0.42, but this rule would not explain everything. The remaining rules show that for values above 49.5 there is a step increase of 14.3, and for values less than 15 there is a step decrease of 5.26. This is in addition to the linear rule for all X.", "This is a fitted model with 4 rules shown, the algorithm can be parameterized for better accuracy.", "In the original paper for the algorithm (see link in references) you can see how this algorithm works on the Boston Housing dataset, a classic \u2018toy\u2019 dataset. This is a similar dataset from the US state of California, so we will see how the algorithm works on the other side of the country. Both datasets can be found in scikit-learn.", "The target for the dataset is the median value of homes in a census block, with several features about the homes such as the number of rooms, latitude, longitude, and average house occupancy. This is a regression type problem, so we will see here how we can tackle it using the RuleFit package in Python.", "The results show that the RuleFit with 500 rules has a similar accuracy to other common out-of-the-box machine learning algorithms on this dataset. (We\u2019ll see later that this max_rules parameter should probably be decreased.)", "Possibly what is most insightful about the algorithm is that we can examine how discovered rules apply over subsets of the data. We can filter our samples of data in any way we want and see how the algorithm ranks the importance of our rules. Similar to the original paper, and important to the problem, let\u2019s take a look at some rules that apply to the top and bottom 10% of valued homes in California.", "For California homes in the top 10%, it looks like location and income are dominant, linear rules.", "Here is an interesting rule that incorporates more than just location:", "An increase of 0.47 applies to this very small subset of the top 10% of homes in California. A rule as specific as this would take a while longer to discover using traditional EDA, visualization, and dashboarding. (This took a few seconds to fit and return.)", "For the bottom 10%, location seems to be everything. A few more rules regarding median income show up in the bottom of the rule set. There are definitely some differences in regards to what rules apply to these sets of home values in California.", "Another interesting rule that shows up in the bottom 10% of valued homes have more to do with income and a high number of rooms. It would be interesting to hear a California realtor\u2019s perspective on why they think this was the case when this data was recorded.", "We all like to see what features are important in our model. Part of the attractiveness of algorithms like the Random Forest regression algorithm is the ability to quickly show people what features come up often as important in the model. It\u2019s not as direct as showing a causal relationship, but it does go a long way to add interpretation to something that is otherwise a black-box.", "Above are the important features of the RuleFit algorithm over the entire dataset. Like the discovered rules, this can be applied to subsets of the data to see what features have the most impact on whatever subset of the data you want to see.", "Having models that are easily interpreted usually means a comparative decrease in accuracy to other algorithms. We saw that the RuleFit algorithm can return accuracy similar to other algorithms, but machine learning best practices still need to be followed. The number of rules allowed in the model can serve as a metric for the complexity of the model, which is controlled by the max_rules parameter. Increasing the maximum number of rules and comparing train and test accuracy (r2) show a common case of overfitting.", "The RuleFit algorithm has potential to be applied in many business problems. The discovered rules from the algorithm can be treated as insights similar to those returned from exploratory data analysis, and we saw how to interpret them in the model. Seeing how important rules are to different subsets of the data is, by itself, a valuable tool in understanding your data. Machine learning best practices still need to be followed, and while the RuleFit algorithm shows good accuracy on the samples included in the article, it wasn\u2019t the best and there is still risk of overfitting if you aren\u2019t careful.", "Thank you for reading! Please see the links in the references section to learn more about the algorithm, the Python package, and the Jupyter notebook I used to create this article. Feel free to clap, comment, or add me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | British Bake-Off Connoisseur| Recovering Insomniac | Heavy Metal Music Advocate"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2e6be8d77432&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://casey-whorton.medium.com/?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": ""}, {"url": "https://casey-whorton.medium.com/?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": "Casey Whorton"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd0549046d684&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&user=Casey+Whorton&userId=d0549046d684&source=post_page-d0549046d684----2e6be8d77432---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2e6be8d77432&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2e6be8d77432&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@maxon?utm_source=medium&utm_medium=referral", "anchor_text": "Max Ostrozhinskiy"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/christophM/rulefit", "anchor_text": "Use the link in the references section"}, {"url": "https://www.kaggle.com/caseyw/interpretable-regression-with-rulefit/edit", "anchor_text": "Or fork the notebook on kaggle."}, {"url": "https://github.com/caseywhorton/interpretable-regression-example", "anchor_text": "https://github.com/caseywhorton/interpretable-regression-example"}, {"url": "https://github.com/caseywhorton/interpretable-regression-example", "anchor_text": "https://github.com/caseywhorton/interpretable-regression-example"}, {"url": "https://scikit-learn.org/stable/datasets/index.html#california-housing-dataset", "anchor_text": "Both datasets can be found in scikit-learn."}, {"url": "https://github.com/caseywhorton/interpretable-regression-example", "anchor_text": "https://github.com/caseywhorton/interpretable-regression-example"}, {"url": "https://github.com/caseywhorton/interpretable-regression-example", "anchor_text": "https://github.com/caseywhorton/interpretable-regression-example"}, {"url": "https://github.com/caseywhorton/interpretable-regression-example", "anchor_text": "https://github.com/caseywhorton/interpretable-regression-example"}, {"url": "https://github.com/caseywhorton/interpretable-regression-example", "anchor_text": "https://github.com/caseywhorton/interpretable-regression-example"}, {"url": "https://www.linkedin.com/in/caseywhorton/", "anchor_text": "add me on LinkedIn"}, {"url": "https://github.com/christophM/rulefit", "anchor_text": "christophM/rulefitImplementation of a rule based prediction algorithm based on the rulefit algorithm from Friedman and Popescu (PDF) The\u2026github.com"}, {"url": "https://github.com/caseywhorton/interpretable-regression-example", "anchor_text": "caseywhorton/interpretable-regression-exampleContribute to caseywhorton/interpretable-regression-example development by creating an account on GitHub.github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2e6be8d77432---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2e6be8d77432---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/interpretation?source=post_page-----2e6be8d77432---------------interpretation-----------------", "anchor_text": "Interpretation"}, {"url": "https://medium.com/tag/rules?source=post_page-----2e6be8d77432---------------rules-----------------", "anchor_text": "Rules"}, {"url": "https://medium.com/tag/business?source=post_page-----2e6be8d77432---------------business-----------------", "anchor_text": "Business"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2e6be8d77432&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&user=Casey+Whorton&userId=d0549046d684&source=-----2e6be8d77432---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2e6be8d77432&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&user=Casey+Whorton&userId=d0549046d684&source=-----2e6be8d77432---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2e6be8d77432&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2e6be8d77432&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2e6be8d77432---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2e6be8d77432--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2e6be8d77432--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2e6be8d77432--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2e6be8d77432--------------------------------", "anchor_text": ""}, {"url": "https://casey-whorton.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://casey-whorton.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Casey Whorton"}, {"url": "https://casey-whorton.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "103 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd0549046d684&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&user=Casey+Whorton&userId=d0549046d684&source=post_page-d0549046d684--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F49a7b8e78c3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-more-from-regression-models-with-rulefit-2e6be8d77432&newsletterV3=d0549046d684&newsletterV3Id=49a7b8e78c3f&user=Casey+Whorton&userId=d0549046d684&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}