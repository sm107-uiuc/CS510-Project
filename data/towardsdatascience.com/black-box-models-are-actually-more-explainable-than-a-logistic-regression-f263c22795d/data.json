{"url": "https://towardsdatascience.com/black-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d", "time": 1683000536.41823, "path": "towardsdatascience.com/black-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d/", "webpage": {"metadata": {"title": "Black-Box models are actually more explainable than a Logistic Regression | by Samuele Mazzanti | Towards Data Science", "h1": "Black-Box models are actually more explainable than a Logistic Regression", "description": "Who works as a data scientist knows it better: one of the main clich\u00e9s around Machine Learning is that you have to choose between: In the following, we will show that not only is there no need to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/titanic", "anchor_text": "Titanic dataset", "paragraph_index": 2}, {"url": "https://catboost.ai", "anchor_text": "Catboost", "paragraph_index": 11}, {"url": "https://www.reuters.com/article/us-amazon-com-jobs-automation-insight/amazon-scraps-secret-ai-recruiting-tool-that-showed-bias-against-women-idUSKCN1MK08G", "anchor_text": "sexist AI recruitment tool", "paragraph_index": 14}, {"url": "https://www.bbc.com/news/technology-35902104", "anchor_text": "racist chatbot", "paragraph_index": 14}, {"url": "https://arxiv.org/abs/1705.07874", "anchor_text": "SHAP (SHapley Additive exPlanations)", "paragraph_index": 15}, {"url": "https://github.com/slundberg/shap", "anchor_text": "the Python library dedicated to SHAP", "paragraph_index": 19}], "all_paragraphs": ["Who works as a data scientist knows it better: one of the main clich\u00e9s around Machine Learning is that you have to choose between:", "In the following, we will show that not only is there no need to choose between power and explainability, but that more powerful models are even more explainable than the shallower ones.", "By way of illustration, we will be using one of the most well-known datasets: the iconic Titanic dataset. We have a bunch of variables about Titanic passengers, and we want to predict how likely each passenger is to survive.", "The variables at our disposal are:", "(Note: for the sake of simplicity, some other variables have been dropped and almost no data preprocessing has been carried out).", "For what concerns classification problems, Logistic Regression is often taken as the baseline.", "After having one-hot encoded the qualitative features (Ticket class, Passenger sex and Port of embarkation), we fit a plain Logistic Regression on the training data. The accuracy, computed on the validation set, amounts to 81.56%.", "What insights can we get from this model? Since Logistic Regression is built as", "the analysis revolves around the \u03b2\u2019s. It is easy to see that for an increment of 1 unit in x\u2c7c the odds will increase by a factor of exp(\u03b2\u2c7c).", "The interpretation is straightforward: an increase of one year in Age will end up in a \u00d70.961 increase in odds.", "The limitations of this model in terms of explainability are self-evident:", "Let\u2019s now try a \u201cblack-box\u201d model. In this example, we will be using Catboost, an algorithm for gradient boosting on decision trees.", "Performing a quick Catboost (without any hyper-parameter tuning) on the same training data (no need for one-hot encoding this time) results in an 87.15% accuracy on validation data.", "Now, the $64,000 question in Machine Learning is: if Catboost is so better than LogReg in predicting survival on unseen data, shouldn\u2019t we just trust it and not worrying too much about the gears?", "Well, it depends. If it is a Kaggle competition, the answer may be \u201cyes\u201d, but in general it is \u201cdefinitely not!\u201d. If you are wondering why, just check out some high profile incidents such as Amazon \u201csexist AI recruitment tool\u201d or Microsoft \u201cracist chatbot\u201d.", "So, in order to figure out what decisions Catboost is making, another tool, called SHAP (SHapley Additive exPlanations), comes to our aid. SHAP (probably the state of the art in Machine Learning explainability) was born in 2017 and it is a brilliant way to reverse-engineer the output of any predictive algorithm.", "Applying SHAP analysis to our data and the Catboost output produces a matrix, which has the same dimension of the original data matrix, containing the SHAP values. The SHAP values look like this:", "The higher the SHAP value the higher the probability of survival and vice versa. Moreover, a SHAP value greater than zero leads to an increase in probability, a value less than zero leads to a decrease in probability.", "Each SHAP value expresses, this is the important part here, the marginal effect that the observed level of a variable for an individual has on the final predicted probability for that individual.", "You can use the Python library dedicated to SHAP to obtain fancy plots (basically containing descriptive statistics about SHAP values). For instance, you can easily obtain a plot summarizing the SHAP values for each observation, broken down by feature. In our example:", "Can you see the elephant in the room?", "If you were to show this plot to the layman (or even your boss), he would probably say: \u201cPretty colors. But what is the ruler down there? Are those dollars? Kilograms? Years?\u201d", "In a nutshell, SHAP values are not understandable for humans (not even for data scientists).", "The concept of probability is far easier to grasp. Actually, it is even more than that: it is innate (after all, this is why people keep taking planes).", "Wishing to pass from SHAP to probabilities, the most obvious thing to do is to plot the Predicted Probability of survival (for each individual) with respect to the SHAP sum (for each individual).", "It is immediately apparent that this is a deterministic function. That is, we can switch from one quantity to another without error. After all, the only difference between the two is that probability is bound to be in [0,1], while SHAP can assume any real number. Therefore:", "where f(.) is a monotonically increasing s-shaped function that maps any real number to the [0,1] interval (for simplicity f() could be a plain interpolation function bounded in [0,1]).", "Let use take an individual. Suppose that, knowing all the variables except Age, its SHAP sum equals to 0. Now imagine that the SHAP value relative to Age is 2.", "No doubt that probability of survival is more digestible than SHAP of survival. What is more understandable: to say that this individual age leads to a rise of 2 in SHAP or to a rise of 44% in probability?", "Based on what we have just seen, starting from the SHAP matrix seen above, it is enough to apply the formula:", "For instance, having a 3rd Class ticket reduces the survival probability of the first passenger by -4.48% (which corresponds to -0.36 SHAP). Notice that also passenger n. 3 and passenger n. 5 were in 3rd Class. Their impacts on probability (respectively -16.65% and -5.17%) are different due to the interaction with other features.", "Several analyses can be carried out on this matrix. We just report some plots as an example.", "The red line identifies the average effect (mean of Age effect for all individuals in a group), while the blue band (mean \u00b1 standard deviation) expresses the variability of Age effect between the individuals in the same group. The variability is due to the interaction between Age and the other variables.", "The value added of this method is that:", "Simple models such as Logistic Regression make a great deal of simplifications. Black-box models are more flexible and thus more adaptable to complex (but very intuitive) real world behaviours, such as non-linear relationships and interactions between variables.", "Explainability means expressing a model\u2019s choices in a way that is intelligible for humans, based on their perception of reality (including complex behaviours).", "We have shown a way to translate SHAP values into probabilities. This makes it possible to visualize a black-box functioning and to ensure that it is consistent (both qualitatively and quantitatively) with our knowledge of the world: a world that is more faceted than the one depicted by simpler models.", "The code can be found here:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Data Scientist | Striving for simplicity."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff263c22795d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f263c22795d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f263c22795d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----f263c22795d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----f263c22795d--------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03----f263c22795d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff263c22795d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff263c22795d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/titanic", "anchor_text": "Titanic dataset"}, {"url": "https://catboost.ai", "anchor_text": "Catboost"}, {"url": "https://www.reuters.com/article/us-amazon-com-jobs-automation-insight/amazon-scraps-secret-ai-recruiting-tool-that-showed-bias-against-women-idUSKCN1MK08G", "anchor_text": "sexist AI recruitment tool"}, {"url": "https://www.bbc.com/news/technology-35902104", "anchor_text": "racist chatbot"}, {"url": "https://arxiv.org/abs/1705.07874", "anchor_text": "SHAP (SHapley Additive exPlanations)"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "the Python library dedicated to SHAP"}, {"url": "https://github.com/smazzanti/tds_black_box_models_more_explainable/blob/master/Shap2Probas.ipynb", "anchor_text": "smazzanti/tds_black_box_models_more_explainableYou can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or\u2026github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f263c22795d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----f263c22795d---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/shap?source=post_page-----f263c22795d---------------shap-----------------", "anchor_text": "Shap"}, {"url": "https://medium.com/tag/black-box?source=post_page-----f263c22795d---------------black_box-----------------", "anchor_text": "Black Box"}, {"url": "https://medium.com/tag/model-interpretation?source=post_page-----f263c22795d---------------model_interpretation-----------------", "anchor_text": "Model Interpretation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff263c22795d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----f263c22795d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff263c22795d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----f263c22795d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff263c22795d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f263c22795d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff263c22795d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f263c22795d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f263c22795d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f263c22795d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f263c22795d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f263c22795d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f263c22795d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f263c22795d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f263c22795d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f263c22795d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/@mazzanti.sam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce90f5bea5f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblack-box-models-are-actually-more-explainable-than-a-logistic-regression-f263c22795d&newsletterV3=e16f3bb86e03&newsletterV3Id=ce90f5bea5f9&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}