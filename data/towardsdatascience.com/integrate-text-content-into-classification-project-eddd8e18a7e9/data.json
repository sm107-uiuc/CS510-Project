{"url": "https://towardsdatascience.com/integrate-text-content-into-classification-project-eddd8e18a7e9", "time": 1683015879.9785018, "path": "towardsdatascience.com/integrate-text-content-into-classification-project-eddd8e18a7e9/", "webpage": {"metadata": {"title": "Incorporate Text Feature Into Classification Project | Jinhang Jiang | Towards Data Science", "h1": "Incorporate Text Feature Into Classification Project", "description": "This project aimed to study how the unstructured text data could add values to a machine learning classification project."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/use-r-to-calculate-boilerplate-for-accounting-analysis-f4a5b64e9b0d", "anchor_text": "Boilerplate score", "paragraph_index": 14}, {"url": "https://github.com/jinhangjiang/ASU_CIS508_TextMining-MachineLearning", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://medium.com/analytics-vidhya/simple-weighted-average-ensemble-machine-learning-777824852426", "anchor_text": "Simple Weighted Average Ensemble | Machine Learning", "paragraph_index": 23}, {"url": "https://towardsdatascience.com/use-r-to-calculate-boilerplate-for-accounting-analysis-f4a5b64e9b0d", "anchor_text": "Use R to Calculate Boilerplate for Accounting Analysis", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/jinhangjiang/", "anchor_text": "https://www.linkedin.com/in/jinhangjiang/", "paragraph_index": 26}], "all_paragraphs": ["This project aimed to study how the unstructured text data could add values to a machine learning classification project.", "I had two datasets from a company. One of them contained all the basic information of the customers. The customer dataset also had the target column, which indicated whether the customer was holding the membership or already canceled it. The other dataset contained the comments which the customers left for the company. My task was to combine the customers\u2019 comments with the customers' existing information to predict whether they would cancel or keep the membership.", "In this project, I studied how to incorporate the text mining techniques, using Natural Language Toolkit (NLTK), into the machine learning models to improve the binary classification performance.", "I used Porter stemmer, Snowball stemmer, Lancaster stemmer, word_tokenize, CountVectorizer, TfidfTransformer, LabelEncoder, XGBClassifier, and CatBoostClassifier in this project. I picked the ROC score as the primary evaluation metric.", "The customer dataset had 2070 records and 17 variables, including the ID for each customer. The comment dataset had the messages the company collected from each customer.", "Figure 1 shows the frequency of the target column. 1266 of them were members of the company, and 804 of them had canceled their memberships. I would consider it pretty balanced data, so I did not apply oversampling techniques.", "Because I was going to calculate the ROC score, I transformed the TARGET value to the binary variable. Here is the code:", "First, I had to tokenize the comments. The original comments may contain typos, irrelevant content, redundant information, and the like that would increase the computation burden and decrease the models' efficiency. Utilizing the tokenizer to break those sentences into individual words enabled me to extract the comments' core information. Figure 2 compares the original comments and tokenized comments.", "To reduce the high dimensionality, I applied three different stemmers: Porter, Snowball (Porter 2), and Lancaster. Figure 3 shows the outputs of the different algorithms. Each of them has pros and cons. We can take a look here:", "1. It looks like Porter tends to save the uppercase or lowercase of the original content", "2. Lancaster is very aggressive. For example, for ID 3034, while the other two kept the word \"need,\" Lancaster converted it to \"nee\"", "3.Porter also had a difficult time recognizing simple words. For example, Porter somehow converted \"his\" to \"hi\" in most cases", "4.Therefore, I picked Snowball stemmer for the rest of the project", "After stemming, I constructed the term-document matrix and eliminated the stop words. The dimension of the term-document matrix is 2070 x 354. It could tell us if a specific word existed in a specific document.", "Then, I constructed the TF-IDF matrix from the term-document matrix. There are many ways to quantify the text content in the collection of documents, such as the Readability score. In one of my previous blogs, I also wrote about calculating the Boilerplate score, which is also a method to quantify text content. TF-IDF is one of the most common quantifying methods, evaluating how relevant a word is to a document in a collection of documents. Figure 5 is part of the TF-IDF matrix.", "After constructing the TF-IDF matrix, I combined the matrix with the original customer dataset. The combined dataset had 2070 records and 387 columns.", "To validate the models I built, compare the original data with the combined data, and avoid overfitting, I split both datasets into a training dataset and a test dataset at a ratio of 4:1, respectively.", "First, I applied CatBoost and XGBoost to the data without the TF-IDF matrix. The outputs are shown in Figure 6 and Figure 7.", "And then, I applied the same models to the combined data. The ROC scores were 0.917173 and 0.911844 for the CatBoost and XGBoost, respectively. Figure 8 shows how the log-loss of the CatBoost model changes with the increase of the learning rounds.", "Figure 9 is the classification report of the CatBoostClassifier with the combined data, which is also the best result I got in this project.", "I compared three different ways to stem the words: Porter, Snowball, and Lancaster. Lancaster was more aggressive than the other two stemmers. Porter tended to keep more information and had difficulty recognizing the most basic words, like \u201chis.\u201d Snowball seemed to fall between the other two stemmers: not as aggressive as Lancaster but keeping the basic words.", "Quantifying and adding the text features to the machine learning models helped capture the information that would not have been found in the original data. Furthermore, TF-IDF is not the only method that could help. By changing the way to quantify the text content, the models could be further improved.", "You may find the codes and data here.", "Simple Weighted Average Ensemble | Machine Learning", "Use R to Calculate Boilerplate for Accounting Analysis", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Walmart Inc. | https://www.linkedin.com/in/jinhangjiang/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feddd8e18a7e9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jinhangjiang.medium.com/?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": ""}, {"url": "https://jinhangjiang.medium.com/?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": "Jinhang Jiang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c41ed254f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&user=Jinhang+Jiang&userId=1c41ed254f6d&source=post_page-1c41ed254f6d----eddd8e18a7e9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feddd8e18a7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feddd8e18a7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/lud4OaUCP4Q", "anchor_text": "Image Source"}, {"url": "https://towardsdatascience.com/use-r-to-calculate-boilerplate-for-accounting-analysis-f4a5b64e9b0d", "anchor_text": "Boilerplate score"}, {"url": "https://github.com/jinhangjiang/ASU_CIS508_TextMining-MachineLearning", "anchor_text": "here"}, {"url": "https://medium.com/analytics-vidhya/analyzing-disease-co-occurrence-using-networkx-gephi-and-node2vec-53941da35a0f", "anchor_text": ""}, {"url": "https://medium.com/analytics-vidhya/simple-weighted-average-ensemble-machine-learning-777824852426", "anchor_text": "Simple Weighted Average Ensemble | Machine Learning"}, {"url": "https://towardsdatascience.com/use-r-to-calculate-boilerplate-for-accounting-analysis-f4a5b64e9b0d", "anchor_text": "Use R to Calculate Boilerplate for Accounting Analysis"}, {"url": "https://medium.com/tag/text-mining?source=post_page-----eddd8e18a7e9---------------text_mining-----------------", "anchor_text": "Text Mining"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----eddd8e18a7e9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----eddd8e18a7e9---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/data-science?source=post_page-----eddd8e18a7e9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tf-idf?source=post_page-----eddd8e18a7e9---------------tf_idf-----------------", "anchor_text": "Tf Idf"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feddd8e18a7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&user=Jinhang+Jiang&userId=1c41ed254f6d&source=-----eddd8e18a7e9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feddd8e18a7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&user=Jinhang+Jiang&userId=1c41ed254f6d&source=-----eddd8e18a7e9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feddd8e18a7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feddd8e18a7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eddd8e18a7e9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eddd8e18a7e9--------------------------------", "anchor_text": ""}, {"url": "https://jinhangjiang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jinhangjiang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jinhang Jiang"}, {"url": "https://jinhangjiang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "614 Followers"}, {"url": "https://www.linkedin.com/in/jinhangjiang/", "anchor_text": "https://www.linkedin.com/in/jinhangjiang/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c41ed254f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&user=Jinhang+Jiang&userId=1c41ed254f6d&source=post_page-1c41ed254f6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6ca0ddf5333f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrate-text-content-into-classification-project-eddd8e18a7e9&newsletterV3=1c41ed254f6d&newsletterV3Id=6ca0ddf5333f&user=Jinhang+Jiang&userId=1c41ed254f6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}