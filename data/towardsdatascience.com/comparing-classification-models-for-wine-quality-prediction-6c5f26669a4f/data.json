{"url": "https://towardsdatascience.com/comparing-classification-models-for-wine-quality-prediction-6c5f26669a4f", "time": 1683007793.54862, "path": "towardsdatascience.com/comparing-classification-models-for-wine-quality-prediction-6c5f26669a4f/", "webpage": {"metadata": {"title": "Comparing Classification Models for Wine Quality Prediction | by Gulden Turgay | Towards Data Science", "h1": "Comparing Classification Models for Wine Quality Prediction", "description": "Here is my first ever blog post! Since I put myself in a continuous, never-ending learning process as a result of my decision of career transition from chemical engineering to data science, I decided\u2026"}, "outgoing_paragraph_urls": [{"url": "http://archive.ics.uci.edu/ml/datasets/Wine+Quality", "anchor_text": "UCI Machine Learning Repository", "paragraph_index": 1}, {"url": "https://www.linkedin.com/in/guldenturgay/", "anchor_text": "LinkedIn", "paragraph_index": 35}], "all_paragraphs": ["Here is my first ever blog post! Since I put myself in a continuous, never-ending learning process as a result of my decision of career transition from chemical engineering to data science, I decided to share what I learned and applied on projects as blog posts.", "In this project I wanted to compare several classification algorithms to predict wine quality which has a score between 0 and 10. Since I like white wine better than red, I decided to compare and select an algorithm to find out what makes a good wine by using winequality-white.csv data sourced from the UCI Machine Learning Repository. The attributes in this dataset are:", "Exploratory data analysis is a very important step to get an idea of what the dataset is like and what kind of modifications we need to make. I started with importing the libraries and modules and reading the data I\u2019ll be using into pandas dataframe.", "To understand the data, I took a look at the first couple of rows. It seems pretty clean but it\u2019s 4898 rows of data and it wouldn\u2019t be wise to check all the rows just by looking at it to see if there is a problem with the data. So I will check all the missing values at once in the next step.", "There is no missing value in the data so it\u2019s ready to analyze but first outliers must be detected and eliminated before the modeling step.", "I applied df.describe() method to get a sense of the descriptive statistics information of the dataset. It\u2019s a very good method to have an intuitive understanding of the problems in the dataset. In a quick glimpse, I can see that there are some outliers.", "Let\u2019s have a look at the \u2018residual sugar\u2019 column. count says there are 4898 rows in this column. While mean and std means respectively the average and standard deviation values of the column, 25% of the values are under 1.70 and 75% of them are under 9.90. The interesting thing is while the average value is 6.39 and minimum value is 0.60, the maximum value is 65.80. It looks like an outlier.", "I used boxplot to visualize the distribution of the values in \u2018residual sugar\u2019 column to get a better insight. The actual maximum value is around 20 and the values bigger than that are outliers since they are not included in the box of observation.", "Most of the time it\u2019s important to remove outliers since they would most likely affect the performance of machine learning models. But let\u2019s say 30% of your dataset are outliers. Then it may not be wise to remove them all because probably there is something more going on and it needs to be inspected further. In order to find and remove the outliers, I used z-score.", "Its interpretation is take the data point or observation, subtract the mean of the population and divide it by the standard deviation. It represents how many standard deviations away a data point is from the mean. The data points which are too far from the mean are considered as outliers. In most cases threshold for outlier detection is either z-score>3 or z-score<-3. For this purpose I used zscore() function defined in SciPy library and set the threshold=3. After removing outliers there are 4487 rows left in the dataset which mean about 8.4% of the dataset has been removed as outliers.", "When I checked the correlation between columns I can see that some of the features are strongly correlated with quality while some of them are not.", "As a last step of exploratory data analysis I wanted to check the class imbalance. And it seems like there is a high class imbalance where the minority classes are less represented than the majority classes. This will be a crucial part of the modeling in the later steps.", "In this step of the analysis I defined the features to train and test the machine learning model and the target to predict which is \u2018quality\u2019. And then I did standardization(also called z-score normalization) for the features because different scales of features may impact the performance of the machine learning models. For this purpose, I used StandardScaler() function defined in Scikit-learn. And finally I split the dataset into training and test sets 80% and 20% respectively.", "Defining the features and the target", "In this part I trained several classification algorithms to find the best one for the dataset I used.", "I started with K-Nearest Neighbors classification algorithm. What this algorithm does is that it takes a data point and selects K number of observations in the training data which are the nearest to the data point and then predicts the response of the data point regarding the most popular response value from the K-nearest neighbors.", "I created a plot to see how the accuracy changed with the number of K.", "I decided to go with k=19 since one of the highest accuracy obtained with it. And trained the model and calculated the accuracy with different validation methods.", "When I look at the classification report I immediately see that classes 4 and 8 have not been taken into consideration when training because their recall results are zero. This means, of all class 4 and class 8 members, it did not predict any of them correctly. So, it wouldn\u2019t be a good model for our dataset.", "Logistic regression is actually a binary classification algorithm which can be used for questions such as Yes/No, True/False, etc.", "In this case it allows us to use it for multi-class classification problems such as ours. Because in our dataset there are 5 classes for quality to be predicted as. In order to use it as a multi-class classification algorithm, I used multi_class=\u2019multinomial\u2019, solver =\u2019newton-cg\u2019 parameters.", "And considering it\u2019s a multi-class classification problem, I used \u2018roc_auc_ovr\u2019 scoring parameter instead of \u2018accuracy\u2019 when calculating cross validation score. I also calculated roc_auc_score with multi_class=\u2019ovr\u2019 parameter. I will explain these later in conclusion.", "Even though cross validation scores are a little bit higher, Some of the recall results are still zero. Let\u2019s see what happens if we add some polynomial features.", "Adding polynomial features to the logistic regression", "Now I tried adding 3rd degree polynomial features to the logistic regression model.", "Finally, I had some representation for minority classes when predicting but they are very low and also cross validation score is lower than before.", "Decision trees are one of the most popularly used classification algorithms in the data science field. When I applied it to my dataset, there is an increase in recall results but the cross validation score decreased.", "Random forest is an ensemble learning method that builds multiple decision trees and then gets a prediction based on what the majority of decision trees predict. I like to think of it as seeing multiple doctors for a health problem and deciding if you should get surgery or not depending on what the majority of the doctors say.", "So let\u2019s see the results of the random forest model.", "It\u2019s the best so far! The roc_auc_score is pretty good, the cross-validation score is the best so far and there are some recall results even for the minority classes. But it\u2019s not enough yet. So one of the things that can be done to increase recall is oversampling the minority classes. For this purpose I used the random forest algorithm with SMOTE algorithm implementation.", "SMOTE (Synthetic Minority Over-Sampling) algorithm creates synthetic minority class samples to increase the representation of minority classes.", "Even though the accuracy is almost the same as the previous one, the recall results have significantly increased for minority classes.", "In this project, I used K-Nearest Neighbors, Logistic Regression with polynomial features, Decision Tree, and Random Forest. With the roc_auc_score in Scikit-learn I calculated the AUC score for each model. Also using cross_val_score method I found AUC score using cross validation method by passing roc_auc_ovr parameter. Even though it's usually used for performance evaluation in binary classification, with the One-vs-Rest approach, I applied it to the multi-class classification problem. Evaluating the model with this method is advantageous when there is a high class imbalance. Also it does not require to set a classification threshold.", "If we compare the cross validation scores and recall results of all models we can see that the best results were obtained with Random Forest Classifier with SMOTE method with 0.7565 cross validation score. Since we had highly imbalanced classes, SMOTE created synthetic minority sampling to balance the samples. And trained the model as if we had balanced classes in our dataset.", "Even though we got the highest cross validation score which is around 0.75, it is still not an ideal model because the recall results are not representative enough for any of the classes. In this case, in order to improve the model we need more data to train it.", "If you have any feedback or correction, please don\u2019t hesitate to reach out to me at my LinkedIn!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6c5f26669a4f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://guldenturgay.medium.com/?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": ""}, {"url": "https://guldenturgay.medium.com/?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": "Gulden Turgay"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37b48d40f95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&user=Gulden+Turgay&userId=f37b48d40f95&source=post_page-f37b48d40f95----6c5f26669a4f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c5f26669a4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c5f26669a4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@matt_j?utm_source=medium&utm_medium=referral", "anchor_text": "Matthieu Joannon"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://archive.ics.uci.edu/ml/datasets/Wine+Quality", "anchor_text": "UCI Machine Learning Repository"}, {"url": "https://www.linkedin.com/in/guldenturgay/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/random-forest?source=post_page-----6c5f26669a4f---------------random_forest-----------------", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6c5f26669a4f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----6c5f26669a4f---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6c5f26669a4f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/exploratory-data-analysis?source=post_page-----6c5f26669a4f---------------exploratory_data_analysis-----------------", "anchor_text": "Exploratory Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6c5f26669a4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&user=Gulden+Turgay&userId=f37b48d40f95&source=-----6c5f26669a4f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6c5f26669a4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&user=Gulden+Turgay&userId=f37b48d40f95&source=-----6c5f26669a4f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c5f26669a4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6c5f26669a4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6c5f26669a4f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6c5f26669a4f--------------------------------", "anchor_text": ""}, {"url": "https://guldenturgay.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://guldenturgay.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gulden Turgay"}, {"url": "https://guldenturgay.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37b48d40f95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&user=Gulden+Turgay&userId=f37b48d40f95&source=post_page-f37b48d40f95--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ff37b48d40f95%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparing-classification-models-for-wine-quality-prediction-6c5f26669a4f&user=Gulden+Turgay&userId=f37b48d40f95&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}