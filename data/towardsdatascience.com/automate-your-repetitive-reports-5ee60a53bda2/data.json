{"url": "https://towardsdatascience.com/automate-your-repetitive-reports-5ee60a53bda2", "time": 1683002886.496907, "path": "towardsdatascience.com/automate-your-repetitive-reports-5ee60a53bda2/", "webpage": {"metadata": {"title": "Automate Your Repetitive Reports! | by Arafath Hossain | Towards Data Science", "h1": "Automate Your Repetitive Reports!", "description": "In most use cases R is used to analyze data, run statistical tests and build model. In doing so, data scientists constantly interact with R by writing codes and produce results from these\u2026"}, "outgoing_paragraph_urls": [{"url": "http://rpubs.com/arafath/CRAN_Report", "anchor_text": "http://rpubs.com/arafath/CRAN_Report", "paragraph_index": 5}, {"url": "https://www.laminarinsight.com/", "anchor_text": "https://www.laminarinsight.com/", "paragraph_index": 36}], "all_paragraphs": ["In most use cases R is used to analyze data, run statistical tests and build model. In doing so, data scientists constantly interact with R by writing codes and produce results from these interactions. Eventually, these results are stored, shared or presented as a report. But what if you have to reproduce the report every day or in other type of regular interval? Well, you can always pull up the R script and re-run the script. But wouldn\u2019t it be nicer if it would be done automatically without you being in the middle to initiate R and running the script?", "In this article we\u2019ll know how to do exactly that!", "Broadly, this article has two sections:", "Firstly, in this article we\u2019ll create a report that uses live data, meaning a data source that gets updated in regular interval.", "Secondly, once the report is created, we\u2019ll automate the process of recreating the report daily to capture the updated data.", "Since the goal of this article is to automate the reproduction of an already built report, I have created a report already and posted here: http://rpubs.com/arafath/CRAN_Report.", "Feel free to go to that report and recreate it in your work station. You can name the RMarkdown script same as mine (\u2018CRAN_Download_Report.Rmd\u2019) and save it in the same location where you want to have your .bat file and other outputs stored.", "What is done in that report looks like this:", "CRAN has an API calling which we can use to get the total number of times any package is downloaded during a specific time. We\u2019ll use the package called cranlogs to call the api.", "Once we have a working R script that produces result that we want, the reproduction workflow looks like as follows:", "In this step we\u2019ll know how to tell R to do all these above steps automatically. In doing so R will also complete all the steps mentioned in Part01 too.", "To automate rerunning the R script we will use Windows Task Scheduler (WTS). Using task scheduler a user can ask windows to execute a batch file (.bat) at a regular interval. A batch file contains a series of commands that can be executed by the command line interpreter.", "We will create a batch file that will run an R script automatically on daily basis. Inside that R script, it\u2019s instructed to call the .Rmd file which creates the report.", "You can copy and paste the following codes in a R script and save it as run.R (my r script file name):", "What this R script does is basically knitting the rmd file and generating a html report, save it in the working directory and send an email notification.", "Before creating the batch file, we can run our R script from command terminal manually and check if it runs as expected.", "Open the windows command shell. Search for \u2018cmd\u2019 or \u2018command prompt\u2019 in the windows and open it. It will open the black command shell.", "Now change the command directory to your desired location using \u2018cd\u2019 command followed by your desired file location (ref: image01).", "The structure of the command that we\u2019ll use is like this: <R.exe location> CMD BATCH <.R file location>", "For simplicity, I\u2019m using the same file location as my R working directory and location to save any outputs.", "These are the exact locations in my case:", "Here\u2019s the final line of code in my computer (ref: image02):", "Once you enter the command (image02) and execute it, it should run the R script, which will knit rmarkdown document and save the report. You should also receive an email with the notification!", "We can save the command line instructions (image02) as a .bat file and save it. Then, any time we\u2019ll need to re-create the report we can execute the .bat file and it\u2019ll automatically call upon command line interface and execute the R script.", "To do that, open a text file (.txt). Paste the Windows shell commands in the .txt file and save it with an extension of .bat.", "In my computer I have named it \u2018run.bat\u2019.", "In cases where you don\u2019t need to re-create a report on regular interval, you can just use this .bat file. All you\u2019ll have to do is to double click (or single click) the .bat file and the report will be generated with the updated data.", "Now we\u2019ll ask our computer to automatically call the .bat file in regular interval.", "2. Select Create Basic Task (red marked on image03)", "3. Give the task a name", "4. Go next and select a trigger. I selected Daily.", "5. Go next and select start time.", "6. Go next and select Start a program as the action.", "7. Go next and load the program/script (.bat file).", "Now every day at 3.30pm. the report below with CRAN package downloads will be created and an email notification will be sent!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Curious Learner and Passionate Data Professional. Read my personal blog: https://www.laminarinsight.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5ee60a53bda2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://curious-joe.medium.com/?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": ""}, {"url": "https://curious-joe.medium.com/?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": "Arafath Hossain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97436c787c1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&user=Arafath+Hossain&userId=97436c787c1e&source=post_page-97436c787c1e----5ee60a53bda2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ee60a53bda2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ee60a53bda2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://thumbs.gfycat.com/ImpressiveInstructiveIberianemeraldlizard-small.gif", "anchor_text": "https://thumbs.gfycat.com/ImpressiveInstructiveIberianemeraldlizard-small.gif"}, {"url": "http://rpubs.com/arafath/CRAN_Report", "anchor_text": "http://rpubs.com/arafath/CRAN_Report"}, {"url": "https://medium.com/tag/command-line?source=post_page-----5ee60a53bda2---------------command_line-----------------", "anchor_text": "Command Line"}, {"url": "https://medium.com/tag/r?source=post_page-----5ee60a53bda2---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/automating?source=post_page-----5ee60a53bda2---------------automating-----------------", "anchor_text": "Automating"}, {"url": "https://medium.com/tag/rmarkdown?source=post_page-----5ee60a53bda2---------------rmarkdown-----------------", "anchor_text": "Rmarkdown"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5ee60a53bda2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5ee60a53bda2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&user=Arafath+Hossain&userId=97436c787c1e&source=-----5ee60a53bda2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5ee60a53bda2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&user=Arafath+Hossain&userId=97436c787c1e&source=-----5ee60a53bda2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ee60a53bda2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5ee60a53bda2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5ee60a53bda2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5ee60a53bda2--------------------------------", "anchor_text": ""}, {"url": "https://curious-joe.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://curious-joe.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arafath Hossain"}, {"url": "https://curious-joe.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "142 Followers"}, {"url": "https://www.laminarinsight.com/", "anchor_text": "https://www.laminarinsight.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97436c787c1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&user=Arafath+Hossain&userId=97436c787c1e&source=post_page-97436c787c1e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4e3e805a6de0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-your-repetitive-reports-5ee60a53bda2&newsletterV3=97436c787c1e&newsletterV3Id=4e3e805a6de0&user=Arafath+Hossain&userId=97436c787c1e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}