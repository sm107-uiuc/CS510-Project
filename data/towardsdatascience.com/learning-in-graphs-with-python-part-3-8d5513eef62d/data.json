{"url": "https://towardsdatascience.com/learning-in-graphs-with-python-part-3-8d5513eef62d", "time": 1683000146.876968, "path": "towardsdatascience.com/learning-in-graphs-with-python-part-3-8d5513eef62d/", "webpage": {"metadata": {"title": "Learning in Graphs with Python (Part 3) | by Ma\u00ebl Fabien | Towards Data Science", "h1": "Learning in Graphs with Python (Part 3)", "description": "Graphs are becoming central to machine learning these days, whether you\u2019d like to understand the structure of a social network by predicting potential connections, detecting fraud, understand\u2026"}, "outgoing_paragraph_urls": [{"url": "https://snap.stanford.edu/data/", "anchor_text": "https://snap.stanford.edu/data/", "paragraph_index": 41}, {"url": "https://networkx.github.io/documentation/latest/reference/algorithms/generated/networkx.algorithms.community.label_propagation.label_propagation_communities.html", "anchor_text": "https://networkx.github.io/documentation/latest/reference/algorithms/generated/networkx.algorithms.community.label_propagation.label_propagation_communities.html", "paragraph_index": 41}, {"url": "http://www.perozzi.net/projects/deepwalk/", "anchor_text": "DeepWalk", "paragraph_index": 43}, {"url": "https://snap.stanford.edu/node2vec/", "anchor_text": "Node2Vec", "paragraph_index": 43}, {"url": "https://github.com/eliorc/node2vec", "anchor_text": "https://github.com/eliorc/node2vec", "paragraph_index": 46}, {"url": "https://arxiv.org/abs/1707.05005", "anchor_text": "Graph2Vec", "paragraph_index": 59}, {"url": "https://maelfabien.github.io/ml/#", "anchor_text": "https://maelfabien.github.io/", "paragraph_index": 65}], "all_paragraphs": ["Graphs are becoming central to machine learning these days, whether you\u2019d like to understand the structure of a social network by predicting potential connections, detecting fraud, understand customer\u2019s behavior of a car rental service or making real-time recommendations for example.", "In this article, we\u2019ll cover :", "I publish all my articles and the corresponding code on this repository :", "This is the final article on my Graph series. If you haven\u2019t, make sure to check the first articles of this series:", "For what comes next, open a Jupyter Notebook and import the following packages :", "The following articles will be using the latest version 2.x ofnetworkx. NetworkX is a Python package for the creation, manipulation, and study of the structure, dynamics, and functions of complex networks.", "I\u2019ll try to keep a practical approach and illustrate most concepts.", "There are three main tasks in graph learning that we will cover in this article:", "In Link Prediction, given a graph G, we aim to predict new edges. Predictions are useful to predict future relations or missing edges when the graph is not fully observed for example, or when new customers join a platform (e.g. a new LinkedIn user).", "Link prediction for a new LinkedIn user would simply be a suggestion of people he might know.", "In link prediction, we simply try to build a similarity measure between pairs of nodes and link the most similar nodes. The question is now to identify and compute the right similarity scores!", "To illustrate the different similarity scores, let\u2019s consider the following graph :", "Let N(i) be a set of neighbors of node i. On the graph above, the neighbors of both nodes i and j can be represented as :", "And the neighbors of i :", "We can build several similarity scores for these two nodes based on their neighborhoods.", "The intersection is the Common Neighbors, and the union is :", "Therefore, the Jaccard Coefficient is given by the ratio of the pink over the yellow:", "How do we perform the evaluation of the link prediction? We must hide a subset of node pairs, and predict their links based on the rules defined above. This is the equivalent of the train-test-split in supervised learning.", "We then evaluate the proportion of correct predictions for dense graphs, or use Area under the Curve criteria for Sparse graphs.", "Let\u2019s implement this in Python on the Karate graph we used in the 2 first articles! First of all, print the information about the graph :", "Then, plot the graph itself :", "Now, let\u2019s remove some connections, e.g 25% of the nodes:", "And plot the partially observed graph :", "You can print the number of edges we deleted and the number of edges remaining :", "We can first make a prediction using the Jaccard Coefficient :", "The prediction looks like this, a first node, a second node, and a Jaccard score (or a label directly):", "We can use the ROC-AUC criteria to compare the performance of the different models since we have both a label and probabilities.", "We can now repeat this for the Adamic-Adar Index :", "And for the preferential attachment score :", "We then select the model that maximizes the area under the curve for example, or any other criteria that you chose. So far, we covered the most common similarity scores for link prediction.", "We\u2019ll now cover into more details the node labeling algorithms.", "Given a graph where some nodes are not labeled, we want to predict their labels. This is in some sense a semi-supervised learning problem.", "One common way to deal with such problems is to make the assumption that there is a certain smoothness on the graph. The Smoothness assumption states that points connected via a path through high-density regions on the data are likely to have similar labels. This is the main hypothesis behind the Label Propagation Algorithm.", "The Label Propagation Algorithm (LPA) is a fast algorithm for finding communities in a graph using network structure alone as its guide, without any predefined objective function or prior information about the communities.", "A single label can quickly become dominant in a densely connected group of nodes, but it will have trouble crossing a sparsely connected region.", "How does the semi-supervised label propagation work?", "We define the initial label matrix Y \u2208 R(n\u00d7C) such that Yij=1 if xi has label yi=j and 0 otherwise.", "The algorithm will generate a prediction matrix F\u2208R(n\u00d7C) which we\u2019ll detail below. Then, we predict the label of a node by finding the most likely label :", "What is the prediction matrix F ?", "The prediction matrix is a matrix F* that minimizes both smoothness and accuracy criteria. Therefore, there is a tradeoff to make between the smoothness and the accuracy of our result.", "The problem expression is quite complex, so I won\u2019t go into details. However, the solution is given by :", "If you\u2019d like to go further on this topic, check the notions of smoothness of a graph function and manifold regularization. I won\u2019t cover the implementation of this part, but if you are interested, Stanford has a great set of labeled graphs that you can download: https://snap.stanford.edu/data/, and Networkx has a direct implementation of label propagation: https://networkx.github.io/documentation/latest/reference/algorithms/generated/networkx.algorithms.community.label_propagation.label_propagation_communities.html", "When dealing with NLP or computer vision problems, we are used to working with embeddings of images or texts in a Deep Neural Net. One of the limitations of graphs with what we have seen so far is the absence of vector features. However, we can learn an embedding of the graph! There are several levels of embedding in a graph :", "We will first focus on the embedding of graph components. Several approaches are possible to embed a node or an edge. For example, DeepWalk uses short random walks to learn representations for edges in graphs. We will talk about Node2Vec , a paper that was published by Aditya Grover and Jure Leskovec from Stanford University in 2016.", "According to the authors: \u201cnode2vec is an algorithmic framework for representational learning on graphs. Given any graph, it can learn continuous feature representations for the nodes, which can then be used for various downstream machine learning tasks.\u201d", "The model learns low-dimensional representations for nodes by optimizing a neighborhood preserving objective, using random walks.", "The code of Node2Vec is available on GitHub: https://github.com/eliorc/node2vec", "To install the package, simply run:", "Then, in your notebook, we\u2019ll embed the Karate graph :", "Then, pre-compute the probabilities and generate walks :", "We can then embed the nodes :", "To get the vector of a node, say node \u20182\u2019, use get_vector :", "The outcome has the following form :", "It has a length of 64 since we defined the dimension as 64 above. What can we do with this embedding? One of the first options is for example to identify the most similar node!", "It returns a list of the most similar nodes and the corresponding probabilities :", "If the nodes have labels, we can train an algorithm based on the embedding and attach a label (node labeling, most similar node\u2026)", "Edges can also be embedded, and the embedding can be further used for classification.", "Then, retrieve the vectors by specifying the name of the 2 linked nodes :", "Again, we can retrieve the most similar edge, which can be used for missing edges prediction for example :", "There are also ways to embed a graph or a sub-graph directly. This approach has been developed in the Graph2Vec paper and is useful to represent graphs or sub-graphs as vectors, thus allowing graph classification or graph similarity measures for example. I won\u2019t dive deeper into this technique, but feel free to check the Github of this project :", "To run the embedding, it\u2019s as easy as :", "We have now covered the introduction to graphs, the main types of graphs, the different graph algorithms, their implementation in Python with Networkx, and graph learning techniques for node labeling, link prediction, and graph embedding.", "Needless to say, this is only the tip of the iceberg. Graph Theory is ever-expanding, and I thought that listing some resources to go further could be useful :", "If you have any other resources in mind which you feel could be useful, don\u2019t hesitate to leave a comment and I\u2019ll add it to the list!", "I hope this series of articles was interesting to follow! Feel free to comment if you have any question or remark.", "NB: This article was originally published on my personal blog: https://maelfabien.github.io/", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8d5513eef62d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mael4impact?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mael4impact?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": "Ma\u00ebl Fabien"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddcee06de4c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&user=Ma%C3%ABl+Fabien&userId=ddcee06de4c8&source=post_page-ddcee06de4c8----8d5513eef62d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8d5513eef62d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8d5513eef62d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/towards-data-science/inside-ai/home", "anchor_text": "Inside AI"}, {"url": "https://github.com/maelfabien/Machine_Learning_Tutorials", "anchor_text": "maelfabien/Machine_Learning_TutorialsThis repo contains exercises, code, tutorials and articles of my personal blog \u2014 maelfabien/Machine_Learning_Tutorialsgithub.com"}, {"url": "https://towardsdatascience.com/introduction-to-graphs-part-1-2de6cda8c5a5", "anchor_text": "Introduction to Graphs (Part 1)Main concepts, properties, and applications in Pythontowardsdatascience.com"}, {"url": "https://towardsdatascience.com/graph-algorithms-part-2-dce0b2734a1d", "anchor_text": "Graph Algorithms (Part 2)Main concepts, properties, and applications in Pythontowardsdatascience.com"}, {"url": "https://snap.stanford.edu/data/", "anchor_text": "https://snap.stanford.edu/data/"}, {"url": "https://networkx.github.io/documentation/latest/reference/algorithms/generated/networkx.algorithms.community.label_propagation.label_propagation_communities.html", "anchor_text": "https://networkx.github.io/documentation/latest/reference/algorithms/generated/networkx.algorithms.community.label_propagation.label_propagation_communities.html"}, {"url": "https://snap.stanford.edu/node2vec/", "anchor_text": "Node2Vec"}, {"url": "https://arxiv.org/abs/1707.05005", "anchor_text": "Graph2Vec"}, {"url": "http://www.perozzi.net/projects/deepwalk/", "anchor_text": "DeepWalk"}, {"url": "https://snap.stanford.edu/node2vec/", "anchor_text": "Node2Vec"}, {"url": "https://github.com/eliorc/node2vec", "anchor_text": "https://github.com/eliorc/node2vec"}, {"url": "https://arxiv.org/abs/1707.05005", "anchor_text": "Graph2Vec"}, {"url": "https://github.com/benedekrozemberczki/graph2vec", "anchor_text": "benedekrozemberczki/graph2vecA parallel implementation of \"graph2vec: Learning Distributed Representations of Graphs\" (MLGWorkshop 2017). \u2026github.com"}, {"url": "https://towardsdatascience.com/how-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780", "anchor_text": "https://towardsdatascience.com/how-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780"}, {"url": "http://www.geometricdeeplearning.com/", "anchor_text": "http://www.geometricdeeplearning.com/"}, {"url": "https://www.edx.org/course/advanced-algorithmics-and-graph-theory-with-python", "anchor_text": "https://www.edx.org/course/advanced-algorithmics-and-graph-theory-with-python"}, {"url": "https://maelfabien.github.io/ml/#", "anchor_text": "https://maelfabien.github.io/"}, {"url": "https://networkx.github.io/documentation/stable/", "anchor_text": "https://networkx.github.io/documentation/stable/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8d5513eef62d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8d5513eef62d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8d5513eef62d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----8d5513eef62d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----8d5513eef62d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8d5513eef62d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&user=Ma%C3%ABl+Fabien&userId=ddcee06de4c8&source=-----8d5513eef62d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8d5513eef62d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&user=Ma%C3%ABl+Fabien&userId=ddcee06de4c8&source=-----8d5513eef62d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8d5513eef62d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8d5513eef62d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8d5513eef62d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8d5513eef62d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8d5513eef62d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8d5513eef62d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8d5513eef62d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mael4impact?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mael4impact?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ma\u00ebl Fabien"}, {"url": "https://medium.com/@mael4impact/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "749 Followers"}, {"url": "http://biped.ai", "anchor_text": "biped.ai"}, {"url": "https://bento.me/mael4impact", "anchor_text": "https://bento.me/mael4impact"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddcee06de4c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&user=Ma%C3%ABl+Fabien&userId=ddcee06de4c8&source=post_page-ddcee06de4c8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc8a99819d6f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-in-graphs-with-python-part-3-8d5513eef62d&newsletterV3=ddcee06de4c8&newsletterV3Id=c8a99819d6f0&user=Ma%C3%ABl+Fabien&userId=ddcee06de4c8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}