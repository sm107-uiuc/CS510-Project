{"url": "https://towardsdatascience.com/the-shape-of-chemical-functions-d1e1568d020", "time": 1683002000.397692, "path": "towardsdatascience.com/the-shape-of-chemical-functions-d1e1568d020/", "webpage": {"metadata": {"title": "The shape of chemical functions. How far can we take the statement: form\u2026 | by Thomas Boys | Towards Data Science", "h1": "The shape of chemical functions", "description": "https://github.com/giotto-ai/the-shape-of-chemical-functions (Simple installation instructions below.) Even if you are in a room for the first time, the objects in your vicinity will feel awfully\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/giotto-ai/the-shape-of-chemical-functions", "anchor_text": "this repository", "paragraph_index": 10}, {"url": "https://github.com/giotto-ai/giotto-learn", "anchor_text": "giotto-learn", "paragraph_index": 10}, {"url": "https://github.com/giotto-ai/giotto-learn/blob/master/README.rst", "anchor_text": "readme", "paragraph_index": 10}, {"url": "http://moleculenet.ai/", "anchor_text": "MoleculeNet", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Receiver_operating_characteristic", "anchor_text": "AUC-ROC", "paragraph_index": 11}, {"url": "http://snap.stanford.edu/graphwave/", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://pubs.rsc.org/en/content/articlelanding/2018/sc/c7sc02664a#!divAbstract", "anchor_text": "here", "paragraph_index": 25}], "all_paragraphs": ["Written by Francesco Pase, Francesco Palma, Matteo Caorsi, Thomas Boys", "Even if you are in a room for the first time, the objects in your vicinity will feel awfully familiar. The slightest detail will contain enough information to recognise an object and to associate with it a function. What the object looks like, what we loosely call its shape, informs us about something way deeper: its function, what the object does.", "Think about it for a second, it\u2019s pretty extraordinary that a short glimpse of an inanimate object will evoke all the things you can do with it. If it\u2019s a pair of headphones hiding under a piece of paper, or a dusty old tool in your family\u2019s toolshed, there is no need for an in-depth analysis, you will probably have an extremely insightful guess about its function.", "Hmmm\u2026 imagine not being able to distinguish a chainsaw from a bread knife.", "For complex evolving systems, it seems difficult to properly examine the question, since the system has the power to influence itself. However, for something as fundamental as chemistry we can expect a less biased answer.", "In chemistry, there is little room to doubt that shapes of molecules have some role to determine their function. Proteins make up our skin, carry the oxygen in our blood, help our muscles move and much much more. Inside our body, proteins take on many specialised shapes depending on the task they are given, for example, scaffolding help cells move and maintain their shape, and enzymes speed up bio-mechanical reactions thanks to special pockets. While those shapes are much more complex than everyday\u2019s objects, how far does the structure of a protein inform about its role in the body?", "Let\u2019s attempt to give a quantitative answer to this question. If shape information determines the function of a molecule, it should be possible to build a highly accurate predictive model relying only on shape features.", "Because we can only test for a single chemical reaction at a time, we simplify the question and attempt to predict whether a molecule will perform an exact function. In our case, we focus on predicting whether a molecule inhibits the spreading of HIV or not.", "To extract shape from molecules, it is natural to use some topology along the way.", "Relying solely on shape information we succeed in reaching a score of 0.74 in AUC-ROC. We achieve further performance boost by including the basic chemical information about the nature of the bonds, reaching 0.77. The state-of-the-art today reaches 0.78. Very respectable!", "The code needed to reproduce our results is fully available and can be found in this repository. To run the Jupyter notebook contained there, you will need to: a) download the repository\u2019s contents; b) install the latest (non-release) version of the open-source library giotto-learn, by following the instructions under \u201cDeveloper installation\u201d in the readme. Very soon, these experimental features will be accessible even more simply via pip without the need to clone the library\u2019s repo, so stay tuned!", "The HIV dataset was introduced by the Drug Therapeutics Program to encourage the research of HIV inhibiting compounds, it is included in MoleculeNet. For each of the 40,000 compounds, they tested whether the compound inhibits the replication of HIV, resulting in a binary labelling of the dataset. The two classes are unbalanced, as only 2% of the molecules are inhibitors. For this reason, we choose the AUC-ROC metric.", "It is common to represent molecules as graphs: seeing the atoms of the compound as vertices and chemical bonds as edges between vertices. In the setting we describe below, we extract shape information from the molecular graphs.", "In order to use this shape information in a predictive model, we need to extract features from the graph.", "If our hypothesis holds, hopefully, when two chemical compounds are close in structure, they will have a similar function. How do we build an embedding to highlight structural similarities between graphs?", "Let\u2019s imagine for a second that we embed the vertices of the graph so as to represent their role inside the graph (hub vs. isolated node).", "If a graph is similar to another, many of its vertices will have similar embeddings in the vector space, and so the resulting molecule feature vector should be near in the embedding space. So we\u2019ve reduced the problem to determining an embedding of the vertices that encodes the role they play inside the graph.", "We can think of the role of a vertex as the way it connects to all the other vertices in the graph. By simulating how a unit of heat spreads from one vertex to the rest of the graph, we can quantify the speed and the reach of the diffusion, and thus its role. The full method is exposed over here.", "We simulate the heat diffusion using the graph laplacian for a given number of time steps. As a measurement of the spread, we take the entropy at every time step of the diffusion. So once the process is started, you measure the diffusion at fixed time intervals and stop the diffusion for a given number of time steps. We found 40 to be reasonable.", "By measuring entropy of the graph at every of the 40 time steps every atom has a representation in 40-d.", "Finally, we are ready for the feature vector. We perform k-means clustering on the embedded vertices, we choose k=10. The feature vector for a vertex is then given by the 10-dimensional probability vector of belonging to each of the 10 clusters.", "Thanks to Hodge theory, it is also possible to study this same diffusion process, but this time on the edges of the graph. By replicating the previous steps we can stack another feature vector to our model.", "We obtain the feature vector of a molecule by stacking the two following vectors:", "To measure the impact of the chemical information we stack on-top of the molecule feature vector:", "It\u2019s time to feed the features to your favourite classifier. In our case, we choose a neural net with two hidden layers with respectively 32 and 64 Relu neurons.", "The performance achieved with the features extracted from the molecule\u2019s graph gives an impressive 0.74. The chemical information boosts the performance up to 0.77, approaching the 0.78 achieved by state-of-the-art Kernel SVM using extensive chemical information. Find the study over here.", "The structural features beat less optimal models that contain more extensive features. Shape is indeed a good proxy for function, even-though simple chemical attributes lead to a performance boost. Nonetheless, it\u2019s noticeable that little chemical information beyond shape is necessary to approach state-of-the-art performance.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd1e1568d020&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1e1568d020--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1e1568d020--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@t.boys_87095?source=post_page-----d1e1568d020--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@t.boys_87095?source=post_page-----d1e1568d020--------------------------------", "anchor_text": "Thomas Boys"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cc08e1b99c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&user=Thomas+Boys&userId=9cc08e1b99c8&source=post_page-9cc08e1b99c8----d1e1568d020---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1e1568d020&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1e1568d020&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/giotto-ai/the-shape-of-chemical-functions", "anchor_text": "https://github.com/giotto-ai/the-shape-of-chemical-functions"}, {"url": "https://github.com/giotto-ai/the-shape-of-chemical-functions", "anchor_text": "this repository"}, {"url": "https://github.com/giotto-ai/giotto-learn", "anchor_text": "giotto-learn"}, {"url": "https://github.com/giotto-ai/giotto-learn/blob/master/README.rst", "anchor_text": "readme"}, {"url": "http://moleculenet.ai/", "anchor_text": "MoleculeNet"}, {"url": "https://en.wikipedia.org/wiki/Receiver_operating_characteristic", "anchor_text": "AUC-ROC"}, {"url": "http://snap.stanford.edu/graphwave/", "anchor_text": "here"}, {"url": "https://pubs.rsc.org/en/content/articlelanding/2018/sc/c7sc02664a#!divAbstract", "anchor_text": "here"}, {"url": "https://github.com/giotto-ai/giotto-learn", "anchor_text": "Giotto library on Github"}, {"url": "https://github.com/giotto-ai/the-shape-of-chemical-functions", "anchor_text": "The notebook containing the code"}, {"url": "https://giotto.ai/", "anchor_text": "website"}, {"url": "https://towardsdatascience.com/the-shape-of-football-games-1589dc4e652a", "anchor_text": "Shape of Football"}, {"url": "https://github.com/giotto-ai/noise-to-signal", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/detecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42", "anchor_text": "Detecting stock crashes"}, {"url": "https://github.com/giotto-ai/stock-market-crashes", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/the-shape-of-population-dynamics-ba70f253919f", "anchor_text": "Shape of population dynamics"}, {"url": "https://github.com/giotto-ai/beetles-tda", "anchor_text": "notebook"}, {"url": "https://medium.com/tag/science?source=post_page-----d1e1568d020---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d1e1568d020---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d1e1568d020---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/chemistry?source=post_page-----d1e1568d020---------------chemistry-----------------", "anchor_text": "Chemistry"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1e1568d020&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&user=Thomas+Boys&userId=9cc08e1b99c8&source=-----d1e1568d020---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1e1568d020&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&user=Thomas+Boys&userId=9cc08e1b99c8&source=-----d1e1568d020---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1e1568d020&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1e1568d020--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd1e1568d020&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d1e1568d020---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1e1568d020--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d1e1568d020--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d1e1568d020--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d1e1568d020--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d1e1568d020--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d1e1568d020--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d1e1568d020--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d1e1568d020--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@t.boys_87095?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@t.boys_87095?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thomas Boys"}, {"url": "https://medium.com/@t.boys_87095/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "30 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cc08e1b99c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&user=Thomas+Boys&userId=9cc08e1b99c8&source=post_page-9cc08e1b99c8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F9cc08e1b99c8%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-chemical-functions-d1e1568d020&user=Thomas+Boys&userId=9cc08e1b99c8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}