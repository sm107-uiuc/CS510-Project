{"url": "https://towardsdatascience.com/visualizing-ai-86247fa2a182", "time": 1683005179.165161, "path": "towardsdatascience.com/visualizing-ai-86247fa2a182/", "webpage": {"metadata": {"title": "Visualizing AI. Deconstructing and Optimizing the SHAP\u2026 | by Wai On | Towards Data Science", "h1": "Visualizing AI", "description": "Now that you understand how the various components of the SHAP Summary Plot work together (part 1), I will provide an example of its use in explaining a black box Machine Learning model. In addition\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@waion/visualizing-ai-8fad4ea70b87", "anchor_text": "part 1", "paragraph_index": 0}, {"url": "https://github.com/taspett/SHAP-Summary-Plot-Article", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset", "anchor_text": "Kaggle", "paragraph_index": 2}, {"url": "https://github.com/taspett/SHAP-Summary-Plot-Article", "anchor_text": "GitHub", "paragraph_index": 3}, {"url": "https://www.forbes.com/sites/kalevleetaru/2019/01/15/a-reminder-that-machine-learning-is-about-correlations-not-causation/#6c8bc3226161", "anchor_text": "causal directions", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Stroop_effect", "anchor_text": "cognitive interference", "paragraph_index": 17}, {"url": "https://accessibility.psu.edu/accommodations/audience/colorblindness/", "anchor_text": "color insensitivity", "paragraph_index": 18}, {"url": "https://ieeexplore.ieee.org/document/736450", "anchor_text": "problematic", "paragraph_index": 19}, {"url": "https://github.com/slundberg/shap/issues/62", "anchor_text": "discussions", "paragraph_index": 20}, {"url": "https://sites.google.com/site/tufteondesign/examples", "anchor_text": "design strategy", "paragraph_index": 23}], "all_paragraphs": ["Now that you understand how the various components of the SHAP Summary Plot work together (part 1), I will provide an example of its use in explaining a black box Machine Learning model. In addition, I will discuss some of the problems with the visualization in the example before offering some ideas for improving it. The goal of these articles is to help the reader interpret the visualization, optimize it, and to arrive at a deeper understanding of the results.", "The code for this example can be found here on GitHub.", "The data I\u2019m using is the HR data from IBM that is available at Kaggle. The original purpose of the data was to understand attrition, but here I\u2019m using it to understand performance rating in the workplace.", "To reduce the amount of data-prep necessary, I\u2019ve simplified the data by pairing down the number of features. In addition, an examination of the data shows that the performance ratings are restricted to either a 3 or a 4 (out of a scale of 1\u20134). So in order to use the data to illustrate the capabilities of the Summary Plot for regression data, I\u2019ve re-scaled the rating to a real number between 0\u20139 by applying a set of transformations (see data file on GitHub).", "In the discussion of the results below, I will analyze this supposedly fictional data and hypothesize a possible story behind the data and the resulting model.", "For this exercise, I used the Random Forest algorithm from scikit-learn and used the SHAP Tree Explainer for explanation.", "The following diagram shows the process of using SHAP in our example.", "The bar graph below shows the feature names and their corresponding mean SHAP value.", "A bar graph of this type is the typical presentation of results for feature attribution algorithms. Here, it lists the features in descending order of importance, according to the mean SHAP value.", "As shown above, the feature with the highest mean SHAP value is \u201cPercentSalaryHike\u201d. This value is so dominant that it makes it difficult to tell the relative difference of other top influencers. In fact, \u201cPercentSalaryHike\u201d is so dominant that it suggests that something might be problematic with the data or our interpretation of it.", "Let\u2019s investigate further. The Summary Plot looks like this:", "The Summary Plot above shows that high values (red points) of \u201cPercentSalaryHike\u201d are associated with positive SHAP values and low values (blue points) of \u201cPercentSalaryHike\u201d are, in general, associated with negative SHAP values.", "Since the original data does not specify the timing of Salary Hike relative to Performance Rating, there are two interpretations of the result:", "In my view, the logical interpretation is probably #2. That is, employees received a high percentage increase in salary because they performed well. Of course, this is conjecture on my part but it serves as a good reminder that XAI tools reflect the nature of the underlying Machine Learning algorithms in general. Specifically, they operate in the realm of correlation and their results are ambiguous in terms of causal directions. The result, therefore, does not tell us that \u201cPercentSalaryHike\u201d is a cause of good work performance, it only tells us it is highly correlated. In this case, significantly more so than other features in the model.", "Of the top five features, \u201cAge\u201d also seems to follow a pattern where high values are associated with high SHAP values and low values are associated with low SHAP values. This pattern also seems to be applied to \u201cStockOptionLevel\u201d in the Summary Plot, albeit with less contrast.", "The SHAP values for the remaining features seem to cluster around zero but it\u2019s hard to see the details because of scaling needed in the plot. That is, the visualization has to be compressed in order to accommodate the large values from the first feature.", "Clearly, although the Summary Plot is useful as it is, there are a number of problems that are preventing us from understanding the result more easily. In this section, I will discuss some of these and to offer suggestions for tackling them in SHAP.", "First and foremost is the use of the color red to indicate high values. Red is an intensely emotional color. It is typically used as a warning of danger and generally has a negative connotation in western cultures. The use of red in and off itself is not the problem. However, in our example, it is particularly problematic since we are dealing with monetary values, experience, and age, where a high value may not be a negative thing. Making sense of a plot in this type of situation is particularly difficult because of the cognitive interference due to interactions between color and feature value.", "The second issue is that the transition from blue to red may cause differentiation issues for some users due to color insensitivity. In particular, the use of blue and purple next to one another being a combination to avoid.", "The mistake that the Summary Plot designers made is similar to those that use the \u201crainbow color\u201d scheme for data visualization (e.g. in \u201cheat maps\u201d). That is, the rainbow color palette looks attractive but is perceptually and semantically problematic.", "There have been discussions on providing custom color palettes for the \u2018dot\u2019 type (primarily as a way to deal with business requirements) but so far it\u2019s still forthcoming. To address the issues discussed, I tweaked the source code and removed the use of red. I also chose a single color but varied the luminosity to make it easier to see the color difference.", "The new Summary Plot looks like this:", "I think the resulting plot is easier to parse at a glance since there are fewer colors to decipher. In addition, switching to a more luminous blue as an indication of high numbers make the higher values standout. However, this may be a problem for users who are accustomed to seeing blue as the low number. If this is the case, I would recommend flipping the two end colors.", "Following a well-known design strategy, I eliminated some of the information that was not useful. Since most of the values for the features are so close to each other and since most the SHAP values are close to zero, it makes sense for us to focus on the top set of features by setting the max_display parameter:", "As mentioned above, it\u2019s unclear if \u201cPercentSalaryHike\u201d was a prior measure or a post measure of performance rating. If the employee received a high salary hike as a result of a good performance rating then this is less of an interest since we are interested in factors that contribute to good performance. Although it may also be interesting to see if a previous salary hike has any effect on performance rating, given it is unclear what the timing of salary increase is, it\u2019s prudent to eliminate this altogether.", "The above comments on \u201cPercentSalaryHike\u201d ambiguity can also be applied to other features associated with monetary values. For the top 5, this includes \u201cStockOptionLevel\u201d. For our analysis, we can assume that others (e.g. distanceFromWork, Age) stay relatively similar whether they are post or pre-measure of work performance rating.", "Since \u201cPercentSalaryHike\u201d is so dominant, the scale for the x-axis has to extend to accommodate for the magnitude of the values. As a result, it is difficult to see how the SHAP values are distributed.", "Luckily, removing the features \u201cPercentSalaryHike\u201d and \u201cStockOptionLevel\u201d from the top five features automatically address this issue. The new summary plot for our model is as shown below with a better suited magnification.", "The resulting plot is simpler and easier to understand. The plot shows that higher values of total working years and age correlate with higher SHAP values (which in turn means higher performance ratings). In addition, low values also correlates with low SHAP values. This supports the thinking that maturity and work experience contribute to good work performance.", "The third feature is more difficult to interpret. Higher values of \u201cDistanceFromHome\u201d (that is, living further from a place of work) seem to correlate with high SHAP values. Without understanding work from home policies and how employees feel about working from home, it\u2019s hard to interpret the result. In addition, the contrast between the color patches isn\u2019t particularly clear since the plot shows some high values also negatively impact performance rating (light blue dots to the left). This result shows this is an area worth looking into and suggests further research from HR in the areas of commuting and the effects of work from home policies in general.", "Of course, this is fictitious data so any interpretation here is purely an exercise in demonstrating the potential analysis that could be done. In addition to the small size of the SHAP values and the small difference between them, the fact that the Summary Plot shows that most of the values tend to cluster around zero also reminds us that it\u2019s best to interpret the results cautiously as well as the need to gather additional corroborative evidence.", "Although designing better XAI systems, in general, is beyond the scope of this article, I want to briefly discuss some tentative ideas for improvements that current tools can make immediately; particularly in the areas of User Experience and Data Visualizations design.", "Without waiting for major research breakthroughs in XAI, I think there are some concrete improvements that can be made immediately so that they can be used to better explain the results of Machine Learning models. I hope to write more about this topic in the future.", "In this article, I used the SHAP Summary Plot to explain the influences behind a black box model\u2019s output. Using the visualization, I hypothesized a possible story behind the data and the resulting model. As part of the process of telling a hypothetical story, I identified a number of ambiguities in the data as well as problems with the design of the SHAP Summary Plot. I then offered some ideas for improving the visualization as well as identifying further work needed to clarify the data. Finally, I provided some tentative ideas for XAI systems so that they can be tailored to the way users behave when seeking explanations.", "SHAP comes with a number of rich visualizations that deserve more attention than they are currently receiving. If you are a Data Scientist responsible for delivering systems or reports to end users, then hopefully this article has helped you to make the necessary adjustments to use the visualization more effectively. If you are an end user decision maker or end user consumer, you should now have a better understanding of the SHAP Summary Plot. This, in turn, will hopefully empower you to demand results to be presented in a way that is easier to understand.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI Researcher, UI Designer, Psychologist, User Researcher, Plastics Climber, and follower of the Bourdain trail."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F86247fa2a182&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----86247fa2a182--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----86247fa2a182--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@waion?source=post_page-----86247fa2a182--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@waion?source=post_page-----86247fa2a182--------------------------------", "anchor_text": "Wai On"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fffc520ef72ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&user=Wai+On&userId=ffc520ef72ba&source=post_page-ffc520ef72ba----86247fa2a182---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86247fa2a182&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86247fa2a182&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@waion/visualizing-ai-8fad4ea70b87", "anchor_text": "part 1"}, {"url": "https://github.com/taspett/SHAP-Summary-Plot-Article", "anchor_text": "here"}, {"url": "https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset", "anchor_text": "Kaggle"}, {"url": "https://github.com/taspett/SHAP-Summary-Plot-Article", "anchor_text": "GitHub"}, {"url": "https://www.forbes.com/sites/kalevleetaru/2019/01/15/a-reminder-that-machine-learning-is-about-correlations-not-causation/#6c8bc3226161", "anchor_text": "causal directions"}, {"url": "https://en.wikipedia.org/wiki/Stroop_effect", "anchor_text": "cognitive interference"}, {"url": "https://accessibility.psu.edu/accommodations/audience/colorblindness/", "anchor_text": "color insensitivity"}, {"url": "https://ieeexplore.ieee.org/document/736450", "anchor_text": "problematic"}, {"url": "https://github.com/slundberg/shap/issues/62", "anchor_text": "discussions"}, {"url": "https://sites.google.com/site/tufteondesign/examples", "anchor_text": "design strategy"}, {"url": "https://unsplash.com/@adamaszczos", "anchor_text": "Adam Nowakowski"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1706.07269", "anchor_text": "Research"}, {"url": "https://ubiquitous.comp.nus.edu.sg/wp-content/uploads/2019/01/chi2019-reasoned-xai-framework.pdf", "anchor_text": "study"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----86247fa2a182---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----86247fa2a182---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/design?source=post_page-----86247fa2a182---------------design-----------------", "anchor_text": "Design"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----86247fa2a182---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/user-experience?source=post_page-----86247fa2a182---------------user_experience-----------------", "anchor_text": "User Experience"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F86247fa2a182&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&user=Wai+On&userId=ffc520ef72ba&source=-----86247fa2a182---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F86247fa2a182&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&user=Wai+On&userId=ffc520ef72ba&source=-----86247fa2a182---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86247fa2a182&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----86247fa2a182--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F86247fa2a182&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----86247fa2a182---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----86247fa2a182--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----86247fa2a182--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----86247fa2a182--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----86247fa2a182--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----86247fa2a182--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----86247fa2a182--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----86247fa2a182--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----86247fa2a182--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@waion?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@waion?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wai On"}, {"url": "https://medium.com/@waion/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "36 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fffc520ef72ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&user=Wai+On&userId=ffc520ef72ba&source=post_page-ffc520ef72ba--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F142465632daa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-ai-86247fa2a182&newsletterV3=ffc520ef72ba&newsletterV3Id=142465632daa&user=Wai+On&userId=ffc520ef72ba&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}