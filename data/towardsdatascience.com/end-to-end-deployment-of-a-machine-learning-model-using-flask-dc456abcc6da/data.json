{"url": "https://towardsdatascience.com/end-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da", "time": 1683011674.78736, "path": "towardsdatascience.com/end-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da/", "webpage": {"metadata": {"title": "End to End Deployment of A Machine Learning Model using Flask | by Aamir Syed | Towards Data Science", "h1": "End to End Deployment of A Machine Learning Model using Flask", "description": "Machine Learning is pretty \u2014 and nifty, if it works right. However, you are limited to showing results to someone who understands the process the way you do. The magic disappears when someone gets to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "Flask", "paragraph_index": 1}, {"url": "https://www.kaggle.com/ananthu017/question-classification", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://www.w3schools.com/w3css/w3css_templates.asp", "anchor_text": "Here", "paragraph_index": 22}, {"url": "https://www.linkedin.com/in/aamir-syed/", "anchor_text": "linkedin profile", "paragraph_index": 36}, {"url": "https://github.com/Viole-Grace/Question_Classification", "anchor_text": "github repository", "paragraph_index": 37}], "all_paragraphs": ["Machine Learning is pretty \u2014 and nifty, if it works right. However, you are limited to showing results to someone who understands the process the way you do. The magic disappears when someone gets to know how it works, and taking others through what it is without visual aid \u2026 is about as exciting as watching paint dry.", "So, a valid line of thought is to have some visual aid, something easy to use, and something that can show an output which is not limited to a Jupyter Notebook or the Terminal. Here, we introduce Flask: a web application framework that is completely in Python. It boasts minimal setup and fast development times. This means no extra hassle trying to learn a language only for web deployment \u2014 plain old Python will do.", "Using Flask, we can now bring our machine learning models to life (or at least take them out of notebooks and terminals). Let\u2019s get started!", "Machine Learning can be used to solve classification problems and to make a practical model, we look at a simple but effective challenge \u2014 Question Classification. The details about the challenge can be found here.", "The goal of this problem is to develop a simple Machine Learning model, which can later be deployed using Flask.", "The dataset is pretty much standard, and has 5 columns : Index, Questions, Cat0, Cat1, Cat2.", "Cat1 is just the abbreviation of the corresponding data point in Cat0. Cat1 boasts only 6 classes, whereas Cat2 delves deeper and has a finer classification for each Question. We can check for unique values to take care of class imbalance, drop duplicates and remove null values (if any) as part of preparing the dataset. Another interesting point to note is that we cannot use categorical labels directly, so we have to convert each of the Cat1 and Cat2 data points into a class number to be used as target variables in our model.", "This can all be done simply as follows:", "As mentioned before, text/categorical values cannot be used directly in a machine learning model. To use these, we need to convert them into numeric values, or features. Feature Extraction and Feature Engineering in text refer to extracting information from data in a numeric format. To keep things simple, we use use an easy and intuitive method to convert our text into usable features. The TF-IDF is a very intuitive method of modeling text data into usable features :", "We have now chosen a method for converting our text into features, and have already formed the target variables as well. All that remains now is to fit a model \u2026.. but, which one? It is important to test out different models before deciding on a final one. Besides, modeling the best classification algorithm is a very simple task via sklearn \u2014 and we can see the outputs of different models using a simple fit() and predict().", "For this project, we choose SVM, LinearSVM, Decision Trees and Random Forests as our classifiers.", "Putting what we have thus far discussed into a simple workflow, we get:", "To evaluate which of our models works better, we need to calculate and compare accuracies between classifiers. Since it is a repetitive process, we can make it easier for us by defining a function to evaluate classifiers.", "After running the evaluation script, we find that LinearSVC outperforms the rest by a bit. At this point, we can use this as our machine learning model \u2014 but we can tune and possibly increase the performance of our model as well. So, the next step is to find the best parameters for our model, using GridSearchCV.", "We can follow the same flow for Task 2 as well. Nothing changes, except modeling by remembering class imbalance in our dataset.", "Since we have found our best model and possibly tuned it, we want to save it to run future predictions directly without having to train a classifier all over again. Recall that we made use of a vectorizer that fit our data as well. So, it is imperative to store the same vectorizer for our test and prediction data as well.", "Remember that we have 6 classes in Cat1, and 40+ in Cat2. A simple way of remembering them is to save a mapping of category_var:class_num in a json/text file. This can be done fairly easily like this:", "We have successfully finished training, tuning and saving our model! However, our code is a little haywire: it is all over the place and not very well structured. To predict results, we need to have a single function that transforms input sentence to lowercase, extracts features using the saved vectorizer and calls the prediction function using our saved model. To this end, let us make a simple prediction function from our saved files. This piece of modular code will help us when we deploy the application as well.", "Since our ML model is now ready and can be called using a single function, we are ready to deploy it. For this part, we need to have Flask installed on our local machine.", "Flask can simply be installed by running the following in a terminal:", "For this part, an IDE like VSCode or an editor like Sublime Text is preferred. They help in auto-completion, and give a good idea of our code structure.", "Every Flask based web application has 3 distinct things \u2014 a \u2018templates\u2019 folder (to store html pages), a \u2018static\u2019 folder (to store css designs and an optional \u2018images\u2019 folder inside : to store images), and a python file to run your app (normally named app.py by convention).", "Since many people (like myself) are not very good at designing Web applications, a fast fix is to use already available HTML templates. Choose one that would fit for your use-case, or can be modified to fit one. Here is a starting point for free html template designs.", "You can demo the template and try it yourself. You can also make changes in the online editor and see those in the browser directly. It can make for fast web designing if you are uncomfortable using Traditional editors and checking for outputs.", "For this project, I chose to have a home page and a prediction page for my web application. Make sure that all html files reside inside the templates folder, and their accompanying css in the static folder.", "The main implementation is seen in the prediction page of the application \u2014", "Finally, we build our app.py, that runs our back-end: the ML model. To do this, we use the prediction function we wrote earlier and define the routes for each of the html pages. By defining routes, we mean to tell the code what page to render when a particular local html page reference is clicked on.", "Also, since we take inputs for our model (usually through an HTML form), we need to set the form action and method accordingly. A very simple way is to use url_for , which sets the route directly to the argument inside the braces. Here, we set it to the predict(), which is the name of the prediction function in app.py.", "To access any inputs made using the form at the html page, we use requests.form[\u2018<value_name>\u2019].", "Combining all of this into a single app.py file, we write it as follows \u2014", "To run our app, we simply type in", "The result should look something like this:", "This marks the end of deploying our project using Flask.", "As a Machine Learning Engineer / Data Scientist or being an enthusiast/practitioner of any of the Data related tracks, it is important to show knowledge of end-to-end development of a product. Flask integrates with pure Python seamlessly, and is hence very easy to develop apps in. Flask should be used in building Proof of Concepts, demonstrating solutions, and for showing development and growth.", "Picking up a simple framework like Flask helps to round off the skill-set as a developer as well. Data Science in general is more reliant on how effectively you can demonstrate and show your ideas to a group of individuals that may not particularly be tech or data aligned.", "Data Scientists are, at the core, still software engineers. As such, building, testing, developing and deploying applications should be a part of every Software Engineer\u2019s skill-set.", "If you enjoyed the read, drop a comment and show your appreciation by clapping! You can also connect with me directly using my linkedin profile.", "The entire code for this project can be found at my github repository.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdc456abcc6da&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aamirsyed2801?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aamirsyed2801?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": "Aamir Syed"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8d88b44d54b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&user=Aamir+Syed&userId=b8d88b44d54b&source=post_page-b8d88b44d54b----dc456abcc6da---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc456abcc6da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc456abcc6da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@arianismmm?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Arian Darvishi"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "Flask"}, {"url": "https://unsplash.com/@campaign_creators?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Campaign Creators"}, {"url": "https://unsplash.com/s/photos/workflow?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/ananthu017/question-classification", "anchor_text": "here"}, {"url": "https://www.w3schools.com/w3css/w3css_templates.asp", "anchor_text": "Here"}, {"url": "https://www.linkedin.com/in/aamir-syed/", "anchor_text": "linkedin profile"}, {"url": "https://github.com/Viole-Grace/Question_Classification", "anchor_text": "github repository"}, {"url": "https://medium.com/tag/ml-model-deployment?source=post_page-----dc456abcc6da---------------ml_model_deployment-----------------", "anchor_text": "Ml Model Deployment"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dc456abcc6da---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/web-app-development?source=post_page-----dc456abcc6da---------------web_app_development-----------------", "anchor_text": "Web App Development"}, {"url": "https://medium.com/tag/python-flask?source=post_page-----dc456abcc6da---------------python_flask-----------------", "anchor_text": "Python Flask"}, {"url": "https://medium.com/tag/classification?source=post_page-----dc456abcc6da---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdc456abcc6da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&user=Aamir+Syed&userId=b8d88b44d54b&source=-----dc456abcc6da---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdc456abcc6da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&user=Aamir+Syed&userId=b8d88b44d54b&source=-----dc456abcc6da---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc456abcc6da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdc456abcc6da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dc456abcc6da---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dc456abcc6da--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dc456abcc6da--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dc456abcc6da--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dc456abcc6da--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aamirsyed2801?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aamirsyed2801?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aamir Syed"}, {"url": "https://medium.com/@aamirsyed2801/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "19 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8d88b44d54b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&user=Aamir+Syed&userId=b8d88b44d54b&source=post_page-b8d88b44d54b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fb8d88b44d54b%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-deployment-of-a-machine-learning-model-using-flask-dc456abcc6da&user=Aamir+Syed&userId=b8d88b44d54b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}