{"url": "https://towardsdatascience.com/a-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966", "time": 1683014897.072064, "path": "towardsdatascience.com/a-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966/", "webpage": {"metadata": {"title": "A Practical Introduction to Keras Callbacks in TensorFlow 2 | by B. Chen | Towards Data Science", "h1": "A Practical Introduction to Keras Callbacks in TensorFlow 2", "description": "When training a machine learning model, we would like to have the ability to monitor the model performance and perform certain actions depending on those performance measures. That\u2019s where Keras\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "my Github repo", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd", "anchor_text": "early stopping", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "anchor_text": "learning rate schedules", "paragraph_index": 7}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook", "paragraph_index": 52}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github", "paragraph_index": 54}], "all_paragraphs": ["When training a machine learning model, we would like to have the ability to monitor the model performance and perform certain actions depending on those performance measures. That\u2019s where Keras Callbacks come in.", "Callbacks are an important type of object TensorFlow and Keras that are designed to be able to monitor the performance in metrics at certain points in the training run and perform some action that might depend on those performance in metric values.", "In this article, we\u2019ll explore the following popular Keras Callbacks APIs with the help of some examples.", "Please check out my Github repo for source code.", "EarlyStopping is a built-in callback designed for early stopping. First, let\u2019s import it and create an early stopping object:", "EarlyStopping() has a few options and by default:", "Next, we just need to pass the callback object to model.fit() method.", "You can see that early_stopping get passed in a list to the callbacks argument. It is a list because in practice we might be passing a number of callbacks for performing different tasks, for example, debugging and learning rate schedules.", "By executing the statement, you should get an output like below:", "The training gets terminated at Epoch 11 due to the increase of val_loss value and that is exactly the conditions monitor='val_loss' and patience=0.", "It\u2019s often more convenient to look at a plot, let\u2019s run plot_metric(history, 'loss') to get a clear picture. In the below graph, validation loss is shown in orange and it\u2019s clear that validation error increases at Epoch 11.", "Apart from the options monitor and patience we mentioned early, the other 2 options min_delta and mode are likely to be used quite often.", "And here is an example of a customized early stopping:", "monitor='val_accuracy' to use validation accuracy as performance measure to terminate the training. patience=3 means the training is terminated as soon as 3 epochs with no improvement. min_delta=0.001 means the validation accuracy has to improve by at least 0.001 for it to count as an improvement. mode='max' means it will stop when the quantity monitored has stopped increasing.", "Let\u2019s go ahead, run it with the customized early stopping, and plot the accuracy.", "This time, the training gets terminated at Epoch 15 as there are 3 epochs with no improvement on validation accuracy (It has to be \u2265 0.001 to count as an improvement).", "For more about early stopping, please check out this article:", "CSVLogger is a callback that streams epoch results to a CSV file. First, let\u2019s import it and create a CSVLogger object:", "Next, we just need to pass the csv_log object to model.fit() method.", "Once the training is completed, we can view the information in the CSV file", "Apart from the compulsory argument filename, the other 2 options separator and append are likely to be used quite often.", "ModelCheckpoint is a callback to save the Keras model or model weight during training, so the model or weights can be loaded later to continue the training from the state saved.", "First, let\u2019s import it and create a ModelCheckpoint object:", "Next, let\u2019s pass the checkpoint object to model.fit() method for training.", "We should be able to see the above printout during the training.", "Once the training is completed, we can get the test accuracy by running:", "Let\u2019s create a new model new_model to demonstrate how loading weights work. And by running get_test_accuracy(new_model, X_test, y_test), we get the test accuracy 0.086 for a model without loading any trained weights.", "Next, let\u2019s load weights with load_weights('model_checkpoints/') and get its test accuracy again. This time, we should be able to see the same accuracy as we trained the model model .", "Below are the commonly used arguments you should know when using ModelCheckpoint callback", "ReduceLROnPlateau is a callback to reduce the learning rate when a metric has stopped improving. This callback monitors a quantity and if no improvement is seen for a patience number of epochs, the learning rate is reduced by factor value (new_lr = lr * factor). Let\u2019s see how this works with the help of an example.", "First, let\u2019s import it and create a ReduceLROnPlateau object:", "monitor='val_loss' to use validation loss as performance measure to reduce the learning rate. patience=2 means the learning rate is reduced as soon as 2 epochs with no improvement. min_delta=0.001 means the validation loss has to improve by at least 0.001 for it to count as an improvement. factor=0.2 means the new learning rate will be reduced as new_lr = lr * factor.", "Let\u2019s train the model with the reduce_lr callback", "You should get an output like above. In the above output, the ReduceLROnPlateau callback has been triggered at Epoch 30 and 37.", "Let\u2019s plot the learning rate and loss to get a clear picture.", "Below are the commonly used arguments you should know when using ReduceLROnPlateau callback", "When training a neural network, it is often useful to reduce the learning rate as the training progresses. This can be done by using learning rate schedules or adaptive learning rate. LearningRateScheduler is a built-in callback for learning rate schedules.", "For more details about learning rate schedules, please check out the following article:", "Let\u2019s see how LearningRateScheduler works with the help of an example.", "First, let\u2019s import it and create a schedule function:", "lr_decay() takes 2 arguments epoch (current epoch) &lr( current learning rate), and returns a new learning rate. Ourlr_decay() function will reduce the learning rate by a factor of 0.2 in every 5 epochs.", "Let\u2019s train the model with the reduce_lr callback", "You should get an output like above. And below is the plot of the learning rate.", "Another useful callback is LambdaCallback. It is similar to Callback and allows us to build custom callbacks on-the-fly.", "LambdaCallback is constructed with the following anonymous functions that will be called at the appropriate time.", "Note that the callbacks expect positional arguments, as:", "Let\u2019s see how LambdaCallback works with the help of an example.", "First, let\u2019s import it and create 3 different LambdaCallback:", "Let\u2019s train the model with above callbacks", "You should get an output like above. This is very useful", "Along with the above functions, there are other callbacks that you might encounter or want to use in your Deep Learning project:", "Thanks for reading. This article has covered the most popular Keras Callbacks.", "Please check out the notebook for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "More can be found from my Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F705d0c584966&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----705d0c584966--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----705d0c584966--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----705d0c584966--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----705d0c584966--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----705d0c584966---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F705d0c584966&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F705d0c584966&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.canva.com", "anchor_text": "www.canva.com"}, {"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "anchor_text": "learning rate schedules"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "my Github repo"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd", "anchor_text": "early stopping"}, {"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "anchor_text": "learning rate schedules"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd", "anchor_text": "A Practical Introduction to Early Stopping in Machine LearningA step to step tutorial to add and customize Early Stopping with Keras and TensorFlow 2.0towardsdatascience.com"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "anchor_text": "Learning Rate Schedule in Practice: an example with Keras and TensorFlow 2.0One of the painful things about training a neural network is the sheer number of hyperparameters we have to deal with\u2026towardsdatascience.com"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/007-keras-callback/keras-callbacks.ipynb", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "anchor_text": "Learning Rate Schedules in practice"}, {"url": "https://towardsdatascience.com/the-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77", "anchor_text": "The Google\u2019s 7 steps of Machine Learning in practice: a TensorFlow example for structured data"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a Machine Learning Model with Keras and TensorFlow 2.0"}, {"url": "https://towardsdatascience.com/batch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f", "anchor_text": "Batch normalization in practice: an example with Keras and TensorFlow 2.0"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd", "anchor_text": "Early stopping in Practice: an example with Keras and TensorFlow"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----705d0c584966---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----705d0c584966---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----705d0c584966---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----705d0c584966---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/callback?source=post_page-----705d0c584966---------------callback-----------------", "anchor_text": "Callback"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F705d0c584966&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&user=B.+Chen&userId=563d09da62a&source=-----705d0c584966---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F705d0c584966&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&user=B.+Chen&userId=563d09da62a&source=-----705d0c584966---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F705d0c584966&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----705d0c584966--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F705d0c584966&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----705d0c584966---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----705d0c584966--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----705d0c584966--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----705d0c584966--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----705d0c584966--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----705d0c584966--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----705d0c584966--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----705d0c584966--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----705d0c584966--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}