{"url": "https://towardsdatascience.com/magic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f", "time": 1683009182.4858181, "path": "towardsdatascience.com/magic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f/", "webpage": {"metadata": {"title": "Magic: the Gathering \u2014 Leveraging Neural Nets in Art Direction | by Ruslan Askerov | Towards Data Science", "h1": "Magic: the Gathering \u2014 Leveraging Neural Nets in Art Direction", "description": "Magic: The Gathering (known as \u201cMagic\u201d or \u201cMTG\u201d) is the world\u2019s oldest trading card game and its publishing company, Wizards of the Coast (WotC), is one of the largest commissioners of fantasy art in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://magic.wizards.com/en", "anchor_text": "Magic: The Gathering", "paragraph_index": 0}, {"url": "https://scryfall.com/docs/api", "anchor_text": "Scryfall API", "paragraph_index": 3}, {"url": "https://datascience.virginia.edu/", "anchor_text": "University of Virginia\u2019s School of Data Science", "paragraph_index": 14}], "all_paragraphs": ["Magic: The Gathering (known as \u201cMagic\u201d or \u201cMTG\u201d) is the world\u2019s oldest trading card game and its publishing company, Wizards of the Coast (WotC), is one of the largest commissioners of fantasy art in the world. Over the past 26 years, WotC has commissioned thousands of pieces of original art, which have found a home in over 20,000 unique cards. Each card can have multiple printings in multiple languages, which creates a global ecosystem of fantasy art.", "Magic cards have overarching classifiers associated with their gameplay mechanics. The primary seven types are Artifact, Creature, Enchantment, Land, Planeswalker, Instant and Sorcery. Virtually every printed card can be classified into at least one of these types. With its 26 year history, Magic has developed a distinct aesthetic that separates it from other card games. Each new card needs to somehow fit into this aesthetic and capture the card\u2019s gameplay. When an artist receives a WotC commission, they are assigned to create art for a specific card printing. This commission begins with a design brief, which includes a description of the card\u2019s gameplay, proposed art depiction, color palette, previous references, and card type. Artists have a degree of creative freedom, but are generally expected to stick close to the design brief. Once the artist has finished their sketches, they will send their draft pieces to the art director for feedback and revisions. The less feedback WoTC provides, the more time the artist has to work on their piece before printing- which typically leads to higher quality pieces.", "To help the artist community better meet the demands of the WotC, our goal is to use a CNN model to categorize any piece into one of the seven types mentioned above. If the likelihood of a draft image belonging to the briefing type (or any type) is low, the artist would know more work is needed before waiting for WotC to reject or accept his/her work. In other words, a CNN could supplement the first touchpoint between the artist and art director. If utilized at the right time in the design process, image classification could lead to a reduction of feedback cycles, providing the artist more time to create high-quality Magic art.", "Throughout Magic\u2019s history, many tools have been designed to help community members analyze cards and build decks. Using the Scryfall API, we were able to pull the entire catalog of Magic cards & corresponding art. Scryfall Card Objects include art redirects and type identities. The JPG files form the basis of our explanatory variable while the card type is our response variable. After organizing the JPG card files into their respective types, we split each type into training and test sets using a 90:10 split (Table 1). Certain types of cards were removed from the training data, including split cards and flip cards. These cards had two types of art, making them difficult to classify into a single class. Cards with multiple primary types, such as Artifact Creatures, were relabeled as one primary type, based on the most appropriate art direction. As an example, an art director would emphasize Artifact over Creature in the Artifact Creature dual type.", "Using the Scryfall API, we use the card name, oracle text, and flavor text as the explanatory variables and the same creature types as with image classification. Oracle text explains the abilities of the card in question, if any, and the flavor text is merely there for additional worldbuilding flair. Many cards will not have any text in oracle text or flavor text but every card has a name. The card types are often referenced in the oracle text, but in ways that are not always indicative of the card type itself. The text was only minimally preprocessed \u2014 all input tokens were converted to lower case letters.", "For this model, we train on 20,000 cards and validate on 5,734 cards [link to Eric\u2019s drive], with the validation set consisting of the newest released cards in the game.", "For our image recognition model with CNN, we decided to go with the option of transfer learning. This is because we have a limited number of images to work with and publicly available models such as ImageNet have been trained with millions of data points. For our first model, we built it on top of VGG-16 (Simonyan, Karen & Zisserman, Andrew. (2014). Very Deep Convolutional Networks for Large-Scale Image Recognition. arXiv 1409.1556.) We tried retraining the last four layers of the model and decided to retrain the last two layers which yielded the highest accuracy. On top of VGG, we added a flattening layer, dense layer with relu activation, a dropout layer, and another dense layer with softmax activation for classification. Images were resized to 224 x 224 x 3 and the batch size was 16 for both train and validation sets.", "The biggest problem that we experienced with VGG was the training speed. It took approximately three hours to train one epoch of the model. For our second model, we decided to proceed with InceptionV3 (Szegedy, Vanhoucke, Ioffe, Schlens, Wojna, 2015). It yielded approximately the same accuracy, but the time decreased from three to one hour per epoch. We kept all other parameters the same; we retrained the last two layers, added a flattening layer, a dense layer with relu activation, a dropout layer and finally, another dense layer with softmax activation.", "Here we use a model with two LSTM layers and a learned embedding layer, all with output dimensionality of 10. We use dropout and recurrent dropout with a rate of 0.3, as well as kernel L2-regularization with a weight of 0.01. This lightweight model architecture trains very quickly with 100 training epochs taking about 1\u20132 hours on CPU achieving 72% prediction accuracy on the validation set. The LSTM architecture was chosen from a few simple language model architectures including simple RNN and was chosen for having the best performance after 10 epochs of training.", "Our goal is to provide artists confidence that their sketches meet the WotC standards. We analyzed our model performance by considering both a validation set and human expertise. On the model performance, \u2014 our first model, VGG, yielded a 55% validation accuracy which was the maximum accuracy from the second epoch. There is a sign of overfit, leading to increasing training accuracy while validation accuracy stays about the same. The Inception model yielded the same 55% validation accuracy but, as was mentioned before, improved the training speed three-fold. Both models show signs of a very significant overfitting. Due to this, we decided to implement regularization methods. We use 30% dropout rate and L1 regularization. Implementation of these techniques helped reduce the overfitting, but did not eliminate it entirely. We asked several Magic players to categorize the following four cards with varying degrees of success. As you can see, some of these images are challenging to classify.", "For a comparison to human expertise, we compared our model performance to an experienced Magic player. The holdout data came from an upcoming set that both the player and CNN had not seen. Based on the confusion matrices shown in Table 2, the model had an overall accuracy rate of 59% vs. 76% for human classification (Table 2 & Table 3). One area where the model failed to correctly identify a single card is Artifact. Meanwhile, the player was observed to have superior type identification across all potential categories.", "The LSTM model achieves 73% validation accuracy after 100 epochs of training. The model struggles to identify sorceries, often confusing them for instants. Similarly, the model is challenged by artifacts and enchantments, often mistaking both of these for creatures. For the confusion matrix from the final LSTM model on the validation set, see Table 4. For a chart showing the training and validation accuracy of the LSTM model over the 100 epochs of training, see Figure 1.", "Confusion Matrix for LSTM model on validation set of 5700 most recent cards", "We observed that our model could reasonably identify creature art, but failed to exhibit similar levels of performance with other card types. This was expected, given the data that we trained on. 42% of all Magic cards fall into the creature classifier. Possibilities that we would consider for future models would be to deliberately undersample creatures, train a model without any creatures, or augmenting the training data of non-creature types. We would want to increase the classification accuracy of non-creatures, which would improve the model performance as a whole. The immediate goal would be to meet a 70\u201375% accuracy rate, which we found to be the range of all experienced Magic players we tested.", "This article resulted from our machine learning project at University of Virginia\u2019s School of Data Science.", "Falomir, Zoe, Lled\u00f3 Museros Cabedo, Ismael Sanz and Luis Gonz\u00e1lez Abril. \u201cCategorizing paintings in art styles based on qualitative color descriptors, quantitative global features and machine learning (QArt-Learn).\u201d Expert Syst. Appl. 97 (2018): 83\u201394.", "Zilio, Felipe, Marcelo O. R. Prates and Lu\u00eds C. Lamb. \u201cNeural Networks Models for Analyzing Magic: the Gathering Cards.\u201d ICONIP (2018).", "Christian Szegedy, Vincent Vanhoucke, Sergey Ioffe, Jonathon Shlens, Zbigniew Wojna. Rethinking the Inception Architecture for Computer Vision (2015)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe2d852d6d89f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@asker4ik?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@asker4ik?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": "Ruslan Askerov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F891fe6b211cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&user=Ruslan+Askerov&userId=891fe6b211cd&source=post_page-891fe6b211cd----e2d852d6d89f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe2d852d6d89f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe2d852d6d89f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://magic.wizards.com/en", "anchor_text": "Magic: The Gathering"}, {"url": "https://scryfall.com/docs/api", "anchor_text": "Scryfall API"}, {"url": "https://datascience.virginia.edu/", "anchor_text": "University of Virginia\u2019s School of Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e2d852d6d89f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/magic-the-gathering?source=post_page-----e2d852d6d89f---------------magic_the_gathering-----------------", "anchor_text": "Magic The Gathering"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e2d852d6d89f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----e2d852d6d89f---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/convolutional-neural-net?source=post_page-----e2d852d6d89f---------------convolutional_neural_net-----------------", "anchor_text": "Convolutional Neural Net"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe2d852d6d89f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&user=Ruslan+Askerov&userId=891fe6b211cd&source=-----e2d852d6d89f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe2d852d6d89f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&user=Ruslan+Askerov&userId=891fe6b211cd&source=-----e2d852d6d89f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe2d852d6d89f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe2d852d6d89f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e2d852d6d89f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e2d852d6d89f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@asker4ik?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@asker4ik?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ruslan Askerov"}, {"url": "https://medium.com/@asker4ik/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F891fe6b211cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&user=Ruslan+Askerov&userId=891fe6b211cd&source=post_page-891fe6b211cd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2979e66ba117&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-the-gathering-leveraging-neural-nets-in-art-direction-e2d852d6d89f&newsletterV3=891fe6b211cd&newsletterV3Id=2979e66ba117&user=Ruslan+Askerov&userId=891fe6b211cd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}