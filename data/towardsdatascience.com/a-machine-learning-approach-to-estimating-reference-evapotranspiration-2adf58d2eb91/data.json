{"url": "https://towardsdatascience.com/a-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91", "time": 1683017625.503975, "path": "towardsdatascience.com/a-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91/", "webpage": {"metadata": {"title": "A Machine Learning Approach to Estimating Reference Evapotranspiration | by Rouhin Mitra | Towards Data Science", "h1": "A Machine Learning Approach to Estimating Reference Evapotranspiration", "description": "Over 70% of the world\u2019s fresh water is used for irrigation and naturally, there is a huge demand for accurate estimates and metrics that could aid sensible water use in the agricultural sector\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.fao.org/3/X0490E/x0490e06.htm", "anchor_text": "Penman-Monteith Equation", "paragraph_index": 2}], "all_paragraphs": ["Over 70% of the world\u2019s fresh water is used for irrigation and naturally, there is a huge demand for accurate estimates and metrics that could aid sensible water use in the agricultural sector.", "Reference evapotranspiration is the evapotranspiration from a hypothetical grass surface with the assumption that the surface is well-irrigated (unlimited water). It is an estimate that is used in irrigation that determines the amount of water required by crops. Since the reference evapotranspiration is a hypothetical concept, it is estimated and not measured.", "The near-surface condition of the air affects this estimate as it depends on many atmospheric variables and essentially, it calculates the evaporative demand of the atmosphere. One of the most common and accurate methods for its estimation is the Penman-Monteith Equation.", "In this article, we use machine learning to predict the reference evapotranspiration in the state of California using in-situ measurements. We initially select 8 features as an input to our model \u2014 average, maximum, and minimum temperature, relative humidity, wind speed, elevation, solar radiation, and a categorical variable to capture the spatial variation in these atmospheric variables.", "We obtained the data from the California Irrigation Management Information System (CIMIS) that has 145 in situ weather stations located across California. These stations are placed on well-watered grass surfaces. Since it measures all parameters required to calculate the reference evapotranspiration, we calculated it using the Penman-Monteith equation and that acts as our response variable.", "The hourly data were averaged to obtain the daily data and only the growing season from April to September for the 5 years (2015\u20132019) was used for the study. The data for every station was stacked to produce 110929 rows of data", "The features chosen for our machine learning model were the atmospheric variables RH, TMAX, TMIN, TAVG, and Wind Speed to consider the conditions of the site and the elevation to accommodate the terrain. However, since in-situ measurements are being used, the dependence of these atmospheric variables on reference evapotranspiration could change based on the location. In California, we may expect stations close to the coast to behave similarly, and to capture this variation in space, k-means clustering was used to group stations with similar atmospheric conditions.", "The features chosen for the k-means clustering were the air temperature, relative humidity, and wind speed. To group similar stations together the above features were averaged for each station for a period of 5 years.", "The number of clusters (k) was chosen based on the following methods: -", "The elbow method shows a break at k=4 and hence we chose 4 clusters to group our stations.", "A silhouette score of 0.36 tells us that the points are not entirely separable based on the features and there is an extent of overlapping. However, we only used 145 data points and used long-term(~5years) averaged values as our features so the variation of the local conditions may not be as distinct as we thought.", "The labels generated from the clustering of the stations were then used in our main dataset to identify similar stations and predict the reference evapotranspiration.", "Additionally, using a random forest regressor model we evaluated the feature importance and ranked them accordingly.", "Solar radiation and the average temperature have the highest feature importance and the rest show relatively lower importance. Also, we want to predict the target value with predictors that are easily available and can be remotely sensed using satellites, and since wind speed is not a very important parameter, we limit ourselves to the following features:", "In our analysis, we used an artificial neural network to predict the reference evapotranspiration. Since most of the features showed some linear relationship with our predictor, we had initially used ridge regression for prediction. We chose ridge regression because some of the features show a strong linear relationship within themselves, for instance, the temperature is linearly related to the humidity. In the presence of multicollinearity in a feature space, ridge regression performs better than linear regression.", "However, since the response function seems to be nonlinear with some of the features a multi-layer perceptron with two hidden layers was used to capture this nonlinearity. Through experimentation, the following architecture produced the best results.", "The feature space contains climatic and geographic variables with different magnitudes and units. Feature scaling helps to normalize the feature space and is essential for MLP as it helps improve the prediction accuracy of our ANN.", "The ReLu function was used as the activation function in our ANN and the goal of this model was to minimize the loss function.", "We also tried ridge regression and random forest.", "Model predictions were compared with the true values and the results show the model can explain 93% of the variability in our predicted values.", "All three models have shown high R\u00b2 values but the ANN performed slightly better than the random forest and the ridge regression model. The errors in the model could be partially attributed to using a limited feature space and excluding the wind speed component. The error for each day(every row) was also plotted against the features to investigate the presence of systematic bias in the model. However, the variation of the errors with the features did not show any bias in predicting the reference evapotranspiration.", "In the future, this model could be improved by the addition of more features such as soil moisture to improve the clustering of the stations based on similar site conditions. It would also be interesting to deploy the model using satellite data instead of in-situ measurements for large scale reference evapotranspiration prediction.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Graduate student interested in terrestrial hydrology. Also loves everything about nature and the outdoors"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2adf58d2eb91&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rouhinmitra.medium.com/?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": ""}, {"url": "https://rouhinmitra.medium.com/?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": "Rouhin Mitra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe51cd14097fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&user=Rouhin+Mitra&userId=e51cd14097fc&source=post_page-e51cd14097fc----2adf58d2eb91---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2adf58d2eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2adf58d2eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@wynand_uys?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Wynand Uys"}, {"url": "https://unsplash.com/s/photos/agriculture-irrigation?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://www.fao.org/3/X0490E/x0490e06.htm", "anchor_text": "Penman-Monteith Equation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2adf58d2eb91---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/hydrology?source=post_page-----2adf58d2eb91---------------hydrology-----------------", "anchor_text": "Hydrology"}, {"url": "https://medium.com/tag/earth-science?source=post_page-----2adf58d2eb91---------------earth_science-----------------", "anchor_text": "Earth Science"}, {"url": "https://medium.com/tag/climate-change?source=post_page-----2adf58d2eb91---------------climate_change-----------------", "anchor_text": "Climate Change"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2adf58d2eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&user=Rouhin+Mitra&userId=e51cd14097fc&source=-----2adf58d2eb91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2adf58d2eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&user=Rouhin+Mitra&userId=e51cd14097fc&source=-----2adf58d2eb91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2adf58d2eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2adf58d2eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2adf58d2eb91---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2adf58d2eb91--------------------------------", "anchor_text": ""}, {"url": "https://rouhinmitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rouhinmitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rouhin Mitra"}, {"url": "https://rouhinmitra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "29 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe51cd14097fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&user=Rouhin+Mitra&userId=e51cd14097fc&source=post_page-e51cd14097fc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6ad50072f03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-machine-learning-approach-to-estimating-reference-evapotranspiration-2adf58d2eb91&newsletterV3=e51cd14097fc&newsletterV3Id=6ad50072f03&user=Rouhin+Mitra&userId=e51cd14097fc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}