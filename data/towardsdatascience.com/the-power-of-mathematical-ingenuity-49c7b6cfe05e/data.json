{"url": "https://towardsdatascience.com/the-power-of-mathematical-ingenuity-49c7b6cfe05e", "time": 1683002492.476563, "path": "towardsdatascience.com/the-power-of-mathematical-ingenuity-49c7b6cfe05e/", "webpage": {"metadata": {"title": "The Power of Mathematical Ingenuity | by Anand P V | Towards Data Science", "h1": "The Power of Mathematical Ingenuity", "description": "\u201cGone are the days of pure mathematical approaches to solve a vision problem, now that AI has made its foray\u201d \u2014 this could be one of the most misleading thoughts of a Deep Learning practitioner\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/AdroitAnandAI/Computer-Vision-Math-Magic-vs-AI", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/AdroitAnandAI/Computer-Vision-Math-Magic-vs-AI", "anchor_text": "here", "paragraph_index": 51}, {"url": "https://www.linkedin.com/in/ananduthaman/", "anchor_text": "here", "paragraph_index": 53}], "all_paragraphs": ["\u201cGone are the days of pure mathematical approaches to solve a vision problem, now that AI has made its foray\u201d \u2014 this could be one of the most misleading thoughts of a Deep Learning practitioner, oblivious of traditional computer vision techniques. If you are one among, then here is an attempt to make you think again.", "Many of the computer vision algorithms \u201crunning on the edge\u201d, use traditional math, rather than compute and memory intensive neural nets. Consider, we have scanned images containing textual content. Lets keep AI aside and address classical problems in scanned images, viz. skew-ness, rotation and text inversion, deterministically. Feature matching & object search are also taken up using math-magic, to motivate you further.", "The source code of all the below case studies can be found here.", "To identify inversion of text font from images is a daunting task. Inversion can happen when the document is scanned upside-down. The document can become inverted, even after rotation or skew correction, as rotation of 90+\u0398 is detected as 90-\u0398, or -90-\u0398 as -90+\u0398. Thus, text inversion is a common problem, but is challenging to recognize.", "Lets see how to mathematically formulate inversion.", "2. Convolve with a Gaussian filter to smooth the noise.", "3. Calculate the fraction of peaks (lines) with sub-peaks on the right side.", "Below is a figure to illustrate the approach", "The above method will not work if the text is in CAPITAL letters or in some other language, as the \u201cdouble peak logic\u201d would likely falter.", "Another numerical way to address the problem is to make use of the font shape, such as \u2018Water Fill Technique\u2019 [1] or to mathematically represent the character shape, as given below. We can describe any shape mathematically using shape context and log-bin histograms. Such attempts demonstrate \u201cmathematical ingenuity\u201d as an efficient solution to variety of problems.", "Method 2: Shape Contexts using Log-Bin Histograms", "a. Find text bounding boxes from images using EAST. {below}", "b. Crop image inside bounding box and apply Canny edge detection.", "c. Take a dummy image with alphanumeric as base input. Find bounding boxes around each character in base input and image from step (b). Do steps {d}-{h} to find best correspondence between character pairs.", "d. Randomly sample N points from edge elements of each character shape.", "e. Construct a new shape descriptor \u2014 shape context. The shape context at a point captures the distribution over relative positions of other shape points and thus summarizes global shape.", "f. Compare the log-polar histograms using Pearson\u2019s chi-squared test or cosine distance.", "h. Find the numeral with minimum distance for each bounding box in base image. Sum up the cost values of each bounding box to find Sigma( \u03a6).", "i. Invert cropped image from step (b) and do steps {d}-{h} to compute Sigma( \u03a6\u2019). Compare the Sigma values to know text inversion.", "EAST (An Efficient and Accurate Scene Text Detector)", "The textual content inside an image can be localized using EAST algorithm.", "Here again, we can use a math-hack to localize text in an image, instead of using AI-based EAST algorithm. You can find consecutive local minima of y-projections of pixels to find consecutive trough that corresponds to line separation in an image. Once a line is found, you can run method 2, starting from step (b).", "The above method would work irrespective of font case or language.", "Most of the scanned documents are skewed. Thus, it is required to de-skew the image before feeding an OCR or even to display.", "2. Compute projection of all pixels on y-axis.", "3. Calculate the pixel incidence density.", "4. Step the rotation angle by 0.5 angles and repeat steps 2, 3", "5. Find the angle \u0398 with maximum pixel incidence density.", "The drawbacks of the above algorithm are:", "a. Iterative computation increases time complexity.", "b. Potential error of 0.5 degrees due to step size.", "Mostly, scanned document would be of form format or tabular data containing lines or point spread of lines (lines can be disjoint in scanned image, due to lack of scan or print quality). Hence, the question boils down to \u201cwhether we can compute the line and \u0398, given a point spread as input?\u201d", "2. Hough Space = Call Hough_Transform (Edge Detected Image)", "3. Find the maxima in Hough space transform (accumulator matrix)", "4. Find \u0398 of the significant lines using tangent of slope", "5. Calculate median of slopes, \u0398\u2019", "6. Rotate the image by \u0398\u2019", "The sine curve voting array in hough space can be visualized as below.", "Please note the accuracy at which skew angle is computed for the above image. In iterative approach, error of angle \u0398 could be[Step Size/2], not to mention the huge iterative computation cost.", "Note: If the scanned document doesn\u2019t contain point spread of lines in your case, then run the above PEAK algorithm to find bounding boxes around text. Angle \u0398 of horizontal edge of bounding box corresponds to skew-ness.", "Rotation is a common problem in scanned images. The document can be rotated 90\u00b0 or more, while being scanned.", "It is possible to classify the images into 4 quadrants using a CNN model like below. But why to load NNs, when you can solve it arithmetically? Moreover, even after quadrant rotation, the image can remain skewed.", "You can use the above skew correction code to find \u0398 and rotate. The only drawback is, rotation of 90+\u0398 could be detected as 90-\u0398, and -90-\u0398 as -90+\u0398. Hence, the image can get flipped, once you rotate!", "Solution: To solve the above problem, just pass the de-skewed image to the text inversion code and flip it upright, if deemed necessary.", "Let\u2019s say you want to find an object (template) inside a bigger image with multiple objects. We can use Object detection models like SSD or YOLO with annotated Query Images to train different classes of objects to be found. But how do we use simple math to find and locate an object in a bigger image?", "We can use homography to find point correspondences and transform the coordinates from one perspective to another. Homography is a transformation ( 3\u00d73 matrix ) that maps the points in one image to the corresponding points in the other image.", "These are the steps you can follow.", "Let\u2019s say, you need to find an object from a set of images. You can use an AI model, as it is a classic case of image classification. But, can we use traditional math to do this? Here\u2019s how\u2026", "Above equation conceptually formulates correlation as the similarity in deviation around mean. Thus, numerator signifies distribution similarity and denominator quantifies L2-norm for normalization.", "Please note that a different car (purple) with similar shape has the second nearest match value, right after the red car. The correlation distance to other shapes are distinctively more. Thus you can see shape matching is functional.", "Please note the correlation values will not be 0, even for same images, as random sampling of points is done to describe shapes. There are other ways to describe shapes without random sampling but time complexity of shape matching would become an order higher. One such method, known as Turning Function, is depicted below.", "The source code of all the above case studies can be found here.", "From the above case studies, you can see that the deterministic solutions can be more accurate and less compute intensive than iterative or AI-based solutions. While AI can outperform in many complex tasks, it is prudent to try out math-based solutions and keep AI as a last resort. You don\u2019t need a sledgehammer to crack a nut. If the above read motivated you to appreciate the beauty of traditional techniques then it has served the purpose.", "If you have any query or suggestion, you can reach me here", "[1] Inversion Detection in Text Document Images. Hamid Pilevar, A. G. Ramakrishnan, Medical Intelligence and Language Engineering Lab, Department of Electrical Engineering, Indian Institute of Science, Bangalore (JCIS 2006)", "[2] Shape Context: A new descriptor for shape matching and object recognition. Serge Belongie, Jitendra Malik and Jan Puzicha. Department of Electrical Engineering and Computer Sciences, University of California at Berkeley (NIPS 2000)", "[3] Shape Matching and Object Recognition Using Shape Contexts. Serge Belongie, Jitendra Malik and Jan Puzicha. Computer Science Division, University of California at Berkeley (PAMI 2002)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI / ML R&D Specialist, KLA-Tencor | CSE, IIT B Alumnus | Ex-Vice President \u2014 AI & DS, IIA | Ex-TSMC | Reached interview twice for IAS | AI Consultant & Mentor"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F49c7b6cfe05e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://anandai.medium.com/?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": ""}, {"url": "https://anandai.medium.com/?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": "Anand P V"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc093ed453e2c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&user=Anand+P+V&userId=c093ed453e2c&source=post_page-c093ed453e2c----49c7b6cfe05e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F49c7b6cfe05e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F49c7b6cfe05e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/AdroitAnandAI/Computer-Vision-Math-Magic-vs-AI", "anchor_text": "here"}, {"url": "https://www.pyimagesearch.com/2018/09/17/opencv-ocr-and-text-recognition-with-tesseract/", "anchor_text": "Courtesy"}, {"url": "https://github.com/AdroitAnandAI/Computer-Vision-Math-Magic-vs-AI", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/ananduthaman/", "anchor_text": "here"}, {"url": "https://medium.com/machine-learning-world/shape-context-descriptor-and-fast-characters-recognition-c031eac726f9", "anchor_text": "https://medium.com/machine-learning-world/shape-context-descriptor-and-fast-characters-recognition-c031eac726f9"}, {"url": "https://stackoverflow.com/questions/55654142/detect-if-a-text-image-is-upside-down", "anchor_text": "https://stackoverflow.com/questions/55654142/detect-if-a-text-image-is-upside-down"}, {"url": "https://github.com/argman/EAST", "anchor_text": "https://github.com/argman/EAST"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----49c7b6cfe05e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----49c7b6cfe05e---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----49c7b6cfe05e---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----49c7b6cfe05e---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----49c7b6cfe05e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F49c7b6cfe05e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&user=Anand+P+V&userId=c093ed453e2c&source=-----49c7b6cfe05e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F49c7b6cfe05e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&user=Anand+P+V&userId=c093ed453e2c&source=-----49c7b6cfe05e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F49c7b6cfe05e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F49c7b6cfe05e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----49c7b6cfe05e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----49c7b6cfe05e--------------------------------", "anchor_text": ""}, {"url": "https://anandai.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anandai.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anand P V"}, {"url": "https://anandai.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "233 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc093ed453e2c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&user=Anand+P+V&userId=c093ed453e2c&source=post_page-c093ed453e2c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdc22cac35dc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-mathematical-ingenuity-49c7b6cfe05e&newsletterV3=c093ed453e2c&newsletterV3Id=dc22cac35dc6&user=Anand+P+V&userId=c093ed453e2c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}