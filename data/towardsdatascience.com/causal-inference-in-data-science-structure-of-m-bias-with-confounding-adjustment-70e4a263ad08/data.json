{"url": "https://towardsdatascience.com/causal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08", "time": 1683018159.096111, "path": "towardsdatascience.com/causal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08/", "webpage": {"metadata": {"title": "Causal Inference in Data Science: Structure of M-Bias with Confounding Adjustment | by Andrew Rothman | Towards Data Science", "h1": "Causal Inference in Data Science: Structure of M-Bias with Confounding Adjustment", "description": "Causal Inference is a field that touches several domains and is of interest to a wide range of practitioners including Statisticians, Data Scientists, Machine Learning Scientists, and other\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/efficient-sampling-frameworks-in-causal-inference-data-science-52ad44e15f48", "anchor_text": "Efficient Sampling Designs in Causal Inference", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/doubly-robust-estimators-for-causal-inference-in-statistical-estimation-3c00847e9db", "anchor_text": "Doubly Robust Estimation Techniques", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/causal-inference-in-data-science-g-estimation-of-structural-nested-models-d11b1e3c9360", "anchor_text": "G-Estimation of Structural Nested Models", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/causal-inference-in-data-science-a-b-testing-and-the-need-for-marginal-structural-modeling-b9ab299681bb", "anchor_text": "Marginal Structural Modeling for informative censoring adjustment in randomized A/B Tests", "paragraph_index": 0}, {"url": "https://github.com/atrothman/M-Bias", "anchor_text": "github link", "paragraph_index": 37}, {"url": "https://mitpress.mit.edu/books/probabilistic-graphical-models", "anchor_text": "Probabilistic Graphical Models: Principles and Techniques", "paragraph_index": 41}, {"url": "http://www.linkedin.com/in/andrew-rothman-49739630", "anchor_text": "LinkedIn", "paragraph_index": 42}, {"url": "https://anr248.medium.com/", "anchor_text": "follow me here on Medium", "paragraph_index": 42}], "all_paragraphs": ["Causal Inference is a field that touches several domains and is of interest to a wide range of practitioners including Statisticians, Data Scientists, Machine Learning Scientists, and other Computational Researchers. Recovery of unbiased estimates of Causal Effects is at times a tough task, particularly in non-randomized settings. I have written several technical pieces on leveraging G-Methods for necessary adjustment to recover causal inferences/contrasts of interests; these include pieces on Efficient Sampling Designs in Causal Inference, Doubly Robust Estimation Techniques, G-Estimation of Structural Nested Models, and Marginal Structural Modeling for informative censoring adjustment in randomized A/B Tests.", "This piece is a bit shorter, but touches on an important topic. Specifically, we will discuss the structure and issues of \u201cM-Bias\u201d, and how confounding identification is technically unverifiable using empirical analysis alone.", "The contents of this piece are as follows:", "Let us postulate a simple toy example:", "We have binary Intervention A with support {0,1}, a continuous Outcome Y, and we are working in an observational (i.e. non-randomized) setting. We would like to recover an unbiased estimate of the Mean Causal Effect Difference of Intervention A on Outcome Y.", "We want to check if there is \u201cconfounding\u201d by binary variable L. As per empirical analysis of our dataset, we would like to \u201cprove\u201d that L is in-fact a confounder of the A-Y causal relationship. And after proving L is in-fact a confounder, we can adjust for L in our analysis to recover an unbiased estimate of the Mean Causal Effect of A on Y.", "As per the \u201ctraditional\u201d definition of confounding, a variable L is a confounder of the Intervention-Outcome relationship if it meets the following three criteria:", "We would like to confirm the following three criteria in our dataset empirically:", "Given we have empirically confirmed the three criteria above, we can now specify the causal structure of our problem. We have \u201cproven\u201d that the true causal structure is specified by the Causal Directed Acyclic Graph (DAG) shown below in Figure 1:", "Given the established Causal DAG in Figure 1, we would like to recover an unbiased estimate of the Mean Causal Effect of Intervention A on Outcome Y. In the marginal DAG, there is an open back-door associational path A <- L -> Y, meaning we need to \u201cadjust\u201d for L.", "Is there possibly something amiss here??", "So what is the issue with our analysis in Section 2? Well, it turns out, the structure of our problem is in-truth different than we thought. Figure 2 below shows the true causal structure of our problem:", "In the Causal DAG in Figure 2, variables U1 and U2 are unmeasured (we do not have access to them in our dataset). And importantly, it\u2019s evident that variable L is not a \u201cconfounder\u201d of the A-Y relationship even though L meets all three criteria specified in the previous section. It turns out the three criteria listed in Section 2 are not sufficient to guarantee a variable is a \u201cconfounder\u201d.", "In Figure 2 variable L is a \u201ccollider\u201d between unmeasured variables U1 and U2, and there is no open back-door associational path from A to Y in the marginal Causal DAG. Rather A and Y are marginally d-separated. The causal structure presented in Figure 2 is referred to as M-Bias in the academic literature.", "Given A and Y are marginally d-separated, the marginal effect estimate of A on Y recovers an unbiased estimate of the Causal Effect Difference of A on Y.", "And importantly, what would happen if we were to condition on L? Again, given the Causal DAG in Figure 2, L is a collider between unmeasured variables U1 and U2. If we were to condition on L, we would be opening an associational backdoor path from A to Y via A <- U2 -> [L] <- U1 -> Y. Implicitly this is a form of selection bias. Therefore, not only is there not confounding by L, but conditioning on L would cause bias (i.e. selection bias) in our analysis, not prevent it.", "When presenting a Causal DAG visually, I like to rank order my variables in the graph from left to right in the order said variables occur in time. This is simply a preference of mine; I find Causal DAGs drawn in this manner easier to analyze and understand. However, because in a Causal DAG the direction of causality between any two variables is already mathematically encoded in the direction of the edge (i.e. arrow) between them, rank-ordering the variables visually in their causal-order is not required.", "In the academic literature, it is far more common to see the Causal DAG in Figure 2 visually presented as the figure to the bottom right:", "The two Causal DAGs shown above are one in the same. Given the clear \u201cM structure\u201d of the figure on the right above, the origins of the name M-Bias are hopefully clear.", "Let\u2019s recap where we are. In Section 2, we performed a small empirical \u201cexploration\u201d of our dataset in an attempt to determine the causal structure of our problem. We determined variable L was a \u201cconfounder\u201d and needed to be \u201cadjusted\u201d for. However, in Section 3 we revealed that our understanding of the causal structure from Section 2 was incorrect. Variable L is in-fact not a confounder, and given the true Causal DAG in Figure 2, \u201cadjusting\u201d for L would cause bias in our analysis (i.e. selection bias), not prevent it.", "So what is the takeaway message here? The lesson is that empirical analysis of our sample data cannot alone definitively reveal the \u201ctrue\u201d causal structure of a problem with certainty. Rather our understanding of the causal structure should be supplemented with subject-matter domain knowledge. The small \u201cexploration\u201d analysis we conducted in Section 2 is a mini-example of a process called \u201cCausal Discovery\u201d, a topic I plan on writing a detailed piece about in the future. In short, Causal Discovery is hard. Very hard in fact. It relies on quite a number of empirical assumptions that are often untestable and/or unverifiable. M-Bias is but one example that throws a wrench into most Causal Discovery techniques.", "In short, in the interest of recovering an unbiased estimate of the causal effect of an Intervention on an Outcome in a non-randomized setting, when determining if a variable should be \u201cadjusted for\u201d it is important to also lean on domain and subject-matter expertise to inform the specification of the causal structure of a problem, and not rely on blind empirical analysis of the sample data alone.", "We\u2019re going to conduct a computational simulation in Python to investigate the M-Bias causal structure discussed in this piece. We will:", "Specify a function to simulate a dataset as the per the Causal DAG specified in Figure 2 above with the Causal Effect Difference of A on Y being null:", "Let\u2019s print the first few observations of our simulated dataset:", "Given we simulated our dataset with this toy example, we are in the unique position of having access to all of the data, included unmeasured variables U1 and U2. In a real-world analysis, we would be blind to said data.", "Let\u2019s look at what our dataset looks like if we were conducting this analysis in the \u201creal-world\u201d:", "In terms of the three \u201cclassical\u201d confounder criteria, we know that variable L was collected and occurs in time before Intervention A occurred. Therefore L cannot be a downstream consequence of A.", "Let\u2019s show L is associated with Intervention A:", "In the fit logistic regression model above, the coefficient estimate for the L term is 1.597 with 95% CI (1.58 , 1.61). There is ample empirical evidence that L is indeed marginally associated with Intervention A.", "Lastly, let\u2019s show L is associated with Outcome Y conditional on Intervention A:", "In the fit OLS regression model above, the coefficient estimate for the L term is 2.198 with 95% CI (2.19 , 2.21). There is ample empirical evidence that L is indeed associated with Outcome Y conditional on Intervention A.", "However, look at the coefficient estimate for the Intervention A term above, which should be our \u201cunbiased\u201d estimate of the Mean Causal Difference of Intervention a=1 and a=0 on Outcome Y. The Mean Causal Difference is estimate to be -0.445 with 95% CI (-0.454 , -0.435). Given we simulated our dataset, we know that this result is incorrect, and the true Causal Difference is null.", "Given the Causal DAG in Figure 2, and that Intervention A and Outcome Y are marginally d-separated, let us recover an estimate of the marginal effect of A on Y:", "In the fit OLS regression model above, the coefficient estimate for the A term is 0.0056 with 95% CI (-0.004 , 0.015). This is in fact, an unbiased estimate for the Mean Causal Effect Difference of Intervention A on Outcome Y (i.e. a null effect).", "Let\u2019s again repeat the analysis, but with a simulated dataset where the Mean Causal Effect Difference of A on Y is 1.62:", "We again see that the marginal effect estimate of A on Y correctly recovers an unbiased estimate of the Mean Causal Effect Difference of A on Y (1.623 , 95% CI (1.614 , 1.633)), while the effect estimate of A on Y conditional on L returns a biased estimate of the Mean Causal Effect Difference of A on Y (1.175 , 95% CI (1.165 , 1.185)).", "For the complete code/notebook for the above computational simulation, please see the following github link.", "This concludes our explanation and working example of M-Bias in Causal Inference, and the challenges it presents with regards to confounding identification. As mentioned, M-Bias is but one potential issue that makes empirical Causal Discovery very challenging. In a future piece, I will delve into methods for Causal Discovery in great detail.", "I would also encourage anyone who found the above material insightful to create there own simulation examples, leverage my code as a starting point, and experiment on your own!", "If you would like to learn more about methods and considerations for Causal Inference, I would suggest textbooks \u201cCausal Inference: What If\u201d by Miguel Hernan and Jamie Robins at Harvard (two of my former Professors), \u201cCausality\u201d by Judea Pearl at UCLA, and \u201cProbabilistic Graphical Models: Principles and Techniques\u201d by Daphne Killer at Stanford and Nir Friedman at Hebrew University of Jerusalem. These are all fantastic texts. I plan on writing more in-depth pieces on Causal Inference in the future.", "Probabilistic Graphical Models: Principles and Techniques", "I hope the above is insightful. As I\u2019ve mentioned in some of my previous pieces, it\u2019s my opinion not enough folks take the time to go through these types of exercises. For me, this type of theory-based insight leaves me more comfortable using methods in practice. A personal goal of mine is to encourage others in the field to take a similar approach. I\u2019m planning on writing based pieces in the future, so feel free to connect with me on LinkedIn, and follow me here on Medium for updates!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Principal Data/ML Scientist @ The Cambridge Group | Harvard trained Statistician and Machine Learning Scientist | Expert in Statistical ML & Causal Inference"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F70e4a263ad08&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://anr248.medium.com/?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": ""}, {"url": "https://anr248.medium.com/?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": "Andrew Rothman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4688574fc42a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&user=Andrew+Rothman&userId=4688574fc42a&source=post_page-4688574fc42a----70e4a263ad08---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70e4a263ad08&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70e4a263ad08&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://unsplash.com/@goshua13?utm_source=medium&utm_medium=referral", "anchor_text": "Joshua Aragon"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/efficient-sampling-frameworks-in-causal-inference-data-science-52ad44e15f48", "anchor_text": "Efficient Sampling Designs in Causal Inference"}, {"url": "https://towardsdatascience.com/doubly-robust-estimators-for-causal-inference-in-statistical-estimation-3c00847e9db", "anchor_text": "Doubly Robust Estimation Techniques"}, {"url": "https://towardsdatascience.com/causal-inference-in-data-science-g-estimation-of-structural-nested-models-d11b1e3c9360", "anchor_text": "G-Estimation of Structural Nested Models"}, {"url": "https://towardsdatascience.com/causal-inference-in-data-science-a-b-testing-and-the-need-for-marginal-structural-modeling-b9ab299681bb", "anchor_text": "Marginal Structural Modeling for informative censoring adjustment in randomized A/B Tests"}, {"url": "https://github.com/atrothman/M-Bias", "anchor_text": "github link"}, {"url": "https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/", "anchor_text": "Causal Inference: What If"}, {"url": "http://bayes.cs.ucla.edu/BOOK-2K/", "anchor_text": "Causality"}, {"url": "https://mitpress.mit.edu/books/probabilistic-graphical-models", "anchor_text": "Probabilistic Graphical Models: Principles and Techniques"}, {"url": "http://www.linkedin.com/in/andrew-rothman-49739630", "anchor_text": "LinkedIn"}, {"url": "https://anr248.medium.com/", "anchor_text": "follow me here on Medium"}, {"url": "https://medium.com/tag/data-science?source=post_page-----70e4a263ad08---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----70e4a263ad08---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----70e4a263ad08---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----70e4a263ad08---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----70e4a263ad08---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70e4a263ad08&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&user=Andrew+Rothman&userId=4688574fc42a&source=-----70e4a263ad08---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70e4a263ad08&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&user=Andrew+Rothman&userId=4688574fc42a&source=-----70e4a263ad08---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70e4a263ad08&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F70e4a263ad08&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----70e4a263ad08---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----70e4a263ad08--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----70e4a263ad08--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----70e4a263ad08--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----70e4a263ad08--------------------------------", "anchor_text": ""}, {"url": "https://anr248.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anr248.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrew Rothman"}, {"url": "https://anr248.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4688574fc42a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&user=Andrew+Rothman&userId=4688574fc42a&source=post_page-4688574fc42a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9aece5122d3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcausal-inference-in-data-science-structure-of-m-bias-with-confounding-adjustment-70e4a263ad08&newsletterV3=4688574fc42a&newsletterV3Id=9aece5122d3b&user=Andrew+Rothman&userId=4688574fc42a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}