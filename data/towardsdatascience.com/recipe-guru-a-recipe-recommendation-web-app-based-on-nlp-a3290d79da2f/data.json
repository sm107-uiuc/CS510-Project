{"url": "https://towardsdatascience.com/recipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f", "time": 1683013207.742914, "path": "towardsdatascience.com/recipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f/", "webpage": {"metadata": {"title": "Recipe Guru, a recipe recommendation web app based on NLP | by Maggie Xiao | Towards Data Science", "h1": "Recipe Guru, a recipe recommendation web app based on NLP", "description": "\u201cRecipe Guru\u201d uses NLP technologies to recommend similar recipes to the ones one might like, currently based on 18000 recipes out of Recipe 1M+. Under the hood, this web app uses Recipe 1M+ data and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@zxiao2015/understanding-language-using-xlnet-with-autoregressive-pre-training-9c86e5bea443", "anchor_text": "medium blog post", "paragraph_index": 1}, {"url": "http://pic2recipe.csail.mit.edu/", "anchor_text": "Recipe 1M+ dataset", "paragraph_index": 2}, {"url": "https://docs.scipy.org/doc/scipy/reference/sparse.html#usage-information", "anchor_text": "SciPy docs", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/deploying-an-nlp-web-app-with-heroku-the-pickle-problem-f50113ed2367", "anchor_text": "medium post", "paragraph_index": 6}, {"url": "https://cs.stanford.edu/~quocle/paragraph_vector.pdf", "anchor_text": "Doc2Vec", "paragraph_index": 15}, {"url": "https://radimrehurek.com/gensim/models/doc2vec.html#gensim.models.doc2vec.Doc2Vec", "anchor_text": "Gensim\u2019s Doc2Vec class", "paragraph_index": 15}], "all_paragraphs": ["\u201cRecipe Guru\u201d uses NLP technologies to recommend similar recipes to the ones one might like, currently based on 18000 recipes out of Recipe 1M+. Under the hood, this web app uses Recipe 1M+ data and natural language processing (NLP) models to recommend recipes based on the ones the user likes.", "It uses a similarity matrix to document similarities between recipes based on title, ingredients, and instructions. Bag of Words (BoW), Doc2Vec, and BERT (Bidirectional Encoder Representations from Transformers) models are used to estimate degrees of similarities between recipes and provide recipe recommendations. (Here is my medium blog post that talks about BERT and other recent NLP technologies, including XLNet. )", "For this project, I used the Recipe 1M+ dataset from MIT researchers: a new large-scale, structured corpus of over one million cooking recipes and 13 million food images. The dataset can be used for NLP and CV projects. Here, we focus on the text recipes (comes in JSON) that include the following information: the recipe URL, title, id, ingredients, and instructions.", "The preprocessing step combines title, ingredients, and instruction into one string for each of the 1M+ recipes and different Natural Language Processing techniques are applied on the clean dataset to generate embeddings and cosine similarity matrix.", "Due to the large size of the cosine similarity matrix, rather than using the sklearn function \u201cmetrics.pairwise_distances\u201d and scipy\u2019s \u201cspatial.distance.cosine\u201d to get pairwise cosine similarity, I used TensorFlow and GPU to speed up the cosine similarity matrix calculation and also tried using Spark distributed computing.", "One side note about storing the large cosine similarity matrix (a few GB for a 20k * 20k matrix with information on 20k recipes), one way to efficiently store it is to keep the indices of non-zero entries by converting the matrix into a sparse matrix. You can check out more about handling sparse matrices in the SciPy docs.", "Since I am going to deploy the web app along with the pickled cosine similarity matrices, I am concerned about the large file sizes (1\u20132 GB). So before converting to csr_matrix, I set the similarity score of recipes with the target recipe to 0 if the score is not in the top 10. Then we only need to pickle ~recipe_num * 10 elements in the compressed sparse row formatted matrix. The file size goes from 1.67 GB to 2 MB :D. By the way, I ran into this medium post today on his journey of pickling large NLP data files, hopefully, it can also help you if you are facing similar deployment issues.", "Using distributed computing with PySpark in Colab using the following code:", "To get the similarity matrices, three different NLP methods are used to represent the recipes:", "We will discuss these three methods in the following section.", "First, let\u2019s take a peek at the main functionality of \u201cRecipe Guru\u201d:", "The main app first provides 10 randomly selected recipes from Recipe 1M+ dataset. The user can select one or more recipes and ask for recommendations. He or she can also ask for other recipe collections until seeing the ones that are interesting.", "Here if we select \u201cChicken Teriyaki\u201d, the bag of words model will bring us the following choices which you can continue selecting, based on these, the web app will push new recipe recommendations. As you can see, the suggested recipes are similar to the original choice.", "In the following example, I will pick 3 recipes I like and see what we will get:", "Nice, the recommended recipes are mostly desserts as well. The BoW is simple and effective in measuring the similarity of short text from different recipes using the BoW vector representation. In particular, the Count Vectorizer method is used to represent the recipes. One shortcoming, however, of BoW is that it loses information about the word order. I did not use bag of n-grams model which could help to capture local word order because of data sparsity and high dimensionality.", "Doc2Vec is another option to measure the similarity between two documents using unsupervised learning. It represents each document as a vector and provides a numerical representation of a text document. Unlike word2vec that represents word concepts, doc2vec generates vectors that attempt to represent the concept of the documents using fixed-length vectors for each document. Here, a different subset of the Recipe 1M+ data than the ones used by Doc2Vec is used, also including 18k recipes. The method is also fairly straightforward. I used Gensim\u2019s Doc2Vec class to train on the dataset and get the embeddings, with a hidden layer size of 512 during training. The resulted matrix has a dimension of 1028702 * 512. For this project, I took the first 18k rows from the matrix as the embeddings for the recipes included in the Doc2Vec recipe recommender.", "Unlike BoW\u2019s recommendation which shows similar or identical words in the recipe names, Doc2Vec recommendations are more diverse. Here is an example:", "Here are the recommendations based on \u201cProsciutto, Feta and Peach Salad\u201d and \u201cFour Cheese Roasted Vegetables\u201d. We can spot similarities more in terms of the recipe context/semantics.", "More on BERT to come while I am finalizing the app :D..", "The following standard Lang class is used to create a dictionary of words from the original recipes. It is useful in preprocessing the recipe sentence data.", "For this project, Layer1.json file from Recipe 1M+ is used. The preliminary exploratory analysis shows there are 1029720 recipes, and the following plot shows the histogram of the number of words in recipes.", "For the ease of analysis, 1029662 recipes with less than 300 words are used in downstream processing.", "\u201cdet_ingrs.json\u201d provides nutritional information on 51213 recipes, which I will be incorporating in the next step of the web app, so users can filter recipes based on nutritional requirements.", "The \u201cRecipe Guru\u201d web app is built using Flask.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D. researcher, UCLA Electrical & Computer Engineering. Experienced in data science, machine learning, and AI. Also, in magnetism and nanotechnology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa3290d79da2f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zxiao2015?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zxiao2015?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": "Maggie Xiao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2dcbacf9caff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&user=Maggie+Xiao&userId=2dcbacf9caff&source=post_page-2dcbacf9caff----a3290d79da2f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3290d79da2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3290d79da2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://recipe-guru-rec.herokuapp.com/main", "anchor_text": "\u201cRecipe Guru\u201d"}, {"url": "https://unsplash.com/@beccatapert?utm_source=medium&utm_medium=referral", "anchor_text": "Becca Tapert"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@zxiao2015/understanding-language-using-xlnet-with-autoregressive-pre-training-9c86e5bea443", "anchor_text": "medium blog post"}, {"url": "http://pic2recipe.csail.mit.edu/", "anchor_text": "Recipe 1M+ dataset"}, {"url": "https://docs.scipy.org/doc/scipy/reference/sparse.html#usage-information", "anchor_text": "SciPy docs"}, {"url": "https://towardsdatascience.com/deploying-an-nlp-web-app-with-heroku-the-pickle-problem-f50113ed2367", "anchor_text": "medium post"}, {"url": "https://cs.stanford.edu/~quocle/paragraph_vector.pdf", "anchor_text": "Doc2Vec"}, {"url": "https://radimrehurek.com/gensim/models/doc2vec.html#gensim.models.doc2vec.Doc2Vec", "anchor_text": "Gensim\u2019s Doc2Vec class"}, {"url": "https://medium.com/tag/nlp?source=post_page-----a3290d79da2f---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a3290d79da2f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa3290d79da2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&user=Maggie+Xiao&userId=2dcbacf9caff&source=-----a3290d79da2f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa3290d79da2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&user=Maggie+Xiao&userId=2dcbacf9caff&source=-----a3290d79da2f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3290d79da2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa3290d79da2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a3290d79da2f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a3290d79da2f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a3290d79da2f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a3290d79da2f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a3290d79da2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zxiao2015?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zxiao2015?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maggie Xiao"}, {"url": "https://medium.com/@zxiao2015/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "34 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2dcbacf9caff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&user=Maggie+Xiao&userId=2dcbacf9caff&source=post_page-2dcbacf9caff--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F28b8c7d616f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecipe-guru-a-recipe-recommendation-web-app-based-on-nlp-a3290d79da2f&newsletterV3=2dcbacf9caff&newsletterV3Id=28b8c7d616f&user=Maggie+Xiao&userId=2dcbacf9caff&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}