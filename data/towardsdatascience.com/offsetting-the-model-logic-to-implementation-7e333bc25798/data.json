{"url": "https://towardsdatascience.com/offsetting-the-model-logic-to-implementation-7e333bc25798", "time": 1683005532.7537742, "path": "towardsdatascience.com/offsetting-the-model-logic-to-implementation-7e333bc25798/", "webpage": {"metadata": {"title": "Offsetting the Model \u2014 Logic to Implementation | by Ajay Tiwari | Towards Data Science", "h1": "Offsetting the Model \u2014 Logic to Implementation", "description": "In our property and casualty insurance world very often we use a term called \u2018offset\u2019 which is widely used for modeling rate (count/exposure) such as the number of claims per exposure unit. This\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In our property and casualty insurance world very often we use a term called \u2018offset\u2019 which is widely used for modeling rate (count/exposure) such as the number of claims per exposure unit. This helps the model to transform the response variable from rate to count keeping coefficient as 1 by using simple algebra.", "This term may confuse the beginners, I had this question when I first introduced to this approach. Why can\u2019t we manually derive a new response variable by simply dividing the count by its respective exposure instead of using an offset term?", "I will walk you through the log-likelihood functions of both versions, with and without offset to show the difference and highlight any discrepancies followed in the approach.", "One important point to be noted, offset should be included on the same \u201cscale\u201d as the linear predictor. In the case of a log link model, this requires the offset variable to be logged before inclusion in the model.", "Here is the regression model in its original form with an offset variable (Si), response variable Y, xi as independent variables and a set of parameters \u03b8 that can be estimated by maximum likelihood. This is achieved by just multiplying the exposure variable to the original form.", "Further, we can simplify this equation by taking natural logarithm both sides", "Now, this equation can be rewritten as a likelihood function in terms of \u03b8 as below", "Finally, we arrive at the log-likelihood equation of the first version (with offset), only terms dependent on \u03b8 will remain in the equation, other terms gets dropped out during differentiation:", "Let\u2019s take a look at the other case when we are modeling rate (Yi/si) as the response variable, here is our new model equation.", "Again, we arrive at the same equation as we had in the first case.", "So, what is the difference? Both equations look the same.", "In the first case, we are assuming yi (count response) following a Poisson distribution, whereas in the second case we are assuming (yi/si)has a Poisson distribution, this second assumption is not appropriate which makes our model incorrect.", "Let\u2019s take a look at the new likelihood function:", "The new equation after keeping only \u03b8 dependent terms during differentiation", "Now, we can compare log-likelihood functions (1) and (2), and observe the difference, both the approach will produce different outcomes. Also, we have seen, the second equation is based on a wrong assumption about the Poisson distribution, data is no more integers. Therefore, we can conclude that using a transformed rate variable as the response and without an offset is an incorrect approach.", "However, still, we have an option to correct the latter approach by applying a weight equivalent to exposure (si) to each observation. We can see the following equation is equivalent to equation (1).", "Let\u2019s understand the difference in the implementation through the following R code examples. Similarly, these can be implemented in other modeling packages as well, both approaches will give the same output.", "There are cases when we already know the effect of an explanatory variable and rather than estimating parameters \u03b2 for this variable, it is better to use available information.", "Another scenario, boosting a new model using an existing model output, e.g., you trained a model for 200 iterations, and later wanted to restart from there to finish another 300 iterations, instead of re-starting the process from scratch you can provide previous model output as base margin or offset.", "This implementation is quite easy and straight forward in R, SAS, Emblem (insurance industry-specific GLM software from Willis Tower Watson) and in statsmodels (a statistical modeling counterpart of sci-kit learn in python), whereas it\u2019s less popular in machine learning models. Instead, they use some function to set the base score before training a new model, this base score can be used from an existing model or any known effect of a variable.", "As an alternative, this function of ML algorithms can help us in implementing offset while modeling rates. This implementation is possible in all the cases where Poisson, Gamma and Tweedie loss functions have been used with log-link.", "Offset in the case of a GLM in R can be achieved using the offset() function, similar implementation is possible for pscl, GBM, and glmnet packages.", "Offset in the case of a GLM in Python (statsmodels) can be achieved using the exposure() function, one important point to note here, this doesn\u2019t require logged variable, the function itself will take care and log the variable.", "Offset in the case of XGBOOST in Python can be achieved using the set_base_margin() function, which requires a logged variable. In lightgbm, we can use set_init_score() before training.", "We discussed how Poisson regression can be used to model rate using an offset variable and how this functionality can be implemented in machine learning models. The examples of algorithms given here are not an exhaustive list, readers can explore other algorithms such as model-based decision trees and neural networks.", "Thanks for reading! I hope you find this article informative.", "[3]Duncan Anderson and Team, 2007, A Practitioner\u2019s Guide to Generalized Linear Models", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7e333bc25798&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7e333bc25798--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7e333bc25798--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ajaytiwari.ib?source=post_page-----7e333bc25798--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajaytiwari.ib?source=post_page-----7e333bc25798--------------------------------", "anchor_text": "Ajay Tiwari"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6cd36cd3bec9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=post_page-6cd36cd3bec9----7e333bc25798---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e333bc25798&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e333bc25798&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "[1] XGBoost Documentation \u2014 xgboost 1.1.0-SNAPSHOT documentationXGBoost is an optimized distributed gradient boosting library designed to be highly efficient, flexible and portable\u2026xgboost.readthedocs.io"}, {"url": "https://lightgbm.readthedocs.io/en/latest/", "anchor_text": "[2] Welcome to LightGBM\u2019s documentation! \u2014 LightGBM 2.3.2 documentationLightGBM is a gradient boosting framework that uses tree-based learning algorithms. It is designed to be distributed\u2026lightgbm.readthedocs.io"}, {"url": "https://www.statsmodels.org/", "anchor_text": "https://www.statsmodels.org/"}, {"url": "https://en.wikipedia.org/wiki/Poisson_regression", "anchor_text": "https://en.wikipedia.org/wiki/Poisson_regression"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7e333bc25798---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7e333bc25798---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/insurance?source=post_page-----7e333bc25798---------------insurance-----------------", "anchor_text": "Insurance"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7e333bc25798---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data?source=post_page-----7e333bc25798---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7e333bc25798&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=-----7e333bc25798---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7e333bc25798&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=-----7e333bc25798---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e333bc25798&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7e333bc25798--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7e333bc25798&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7e333bc25798---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7e333bc25798--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7e333bc25798--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7e333bc25798--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7e333bc25798--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7e333bc25798--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7e333bc25798--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7e333bc25798--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7e333bc25798--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajaytiwari.ib?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajaytiwari.ib?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ajay Tiwari"}, {"url": "https://medium.com/@ajaytiwari.ib/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "258 Followers"}, {"url": "https://www.linkedin.com/in/ajtiwari/", "anchor_text": "https://www.linkedin.com/in/ajtiwari/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6cd36cd3bec9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=post_page-6cd36cd3bec9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F12278ac13bbe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foffsetting-the-model-logic-to-implementation-7e333bc25798&newsletterV3=6cd36cd3bec9&newsletterV3Id=12278ac13bbe&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}