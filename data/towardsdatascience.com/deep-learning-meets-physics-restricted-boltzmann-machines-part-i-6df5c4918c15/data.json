{"url": "https://towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15", "time": 1682993341.539764, "path": "towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15/", "webpage": {"metadata": {"title": "Deep Learning meets Physics: Restricted Boltzmann Machines | Towards Data Science", "h1": "Deep Learning meets Physics: Restricted Boltzmann Machines Part I", "description": "Restricted Boltzmann Machines achieve state-of-the-art performance in collaborative filtering. Meanwhile, they have many similarities with concepts from Physics."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "Netflix Prize", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Boltzmann_distribution", "anchor_text": "Boltzmann Distribution", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Bernoulli_distribution", "anchor_text": "Bernoulli distribution", "paragraph_index": 16}, {"url": "https://www.cs.toronto.edu/~rsalakhu/papers/rbmcf.pdf", "anchor_text": "Restricted Boltzmann Machines", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Outer_product", "anchor_text": "outer products", "paragraph_index": 23}, {"url": "https://artem-oppermann.medium.com/subscribe", "anchor_text": "https://artem-oppermann.medium.com/subscribe", "paragraph_index": 26}], "all_paragraphs": ["This tutorial is part one of a two part series about Restricted Boltzmann Machines, a powerful deep learning architecture for collaborative filtering. In this part I introduce the theory behind Restricted Boltzmann Machines. The second part consists of a step by step guide through a practical implementation of a model which can predict whether a user would like a movie or not.", "The practical part is now available here.", "Restricted Boltzmann Machines (RBMs) are neural networks that belong to so called Energy Based Models. This type of neural networks may be not that familiar to the reader of this article as e.g. feedforward or convolution neural networks. Yet this kind of neural networks gained big popularity in recent years in the context of the Netflix Prize where RBMs achieved state of the art performance in collaborative filtering and have beaten most of the competition.", "In my opinion RBMs have one of the easiest architectures of all neural networks. As it can be seen in Fig.1. a RBM consists out of one input/visible layer (v1,\u2026,v6), one hidden layer (h1, h2) and corresponding biases vectors Bias a and Bias b. The absence of an output layer is apparent. But as it can be seen later an output layer wont be needed since the predictions are made differently as in regular feedforward neural networks.", "Energy is a term that may not be associated with deep learning in the first place. Rather is energy a quantitative property of physics. E.g. gravitational energy describes the potential energy a body with mass has in relation to another massive object due to gravity. Yet some deep learning architectures use the idea of energy as a metric for measurement of the models quality.", "One purpose of deep learning models is to encode dependencies between variables. The capturing of dependencies happen through associating of a scalar energy to each configuration of the variables, which serves as a measure of compatibility. A high energy means a bad compatibility. An energy based model model tries always to minimize a predefined energy function. The energy function for the RBMs is defined as:", "As it can be noticed the value of the energy function depends on the configurations of visible/input states, hidden states, weights and biases. The training of RBM consists in finding of parameters for given input values so that the energy reaches a minimum.", "Restricted Boltzmann Machines are probabilistic. As opposed to assigning discrete values the model assigns probabilities. At each point in time the RBM is in a certain state. The state refers to the values of neurons in the visible and hidden layers v and h. The probability that a certain state of v and h can be observed is given by the following joint distribution:", "Here Z is called the \u2018partition function\u2019 that is the summation over all possible pairs of visible and hidden vectors.", "This is the point where Restricted Boltzmann Machines meets Physics for the second time. The joint distribution is known in Physics as the Boltzmann Distribution which gives the probability that a particle can be observed in the state with the energy E. As in Physics we assign a probability to observe a state of v and h, that depends on the overall energy of the model. Unfortunately it is very difficult to calculate the joint probability due to the huge number of possible combination of v and h in the partition function Z. Much easier is the calculation of the conditional probabilities of state h given the state v and conditional probabilities of state v given the state h:", "It should be noticed beforehand (before demonstrating this fact on practical example) that each neuron in a RBM can only exist in a binary state of 0 or 1. The most interesting factor is the probability that a hidden or visible layer neuron is in the state 1 \u2014 hence activated. Given an input vector v the probability for a single hidden neuron j being activated is:", "Here is \u03c3 the Sigmoid function. This equation is derived by applying the Bayes Rule to Eq.3 and a lot of expanding which will be not covered here.", "Analogous the probability that a binary state of a visible neuron i is set to 1 is:", "Lets assume some people were asked to rate a set of movies on a scale of 1\u20135 stars. In classical factor analysis each movie could be explained in terms of a set of latent factors. For example, movies like Harry Potter and Fast and the Furious might have strong associations with a latent factors of fantasy and action. On the other hand users who like Toy Story and Wall-E might have strong associations with latent Pixar factor. RBMs are used to analyse and find out these underlying factors. After some epochs of the training phase the neural network has seen all ratings in the training date set of each user multiply times. At this time the model should have learned the underlying hidden factors based on users preferences and corresponding collaborative movie tastes of all users.", "The analysis of hidden factors is performed in a binary way. Instead of giving the model user ratings that are continues (e.g. 1\u20135 stars), the user simply tell if they liked (rating 1) a specific movie or not (rating 0). The binary rating values represent the inputs for the input/visible layer. Given the inputs the RMB then tries to discover latent factors in the data that can explain the movie choices. Each hidden neuron represents one of the latent factors. Given a large dataset consisting out of thousands of movies it is quite certain that a user watched and rated only a small amount of those. It is necessary to give yet unrated movies also a value, e.g. -1.0 so that the network can identify the unrated movies during training time and ignore the weights associated with them.", "Lets consider the following example where a user likes Lord of the Rings and Harry Potter but does not like The Matrix, Fight Club and Titanic. The Hobbit has not been seen yet so it gets a -1 rating. Given these inputs the Boltzmann Machine may identify three hidden factors Drama, Fantasy and Science Fiction which correspond to the movie genres.", "Given the movies the RMB assigns a probability p(h|v) (Eq. 4) for each hidden neuron. The final binary values of the neurons are obtained by sampling from Bernoulli distribution using the probability p.", "In this example only the hidden neuron that represents the genre Fantasy becomes activate. Given the movie ratings the Restricted Boltzmann Machine recognized correctly that the user likes Fantasy the most.", "After the training phase the goal is to predict a binary rating for the movies that had not been seen yet. Given the training data of a specific user the network is able to identify the latent factors based on this users preference. Since the latent factors are represented by the hidden neurons we can use p(v|h) (Eq. 5) and sample from Bernoulli distribution to find out which of the visible neurons now become active.", "Fig. 4 shows the new ratings after using the hidden neuron values for the inference. The network did identified Fantasy as the preferred movie genre and rated The Hobbit as a movie the user would like.", "In summary the process from training to the prediction phase goes as follows:", "The training of the Restricted Boltzmann Machine differs from the training of a regular neural networks via stochastic gradient descent. The deviation of the training procedure for a RBM wont be covered here. Instead I will give an short overview of the two main training steps and refer the reader of this article to check out the original paper on Restricted Boltzmann Machines.", "The first part of the training is called Gibbs Sampling. Given an input vector v we are using p(h|v) (Eq.4) for prediction of the hidden values h. Knowing the hidden values we use p(v|h) (Eq.5) for prediction of new input values v. This process is repeated k times. After k iterations we obtain an other input vector v_k which was recreated from original input values v_0.", "The update of the weight matrix happens during the Contrastive Divergence step. Vectors v_0 and v_k are used to calculate the activation probabilities for hidden values h_0 and h_k (Eq.4). The difference between the outer products of those probabilities with input vectors v_0 and v_k results in the update matrix:", "Using the update matrix the new weights can be calculated with gradient ascent, given by:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Deep Learning & AI Software Developer | MSc. Physics | https://artem-oppermann.medium.com/subscribe"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6df5c4918c15&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://artem-oppermann.medium.com/?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": ""}, {"url": "https://artem-oppermann.medium.com/?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": "Artem Oppermann"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F619319ac8220&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&user=Artem+Oppermann&userId=619319ac8220&source=post_page-619319ac8220----6df5c4918c15---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6df5c4918c15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6df5c4918c15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/artem-oppermann-929154199/?locale=en_US", "anchor_text": "LinkedIn"}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "Netflix Prize"}, {"url": "https://en.wikipedia.org/wiki/Boltzmann_distribution", "anchor_text": "Boltzmann Distribution"}, {"url": "https://en.wikipedia.org/wiki/Bernoulli_distribution", "anchor_text": "Bernoulli distribution"}, {"url": "https://www.cs.toronto.edu/~rsalakhu/papers/rbmcf.pdf", "anchor_text": "Restricted Boltzmann Machines"}, {"url": "https://en.wikipedia.org/wiki/Outer_product", "anchor_text": "outer products"}, {"url": "https://www.cs.toronto.edu/~rsalakhu/papers/rbmcf.pdf", "anchor_text": "https://www.cs.toronto.edu/~rsalakhu/papers/rbmcf.pdf"}, {"url": "https://www.cs.toronto.edu/~hinton/absps/guideTR.pdf", "anchor_text": "https://www.cs.toronto.edu/~hinton/absps/guideTR.pdf"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6df5c4918c15---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6df5c4918c15---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6df5c4918c15---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6df5c4918c15---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6df5c4918c15---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6df5c4918c15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&user=Artem+Oppermann&userId=619319ac8220&source=-----6df5c4918c15---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6df5c4918c15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&user=Artem+Oppermann&userId=619319ac8220&source=-----6df5c4918c15---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6df5c4918c15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6df5c4918c15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6df5c4918c15---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6df5c4918c15--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6df5c4918c15--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6df5c4918c15--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6df5c4918c15--------------------------------", "anchor_text": ""}, {"url": "https://artem-oppermann.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://artem-oppermann.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Artem Oppermann"}, {"url": "https://artem-oppermann.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.8K Followers"}, {"url": "https://artem-oppermann.medium.com/subscribe", "anchor_text": "https://artem-oppermann.medium.com/subscribe"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F619319ac8220&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&user=Artem+Oppermann&userId=619319ac8220&source=post_page-619319ac8220--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc09555d6711e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15&newsletterV3=619319ac8220&newsletterV3Id=c09555d6711e&user=Artem+Oppermann&userId=619319ac8220&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}