{"url": "https://towardsdatascience.com/topic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369", "time": 1683010204.598488, "path": "towardsdatascience.com/topic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369/", "webpage": {"metadata": {"title": "Topic Modeling with NLP on Amazon Reviews | by Enes Gokce | Towards Data Science", "h1": "Topic Modeling with NLP on Amazon Reviews", "description": "Topic modeling is another popular text analysis technique. The ultimate goal of topic modeling to find a theme across reviews, and discover hidden topics. Each document in the corpus will be made up\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/snap/amazon-fine-food-reviews", "anchor_text": "Kaggle", "paragraph_index": 9}, {"url": "http://i.stanford.edu/~julian/pdfs/www13.pdf", "anchor_text": "From amateurs to connoisseurs: modeling the evolution of user expertise through online reviews", "paragraph_index": 9}, {"url": "https://colab.research.google.com/drive/1JUL32S3r1rShFY4BLK54w5GSwOKqJUe1?usp=sharing", "anchor_text": "Colab Notebook", "paragraph_index": 12}, {"url": "https://www.linkedin.com/in/bibor-szabo/", "anchor_text": "Bibor Szabo", "paragraph_index": 54}, {"url": "https://colab.research.google.com/drive/1JUL32S3r1rShFY4BLK54w5GSwOKqJUe1?usp=sharing", "anchor_text": "GitHub folder", "paragraph_index": 55}, {"url": "https://towardsdatascience.com/beginners-guide-for-data-cleaning-and-feature-extraction-in-nlp-756f311d8083", "anchor_text": "data cleaning", "paragraph_index": 55}, {"url": "https://towardsdatascience.com/sentiment-analysis-on-amazon-reviews-45cd169447ac", "anchor_text": "sentiment analysis", "paragraph_index": 55}], "all_paragraphs": ["Topic modeling is another popular text analysis technique. The ultimate goal of topic modeling to find a theme across reviews, and discover hidden topics. Each document in the corpus will be made up of at least one topic, if not multiple topics.", "In this part, I will be covering the results of Latent Dirichlet Allocation (LDA), which is one of many topic modeling techniques. It\u2019s an unsupervised classification method. When we have a large text and don\u2019t know where to start, then we can apply topic modeling and can see what kind of groups are emerging. LDA was specifically designed for text data.", "To use a topic modeling technique, you need to provide:", "In topic modeling, I will create different models and compare them. In the end, I will choose the topic model that makes the most sense.", "In here, I won\u2019t cover the mathematical foundation of the LDA. I will just discuss how to interpret the results of LDA topic modeling.", "During LDA Topic modeling, we create many different topic groups. As a researcher, we are the one who decides the number of groups in the output. However, we do not know what is the best number of groups. Therefore, we will obtain different numbers of groups. Then, we examine and compare topic modelings, and decide which topic model makes more sense, most meaningful, have the clearest distinction within the model. Then, the group (model) that makes the most sense will be chosen among all topic groups.", "It must be noted that the nature of the LDA is subjective. It\u2019s possible that different people may reach different conclusions about choosing the most meaningful topic groups. We are looking for the most reasonable topic groups. People from different backgrounds, different domain expertise may not be on the same page about most sensible topic groups.", "LDA is an unsupervised clustering method. When we are talking about unsupervised clustering methods, we need to mention K-Means Clustering. K-Means Clustering is one of the most well-known unsupervised clustering methods. It\u2019s very practical and useful in many cases and has used for text mining for years. In contrast to K-means clustering, where each word can only belong to one cluster (hard-clustering), LDA allows for \u2018fuzzy\u2019 memberships (soft clustering). Soft-clustering allows overlap among the cluster, whereas, in hard-clustering, clusters are mutually exclusive. What does this mean? In LDA, a word can belong to more than one group while this is not possible in K-Means clustering. In LDA, this trade-off makes it easier to find similarities between the words. However, this soft-clustering makes it hard to obtain distinct groups because the same words can appear in different groups. We will experience this drawback in our further analysis.", "Once the topic modeling technique is applied, the researcher\u2019s job as a human is to interpret the results and see if the mix of words in each topic makes sense. If they don\u2019t make sense, we can try changing up the number of topics, the terms in the document-term matrix, model parameters, or even try a different model.", "Brief information about the data I use: The data used in this study were downloaded from Kaggle. It was uploaded by the Stanford Network Analysis Project. The original data is coming from the study of \u2018From amateurs to connoisseurs: modeling the evolution of user expertise through online reviews\u2019 done by J. McAuley and J. Leskovec (2013). This data set consists of reviews of fine foods from Amazon. The data includes all 568,454 reviews spanning 1999 to 2012. Reviews include product and user information, ratings, and a plain text review.", "In this study, I will focus on \u2018good reviews\u2019 on Amazon. I defined \u2018good reviews\u2019 as the reviews that have 4-star or 5-star customer reviews (out of 5). In other words, if an Amazon review is 4 or 5 stars, it\u2019s called \u2018good review\u2019 in this study. 1,2 or 3-star reviews are labeled as \u2018bad reviews\u2019.", "Data preparation is a critical part because if we fail to prepare the data properly, we can\u2019t perform topic modeling. Here, I won\u2019t dive into detail because data preparation is not the focus of this study. However, be ready to spend some time here in case you have a problem. If you adjust the codes I provide here for your own dataset, I hope you should not have any problem.", "An edit and warning: if you want to replicate this work, please follow/double-check with the Colab Notebook on my Github because there are a couple of missing variables/definitions on here that will block the process.", "Let\u2019s start with checking the number of column and row of the data:", "This amount of review is so hard to handle for many home computers (and for the Google Colab). Therefore, I will use just 10,000 reviews. Unfortunately, we can\u2019t use all of our reviews if we don\u2019t have access to a supercomputer.", "Now, the next step of data preparation is the count vectorizer:", "Pickling the data for creating a term-document matrix", "After pickling the data, we obtain a wide word dictionary:", "Now, it\u2019s time to create the term-document matrix. This term-document matrix data will be used for generating topic modeling. That\u2019s why it\u2019s crucial for the study.", "Let\u2019s start to create topic modelings!", "There are many ways to create topic modelings. By filtering the text for certain criteria, we can obtain different topic groups. In this study, we will create topic modeling by using:", "Topic Modeling \u2014 Attempt 1 (with all the review data)", "As a beginning, we are using all the reviews that we have. No text filtering is applied in this process.", "What will I do with this result? At this point, we can examine these two topic groups and check whether they are distinct groups or not. We don\u2019t expect all words in a group must be related. We are looking for a general trend in the topic group. Considering the above two groups, it\u2019s hard to see a clear distinct group there. This is my opinion. If you think that there are actually two discrete groups, and you can justify it, then you are safe to go with it.", "Remember, I said that LDA is a soft-clustering model. Here, we see that the word \u2018like\u2019 appeared in both groups. This is normal because, in soft-clustering models, a word can appear in different groups at the same time.", "We don\u2019t need to push ourselves to give meaning to the above model. We can move forward. Let\u2019s create more topic models.", "Similar to the 2 topics model, we will create 3 and 4 groups.", "All the results can be seen in Table 1 (below table). At this point, we should examine the groups and try to find a group that makes the most sense. By looking at Table 1, it can be said that \u2018Modeling with 2 Topics\u2019 makes the most sense. The first group is about beverages, and the second group is about reactions. Feel free to reach a different conclusion than me! For now, this will stay here and won\u2019t go further because we will create 6 more topic models. I can check the outputs more closely after I get all results. We will reconsider Table 1 after producing further topic modelings.", "Topic Modeling \u2014 Attempt 2 (Nouns only): In this step, only nouns will be used for creating topics by using the LDA method. Again, our purpose is to find hidden patterns in reviews. Now, we are just trying to explore by using different criteria.", "Similar to the previous step, we will run LDA with 2,3 and 4 topic groups.", "Let's create a function to pull out nouns from a string of text:", "Let's apply this defined noun function to our Amazon Review text data:", "Create a new document-term matrix using only nouns:", "\u26ab Let\u2019s start with 2 topics", "Table 2 is the output of the LDA topic modeling attempts with only nouns. At this point, again we need to briefly examine topics and try to find a model that has distinct topic groups. Again, still no need to spend much time because we will still produce more topic models.", "To me, The topic model with three groups is meaningful. It has these groups:", "It\u2019s totally normal that people can reach different conclusions than others.", "Topic Modeling \u2014 Attempt 3 (Nouns and Adjectives): In this step, only nouns and adjectives were used for creating topics by using the LDA method.", "Let\u2019s prepare the data for this:", "Let\u2019s define the function that will give us only nouns or adjectives:", "Let\u2019s check the Amazon Review data with noun/adj only filter:", "As we can see, we only have nouns and adjectives here. Now, we will ask LDA to create topics by using this filtered version of our dataset.", "Let\u2019s prepare the data for LDA:", "\u26ab Let\u2019s start with 2 topics", "\u26ab Let\u2019s try with 3 topics", "\u26ab Let\u2019s try with 4 topics", "Table 3 is the output of the LDA topic modeling attempts with only nouns or adjectives. At this point, again we need to examine topics and check if there is any topic group making sense.", "Now, in the final stage, Table 1, Table 2, and Table 3 must be evaluated together. In total, we created 9 topic models. At this point, we need to ask ourselves self \u2018which group makes more sense?\u2019. Now, it\u2019s time to focus and examine the topics. Which groups make sense? If there is no group that makes sense, we need to go back data to data cleaning, change parameters, or use different filters and models. It\u2019s a recursive process.", "Out of the 9 examined topic models, nouns only, the 3-topic group made the most sense to me (Table 4). I see three distinct groups here: (1) pet items, (2) cookies and snacks, and (3) beverage. Again, it\u2019s totally normal that another person can find a different topic model more meaningful.", "Keep in mind that this dataset consists of only food reviews. So, it quite normal to see that the groups are related to foods.", "So, let\u2019s pull that down here and run it through some more iterations to get more fine-tuned topics. 3 topic (only with noun) was the most meaningful model to me. So, I will fine-tune this topic model more by increasing number of iterations from 10 to 80.", "In the above table, we see similar groups with Table 4, just in different orders. By considering all the steps of topic analysis with the LDA method, it can be concluded that good Amazon Reviews can be categorized into three main topics: (1) beverages, (2) pet items, and (3) cookies and snacks.", "Lastly, we need to keep in mind that in order to understand which topic group makes more sense, we may need domain expertise. As a researcher, it\u2019s our responsibility to justify our choice of topic group. As long as we can justify, we can decide any topic group as a final topic model.", "Thank you for reading! Happy analysis!", "*Special thanks to my friend Bibor Szabo for prividing valuable feedbacks and suggestions while writing this posting.", "Note: For the Python codes for this study, you can check my GitHub folder. All the scripts used in this study are available in the Github folder. In addition, this topic modeling study is a part of the bigger project. You can check my previous posts for data cleaning and sentiment analysis if you are interested in to see previous steps.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Native, and Ph.D. student at Penn State University"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae42a4c8b369&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@enesgokce?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@enesgokce?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": "Enes Gokce"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F96f31b18f758&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&user=Enes+Gokce&userId=96f31b18f758&source=post_page-96f31b18f758----ae42a4c8b369---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae42a4c8b369&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae42a4c8b369&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.shutterstock.com/g/arfa_adam", "anchor_text": "Arfa Adam"}, {"url": "https://www.shutterstock.com/image-photo/colorful-alphabet-arrangement-word-topics-1049976773", "anchor_text": "Shutterstock"}, {"url": "https://www.kaggle.com/snap/amazon-fine-food-reviews", "anchor_text": "Kaggle"}, {"url": "http://i.stanford.edu/~julian/pdfs/www13.pdf", "anchor_text": "From amateurs to connoisseurs: modeling the evolution of user expertise through online reviews"}, {"url": "https://colab.research.google.com/drive/1JUL32S3r1rShFY4BLK54w5GSwOKqJUe1?usp=sharing", "anchor_text": "Colab Notebook"}, {"url": "https://www.linkedin.com/in/bibor-szabo/", "anchor_text": "Bibor Szabo"}, {"url": "https://colab.research.google.com/drive/1JUL32S3r1rShFY4BLK54w5GSwOKqJUe1?usp=sharing", "anchor_text": "GitHub folder"}, {"url": "https://towardsdatascience.com/beginners-guide-for-data-cleaning-and-feature-extraction-in-nlp-756f311d8083", "anchor_text": "data cleaning"}, {"url": "https://towardsdatascience.com/sentiment-analysis-on-amazon-reviews-45cd169447ac", "anchor_text": "sentiment analysis"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----ae42a4c8b369---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ae42a4c8b369---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/topic-modeling?source=post_page-----ae42a4c8b369---------------topic_modeling-----------------", "anchor_text": "Topic Modeling"}, {"url": "https://medium.com/tag/python?source=post_page-----ae42a4c8b369---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ae42a4c8b369---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae42a4c8b369&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&user=Enes+Gokce&userId=96f31b18f758&source=-----ae42a4c8b369---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae42a4c8b369&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&user=Enes+Gokce&userId=96f31b18f758&source=-----ae42a4c8b369---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae42a4c8b369&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae42a4c8b369&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae42a4c8b369---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae42a4c8b369--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@enesgokce?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@enesgokce?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Enes Gokce"}, {"url": "https://medium.com/@enesgokce/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "201 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F96f31b18f758&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&user=Enes+Gokce&userId=96f31b18f758&source=post_page-96f31b18f758--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd041d3f1e6df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modeling-with-nlp-on-amazon-reviews-an-application-of-latent-dirichlet-allocation-lda-ae42a4c8b369&newsletterV3=96f31b18f758&newsletterV3Id=d041d3f1e6df&user=Enes+Gokce&userId=96f31b18f758&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}