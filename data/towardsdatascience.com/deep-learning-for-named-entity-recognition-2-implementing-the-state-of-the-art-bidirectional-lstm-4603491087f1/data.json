{"url": "https://towardsdatascience.com/deep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1", "time": 1682993408.2150211, "path": "towardsdatascience.com/deep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1/", "webpage": {"metadata": {"title": "Deep Learning for Named Entity Recognition #2: Implementing the state-of-the-art Bidirectional LSTM + CNN model for CoNLL 2003 | by Maximilian Hofer | Towards Data Science", "h1": "Deep Learning for Named Entity Recognition #2: Implementing the state-of-the-art Bidirectional LSTM + CNN model for CoNLL 2003", "description": "CoNLL 2003 is one of the many publicly available datasets useful for NER (see post #1). In this post we are going to implement the current SOTA algorithm by Chiu and Nichols (2016) (here) in Python\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/sigma-squared/deep-learning-for-ner-1-public-datasets-and-annotation-methods-8b1ad5e98caf", "anchor_text": "post #1", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1511.08308", "anchor_text": "here", "paragraph_index": 0}, {"url": "http://www.wildml.com/2015/11/understanding-convolutional-neural-networks-for-nlp/", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Bidirectional_recurrent_neural_networks", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://pdfs.semanticscholar.org/4b80/89bc9b49f84de43acc2eb8900035f7d492b2.pdf", "anchor_text": "here", "paragraph_index": 4}, {"url": "http://sigmasquared.io", "anchor_text": "sigmasquared.io", "paragraph_index": 14}], "all_paragraphs": ["CoNLL 2003 is one of the many publicly available datasets useful for NER (see post #1). In this post we are going to implement the current SOTA algorithm by Chiu and Nichols (2016) (here) in Python with Keras and Tensorflow. The implementation has a bidirectional LSTM (BLSTM) at its core while also using a convolutional neural network (CNN) to identify character-level patterns.", "Assuming readers are familiar with CNNs (if not, read Denny Britz\u2019 recap here), but not so much with BLSTMs, let\u2019s quickly describe why BLSTMs are particularly suited for NER.", "Long short-term memory (LSTM) cells are the building block of recurrent neural networks (RNNs). While plain LSTM cells in a feedforward neural network process text just like humans do (from left to right), BLSTMs also consider the opposite direction. This allows the model to uncover more patterns as the amount of input information is increased. In other words, the model not only considers the sequence of tokens after a token of interest, but also before the token of interest.", "The figure below capture this idea more formally. Note that x stands for the input sequence, h for the output sequence from forward or backward runs (defined by the arrow pointing right or left, respectively), y for the concatenated output sequence where sigma concatenates the forward and backward output elements.", "The Wikipedia article (here) contains more details, including the link to the original paper by Schuster and Paliwal (1997) (here).", "I have used Keras with a Tensorflow backend. This is usually the most efficient set-up, particularly when running on a GPU.", "After loading the training, development and testing data files, the embed function creates word- and character-level embeddings. This means that words and characters are mapped to real numbers that the neural network can work with. More specifically, labels (e.g. B-ORG, I-ORG, B-LOC, etc.), token cases (e.g. lower case, upper case or numeric tokens) and characters are mapped to a real number using a dictionary data structure. Furthermore, all unique words are mapped to GloVE embedding vectors.", "The BLSTM layer forms the core of the network and has the following three inputs:", "The graph below shows the model architecture with all layers. A softmax activation layer generates the final outputs.", "The recommended parameters are slightly different to the paper. This might be due to the fact that we don\u2019t know what F1 score Chiu and Nichols (2016) would have achieved without using additional rule-based methods . Only considering their machine learning model component, these parameters achieve an F1 score of 90%+:", "When running the code on your local machine, you can achieve an F1 score of ~86% with only 30 epochs and around 1 hour of training with the above dropout, LSTM state size, convolutional width and optimiser parameters (see image below).", "To conclude, bidirectional LSTMs are a very powerful and flexible type of neural network for named entity recognition. Hint: try reusing the model on different data in the CoNLL format. How does it perform?", "I hope this provided a useful overview and implementation of the current SOTA model for CoNLL 2003 data. Let me know what results you get with different parameters and other tweaks! \ud83d\udc4b", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD @ EPFL | Machine Learning consulting at sigmasquared.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4603491087f1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4603491087f1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4603491087f1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maxhofer?source=post_page-----4603491087f1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxhofer?source=post_page-----4603491087f1--------------------------------", "anchor_text": "Maximilian Hofer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe95f1fe15b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&user=Maximilian+Hofer&userId=be95f1fe15b&source=post_page-be95f1fe15b----4603491087f1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4603491087f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4603491087f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/sigma-squared/deep-learning-for-ner-1-public-datasets-and-annotation-methods-8b1ad5e98caf", "anchor_text": "post #1"}, {"url": "https://arxiv.org/abs/1511.08308", "anchor_text": "here"}, {"url": "http://www.wildml.com/2015/11/understanding-convolutional-neural-networks-for-nlp/", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1801.02143.pdf", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Bidirectional_recurrent_neural_networks", "anchor_text": "here"}, {"url": "https://pdfs.semanticscholar.org/4b80/89bc9b49f84de43acc2eb8900035f7d492b2.pdf", "anchor_text": "here"}, {"url": "https://github.com/mxhofer/Named-Entity-Recognition-BidirectionalLSTM-CNN-CoNLL", "anchor_text": "mxhofer/Named-Entity-Recognition-BidirectionalLSTM-CNN-CoNLLNamed-Entity-Recognition-BidirectionalLSTM-CNN-CoNLL - Keras implementation of Chiu and Nichols (2016)github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4603491087f1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/lstm?source=post_page-----4603491087f1---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/keras?source=post_page-----4603491087f1---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/named-entity-recognition?source=post_page-----4603491087f1---------------named_entity_recognition-----------------", "anchor_text": "Named Entity Recognition"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4603491087f1---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4603491087f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&user=Maximilian+Hofer&userId=be95f1fe15b&source=-----4603491087f1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4603491087f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&user=Maximilian+Hofer&userId=be95f1fe15b&source=-----4603491087f1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4603491087f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4603491087f1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4603491087f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4603491087f1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4603491087f1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4603491087f1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4603491087f1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4603491087f1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4603491087f1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4603491087f1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4603491087f1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4603491087f1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxhofer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxhofer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maximilian Hofer"}, {"url": "https://medium.com/@maxhofer/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "267 Followers"}, {"url": "http://sigmasquared.io", "anchor_text": "sigmasquared.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe95f1fe15b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&user=Maximilian+Hofer&userId=be95f1fe15b&source=post_page-be95f1fe15b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fbe95f1fe15b%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-named-entity-recognition-2-implementing-the-state-of-the-art-bidirectional-lstm-4603491087f1&user=Maximilian+Hofer&userId=be95f1fe15b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}