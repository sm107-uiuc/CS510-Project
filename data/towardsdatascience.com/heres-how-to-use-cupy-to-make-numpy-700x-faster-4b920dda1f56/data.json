{"url": "https://towardsdatascience.com/heres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56", "time": 1682999804.580637, "path": "towardsdatascience.com/heres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56/", "webpage": {"metadata": {"title": "Here\u2019s How to Use CuPy to Make Numpy Over 10X Faster | by George Seif | Towards Data Science", "h1": "Here\u2019s How to Use CuPy to Make Numpy Over 10X Faster", "description": "Numpy has been a gift to the Python community. It\u2019s allowed Data Scientists, Machine Learning Practitioners, and Statisticians to process huge amounts of data in matrix format in a way that\u2019s easy\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.superquotes.co/?utm_source=mediumtech&utm_medium=web&utm_campaign=sharing", "anchor_text": "Super Quotes newsletter", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/one-simple-trick-for-speeding-up-your-python-code-with-numpy-1afc846db418", "anchor_text": "data processing into Numpy", "paragraph_index": 2}, {"url": "https://github.com/cupy/cupy", "anchor_text": "CuPy", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/use-cython-to-get-more-than-30x-speedup-on-your-python-code-f6cb337919b6", "anchor_text": "using Cython", "paragraph_index": 7}, {"url": "https://twitter.com/GeorgeSeif94", "anchor_text": "twitter", "paragraph_index": 20}, {"url": "https://www.linkedin.com/in/georgeseif/", "anchor_text": "LinkedIn", "paragraph_index": 20}], "all_paragraphs": ["Want to be inspired? Come join my Super Quotes newsletter. \ud83d\ude0e", "Numpy has been a gift to the Python community. It\u2019s allowed Data Scientists, Machine Learning Practitioners, and Statisticians to process huge amounts of data in matrix format in a way that\u2019s easy and efficient.", "Even on its own, Numpy is already a significant step up from Python in terms of speed. Whenever you find your Python code running slow, especially if you see a lot of for-loops, it\u2019s always a good idea to move the data processing into Numpy and let its vectorization do the work at top speed!", "Still, even with that speedup ,Numpy is only running on the CPU. With consumer CPUs typically having 8 cores or less, the amount of parallel processing, and therefore the amount of speedup that can be achieved, is limited.", "That\u2019s where our new friend CuPy comes in!", "CuPy is a library that implements Numpy arrays on Nvidia GPUs by leveraging the CUDA GPU library. With that implementation, superior parallel speedup can be achieved due to the many CUDA cores GPUs have.", "CuPy\u2019s interface is a mirror of Numpy and in most cases, it can be used as a direct replacement. Just replace your Numpy code with compatible CuPy code and boom you have GPU speedup. CuPy will support most of the array operations that Numpy has including indexing, broadcasting, math on arrays, and various matrix transformations.", "You can also write custom Python code which leverages CUDA and GPU speedups if you have something specific that isn\u2019t yet supported. All that\u2019s required is a small snippet of your code in C++ format and CuPy will automatically do the GPU conversion, very similar to using Cython.", "To get started with CuPy we can install the library via pip:", "For these benchmarks I will be using a PC with the following setup:", "Once CuPy is installed we can import it in a similar way as Numpy:", "For the rest of the coding, switching between Numpy and CuPy is as easy as replacing the Numpy np with CuPy\u2019s cp. The code below creates a 3D array with 1 Billion 1\u2019s for both Numpy and CuPy. To measure the speed of creating the arrays, I used Python\u2019s native time library:", "Notice how we added an extra line after the initialization of the cupy array. What this does is ensure that our code finishes executing on the GPU before going to the next line.", "The incredible part was that even though this was only array creation, CuPy was still much faster. Numpy created the array of 1 Billion 1\u2019s in 1.68 seconds while CuPy only took 0.16; that\u2019s a 10.5X speedup!", "But we can still do more.", "Let\u2019s try doing some mathematical operations on the arrays. This time we\u2019ll multiply the entire array by 5 and again check the speed of Numpy vs CuPy.", "Let\u2019s now try working with multiple arrays and do a few operations. The code down below will do the following:", "In this case, Numpy performed the process in 1.49 seconds on the CPU while CuPy performed the process in 0.0922 on the GPU; a more modest but still great 16.16X speedup!", "Using CuPy is a great way to accelerate Numpy and matrix operations on the GPU by many times. It\u2019s important to note that the speedups you\u2019ll get are highly dependant on the size of the array you\u2019re working with. The table below shows the difference in speed when we change the size of the array we\u2019re processing:", "The speedup drastically kicks up once we get to about 10 million data points and gets much much faster once we cross that 100 million points mark. Below that, Numpy is actually faster. Also, keep in mind that more GPU memory will help you process more data, so it\u2019s important to see if your GPU has enough memory to fit enough data where CuPy is worth it.", "Follow me on twitter where I post all about the latest and greatest AI, Technology, and Science! Connect with me on LinkedIn too!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4b920dda1f56&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@george.seif94?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@george.seif94?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": "George Seif"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2af5c8737ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&user=George+Seif&userId=e2af5c8737ec&source=post_page-e2af5c8737ec----4b920dda1f56---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b920dda1f56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b920dda1f56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.superquotes.co/?utm_source=mediumtech&utm_medium=web&utm_campaign=sharing", "anchor_text": "Super Quotes newsletter"}, {"url": "https://towardsdatascience.com/one-simple-trick-for-speeding-up-your-python-code-with-numpy-1afc846db418", "anchor_text": "data processing into Numpy"}, {"url": "https://github.com/cupy/cupy", "anchor_text": "CuPy"}, {"url": "https://towardsdatascience.com/use-cython-to-get-more-than-30x-speedup-on-your-python-code-f6cb337919b6", "anchor_text": "using Cython"}, {"url": "https://twitter.com/GeorgeSeif94", "anchor_text": "twitter"}, {"url": "https://www.linkedin.com/in/georgeseif/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4b920dda1f56---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4b920dda1f56---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----4b920dda1f56---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/technology?source=post_page-----4b920dda1f56---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4b920dda1f56---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b920dda1f56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&user=George+Seif&userId=e2af5c8737ec&source=-----4b920dda1f56---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b920dda1f56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&user=George+Seif&userId=e2af5c8737ec&source=-----4b920dda1f56---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b920dda1f56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4b920dda1f56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4b920dda1f56---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4b920dda1f56--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4b920dda1f56--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4b920dda1f56--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4b920dda1f56--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@george.seif94?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@george.seif94?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "George Seif"}, {"url": "https://medium.com/@george.seif94/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2af5c8737ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&user=George+Seif&userId=e2af5c8737ec&source=post_page-e2af5c8737ec--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc78596234267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-to-use-cupy-to-make-numpy-700x-faster-4b920dda1f56&newsletterV3=e2af5c8737ec&newsletterV3Id=c78596234267&user=George+Seif&userId=e2af5c8737ec&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}