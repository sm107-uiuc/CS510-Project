{"url": "https://towardsdatascience.com/multi-layer-perceptron-using-tensorflow-9f3e218a4809", "time": 1682993698.806902, "path": "towardsdatascience.com/multi-layer-perceptron-using-tensorflow-9f3e218a4809/", "webpage": {"metadata": {"title": "Multi-Layer perceptron using Tensorflow | by Aayush Agrawal | Towards Data Science", "h1": "Multi-Layer perceptron using Tensorflow", "description": "In this blog, we are going to build a neural network(multilayer perceptron) using TensorFlow and successfully train it to recognize digits in the image. Tensorflow is a very popular deep learning\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@aayushmnit/building-neural-network-from-scratch-9c88535bf8e9", "anchor_text": "previous blog", "paragraph_index": 0}, {"url": "https://github.com/aayushmnit/Deep_learning_explorations/blob/master/2_MLP_tensorflow/my1stNN.ipynb", "anchor_text": "jupyter notebook", "paragraph_index": 14}, {"url": "https://www.linkedin.com/in/aayushmnit/", "anchor_text": "LinkedIn", "paragraph_index": 14}, {"url": "http://aayushmnit.com", "anchor_text": "aayushmnit.com", "paragraph_index": 16}], "all_paragraphs": ["In this blog, we are going to build a neural network(multilayer perceptron) using TensorFlow and successfully train it to recognize digits in the image. Tensorflow is a very popular deep learning framework released by, and this notebook will guide to build a neural network with this library. If you want to understand what is a Multi-layer perceptron, you can look at my previous blog where I built a Multi-layer perceptron from scratch using Numpy.", "Let\u2019s start by importing our data. As Keras, a high-level deep learning library already has MNIST data as part of their default data we are just going to import the dataset from there and split it into train and test set.", "As we can see our current data have dimension N 28*28, we will start by flattening the image in N*784, and one-hot encode our target variable.", "Now we have processed the data, let\u2019s start building our multi-layer perceptron using tensorflow. We will begin by importing the required libraries.", "tf.InteractiveSession() is a way to run tensorflow model directly without instantiating a graph whenever we want to run a model. We will be building 784(Input)-512(Hidden layer 1)-256(Hidden layer 2)-10(Output) neural net model. Let\u2019s start our model construction by defining initialization variables.", "In tensorflow, we define a placeholder for our input variables and output variables and any variables we want to keep track of.", "As dense layers require weights and biases and they need to be initialized with a random normal distribution with zero mean and small variance (1/square root of the number of features).", "Now we will start writing the graph calculation to develop our 784(Input)-512(Hidden layer 1)-256(Hidden layer 2)-10(Output) model. We will multiply the input for each layer with its respective weights and add bias term. After weights and biases, we need to add an activation; we will use ReLU activation for hidden layers and softmax for the final output layer to get class probability score. Also to prevent overfitting; let \u2018s add some drop out after each hidden layer. Dropout is an essential concept in creating redundancies in our network which leads to better generalization.", "Now we need to define a loss function to optimize our weights and biases, and we will use softmax cross entropy with logits for the predicted and correct label. We will also add some L2 regularization to our network.", "Now we need to define an optimizer and learning rate for our network to optimize weights and biases on our given loss function. We will use exponential decay on our learning rate by every five epoch to reduce the learning by 15%. For optimizer, we are going to use Adam optimizer.", "We are done with our model construction. Let\u2019s define accuracy metric to evaluate our model performance as loss function is non-intuitive.", "We will now start training our network on train data and evaluate our network on test dataset simultaneously. We will be using batch optimization with size 128 and train it for 14 epochs to get 98%+ accuracy.", "Let\u2019s visualization train and test accuracy as a function of the number of epochs.", "As we can see we have successfully trained a Multi-Layer perceptron which was written in tensorflow with high validation accuracy!", "I hope you enjoyed reading, and feel free to use my code(also available in jupyter notebook) to try it out for your purposes. Also, if there is any feedback on code or just the blog post, feel free to reach out on LinkedIn or email me at aayushmnit@gmail.com.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Experienced data scientist. Passionate about solving interesting problems with data. All views are my own unless you share them. More on aayushmnit.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9f3e218a4809&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aayushmnit?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aayushmnit?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": "Aayush Agrawal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85dd669ac015&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&user=Aayush+Agrawal&userId=85dd669ac015&source=post_page-85dd669ac015----9f3e218a4809---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f3e218a4809&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f3e218a4809&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@aayushmnit/building-neural-network-from-scratch-9c88535bf8e9", "anchor_text": "previous blog"}, {"url": "https://github.com/aayushmnit/Deep_learning_explorations/blob/master/2_MLP_tensorflow/my1stNN.ipynb", "anchor_text": "jupyter notebook"}, {"url": "https://www.linkedin.com/in/aayushmnit/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9f3e218a4809---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9f3e218a4809---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----9f3e218a4809---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----9f3e218a4809---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9f3e218a4809---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9f3e218a4809&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&user=Aayush+Agrawal&userId=85dd669ac015&source=-----9f3e218a4809---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9f3e218a4809&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&user=Aayush+Agrawal&userId=85dd669ac015&source=-----9f3e218a4809---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f3e218a4809&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9f3e218a4809&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9f3e218a4809---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9f3e218a4809--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9f3e218a4809--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9f3e218a4809--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9f3e218a4809--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aayushmnit?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aayushmnit?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aayush Agrawal"}, {"url": "https://medium.com/@aayushmnit/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "414 Followers"}, {"url": "http://aayushmnit.com", "anchor_text": "aayushmnit.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85dd669ac015&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&user=Aayush+Agrawal&userId=85dd669ac015&source=post_page-85dd669ac015--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8137fc02bcb8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-layer-perceptron-using-tensorflow-9f3e218a4809&newsletterV3=85dd669ac015&newsletterV3Id=8137fc02bcb8&user=Aayush+Agrawal&userId=85dd669ac015&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}