{"url": "https://towardsdatascience.com/cross-validation-c4fae714f1c5", "time": 1683012393.517597, "path": "towardsdatascience.com/cross-validation-c4fae714f1c5/", "webpage": {"metadata": {"title": "Cross-Validation. Validating your Machine Learning Models\u2026 | by Kurtis Pykes | Towards Data Science", "h1": "Cross-Validation", "description": "Cross validation may be any of various model validation techniques that are used to assess how well a predictive model will generalize to an independent set of data that the model has not seen\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/jakubwasikowski/stratified-group-k-fold-cross-validation", "anchor_text": "Kaggle Notebook", "paragraph_index": 17}, {"url": "https://www.amazon.com/Approaching-Almost-Machine-Learning-Problem-ebook/dp/B089P13QHT", "anchor_text": "Approaching (almost) any Machine Learning Problem", "paragraph_index": 20}], "all_paragraphs": ["Cross validation may be any of various model validation techniques that are used to assess how well a predictive model will generalize to an independent set of data that the model has not seen before. Hence, it is typically employed in situations where we predict something and we want to gain a rough estimate of how well our predictive model will perform in practice.", "\u201cBefore Creating any Machine Learning Model, we must know what Cross Validation is and how to choose the best Cross Validation\u201d \u2014 Abhishek Thakur, Kaggle\u2019s first 4x Grandmaster", "By the end of this post you will have a good understanding of the popular cross validation techniques, how we can implement them using scikit-learn, and how to select the correct CV given a specific problem.", "Essentially, selecting the correct cross validation technique boils down to the data that we have on hand, hence why one choice of cross validation may or may not work for another set of data. However, the goal of employing a cross validation technique remains constant, we want to estimate the expected level of fit for of a predictive model on unseen data, since with this information we can make the necessary adaptations to make our predictive models (if required) or decide to use a totally different one.", "I may receive abuse from some experience Data Scientist, Machine Learning and/or Deep learning practitioners for improper terminology because cross validation often allows the predictive model to train and test on various splits whereas hold-out sets do not. Regardless, a hold-out based cross validation is when we split our data into a train and test set. This is often the first validation technique you\u2019d of implemented and the easiest to get your head around. It consist of quite literally dividing up your data into separate portions where you may train your predictive model on one set and test it on the test set.", "Note: Some people take this further and will have a training dataset, a validation dataset and test data set. The validation dataset will be used to tune the predictive model and the test set will be used to test how well the model generalizes.", "When dividing the data, something to keep in mind is that you\u2019d have to determine what proportion of the data is for training and what is for testing. I\u2019ve seen various splits from 60% (train)\u2014 40% (test) to 80% (train) \u2014 20% (test). I believe it is safe to say that a range from 60%-80% of your data should go towards training your predictive model and the remainder may go directly to the test set (or split again into validation and test sets).", "Performing the hold-out based validation technique is most effective when we have a very large dataset. As it is not required we test on various splits, this technique uses much less computational power hence making it the go-to strategy for validation on large datasets.", "I briefly touched on cross validation consist of above \u201ccross validation often allows the predictive model to train and test on various splits whereas hold-out sets do not.\u201d \u2014 In other words, cross validation is a resampling procedure. When \u201ck\u201d is present in machine learning discussions, it\u2019s often used to represent a constant value, for instance k in k-means clustering refers to the number of clusters and k in k Neareast Neighbors refers to the number of neighbors to consider when performing a plurality vote (for classification). This pattern holds true for K-Fold cross validation also, where k references the number of groups that a given data sample should be split into.", "In k-fold cross-validation, the original sample is randomly partitioned into k equal sized groups. From the k groups, one group would be removed as a hold-out set and the remaining groups would be the training data. The predictive model is then fit on the training data and evaluated on the hold-out set. This procedure is k times so that all groups have served exactly once as the hold-out set.", "Due to the ease of comprehension, k-fold cross validation is quite popular. and it often results in a less biased outcome than performing hold-out based validation. This technique is often a good starting point for Regression problems, although it may be better to use stratified k-fold if the distribution of the target variable is not consistent \u2014 which would require binning the target variable. Somethings to consider is the configuration of k which must split the data so that each train/test split of the data samples are large enough to be statistically representative of the broader dataset.", "Both of the techniques that we have covered till now are relatively effective in many scenarios, although misleading results (and potentially overall failure) can arise when the target data has imbalanced labels \u2014 I\u2019ve been careful not to only mention this as a problem for classification task because we can adjust a regression task in some ways for us to be able to perform stratified k-fold for validation. Instead, a better solution would be to split the randomly in such a way that we maintain the same class distribution in each subset \u2014 this is what we refer to as stratification.", "Note: Other than the way we randomly split the data, the stratified k-fold cross validation is the same as simple k-fold cross validation.", "According to the first 4X Kaggle Grandmaster, Abhishek Thakur, it is safe to say that if we have a standard classification task then applying stratified k-fold cross validation blindly is not a bad idea at all.", "Leave-one-out Cross validation may be thought of as a special case of k-fold cross validation where k = n and n is the number of samples within the original dataset. In other words, the data will be trained on n - 1 samples and will be used to predict the sample that was left out and this would be repeated n times so that each sample serves as the left out sample.", "This technique may require large computation time, and in that case k-fold cross validation may be a better solution. Alternatively, if the dataset is small then we would be losing plenty of data to the predictive model (especially if the cross validation is big) therefore making leave-one-out is a good solution in this situation.", "GroupKFold cross validation is another variation of k-fold cross validation which ensures the same group is not represented in the train and test set. For instance, if we would like to build a predictive model that classifies malignant or benign from images of patients skin, it is likely that we would have images from the same patient. Since we do not split a single patient across the training and test set we revert to GroupKfold instead of k-fold (or stratified k-fold for that matter) \u2014 therefore, the patients would be considered as groups.", "Note: Another variant of this technique is Stratified K-fold Cross Validation which is performed when we want to preserve the class distribution and we don\u2019t want the same group will not appear in two different folds. There is no inbuilt solution to this is scikit-learn, but there is a nice implementation in this Kaggle Notebook.", "Cross Validation is the first step to building Machine Learning Models and it\u2019s extremely important that we consider the data that we have when deciding what technique to employ \u2014 In some cases, it may even be necessary to adopt new forms of cross validation depending on the data.", "\u201cIf you have a good Cross Validation scheme in which validation data is representative of the training and real-world data, you will be able to build a good Machine Learning Model which is highly generalizable\u201d \u2014 Abhishek Thakur", "This story was highly inspired by the book Approaching (almost) any Machine Learning Problem (the link is not an affiliate link and I have not be asked to promote the book) by the first 4x Kaggle Grandmaster Abhishek Thakur. If you already have some experience with Machine Learning then and want more practical advice then I\u2019d highly recommend this book.", "If you\u2019d like to get in contact with me, I am most reachable on LinkedIn:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc4fae714f1c5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kurtispykes.medium.com/?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877----c4fae714f1c5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4fae714f1c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4fae714f1c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)", "anchor_text": "Wikipedia"}, {"url": "https://medium.com/u/c82c464daf80?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "Adi Bronshtein"}, {"url": "https://towardsdatascience.com/train-test-split-and-cross-validation-in-python-80b61beca4b6", "anchor_text": "Train/Test Split and Cross Validation in Python"}, {"url": "https://bit.ly/3fUuyOy", "anchor_text": "https://bit.ly/3fUuyOy"}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html", "anchor_text": "Scikit-Learn Documentation"}, {"url": "https://bit.ly/2POmqVb", "anchor_text": "https://bit.ly/2POmqVb"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html#sklearn.model_selection.StratifiedKFold", "anchor_text": "Scikit-Learn Documentation"}, {"url": "https://bit.ly/3iCHavo", "anchor_text": "https://bit.ly/3iCHavo"}, {"url": "https://www.google.com/url?sa=i&url=https%3A%2F%2Fcampus.datacamp.com%2Fcourses%2Fmodel-validation-in-python%2Fcross-validation%3Fex%3D10&psig=AOvVaw2sJGVDwGJwUQAawqZAHnW3&ust=1597337281376000&source=images&cd=vfe&ved=0CA0QjhxqFwoTCMjevKKPlusCFQAAAAAdAAAAABAD", "anchor_text": "DataCamp"}, {"url": "https://bit.ly/2POw0HU", "anchor_text": "https://bit.ly/2POw0HU"}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html", "anchor_text": "Scikit-Learn Documentation"}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html", "anchor_text": "https://scikit-learn.org/stable/modules/cross_validation.html"}, {"url": "https://www.kaggle.com/jakubwasikowski/stratified-group-k-fold-cross-validation", "anchor_text": "Kaggle Notebook"}, {"url": "https://www.amazon.com/Approaching-Almost-Machine-Learning-Problem-ebook/dp/B089P13QHT", "anchor_text": "Approaching (almost) any Machine Learning Problem"}, {"url": "https://www.linkedin.com/in/kurtispykes/", "anchor_text": "Kurtis Pykes - AI Writer - Towards Data Science | LinkedInView Kurtis Pykes' profile on LinkedIn, the world's largest professional community. Kurtis has 1 job listed on their\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c4fae714f1c5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c4fae714f1c5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c4fae714f1c5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c4fae714f1c5---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----c4fae714f1c5---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4fae714f1c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&user=Kurtis+Pykes&userId=5ba760786877&source=-----c4fae714f1c5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4fae714f1c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&user=Kurtis+Pykes&userId=5ba760786877&source=-----c4fae714f1c5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4fae714f1c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc4fae714f1c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c4fae714f1c5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c4fae714f1c5--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://kurtispykes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://www.fullstackfreelancershub.com/wisdom-wednesday", "anchor_text": "https://www.fullstackfreelancershub.com/wisdom-wednesday"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffde3d752d24c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-validation-c4fae714f1c5&newsletterV3=5ba760786877&newsletterV3Id=fde3d752d24c&user=Kurtis+Pykes&userId=5ba760786877&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}