{"url": "https://towardsdatascience.com/using-deep-learning-ai-to-predict-the-stock-market-9399cf15a312", "time": 1683006701.868289, "path": "towardsdatascience.com/using-deep-learning-ai-to-predict-the-stock-market-9399cf15a312/", "webpage": {"metadata": {"title": "I Tried Using Deep Learning to Predict the Stock Market | Towards Data Science", "h1": "I Tried Using Deep Learning to Predict the Stock Market", "description": "Using Deep Learning to predict/forecast stock prices. In Data Science, use neural networks to gain an advantage in the financial markets."}, "outgoing_paragraph_urls": [{"url": "https://www.investopedia.com/terms/t/technicalanalysis.asp", "anchor_text": "Technical Analysis", "paragraph_index": 1}, {"url": "https://pathmind.com/wiki/lstm", "anchor_text": "Recurrent Neural Network \u2014 LSTM", "paragraph_index": 2}, {"url": "https://marco-santos.medium.com/membership", "anchor_text": "Sign up for a Medium Membership here to gain unlimited access and support content like mine! With your support I earn a small portion of the membership fee. Thanks!", "paragraph_index": 6}, {"url": "https://finance.yahoo.com/quote/SPY/history?p=SPY", "anchor_text": "download the prices for SPY", "paragraph_index": 8}, {"url": "https://eodhistoricaldata.com/r/?ref=31CX3ILN", "anchor_text": "EOD Historical Data", "paragraph_index": 9}, {"url": "https://www.tensorflow.org/guide/keras", "anchor_text": "Tensorflow Keras", "paragraph_index": 13}, {"url": "https://towardsdatascience.com/predicting-bitcoin-prices-with-deep-learning-438bc3cf9a6f", "anchor_text": "previous article about Deep Learning and Bitcoin", "paragraph_index": 25}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 35}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 35}, {"url": "http://linkedin.com/in/marco-s-santos", "anchor_text": "linkedin.com/in/marco-s-santos", "paragraph_index": 37}], "all_paragraphs": ["Imagine being able to know when a stock is heading up or going down in the next week and then with the remaining cash you have, you would put all of your money to invest or short that stock. After playing the stock market with the knowledge of whether or not the stock will increase or decrease in value, you might end up a millionaire!", "Unfortunately, this is impossible because no one can know the future. However, we can make estimated guesses and informed forecasts based on the information we have in the present and the past regarding any stock. An estimated guess from past movements and patterns in stock price is called Technical Analysis. We can use Technical Analysis (TA)to predict a stock\u2019s price direction, however, this is not 100% accurate. In fact, some traders criticize TA and have said that it is just as effective in predicting the future as Astrology. But there are other traders out there who swear by it and have established long successful trading careers.", "In our case, the Neural Network we will be using will utilize TA to help it make informed predictions. The specific Neural Network we will implement is called a Recurrent Neural Network \u2014 LSTM. Previously we utilized an RNN to predict Bitcoin prices (see article below):", "In the article, we explored the usage of LSTM to predict Bitcoin prices. We delved a little bit into the background of an LSTM model and gave instructions on how to program one to predict BTC prices. However, we limited the input data to Bitcoin\u2019s own price history and did not include other variables like technical indicators such as volume or moving averages.", "Since the last RNN we constructed could only take in one sequence (past closing prices) to predict the future, we wanted to see if it would be possible to add even more data to the Neural Network. Maybe these other pieces of data could enhance our price forecasts? Perhaps by adding in TA indicators to our dataset, the Neural Network might be able to make much more accurate predictions? \u2014 Which is exactly what we want to accomplish here.", "In the next few sections, we will be constructing a new Recurrent Neural Network with the capability to take in not just one piece but multiple pieces of information in the form of technical indicators in order to forecast future prices in the stock market.", "Sign up for a Medium Membership here to gain unlimited access and support content like mine! With your support I earn a small portion of the membership fee. Thanks!", "In order to use a Neural Network to predict the stock market, we will be utilizing prices from the SPDR S&P 500 (SPY). This will give us a general overview of the stock market and by using an RNN we might be able to figure out which direction the market is heading.", "To retrieve the right data for our Neural Network, you will need to head over to Yahoo Finance and download the prices for SPY. We will be downloading five years worth of price history for SPY as a convenient .csv file.", "Another option would be to use a financial data API such as EOD Historical Data. It is free to sign up and you\u2019ll have access to vast amounts of datasets. Disclosure: I earn a small commission from any purchases made through the link above.", "After we have downloaded the price history for SPY, we can apply a Technical Analysis Python library to produce the Technical Indicator values. A more in depth look into the process from which we were able to retrieve the indicator values was covered here:", "The article above goes over the exact TA Python library we utilized in order to retrieve the indicator values for SPY.", "Let\u2019s begin coding out our Neural Network by first importing some libraries:", "First, we imported some of the usual Python libraries (numpy, pandas, etc). Next, we imported the technical analysis library we previously utilized to create Technical Indicators for BTC (covered in the article above). Then, we imported the Neural Network library from Tensorflow Keras. After importing the necessary libraries, we\u2019ll load in the SPY.csv file we downloaded from Yahoo Finance.", "After loading in the data, we\u2019ll need to perform some preprocessing in order to prepare our data for the neural network and one of the first things we\u2019ll need to do is convert the DataFrame\u2019s index into the Datetime format. Then we will set the Date column in our data as the index for the DF.", "Next, we\u2019ll create some technical indicators by using the ta library. To cover as much technical analysis as possible, we\u2019ll use all the indicators available to us from the library. Then, drop everything else besides the indicators and the Closing prices from the dataset.", "Once we have created the technical indicator values, we can then eliminate some rows from our original dataset. We will only be including the last 1000 rows of data in order to have a more accurate representation of the current market climate.", "When scaling our data, there are multiple approaches to take to make sure our data is still accurately represented. It may be useful to experiment with different scalers to see their effect on model performance.", "In our case, we will be utilizing RobustScaler to scale our data. This is done so that extreme outliers will have little effect and hopefully improve training time and overall model performance.", "Before we start constructing the neural network, let\u2019s create some helper functions to better optimize the process. We\u2019ll explain each function in detail.", "In order to appropriately format our data, we will need to split the data into two sequences. The length of these sequences can be modified but we will be using the values from the last 90 days to predict prices for the next 30 days. The split_sequence function will then format our data into the appropriate X and y variables where X contains the closing prices and indicators for the past 90 days and y contains the closing prices for the next 30 days.", "What our NN will do with this information is learn how the last 90 days of closing prices and technical indicator values affect the next 30 days of closing prices.", "Now we can begin constructing our Neural Network! The following code is how we construct our NN with custom layers and nodes.", "This is where we begin experimenting with the parameters for:", "The values we input for each of these parameters will have to be explored as each value can have a significant effect on the overall model\u2019s quality. There are probably methods out there to find the optimum values for each parameter. For our case we subjectively tested out different values for each parameter and the best ones we found can be seen in the code snippet above.", "If you wish to know more about the reasoning and concepts behind these variables, then it is suggested that you read our previous article about Deep Learning and Bitcoin.", "After training, we will visualize the progress of our Neural Network with our custom helper function:", "As our network trains, we can see that the Loss decreasing and Accuracy increasing. As a general rule, we are looking for the two lines to converge or align together as the number of epochs increases. If they do not, then that is a sign that the model is inadequate and we will need to go back and change some parameters.", "Another way we can evaluate the quality of our model\u2019s predictions is to test it against the actual values and calculate the RMSE with our custom helper function: val_rmse.", "Here we plot the predicted values with the actual values to see how well the compare. If the plot of the predicted values are extremely off and nowhere near the actual values, then we know that our model is deficient. However, if the values appear visually close and the RMSE is very low, then we can conclude that our model is acceptable.", "Our model seems to do well in the beginning but it cannot capture or model some intense movements in the price. This is probably why the last three predictions appear very far off. Perhaps with more training and experimentation our model could anticipate those movements.", "Once we are satisfied with how well our model performs, then we can use it to predict future values. This part is fairly simply relative to what we have already done.", "Here we are just predicting off of the most recent values we have from the downloaded .csv file. Once we run the code we are presented with the following forecast:", "And there we have it! \u2014 The forecasted prices for SPY. Do what you wish with this knowledge but remember one thing: the stock market is unpredictable. The values predicted here are not certain. They may be better than just randomly guessing since the values are educated guesses based on the Technical Indicators and price patterns from the past.", "We were able to successfully construct a Recurrent Neural Network of LSTM layers that is able to take in multiple inputs rather than just one. The quality of the model may vary from person to person depending on how much time they wish to spend on it. These predictions can be extremely useful for those wishing to gain some insight into the future price movement of a stock even though predicting the future isn\u2019t possible. But, it is likely to believe that this way is better than randomly guessing.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "NYC Data Scientist specializing in AI/ML with a passion for code | Let\u2019s connect! \u2014 linkedin.com/in/marco-s-santos."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9399cf15a312&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9399cf15a312--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9399cf15a312--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://marco-santos.medium.com/?source=post_page-----9399cf15a312--------------------------------", "anchor_text": ""}, {"url": "https://marco-santos.medium.com/?source=post_page-----9399cf15a312--------------------------------", "anchor_text": "Marco Santos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe06d69ac26aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&user=Marco+Santos&userId=e06d69ac26aa&source=post_page-e06d69ac26aa----9399cf15a312---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9399cf15a312&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9399cf15a312&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@till_indeman?utm_source=medium&utm_medium=referral", "anchor_text": "Vladimir Solomyani"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.investopedia.com/terms/t/technicalanalysis.asp", "anchor_text": "Technical Analysis"}, {"url": "https://pathmind.com/wiki/lstm", "anchor_text": "Recurrent Neural Network \u2014 LSTM"}, {"url": "https://towardsdatascience.com/predicting-bitcoin-prices-with-deep-learning-438bc3cf9a6f", "anchor_text": "I Tried Deep Learning Models to Predict Bitcoin PricesUsing Neural Networks to Forecast Bitcoin Pricestowardsdatascience.com"}, {"url": "https://marco-santos.medium.com/membership", "anchor_text": "Sign up for a Medium Membership here to gain unlimited access and support content like mine! With your support I earn a small portion of the membership fee. Thanks!"}, {"url": "https://finance.yahoo.com/quote/SPY/history?p=SPY", "anchor_text": "download the prices for SPY"}, {"url": "https://eodhistoricaldata.com/r/?ref=31CX3ILN", "anchor_text": "EOD Historical Data"}, {"url": "https://towardsdatascience.com/technical-indicators-on-bitcoin-using-python-c392b4a33810", "anchor_text": "How I Coded Technical Indicators for BitcoinUse Python to Create Technical Indicators for Bitcointowardsdatascience.com"}, {"url": "https://www.tensorflow.org/guide/keras", "anchor_text": "Tensorflow Keras"}, {"url": "https://towardsdatascience.com/predicting-bitcoin-prices-with-deep-learning-438bc3cf9a6f", "anchor_text": "previous article about Deep Learning and Bitcoin"}, {"url": "https://eodhistoricaldata.com/financial-academy/extracting-the-knowledge-from-the-data/i-tried-using-deep-learning-to-predict-the-stock-market/", "anchor_text": "Additionally published in eodhistoricaldata.com"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://github.com/marcosan93/Price-Forecaster", "anchor_text": "marcosan93/Price-ForecasterUsing Time Series models: SARIMA and FB Prophet to forecast Bitcoin prices: Using a Recurrent Neural Network: LSTM\u2026github.com"}, {"url": "https://towardsdatascience.com/predicting-bitcoin-prices-with-deep-learning-438bc3cf9a6f", "anchor_text": "I Tried Deep Learning Models to Predict Bitcoin PricesUsing Neural Networks to Forecast Bitcoin Pricestowardsdatascience.com"}, {"url": "https://towardsdatascience.com/technical-indicators-on-bitcoin-using-python-c392b4a33810", "anchor_text": "How I Coded Technical Indicators for BitcoinUse Python to Create Technical Indicators for Bitcointowardsdatascience.com"}, {"url": "https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/", "anchor_text": "How to Develop LSTM Models for Time Series Forecasting - Machine Learning MasteryLong Short-Term Memory networks, or LSTMs for short, can be applied to time series forecasting. There are many types of\u2026machinelearningmastery.com"}, {"url": "https://medium.com/tag/finance?source=post_page-----9399cf15a312---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9399cf15a312---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----9399cf15a312---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/tag/technology?source=post_page-----9399cf15a312---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/money?source=post_page-----9399cf15a312---------------money-----------------", "anchor_text": "Money"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9399cf15a312&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&user=Marco+Santos&userId=e06d69ac26aa&source=-----9399cf15a312---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9399cf15a312&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&user=Marco+Santos&userId=e06d69ac26aa&source=-----9399cf15a312---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9399cf15a312&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9399cf15a312--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9399cf15a312&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9399cf15a312---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9399cf15a312--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9399cf15a312--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9399cf15a312--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9399cf15a312--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9399cf15a312--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9399cf15a312--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9399cf15a312--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9399cf15a312--------------------------------", "anchor_text": ""}, {"url": "https://marco-santos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://marco-santos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Santos"}, {"url": "https://marco-santos.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.3K Followers"}, {"url": "http://linkedin.com/in/marco-s-santos", "anchor_text": "linkedin.com/in/marco-s-santos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe06d69ac26aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&user=Marco+Santos&userId=e06d69ac26aa&source=post_page-e06d69ac26aa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc323f276f5e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-ai-to-predict-the-stock-market-9399cf15a312&newsletterV3=e06d69ac26aa&newsletterV3Id=c323f276f5e0&user=Marco+Santos&userId=e06d69ac26aa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}