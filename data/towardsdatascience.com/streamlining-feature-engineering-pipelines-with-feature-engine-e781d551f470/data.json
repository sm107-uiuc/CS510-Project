{"url": "https://towardsdatascience.com/streamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470", "time": 1683015545.0057669, "path": "towardsdatascience.com/streamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470/", "webpage": {"metadata": {"title": "Streamlining Feature Engineering Pipelines with Feature-engine | by Sole from Train in Data | Towards Data Science", "h1": "Streamlining Feature Engineering Pipelines with Feature-engine", "description": "In many organizations, we create machine learning models that process a group of input variables to output a prediction. Some of these models predict for example the likelihood of a loan being\u2026"}, "outgoing_paragraph_urls": [{"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature-engine", "paragraph_index": 2}, {"url": "https://trainindata.medium.com/feature-engineering-for-machine-learning-a-comprehensive-overview-a7ad04c896f8", "anchor_text": "elsewhere", "paragraph_index": 5}, {"url": "https://www.courses.trainindata.com/p/feature-engineering-for-machine-learning", "anchor_text": "Feature Engineering for Machine Learning", "paragraph_index": 5}, {"url": "https://packt.link/0ewSo", "anchor_text": "Python Feature Engineering Cookbook", "paragraph_index": 5}, {"url": "https://www.forbes.com/sites/gilpress/2016/03/23/data-preparation-most-time-consuming-least-enjoyable-data-science-task-survey-says/", "anchor_text": "survey by Forbes", "paragraph_index": 6}, {"url": "https://www.featuretools.com/", "anchor_text": "Featuretools", "paragraph_index": 15}, {"url": "https://pypi.org/project/category-encoders/", "anchor_text": "Category encoders", "paragraph_index": 15}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "Scikit-learn", "paragraph_index": 15}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature-engine", "paragraph_index": 15}, {"url": "https://opensource.com/life/15/12/why-open-source", "anchor_text": "this article", "paragraph_index": 18}, {"url": "https://www.udemy.com/course/feature-engineering-for-machine-learning/?referralCode=A855148E05283015CF06", "anchor_text": "Feature Engineering for Machine Learning", "paragraph_index": 19}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature engine", "paragraph_index": 21}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature engine", "paragraph_index": 22}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "documentation", "paragraph_index": 24}, {"url": "http://www.trainindata.com", "anchor_text": "www.trainindata.com", "paragraph_index": 26}, {"url": "http://eepurl.com/hdzffv", "anchor_text": "http://eepurl.com/hdzffv", "paragraph_index": 26}], "all_paragraphs": ["In many organizations, we create machine learning models that process a group of input variables to output a prediction. Some of these models predict for example the likelihood of a loan being repaid, the probability of an application being fraudulent, if a car should be repaired or replaced after an accident, whether the customer is going to churn, and much more.", "The raw data collected and stored by the organizations is almost never suitable to train new machine learning models, or be consumed by existing models to produce a prediction. Instead, we perform an extensive amount of transformation before the variables can be utilized by machine learning algorithms. The collection of variable transformations are commonly referred to as feature engineering.", "In this article we are going to describe the most common challenges encountered when building and deploying feature engineering and machine learning pipelines, and how utilizing open source software and a new Python library called Feature-engine, can help mitigate some of these challenges.", "Feature engineering is the process of using domain knowledge of the data to create features that make machine learning algorithms work. There are several aspects in raw data that need to be addressed. For example, very often data is missing, or variable values take the form of strings instead of numbers. Many machine learning libraries, like Scikit-learn are unable to process missing values or strings, thus we need to transform these into numerical values. In addition, some models tend to work better when the variables show certain characteristics like a normal distribution or similar scales. Thus, we try to transform variables to make them take these characteristics.", "Feature engineering includes data transformation procedures to tackle all of these aspects, including imputation of missing data, encoding of categorical variables, transformation or discretization of numerical variables, and setting features in similar scales. In addition, feature engineering also involves feature creation by combination of existing features into new variables, or by extracting information from dates, aggregating transaction data, or deriving features from time series, text or even images.", "In summary, Feature engineering includes every aspect of data transformation and new data creation to return datasets fit to train and be consumed by machine learning models. I described extensively the different feature engineering techniques elsewhere. More details and code implementations can be found in the course \u201cFeature Engineering for Machine Learning \u201d and the book \u201cPython Feature Engineering Cookbook\u201d.", "According to a survey by Forbes, data scientists and machine learning engineers spend around 60% of their time cleaning and organizing data for analysis and machine learning, or in other words, in data transformation and feature engineering.", "Feature engineering can be quite repetitive and data scientists tend to carry out the same types of transformations to the various data sources that will be used to create the different machine learning models. Most data sources show the same challenges: lack of information or missing data, variables in forms of strings instead of numbers, distributions that are not optimal for the performance of the machine learning model we intend to build or different scales. Thus, we find ourselves doing the same type of data transformations over and over, model after model. If every time we do this, we start coding from scratch, the whole process becomes extremely inefficient.", "We should strive to minimize repetition and duplicate code, and optimize reliability, to improve performance and efficiency and also reduce the time data scientists spend on data processing. If data scientists spend less time cleaning and pre-processing data, they will be able to spend more time creating innovative solutions, tackling more interesting challenges and learning and developing in other areas.", "Feature engineering is very repetitive and we tend to carry out the same transformations to several of our data sources. Coding these transformations from scratch every time, or copying and pasting code from one notebook to the other is very inefficient and poor practice.", "In scenarios like these, working in teams brings the additional complication that we could end up with different code implementations of the same techniques both in the research and production environments, each one developed by a different team member. This is not only inefficient, but it also makes it very difficult to track what has been done in the team. We end up with multiple sources or versions of same code, with little, if any, code standardization, versioning and testing.", "It is generally preferred to create or use tools that can be shared across the team. Common tools have several advantages: first, we don\u2019t need to re-write our pipelines from scratch in every project, and also, they facilitate knowledge sharing. When all members can read from and use existing libraries, they can learn from each other, and develop theirs skills and that of their colleagues faster.", "It is also worth considering that, as data scientists research and develop machine learning models, code testing and unit testing is often omitted or forgotten. During procedural programming, frequently used within in Jupyter notebooks, inputs derived from previous commands, tend to be re-engineered and re-assigned over and over, and then used to train the machine learning models. This process makes it hard to track transformations and code dependencies, which in itself can contain bugs, and thus can lead to bug propagation and difficulty to debug.", "Reproducibility is the ability to duplicate a machine learning model exactly, such that given the same raw data as input, both models return the same output. And this is ultimately, what we aim to achieve between the models we develop in the research environment and deploy in the production environment.", "Refactoring the feature engineering pipelines developed in the research environment to add unit tests, and integration tests in the production environment, is extremely time consuming, provide new opportunities to introduce bugs, or find bugs introduced during model development. More importantly, refactoring code that achieves the same outcome, but was written by different developers, is extremely inefficient. Ultimately, we want to utilize the same code in our research and production environment, to minimize the deployment timeline and maximize reproducibility.", "In the last few years, a growing number of open source Python libraries began to support feature engineering as part of the machine learning pipeline. Among these, the library Featuretools supports an exhaustive array of functions to work with transaction data and time series; the library Category encoders supports a comprehensive selection of methods to encode categorical variables; and the libraries Scikit-learn and Feature-engine support a wide range of transformations including imputation, categorical encoding, discretization and mathematical transformations, among others.", "Using open source software, helps data scientists reduce the amount of time they spend on feature transformation, improves code sharing standards across the team, and allows the use of well versioned and tested code, minimizing deployment timelines while maximizing reproducibility. In other words, open source allows us to use the same code, with clear versions both in the research and development environment, therefore removing or minimizing the amount of code that needs to be refactored to be put into production.", "Why using well established open source projects is more efficient? For multiple reasons, first open source projects tend to be thoroughly documented, so it is clear what each piece of code intends to achieve. Second, well established projects have been widely adopted and approved by the community, giving us peace of mind that the code is of quality and will be maintained and improved in the years to come. Third, open source packages are extensively tested to prevent the introduction of bugs and maximize reproducibility. Fourth, packages are clearly versioned, so we can navigate to more modern, or previous implementations of the code, to obtain the desired results. Fifth, open source packages can be shared, facilitating the adoption and spread of knowledge. And finally utilizing open source packages removes the task of coding from our hands, improving team performance, reproducibility and collaboration dramatically.", "An extensive discussion on why we should use open source can be found in this article.", "Feature-engine is an open source Python library that I created to simplify and streamline the implementation of and end-to-end feature engineering pipeline. Feature-engine was originally designed to accompany the course Feature Engineering for Machine Learning but has been now adopted by the community, and has a growing number of contributors to the code base.", "Feature-engine preserves Scikit-learn functionality with the methods fit() and transform() to learn parameters from and then transform the data. Keep in mind that many feature engineering techniques, need to learn parameters from the data, like statistical values or encoding mappings, to transform data. The Scikit-learn like functionality with the fit and transform methods makes Feature-engine easy use.", "Feature engine includes multiple transformers to impute missing data, encode categorical variables, discretize or transform numerical variables and remove outliers, thus providing the most exhaustive battery of feature engineering transformations", "Some key characteristics of Feature engine transformers are that i) it allows the selection of the variable subsets to transform directly at the transformer, ii) it takes in a dataframe and returns a dataframe, facilitating both data exploration and model deployment and iii) it automatically recognizes numerical and categorical variables, thus applying the right pre-processing to the right feature subsets.", "Feature-engine transformers can be assembled within a Scikit-learn pipeline, making it possible to store an entire machine learning pipeline into a single object which can be saved and retrieved at a later stage for batch scoring, or placed in memory, for live scoring.", "Feature-engine is being actively developed and welcomes feedback from users and contributions from the community. More details on how to use Feature-engine can be found in its documentation and in this article:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist, book author, online instructor (www.trainindata.com) and Python open-source developer. Get our regular updates: http://eepurl.com/hdzffv"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe781d551f470&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e781d551f470--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e781d551f470--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://trainindata.medium.com/?source=post_page-----e781d551f470--------------------------------", "anchor_text": ""}, {"url": "https://trainindata.medium.com/?source=post_page-----e781d551f470--------------------------------", "anchor_text": "Sole from Train in Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97dedb58f477&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&user=Sole+from+Train+in+Data&userId=97dedb58f477&source=post_page-97dedb58f477----e781d551f470---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe781d551f470&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe781d551f470&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature-engine"}, {"url": "https://trainindata.medium.com/feature-engineering-for-machine-learning-a-comprehensive-overview-a7ad04c896f8", "anchor_text": "elsewhere"}, {"url": "https://www.courses.trainindata.com/p/feature-engineering-for-machine-learning", "anchor_text": "Feature Engineering for Machine Learning"}, {"url": "https://packt.link/0ewSo", "anchor_text": "Python Feature Engineering Cookbook"}, {"url": "https://www.forbes.com/sites/gilpress/2016/03/23/data-preparation-most-time-consuming-least-enjoyable-data-science-task-survey-says/", "anchor_text": "survey by Forbes"}, {"url": "https://www.featuretools.com/", "anchor_text": "Featuretools"}, {"url": "https://pypi.org/project/category-encoders/", "anchor_text": "Category encoders"}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "Scikit-learn"}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature-engine"}, {"url": "https://opensource.com/life/15/12/why-open-source", "anchor_text": "this article"}, {"url": "https://www.udemy.com/course/feature-engineering-for-machine-learning/?referralCode=A855148E05283015CF06", "anchor_text": "Feature Engineering for Machine Learning"}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature engine"}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature engine"}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "documentation"}, {"url": "https://trainindata.medium.com/feature-engine-a-new-open-source-python-package-for-feature-engineering-29a0ab88ea7c", "anchor_text": "Feature-engine: A new open source Python package for feature engineeringFeature-engine is an open source Python library with the most exhaustive battery of transformers to engineer features\u2026trainindata.medium.com"}, {"url": "https://www.courses.trainindata.com/p/feature-engineering-for-machine-learning", "anchor_text": "Feature Engineering for Machine Learning"}, {"url": "https://packt.link/0ewSo", "anchor_text": "Python Feature Engineering Cookbook"}, {"url": "https://feature-engine.readthedocs.io/en/latest/", "anchor_text": "Feature-engine"}, {"url": "https://trainindata.medium.com/feature-engine-a-new-open-source-python-package-for-feature-engineering-29a0ab88ea7c", "anchor_text": "Feature-engine: A new open source Python package for feature engineering"}, {"url": "https://towardsdatascience.com/practical-code-implementations-of-feature-engineering-for-machine-learning-with-python-f13b953d4bcd", "anchor_text": "Practical Code Implementations of Feature Engineering with Python"}, {"url": "https://trainindata.medium.com/feature-engineering-for-machine-learning-a-comprehensive-overview-a7ad04c896f8", "anchor_text": "Feature Engineering for Machine Learning: A comprehensive Overview"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----e781d551f470---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e781d551f470---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/machine-learning-pipeline?source=post_page-----e781d551f470---------------machine_learning_pipeline-----------------", "anchor_text": "Machine Learning Pipeline"}, {"url": "https://medium.com/tag/ml-model-deployment?source=post_page-----e781d551f470---------------ml_model_deployment-----------------", "anchor_text": "Ml Model Deployment"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----e781d551f470---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe781d551f470&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&user=Sole+from+Train+in+Data&userId=97dedb58f477&source=-----e781d551f470---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe781d551f470&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&user=Sole+from+Train+in+Data&userId=97dedb58f477&source=-----e781d551f470---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe781d551f470&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e781d551f470--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe781d551f470&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e781d551f470---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e781d551f470--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e781d551f470--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e781d551f470--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e781d551f470--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e781d551f470--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e781d551f470--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e781d551f470--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e781d551f470--------------------------------", "anchor_text": ""}, {"url": "https://trainindata.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://trainindata.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sole from Train in Data"}, {"url": "https://trainindata.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "http://www.trainindata.com", "anchor_text": "www.trainindata.com"}, {"url": "http://eepurl.com/hdzffv", "anchor_text": "http://eepurl.com/hdzffv"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97dedb58f477&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&user=Sole+from+Train+in+Data&userId=97dedb58f477&source=post_page-97dedb58f477--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F59cf9de246a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlining-feature-engineering-pipelines-with-feature-engine-e781d551f470&newsletterV3=97dedb58f477&newsletterV3Id=59cf9de246a4&user=Sole+from+Train+in+Data&userId=97dedb58f477&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}