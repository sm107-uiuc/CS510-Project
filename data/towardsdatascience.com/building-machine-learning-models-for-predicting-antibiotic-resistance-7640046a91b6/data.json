{"url": "https://towardsdatascience.com/building-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6", "time": 1683001004.202074, "path": "towardsdatascience.com/building-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6/", "webpage": {"metadata": {"title": "Building Machine Learning Models for Predicting Antibiotic Resistance | by Nicole Wheeler | Towards Data Science", "h1": "Building Machine Learning Models for Predicting Antibiotic Resistance", "description": "This month, I ran a workshop for around 25 computer science students in Cluj-Napoca, Romania. The workshop was part of a two-day symposium on ML in biology, organised by the Romanian Society of\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.rsbi.ro", "anchor_text": "Romanian Society of Bioinformatics", "paragraph_index": 0}, {"url": "http://kaggle.com", "anchor_text": "Kaggle", "paragraph_index": 12}, {"url": "https://www.kaggle.com/nwheeler443/gono-unitigs", "anchor_text": "run entirely on Kaggle", "paragraph_index": 29}], "all_paragraphs": ["This month, I ran a workshop for around 25 computer science students in Cluj-Napoca, Romania. The workshop was part of a two-day symposium on ML in biology, organised by the Romanian Society of Bioinformatics.", "Based on a previous poll, there was huge interest among BSc, MSc and PhD computer science students to learn about applications of ML in medicine and biology. Most of the students attending the session had studied machine learning algorithms during their undergrad studies, but were interested in learning more about bioinformatics/biology.", "My role in the workshop was to deliver a one-hour talk on ML for predicting antibiotic resistance, and then to run a two-hour hands-on workshop for a subset of the students. I aimed to introduce the students to ML applications in identifying antibiotic resistant bacteria, and get them thinking about some of the current limitations of the standard methods we use for ML in applying these to bacterial genome data, and ways to go beyond these.", "Bacterial infections that don\u2019t respond to treatment are a growing concern. Currently antimicrobial resistant infections kill over 700,000 people per year, and by 2050 its estimated 10 million people will die from of antimicrobial resistant infections unless we make significant changes to the way we develop and use antibiotics.", "Machine learning algorithms that predict antibiotic resistance from whole genome sequences could improve our ability to recognise and contain new resistant strains. In the near future it could be possible to sequence the DNA of the bacteria causing an infection within a few hours of collecting a sample, then analyse this DNA sequence data to predict which antibiotics could be successfully used to treat the infection.", "Drug resistance in Neisseria gonorrhoeae, the bacteria that cause gonorrhoea is a particularly big problem, with gonorrhoea infections resistant to all available antibiotics showing up around the world. Gonorrhoea is the second most common sexually transmitted infection (STI) in Europe, after chlamydia. Rates of gonorrhoea infection are on the rise, with a 26% increase in cases reported from 2017\u20132018 in the UK.", "Many people who are infected experience no symptoms, which helps infections to spread. If left untreated, the infection can cause infertility in both men and women, or lead to life-threatening ectopic pregnancies. Babies born to mothers with gonorrhoea can develop an eye infection that causes permanent sight loss if not treated.", "In the past, patients were treated with an antibiotic called ciprofloxacin. Doctors have now stopped treating infections with this antibiotic because resistance to the drug became too common, causing treatments to fail. Until very recently, the recommended treatment was two drugs \u2014 ceftriaxone and azithromycin. But, azithromycin has since been removed from UK treatment recommendations because of concern over rising resistance to the antibiotic. Currently in the UK, patients are only treated with ceftriaxone.", "In February 2018, the first ever reported case of resistance to all of the usual treatments was reported, and this year two women in the UK contracted the disease without leaving the country, suggesting drug resistance is here to stay.", "A number of drugs have been removed from treatment recommendations over the years because of increasing resistance, but each of these antibiotics can still be used to treat some infections, meaning that if we can confidently predict antibiotic resistance, we can return these antibiotics to use.", "Everyone who attended the workshop also attended my talk, which introduced people to our growing concerns around antibiotic resistant bacterial infections, and ways in which machine learning algorithms could be built into point-of-care diagnostics to help reduce or eliminate the spread of antibiotic resistance.", "The workshop was designed to let people see the data for themselves, and use it to build machine learning algorithms. Having not designed a workshop before, I wasn\u2019t sure how much material to prepare for a 2 hour time slot, so I designed the activity to have a simple basis, with multiple options for follow-on work, which let participants do what interested them.", "I ran the workshop using Kaggle, since it allowed me to upload the data and make it accessible through a simple interface, which allowed the inclusion of extra information to give the data context. I created a starter notebook that took participants through reading in and looking at the data, then building some simple models and assessing their performance.", "For this exercise, we worked with unitigs, segments of DNA shared by strains in our collection. These are produced by taking the DNA from different bacteria that we\u2019ve pieced together after sequencing their genomes, then breaking it into different 31-character words. These words are then assembled into a De Bruijn graph (DBG). This graph is pieced together by identifying words that overlap internally, and are present in the same samples.", "To learn more about unitigs, read this paper:", "This process allows us to represent the similarities and differences between these different bacteria in an efficient way. The differences can be individual mutations, pieces of DNA that have been inserted or deleted, or other genetic elements called plasmids, which can pass between bacteria and spread antibiotic resistance.", "Usually when working with unitigs, the number of variables may range between 0.5\u20135 million, but for the purpose of the exercise I first ran an association study to identify unitigs that were significantly associated with resistance to make the analysis run faster.", "The filtering resulted in 8,873 unitigs strongly associated with ciprofloxacin resistance and 515 unitigs significantly associated with azithromycin resistance, for a dataset containing 3,971 samples.", "We looked at four different model types:", "We also looked at two resistance profiles:", "I put together a simple model training notebook, which split the data into five folds for cross-validation, and within each of those performed a grid search across possible hyper-parameters, again using 5-fold cross-validation.", "Using this function, we could compare the performances of the different model types across datasets.", "The participants had a few options for next steps. The other things they could do in the subsequent sections are:", "Azithromycin (AZM) prediction performance was high across the more complex ML methods we tested. While the performance of model types was very similar, the random forest learned about resistance at a much smaller sample size.", "By the end of training, both models had learned to search for the same unitig, which contained a mutation in the 23S ribosomal RNA which is responsible for most high-level AZM resistance.", "Ciprofloxacin resistance can usually be predicted in any species by looking for one or two mutations that cause the vast majority of resistance. In this sense, they are easy models to build, but ML models can sometimes have trouble building a model that isn\u2019t cluttered with extraneous information.", "Below, we can see that the random forest has found a nice solution to the problem, but the SVM appears to have over-fit. Both models don\u2019t look like they\u2019d particularly benefit from the collection of more samples.", "When I looked into what the models had learned, I was disappointed to see that while both models were quite accurate, the major mutation that we know drives resistance hadn\u2019t been chosen as a top feature by either of these models, suggesting the models had found an alternative solution to accurately predicting resistance that didn\u2019t involve the actual resistance mechanism.", "This is a relatively common problem in ML in this area \u2014 there are so many variables, and so few samples, that spurious associations can form in the data. It\u2019s possible this high performance is due to the model identifying unitigs that flag major families of resistant strains rather than real resistance mechanisms. The best way of diagnosing this would be to see where the unitigs fall on a phylogenetic tree of the isolates.", "The workshop was run entirely on Kaggle, so you can try the workshop for yourself.", "I learned how to build ML models primarily from following peoples\u2019 notebooks on Kaggle, so my hope is that other people working in this area will find the dataset and workbook a nice introduction to the subject.", "Now that I\u2019ve got a starting point for a workshop, I plan to make improvements to it over time and run it in more settings, particularly for people who haven\u2019t got as much experience with machine learning.", "I\u2019d also like to explore the possibility of including an updated/augmented version of the notebook in a publication, to let other people easily replicate and tweak the analysis.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Bioinformatician + data scientist, building machine learning algorithms for the detection of emerging infectious threats to human health"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7640046a91b6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7640046a91b6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7640046a91b6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nwheeler443.medium.com/?source=post_page-----7640046a91b6--------------------------------", "anchor_text": ""}, {"url": "https://nwheeler443.medium.com/?source=post_page-----7640046a91b6--------------------------------", "anchor_text": "Nicole Wheeler"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3b4466954e30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&user=Nicole+Wheeler&userId=3b4466954e30&source=post_page-3b4466954e30----7640046a91b6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7640046a91b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7640046a91b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markusspiske?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Markus Spiske"}, {"url": "https://unsplash.com/collections/4353513/my-first-collection/a193056e4c3aeb1aa7eb2b4b2c608dc8?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://www.rsbi.ro", "anchor_text": "Romanian Society of Bioinformatics"}, {"url": "https://www.mdpi.com/2079-6382/7/3/60", "anchor_text": "Whittles et al. 2018"}, {"url": "https://www.bbc.co.uk/news/health-43571120", "anchor_text": "Man has 'world's worst' super-gonorrhoeaA man in the UK has caught the world's \"worst-ever\" case of super-gonorrhoea. He had a regular partner in the UK, but\u2026www.bbc.co.uk"}, {"url": "http://kaggle.com", "anchor_text": "Kaggle"}, {"url": "https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1007758", "anchor_text": "A fast and agnostic method for bacterial genome-wide association studies: Bridging the gap between\u2026Author summary Genome-wide association studies (GWAS) help explore the genetic bases of phenotype variation in a\u2026journals.plos.org"}, {"url": "https://www.kaggle.com/nwheeler443/gono-unitigs", "anchor_text": "run entirely on Kaggle"}, {"url": "https://medium.com/tag/health?source=post_page-----7640046a91b6---------------health-----------------", "anchor_text": "Health"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7640046a91b6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/antibiotic-resistance?source=post_page-----7640046a91b6---------------antibiotic_resistance-----------------", "anchor_text": "Antibiotic Resistance"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7640046a91b6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----7640046a91b6---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7640046a91b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&user=Nicole+Wheeler&userId=3b4466954e30&source=-----7640046a91b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7640046a91b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&user=Nicole+Wheeler&userId=3b4466954e30&source=-----7640046a91b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7640046a91b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7640046a91b6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7640046a91b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7640046a91b6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7640046a91b6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7640046a91b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7640046a91b6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7640046a91b6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7640046a91b6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7640046a91b6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7640046a91b6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7640046a91b6--------------------------------", "anchor_text": ""}, {"url": "https://nwheeler443.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nwheeler443.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nicole Wheeler"}, {"url": "https://nwheeler443.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "104 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3b4466954e30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&user=Nicole+Wheeler&userId=3b4466954e30&source=post_page-3b4466954e30--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F698ed647e424&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-machine-learning-models-for-predicting-antibiotic-resistance-7640046a91b6&newsletterV3=3b4466954e30&newsletterV3Id=698ed647e424&user=Nicole+Wheeler&userId=3b4466954e30&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}