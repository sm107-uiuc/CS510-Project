{"url": "https://towardsdatascience.com/convolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c", "time": 1683007589.473248, "path": "towardsdatascience.com/convolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c/", "webpage": {"metadata": {"title": "Convolutional Neural Network: Feature Map and Filter Visualization | by Renu Khandelwal | Towards Data Science", "h1": "Convolutional Neural Network: Feature Map and Filter Visualization", "description": "In this article, we will visualize the intermediate feature representations across different CNN layers to understand what happens inside CNN\u2019s to classify images. Supervised Deep Learning and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/datadriveninvestor/building-powerful-image-classification-convolutional-neural-network-using-keras-a1839d0ff298", "anchor_text": "Building Powerful Image Classification Convolutional Neural Network using Keras", "paragraph_index": 1}, {"url": "https://medium.com/datadriveninvestor/building-powerful-image-classification-convolutional-neural-network-using-keras-a1839d0ff298", "anchor_text": "Building powerful image classification CNN using Keras", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/dogs-vs-cats/data", "anchor_text": "classifying cats and dogs", "paragraph_index": 13}, {"url": "https://www.kaggle.com/c/dogs-vs-cats/data", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://arxiv.org/pdf/1804.11191.pdf", "anchor_text": "How Convolutional Neural Networks see the World \u2014 A survey of Convolutional Neural Network Visualization Methods", "paragraph_index": 30}, {"url": "https://ai.googleblog.com/2017/11/feature-visualization.html", "anchor_text": "Feature Visualization \u2014 Google AI Blog", "paragraph_index": 31}], "all_paragraphs": ["In this article, we will visualize the intermediate feature representations across different CNN layers to understand what happens inside CNN\u2019s to classify images.", "Building Powerful Image Classification Convolutional Neural Network using Keras", "Building powerful image classification CNN using Keras", "Supervised Deep Learning and Machine Learning take data and results as an input during training to generate the rules or data patterns. Understanding of data patterns or rules generated by the model helps us understand how the results were derived from the input data.", "Training: Convolutional neural network takes a two-dimensional image and the class of the image, like a cat or a dog as an input. As a result of the training, we get trained weights, which are the data patterns or rules extracted from the images.", "Inference or Prediction: Image will be the only input passed to the trained model, and the trained model will output the class of the image. The class of the image will be based on the learned data patterns during the training.", "Apply filters or feature detectors to the input image to generate the feature maps or the activation maps using the Relu activation function. Feature detectors or filters help identify different features present in an image like edges, vertical lines, horizontal lines, bends, etc.", "Pooling is then applied over the feature maps for invariance to translation. Pooling is based on the concept that when we change the input by a small amount, the pooled outputs do not change. We can use min pooling, average pooling, or max pooling. Max pooling provides better performance compared to min or average pooling.", "Flatten all the input and pass these flattened inputs to a deep neural network that outputs the class of the object", "The class of the image can be binary like a cat or dog, or it can be a multi-class classification like identifying digits or classifying different apparel items.", "Neural networks are like a black box, and learned features in a Neural Network are not interpretable. You pass an input image, and the model returns the results.", "What if you get an incorrect prediction and would like to figure out why such a decision was made by CNN?", "If only you could visualize the intermediate representation applied across different Convolutional layers in CNN to understand how the model learns. Understanding the working of the model will help to know the reason for incorrect predition that will lead to better fine tuning of the model and explain the decisions", "The example used here is a deep CNN model for classifying cats and dogs. Before you dive in to learn to visualize both the filters and the feature maps generated by CNN, you will need to understand some of the critical points about Convolutional layers and the filters applied to them.", "We build a CNN for classifying dogs and cats and later visualize the feature maps or activation maps and filters applied to generate them on an input image", "Dataset can be downloaded from here", "We will unzip the file and create the folders as shown below and split the data into the training dataset with 10,000 cats and 10,000 dogs images and validation dataset containing 2500 cats and 2500 dogs images", "Rescale and Apply different Augmentation to the training image", "Generate batches of normalized data for train and validation data set", "your data is stored in directories, so use the flow_from_directory() method. flow_from_directory() will take the data from the specified path and generates batches of augmented normalized data.", "Create the Deep Convolutional Neural network model", "We train the model for 50 epochs", "Feature Visualization translates the internal features present in an image into visually perceptible or recognizable image patterns. Feature visualization will help us understand the learned features explicitly.", "First, you will visualize the different filters or feature detectors that are applied to the input image and, in the next step, visualize the feature maps or activation maps that are generated.", "CNN uses learned filters to convolve the feature maps from the previous layer. Filters are two- dimensional weights and these weights have a spatial relationship with each other.", "The steps you will follow to visualize the filters.", "Feature maps are generated by applying Filters or Feature detectors to the input image or the feature map output of the prior layers. Feature map visualization will provide insight into the internal representations for specific input for each of the Convolutional layers in the model.", "The steps you will follow to visualize the feature maps.", "We can see that for the dog image, the snout and the tongue are very prominent features, and for the cat image, the ears and tail are prominent in the feature maps.", "Visualizing an inside story of how CNN learns to identify different features present in images provides a deeper insight into how the model works. It will also help to understand why the model might be failing to classify some of the images correctly and hence fine-tuning the model for better accuracy and precision.", "How Convolutional Neural Networks see the World \u2014 A survey of Convolutional Neural Network Visualization Methods", "Feature Visualization \u2014 Google AI Blog", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A Technology Enthusiast who constantly seeks out new challenges by exploring cutting-edge technologies to make the world a better place!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff75012a5a49c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arshren.medium.com/?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35----f75012a5a49c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff75012a5a49c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff75012a5a49c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/datadriveninvestor/convolutional-neural-network-cnn-simplified-ecafd4ee52c5", "anchor_text": "Convolutional Neural Network Basics"}, {"url": "https://medium.com/datadriveninvestor/building-powerful-image-classification-convolutional-neural-network-using-keras-a1839d0ff298", "anchor_text": "Building Powerful Image Classification Convolutional Neural Network using Keras"}, {"url": "https://medium.com/datadriveninvestor/building-powerful-image-classification-convolutional-neural-network-using-keras-a1839d0ff298", "anchor_text": "Building powerful image classification CNN using Keras"}, {"url": "https://www.kaggle.com/c/dogs-vs-cats/data", "anchor_text": "classifying cats and dogs"}, {"url": "https://www.kaggle.com/c/dogs-vs-cats/data", "anchor_text": "here"}, {"url": "https://github.com/arshren/Feature-Visualization", "anchor_text": "here"}, {"url": "https://keras.io/api/layers/", "anchor_text": "Keras documentation: Keras layers APILayers are the basic building blocks of neural networks in Keras. A layer consists of a tensor-in tensor-out\u2026keras.io"}, {"url": "https://keras.io/examples/conv_filter_visualization/", "anchor_text": "Convolution filter visualization \u2014 Keras Documentationfrom __future__ import print_function import time import numpy as np from PIL import Image as pil_image from\u2026keras.io"}, {"url": "https://arxiv.org/pdf/1804.11191.pdf", "anchor_text": "How Convolutional Neural Networks see the World \u2014 A survey of Convolutional Neural Network Visualization Methods"}, {"url": "https://cs.nyu.edu/~fergus/papers/zeilerECCV2014.pdf", "anchor_text": "Visualizing and Understanding Convolutional Networks"}, {"url": "https://ai.googleblog.com/2017/11/feature-visualization.html", "anchor_text": "Feature Visualization \u2014 Google AI Blog"}, {"url": "https://cs.nyu.edu/~fergus/papers/zeilerECCV2014.pdf", "anchor_text": "https://cs.nyu.edu/~fergus/papers/zeilerECCV2014.pdf"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f75012a5a49c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----f75012a5a49c---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f75012a5a49c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----f75012a5a49c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/features?source=post_page-----f75012a5a49c---------------features-----------------", "anchor_text": "Features"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff75012a5a49c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&user=Renu+Khandelwal&userId=31b07253bc35&source=-----f75012a5a49c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff75012a5a49c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&user=Renu+Khandelwal&userId=31b07253bc35&source=-----f75012a5a49c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff75012a5a49c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff75012a5a49c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f75012a5a49c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f75012a5a49c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f75012a5a49c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f75012a5a49c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f75012a5a49c--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://arshren.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb1cb44d62203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c&newsletterV3=31b07253bc35&newsletterV3Id=b1cb44d62203&user=Renu+Khandelwal&userId=31b07253bc35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}