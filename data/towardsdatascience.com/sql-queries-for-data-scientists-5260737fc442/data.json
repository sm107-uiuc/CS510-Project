{"url": "https://towardsdatascience.com/sql-queries-for-data-scientists-5260737fc442", "time": 1683015868.384042, "path": "towardsdatascience.com/sql-queries-for-data-scientists-5260737fc442/", "webpage": {"metadata": {"title": "SQL Queries for Data Scientists. Explained with examples. | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "SQL Queries for Data Scientists", "description": "SQL is a programming language that is used by most relational database management systems (RDBMS) to manage data stored in tabular form (i.e. tables). SQL is a fundamental skill expected from a data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/shubh0799/churn-modelling", "anchor_text": "customer churn dataset", "paragraph_index": 2}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 24}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 24}], "all_paragraphs": ["SQL is a programming language that is used by most relational database management systems (RDBMS) to manage data stored in tabular form (i.e. tables).", "SQL is a fundamental skill expected from a data scientist. You might argue that it is the job of a data engineer but the data scientist roles are inclined to being full-stack. Besides, as a data scientist, you wouldn\u2019t want to depend on a data engineer to retrieve data from a database.", "In this post, we will write complex queries to retrieve data stored in a table. I have uploaded the customer churn dataset to a table in a MySQL database.", "We will start with simple queries and steadily increase the complexity. I will describe the data needed and then write the query to retrieve that data from the table.", "Let\u2019s first take a look at the columns in the table.", "There are some features about customers and their accounts at a bank. The \u201cExited\u201d column indicates whether a customer churns (i.e. leaves the bank).", "We can now start on the queries.", "Instead of retrieving the entire \u201cBalance\u201d column, we have used the MAX aggregate function to select only the maximum value in that column.", "We cannot use the MAX for this query because we need the top 5 customers. What we can do is to sort the customers based on the balance and then select the top 5 using LIMIT.", "There is a condition that requires us to use the WHERE statement.", "In case you wonder, the average age of customers with a credit card is 38.8424.", "We will use another aggregate function to COUNT the number of customers. In order to group customers based on an attribute, the GROUP BY statement is used.", "We can apply the AVG function to the salary and GROUP BY the number of products.", "I want to introduce another statement related to conditions. The WHERE statement allows us to select entries that fit a condition or multiple conditions. However, it cannot be used with the aggregate functions.", "For the query above, consider we are only interested in the number of product categories with an average higher than 100000. Thus, we need to apply a condition on the averages which can be done using the HAVING statement.", "We are introducing two new topics here. One is using multiple conditions (age and balance), the other one is the nested SELECT statements.", "We can combine the multiple conditions in a WHERE statement using logical operators such as AND and OR. One condition is explicitly given (age > 50) but the other one needs to calculated on the table using another SELECT statement. That\u2019s where we need nested SELECT statements.", "The condition on the balance is another SELECT statement.", "It is similar to the previous example with an additional condition. We will count the number of customers based on three conditions:", "We can also adjust the name of the column in the result set using the \u201cAS\u201d keyword.", "We have covered some basic and complex queries. What we achieve with the queries is that some calculations and filtering are done at the database level. Thus, we can only retrieve the data we need instead of getting all the data and then applying filtering and calculations.", "Since real-life databases contain much more data and many relational tables, it is very important to be able to query the desired data using SQL.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5260737fc442&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5260737fc442--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5260737fc442--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----5260737fc442--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----5260737fc442--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----5260737fc442---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5260737fc442&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5260737fc442&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@amutiomi?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Miguel A. Amutio"}, {"url": "https://unsplash.com/s/photos/overview?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/shubh0799/churn-modelling", "anchor_text": "customer churn dataset"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5260737fc442---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5260737fc442---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----5260737fc442---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----5260737fc442---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----5260737fc442---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5260737fc442&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----5260737fc442---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5260737fc442&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----5260737fc442---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5260737fc442&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5260737fc442--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5260737fc442&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5260737fc442---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5260737fc442--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5260737fc442--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5260737fc442--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5260737fc442--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5260737fc442--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5260737fc442--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5260737fc442--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5260737fc442--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-queries-for-data-scientists-5260737fc442&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}