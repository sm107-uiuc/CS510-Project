{"url": "https://towardsdatascience.com/an-introduction-to-linear-regression-for-data-science-9056bbcdf675", "time": 1683017813.289519, "path": "towardsdatascience.com/an-introduction-to-linear-regression-for-data-science-9056bbcdf675/", "webpage": {"metadata": {"title": "An Introduction to Linear Regression for Data Science | Towards Data Science", "h1": "Introduction to Linear Regression with Python", "description": "In the world of machine learning \u2014 where humans find creative ways for machines to find creative ways to solve problems \u2014 few algorithms are as popular as linear regression."}, "outgoing_paragraph_urls": [{"url": "https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century", "anchor_text": "Harvard Business Review", "paragraph_index": 4}, {"url": "https://github.com/dhyan6/data-science-projects/blob/main/kc_house_data.csv?raw=true", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://www.kaggle.com/harlfoxem/housesalesprediction", "anchor_text": "Kaggle data set", "paragraph_index": 9}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab", "paragraph_index": 9}], "all_paragraphs": ["In the world of machine learning \u2014 where humans find creative ways for machines to find creative ways to solve problems \u2014 few algorithms are as popular as linear regression.", "To put it simply, linear regression is to machine learning as Yoda is to Star Wars: it\u2019s super old, it's easy to ignore, but it is very powerful. It would behoove you to befriend it if you are to save the galaxy.", "In this article, I will explain linear regression in a way that I hope feels intuitive and accessible. Along the way, I'll introduce some key ideas that I think are useful if you're starting to learn data science. I'll also include the complete Python code for applying linear regression to a real-world example so you can follow along.", "The article is divided intro three parts:", "A really good starting question in linear regression is: why do we care about relationships? There's a reason why the Harvard Business Review named data science \"the sexiest job in the 21st century,\" and it comes down to three simple facts:", "Since we can\u2019t access information from the future, the only thing left for us to do is to make an educated decision based on the data we already know; more specifically, based on the relationships between the data we know. That's where linear regression comes in.", "Imagine that you\u2019re hired by a real-estate company to determine the price of a house based on its features.", "The challenge is real: if you choose a price that is too high, you risk not selling the house, but if you set the price too low, you lose out on a potential gain. So how do you set the right price?", "To make this example concrete, we\u2019ll use a popular real-world data set of housing prices from King County, WA, which includes homes sold between May 2014 and May 2015.", "You can access the data set here (I've modified the original Kaggle data set to make it easier to examine the data). I'll be running Python code on Google Colab, which I highly recommend (you can set up a Python notebook on your browser with one click).", "We can use the pandas read_csv() method to load the csv data set as a DataFrame (which is structured in rows and columns). We'll save it as 'houses' and print the first 5 rows:", "We get a sense of what this data set is like, but we can do better. Applying .info() to houses gives us a nice summary:", "We have data on 21,613 houses that were sold in King County and a list of 10 variables that could potentially help us predict the price of a house. A note on variables that are not self-explanatory:", "The question is: which feature or explanatory variable has the strongest relationship with the target variable price? First, we need to a way to talk about relationships.", "Correlation is the relationship between two variables, and the strength of this relationship is called the Pearson\u2019s correlation coefficient, Pearson\u2019s r, or just r for short.", "The correlation coefficient can take any value from -1 to 1.", "Here's a neat chart that shows different correlation coefficients (r values) for different scatter plots:", "Note that r does not translate directly to a percentage of accuracy. An r value of .6 does not mean that 60% of the data are close to the line of best nor that the model is 60% accurate. The coefficient r is simply a measure of how strong the linear relationship is and whether it\u2019s positive or negative.", "Let's display the correlation coefficients between all possible variables in our houses data set using a heat map.", "A few pointers on how to read a heat map:", "To find the strongest relationship, we look for the box with the lightest color or the highest value. The variable sqft_living has the strongest relationship to price (r = 0.7).", "Let\u2019s visualize this relationship with a scatter plot.", "Visually, it appears like there is a general linear relationship between these variables. The house prices seem to increase as the squared footage increases (we\u2019ll talk more about how to describe this soon). It's time to build a model!", "By now, hopefully you subscribe to the idea that relationships really matter in data science (also in real life, but let's stick to data science for now). By building models of relationships, we can make predictions about data that we're interested in.", "A linear model is the equation of a line that describes the relationship between a predictor variable X and an outcome variable Y.", "Here, we've introduced new terms. You can think of a linear model as a function f that receives some input X and returns an output Y. We call X a predictor variable, and Y the target or outcome variable.", "In this case, we are building a linear model, so our equation will be the slope-intercept equation of a line.", "As a mathematical convention, we'll write the previous equation as:", "where \u03b20 and \u03b21 are the model's coefficients or parameters. Finding the best model for our data is equivalent to finding the parameters \u03b20 and \u03b21 (y-intercept and slope) that minimize the distance between the estimated values of the model and the actual values in our data.", "How do we describe how well our linear model fits the data? One way to think about accuracy is to think about error. The difference between the predicted value and the actual value is called the residual, and can be visualized as follows:", "One way to find the line of best fit is to try to minimize the Mean Squared Error.", "The Mean Squared Error is a measure of the average of the squares of the residuals. A line of best fit is a line whose coefficients \u03b20 (y-intercept) and \u03b21 (slope) minimize the mean squared error.", "Mathematically, this can be expressed as:", "We'll use the Python library sklearn to build a simple linear regression model that finds the line of best fit. Again, we are trying to calculate the coefficients \u03b20 and \u03b21 that minimize the residuals.", "Because we'll want to evaluate the model's predictions on data it hasn't seen before (to give us a sense of accuracy), we'll train the model on a subset of the data and test it on another subset. This can be visualized as follows:", "Step 1: Define our train and test data", "Step 2: Build and fit the model", "The coefficient \u03b21 of our model tells us that the price increases approximately $280 for every additional square foot in a house. So now, let's say we want to predict the price of a house with 4,600 squared feet.", "Once you have a model of the relationship between a predictor variable X and an outcome variable Y, a logical question to ask is: how good is this model? After all, the decisions you make in real life will depend on how much you trust your model.", "A few things to keep in mind:", "Model evaluation is a fascinating topic on its own, which I can't possibly do justice in this section. For now, I want to leave you with a few pointers on how to determine the accuracy of a linear regression model.", "A popular way to measure the error of a model is to calculate the average of the residuals squared, which is essentially a measure of the average distance between our model\u2019s predicted points (on the line of best fit) and the actual data points.", "The Root Mean Squared Error (RMSE) measures the root of the average of the squares of the residuals. This can be expressed as:", "In other words, we are taking the square root of the average of the squared residuals.", "We can use a module from sklearn to calculate the MSE, and then apply the square root. Note that we'll use the y_test values below, which is the subset of values the model has never seen before:", "Root Mean Squared Error: $266,725! As you can tell, this number is a bit on the high end. We would ideally like the RMSE to be smaller.", "Given that the price of a house is dependent on more factors than just the squared footage, it's not a big surprise that the RMSE is large. One way to solve this problem is to include more predictor variables in a regression model to make it more accurate (I'll be writing more about this soon).", "A second popular measure of how well the fitted regression line fits the data is called r-squared (or r\u00b2).", "R-squared, also known as the coefficient of determination, is the proportion of variation that is explained by a linear model. In general, a higher r-squared value represents a better fit of the data.", "Let's calculate R-Squared. We'll provide as inputs the subset y_test and the subset y_pred, which we obtained by applying our model to x_test.", "R-Squared = .48. This means that 48% of the variation in the data is explained or predicted by the linear model. It's a good start.", "I hope this article was useful as an introduction to why we care about building and evaluating linear models. In a future post, I\u2019ll explore the advantages of using multiple linear regression and discovering non-linear relationships.", "In short, linear regression is a powerful supervised machine learning algorithm that can help us model linear relationships between two variables. Simple linear regression is often a good starting point for exploring our data and thinking about how to build more complex models.", "If you want to check out more resources, I highly recommend:", "Thanks for reading! If you enjoyed this piece, feel free to request new topics or start a conversation thread below.", "I'll be explaining a new data science concept each week in a way that I hope is fun and intuitive.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Instructional designer. Passionate about translating data science concepts into stories."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9056bbcdf675&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dhyan-adler.medium.com/?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": ""}, {"url": "https://dhyan-adler.medium.com/?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": "Dhyan Adler-Belendez"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F669057ff39a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&user=Dhyan+Adler-Belendez&userId=669057ff39a4&source=post_page-669057ff39a4----9056bbcdf675---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9056bbcdf675&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9056bbcdf675&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "GETTING STARTED"}, {"url": "https://askdatascience.com/13/what-are-the-main-branches-of-machine-learning", "anchor_text": "Photo source"}, {"url": "https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century", "anchor_text": "Harvard Business Review"}, {"url": "https://unsplash.com/s/photos/beautiful-house?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/dhyan6/data-science-projects/blob/main/kc_house_data.csv?raw=true", "anchor_text": "here"}, {"url": "https://www.kaggle.com/harlfoxem/housesalesprediction", "anchor_text": "Kaggle data set"}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab"}, {"url": "https://en.wikipedia.org/wiki/Pearson_correlation_coefficient", "anchor_text": "Photo Source"}, {"url": "https://upload.wikimedia.org/wikipedia/commons/e/ed/Residuals_for_Linear_Regression_Fit.png", "anchor_text": "Wikipedia"}, {"url": "http://statlearning.com/", "anchor_text": "PDF"}, {"url": "https://www.coursera.org/learn/machine-learning/home/welcome", "anchor_text": "Coursera"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----9056bbcdf675---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9056bbcdf675---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----9056bbcdf675---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9056bbcdf675---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----9056bbcdf675---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9056bbcdf675&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&user=Dhyan+Adler-Belendez&userId=669057ff39a4&source=-----9056bbcdf675---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9056bbcdf675&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&user=Dhyan+Adler-Belendez&userId=669057ff39a4&source=-----9056bbcdf675---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9056bbcdf675&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9056bbcdf675&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9056bbcdf675---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9056bbcdf675--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9056bbcdf675--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9056bbcdf675--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9056bbcdf675--------------------------------", "anchor_text": ""}, {"url": "https://dhyan-adler.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dhyan-adler.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dhyan Adler-Belendez"}, {"url": "https://dhyan-adler.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "124 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F669057ff39a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&user=Dhyan+Adler-Belendez&userId=669057ff39a4&source=post_page-669057ff39a4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2f03266bda4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-linear-regression-for-data-science-9056bbcdf675&newsletterV3=669057ff39a4&newsletterV3Id=2f03266bda4f&user=Dhyan+Adler-Belendez&userId=669057ff39a4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}