{"url": "https://towardsdatascience.com/blitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7", "time": 1683005376.1046798, "path": "towardsdatascience.com/blitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7/", "webpage": {"metadata": {"title": "BLiTZ \u2014 A Bayesian Neural Network library for PyTorch | by Piero Esposito | Towards Data Science", "h1": "BLiTZ \u2014 A Bayesian Neural Network library for PyTorch", "description": "This is a post on the usage of a library for Deep Bayesian Learning. If you are new to the theme, you may want to seek one of the many posts on medium about it or just the documentation section on\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning#Bayesian-Deep-Learning-in-a-Nutshell", "anchor_text": "documentation section on Bayesian DL of our lib repo", "paragraph_index": 0}, {"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning/blob/master/blitz/examples/bayesian_regression_boston.py", "anchor_text": "this example", "paragraph_index": 17}, {"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning/tree/master/blitz/examples", "anchor_text": "on the repository", "paragraph_index": 17}, {"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning", "anchor_text": "https://github.com/piEsposito/blitz-bayesian-deep-learning", "paragraph_index": 26}], "all_paragraphs": ["This is a post on the usage of a library for Deep Bayesian Learning. If you are new to the theme, you may want to seek one of the many posts on medium about it or just the documentation section on Bayesian DL of our lib repo.", "As there is a rising need for gathering uncertainty over neural network predictions, using Bayesian Neural Network layers became one of the most intuitive approaches \u2014 and that can be confirmed by the trend of Bayesian Networks as a study field on Deep Learning.", "It occurs that, despite the trend of PyTorch as a main Deep Learning framework (for research, at least), no library lets the user introduce Bayesian Neural Network layers intro their models with as ease as they can do it with nn.Linear and nn.Conv2d, for example.", "Logically, that causes a bottleneck for anyone that wants to iterate flexibly with Bayesian approaches for their data modeling, as the user has to develop the whole part of Bayesian Layers for its use rather than focusing on the architecture of its model.", "BLiTZ was created to change to solve this bottleneck. By being fully integrated with PyTorch (including with nn.Sequential modules) and easy to extend as a Bayesian Deep Learning library, BLiTZ lets the user introduce uncertainty on its neural networks with no more effort than tuning its hyper-parameters.", "In this post, we discuss how to create, train and infer over uncertainty-introduced Neural Networks, using BLiTZ layers and sampling utilities.", "As we know, the main idea on Bayesian Deep Learning is that, rather than having deterministic weights, at each feed-forward operation, the Bayesian layers samples its weights from a normal distribution.", "Consequently, the trainable parameters of the layer are the ones that determine the mean and variance of this distribution.", "Mathematically, the operations would go from:", "Implementing layers where our \u03c1 and \u03bc are the trainable parameters may be hard on Torch, and beyond that, creating hyper-parameter tunable layers may be even harder to craft. BLiTZ has a built-in BayesianLinear layer which can be introduced into the model this easy:", "It works as a normal Torch nn.Module network, but its BayesianLinear modules perform training and inference with the previously explained uncertainty on its weights.", "As proposed in its original paper, Bayesian Neural Networks cost function is a combination of a \u201ccomplexity cost\u201d with a \u201cfitting-to-data cost\u201d. After all the algebra wrangling, for each feed-forward operation, we have:", "It occurs that the complexity cost (P(W)) consists of the sum of the probability density function of the sampled weights (of each Bayesian layer on the network) relative to a much-simpler, predefined pdf function. By doing that, we ensure that, while optimizing, our model variance over its predictions will diminish.", "To do that, BLiTZ brings us the variational_estimator decorator that introduces some methods, as nn_kl_divergence method into our nn.Module. Given data points, its labels, and a criterion, we could get the loss over a prediction by doing:", "Bayesian Neural Networks are often optimized by sampling the loss many times on the same batch before optimizing and proceeding, which occurs to compensate the randomness over the weights and avoid optimizing them over a loss influenced by outliers.", "BLiTZ\u2019s variational_estimator decorator also powers the neural network with the sample_elbo method. Given the inputs, outputs, criterion and sample_nbr, it estimates does the iterative process on calculating the loss over the batch sample_nbr times and gathers its mean, returning the sum of the complexity loss with the fitting one.", "It is very easy to optimize a Bayesian Neural Network model:", "We are now going through this example, to use BLiTZ to create a Bayesian Neural Network to estimate confidence intervals for the house prices of the Boston housing sklearn built-in dataset. If you want to seek other examples, there are more on the repository", "Besides the known modules, we will bring from BLiTZ the variational_estimator decorator, which helps us to handle the Bayesian layers on the module keeping it fully integrated with the rest of Torch, and, of course, BayesianLinear, which is our layer that features weight uncertainty.", "Nothing new under the sun here, we are importing and standard-scaling the data to help with the training.", "We can create our class with inheriting from nn.Module, as we would do with any Torch network. Our decorator introduces the methods to handle the Bayesian features, calculating the complexity cost of the Bayesian Layers and doing many feedforwards (sampling different weights on each one) to sample our loss.", "This function does create a confidence interval for each prediction on the batch on which we are trying to sample the label value. We then can measure the accuracy of our predictions by seeking how much of the prediction distributions did include the correct label for the datapoint.", "Notice here that we create our BayesianRegressor as we would do with other neural networks.", "We do a training loop that only differs from a common Torch training by having its loss sampled by its sample_elbo method. All the other stuff can be done normally, as our purpose with BLiTZ is to ease your life on iterating on your data with different Bayesian Neural Networks without trouble.", "Here is our very simple training loop:", "BLiTZ is a useful lib to iterate in Deep Learning experiments with Bayesian Layers and very little change in the usual code. Its layers and decorators are very integrated with Torch modules for neural networks and make it easy also to create custom networks and extract their complexity cost have no difficulty.", "And of course, here is the link for our repo: https://github.com/piEsposito/blitz-bayesian-deep-learning", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Google Developer Expert in Machine Learning and Machine Learning Engineer @ Sticker Mule; I\u2019m your friendly neghborhood nerdy guy."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F82f9998916c7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----82f9998916c7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----82f9998916c7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@piero.skywalker?source=post_page-----82f9998916c7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@piero.skywalker?source=post_page-----82f9998916c7--------------------------------", "anchor_text": "Piero Esposito"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c56b7cd9b15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&user=Piero+Esposito&userId=2c56b7cd9b15&source=post_page-2c56b7cd9b15----82f9998916c7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82f9998916c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82f9998916c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://ericmjl.github.io/bayesian-deep-learning-demystified/images/linreg-bayesian.png", "anchor_text": "https://ericmjl.github.io/bayesian-deep-learning-demystified/images/linreg-bayesian.png"}, {"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning#Bayesian-Deep-Learning-in-a-Nutshell", "anchor_text": "documentation section on Bayesian DL of our lib repo"}, {"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning/blob/master/blitz/examples/bayesian_regression_boston.py", "anchor_text": "this example"}, {"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning/tree/master/blitz/examples", "anchor_text": "on the repository"}, {"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning", "anchor_text": "https://github.com/piEsposito/blitz-bayesian-deep-learning"}, {"url": "https://github.com/piEsposito/blitz-bayesian-deep-learning", "anchor_text": "piEsposito/blitz-bayesian-deep-learningBLiTZ is a simple and extensible library to create Bayesian Neural Network Layers (based on whats proposed in Weight\u2026github.com"}, {"url": "https://arxiv.org/abs/1505.05424", "anchor_text": "Weight Uncertainty in Neural NetworksWe introduce a new, efficient, principled and backpropagation-compatible algorithm for learning a probability\u2026arxiv.org"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----82f9998916c7---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----82f9998916c7---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/bayesian-machine-learning?source=post_page-----82f9998916c7---------------bayesian_machine_learning-----------------", "anchor_text": "Bayesian Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----82f9998916c7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----82f9998916c7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F82f9998916c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&user=Piero+Esposito&userId=2c56b7cd9b15&source=-----82f9998916c7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F82f9998916c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&user=Piero+Esposito&userId=2c56b7cd9b15&source=-----82f9998916c7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82f9998916c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----82f9998916c7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F82f9998916c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----82f9998916c7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----82f9998916c7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----82f9998916c7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----82f9998916c7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----82f9998916c7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----82f9998916c7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----82f9998916c7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----82f9998916c7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----82f9998916c7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@piero.skywalker?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@piero.skywalker?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Piero Esposito"}, {"url": "https://medium.com/@piero.skywalker/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "211 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c56b7cd9b15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&user=Piero+Esposito&userId=2c56b7cd9b15&source=post_page-2c56b7cd9b15--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2195fe448065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fblitz-a-bayesian-neural-network-library-for-pytorch-82f9998916c7&newsletterV3=2c56b7cd9b15&newsletterV3Id=2195fe448065&user=Piero+Esposito&userId=2c56b7cd9b15&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}