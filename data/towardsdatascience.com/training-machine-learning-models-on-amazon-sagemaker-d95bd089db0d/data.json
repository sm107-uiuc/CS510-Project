{"url": "https://towardsdatascience.com/training-machine-learning-models-on-amazon-sagemaker-d95bd089db0d", "time": 1683007161.93541, "path": "towardsdatascience.com/training-machine-learning-models-on-amazon-sagemaker-d95bd089db0d/", "webpage": {"metadata": {"title": "Training Machine Learning Models on Amazon SageMaker | by Emily Webber | Towards Data Science", "h1": "Training Machine Learning Models on Amazon SageMaker", "description": "It\u2019s midnight. You\u2019ve spent hours fine-tuning your script, and you\u2019re racing to get it onto the server before your deadline tomorrow. You\u2019re building Naive Bayes, Logistic Regression, XGBoost, KNN\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/gs-studio.html", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples", "anchor_text": "SageMaker Examples", "paragraph_index": 5}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples", "anchor_text": "SageMaker-Examples", "paragraph_index": 8}, {"url": "https://sagemaker.readthedocs.io/en/stable/", "anchor_text": "SageMaker Python SDK", "paragraph_index": 8}, {"url": "https://sagemaker.readthedocs.io/en/stable/debugger.html", "anchor_text": "SageMaker-Debugger", "paragraph_index": 8}, {"url": "https://aws.amazon.com/sagemaker/pricing/instance-types/", "anchor_text": "ml.m4.xlarge", "paragraph_index": 10}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples/blob/master/sagemaker-debugger/mnist_tensor_plot/scripts/mxnet_gluon_save_all_demo.py", "anchor_text": "entry point script", "paragraph_index": 11}, {"url": "https://sagemaker.readthedocs.io/en/stable/sagemaker.mxnet.html#mxnet-estimator", "anchor_text": "MXNet estimator", "paragraph_index": 11}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/debugger-how-it-works.html", "anchor_text": "Debugger Hook Config", "paragraph_index": 14}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/debugger-built-in-rules.html", "anchor_text": "comes with 18 rules out of the box", "paragraph_index": 15}, {"url": "https://github.com/awslabs/sagemaker-debugger/blob/master/docs/sagemaker.md#zero-script-change", "anchor_text": "zero code changes", "paragraph_index": 15}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/processing-job.html", "anchor_text": "SageMaker Processing", "paragraph_index": 32}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/experiments.html", "anchor_text": "follow the lineage of that model", "paragraph_index": 33}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/autopilot-automate-model-development.html", "anchor_text": "SageMaker Autopilot", "paragraph_index": 39}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples", "anchor_text": "on our Github page right here", "paragraph_index": 49}, {"url": "https://aws.amazon.com/sagemaker/developer-resources/", "anchor_text": "developer resources right here.", "paragraph_index": 49}], "all_paragraphs": ["It\u2019s midnight. You\u2019ve spent hours fine-tuning your script, and you\u2019re racing to get it onto the server before your deadline tomorrow. You\u2019re building Naive Bayes, Logistic Regression, XGBoost, KNN, and any model under the sun in your massive for-loop.You\u2019ve finally ironed out the kinks on your local machine, and you\u2019re ready to scale your precious script, but when it starts to run you see \u2026 what exactly? Random print statements? How do you know it\u2019s working? What would you do if it broke? How do you even know your models are doing what you want them to?", "The reality is that you don\u2019t need to go it alone. There are tens of thousands of other data scientists and machine learning engineers who have walked the same path as you, and fortunately, there\u2019s quite a bit of technology on the table you can put to work in pursuit of your goals.", "Here I\u2019ll walk you through training machine learning models on Amazon SageMaker, a fully-managed solution for building, training, and deploying machine learning models, lovingly developed by Amazon Web Services. We\u2019ll cover how to bring your own model on SageMaker, analyze training jobs with the debugger, manage projects with experiments, and scale jobs over multiple EC2 instances.", "Let\u2019s jump in! And who knows, by the end of this tutorial, you may even get your own slick visualization to show for it.", "First, let\u2019s get your environment setup. SageMaker Studio is a fully-integrated IDE for machine learning. It decouples development from compute, letting you easily modify and configure your EC2 instances separately while maintaining your IDE. You can setup Studio with either IAM or SSO credentials, with more details right here.", "Next, clone the Github repository for SageMaker Examples. Open up Studio, create a new terminal, and run this command.", "Let\u2019s step through this together. Right off the bat, make sure you\u2019re adding a few dependencies.", "Once you\u2019ve gotten those installed, we\u2019re ready to get your job started!", "These first lines are pretty generic, you\u2019ll see most of them across the SageMaker-Examples. We\u2019re importing the SageMaker Python SDK, then pointing to the new SageMaker-Debugger library. This has both a Debugger Hook Config, and a Collection Config. We\u2019re going to need both of these here.", "Next, let\u2019s set up our estimator!", "Estimators are how we configure training jobs on SageMaker. You\u2019ve got your execution role with the permissions to run the job, then the EC2 instance config. See how minimal that is? It\u2019s just 2 lines of code to specify that you need an ml.m4.xlarge.", "Next, we\u2019re pointing to our entry point script. This is a file that comes with your example; it\u2019s using the MXNet estimator to complete abstract away the Docker file.", "Remember, as long as you can run your code on Docker, you can run it on SageMaker.", "Here, we\u2019re using what\u2019s called script mode, or the ability to bring your own model script and scale it up on SageMaker using ephemeral clusters. These are EC2 instances that spin up when your job starts, and spin down when your job is over. This makes them a lot easier to scale, secure, and pay for.", "After defining the model, along with the version of the framework, we\u2019re ready to add the Debugger Hook Config. This tells SageMaker that (A) we want to add Debugger to our job, and (B) what we want it to do. In this case, we\u2019re grabbing all tensors.", "Don\u2019t be misled by the name, SageMaker Debugger is a very advanced solution! The net is, you\u2019re going to collect the tensors in your deep learning model. Then, you\u2019re going to analyze those. SageMaker Debugger comes with 18 rules out of the box , and you can apply these to your deep learning models with zero code changes. That is to say, as long as you are using the SageMaker deep learning containers, you don\u2019t need to modify your script to start using SageMaker Debugger.", "Now, fit your model, and we\u2019re off to the races!", "If you\u2019re a savvy AWS user, you\u2019ll know to navigate back to the AWS console to investigate your training job. Navigate to Training on the left-hand side of the SageMaker landing page, then select Training Jobs.", "This will open up a view into your job! You\u2019ll see it\u2019s status show starting, along with all the details about where your data is, which image you\u2019re using, where your model artifact is going, and the date and time.", "Remember, all of your jobs in SageMaker are stored and logged by default.", "This means it should be breathtakingly easy not just to monitor your jobs while they\u2019re running, but revert back and pick up a model exactly where you left off, even months back.", "Now let\u2019s go get those tensors.", "Next, run a quick command to grab the path in S3 where your tensor data is stored.", "Next, run the command to copy your data from S3 to your local Studio instance.", "I have to admit, these 2 lines are quite possibly my favorite commands on the AWS cloud. They\u2019re so simple, and yet so effective. !aws s3 cp and !aws s3 sync All we\u2019re doing is moving our data from S3 to our code on Studio. And it works like a charm.", "Now, here comes the fun part. Let\u2019s use a package calledtensor_plot to setup an interactive visualization of your network!", "We\u2019re pointing to a folder called debug-output, you\u2019ll want to make sure that\u2019s where you copied those tensors from S3 into.", "Pretty awesome! Remember, you can set up this visualization for any deep learning model you train on SageMaker. You just need to add that debug hook config. You can also run this on XGBoost models!", "Next, we\u2019ll learn how to manage our projects using SageMaker Experiments.", "I\u2019ll walk you through a few code snippets from this notebook, available here.", "First, it\u2019s helpful to know how this is organized in SageMaker. You have experiments, trials, and trial components. The experiment is the overarching learning project you\u2019re working on, like your computer vision solution, or a forecasting model you\u2019re building.", "That experiment is going to be broken down into multiple trials, and each trial will roughly correspond to a training job. So if you\u2019re testing out XGBoost, KNN, Logistic Regression, and SVM for a classification project, you would list each attempt as a trial. And of course, you can specify the object metrics that you\u2019re interested in for those trials.", "Next, each trial will have a trial component. These are going to be the steps of that trial, such as preprocessing techniques you applied, SageMaker Processing jobs you ran, or training jobs.", "This is how you can traceback your results. After you\u2019re found a reasonable model, as long as its been tracked via Experiments, you can literally follow the lineage of that model to recreate it downstream.", "Here are a few code snippets, along with the slick experiments visuals!", "First, just make sure to get the dependencies installed.", "Next, get your imports set up, along with your SageMaker credentials.", "Now, let\u2019s create an experiment via the SDK! A few things to note. (1) This is literally only 4 lines of code. (2) You get one chance at naming. You\u2019ll want to develop a naming version strategy if, like me, you take a few tries to get the one you really want.", "Next, let\u2019s add preprocessing steps to your experiment. Here, we\u2019re going to log parameters that we set. In this case, that\u2019s the mean and standard deviation we\u2019ll use for normalization.", "Note that here you can log parameters you\u2019re setting. When running SageMaker Autopilot jobs, you can see how to log SageMaker Processing jobs to associate your feature engineering steps with model training.", "Follow the notebook to create the estimator. In that example, you\u2019re actually going to loop through a list of the number of potential hidden layers to build your network around.", "Once you\u2019ve got the estimator created, here is how we\u2019ll add an experiment config to it.", "On calling estimator.fit(), you\u2019re adding the rest of the components you need to associate this training job with your experiment, i.e. logging it as a trial.", "Now, click on the Experiments tab on the left, then right-click on your experiment to view in the trial components detailed view.", "Pretty fancy! Remember, every time you create an experiment in Studio, including with the SDK, it\u2019s going to show up in the Experiments Tab. To view the trial component list, just right-click.", "Next, highlight one of the trials, and right-click to open in trial details.", "This will give you the training job-specific drill down.", "Once you\u2019re in the trial details view, you can inspect the lineage of your project by immediately referencing both the training job, and the preprocessing steps.", "On top of that, you can create charts to analyze your model performance in that specific trial.", "And that\u2019s a wrap! I hope you enjoyed this tutorial. Remember, you can always dig into more examples on our Github page right here, or the rest of our developer resources right here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Enlightened ideas are the future: mindfulness, compassion, environmental policies, deep learning and scalable cloud systems. ML @ AWS \u2014 all opinions my own."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd95bd089db0d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@emilywebber?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@emilywebber?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": "Emily Webber"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fafdac8915532&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&user=Emily+Webber&userId=afdac8915532&source=post_page-afdac8915532----d95bd089db0d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd95bd089db0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd95bd089db0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/gs-studio.html", "anchor_text": "here"}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples", "anchor_text": "SageMaker Examples"}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples.git", "anchor_text": "https://github.com/awslabs/amazon-sagemaker-examples.git"}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples", "anchor_text": "SageMaker-Examples"}, {"url": "https://sagemaker.readthedocs.io/en/stable/", "anchor_text": "SageMaker Python SDK"}, {"url": "https://sagemaker.readthedocs.io/en/stable/debugger.html", "anchor_text": "SageMaker-Debugger"}, {"url": "https://aws.amazon.com/sagemaker/pricing/instance-types/", "anchor_text": "ml.m4.xlarge"}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples/blob/master/sagemaker-debugger/mnist_tensor_plot/scripts/mxnet_gluon_save_all_demo.py", "anchor_text": "entry point script"}, {"url": "https://sagemaker.readthedocs.io/en/stable/sagemaker.mxnet.html#mxnet-estimator", "anchor_text": "MXNet estimator"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/debugger-how-it-works.html", "anchor_text": "Debugger Hook Config"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/debugger-built-in-rules.html", "anchor_text": "comes with 18 rules out of the box"}, {"url": "https://github.com/awslabs/sagemaker-debugger/blob/master/docs/sagemaker.md#zero-script-change", "anchor_text": "zero code changes"}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples", "anchor_text": "amazon-sagemaker-examples"}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples/tree/master/sagemaker-experiments", "anchor_text": "sagemaker-experiments"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/processing-job.html", "anchor_text": "SageMaker Processing"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/experiments.html", "anchor_text": "follow the lineage of that model"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/autopilot-automate-model-development.html", "anchor_text": "SageMaker Autopilot"}, {"url": "https://github.com/awslabs/amazon-sagemaker-examples", "anchor_text": "on our Github page right here"}, {"url": "https://aws.amazon.com/sagemaker/developer-resources/", "anchor_text": "developer resources right here."}, {"url": "https://medium.com/tag/sagemaker?source=post_page-----d95bd089db0d---------------sagemaker-----------------", "anchor_text": "Sagemaker"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d95bd089db0d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d95bd089db0d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/aws?source=post_page-----d95bd089db0d---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d95bd089db0d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd95bd089db0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&user=Emily+Webber&userId=afdac8915532&source=-----d95bd089db0d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd95bd089db0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&user=Emily+Webber&userId=afdac8915532&source=-----d95bd089db0d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd95bd089db0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd95bd089db0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d95bd089db0d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d95bd089db0d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d95bd089db0d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d95bd089db0d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d95bd089db0d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@emilywebber?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@emilywebber?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Emily Webber"}, {"url": "https://medium.com/@emilywebber/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "335 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fafdac8915532&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&user=Emily+Webber&userId=afdac8915532&source=post_page-afdac8915532--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F72fdcf1f05fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-machine-learning-models-on-amazon-sagemaker-d95bd089db0d&newsletterV3=afdac8915532&newsletterV3Id=72fdcf1f05fe&user=Emily+Webber&userId=afdac8915532&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}