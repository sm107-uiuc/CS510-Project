{"url": "https://towardsdatascience.com/inpainting-with-ai-get-back-your-images-pytorch-a68f689128e5", "time": 1683006220.985473, "path": "towardsdatascience.com/inpainting-with-ai-get-back-your-images-pytorch-a68f689128e5/", "webpage": {"metadata": {"title": "Inpainting with AI \u2014 get back your images! [PyTorch] | by Hmrishav Bandyopadhyay | Towards Data Science", "h1": "Inpainting with AI \u2014 get back your images! [PyTorch]", "description": "Did you know the old childhood photo you have in that dusty album can be restored? Yeah, that one in which everyone is holding hands and having the time of their lives! Don\u2019t believe me? Check this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Art_conservation", "anchor_text": "conservation", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Inpainting#cite_note-1", "anchor_text": "[1]", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/List_of_art_media", "anchor_text": "mediums", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Oil_painting", "anchor_text": "oil", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Acrylic_paint", "anchor_text": "acrylic", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Photographic_printing", "anchor_text": "chemical photographic prints", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Sculpture", "anchor_text": "3-dimensional sculptures", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Digital_imaging", "anchor_text": "images", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Digital_video", "anchor_text": "video", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Inpainting", "anchor_text": "https://en.wikipedia.org/wiki/Inpainting", "paragraph_index": 1}, {"url": "https://hmrishavbandy.github.io", "anchor_text": "https://hmrishavbandy.github.io", "paragraph_index": 27}], "all_paragraphs": ["Did you know the old childhood photo you have in that dusty album can be restored? Yeah, that one in which everyone is holding hands and having the time of their lives! Don\u2019t believe me? Check this out here \u2014", "Inpainting is a conservation process where damaged, deteriorating, or missing parts of an artwork are filled in to present a complete image.[1] This process can be applied to both physical and digital art mediums such as oil or acrylic paintings, chemical photographic prints, 3-dimensional sculptures, or digital images and video. \u2014 https://en.wikipedia.org/wiki/Inpainting", "Image inpainting is an active area of AI research where AI has been able to come up with better inpainting results than most artists. In this article, we are going to discuss image inpainting using neural networks \u2014 specifically context encoders. This article explains and implements the research work on context encoders that was presented in CVPR 2016.", "To get started with Context Encoders, we have to learn what are autoencoders. An autoencoder structurally consists of an encoder, a decoder and a bottleneck. The general autoencoder aims to reduce image size by ignoring the noise in the image. Autoencoders are however not specific for images and can be extended to other data as well. There are specific variants of autoencoders to fulfill specific tasks.", "Now that we know about autoencoders we can describe context encoders as an analogy to autoencoders. A context encoder is a convolutional neural network trained to generate the contents of an arbitrary image region on the basis of its surroundings \u2014 i.e. a context encoder takes in the surrounding data of the image region and tries to generate something that would fit into the image region. Same as we fitted jigsaw puzzles when we were small \u2014 only we didn\u2019t have to generate the puzzle pieces ;)", "Our context encoder here consists of an encoder capturing the context of an image into a compact latent feature representation and a decoder which uses that representation to produce the missing image content. Missing image content? \u2014 Since we need an enormous dataset to train a neural network, we cannot afford to work with just the inpainting problem images. So we block out portions of images from normal image datasets to create an inpainting problem and feed the images to the neural network, thus creating missing image content at the region we block.", "[It is important to note here that the images fed to the neural network have too many missing portions for classical inpainting methods to work at all.]", "GANs or Generative Adversarial Networks have been shown to be extremely useful for image generation. Generative Adversarial Networks run on a basic principle of a generator trying to \u2018fool\u2019 a discriminator and a determined discriminator trying to get hold of the generator. In other words, two networks trying to minimize and maximize a loss function respectively.", "Region Masks are the portion of images we block out so that we can feed the generated inpainting problems to the model. By blocking out, we just set the pixel value to zero for that image region. Now, there are 3 ways we can do this \u2014", "In here, I have implemented only the Central Region masking method as this is just a guide to get you started on inpainting with AI. Feel free to try with other masking methods and let me know about the results in the comments!", "By now, you should have some idea about the model. Let\u2019s see if you\u2019re correct ;)", "The model consists of an encoder and a decoder section, building up the context-encoder part of the model. This part also acts as the generator which generates data and tries to fool the discriminator. The discriminator consists of convolution networks followed by a Sigmoid function that finally gives a single scalar as output.", "The loss function of the model is divided into 2 parts:", "It is important to note here that only using L2 loss would give us a blurry image. Because having a blurry image reduces the mean pixel wise error and thus the L2 loss is minimized \u2014 but not in a way we want it to.", "2. Adversarial Loss \u2014 This tries to make the prediction \u2018look\u2019 real (remember the generator has to fool the discriminator!) and this helps us in getting over the blurry image that the L2 loss would have led us into. Mathematically, we can express it as \u2014", "Here an interesting observation is that the adversarial loss encourages the entire output to look real and not just the missing part. The adversarial network, in other words, gives the whole image a realistic look.", "Now since we have cleared the main points of the network lets get down to building the model. I will first build the model structure and then will get down to the training and the loss function part. The model will be built with the help of the PyTorch library on python.", "Let\u2019s start with the generator network:", "Let\u2019s start training the network now. We will set the batch-size to 64, and the number of epochs to 100. The learning rate is set to 0.0002.", "Let\u2019s take a glance at what our model has been able to build!", "Images at the zeroth epoch(noise) \u2014", "Images at the 100th epoch \u2014", "Let\u2019s see what went into the model \u2014", "That from this? Yeah! Pretty cool, huh?", "Implement your version of the model. Watch it recreate your childhood photos \u2014 and if you are good enough, you might just recreate the future of Inpainting with AI. So, what are you waiting for?", "Let me know in the comments if anything goes wrong with your implementation. Here to help :)", "Check out my blog for faster updates and subscribe for quality content :D", "Hmrishav Bandyopadhyay is a 2nd year Undergraduate at the Electronics and Telecommunication department of Jadavpur University, India. His interests lie in Deep Learning, Computer Vision, and Image Processing. He can be reached at \u2014 hmrishavbandyopadhyay@gmail.com || https://hmrishavbandy.github.io", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD, SketchX, CVSSP, University of Surrey"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa68f689128e5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a68f689128e5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a68f689128e5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hmrishavbandyopadhyay?source=post_page-----a68f689128e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hmrishavbandyopadhyay?source=post_page-----a68f689128e5--------------------------------", "anchor_text": "Hmrishav Bandyopadhyay"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3309993693c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&user=Hmrishav+Bandyopadhyay&userId=c3309993693c&source=post_page-c3309993693c----a68f689128e5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa68f689128e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa68f689128e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jamesponddotco?utm_source=medium&utm_medium=referral", "anchor_text": "James Pond"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Art_conservation", "anchor_text": "conservation"}, {"url": "https://en.wikipedia.org/wiki/Inpainting#cite_note-1", "anchor_text": "[1]"}, {"url": "https://en.wikipedia.org/wiki/List_of_art_media", "anchor_text": "mediums"}, {"url": "https://en.wikipedia.org/wiki/Oil_painting", "anchor_text": "oil"}, {"url": "https://en.wikipedia.org/wiki/Acrylic_paint", "anchor_text": "acrylic"}, {"url": "https://en.wikipedia.org/wiki/Photographic_printing", "anchor_text": "chemical photographic prints"}, {"url": "https://en.wikipedia.org/wiki/Sculpture", "anchor_text": "3-dimensional sculptures"}, {"url": "https://en.wikipedia.org/wiki/Digital_imaging", "anchor_text": "images"}, {"url": "https://en.wikipedia.org/wiki/Digital_video", "anchor_text": "video"}, {"url": "https://en.wikipedia.org/wiki/Inpainting", "anchor_text": "https://en.wikipedia.org/wiki/Inpainting"}, {"url": "https://medium.com/@hmrishavbandyopadhyay/generative-adversarial-networks-hard-not-eea78c1d3c95", "anchor_text": "https://medium.com/@hmrishavbandyopadhyay/generative-adversarial-networks-hard-not-eea78c1d3c95"}, {"url": "https://arxiv.org/abs/1604.07379", "anchor_text": "https://arxiv.org/abs/1604.07379 ]"}, {"url": "https://www.theconvolvedblog.vision", "anchor_text": "The Convolved BlogCroesus, the king of Lydia (Asia Minor), once asked the Oracle of Delphi whether he should go to war against Persia\u2026www.theconvolvedblog.vision"}, {"url": "https://hmrishavbandy.github.io", "anchor_text": "https://hmrishavbandy.github.io"}, {"url": "https://medium.com/tag/python?source=post_page-----a68f689128e5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a68f689128e5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a68f689128e5---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----a68f689128e5---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----a68f689128e5---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa68f689128e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&user=Hmrishav+Bandyopadhyay&userId=c3309993693c&source=-----a68f689128e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa68f689128e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&user=Hmrishav+Bandyopadhyay&userId=c3309993693c&source=-----a68f689128e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa68f689128e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a68f689128e5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa68f689128e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a68f689128e5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a68f689128e5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a68f689128e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a68f689128e5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a68f689128e5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a68f689128e5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a68f689128e5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a68f689128e5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a68f689128e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hmrishavbandyopadhyay?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hmrishavbandyopadhyay?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hmrishav Bandyopadhyay"}, {"url": "https://medium.com/@hmrishavbandyopadhyay/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3309993693c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&user=Hmrishav+Bandyopadhyay&userId=c3309993693c&source=post_page-c3309993693c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F35cad6264837&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finpainting-with-ai-get-back-your-images-pytorch-a68f689128e5&newsletterV3=c3309993693c&newsletterV3Id=35cad6264837&user=Hmrishav+Bandyopadhyay&userId=c3309993693c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}