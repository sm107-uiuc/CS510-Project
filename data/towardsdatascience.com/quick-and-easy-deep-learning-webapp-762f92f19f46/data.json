{"url": "https://towardsdatascience.com/quick-and-easy-deep-learning-webapp-762f92f19f46", "time": 1683015922.764269, "path": "towardsdatascience.com/quick-and-easy-deep-learning-webapp-762f92f19f46/", "webpage": {"metadata": {"title": "Quick and Easy Deep Learning WebApp | by Merlin Sch\u00e4fer | Towards Data Science", "h1": "Quick and Easy Deep Learning WebApp", "description": "Have you ever wanted to use deep learning in a project and show your results in an interactive way? Do you want to start your deep learning journey and quickly see your results as a working\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/gpiosenka/100-bird-species", "anchor_text": "225 Bird Species Dataset", "paragraph_index": 3}, {"url": "https://docs.fast.ai/", "anchor_text": "fastai", "paragraph_index": 17}], "all_paragraphs": ["Have you ever wanted to use deep learning in a project and show your results in an interactive way? Do you want to start your deep learning journey and quickly see your results as a working application? Let me show you how.", "One of the easiest ways to deploy a small data-driven or machine learning app with Python is streamlit. Streamlit allows you to create WebApps with a lot of functionality using just a few lines of code as I will demonstrate in a minute.", "Now that covers the deployment part, but what about the machine or deep learning? If you want to dive into deep learning, fast.ai is a great place to start. Their MOOC, now also their book and especially the fastai library provide you with everything you need to start your deep learning journey.", "I want to show you just how quick & easy you can build an interactive classification WebApp that uses state of the art deep learning models. To do that I will take the 225 Bird Species Dataset from Kaggle,train a deep learning model on it and then use that model in a streamlit App.", "Now I realize that classifying that many bird species is technically not the easiest task, and the model is far from perfect, if you want really good results you will have to dig a bit deeper. I just want to provide you with a classification app tutorial that doesn\u2019t use MNIST, Fashion MNIST, CIFAR-10 or anything the fastai MOOC already uses. This tutorial is not showing you how to get a top spot on the Kaggle leaderboard for bird image classification. I\u2019d rather show you how to build something end-to-end in a beginner friendly manner.", "The first step is to download the data.The Dataset contains 4 folders named \u201cconsolidated\u201d, \u201ctest\u201d, \u201ctrain\u201d and \u201cvalid\u201d. Within each folder we can find 225 subfolders, one for each species. The folder names will provide the labels later. The \u201cconsolidated\u201d folder contains all images, so it\u2019s only of limited use for us.", "Let\u2019s focus on the train and validation folder for our task.", "The next step is to load our data, preprocess it and train our model. This may sound like a lot and possibly overwhelming if you are a beginner, but fastai makes it surprisingly simple.", "We first import the fastai.vision.all package. Please note that I am using import * here. I know about the issues this can create, I don't recommend using it for anything other than exploration and experimentation within a jupyter notebook. Once we've explored, trained and saved the model we will not use this kind of import again in our WebApp file.", "Now we can build a DataBlock and dataloader to load the data in a way our model can process them. In fastai this is done through the DataBlock class and the dataloaders. The GrandparentSplitter() tells the DataBlock to use all files in \"train\" for the training set and all in \"valid\" for the validation set.", "This would be a good moment to check if everything went as expected. We will look into the first 10 pictures of the validation and training data to see if everything has been loaded correctly.", "Your output should look something like this:", "Note that the training data is already shuffled for training, while the validation data is not and also doesn\u2019t need to be.", "Most of the pictures our classifier will have to deal with in a real setting won\u2019t be perfect images worthy of a National Geographic feature (i.e. when someone wants to use your app to find out which bird they\u2019ve taken a photo of). We should therefore add some transformations to the data. With birds.new() we can add new images or transformed images in our case. Using RandomResizedCrop we can add pictures which are random crops from the original picture, with batch_tfms = aug_transforms() we add transformations to the whole batch, these transformations are some useful standard image augmentations such as changing the brightness, tilting, stretching and squishing the picture.", "Some of these pictures may look a little odd, but you can also spot some \u201cokay but far from ideal\u201d pictures, which may resemble something a user of your WebApp would upload later.", "Okay, so we have our data, we preprocessed it a bit. It\u2019s time to choose a model and train it.", "Fastai strongly emphasizes using pretrained models and fine tuning them. This often leads to better and faster results than training something from scratch. Here we will use a ResNet34 which was pretrained on the ImageNet dataset. Hence, our model has already \u201cseen\u201d pictures and also kind of \u201cknows\u201d what a bird looks like. We can use that and now fine tune the model towards classifying different species of birds.", "For an in-depth explanation of the fine_tune() method see the fastai docs.", "Once the model is trained we can check which kind of errors it makes, look into it\u2019s loss over training time and of course use the test set to see how well it does on new data. You should definitely do all of these things. If you don\u2019t know how, check the fast.ai tutorials or the MOOC.", "However, I am not discussing these steps here as the main focus is not the model training and evaluation, but showing how to create a working app.", "The model did pretty well. The error rate (on the validation set) is 0.02 for me, which translate into 98% accuracy. Please note that accuracy is not always the best metric and if you want to train a model you should look into more metrics.", "It\u2019s time to save our model and move into the next stage: Building the WebApp.", "You should probably find a more meaningful name, especially if you have multiple models.", "We are going to use streamlit as mentioned. To host your application locally open your terminal or command/anaconda prompt navigate to the directory your Python file is located and type streamlit run {your_file_name}.py.", "The app should be available under localhost:8501.", "We will need streamlit, numpy, PIL and fastai.vision to run everything.", "The beginning of our App should have title. Which in streamlit is as easy as typing st.title(\"Your chosen title\")", "The next part of our App is the file upload which is quick and convenient with: uploaded_file = st.file_uploader(\"Choose an image...\", type=\"jpg\")", "We now basically have finished the first state of the app, which looks like this:", "To integrate our classification we first need to load the model.", "Now let\u2019s classify the image and create some output.", "The code checks whether there is an uploaded file, and once that is true the image file is converted in order to let our model predict its label using the .predict() method.", "Once we have a prediction we create some output for our user with st.write() which uses standard Markdown formatting. I also added a small if statement to have better grammar.", "After you\u2019ve uploaded an image the WebApp should look somewhat like this:", "Great! Now we have a functioning, local WebApp that uses our deep learning model! Much cooler than reading through a jupyter notebook!", "You could deploy this, however you may need to make some changes, regarding the use of GPUs etc.", "Here is the whole code for the App:", "You now know how to build an Image Classification App based on Deep Learning!", "Streamlit offers many features and you could add more functionality or display more data or change the layout a bit, experiment and explore. Fastai also offers tons of features, which I recommend you to explore as well.", "I hope this article was helpful to you and now I ask you to:", "Explore, experiment, build your own Apps and showcase what you\u2019ve learned!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at HMS Analytical Software with a psychology background. Interested in all things \u201cdata\u201d, cloud and AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F762f92f19f46&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----762f92f19f46--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----762f92f19f46--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ms101196.medium.com/?source=post_page-----762f92f19f46--------------------------------", "anchor_text": ""}, {"url": "https://ms101196.medium.com/?source=post_page-----762f92f19f46--------------------------------", "anchor_text": "Merlin Sch\u00e4fer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a2c8842187b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=post_page-5a2c8842187b----762f92f19f46---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F762f92f19f46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F762f92f19f46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@itookthose?utm_source=medium&utm_medium=referral", "anchor_text": "Sid Balachandran"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.streamlit.io/", "anchor_text": "Streamlit - The fastest way to create data appsStreamlit is an open-source app framework for Machine Learning and Data Science teams. Create beautiful data apps in\u2026www.streamlit.io"}, {"url": "https://www.fast.ai/", "anchor_text": "HomeUpdate Oct 20, 2020: NumFOCUS has apologized to me. I accept their apology. I do not accept their assertion that \"At\u2026www.fast.ai"}, {"url": "https://www.kaggle.com/gpiosenka/100-bird-species", "anchor_text": "225 Bird Species Dataset"}, {"url": "https://unsplash.com/@dulceylima?utm_source=medium&utm_medium=referral", "anchor_text": "Dulcey Lima"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://docs.fast.ai/", "anchor_text": "fastai"}, {"url": "https://medium.com/tag/ai?source=post_page-----762f92f19f46---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/streamlit?source=post_page-----762f92f19f46---------------streamlit-----------------", "anchor_text": "Streamlit"}, {"url": "https://medium.com/tag/fastai?source=post_page-----762f92f19f46---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----762f92f19f46---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/deployment?source=post_page-----762f92f19f46---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F762f92f19f46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=-----762f92f19f46---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F762f92f19f46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=-----762f92f19f46---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F762f92f19f46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----762f92f19f46--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F762f92f19f46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----762f92f19f46---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----762f92f19f46--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----762f92f19f46--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----762f92f19f46--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----762f92f19f46--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----762f92f19f46--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----762f92f19f46--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----762f92f19f46--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----762f92f19f46--------------------------------", "anchor_text": ""}, {"url": "https://ms101196.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ms101196.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Merlin Sch\u00e4fer"}, {"url": "https://ms101196.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "129 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a2c8842187b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=post_page-5a2c8842187b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F18a27e283ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-and-easy-deep-learning-webapp-762f92f19f46&newsletterV3=5a2c8842187b&newsletterV3Id=18a27e283ce1&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}