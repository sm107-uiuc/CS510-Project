{"url": "https://towardsdatascience.com/how-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200", "time": 1683002712.257523, "path": "towardsdatascience.com/how-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200/", "webpage": {"metadata": {"title": "How to Create a Hub-and-Spoke Plot with Plotly | by Ehsan Khodabandeh | Towards Data Science", "h1": "How to Create a Hub-and-Spoke Plot with Plotly", "description": "How to plot the latitude (lat) and longitude (long) coordinates of some locations on the map using Plotly in Python and draw the lines between them to show the flow (a plot known as \u201chub-and-spoke\u201d)"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Spoke%E2%80%93hub_distribution_paradigm", "anchor_text": "hub-and-spoke", "paragraph_index": 0}, {"url": "https://plot.ly/python/", "anchor_text": "Plotly", "paragraph_index": 0}, {"url": "https://plot.ly/python/lines-on-maps/", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://plot.ly/python/v3/lines-on-maps/", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://plot.ly/python/v4-migration/", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://plot.ly/python/creating-and-updating-figures/", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://plot.ly/python/creating-and-updating-figures/", "anchor_text": "documentation", "paragraph_index": 4}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke/blob/master/plotly_hub_and_spoke.ipynb", "anchor_text": "this Jupyter Notebook", "paragraph_index": 7}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke/blob/master/sample_us.csv", "anchor_text": "sample .csv file", "paragraph_index": 8}, {"url": "https://plot.ly/python/reference/#layout-geo-scope", "anchor_text": "Plotly\u2019s documentation", "paragraph_index": 16}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke/blob/master/sample_us.csv", "anchor_text": "US data", "paragraph_index": 21}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke/blob/master/sample_eu.csv", "anchor_text": "Europe", "paragraph_index": 22}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke", "anchor_text": "GitHub", "paragraph_index": 23}, {"url": "https://twitter.com/EhsanKhoda", "anchor_text": "Twitter", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/ehsankhodabandeh", "anchor_text": "LinkedIn", "paragraph_index": 24}], "all_paragraphs": ["A while ago, I needed to plot the lines connecting the latitude (lat) and longitude (long) coordinates of some locations on the map. What I needed to draw is known as the \u201chub-and-spoke\u201d plot. Knowing that Plotly already has some samples such as the one here, I was able to do it pretty easily. But real-life data won\u2019t always lend itself perfectly to Plotly\u2019s examples, and there may be other requirements that out-of-the-box examples don\u2019t meet.", "In this blog, I\u2019ll show you how to build one of these graphs on your own. In particular, we\u2019ll assume that:", "*This was actually something that required more effort prior to Plotly version 4, especially since their documentation emphasizes online mode, as you can see here. But version 4 is offline only. You can read more about the migration of online features here.", "There are multiple ways to represent a figure in Plotly. Two of the most common ways are using (a) dictionaries or using (b) graph objects. Though each has its pros and cons, Plotly recommends the latter for its additional benefits, which you can check out here.", "To create a figure, we need two main components: the data and a layout. From the documentation:", "You can build a complete figure by passing trace and layout specifications to the plotly.graph_objects.Figure constructor. These trace and layout specifications can be either dictionaries or graph objects.", "The layout dictionary specifies the properties of the figure\u2019s layout, while data is a list of trace dictionaries with configuration options for individual traces (trace is a word Plotly uses to describe plots).", "Now that we know how figures are constructed, we can prepare our data and plot them on the map. Although the code below is for Plotly version 4, you can find the implementation for both versions 3 and 4 in this Jupyter Notebook.", "The data (as you can see in this sample .csv file) consists of information about each origin and destination location (namely, city, state, country, lat, and long). To draw the plot, we only care about:", "So first, let\u2019s load the data:", "Next, create the location dataframe with all needed attributes:", "After that, we can add each location and its attributes to the figure:", "After that, we can add each path to the figure:", "Finally, let\u2019s specify the layout of our map:", "Since we want to show the map as an HTML file, we need one more line:", "That\u2019s it! This works as intended, but only if the lat/long data is confined to the US. To make it more responsive to different kinds of underlying data (like European locations, for example), we need to make one small change.", "If you look closely at the codes above, you\u2019ll see that in the layout dictionary, we specified scope='usa'. According to Plotly\u2019s documentation, scope accepts one of the following values:", "In order to decide what scope to use, we should look at the range of lats and longs in our data.", "We can then compare our range against the approximate range of each scope to decide which one to use (I found these by searching for them online \u2014 they should serve our purposes just fine.)", "All that\u2019s left to do is to change scope=scope in layout and we\u2019re all done.", "And voila! We\u2019re done. Let\u2019s test out this method on two different datasets.", "This is a map of US data:", "And this is one from Europe:", "Note that the sample data and the more-detailed code for this blog are available on GitHub.", "I hope you find this blog useful. I can be reached on Twitter and LinkedIn and I welcome any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Operations Research Scientist. I write about optimization, logistics, and occasionally Python!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd11d65a4200&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d11d65a4200--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d11d65a4200--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ehsankhoda.medium.com/?source=post_page-----d11d65a4200--------------------------------", "anchor_text": ""}, {"url": "https://ehsankhoda.medium.com/?source=post_page-----d11d65a4200--------------------------------", "anchor_text": "Ehsan Khodabandeh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd4141d5e72a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&user=Ehsan+Khodabandeh&userId=d4141d5e72a7&source=post_page-d4141d5e72a7----d11d65a4200---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd11d65a4200&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd11d65a4200&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Spoke%E2%80%93hub_distribution_paradigm", "anchor_text": "hub-and-spoke"}, {"url": "https://plot.ly/python/", "anchor_text": "Plotly"}, {"url": "https://plot.ly/python/lines-on-maps/", "anchor_text": "here"}, {"url": "https://plot.ly/python/v3/lines-on-maps/", "anchor_text": "here"}, {"url": "https://plot.ly/python/v4-migration/", "anchor_text": "here"}, {"url": "https://plot.ly/python/creating-and-updating-figures/", "anchor_text": "here"}, {"url": "https://plot.ly/python/creating-and-updating-figures/", "anchor_text": "documentation"}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke/blob/master/plotly_hub_and_spoke.ipynb", "anchor_text": "this Jupyter Notebook"}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke/blob/master/sample_us.csv", "anchor_text": "sample .csv file"}, {"url": "https://plot.ly/python/reference/#layout-geo-scope", "anchor_text": "Plotly\u2019s documentation"}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke/blob/master/sample_us.csv", "anchor_text": "US data"}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke/blob/master/sample_eu.csv", "anchor_text": "Europe"}, {"url": "https://github.com/ekhoda/plotly_hub_and_spoke", "anchor_text": "GitHub"}, {"url": "https://twitter.com/EhsanKhoda", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/ehsankhodabandeh", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----d11d65a4200---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d11d65a4200---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----d11d65a4200---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----d11d65a4200---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd11d65a4200&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&user=Ehsan+Khodabandeh&userId=d4141d5e72a7&source=-----d11d65a4200---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd11d65a4200&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&user=Ehsan+Khodabandeh&userId=d4141d5e72a7&source=-----d11d65a4200---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd11d65a4200&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d11d65a4200--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd11d65a4200&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d11d65a4200---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d11d65a4200--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d11d65a4200--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d11d65a4200--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d11d65a4200--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d11d65a4200--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d11d65a4200--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d11d65a4200--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d11d65a4200--------------------------------", "anchor_text": ""}, {"url": "https://ehsankhoda.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ehsankhoda.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ehsan Khodabandeh"}, {"url": "https://ehsankhoda.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "189 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd4141d5e72a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&user=Ehsan+Khodabandeh&userId=d4141d5e72a7&source=post_page-d4141d5e72a7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F10231a69095e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-hub-and-spoke-plot-with-plotly-d11d65a4200&newsletterV3=d4141d5e72a7&newsletterV3Id=10231a69095e&user=Ehsan+Khodabandeh&userId=d4141d5e72a7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}