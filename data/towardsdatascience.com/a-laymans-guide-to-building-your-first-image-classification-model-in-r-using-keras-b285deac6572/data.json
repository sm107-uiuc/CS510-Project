{"url": "https://towardsdatascience.com/a-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572", "time": 1683013727.716515, "path": "towardsdatascience.com/a-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572/", "webpage": {"metadata": {"title": "A Layman\u2019s Guide to Building Your First Image Classification Model in R Using Keras | by Abhibhav Sharma | Towards Data Science", "h1": "A Layman\u2019s Guide to Building Your First Image Classification Model in R Using Keras", "description": "Applications of machine learning (ML) are now almost an integral part of our everyday life. From a speech-recognition based virtual assistant in our smartphones to super-intelligent automated drones\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/AbhibhavS/CNN-Toy-model", "anchor_text": "This dataset", "paragraph_index": 10}, {"url": "https://bioconductor.org/packages/release/bioc/html/EBImage.html", "anchor_text": "EBImage", "paragraph_index": 11}, {"url": "https://bioconductor.org/", "anchor_text": "Bioconductor", "paragraph_index": 11}, {"url": "https://medium.com/vsinghbisen/where-is-artificial-intelligence-used-areas-where-ai-can-be-used-14ba8c092e73", "anchor_text": "Where Is Artificial Intelligence Used: Areas Where AI Can Be Used", "paragraph_index": 32}, {"url": "https://towardsdatascience.com/gentle-dive-into-math-behind-convolutional-neural-networks-79a07dd44cf9", "anchor_text": "Gentle Dive into Math Behind Convolutional Neural Networks", "paragraph_index": 33}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "A Comprehensive Guide to Convolutional Neural Networks \u2014 the ELI5 way", "paragraph_index": 34}], "all_paragraphs": ["Applications of machine learning (ML) are now almost an integral part of our everyday life. From a speech-recognition based virtual assistant in our smartphones to super-intelligent automated drones, ML and artificial intelligence (AI) is revolutionizing the dynamics of human-machine interactions. AI algorithms, especially the convolution neural networks (CNN) have made computer vision extremely powerful than ever. While the applications of it are breathtakingly awesome, it could be very intimidating to build one\u2019s own CNN model, especially for a non-programmer or a beginner in data science, in general. As an R lover, it was not difficult for me to assert that it gets even more enigmatic for a novice R programmer. The plausible reason for this imbalance could be that the standard neural network and ML libraries (like Keras and Tensorflow) are primarily compatible with Python and naturally gravitate the masses to roll with Python itself, leading to a severe lack of novice\u2019s guide and documentation to facilitate the implementation of these sophisticated frameworks in R. Nevertheless, APIs of Keras and Tensorflow is now available on CRAN. Herein, we are going to make a CNN based vanilla image-classification model using Keras and Tensorflow framework in R. With this article, my goal is to enable you to conceptualize and build your own CNN models in R using Keras and, sequentially help to boost your confidence through hands-on coding to build even more complex models in the future using this profound API. Apart from the scripting of the model, I will also try as much to concisely elaborate on the necessary components while plunging the hardcore underlying mathematics. Now let\u2019s start.", "As a prelude to the scripting of CNN, let\u2019s understand the formalisms of it in brief. Just like a human eye registers the information only in the confined receptive frame and learns the specific patterns and spatial features, which subsequently trigger specific neural responses, a CNN model operates in the same fashion. We will try to probe the CNN architecture and understand its key components (Figure 1).", "Instead of amalgamating the entire image pixels at a time, a subset of pixels is convoluted into a single datum Figure 2. Convolution is carried out by sliding a frame of a smaller size across the entire image acting as a receptive field that accounts for the temporal-spatial features. This frame is called a Kernel/Filter. Imagine scanning a building wall with a flashlight, the filter works in the same fashion. Now, if you have a variety of filters, you are likely to extract or observe more discriminative spatial features and frequently recurring adjacent values. This scheme empowers the learning by not only preserving the spatial characteristics with the least information loss but also significantly reduces the required number of weights, enabling the image classification practically feasible and scalable. For example, consider a 2D black and white (b&w) image as the input to CNN. The model initiates to convolute the image by employing a filter which then slides across the image with a given step size, also called strides. The filter values are analogous to the weights in the neural network. The linear combination of these filter values and the image\u2019s foregrounding pixel values at an instance, generate a single feature output. A set of these values generated produces a new layer called a feature map. Intuitively, a feature map is a condensed form of the input image that preserves all the dominating features and patterns into a smaller dimension for efficient learning.", "Elucidating this in Figure 3, the filter of size 4x4 is employed over a b&w image of dimension 10X10. The filter slides across the image with a stride of 1 unit, thus generating a convoluted layer of dimension (10\u20134+1)X(10\u20134+1) i.e 7X7. Note that the bias/intercept for this example is assumed to be 0. Similarly, n number of filters would generate n feature maps.", "For a b&w image, the depth is 1 and so of the filters. However, a colored image is an ensemble of Red, Blue, and Green (RBG) channels. precisely, a stack of three 2D layers, where each layer represents the intensity of a particular color channel. So for a colored image of depth 3, you will need a filter of dimension (4X4)X3 (Figure 4).", "Once the feature maps are generated, an activation function is applied over each of them. For this purpose, the Rectified Linear Unit (ReLU) activation function comes in handy. If the input to ReLU is a negative value, it simply transforms it to zero else it will spit out the very same input value (Figure 4). Mathematically, f(x)= max(0,x).", "After the activation layer, another scheme is employed to smartly reduce the dimensions of the feature map without losing vital information. This technique is called Max-pooling. Quite similar to the convolution scheme, here only the highest value from the max-pooling window is picked. This window slides in the same fashion as of the filter but with a step-size equal to the dimension of the pooling window (Figure 5). Max-pooling significantly reduces the dimension of the feature map while also preserving the important/dominating features. The final max-pooled layer is then squashed and flatten into the neuron layer that connects to a fully connected neural network to perform the classification task.", "Mind you CNN is not limited to a single convolution or a single set of the aforementioned schemes. Backed with a sufficient number of filters, The deeper your network is, the higher performance it will achieve. Intuitively, the initial convolutions would capture the low-level recurring features such as edges and colors. Sequentially, the deep layers tend to capture high-level features like recurring clusters pixels say eyes or noses in a portrait. So, in conclusion, based on your image complexity and computation power, you should choose a sufficient and efficient number of layers and filters.", "Now let\u2019s jump into the making of our toy model \ud83e\udd13!!", "I believe that to understand any statistical concept nothing comes handier than a deck of playing cards. Here I will exploit a deck of playing cards but in a slightly unorthodox form. Yes, you guessed it!! I will make a prediction model that should be able to accurately classify and predict the suit of a given image of any arbitrary non-faced playing card.", "This dataset contains a set of 43 card images for each suit viz Clubs \u2663, Hearts \u2665\ufe0f , Diamonds \u2666\ufe0f, and Spades \u2660\ufe0f . Note that the symbols of each suit follow a standard shape however the designing and arrangement of these symbols vary from card to card. We will incorporate this dataset to train and test our model. (To follow the script conveniently, I recommend you to download the images and keep all the files in a parent file as they appear in the Github repository)", "For this task, you would require Keras and EBImage packages. The former is available on the cran repository. The later is used to deal with the images efficiently and can be called from an open-source software called Bioconductor. These can be installed on Windows OS as:", "This installs the CPU version of Keras API, which is recommended for the novice for now.", "Note: The Keras API will require Python support and R tools plug-in. So make sure you have anaconda and R tools installed on your machine with properly added to your system path.", "Next, we will convert the images of each suit into a tensor (numbered matrix). readImage() function from EBImage library does this robustly. Let\u2019s try reading an image from our dataset.", "This indicates that the image is colored with dimension 500 X 726 X 4. Notice, as we have discussed earlier, here the image depth is 4 and so we will need a filter of depth 4. To unmask these four matrixes we use:", "This will give the details of the four channels separately.", "And oh yeah! to elucidate our selected card we do:", "Although the depth is the same for each card in the data set, the pixel dimensions are varying and so we have to resize each of the cards to 100x100x4 dimensions and combine them all in a stack that is compatible to Keras. This stack then directly goes into the architecture as input.", "To see what images are included in the test set, we do this:", "I got the cards as shown in figure 8. It could be a different set of cards for you.", "One Hot encoding is necessary to create the categorical vectors corresponding to the input data.", "Below is the R script to build the CNN model. I am also giving a comprehensive animation along with it that illustrates what\u2019s what as the script proceeds (Figure 9).", "We can get a summary of this model using summary(model.card). The output of this will be a neat and concise summary of the model.", "Once the architecture is built, its time to fit our dataset for the training of the model. The fitting is done as:", "On fitting, each epoch (forward feed-backpropagation) will appear in the console area. The processing time may vary from machine to machine. While the epochs are running you should see a graphic in the Rstudio viewer (Figure 9). These are the juxtaposed curves of loss and accuracy for training and validation sets.", "The running epochs appearing in the console looks something like this:", "A summary of the whole training process can be plotted using plot(history).", "Once the training is completed. Its time to evaluate our freshly trained model. First, we will look at the performance of moel over the trained data set, and then we will finally test and evaluate our trained model over our test set.", "The 100% accuracy over the train set can be a sign of overfitting but notice that our model has achieved a 100% accuracy over the test set as well. That means we have successfully made a convolution neural network model to correctly classify a given card image into its true suit.", "If you are here then congratulations!! You have successfully made your Convolution neural network model. Hope you enjoyed the ride. Please feel free to reach out to me in case you find anything fallible or incorrect. I am also open to all suggestions that can improve the quality of this document.", "Thank you for reading and Happy R-ing \ud83d\ude00", "Where Is Artificial Intelligence Used: Areas Where AI Can Be Used", "Gentle Dive into Math Behind Convolutional Neural Networks", "A Comprehensive Guide to Convolutional Neural Networks \u2014 the ELI5 way", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D. in Breast cancer Multi-omics and Machine learning| An R fanatic| Trying to induce machine learning in the yet-to-explore terrains of modern biology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb285deac6572&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b285deac6572--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b285deac6572--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://abhibhav.medium.com/?source=post_page-----b285deac6572--------------------------------", "anchor_text": ""}, {"url": "https://abhibhav.medium.com/?source=post_page-----b285deac6572--------------------------------", "anchor_text": "Abhibhav Sharma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb42a40ff02c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&user=Abhibhav+Sharma&userId=fb42a40ff02c&source=post_page-fb42a40ff02c----b285deac6572---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb285deac6572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb285deac6572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/AbhibhavS/CNN-Toy-model", "anchor_text": "This dataset"}, {"url": "https://bioconductor.org/packages/release/bioc/html/EBImage.html", "anchor_text": "EBImage"}, {"url": "https://bioconductor.org/", "anchor_text": "Bioconductor"}, {"url": "https://medium.com/vsinghbisen/where-is-artificial-intelligence-used-areas-where-ai-can-be-used-14ba8c092e73", "anchor_text": "Where Is Artificial Intelligence Used: Areas Where AI Can Be Used"}, {"url": "https://towardsdatascience.com/illustrated-10-cnn-architectures-95d78ace614d#:~:text=AlexNet%20(2012)&text=With%2060M%20parameters%2C%20AlexNet%20has,on%20the%20subsets%20of%20ImageNet.%E2%80%9D", "anchor_text": "Illustrated: 10 CNN Architectures"}, {"url": "https://towardsdatascience.com/gentle-dive-into-math-behind-convolutional-neural-networks-79a07dd44cf9", "anchor_text": "Gentle Dive into Math Behind Convolutional Neural Networks"}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "A Comprehensive Guide to Convolutional Neural Networks \u2014 the ELI5 way"}, {"url": "https://blog.rstudio.com/2017/09/05/keras-for-r/", "anchor_text": "Keras for R"}, {"url": "https://bioconductor.org/packages/release/bioc/vignettes/EBImage/inst/doc/EBImage-introduction.html", "anchor_text": "Introduction to EBImage"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----b285deac6572---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/tag/r?source=post_page-----b285deac6572---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b285deac6572---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/modeling?source=post_page-----b285deac6572---------------modeling-----------------", "anchor_text": "Modeling"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----b285deac6572---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb285deac6572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&user=Abhibhav+Sharma&userId=fb42a40ff02c&source=-----b285deac6572---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb285deac6572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&user=Abhibhav+Sharma&userId=fb42a40ff02c&source=-----b285deac6572---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb285deac6572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b285deac6572--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb285deac6572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b285deac6572---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b285deac6572--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b285deac6572--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b285deac6572--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b285deac6572--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b285deac6572--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b285deac6572--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b285deac6572--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b285deac6572--------------------------------", "anchor_text": ""}, {"url": "https://abhibhav.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://abhibhav.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abhibhav Sharma"}, {"url": "https://abhibhav.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "54 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb42a40ff02c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&user=Abhibhav+Sharma&userId=fb42a40ff02c&source=post_page-fb42a40ff02c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3f86548861f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572&newsletterV3=fb42a40ff02c&newsletterV3Id=3f86548861f6&user=Abhibhav+Sharma&userId=fb42a40ff02c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}