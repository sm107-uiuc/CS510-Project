{"url": "https://towardsdatascience.com/quality-control-with-machine-learning-d7aab7382c1e", "time": 1682995736.568455, "path": "towardsdatascience.com/quality-control-with-machine-learning-d7aab7382c1e/", "webpage": {"metadata": {"title": "Quality Control with Machine Learning | by Marco Cerliani | Towards Data Science", "h1": "Quality Control with Machine Learning", "description": "Quality Control is an important step in every production system. A lot of business investments aim to reinforce this process to grant higher-performance products. In the last years, Machine Learning\u2026"}, "outgoing_paragraph_urls": [{"url": "http://archive.ics.uci.edu/ml/datasets/Steel+Plates+Faults", "anchor_text": "Steel Plates Faults Data Set", "paragraph_index": 3}], "all_paragraphs": ["Quality Control is an important step in every production system. A lot of business investments aim to reinforce this process to grant higher-performance products. In the last years, Machine Learning solutions play a key role in this program of investments for their ability to easily adapt in every contest and for the great results achieved.", "In this article, I present an AI solution for Quality Control in a standard production unit, in the form of a classification problem. Following a very interesting approach, I try to achieve the best possible performance, giving a visual explanation of the results and taking into account the useful human insights.", "I want to underline this latest topic because human insights are often underestimated in Machine Learning! It\u2019s not a surprise that they permit us to achieve the best performances and to adopt the smartest solutions.", "I took the dataset for the analysis from the faithful UCI repository (Steel Plates Faults Data Set). The data description is very poor but it doesn\u2019t matter because it\u2019s easy to understand\u2026 We have a dataset containing the meta information of steel plates like luminosity, perimeter, edge, thickness, area, type of steel and so on (27 independent variables in total).", "We can imagine to manage a factory that works steel and produces steel plates in the final step of the production system to sell them in the wholesale market. Our aim is to maximize the efficiency of the production system, trying to identify the possible types of steel plate faults (7 in total) only considering the metadata of the products. In this way, we will be able to identify the fallacies of the production system and accordingly react.", "With 1941 samples at our disposal, the distribution of the total faults is unbalanced in favor of \u2018Other Faults\u2019 class:", "We are in a hurry and want to get immediately some results. So we take all our data and fit a Gradient Boosting.", "We are able to achieve an overall ACCURACY of 0.807%.", "If we plot the confusion matrix it\u2019s possible to see that our algorithm isn\u2019t able to classify well the Other_faults class. This first result imposes us to slow down and think a little bit.", "Personally, the best way to investigate a phenomenon is to make a plot. For this reason, I took all the variables that we used to fit our Gradient Boosting and I plotted them. To do this I reduce the starting dimensions (27 variables) to only 2 dimensions fitting a TSNE.", "Here it is a clear and beautiful explanation of our results! We (and also the algorithm) aren\u2019t able to identify a clear separation from the Other_Faults (pink dots) to the remaining classes. In this way the recall values from the confusion matrix for the Other_Faults make sense. Other_Faults is a noisy class and we have to take into account this aspect in our analysis.", "What does it mean that Other_Faults is a noisy class? To answer this question we take advantage of notorious and underestimated human insights.", "Assuming that humans made up the quality check in a production system today. If these people inspect a steel plate with a notable bump or a stain on its surface this piece is easy to label. But if these people inspect a plate with a bump and a stain on the surface at the same time label it is not so easy! (if you are in doubt put it in Other_Faults).", "This is only one example, but personally, it clarifies our situation: Other_Faults class needs to be treated with care because it incorporates a lot of undefined cases of quality checks.", "With this precious consideration in mind, we can proceed safely! As above I try to plot all the steel plates in our dataset, taking into consideration all the variables BUT not including the plates which belong to Other_Faults (pink dots).", "Pretty good! We have removed the noise caused by Other_Faults and now the classes are well separated.", "At this point, we try to make a model which not takes into account the Other_Faults class. We fit a Gradient Boosting as above.", "Now the ACCURACY is 0.909%, improving by 10 percentage points.", "Certainly, this is a good result and confirms the goodness of our reasonings but this second model reproduces an unrealistic scenario. In this way, we are imposing that Other_Faults class doesn\u2019t exist and that all the faults are easy to distinguish and to label. With our first model, we have proved that this is not our case. So we need a way to translate the uncertainty, that appears when people try to classify an ambiguous steel plate, in machine learning language.", "I have encoded this uncertainty imposing a threshold on each class on our final predictions. To build this threshold I have made the predictions with our second model on the Other_Faults samples and I\u2019ve stored it, maintaining the separation for each predicted class (as shown below).", "Next, I\u2019ve calculated a mobile threshold on each predicted class: I\u2019ve adopted the 0.30 percentile in every class (red squares) calculated on the score distributions.", "Practically, we utilize this threshold to say if a steel plate belongs with certainty to a given class of failures. If our prediction is below the threshold, we have not so much confidence to classify it and so we label it as an Other_Faults.", "Adopting this technique we are able to achieve an ACCURACY of 0.861% (in test data without Other_Faults). If we will increase the threshold, we will lose accuracy points, but we will get higher precision, and so on.", "Regarding the Other_Faults class, we are assuming that it exists in the form of an \u2018indecision class\u2019, which contains all the samples classified by the model with low confidence. At the same time, we are assuming that all the samples of the original Other_Faults class belong to the class pointed by the model if the confidence is higher than the threshold (we trust this).", "In the end, if we plot again our original data adopting our resizing of Other_Faults class, we can see a noise reduction (pink dots concentration).", "In this post, I proposed a workflow for fault classification in Quality Control. I received as input some samples of steel plates and I started to analyze them in order to correctly classify faults. After the first step, I noticed some ambiguous behaviors in the data structure and so I started to investigate\u2026 Based on my human insight, I suggested a new vision of the problem, I tried to solve it and I proposed my personal solution.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd7aab7382c1e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----d7aab7382c1e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7aab7382c1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7aab7382c1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@hansenhouse?utm_source=medium&utm_medium=referral", "anchor_text": "Glenn Hansen"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://archive.ics.uci.edu/ml/datasets/Steel+Plates+Faults", "anchor_text": "Steel Plates Faults Data Set"}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html", "anchor_text": "sklearn documentation"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d7aab7382c1e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d7aab7382c1e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/quality-control?source=post_page-----d7aab7382c1e---------------quality_control-----------------", "anchor_text": "Quality Control"}, {"url": "https://medium.com/tag/python?source=post_page-----d7aab7382c1e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7aab7382c1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&user=Marco+Cerliani&userId=c843902314c7&source=-----d7aab7382c1e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7aab7382c1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&user=Marco+Cerliani&userId=c843902314c7&source=-----d7aab7382c1e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7aab7382c1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd7aab7382c1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d7aab7382c1e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d7aab7382c1e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquality-control-with-machine-learning-d7aab7382c1e&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}