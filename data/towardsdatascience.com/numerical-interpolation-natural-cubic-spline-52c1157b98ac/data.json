{"url": "https://towardsdatascience.com/numerical-interpolation-natural-cubic-spline-52c1157b98ac", "time": 1682994045.7906718, "path": "towardsdatascience.com/numerical-interpolation-natural-cubic-spline-52c1157b98ac/", "webpage": {"metadata": {"title": "Numerical Interpolation: Natural Cubic Spline | by Lois Leal | Towards Data Science", "h1": "Numerical Interpolation: Natural Cubic Spline", "description": "I was entranced by this method when I first heard of it, especially the derivation. This post will show you how I cracked it out and made it simpler."}, "outgoing_paragraph_urls": [], "all_paragraphs": ["I was entranced by this method when I first heard of it, especially the derivation. This post will show you how I cracked it out and made it simpler. We will use the top-down approach and make sure you visualize while you\u2019re reading to understand it better.", "How can we fit all these data points using a function?", "The function that we are referring to is also called interpolating function or interpolant.", "Interpolation is usually confused with approximation and curve-fitting. The key to their differences is the extent on how they fit the data and the appropriateness of their usage.", "In interpolation, you fit all data points exactly while approximation, as it name suggests, just approximates.", "When it comes to appropriateness, interpolation is appropriate to use in smoothing out such noisy data and not appropriate when data points are subject to experimental errors or other sources of significant error. Having large set of data points also may burden interpolation. On the other hand, approximation is mainly appropriate for the design of library routines for computing special functions. This is due to the nature of these functions \u2014 exact values are seen to be inessential and to some point, inefficient when approximate values work.", "In curve-fitting, we do not fit all our data points. That\u2019s why we have the concept of residuals. In interpolation, it forces the function to fit all the data points.", "Now that we know which category are we talking about, let\u2019s narrow down to the families of functions used for interpolation.", "(2) Two Families of Functions considered here:", "Spoiler: Natural Cubic Spline is under Piece-wise Interpolation. But let us explain both of them to appreciate the method later.", "Polynomial Interpolation is the simplest and the most common type of interpolation. One feature of it is that there\u2019s always a unique polynomial of degree at most n-1 passing through n data points.", "There are many ways to compute or represent one polynomial but they boil down to the same mathematical function. Some of the methods are Monomial Basis, Lagrange Basis and Newton\u2019s Basis. As you notice, they are named after their basis.", "As how different methods are born, Piece-wise Interpolation solves these complications.", "Piece-wise interpolation answers these by fitting a large number of data points with low-degree polynomials. Since we only use low-degree polynomials, we eliminate excessive oscillations and non-convergence.", "General Concept: Given a set of data points, a different polynomial is used in each interval such that we interpolate several interpolants at successive points. That\u2019s why there are terms such as knots, breakpoints or control points \u2014 these are abscissas at which the interpolant changes from one polynomial to another.", "Primary Concern: It appears to sacrifice the smoothness of the interpolating of the interpolating function such that the graph can have \u201ccorners\u201d which implies that the derivative is discontinuous at such points.", "GOAL: Laying all those concepts and primary concerns, we aim to find an interpolating function that is smooth and does not change too much between node points.", "Now that we\u2019ve discussed where Natural Cubic Spline belongs and therefore this method should also inherit all these general features. We now discuss the method below. Don\u2019t worry, we\u2019ll make sense of every part of what we are going to discuss.", "I. Why is it called Natural Cubic Spline?", "\u2018Spline\u2019 \u2014 This one just means a piece-wise polynomial of degree k that is continuously differentiable k-1 times", "\u2018Natural Cubic Spline\u2019 \u2014 is a piece-wise cubic polynomial that is twice continuously differentiable. It is considerably \u2018stiffer\u2019 than a polynomial in the sense that it has less tendency to oscillate between data points.", "Still isn\u2019t making any sense? Let\u2019s visualize it and explain the mathematical terms for the parts that we will use later through the mechanical model.", "Let\u2019s imagine this as having an elastic strip pinned to a cork board. Now presenting the main points:", "Now that the general concepts are clear to us, let\u2019s make these concepts concrete.We specify how it originated using the derivation.", "This one is quite long but is understandable for those who know derivatives and integrals.", "where there are n knots (k\u2019s) which are data points (x,y) and f as the interpolant between two knots.", "Since I view math as modeling, we start with an illustration. This will serve as to concretely tell what we want to explain and also our map while we do derivation.", "The Derivation Proper is consists of two parts \u2014 each part arriving at an equation \u2014 which we will use and play an important part in computations.", "Having the needed formulas, we show how to use them.", "III. How to Use it for interpolation?", "We illustrate its usage through an example then later generalize the process.", "We first understand what it wants. Primarily what it\u2019s demanding is \u2014 Find an interpolant for the segment that contains x = 1.5 using Natural Cubic Spline that would interpolate all the data points given and know its corresponding y-coordinate.", "and we must rearrange the values to ease the process", "then we know the specific knots", "then we substitute the corresponding values so that:", "which in turn create a system of linear equations:", "knots can be solved via root finding techniques elimination, substitution, Gaussian Elimination, LU Decomposition, etc.", "skipping the detailed computation we have:", "then we know focus to get y at x = 1.5", "We find which knots does x is in: 1.5 is between x1 = 1 and x2 = 2", "therefore we use the first and second knots such that:", "Now that we\u2019ve seen how it works, we generalize the process to give a solution to the problem of finding y at some x using the Natural Cubic Spline.", "Must be seen as a suggestion only. There are many ways to do this.", "Find: Interpolant fi,i+1(x) considering y at some x.", "*First Main Step: Formula and Prepare", "We will be needing these formulas, so it would be nice to get all your formulas settled before you start your calculations:", "2. for the interpolant for a segment", "3. Make sure that the abscissas (x-coordinates) are arranged in increasing order since we\u2019re considering functions per segment.", "*Second Main Step: Solve the knots (k\u2019s) using the formula above1", "We can say that Natural Cubic Spline is a pretty interesting method for interpolation. Having known interpolation as fitting a function to all given data points, we knew Polynomial Interpolation can serve us at some point using only a single polynomial to do the job. Especially useful when we are only considering low-degree polynomials but with high-degree polynomials over-fitting lurks in the deep yielding unwanted oscillations that doesn\u2019t provide any insights to the data. One saving grace is Piece-wise Interpolation which does things using different low-degree polynomials which is especially useful with large data sets. It can be seen that there\u2019s more work to do in Piece-wise Implementation but the complexity of the method considering large data sets overtakes the quite long implementation.", "Lecture Notes on Sir JM Soriano\u2019s CS131 Class", "M. Heath. Scientific Computating: An Introductory Survey.", "K. Atkinson and W. Han. Elementary Numerical Analysis.", "J. Kiusalaas. Numerical Methods in Enginerring With Matlab.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Computer Vision, Robotics, and Machine Learning MSc at the University of Surrey"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F52c1157b98ac&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lbleal1.medium.com/?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": ""}, {"url": "https://lbleal1.medium.com/?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": "Lois Leal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F343e704bf439&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&user=Lois+Leal&userId=343e704bf439&source=post_page-343e704bf439----52c1157b98ac---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52c1157b98ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52c1157b98ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mitchel3uo?utm_source=medium&utm_medium=referral", "anchor_text": "Mitchell Luo"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----52c1157b98ac---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/numerical-methods?source=post_page-----52c1157b98ac---------------numerical_methods-----------------", "anchor_text": "Numerical Methods"}, {"url": "https://medium.com/tag/cubicspline?source=post_page-----52c1157b98ac---------------cubicspline-----------------", "anchor_text": "Cubicspline"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52c1157b98ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&user=Lois+Leal&userId=343e704bf439&source=-----52c1157b98ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52c1157b98ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&user=Lois+Leal&userId=343e704bf439&source=-----52c1157b98ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52c1157b98ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F52c1157b98ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----52c1157b98ac---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----52c1157b98ac--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----52c1157b98ac--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----52c1157b98ac--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----52c1157b98ac--------------------------------", "anchor_text": ""}, {"url": "https://lbleal1.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lbleal1.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lois Leal"}, {"url": "https://lbleal1.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "78 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F343e704bf439&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&user=Lois+Leal&userId=343e704bf439&source=post_page-343e704bf439--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F343e704bf439%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnumerical-interpolation-natural-cubic-spline-52c1157b98ac&user=Lois+Leal&userId=343e704bf439&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}