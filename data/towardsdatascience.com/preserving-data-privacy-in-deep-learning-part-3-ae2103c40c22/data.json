{"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22", "time": 1683012288.100744, "path": "towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22/", "webpage": {"metadata": {"title": "Preserving Data Privacy in Deep Learning | Part 3 | by Harsh Yadav | Towards Data Science", "h1": "Preserving Data Privacy in Deep Learning | Part 3", "description": "Link to part 1 (Basics of Federated Learning): https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029 Link to part 2 (Distribution of CIFAR10 into\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/akshay-kulkarni-1a562679/", "anchor_text": "Mr. Akshay Kulkarni", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "part 2", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "part 2", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "Part 1", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "part2", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "part 2", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1", "paragraph_index": 26}, {"url": "https://arxiv.org/abs/1602.05629", "anchor_text": "Communication-Efficient Learning of Deep Networks from Decentralized Data", "paragraph_index": 31}], "all_paragraphs": ["Many thanks to renowned data scientist Mr. Akshay Kulkarni for his inspiration and guidance on this tutorial.", "What is Federated Learning? What is the non-IID dataset? What changes to make to accumulate non-IID data in Federated Learning? What are the use cases of this type of Deep Learning method?", "These are some of the questions because of which you are here. This blog is part 3 of the series Preserving Data Privacy in Deep Learning and focuses on the implementation of federated learning with the non-IID dataset. In part 1 of this series, we explored the underlying architecture of federated learning and its basic implementation using PyTorch. But part 1, was unable to deal with the real-world dataset, where any client can have any number of images from the give classes. To tackle this issue, in part 2, we distributed CIFAR 10 (balanced dataset) into non-IID/real-world distribution and further divided it into clients. Now, in order to construct a federated learning model for real-world/non-IID datasets, I am writing this tutorial. In this part of the series, we will use the architecture of federated learning (in part 1) with non-IID clients (in part 2); thus it can be considered as a real-world use case of federated learning.", "After completing this tutorial, you will know:", "Federated Learning is a type of privacy-preserving method which aims at training an AI model on multiple devices (clients) possessing personal data, without explicitly exchanging or storing the data samples. A global model (weights) is transferred to these devices where the actual training takes place concurrently, incorporating the client-specific features and then updating (aggregating) the global model with all the new features learned during the training at individual devices.", "The next word prediction by Google keyboard is a distinguished example of Federated Learning. Federated Learning processes the device history (typing history) to suggest improvements to the next iteration of Gboard\u2019s query suggestion model.", "Federated Learning is very similar to that of a flower. Just like all the petals (clients) are held by the pedicel (global server), with each petal having different dimensions, and pattern but similar to other petals which constitute to flower (non-IID dataset) and how all the nutrients (weights of the models) are transferred by the pedicel to the petals simultaneously, a flower is a real-life analogy to federated learning.", "To develop a deeper understanding regarding the basic implementation of Federated Learning using Pytorch, please head over to Part 1 of this series.", "Now we are good to proceed to the next and the most exciting section of this blog, playing with the code. This tutorial builds a federated learning model from scratch using PyTorch by converting the balanced CIFAR10 dataset to the non-IID/real-world dataset. There are many aggregating techniques for federated learning, but this study implements the weighted mean of all the weights.", "CIFAR10 dataset is converted into an extreme non-IID dataset (Refer to part2). CIFAR10 consists of 60,000 color images of 32x32 pixels in 10 classes. The training set consists of 50,000 images, and the remaining 10,000 images are for test purposes.", "Below is the code, that is explained in detail in part 2 of this series. Please head over to part 2 to understand the following snippet in more detail.", "To get deeper insights into the above functions, please read part 2 of this series, where each and every function is explained in detail.", "VGG19 (16 Convolution layers, 3 Fully Connected layers, 5 MaxPool layers, and 1 SoftMax layer) is used in this tutorial.", "The baseline_data function creates a loader for the baseline data on which the client\u2019s model is retrained before the aggregation of weights on the global server. \u2018num\u2019 is the number of images on which the retraining of client\u2019s model on the global server is supposed to take place. Lines 9\u201310 gets the CIFAR10 data, and shuffle the training set. Line 12, selects num images from this shuffled dataset, following which it is used to create a Data Loader at line 14.", "The client_update function trains the client model on the given private client data. This is the local training round that takes place for every selected client, i.e. num_sleected (6 in our case).", "The client_sync function synchronizes the client model (before training) with global weights. It helps in the case when a particular client has not participated in the previous communication rounds, so it makes sure that all the selected clients have the previously trained weights from the global model.", "The server_aggregate function aggregates the model weights received from every client and updates the global model with updated weights. In this tutorial, the weighted mean of the weights is calculated. In part 1 of this series, instead of the weighted mean, the mean is used as an aggregation method.", "The test function is the standard function for evaluating the global model with the test dataset. It returns the test loss and test accuracy, which is used for a comparative study of different approaches.", "Now, we are done with all the pre-processing of the data and some helper-functions for federated learning. So, lets deep dive into the training of the model, i.e. federated learning with the non-IID dataset.", "Global model, client\u2019s models are initialized with the VGG19, and training is done on a GPU. Line 6\u201311, initializes the model with VGG19 on a GPU (Cuda). At line 14, the optimizer (SGD) is defined along with the learning rate. We can also add the momentum term in our optimizer. At line 17, the baseline data is added to a loader with \u2018baseline_num\u2019 images, i.e. 100 images as defined above.", "The non-IID data is loaded into a train_loader using the above functions, which ensures the data is non-IID. Classes_pc=2, num_clients=20, batch_size=32.", "Lines 1\u20134 create a list for keeping track of the loss and accuracy of the model on train and test dataset. Line 7 starts the training of individual clients in communication rounds (num_rounds). In every communication round, first, the selected clients are updated with the global weights. Then the local model is trained on the client\u2019s device itself, following which the retraining round takes place on the global server. After retraining the client\u2019s model, the aggregation of weights takes place.", "Line 9 selects the num_selected clients from num_clients, i.e. six clients are randomly selected from a total of 20 clients. Training at the client\u2019s device is done (Lines 13\u201317) using the client_sync(line 15), where the local models are updated with the global weights before the training, and then client_update function (line 16) is used to start the training. Once the local models are trained on the device itself, ensuring the privacy of the private data, they are sent to the global server. First, the retraining (lines 12\u201317) of these models with the baseline data is done. It is followed by the aggregation (line 27) of these local models (weights) into one global model. After updating the global model, this global model is used to test the training (line 28) with the help of the test function defined above.", "This process continues for num_rounds, i.e. 150 communication rounds in our case. This is the example of the federated learning with the non-IID dataset, and similar can be done for the real-world dataset (defined in part 2), which can be further applied to a real client-based system.", "With 6 selected clients, each running 5 local epochs and retaining on the global server with 20 epochs on the top of 150 communication rounds, below is the truncated test result.", "Comparatively, the approach used in this tutorial gives around 72% accuracy, while the one used in part 1 of this series gives around 35% accuracy when applied on a non-IID dataset. Moreover, the current approach (retraining on a global server) is far more stable when compared with other methods available.", "On the comparative study of this approach (retaining on a global server with weighted-mean) with the approach used in part 1, i.e. the basic federated learning with mean, approach 2 (retraining on a global server) outclassed the one used in part 1. This entire tutorial shows the importance of retaining on a global server to handle the dataset\u2019s non-IID issue. Hence, this study is an excellent method to deal with a non-IID dataset problem and can be used in real-world use cases.", "In this tutorial, you discovered how to preserve data privacy in deep learning models using federated learning with PyTorch and can be applied to real-world problems.", "Below is the flow diagram for a quick revision of the entire process.", "Federated Learning is one of the leading methods for preserving data privacy in machine learning models. The safety of the client\u2019s data is ensured by only sending the updated weights of the model, not the data. This approach of retraining each client\u2019s model with baseline data deals with the problem of non-IID data. Also, the synchronization of each client\u2019s model with global weights along with the weighted_mean as an aggregation of technique helps in getting a good accuracy of this model. This tutorial deals with the extreme case of a non-IID dataset, but when used for real-life data, it performs better than these results of ours, and it is because the current data is actually more truncated than the ones we deal in a real-life scenario.", "In the upcoming tutorials, you will not only get to learn about different aggregation techniques in federated learning, but also, homomorphic encryption of the model weights, differential privacy and it\u2019s hybrid with federated learning, and a few more topics helping in preserving the data privacy.", "[2] H.Brendan McMahan, Communication-Efficient Learning of Deep Networks from Decentralized Data, Proceedings of the 20th International Conference on Artificial Intelligence and Statistics (AISTATS) 2017. JMLR: W&CP volume 54", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Deep Learning enthusiast, with prior experience at Publicis Sapient, National University of Singapore, and SUSTech China."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae2103c40c22&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mailharsh17?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": "Harsh Yadav"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11670cac41ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&user=Harsh+Yadav&userId=11670cac41ec&source=post_page-11670cac41ec----ae2103c40c22---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae2103c40c22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae2103c40c22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b"}, {"url": "https://www.instagram.com/yourviewfrommylens/", "anchor_text": "Harsh Yadav"}, {"url": "https://www.linkedin.com/in/akshay-kulkarni-1a562679/", "anchor_text": "Mr. Akshay Kulkarni"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "part 2"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "part 2"}, {"url": "https://unsplash.com/@studiokiek?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Kiki Siepel"}, {"url": "https://unsplash.com/s/photos/flower?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "Part 1"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "part2"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "part 2"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1"}, {"url": "https://federated.withgoogle.com/", "anchor_text": "Google AI"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "anchor_text": "part 1"}, {"url": "https://arxiv.org/abs/1903.02891", "anchor_text": "arXiv:1903.02891"}, {"url": "https://arxiv.org/abs/1602.05629", "anchor_text": "Communication-Efficient Learning of Deep Networks from Decentralized Data"}, {"url": "https://medium.com/tag/federated-learning?source=post_page-----ae2103c40c22---------------federated_learning-----------------", "anchor_text": "Federated Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ae2103c40c22---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ae2103c40c22---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----ae2103c40c22---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----ae2103c40c22---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae2103c40c22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&user=Harsh+Yadav&userId=11670cac41ec&source=-----ae2103c40c22---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae2103c40c22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&user=Harsh+Yadav&userId=11670cac41ec&source=-----ae2103c40c22---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae2103c40c22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae2103c40c22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae2103c40c22---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae2103c40c22--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae2103c40c22--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae2103c40c22--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae2103c40c22--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Harsh Yadav"}, {"url": "https://medium.com/@mailharsh17/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11670cac41ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&user=Harsh+Yadav&userId=11670cac41ec&source=post_page-11670cac41ec--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5ba5c7d18464&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-3-ae2103c40c22&newsletterV3=11670cac41ec&newsletterV3Id=5ba5c7d18464&user=Harsh+Yadav&userId=11670cac41ec&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}