{"url": "https://towardsdatascience.com/the-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd", "time": 1683018384.9729972, "path": "towardsdatascience.com/the-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd/", "webpage": {"metadata": {"title": "The Ultimate Guide to Counterfactual Explanations for Classification Models | by Chetana Didugu | Towards Data Science", "h1": "The Ultimate Guide to Counterfactual Explanations for Classification Models", "description": "Let\u2019s say Paul applies for a loan at ABC Bank. He receives a mail from the bank expressing deep regret to inform him that his loan application has been rejected. Rejected! After being shattered for a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://christophm.github.io/interpretable-ml-book/counterfactual.html", "anchor_text": "book", "paragraph_index": 7}, {"url": "https://docs.seldon.io/projects/alibi/en/stable/examples/cfproto_housing.html", "anchor_text": "alibi", "paragraph_index": 10}, {"url": "http://lib.stat.cmu.edu/datasets/boston", "anchor_text": "Boston House Pricing", "paragraph_index": 10}, {"url": "https://arxiv.org/pdf/1907.02584.pdf", "anchor_text": "this", "paragraph_index": 13}], "all_paragraphs": ["Let\u2019s say Paul applies for a loan at ABC Bank. He receives a mail from the bank expressing deep regret to inform him that his loan application has been rejected. Rejected!", "After being shattered for a while, Paul may be curious to know what happened. So he goes to the bank and asks for the person who takes decisions on loan applications. He is directed to Jane, who takes the decisions on loan applications. Paul asks Jane why his application got rejected. She tells him his asking amount is too high, and his salary is less than minimum, and so on.", "But then, he asks her what could he have done to get his loan application approved. She tells him his asking amount needs to be reduced by so much, increase his salary by so much, come back after certain years, so on.", "But come on! Paul can\u2019t suddenly change his salary right! Neither can he wait for years for the loan. So he asks Jane what is the smallest change in his application he can do to get his loan approved.", "If Jane were replaced by an AI model, what the model would give Paul is called the Counterfactual Explanation.", "Counterfactual explanations provide the smallest change in the input feature values required to change the output of an instance to a predetermined/desired output", "However, as in Paul\u2019s case, not all features can be changed. So a requirement or constraint on Counterfactual explanations is that they perturb as few features as possible to obtain the desired output.", "There are multiple ways of determining counterfactual explanations proposed by multiple researchers. If you are interested in understanding the difference between each of them, you can take a look at this book by Christoph Molnar.", "However, a simple method to achieve this is as follows:", "Caveat: The thing with counterfactual explanations is that it is applicable only to supervised classification tasks. It is not amenable to regression or unsupervised tasks. It is important to know this", "To illustrate the use of Counterfactual Explanations, I will be using an illustrated example from the alibi library. The example explains a shallow Neural Network model on the Boston House Pricing dataset. The code for the illustration can be found on the alibi documentation page.", "Since the Boston House Dataset is present in the sklearn library, the dataset is loaded from sklearn directly.", "Housing dataset is a regression dataset, on which counterfactuals are not effective. Hence we need to convert it into a classification type of dataset. We choose the median of the target value, which is the house price. Any data point (house in the set of houses) with a price less than median is labelled 0 and above the median is labelled 1.", "The variant of counterfactual explanation used here is the one that is guided by prototypes. Here, prototypes are counterfactual examples (data points). They are built by building k-d trees or encoders, so that counterfactual explanations can be built fast. It is built based on this paper, which you can refer to for more details on how the algorithm works.", "A custom neural network model is built for this illustration:", "Now that we have our model, we want to understand a particular outcome. A particular test instance is chosen:", "The original label of this data point is 0, which indicates that the price of this house is below median price. Now let us run the counterfactual on it (CounterFactualProto calls counterfactual explanations by prototypes).", "Let us print out the original and the explained outcomes (both should be different or contrastive to each other).", "We can determine how much of which value has changed between the original feature set and the explanation:", "So this says that for the price to be above median, this house needed to have an age of 6.5 years lesser than it currently has, and an LSTAT value of 4.8 units less than it currently has.", "Counterfactuals are the most natural way of explaining model behaviour to humans. However, it has certain limitations, the most important one of which is that it only applies to classification problems.", "Another problem is that sometimes it provides explanations which, practically, cannot be fulfilled to reverse the decision. For example, age cannot be reversed. So we try to run counterfactuals by imposing that age cannot be changed.", "Note that there can be multiple counterfactual explanations for a single datapoint, since there can be many ways to reach the decision boundary. We can choose the one that respects our business constraints of any other practical constraints.", "Having said this, it is a powerful arrow in your XAI quiver!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe9ee8ed90cfd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cervio.medium.com/?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": ""}, {"url": "https://cervio.medium.com/?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": "Chetana Didugu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb513a31190a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&user=Chetana+Didugu&userId=b513a31190a0&source=post_page-b513a31190a0----e9ee8ed90cfd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9ee8ed90cfd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9ee8ed90cfd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://christophm.github.io/interpretable-ml-book/counterfactual.html", "anchor_text": "book"}, {"url": "https://docs.seldon.io/projects/alibi/en/stable/examples/cfproto_housing.html", "anchor_text": "alibi"}, {"url": "http://lib.stat.cmu.edu/datasets/boston", "anchor_text": "Boston House Pricing"}, {"url": "https://arxiv.org/pdf/1907.02584.pdf", "anchor_text": "this"}, {"url": "https://medium.com/tag/counterfactual?source=post_page-----e9ee8ed90cfd---------------counterfactual-----------------", "anchor_text": "Counterfactual"}, {"url": "https://medium.com/tag/ml-explainability?source=post_page-----e9ee8ed90cfd---------------ml_explainability-----------------", "anchor_text": "Ml Explainability"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----e9ee8ed90cfd---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/aiml?source=post_page-----e9ee8ed90cfd---------------aiml-----------------", "anchor_text": "Aiml"}, {"url": "https://medium.com/tag/xai?source=post_page-----e9ee8ed90cfd---------------xai-----------------", "anchor_text": "Xai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe9ee8ed90cfd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&user=Chetana+Didugu&userId=b513a31190a0&source=-----e9ee8ed90cfd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe9ee8ed90cfd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&user=Chetana+Didugu&userId=b513a31190a0&source=-----e9ee8ed90cfd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9ee8ed90cfd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe9ee8ed90cfd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e9ee8ed90cfd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e9ee8ed90cfd--------------------------------", "anchor_text": ""}, {"url": "https://cervio.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cervio.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chetana Didugu"}, {"url": "https://cervio.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "168 Followers"}, {"url": "https://www.linkedin.com/in/kavitha-chetana-didugu/", "anchor_text": "https://www.linkedin.com/in/kavitha-chetana-didugu/"}, {"url": "https://github.com/kavithacd", "anchor_text": "https://github.com/kavithacd"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb513a31190a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&user=Chetana+Didugu&userId=b513a31190a0&source=post_page-b513a31190a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffb4adc1375bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-counterfactual-explanations-for-classification-models-e9ee8ed90cfd&newsletterV3=b513a31190a0&newsletterV3Id=fb4adc1375bf&user=Chetana+Didugu&userId=b513a31190a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}