{"url": "https://towardsdatascience.com/time-series-forecasting-with-a-sarima-model-db051b7ae459", "time": 1683002649.873993, "path": "towardsdatascience.com/time-series-forecasting-with-a-sarima-model-db051b7ae459/", "webpage": {"metadata": {"title": "Time Series Forecasting with a SARIMA Model | by Andrew Graves | Towards Data Science", "h1": "Time Series Forecasting with a SARIMA Model", "description": "Hey there! In this article, I\u2019ll run through an example of electricity load forecasting using a SARIMA model. Three years of daily electricity load data was gathered for a building on the UC Berkeley\u2026"}, "outgoing_paragraph_urls": [{"url": "https://engagementdashboard.com/ucb/ucb/", "anchor_text": "daily electricity load data", "paragraph_index": 0}, {"url": "http://people.duke.edu/~rnau/Slides_on_ARIMA_models--Robert_Nau.pdf", "anchor_text": "SARIMA models", "paragraph_index": 7}, {"url": "http://people.duke.edu/~rnau/411arim3.htm", "anchor_text": "ACF and PACF plots", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Akaike_information_criterion", "anchor_text": "AIC", "paragraph_index": 13}, {"url": "https://www.liip.ch/en/blog/time-series-prediction-a-short-comparison-of-best-practices", "anchor_text": "walk forward validation", "paragraph_index": 15}, {"url": "https://public.tableau.com/profile/andrew.graves8383#!/vizhome/Load_Forecasting_Dashboard/Dashboard1", "anchor_text": "here", "paragraph_index": 23}, {"url": "https://github.com/gravesa333/Electricity_Load_Forecasting", "anchor_text": "here", "paragraph_index": 23}], "all_paragraphs": ["Hey there! In this article, I\u2019ll run through an example of electricity load forecasting using a SARIMA model. Three years of daily electricity load data was gathered for a building on the UC Berkeley campus to create a model based on the building\u2019s electricity use from January 2016 through October 2019. The model will predict the daily loads for November 2019, and its effectiveness will be measured using mean absolute percentage error. The following topics will be covered while detailing this process:", "Before modeling, let\u2019s take a look at some data to see if we can extract any meaningful information.", "Looking at Figure 1 above, there is a very clear weekly trend in the data. While there is a high electricity load when class is in session during the week, there is a lower electricity load during the weekend. This piece of insight will come in handy later on when determining the SARIMA parameters.", "For many types of time series models, it\u2019s important to verify that your data is stationary. As a quick summary, the data needs to satisfy the following requirements to ensure stationarity:", "It\u2019s clear from the EDA above that the data contains a periodic component, so transformations will need to be applied to make the data stationary. In this case, we\u2019ll apply both a first difference and weekly seasonal difference. Figure 2 below shows the same date range after the data has been differenced; it no longer contains the weekly trend.", "A quick and easy way to verify the data\u2019s stationarity is through the augmented Dickey-Fuller test. This can be done with the following code:", "The null hypothesis (p-value > 0.05) for this test is that the data is not stationary. Based on our output from the code above, the p-value was calculated to be ~ 0, so we can reject the null hypothesis and say that the data is in fact stationary. On to modeling!", "As a quick overview, SARIMA models are ARIMA models with a seasonal component. Per the formula SARIMA(p,d,q)x(P,D,Q,s), the parameters for these types of models are as follows:", "Two approaches were taken to determine the ideal SARIMA parameters: ACF and PACF plots, and a grid search. The ACF and PACF plots were used as a starting point to narrow down to a few potential parameters, and then a grid search was used to identify the best parameters. Let\u2019s take a look!", "ACF and PACF plots were generated using the following code, and can be seen in Figure 3 below.", "As can be seen, there are significant negative spikes in the ACF plot at lag 1 and lag 7 (weekly seasonal component). In the PACF plot, there are significant negative spikes at lags 1 and 2 (i.e. lags are slower to decay), as well as significant negative spikes at lags 7, 14, 21, etc. These characteristics suggest a potential parameter starting point of SARIMA(0,1,1)x(0,1,1,7):", "Using these parameters, the model was fit to the data, and then a new set of ACF and PACF plots of the model\u2019s residuals was evaluated. See the code below:", "See Figure 4 below for the ACF and PACF plots of the residuals. There are no significant spikes except for at lag 7. These parameters are an acceptable starting point for the model and can be further improved using a grid search.", "With a starting point of (0,1,1)x(0,1,1,7), a grid search was set up to test a number of different parameter combinations. It\u2019s worth looking at models where p = 0,1, or 2 and q = 1 or 2. A metric that can be used to compare the relative quality of each model is AIC (Akaike information criterion), which is an estimator of out-of-sample prediction error; a lower AIC score indicates a more predictive model. See the code below that generated the list of different parameter combinations, as well as the SARIMA model pipeline that tested each combination and printed the corresponding AIC scores:", "In this case, the lowest AIC score was achieved with p, P = 1 and q, Q = 2, so the final SARIMA model parameters to be used are SARIMA(1,1,2)x(1,1,2,7).", "As mentioned in the background of this article, the SARIMA model is predicting the daily electricity load for November 2019. While a simple train/test split is possible for time series (where the test data is the actual November 2019 load data in our case), a more robust option is walk forward validation in which the test data is split up multiple times. See code below; in the first walk through, daily loads for the first week of November are predicted based on the model fit to the training data. In the second walk through, the actual daily loads for the first week of November are added to the training data, the model is refit, and loads for the second week of November are predicted. The same process is followed for the third and fourth weeks of November.", "Mean absolute percentage error (MAPE) is a metric that can be used to evaluate the SARIMA model. For each predicted data point, the absolute difference from the corresponding test point was calculated, and then divided by the test point. The average percentage gives the MAPE. See the code below for walk forward validation and MAPE calculation.", "Our model\u2019s predictions had a MAPE of 9.74%. Not bad! Let\u2019s plot the predictions along with the actual data to see how they compare visually. See Figure 5 below.", "The predictions seem to follow the weekly trend fairly well, although there\u2019s pretty significant error for a number of the days throughout the month. Taking a closer look, these are holidays (specifically Veteran\u2019s Day on the 11th, and Thanksgiving Break at the end of the month).", "A quick way to improve the model\u2019s performance is to add in an exogenous variable that accounts for holidays throughout the year. Python has a \u201cholidays\u201d package that can be imported and used to determine whether or not a date is a holiday (U.S. holidays can be specified).", "The SARIMAX model that we\u2019ve been using so far simply takes in exogenous variables as an additional argument. See the code excerpt below:", "Running this model through the walk_forward_validation function, we get a MAPE of 7.04%. This is more than a 25% improvement on the initial model! See Figure 6 below for the updated forecast in comparison with the actual daily loads. There is a noticeable improvement for the Veteran\u2019s Day and Thanksgiving load predictions; adding in the holiday variable was beneficial! There is still room for improvement however, as there is still significant error for other days during Thanksgiving break. Methods to reduce those errors will not be explored here.", "To summarize, we ran through an electric load forecasting problem and covered a number of important time series topics. Checking for stationarity, analyzing ACF and PACF plots, performing validation, and considering exogenous variables are all essential when implementing SARIMA models.", "This project was extended to over 70 UC Berkeley buildings, and an interactive Tableau dashboard was created to display the forecasts; it can be viewed here. A recorded demonstration can be seen below as well. Click here to access the github repo for this project.", "Hope this overview was helpful. See you next time!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist with expertise in machine learning who is seeking to impact the world through sustainability and renewable energy solutions."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdb051b7ae459&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----db051b7ae459--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db051b7ae459--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gravesa333?source=post_page-----db051b7ae459--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gravesa333?source=post_page-----db051b7ae459--------------------------------", "anchor_text": "Andrew Graves"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F308631406e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&user=Andrew+Graves&userId=308631406e3b&source=post_page-308631406e3b----db051b7ae459---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb051b7ae459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb051b7ae459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.elenazhukova.com/educational#11", "anchor_text": "Elena Zhukova"}, {"url": "https://engagementdashboard.com/ucb/ucb/", "anchor_text": "daily electricity load data"}, {"url": "http://people.duke.edu/~rnau/Slides_on_ARIMA_models--Robert_Nau.pdf", "anchor_text": "SARIMA models"}, {"url": "http://people.duke.edu/~rnau/411arim3.htm", "anchor_text": "ACF and PACF plots"}, {"url": "https://en.wikipedia.org/wiki/Akaike_information_criterion", "anchor_text": "AIC"}, {"url": "https://www.liip.ch/en/blog/time-series-prediction-a-short-comparison-of-best-practices", "anchor_text": "walk forward validation"}, {"url": "https://public.tableau.com/profile/andrew.graves8383#!/vizhome/Load_Forecasting_Dashboard/Dashboard1", "anchor_text": "here"}, {"url": "https://github.com/gravesa333/Electricity_Load_Forecasting", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----db051b7ae459---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series?source=post_page-----db051b7ae459---------------time_series-----------------", "anchor_text": "Time Series"}, {"url": "https://medium.com/tag/sarima-model?source=post_page-----db051b7ae459---------------sarima_model-----------------", "anchor_text": "Sarima Model"}, {"url": "https://medium.com/tag/python?source=post_page-----db051b7ae459---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb051b7ae459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&user=Andrew+Graves&userId=308631406e3b&source=-----db051b7ae459---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb051b7ae459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&user=Andrew+Graves&userId=308631406e3b&source=-----db051b7ae459---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb051b7ae459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db051b7ae459--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdb051b7ae459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----db051b7ae459---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----db051b7ae459--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----db051b7ae459--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----db051b7ae459--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----db051b7ae459--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----db051b7ae459--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----db051b7ae459--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----db051b7ae459--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----db051b7ae459--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gravesa333?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gravesa333?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrew Graves"}, {"url": "https://medium.com/@gravesa333/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "61 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F308631406e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&user=Andrew+Graves&userId=308631406e3b&source=post_page-308631406e3b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff0c1cae1988&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-a-sarima-model-db051b7ae459&newsletterV3=308631406e3b&newsletterV3Id=f0c1cae1988&user=Andrew+Graves&userId=308631406e3b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}