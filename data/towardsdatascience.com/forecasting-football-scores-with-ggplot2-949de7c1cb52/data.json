{"url": "https://towardsdatascience.com/forecasting-football-scores-with-ggplot2-949de7c1cb52", "time": 1683012946.074021, "path": "towardsdatascience.com/forecasting-football-scores-with-ggplot2-949de7c1cb52/", "webpage": {"metadata": {"title": "Forecasting Football Scores in R | Towards Data Science", "h1": "Forecasting Football Scores With GgPlot2", "description": "The Poisson distribution can help to forecast the number of goals scored in a football match. Let's use R's Ggplot2 to help visualise some of these scores"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Poisson_distribution", "anchor_text": "Poisson distribution", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Sim%C3%A9on_Denis_Poisson", "anchor_text": "Sim\u00e9on Denis Poisson", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Ladislaus_Bortkiewicz", "anchor_text": "Ladislaus Bortkiewicz", "paragraph_index": 1}, {"url": "https://fbref.com/en/expected-goals-model-explained/", "anchor_text": "expected goals", "paragraph_index": 6}, {"url": "https://medium.com/@Soccermatics/luck-skill-and-randomness-aaa8d80836ea", "anchor_text": "This guy", "paragraph_index": 7}, {"url": "https://www.nytimes.com/2014/07/08/science/soccer-a-beautiful-game-of-chance.html#:~:text=It%20involves%20hundreds%20of%20skillful,victory%20is%20a%20single%20goal.", "anchor_text": "articles and studies", "paragraph_index": 7}, {"url": "https://dashee87.github.io/data%20science/football/r/predicting-football-results-with-statistical-modelling/", "anchor_text": "fantastic blog post", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/did-liverpool-deserve-to-win-the-premier-league-eda7a4e1b9ca#h1", "anchor_text": "previous post", "paragraph_index": 10}, {"url": "https://projects.fivethirtyeight.com/soccer-predictions/champions-league/", "anchor_text": "FiveThirtyEight\u2019s model", "paragraph_index": 12}, {"url": "https://www.youtube.com/watch?v=rbk4K2OIe0g", "anchor_text": "Robert Lewangoalski", "paragraph_index": 19}, {"url": "https://en.wikipedia.org/wiki/Butterfly_effect", "anchor_text": "wouldn\u2019t be here speaking about this today", "paragraph_index": 22}], "all_paragraphs": ["In one of my earlier posts, I mentioned that the scores in a football match can be approximated somewhat using the Poisson distribution, but I didn\u2019t go too much into the topic. Well, you\u2019re in luck today\u2026 we\u2019re going to have a look at the subject, and by the end of this post we\u2019ll have Ggplot2 visual illustrating the likely scores of a football match, which really is excellent.", "First off, a little bit on the roots of the Poisson distribution. The discovery of this probability distribution is attributed to Sim\u00e9on Denis Poisson, a French mathematician from the nineteenth century. Like many of his contemporaries at the time, he dealt mainly with its theories. It wasn\u2019t until Russian statistician Ladislaus Bortkiewicz published his book The Law of Small Numbers in 1898 that the Poisson distribution became widely used in practice.", "Bortkiewicz famously had access to a data set of the Prussian army over a period of 20 years which recorded the number of soldiers that were killed by their horses\u2019 kicks. Grim.", "Anyway, he showed that these deaths could be approximated by the Poisson distribution, and the rest, as they say, is history.", "Now\u2026 how does one go from Prussian cavalry to football scores?", "Let\u2019s first have a look at the basic assumptions that satisfy a Poisson process:", "Now think of goals as an event in a football match. If we had a metric that could express a team\u2019s scoring rate/intensity over 90 minutes, we can say that the first assumption is satisfied. This would\u2019ve been a pain in the arse to define, but thankfully the sports nerds (people a hundred times more intelligent than me, I should add) have come up with expected goals (xG) for this. Thanks for today!", "Next question- do goals occur randomly in a football match? That is to say, is there a particular point in time in a match when goals are more likely to be scored? This guy says no, and many other articles and studies also suggest that goals do occur at random in a football match. In practice, goals might not be as random as one might think but\u2026 we have enough evidence to argue that they are, so let\u2019s tick that box and move on for now.", "Now for the final assumption- that being, goals are independent of one another. If a team is behind, surely the players are working harder to get back into the game to score an equaliser. Or perhaps if a team is already leading by 5 goals, the players might take their foot off the gas and let one in due to complacency. Either way, you have to say that goals don\u2019t occur independently of one another, and using a basic Poisson process to model football scores starts to break down here.", "There are techniques to adjust for goal dependencies in a match, but we all have day jobs- so let\u2019s leave that for another day\u2026 and agree for now that two out of three isn\u2019t bad (also, I\u2019m pushing to generate useful content innit, so here we are). For further reading, I suggest having a look at this fantastic blog post that has basically done a Bortkiewicz for football, showing you can approximate the number goals scored over a season with the Poisson distribution.", "In my previous post on xG, I created a simple Poisson model to help predict the outcomes of a football match (home win, draw, away win) in R. We\u2019re going to use something similar here, but focus more on obtaining the probabilities of the correct scores as an output.", "R has come a long way from its base heat map libraries which haven\u2019t aged too well. Ggplot2 is a fantastic package which allows for all sorts of graphs and charts to be built. In order to use them, we have to first install some dependencies in RStudio:", "Cool, now let\u2019s go back to one of our original assumptions- that teams have a constant scoring rate over 90 minutes in a football match. We\u2019ll be using the shot-based xG taken from FiveThirtyEight\u2019s model for the Champions League quarter-final between Barcelona and Bayern Munich (oh boy\u2026). Let\u2019s construct and source a ScoreGrid:", "We\u2019ve created a data frame with 11 columns and 11 rows, each entry representing a correct score. So the entry in [row i , column j] is going to be the score i,j with i being the home score and j as the away score. Hence entry [1,2] is going to be a 2\u20131 win for the away team. dpois helps to generate a random Poisson probability for each score i, given the homeXg and awayXg. Finally, we cap the individual scores at 9, and once we get to 10 we\u2019re going to sum the probabilities together and group them as a single entry. It just makes things easier.", "Let\u2019s give it a quick spin. In the RStudio console, type", "Nice grid, but not too easy on the eye.", "Let\u2019s build the correct score visual now. We\u2019re going to use geom_tile() in Ggplot2, which generates a nice heat map at the end. Here\u2019s the code:", "Ggplot2 requires the input data to be a tidy dataframe, so the conversion from base R data.frame takes place on line 10 with pivot_longer. Next, we\u2019ll need to convert all our vars to factors and sort the levels in the correct order (remember that 10+ is a factor, using as.numeric will just cause it to become an NA. We want it to be the final level in the list). This is done on line 14 with ~forcats::fct_relevel. Everything beyond that just contains the usual building blocks of a Ggplot2 graph.", "Right, here we go. Fire up the R console and enter the team names and xG inputs from wherever your source was from:", "Men against boys in this match, and just by looking at the visualisation/heat map you can see the most likely score would have been 5\u20131 to Bayern Munich based on xG. In reality, Bayern actually won 8\u20132. Robert Lewangoalski indeed.", "One more to illustrate a closer match, yesterday evening\u2019s Champions League final between Paris Saint-Germain and Bayern Munich:", "A much tighter match, with 1\u20131 being the most probable score- Bayern Munich actually won 1\u20130.", "As always there are several caveats, one of which we\u2019ve already discussed- namely that goals aren\u2019t independent of one another, so the model is worth revisiting. Also, if any one of those xG chances had a different result (i.e. a shot hit the post or went wide instead of going in), we likely wouldn\u2019t be here speaking about this today\u2026 Let\u2019s not forget too how xG itself is a flawed metric which doesn\u2019t capture a lot of the nuances within a football match.", "Still, these visuals are a nice representation of how a match might have turned out- if anything, it\u2019s a good exercise in using some of the impressive R libraries for graphics and visualisation.", "As usual, you can nick all of this on my Github repository if I struggled to make any sense. Cheers for today\u2026", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F949de7c1cb52&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ourandy?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ourandy?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": "Andy Lee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4d1657156354&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&user=Andy+Lee&userId=4d1657156354&source=post_page-4d1657156354----949de7c1cb52---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F949de7c1cb52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F949de7c1cb52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@guoshiwushuang", "anchor_text": "@guoshiwushuang"}, {"url": "https://unsplash.com/photos/6J7eIvNwttQ", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Poisson_distribution", "anchor_text": "Poisson distribution"}, {"url": "https://en.wikipedia.org/wiki/Sim%C3%A9on_Denis_Poisson", "anchor_text": "Sim\u00e9on Denis Poisson"}, {"url": "https://en.wikipedia.org/wiki/Ladislaus_Bortkiewicz", "anchor_text": "Ladislaus Bortkiewicz"}, {"url": "https://fbref.com/en/expected-goals-model-explained/", "anchor_text": "expected goals"}, {"url": "https://medium.com/@Soccermatics/luck-skill-and-randomness-aaa8d80836ea", "anchor_text": "This guy"}, {"url": "https://www.nytimes.com/2014/07/08/science/soccer-a-beautiful-game-of-chance.html#:~:text=It%20involves%20hundreds%20of%20skillful,victory%20is%20a%20single%20goal.", "anchor_text": "articles and studies"}, {"url": "https://dashee87.github.io/data%20science/football/r/predicting-football-results-with-statistical-modelling/", "anchor_text": "fantastic blog post"}, {"url": "https://towardsdatascience.com/did-liverpool-deserve-to-win-the-premier-league-eda7a4e1b9ca#h1", "anchor_text": "previous post"}, {"url": "https://projects.fivethirtyeight.com/soccer-predictions/champions-league/", "anchor_text": "FiveThirtyEight\u2019s model"}, {"url": "https://www.youtube.com/watch?v=rbk4K2OIe0g", "anchor_text": "Robert Lewangoalski"}, {"url": "https://en.wikipedia.org/wiki/Butterfly_effect", "anchor_text": "wouldn\u2019t be here speaking about this today"}, {"url": "https://towardsdatascience.com/did-liverpool-deserve-to-win-the-premier-league-eda7a4e1b9ca", "anchor_text": "Did Liverpool Deserve to Win the Premier League?Premier League 2019/20 Review Using Python, R, and Expected Goalstowardsdatascience.com"}, {"url": "https://github.com/ourandy/blog-repo", "anchor_text": "ourandy/blog-repoRepository for blog posts. Contribute to ourandy/blog-repo development by creating an account on GitHub.github.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----949de7c1cb52---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/sports?source=post_page-----949de7c1cb52---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/programming?source=post_page-----949de7c1cb52---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/math?source=post_page-----949de7c1cb52---------------math-----------------", "anchor_text": "Math"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----949de7c1cb52---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F949de7c1cb52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&user=Andy+Lee&userId=4d1657156354&source=-----949de7c1cb52---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F949de7c1cb52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&user=Andy+Lee&userId=4d1657156354&source=-----949de7c1cb52---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F949de7c1cb52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F949de7c1cb52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----949de7c1cb52---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----949de7c1cb52--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----949de7c1cb52--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----949de7c1cb52--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----949de7c1cb52--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ourandy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ourandy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andy Lee"}, {"url": "https://medium.com/@ourandy/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "73 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4d1657156354&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&user=Andy+Lee&userId=4d1657156354&source=post_page-4d1657156354--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7a34a89270b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-football-scores-with-ggplot2-949de7c1cb52&newsletterV3=4d1657156354&newsletterV3Id=7a34a89270b1&user=Andy+Lee&userId=4d1657156354&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}