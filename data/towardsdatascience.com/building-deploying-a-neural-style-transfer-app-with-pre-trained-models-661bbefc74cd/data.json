{"url": "https://towardsdatascience.com/building-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd", "time": 1683007063.2467442, "path": "towardsdatascience.com/building-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd/", "webpage": {"metadata": {"title": "Building + deploying a Neural Style Transfer app with pre-trained models | by Ran (Reine) | Towards Data Science", "h1": "Building + deploying a Neural Style Transfer app with pre-trained models", "description": "I feel like one of the issues I\u2019ve faced with regards to learning software development is that many tutorials are often too technical (and not fun). This is probably because of the nature of software\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/ProGamerGov/Torch-Models", "anchor_text": "ProGamerGov", "paragraph_index": 2}, {"url": "https://github.com/jcjohnson/fast-neural-style/blob/master/models/download_style_transfer_models.sh", "anchor_text": "jcjohns", "paragraph_index": 2}, {"url": "https://opensource.com/article/18/4/flask", "anchor_text": "This article gives a pretty good explanation of Flask.", "paragraph_index": 4}, {"url": "https://www.pyimagesearch.com/2018/08/27/neural-style-transfer-with-opencv/", "anchor_text": "His article", "paragraph_index": 6}, {"url": "https://devcenter.heroku.com/articles/getting-started-with-python?singlepage=true#define-a-procfile", "anchor_text": "Procfile", "paragraph_index": 10}, {"url": "https://help.heroku.com/IYRYW6VB/how-do-i-install-additional-software-packages-that-my-application-requires", "anchor_text": "Aptfile", "paragraph_index": 12}, {"url": "https://www.heroku.com/dynos", "anchor_text": "Heroku", "paragraph_index": 12}], "all_paragraphs": ["I feel like one of the issues I\u2019ve faced with regards to learning software development is that many tutorials are often too technical (and not fun). This is probably because of the nature of software development but I feel like grasping technical concepts is as important as building fun mini-projects that will continue to encourage and spur us on. \u0f3c \u3064 \u25d5_\u25d5 \u0f3d\u3064", "I thought it\u2019ll be really cool to build something simple that involves image processing and deploy it online to show off to our friends and family. So today\u2019s tutorial will be a diagrammatically-explained walkthrough of how to build a web app that:", "A quick explanation of the directory structure above \u2014 All the files are needed except test.py. test.py was used for me to locally test and see if my neuralStyleProcess.py script was working correctly. I have 11 .t7 models in my project but you can decide how many you want (downloaded from ProGamerGov and jcjohns). Lastly, you can just ignore __pycache__ coz its auto-generated.", "In the diagram above, I\u2019ve tried to only include the most important bits that\u2019ll hopefully help you guys understand how the web app works (I called mine pyFlaskOpenCV \u2014 bad naming, I know >.<). Also, it\u2019s missing chunks of code, and parts of it are pseudocodes (I\u2019ve labeled them), and the \u2018\u2026\u2019s are also NOT actual codes.", "Let\u2019s start with the app.py script. Think of this as the app\u2019s root \u2014 we use this to set up the routes (something like the \u2018control\u2019 that tells things how to interact). This article gives a pretty good explanation of Flask. As we can see in the diagram above, render_template() will render our upload.html template. This means that our upload.html page will be displayed to us and as we can see from the diagram, there is a form with a POST method. With action=\u201c{{url_for(\u2018upload\u2019)}}\u201d, we call def upload() and in that function, we let users upload image(s) with the following codes:", "From complete.html, we again use \u201curl_for(\u2018send_processed_image\u2019, parameter1, parameter2)\u201d to invoke send_processed_image function that will call our python OpenCV image processing script neuralStyleProcess.py. neuralStyleProcess.py writes the processed image to file with imwrite and returns the processed image filename so send_processed_image function knows what to send from directory to complete.html.", "With regard to the neuralStyleProcess.py script, my implementation is largely adapted from pyImageSearch\u2019s tutorial. His article gives a thorough and detailed explanation of how it works. The only parts I've changed are \u2014 instead of showing the image, I did an imwrite and I removed the scaling part for the post-processing of the image.", "You don\u2019t have to use Heroku, there are other options out there but because our models take up quite a bit of space (their sizes can add up), remember to choose servers that will give you a little more storage space (e.g. Heroku\u2019s free tier worked fine for me but PythonAnywhere\u2019s free tier didn\u2019t).", "Continuing from our previous diagram, we still need to provide Heroku with three additional files so Heroku \u201cknows\u201d what to do with our web app. These files are \u2014 Procfile, requirements.txt, Aptfile.", "Again, here\u2019s a diagram to better explain things:", "A Procfile is a text file in the root directory of your application, to explicitly declare what command should be executed to start your app. In my case, here\u2019s mine:", "Okay please let me rant. BECAUSE OF THIS I SPENT HOURS DEBUGGING!!! Why? Coz they apparently care a lot about spaces. So if you wrote \u2014 web:gunicorn app:app/ web:gunicorn app: app/ or any other configuration (okay i haven\u2019t tried all, but I know its space (very) sensitive \u0ca5_\u0ca5)", "We use Aptfile to include other additional software that we need to be installed on the dyno. What\u2019s dyno? According to Heroku, \u201cThe containers used at Heroku are called \u201cdynos.\u201d Dynos are isolated, virtualized Linux containers that are designed to execute code based on a user-specified command.\u201d", "Here is what\u2019s in mine (OpenCV requires the following libraries to run correctly):", "in my terminal to generate my requirements.txt. If you\u2019re interested in what\u2019s in it:", "One of the trickiest things about working with libraries like OpenCV-python and NumPy is that it can be really tedious to figure out which version works together and which doesn\u2019t. (Sometimes version 4.2.0.32 works but 4.1.0 might not.) These are the versions that work for me.", "Aight, hope that helped someone gain a better understanding of how things work. I\u2019m not sure if this is a better way of going through codes rather than breaking the codes into chunks and then explaining each line \u2014 I personally find that most tutorials lack diagrammatical explanations so I thought I\u2019d present things in a way that feels most intuitive to myself \u2014 do lemme know what you guys think.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I live for days when I can watch skies of blue, while enjoying the view. Most other days I\u2019m a city rat who scuttles between Art and Coding. SG NTU CS Grad."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F661bbefc74cd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://reine-ran.medium.com/?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": ""}, {"url": "https://reine-ran.medium.com/?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": "Ran (Reine)"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F441e7a0a4faa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&user=Ran+%28Reine%29&userId=441e7a0a4faa&source=post_page-441e7a0a4faa----661bbefc74cd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F661bbefc74cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F661bbefc74cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/ProGamerGov/Torch-Models", "anchor_text": "ProGamerGov"}, {"url": "https://github.com/jcjohnson/fast-neural-style/blob/master/models/download_style_transfer_models.sh", "anchor_text": "jcjohns"}, {"url": "https://opensource.com/article/18/4/flask", "anchor_text": "This article gives a pretty good explanation of Flask."}, {"url": "https://www.pyimagesearch.com/2018/08/27/neural-style-transfer-with-opencv/", "anchor_text": "His article"}, {"url": "https://devcenter.heroku.com/articles/getting-started-with-python?singlepage=true#define-a-procfile", "anchor_text": "Procfile"}, {"url": "https://help.heroku.com/IYRYW6VB/how-do-i-install-additional-software-packages-that-my-application-requires", "anchor_text": "Aptfile"}, {"url": "https://www.heroku.com/dynos", "anchor_text": "Heroku"}, {"url": "https://github.com/Reine0017/pyFlaskOpenCV", "anchor_text": "https://github.com/Reine0017/pyFlaskOpenCV"}, {"url": "https://apricot-cupcake-90327.herokuapp.com/", "anchor_text": "https://apricot-cupcake-90327.herokuapp.com/"}, {"url": "https://medium.com/tag/flask?source=post_page-----661bbefc74cd---------------flask-----------------", "anchor_text": "Flask"}, {"url": "https://medium.com/tag/python?source=post_page-----661bbefc74cd---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/web-development?source=post_page-----661bbefc74cd---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/tag/neural-style-transfer?source=post_page-----661bbefc74cd---------------neural_style_transfer-----------------", "anchor_text": "Neural Style Transfer"}, {"url": "https://medium.com/tag/heroku?source=post_page-----661bbefc74cd---------------heroku-----------------", "anchor_text": "Heroku"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F661bbefc74cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&user=Ran+%28Reine%29&userId=441e7a0a4faa&source=-----661bbefc74cd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F661bbefc74cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&user=Ran+%28Reine%29&userId=441e7a0a4faa&source=-----661bbefc74cd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F661bbefc74cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F661bbefc74cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----661bbefc74cd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----661bbefc74cd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----661bbefc74cd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----661bbefc74cd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----661bbefc74cd--------------------------------", "anchor_text": ""}, {"url": "https://reine-ran.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://reine-ran.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ran (Reine)"}, {"url": "https://reine-ran.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "430 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F441e7a0a4faa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&user=Ran+%28Reine%29&userId=441e7a0a4faa&source=post_page-441e7a0a4faa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdcb13a040500&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-deploying-a-neural-style-transfer-app-with-pre-trained-models-661bbefc74cd&newsletterV3=441e7a0a4faa&newsletterV3Id=dcb13a040500&user=Ran+%28Reine%29&userId=441e7a0a4faa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}