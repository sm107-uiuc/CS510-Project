{"url": "https://towardsdatascience.com/yolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d", "time": 1683011419.8277278, "path": "towardsdatascience.com/yolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d/", "webpage": {"metadata": {"title": "YOLOv4 on Google Colab: Train your Custom Dataset (Traffic signs) with ease | by Quang Nguyen | Towards Data Science", "h1": "YOLOv4 on Google Colab: Train your Custom Dataset (Traffic signs) with ease", "description": "A while ago, I wrote a tutorial on training YOLOv3 with a custom dataset (gun detection) using the free GPU provided by Google Colab. After publishing the tutorial, many people emailed me asking\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@quangnhatnguyenle/how-to-train-yolov3-on-google-colab-to-detect-custom-objects-e-g-gun-detection-d3a1ee43eda1", "anchor_text": "tutorial on training YOLOv3 with a custom dataset (gun detection)", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/2004.10934.pdf", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/developer0hye/Yolo_Label", "anchor_text": "Yolo_label", "paragraph_index": 4}, {"url": "https://github.com/Cartucho/OpenLabeling", "anchor_text": "OpenLabeling", "paragraph_index": 4}, {"url": "https://github.com/AlexeyAB/Yolo_mark", "anchor_text": "Yolo_mark", "paragraph_index": 4}, {"url": "https://github.com/puzzledqs/BBox-Label-Tool", "anchor_text": "BBox-Label-Tool", "paragraph_index": 4}, {"url": "https://www.kaggle.com/valentynsichkar/traffic-signs-dataset-in-yolo-format", "anchor_text": "Kaggle", "paragraph_index": 8}, {"url": "https://colab.research.google.com/drive/1VNc-Ywrs1XmfHcsq-BWpXZ5Zv_A2FcFn?usp=sharing", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://www.marktechpost.com/2019/06/07/how-to-connect-google-colab-with-google-drive/", "anchor_text": "mount Drive with Colab environment", "paragraph_index": 10}, {"url": "https://colab.research.google.com/drive/1VNc-Ywrs1XmfHcsq-BWpXZ5Zv_A2FcFn?usp=sharing", "anchor_text": "Colab Notebook", "paragraph_index": 12}, {"url": "https://github.com/quangnhat185/Machine_learning_projects/blob/master/YOLOv4_traffic_signs_detection/YOLOV4_traffic_sign_detection.ipynb", "anchor_text": "OpenCV", "paragraph_index": 14}, {"url": "https://github.com/Ma-Dan/keras-yolo4", "anchor_text": "Keras", "paragraph_index": 14}, {"url": "https://github.com/Tianxiaomo/pytorch-YOLOv4", "anchor_text": "Pytorch", "paragraph_index": 14}, {"url": "https://github.com/AlexeyAB/darknet", "anchor_text": "original GitHub repository of YOLOv4", "paragraph_index": 16}, {"url": "https://medium.com/@quangnhatnguyenle/how-to-train-yolov3-on-google-colab-to-detect-custom-objects-e-g-gun-detection-d3a1ee43eda1", "anchor_text": "my article on training YOLOv3 on Colab", "paragraph_index": 16}, {"url": "https://drive.google.com/file/d/1-OGmSXd-CIOLRXWeth8UD21ssVhm-113/view?usp=sharing", "anchor_text": "YOLOv4 weights for traffic sign detection (2000 iterations)", "paragraph_index": 17}, {"url": "https://1drv.ms/u/s!AmvAoTF_vGyoeTqJMD2K1Ec9DO4?e=Laizbv", "anchor_text": "Traffic signs dataset in YOLO format", "paragraph_index": 18}], "all_paragraphs": ["A while ago, I wrote a tutorial on training YOLOv3 with a custom dataset (gun detection) using the free GPU provided by Google Colab. After publishing the tutorial, many people emailed me asking about problems they faced during their training process. What I noticed is that the majority of those issues come from modifying inappropriate layer architecture, running cells in incorrect directory paths or missing one/some of the required configuration steps. I also realized that the setting up process might take time and often can be quite confusing.", "For those reasons, I have came up with a new approach in which most of the setting up steps are automated with a python script (Colab allows you modifying and running python script directly on its environment). With this new procedure, the only thing you need to perform locally is to prepare your custom dataset following YOLO format, while all of the remains would be executed in Colab environment.", "YOLOv4 was developed by Alexey Bochkovskiy, Chien-Yao Wang, and Hong-Yuan Mark Liao. It was released in April 2020 and claimed as one of the state-of-the-art real-time object detectors at the time. According to its paper, YOLOv4 is 12% faster and 10% more accurate compare to YOLOv3. The new architecture of YOLOV4 is built with CSPDarknet54 as a backbone, which promotes the learning capability of CNN. Furthermore, the implement of universal features includes Weighted-Residual-Connections (WRC), Cross-Stage-Partial-connections (CSP), Cross mini-Batch Normalization (CmBN), Self-adversarial-training (SAT) and Mish-activation help YOLOv4 obtain a very impressive results. To get more details about YOLOv4, you can refer to the original paper here. [1]", "To be able to train our custom dataset with YOLOv4, it is mandatory that our dataset follows the YOLO format. Each image from the dataset would associate with a .txt file having the same name, which contains the object classes and their coordinate following this syntax: <object-class> <x_center> <y_center> <width> <height>", "There are many open-source GUI tools which can help you easily generate label file from image such as Yolo_label, OpenLabeling, Yolo_mark, BBox-Label-Tool, etc. Just simply drag and drop your mouse to create a bounding box around your objects, then the tool would generate the label file automatically.", "Next, you need to create 3 files: classes.names, train.txt and test.txt. The classes.names contains the names of your objects following format:", "Make sure that the index of your <object-class> from label file .txt is corresponded to the index of your classes name, e.g, <object-class> of object1_name, object2_name, object3_name are 0, 1, 2 respectively.", "train.txt and test.txt contains file paths of your training images and testing images. The idea is that you split your dataset into training set and test sets so that you will train your model on the training set and validate it on the test set. If the loss on your training set is high, it means your model is underfitting and you will need to train longer. If the loss is low on your training set and high on your test set, it means your model is overfitting and you will need to add more data. Depending on the number of images in your dataset that your validation set can be extracted from around 5% (small dataset) to 30% (large dataset) of the total dataset. These two files share the same format syntax as data/<image_path>.", "In this tutorial, I will use the Traffic Signs Dataset in YOLO format from Kaggle. You don\u2019t have to download it now since we will directly download it from Colab environment later. Examples of some of its images and labels can be seen as below (notice that one image can have multiple objects):", "In summary, the traffic sign dataset which we would use in this tutorial would be:", "For who is already familiar with Colab, you can jump right in my Colab notebook here and start playing around with it. However, make sure that you enable GPU in advance by select Runtime -> Change runtime type>Hardware accelerator>GPU, create directory YOLOv4_weight/backup in your Google Drive and mount Drive with Colab environment.", "As mentioned before, I have implemented some modifications which help the training process more straightforward:", "The notebook below demonstrates the pipeline of YOLOv4 training procedure on Colab. I will recommend you to take a look at my Colab Notebook to see what kind of output of each cell you should expect.", "Although I did define my max_batches=8000, both accuracy and loss from training result didn\u2019t improve much after 2000 iterations (Figure 2). The number of iterations might increase if you train with more classes or harder-to-learn dataset. Make sure that you monitor the loss and accuracy by double click on file chart.png or just simply look at the training statistic from the output cell.", "After obtain the training weights, there are several ways to deploy YOLOv4 with third-party frameworks including OpenCV, Keras, Pytorch, etc. However, those are beyond the scope of this tutorial. You can predict an image or video using the same Colab working space which you\u2019ve used for training process (Figure 3 and Figure 4). Cell 13 and 15 gives you an explicit way to predict an image and video respectively. By default, the predicted image is saved at predictions.jpg while the predicted video would be saved at output.mp4.", "This tutorial has introduced a new approach which allows you training your custom dataset with YOLOv4 on Google Colab with ease. All modifications relating to neural network architecture and training parameters are automated and can be performed within Colab environment, while unit tests are integrated to debug common compiling errors.", "However, I would like to point out that using an automated tool has its own price. The fact that you have no idea what is happening behind might be disturbing, especially people who want to have a better intuition about YOLOv4 architecture. In that case, you can refer to the original GitHub repository of YOLOv4 or read my article on training YOLOv3 on Colab.", "YOLOv4 weights for traffic sign detection (2000 iterations)", "Traffic signs dataset in YOLO format", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a researcher in the field of Robotics, Computer Vision and Artificial Intelligence. Email: quangnhatnguyenle@gmail.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3243ca91c81d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@quangnhatnguyenle?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@quangnhatnguyenle?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": "Quang Nguyen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc6e91f9ceb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&user=Quang+Nguyen&userId=c6e91f9ceb&source=post_page-c6e91f9ceb----3243ca91c81d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3243ca91c81d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3243ca91c81d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/j8CQ35hO82I", "anchor_text": "Hanns Adrian B\u00f6hme"}, {"url": "https://colab.research.google.com/drive/1VNc-Ywrs1XmfHcsq-BWpXZ5Zv_A2FcFn?usp=sharing", "anchor_text": "Colab Notebook for training YOLOv4 with custom dataset (traffic signs)"}, {"url": "https://medium.com/@quangnhatnguyenle/how-to-train-yolov3-on-google-colab-to-detect-custom-objects-e-g-gun-detection-d3a1ee43eda1", "anchor_text": "tutorial on training YOLOv3 with a custom dataset (gun detection)"}, {"url": "https://arxiv.org/pdf/2004.10934.pdf", "anchor_text": "here"}, {"url": "https://github.com/developer0hye/Yolo_Label", "anchor_text": "Yolo_label"}, {"url": "https://github.com/Cartucho/OpenLabeling", "anchor_text": "OpenLabeling"}, {"url": "https://github.com/AlexeyAB/Yolo_mark", "anchor_text": "Yolo_mark"}, {"url": "https://github.com/puzzledqs/BBox-Label-Tool", "anchor_text": "BBox-Label-Tool"}, {"url": "https://github.com/Cartucho/OpenLabeling", "anchor_text": "Source"}, {"url": "https://www.kaggle.com/valentynsichkar/traffic-signs-dataset-in-yolo-format", "anchor_text": "Kaggle"}, {"url": "https://colab.research.google.com/drive/1VNc-Ywrs1XmfHcsq-BWpXZ5Zv_A2FcFn?usp=sharing", "anchor_text": "here"}, {"url": "https://www.marktechpost.com/2019/06/07/how-to-connect-google-colab-with-google-drive/", "anchor_text": "mount Drive with Colab environment"}, {"url": "https://www.cyberciti.biz/faq/how-to-change-directory-in-linux-terminal/", "anchor_text": "cd command in Linux terminal"}, {"url": "https://github.com/AlexeyAB/darknet/wiki/CFG-Parameters-in-the-%5Bnet%5D-section", "anchor_text": "this page"}, {"url": "https://colab.research.google.com/drive/1VNc-Ywrs1XmfHcsq-BWpXZ5Zv_A2FcFn?usp=sharing", "anchor_text": "Colab Notebook"}, {"url": "https://github.com/quangnhat185/Machine_learning_projects/blob/master/YOLOv4_traffic_signs_detection/YOLOV4_traffic_sign_detection.ipynb", "anchor_text": "OpenCV"}, {"url": "https://github.com/Ma-Dan/keras-yolo4", "anchor_text": "Keras"}, {"url": "https://github.com/Tianxiaomo/pytorch-YOLOv4", "anchor_text": "Pytorch"}, {"url": "https://github.com/AlexeyAB/darknet", "anchor_text": "original GitHub repository of YOLOv4"}, {"url": "https://medium.com/@quangnhatnguyenle/how-to-train-yolov3-on-google-colab-to-detect-custom-objects-e-g-gun-detection-d3a1ee43eda1", "anchor_text": "my article on training YOLOv3 on Colab"}, {"url": "https://colab.research.google.com/drive/1VNc-Ywrs1XmfHcsq-BWpXZ5Zv_A2FcFn?usp=sharing", "anchor_text": "Train YOLOv4 on Colab notebook"}, {"url": "https://github.com/quangnhat185/darknet_for_colab", "anchor_text": "Darknet for colab repository"}, {"url": "https://drive.google.com/file/d/1-OGmSXd-CIOLRXWeth8UD21ssVhm-113/view?usp=sharing", "anchor_text": "YOLOv4 weights for traffic sign detection (2000 iterations)"}, {"url": "https://1drv.ms/u/s!AmvAoTF_vGyoeTqJMD2K1Ec9DO4?e=Laizbv", "anchor_text": "Traffic signs dataset in YOLO format"}, {"url": "https://medium.com/tag/yolov4?source=post_page-----3243ca91c81d---------------yolov4-----------------", "anchor_text": "Yolov4"}, {"url": "https://medium.com/tag/traffic-sign-detection?source=post_page-----3243ca91c81d---------------traffic_sign_detection-----------------", "anchor_text": "Traffic Sign Detection"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3243ca91c81d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/google-colab?source=post_page-----3243ca91c81d---------------google_colab-----------------", "anchor_text": "Google Colab"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----3243ca91c81d---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3243ca91c81d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&user=Quang+Nguyen&userId=c6e91f9ceb&source=-----3243ca91c81d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3243ca91c81d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&user=Quang+Nguyen&userId=c6e91f9ceb&source=-----3243ca91c81d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3243ca91c81d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3243ca91c81d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3243ca91c81d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3243ca91c81d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3243ca91c81d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3243ca91c81d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3243ca91c81d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@quangnhatnguyenle?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@quangnhatnguyenle?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Quang Nguyen"}, {"url": "https://medium.com/@quangnhatnguyenle/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "241 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc6e91f9ceb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&user=Quang+Nguyen&userId=c6e91f9ceb&source=post_page-c6e91f9ceb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33f8f73feefb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-in-google-colab-train-your-custom-dataset-traffic-signs-with-ease-3243ca91c81d&newsletterV3=c6e91f9ceb&newsletterV3Id=33f8f73feefb&user=Quang+Nguyen&userId=c6e91f9ceb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}