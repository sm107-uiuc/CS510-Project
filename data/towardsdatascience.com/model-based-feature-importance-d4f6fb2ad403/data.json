{"url": "https://towardsdatascience.com/model-based-feature-importance-d4f6fb2ad403", "time": 1682994453.4458501, "path": "towardsdatascience.com/model-based-feature-importance-d4f6fb2ad403/", "webpage": {"metadata": {"title": "Model-based feature importance. In an earlier post, I discussed a model\u2026 | by Vishal Singh | Towards Data Science", "h1": "Model-based feature importance", "description": "In an earlier post, I discussed a model agnostic feature selection technique called forward feature selection which basically extracted the most important features required for the optimal value of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@vishu160196/feature-importance-and-forward-feature-selection-752638849962", "anchor_text": "earlier post", "paragraph_index": 0}, {"url": "https://archive.ics.uci.edu/ml/datasets/Glass+Identification", "anchor_text": "Glass Identification dataset", "paragraph_index": 3}, {"url": "https://github.com/vishu160196/Feature-importance", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/bayesian-linear-regression-in-python-using-machine-learning-to-predict-student-grades-part-2-b72059a8ac7e", "anchor_text": "here", "paragraph_index": 16}, {"url": "http://www.statisticshowto.com/posterior-distribution-probability/", "anchor_text": "posterior probability distribution", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/markov-chain-monte-carlo-in-python-44f7e609be98", "anchor_text": "Markov Chain Monte Carlo", "paragraph_index": 17}, {"url": "https://archive.ics.uci.edu/ml/datasets/Computer+Hardware", "anchor_text": "here", "paragraph_index": 19}], "all_paragraphs": ["In an earlier post, I discussed a model agnostic feature selection technique called forward feature selection which basically extracted the most important features required for the optimal value of chosen KPI. It had one caveat though \u2014 large time complexity. In order to circumvent that issue feature importance can directly be obtained from the model being trained. In this post, I will consider 2 classification and 1 regression algorithms to explain model-based feature importance in detail.", "An inherently binary classification algorithm, it tries to find the best hyperplane in k-dimensional space that separates the 2 classes, minimizing logistic loss.", "The k dimensional weight vector can be used to get feature importance. Large positive values of w_j signify higher importance of the jth feature in the prediction of positive class. Large negative values signify higher importance in the prediction of negative class. This can be seen from the expression of logistic loss. SGD reduces loss by setting learning large positive weights for features more important in predicting a data point to belong to the positive class and similarly for negative class.", "In order to illustrate the above concept, let us try to extract the top 4 features from Glass Identification dataset having 9 attributes, namely", "All being real-valued. Entire code can be found here.", "The objective is to predict the type of glass from amongst 7 classes, given above features. In order to keep things simple to understand, only points belonging to 2 classes are chosen. This leaves us with a binary classification problem making logistic regression an ideal candidate to solve it.", "Final dataset has 146 points each having 9 attributes. The objective is to predict whether given glass composition is float-processed or non-float-processed. EDA reveals the scale difference between features, hence min-max scaling is used to squash all feature values in the interval [0, 1].", "Next, the best hyperparameter is searched using grid search on C(the term multiplying logistic loss, find more here). The best hyperparameter offers a log loss of 0.54 and an accuracy of about 70%. Not bad considering the small amount of data that we have.", "The most important features as found using parameters learned by SGD are enumerated here for convenience.", "Random forest is an ensemble model using decision trees as base learners. The base learners are high variance, low bias models. The variance of the overall model is reduced by aggregating the decisions taken by all base learners to predict the response variable. The idea is to ensure that each base learner learns a different aspect of data. This is achieved via both row and column sampling. In a classification setting the aggregation is done by taking a majority vote.", "At each node of a decision tree, the feature to be used for splitting the dataset is decided based on information gain(I.G.) or the more computationally cheap Gini impurity reduction. The feature that maximizes I.G. (or reduction in Gini impurity) is selected as the splitting feature. Data is then divided amongst its children according to the value of splitting feature. If the feature is categorical, data belonging to each category of splitting feature goes to a separate child. In the case of a numerical feature, the best threshold value of the feature (the one used to decide in favor of this feature to be used as splitting feature) is used to split data into two parts, each going to one child.", "Information Gain due to a feature summed across all the levels of decision tree determines its feature importance. This can also be seen from the fact that at every node splitting is done on the feature which maximizes Information Gain.", "Random forests comprise multiple decision trees, thus the feature importance of feature j is the normalized sum of I.G. brought about by feature j across all trees. Let us head back to the Glass Identification dataset and see what features are deemed important by Random Forest.", "Random forest performs significantly better than logistic regression at solving this task. It gives above 90% accuracy and 0.22 log-loss. Scikit-learn\u2019s random forest model has a feature_importance_ attribute that gives the value of Gini impurity reduction caused by each feature across all levels normalized across trees. The only hyperparameter of interest here is the number of base learners. A grid search is performed which gives 33 base learners as an optimal value. Random forests seldom overfit, usually, they saturate with an increasing number of base learners, increasing computational overhead without deteriorating performance. The results have been summarised here.", "First a little introduction to Bayesian models and how they differ from conventional machine learning models used very frequently (also called frequentist models) such as KNN, logistic regression, SVM, decision trees etc. What most of us are used to is this", "Bayesian models instead of predicting 1 output for a given input, give a distribution from which output may be sampled. A Bayesian model shows the amount of uncertainty in the response variable by giving its probability distribution. Usually, the response variable is modeled as Gaussian.", "Here \u03b2 (model parameters or weight vector) is also sampled from distributions \u2014 one for each parameter. As stated here The objective is to determine the posterior probability distribution for the model parameters given the inputs, X, and outputs, y.", "Posterior probability distributions are estimated by taking samples using sampling methods like Markov Chain Monte Carlo (MCMC). As more samples are drawn, the estimates converge to the true value.", "Mean values of model parameters obtained from posterior distributions can be used to make point estimates about them and in turn about the mean of the normal distribution of the response variable. Response variable can itself be estimated using its mean value. The certainty of these estimates depends on individual distributions and increases with the amount of data fed to the model. The model weights can be interpreted in a manner similar to that of linear regression or logistic regression. Higher the absolute value of a feature weight, more is its importance. In case two or more features have similar weights, the one whose value is more certain as indicated by its distribution, should be given higher importance, since the model is more confident about its value than it is about others.", "Using the above insights, let us examine which features are more important for predicting published rating of an electronic device given a bunch of information about it. The dataset can be found here. Using 2 chains and 2000 draws from the posterior, the following distributions were obtained", "Since the data is very less (167 train points) we have a high standard deviation, showing high model uncertainty. As the data increases i.e. as we gather more evidence the model estimate improves and eventually washes over the prior, which in this case is assumed to be Gaussian. For infinite data, the Bayesian model converges to frequentist. Mean weight values are used for getting feature importance.", "That\u2019s it for this post. Do let me know other good techniques to get feature importance in the comments section. Until next time\u2026Farewell.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd4f6fb2ad403&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vishu160196?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vishu160196?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": "Vishal Singh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F74e62bc18439&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&user=Vishal+Singh&userId=74e62bc18439&source=post_page-74e62bc18439----d4f6fb2ad403---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4f6fb2ad403&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4f6fb2ad403&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@vishu160196/feature-importance-and-forward-feature-selection-752638849962", "anchor_text": "earlier post"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Glass+Identification", "anchor_text": "Glass Identification dataset"}, {"url": "https://github.com/vishu160196/Feature-importance", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/bayesian-linear-regression-in-python-using-machine-learning-to-predict-student-grades-part-2-b72059a8ac7e", "anchor_text": "here"}, {"url": "http://www.statisticshowto.com/posterior-distribution-probability/", "anchor_text": "posterior probability distribution"}, {"url": "https://towardsdatascience.com/@williamkoehrsen?source=post_header_lockup", "anchor_text": "Will Koehrsen"}, {"url": "https://towardsdatascience.com/markov-chain-monte-carlo-in-python-44f7e609be98", "anchor_text": "Markov Chain Monte Carlo"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Computer+Hardware", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/introduction-to-bayesian-linear-regression-e66e60791ea7", "anchor_text": "https://towardsdatascience.com/introduction-to-bayesian-linear-regression-e66e60791ea7"}, {"url": "https://towardsdatascience.com/bayesian-linear-regression-in-python-using-machine-learning-to-predict-student-grades-part-2-b72059a8ac7e", "anchor_text": "https://towardsdatascience.com/bayesian-linear-regression-in-python-using-machine-learning-to-predict-student-grades-part-2-b72059a8ac7e"}, {"url": "https://github.com/WillKoehrsen/Data-Analysis/blob/master/bayesian_lr/Bayesian%20Linear%20Regression%20Project.ipynb", "anchor_text": "https://github.com/WillKoehrsen/Data-Analysis/blob/master/bayesian_lr/Bayesian%20Linear%20Regression%20Project.ipynb"}, {"url": "https://wiseodd.github.io/techblog/2017/01/05/bayesian-regression/", "anchor_text": "https://wiseodd.github.io/techblog/2017/01/05/bayesian-regression/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d4f6fb2ad403---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd4f6fb2ad403&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&user=Vishal+Singh&userId=74e62bc18439&source=-----d4f6fb2ad403---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd4f6fb2ad403&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&user=Vishal+Singh&userId=74e62bc18439&source=-----d4f6fb2ad403---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4f6fb2ad403&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd4f6fb2ad403&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d4f6fb2ad403---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d4f6fb2ad403--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vishu160196?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vishu160196?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vishal Singh"}, {"url": "https://medium.com/@vishu160196/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "108 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F74e62bc18439&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&user=Vishal+Singh&userId=74e62bc18439&source=post_page-74e62bc18439--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa348c4e2175f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-feature-importance-d4f6fb2ad403&newsletterV3=74e62bc18439&newsletterV3Id=a348c4e2175f&user=Vishal+Singh&userId=74e62bc18439&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}