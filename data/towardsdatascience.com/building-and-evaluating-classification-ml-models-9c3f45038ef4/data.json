{"url": "https://towardsdatascience.com/building-and-evaluating-classification-ml-models-9c3f45038ef4", "time": 1683012453.4469278, "path": "towardsdatascience.com/building-and-evaluating-classification-ml-models-9c3f45038ef4/", "webpage": {"metadata": {"title": "Building and Evaluating Classification ML Models | by Nishit Jain | Towards Data Science", "h1": "Building and Evaluating Classification ML Models", "description": "All the information you need about building a good classification model and evaluating its performance the right way in the world of machine learning. Handling class imbalance and data distribution plays a very significant role to develop good machine learning models in any experiment."}, "outgoing_paragraph_urls": [{"url": "http://www.linkedin.com/in/thenishitjain", "anchor_text": "www.linkedin.com/in/thenishitjain", "paragraph_index": 31}], "all_paragraphs": ["There are different types of problems in machine learning. Some might fall under regression (having continuous targets) while others might fall under classification (having discrete targets). Some might not have a target at all where you are just trying to learn the characteristics of data by distinguishing the data points based on their inherent features by creating clusters.", "However, this article is not about different areas of machine learning but about a very little yet important thing, which if not tended to carefully can wreak \u201cwho knows what\u201d on your operationalized classification models and eventually, the business. Therefore, the next time when someone at work tells you that her/his model is giving ~93.23% accuracy, do not fall for it before asking the right questions.", "So, how do we know what are the right questions?", "That\u2019s a good question. Let us try to answer that by studying how to build and evaluate a classification model the right way. Everyone who has been studying machine learning is aware of all frequently used classification metrics but only a few of them know the right one to use to evaluate the performance of their classification model.", "So, to enable you to ask the right questions, we will go through the following concepts in detail (for a classification model):", "While splitting data for training, validation, and test set, one should always keep in mind that all three of them must be representative of the same population. For example, in the MNIST digit classification dataset where all the digit images are grey (black and white), you train it and achieve a validation accuracy of almost 90%, but your test data has digit images of various colors (not just black and white). Now, you have a problem there. No matter what you do, there will always be a data bias. You cannot get rid of it totally but what you can do is maintain a uniformity in your validation and test data set. This is an example of a difference in the distribution of validation and test sets.", "Your test data set MUST always represent real-world data distribution. For example, in a binary classification problem, where you are supposed to detect positive patients for a rare disease (class 1) where 6% of the entire data set contains positive cases, then your test data should also have almost the same proportion. Make sure you follow the same distribution. This is not just the case with classification models. It holds for every type of ML modeling problem.", "The test dataset should be extracted first without any data leakage into the leftover data and then, validation data must follow the distribution in the test data. And, what remains after these two splits goes into training. Hence, the right sequence to divide the entire dataset into training, validation, and test sets is to get the test, validation, and training set specifically in that order from the entire dataset.", "There is a convenience of 70\u201320\u201310 split in the machine learning community but that is only when you have an average amount of data. If you are working on, for instance, an image classification problem and you have ~10 million of images, then doing a 70\u201320\u201310 split would be a bad idea because the amount of data is so huge that to validate your model, even 1 to 2% of it is enough. Hence, I would rather go with 96\u20132\u20132 split because you do not want to increase the unnecessary overhead on validation and test by increasing the size as the same representation of distribution can be achieved using 2% of the total data in the validation and test. Also, make sure you do not sample with a replacement while making splits.", "In case of any classification problem, which affects the performance of a model most is the amount of loss contributed by every class to the total cost. The higher the number of examples of a certain class, the total loss contribution of that class is higher. The loss contribution to the total cost by a class is directly proportional to the number of examples belonging to that class. In this way, the classifier concentrates more on classifying those instances correctly which are contributing more to the total cost of the loss function (i.e. the instances from the majority class).", "Following are the ways using which we can tackle class imbalance:", "In binary cross-entropy loss, we have the following loss function:", "The model outputs the probability that the given example belongs to a positive (y=1) class. And, based on the above binary cross-entropy loss function, loss value is computed per example, and finally, the total cost is computed as the average loss across all examples. Let us conduct a simple simulation to understand it better by writing a simple python script. Let\u2019s generate 100 ground truth labels, 25 out of which belong to the positive (y=1) class, and the rest are negative (y=0) to account for the class imbalance in our tiny experiment. Also, we will generate a random probability value of it belonging to the positive class for every example.", "Now, that we have ground truth labels and predicted probabilities, using the above loss function, we can compute the total loss contribution by both the classes. A really small number was added to the predicted probabilities before calculating the log value to avoid error due to undefined value. [log(0) = undefined]", "As we can see that the total loss over both the classes has a huge difference and the negative class is leading the race of loss contribution, the algorithm is technically going to focus more on the negative class to decrease loss radically while minimizing it. That is when we fool the model into believing what is not real by assigning a weight to total loss calculation by using the following weighted loss function:", "Here, \u2018Wp\u2019 & \u2018Wn\u2019 are weights assigned to positive and negative class loss respectively and can be calculated as follows:", "Wp = total number of negative (y=0) examples / total examples", "Wn = total number of positive (y=1) examples / total examples", "Now, let us calculate weighted loss by adding the weights to the calculation:", "Amazing! Isn\u2019t it? We managed to reduce the difference of loss contribution between both classes significantly by assigning the right weights.", "This is yet another technique using which you can counter class imbalance but this should not be the first technique you use. Resampling can be done in three ways:", "Oversampling can be achieved either by random sampling the minority class with the replacement or by synthetically generating more examples by using techniques such as SMOTE. Oversampling can help up to a limit because, after a certain amount, you are duplicating the information contained in the data. It might give you ideal loss contributions from both the classes but will fail at validation and test time. But, if you have a massive amount of data along with imbalance, you should go for undersampling without replacement of majority class.", "Sometimes, people do use both the techniques at once when there is an average amount of data, and class imbalance is not huge. So, they oversample the minority class and undersample the majority class by a certain calculated amount to achieve balance.", "Now, you understand when somebody comes to you and says I have got ~93.23% accuracy, you should think and ask about the class proportions in the data and the type of loss function used. Then, you should wonder whether measuring just accuracy is the right way to go. Or there is something more!", "There is always something more at least when you are working on a machine learning model but to know when you want more is only possible when you have something to compare to. A Benchmark! Once you have a benchmark, you know how much improvement you want.", "But to improve the performance, you need to know which metric is the right indicator of performance in the business problem you are trying to solve. For example, if you are trying to solve a tumor detection problem where the objective is to detect whether the tumor is malignant (y=1) or benign (y=0). In this case, you need to understand that in real word benign cases are more than the malignant cases. Hence, when you get the data, you will have a good amount of class imbalance (unless of course, you are really lucky). So, accuracy as a metric is out of the question. Now, the question is, what is more important? To detect whether a patient has a malignant tumor or a benign one. This is a business decision and you should always consult a domain expert(s) (in this case, expert doctors) to understand the business problem by asking such questions. If we are more concerned with detecting malignant tumors effectively even if we have a few false positives (Ground Truth: Benign, Model Prediction: Malignant) but we need as minimum false negatives (Ground Truth: Malignant, Model Prediction: Benign) as possible, then Recall should be our metric of choice but if it is vice-versa (which can never be in this particular case), Precision should be our choice.", "Sometimes, in a business setting, there are problems where you need effective classifications on both the classes and hence you would want to optimize the F1 score. To tackle this trade-off, we should work on maximizing the area under the precision-recall curve as much as possible.", "Also, the results must be conveyed in terms of confidence intervals with upper and lower bounds of the metric to get a fair idea of the behavior of the model on the population using all the experiments conducted over various samples.", "To summarize it all, the following are the major takeaways from this article:", "Thank you for reading the article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Learning from Data | Data Scientist | Wanderer | LinkedIN: www.linkedin.com/in/thenishitjain"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9c3f45038ef4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thenishitjain?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thenishitjain?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": "Nishit Jain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32b26764953a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&user=Nishit+Jain&userId=32b26764953a&source=post_page-32b26764953a----9c3f45038ef4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c3f45038ef4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c3f45038ef4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@martinsanchez?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Martin Sanchez"}, {"url": "https://unsplash.com/s/photos/natural-balance?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9c3f45038ef4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9c3f45038ef4---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/class-imbalance?source=post_page-----9c3f45038ef4---------------class_imbalance-----------------", "anchor_text": "Class Imbalance"}, {"url": "https://medium.com/tag/model-evaluation?source=post_page-----9c3f45038ef4---------------model_evaluation-----------------", "anchor_text": "Model Evaluation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9c3f45038ef4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c3f45038ef4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&user=Nishit+Jain&userId=32b26764953a&source=-----9c3f45038ef4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c3f45038ef4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&user=Nishit+Jain&userId=32b26764953a&source=-----9c3f45038ef4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c3f45038ef4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9c3f45038ef4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9c3f45038ef4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9c3f45038ef4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thenishitjain?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thenishitjain?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nishit Jain"}, {"url": "https://medium.com/@thenishitjain/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "108 Followers"}, {"url": "http://www.linkedin.com/in/thenishitjain", "anchor_text": "www.linkedin.com/in/thenishitjain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32b26764953a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&user=Nishit+Jain&userId=32b26764953a&source=post_page-32b26764953a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd113167357b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-evaluating-classification-ml-models-9c3f45038ef4&newsletterV3=32b26764953a&newsletterV3Id=d113167357b9&user=Nishit+Jain&userId=32b26764953a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}