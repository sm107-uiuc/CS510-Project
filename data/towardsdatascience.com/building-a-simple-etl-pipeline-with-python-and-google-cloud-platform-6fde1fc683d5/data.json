{"url": "https://towardsdatascience.com/building-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5", "time": 1683006214.524162, "path": "towardsdatascience.com/building-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5/", "webpage": {"metadata": {"title": "Building a Simple ETL Pipeline with Python and Google Cloud Platform | by Tobi Sam | Towards Data Science", "h1": "Building a Simple ETL Pipeline with Python and Google Cloud Platform", "description": "There are a lot of ETL tools out there and sometimes they can be overwhelming, especially when you simply want to copy a file from point A to B. So today, I am going to show you how to extract a CSV\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cloud.google.com/functions/", "anchor_text": "Cloud Functions", "paragraph_index": 8}, {"url": "https://aws.amazon.com/lambda/", "anchor_text": "AWS Lambda", "paragraph_index": 8}, {"url": "https://azure.microsoft.com/en-us/services/functions/", "anchor_text": "Azure Functions", "paragraph_index": 8}, {"url": "https://cloud.google.com/functions/docs/locations", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://medium.com/geekculture/secure-your-credentials-in-google-cloud-functions-with-secret-manager-22a4a1b3788a", "anchor_text": "guide", "paragraph_index": 16}, {"url": "https://cloud.google.com/bigquery/docs/tables", "anchor_text": "create your Bigquery table", "paragraph_index": 19}, {"url": "https://cloud.google.com/bigquery/docs/schema-detect", "anchor_text": "auto-detection", "paragraph_index": 19}, {"url": "https://cloud.google.com/scheduler/docs/creating", "anchor_text": "here", "paragraph_index": 21}, {"url": "https://crontab.guru/", "anchor_text": "site editor", "paragraph_index": 23}, {"url": "https://medium.com/@tobisam/membership", "anchor_text": "become a Medium member", "paragraph_index": 26}, {"url": "https://github.com/togobingi/google_cloud_function", "anchor_text": "Github", "paragraph_index": 27}], "all_paragraphs": ["There are a lot of ETL tools out there and sometimes they can be overwhelming, especially when you simply want to copy a file from point A to B. So today, I am going to show you how to extract a CSV file from an FTP server (Extract), modify it (Transform) and automatically load it into a Google BigQuery table (Load) using python 3.6 and Google Cloud Functions.", "At the end of this article, you will be able to extract a file from an FTP server and load it into a data-warehouse using Python in Google Cloud Functions.", "In this article, we will look to do the following:", "Extract, Transform, Load (ETL) is the general procedure of copying data from one or more sources into a destination system which represents the data differently from the source or in a different context than the source. \u2014 Wikipedia", "Let me give you some background info before we begin. A 3rd-party service provider had an FTP server which housed several CSV files, each containing the daily transaction data of a logistic company. We needed that data in our data warehouse so we could share it internally with stakeholders and to monitor performance.", "The infrastructure team at this logistics company exports one CSV file daily from their database, and uploads it to an FTP server.", "Our job was to copy those files daily from the server, clean it and then load it into our data warehouse so we could connect it to other data sources and run analytics on them.", "This is what our ETL pipeline diagram will look like in the end:", "Google Cloud Functions: Cloud Functions (CF) is Google Cloud\u2019s Serverless platform set to execute scripts responding to specified events, such as a HTTP request or a database update. An alternative to CF is AWS Lambda or Azure Functions.", "Make sure your runtime is set to \u201cPython 3.7\u201d and under \u201cAdvanced options\u201d change the region to one closest to you. As at the writing of this post, CF isn\u2019t available in every Google data-centre region, so check here to see where Cloud Functions is enabled.", "When you complete these steps, your display should look like this:", "A Cloud Function has two files; a main.py and a requirements.txt file. The latter host all the file dependencies we need for our script to work, so click on the requirements.txt tab and make sure you have these dependencies included in the editor like so:", "A quick summary of all dependencies:", "Now in the main.py tab, you can start including the code below. Looking at line 1 to 4. We created a function called \u201cftp_function\u201d, which we will refer to in the future when accessing the Cloud Function with a HTTP request. We then login to the FTP server with the necessary credentials, and navigate to the appropriate directory where the file is stored on the server.", "Please note, the FTP server I was working on, had multiple CSVs representing transaction data for different days. So to get the most recent file in the directory, I used the code starting at line 7 to line 9.", "The rest of the code grabs the file and downloads it.", "Note: To secure your credentials with a secret manager, follow this guide.", "To \u201ctransform\u201d the data, we are going to make a simple change to the CSV file we just downloaded. We will simply change every occurrence of \u201cFBA\u201d to \u201cAMAZON\u201d in the CSV file. Here is the code below.", "Note here too, Google Cloud Function has a /tmp directory where you can temporarily store files. Files in this directory are stored in the instance\u2019s RAM, therefore writing to /tmp takes up system memory. Once the instance stops running, all temporary files in the directory are deleted.", "Now, make sure you create your Bigquery table. And then we simply use this code below to load the transformed CSV file into the Bigquery table you have created. Since we are enabling \u201cauto-detection\u201d , the Bigquery table doesn\u2019t have to have a schema when creating it as it will be inferred based on the data in the CSV file.", "When you finish writing the script you can deploy the Cloud Function by clicking \u201cCreate\". When the Cloud Function deploys successfully, you should see a green check mark like so\u2026", "Now all that is left to do is to create a cron job (Cloud Scheduler) that will automate the call to the CF at some predefined interval. The good news is, creating cron jobs on Google Cloud Platform is very straightforward and really the simplest part. You can follow the instructions here or replicate the image below.", "The \u201cfrequency\u201d field here will run our script every day at 1:59AM.", "You can use this cool site editor for simple cron schedule expressions.", "Now that our data is sitting snug in the data warehouse, we can connect it to any visualisation tool and perform analysis on it.", "That is it. Hope you found this helpful. This was a very simple approach to developing an ETL that anyone can build on.", "You can become a Medium member and enjoy more stories like this.", "You can find the link to the full script on Github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6fde1fc683d5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tobisam?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobisam?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": "Tobi Sam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F92fab82e0c7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&user=Tobi+Sam&userId=92fab82e0c7a&source=post_page-92fab82e0c7a----6fde1fc683d5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6fde1fc683d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6fde1fc683d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cloud.google.com/blog/products/gcp", "anchor_text": "GCP"}, {"url": "https://www.lucidchart.com/pages/examples/uml_diagram_tool", "anchor_text": "Lucidchart"}, {"url": "https://cloud.google.com/functions/", "anchor_text": "Cloud Functions"}, {"url": "https://aws.amazon.com/lambda/", "anchor_text": "AWS Lambda"}, {"url": "https://azure.microsoft.com/en-us/services/functions/", "anchor_text": "Azure Functions"}, {"url": "https://console.cloud.google.com/functions/list", "anchor_text": "Go to the Cloud Functions Overview page"}, {"url": "https://github.com/togobingi/google_cloud_function/blob/master/mysqlToBQ.py", "anchor_text": "code"}, {"url": "https://cloud.google.com/functions/docs/locations", "anchor_text": "here"}, {"url": "https://cloud.google.com/", "anchor_text": "GCP console"}, {"url": "https://medium.com/geekculture/secure-your-credentials-in-google-cloud-functions-with-secret-manager-22a4a1b3788a", "anchor_text": "guide"}, {"url": "https://cloud.google.com/bigquery/docs/tables", "anchor_text": "create your Bigquery table"}, {"url": "https://cloud.google.com/bigquery/docs/schema-detect", "anchor_text": "auto-detection"}, {"url": "https://cloud.google.com/functions/docs/quickstart-console", "anchor_text": "source"}, {"url": "https://cloud.google.com/scheduler/docs/creating", "anchor_text": "here"}, {"url": "https://cloud.google.com/functions/docs/quickstart-console", "anchor_text": "source"}, {"url": "https://crontab.guru/", "anchor_text": "site editor"}, {"url": "https://medium.com/@tobisam/membership", "anchor_text": "become a Medium member"}, {"url": "https://github.com/togobingi/google_cloud_function", "anchor_text": "Github"}, {"url": "https://medium.com/tag/gcp?source=post_page-----6fde1fc683d5---------------gcp-----------------", "anchor_text": "Gcp"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----6fde1fc683d5---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/python?source=post_page-----6fde1fc683d5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/big-data?source=post_page-----6fde1fc683d5---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6fde1fc683d5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6fde1fc683d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&user=Tobi+Sam&userId=92fab82e0c7a&source=-----6fde1fc683d5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6fde1fc683d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&user=Tobi+Sam&userId=92fab82e0c7a&source=-----6fde1fc683d5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6fde1fc683d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6fde1fc683d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6fde1fc683d5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6fde1fc683d5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobisam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobisam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tobi Sam"}, {"url": "https://medium.com/@tobisam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "307 Followers"}, {"url": "https://www.linkedin.com/in/tobiwf/", "anchor_text": "https://www.linkedin.com/in/tobiwf/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F92fab82e0c7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&user=Tobi+Sam&userId=92fab82e0c7a&source=post_page-92fab82e0c7a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1c58a149f4ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-simple-etl-pipeline-with-python-and-google-cloud-platform-6fde1fc683d5&newsletterV3=92fab82e0c7a&newsletterV3Id=1c58a149f4ec&user=Tobi+Sam&userId=92fab82e0c7a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}