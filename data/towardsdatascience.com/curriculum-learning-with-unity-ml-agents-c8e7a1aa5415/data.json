{"url": "https://towardsdatascience.com/curriculum-learning-with-unity-ml-agents-c8e7a1aa5415", "time": 1683010908.4666061, "path": "towardsdatascience.com/curriculum-learning-with-unity-ml-agents-c8e7a1aa5415/", "webpage": {"metadata": {"title": "Curriculum Learning With Unity ML-Agents | by Adam Price | Towards Data Science", "h1": "Curriculum Learning With Unity ML-Agents", "description": "Curriculum Learning With Unity ML-Agents."}, "outgoing_paragraph_urls": [{"url": "https://github.com/adamprice97/UnityPursitEvasionGame", "anchor_text": "https://github.com/adamprice97/UnityPursitEvasionGame", "paragraph_index": 0}, {"url": "https://github.com/Unity-Technologies/ml-agents/blob/master/docs/Training-Configuration-File.md", "anchor_text": "consult Unity\u2019s documentation.", "paragraph_index": 12}], "all_paragraphs": ["To see the code that I produced for this article, see the GitHub repo here: https://github.com/adamprice97/UnityPursitEvasionGame", "When a person is present with a new problem, they need sufficient background knowledge to solve it. You can\u2019t expect someone to learn calculus without learning geometry first. The same is true for our reinforcement learning agents!", "In this article, I will present a challenging game environment and show you how it can be solved using Unity ML-Agents and curriculum learning.", "Pursuit-evasion games are a family of problems that task a group of agents with tracking down members of another group. In our implementation, we will be training a group of 3 hunters to capture a single prey. Each episode, the hunters spawn at the edge of the forest clearing, their goal is to capture the prey before it escapes into the trees!", "We can influence an agent\u2019s learning by rewarding them for completing tasks in the environment. For an agent to be successful during training, we need to define a set of rewards that can guide them towards a solution to the game.", "To navigate an environment, agents need to take actions. These actions let an agent directly interact with the environment and are chosen by an agent\u2019s policy. This policy is a function of the agent\u2019s observations that outputs an action for the agent to perform.", "Our hunters make and take the following observations and actions:", "This environment is fully observable, as each agent knows the exact location of itself, the other agents, and the prey. You will also notice that the Observation Vector is stacked, the previous two observation vectors inform the current action to take. Doing this lets the agent infer information on each entity\u2019s velocity.", "Our agent\u2019s actions let them push them selfs forwards and backwards on the Z and X planes, giving them full mobility across a fixed plane.", "Finally, the last element of the environment is the prey. It is controlled by a simple heuristic that will run directly away from the mean position of the hunter agents. The heuristic is simple, but the agents will have to work as a team as an intersection will be required to catch fast prey.", "The agents need to find actions that maximize the reward signal. To do this, we use a neural network as the agent\u2019s policy. Then, during training, the reward signal is used to update the neural network and improve the agent\u2019s policy.", "We need an algorithm to handle the training of these neural networks. Thankfully, Unity ML-Agents provides an implementation of Open-AI\u2019s proximal policy optimization (PPO) algorithm.", "We provide Unity with a config file to begin training. There are a lot of variables to consider, and each one can have a dramatic effect on training. For information on all of them, consult Unity\u2019s documentation.", "PPO is a powerful algorithm, but our environment is too complicated for an agent to enter blind. We need to create a better learning environment for our agents.", "Complex environments can require agents to grasp multiple concepts before they can begin to exploit the environment\u2019s reward single. These concepts can be so advanced that random exploration will not be able to reliably reinforce the actions taken to receive a reward. Our pursuit-evasion game is an example of this. The prey can easily evade naive agents, so the hunters will never discover the reward they would receive for capturing it.", "This is where curriculum learning comes in!", "Instead of letting the agent loose on the difficult environment, we first introduce them to an easier version of the game. From there, we can slowly increment the difficulty with progressively harder \u2018lessons\u2019.", "The difficulty of our pursuit-evasion game is controlled by two parameters:", "Our first lesson needs to be very easy; new agents need to learn to walk before they can hunt. We start with a stationary target (prey speed = 0) and a very wide capture range. We then decrease the capture range as the lessons are completed.", "Once the agents have fully grasped navigating their way to the prey we can begin to start letting the prey move, at gradually increasing speeds:", "With our lesson plan sorted, we just need to define the criteria for passing a lesson. Luckily, this is quite easy. We consider each lesson \u2018passed\u2019 when the agents can accumulate more than a threshold reward value over a set number of episodes. For our training, the lessons are passed when the agents can average over 4 reward per episode for 200 episodes. In practice, the agents need to capture the prey 8 out of 9 times (over 200 episodes) to pass a lesson.", "We train the agents in a speed-up unity environment to decrease the real-time training time. I trained the agents for 3 million time steps at 2.5x speed. If you want to watch the agents train, then you can watch the video below:", "Unity ML-Agents produces many tensorboard graphs to inform us of how the training went, but these two are the most important to us:", "You might have noticed the abnormal learning curve of the reward accumulation. Normally we would expect reward accumulation to keep increasing throughout the training. However, when using curriculum learning, our environment\u2019s reward becomes harder to obtain, so gaining it becomes more difficult. We can still see the individual learning curves of each lesson. Around 600k on lesson 14 is a good example.", "We can measure the success of the agents by the number of lessons they have passed. The first 3 million steps of training got them through the first 37 lessons. Unfortunately, this meant that the agents were still faster than the prey, which somewhat reduced the need for teamwork. So, I trained the agent for a further 3 million timesteps. The agents reach lesson 59, the prey is faster than the hunters, so team behaviour emerged.", "The gifs to the left show the yellow agent moving to make an interception, while the other two hunters pursue.", "You will notice that the agents face in the direction they last applied force. The yellow agent has also, effectively, learnt to break. This would be key in intercepting the prey if it adjusted course.", "I hope that I have shed some light on the power of a learning curriculum. Even though our learning algorithms have improved drastically over the last couple of years, we still can\u2019t expect them to solve everything on their own.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning and Data Science enthusiast!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc8e7a1aa5415&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@adamprice97?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamprice97?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": "Adam Price"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e52daf12ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&user=Adam+Price&userId=9e52daf12ce1&source=post_page-9e52daf12ce1----c8e7a1aa5415---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8e7a1aa5415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8e7a1aa5415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/adamprice97/UnityPursitEvasionGame", "anchor_text": "https://github.com/adamprice97/UnityPursitEvasionGame"}, {"url": "https://github.com/Unity-Technologies/ml-agents/blob/master/docs/Training-Configuration-File.md", "anchor_text": "consult Unity\u2019s documentation."}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----c8e7a1aa5415---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/unity?source=post_page-----c8e7a1aa5415---------------unity-----------------", "anchor_text": "Unity"}, {"url": "https://medium.com/tag/ml-agent?source=post_page-----c8e7a1aa5415---------------ml_agent-----------------", "anchor_text": "Ml Agent"}, {"url": "https://medium.com/tag/curriculum-learning?source=post_page-----c8e7a1aa5415---------------curriculum_learning-----------------", "anchor_text": "Curriculum Learning"}, {"url": "https://medium.com/tag/pursuit?source=post_page-----c8e7a1aa5415---------------pursuit-----------------", "anchor_text": "Pursuit"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc8e7a1aa5415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&user=Adam+Price&userId=9e52daf12ce1&source=-----c8e7a1aa5415---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc8e7a1aa5415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&user=Adam+Price&userId=9e52daf12ce1&source=-----c8e7a1aa5415---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8e7a1aa5415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc8e7a1aa5415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c8e7a1aa5415---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c8e7a1aa5415--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamprice97?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamprice97?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adam Price"}, {"url": "https://medium.com/@adamprice97/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e52daf12ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&user=Adam+Price&userId=9e52daf12ce1&source=post_page-9e52daf12ce1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F53e947916578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcurriculum-learning-with-unity-ml-agents-c8e7a1aa5415&newsletterV3=9e52daf12ce1&newsletterV3Id=53e947916578&user=Adam+Price&userId=9e52daf12ce1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}