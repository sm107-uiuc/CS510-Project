{"url": "https://towardsdatascience.com/sentiment-analysis-with-python-part-2-4f71e7bde59a", "time": 1682994768.983476, "path": "towardsdatascience.com/sentiment-analysis-with-python-part-2-4f71e7bde59a/", "webpage": {"metadata": {"title": "Sentiment Analysis with Python (Part 2) | by Aaron Kub | Towards Data Science", "h1": "Sentiment Analysis with Python (Part 2)", "description": "In part one of this series we built a barebones movie review sentiment classifier. The goal of this next post is to provide an overview of several techniques that can be used to enhance an NLP model\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/aaronkub/machine-learning-examples/tree/master/imdb-sentiment-analysis", "anchor_text": "GitHub Repository", "paragraph_index": 2}, {"url": "https://www.nltk.org/", "anchor_text": "Natural Language Toolkit", "paragraph_index": 4}, {"url": "http://www.nltk.org/howto/stem.html", "anchor_text": "NLTK Stemmers", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "tf-idf statistic", "paragraph_index": 18}], "all_paragraphs": ["In part one of this series we built a barebones movie review sentiment classifier. The goal of this next post is to provide an overview of several techniques that can be used to enhance an NLP model. That being said, we won\u2019t go too far in depth on any particular topic.", "If you haven\u2019t yet, you can read my first post here:", "All of the code used in this series along with supplemental materials can be found in this GitHub Repository.", "For our first iteration we did very basic text processing like removing punctuation and HTML tags and making everything lower-case. We can clean things up further by removing stop words and normalizing the text.", "To make these transformations we\u2019ll use libraries from the Natural Language Toolkit (NLTK). This is a very popular NLP library for Python.", "Stop words are the very common words like \u2018if\u2019, \u2018but\u2019, \u2018we\u2019, \u2018he\u2019, \u2018she\u2019, and \u2018they\u2019. We can usually remove these words without changing the semantics of a text and doing so often (but not always) improves the performance of a model. Removing these stop words becomes a lot more useful when we start using longer word sequences as model features (see n-grams below).", "Note: In practice, an easier way to remove stop words is to just use the stop_words argument with any of scikit-learn\u2019s \u2018Vectorizer\u2019 classes. If you want to use NLTK\u2019s full list of stop words you can do stop_words='english\u2019. In practice I\u2019ve found that using NLTK\u2019s list actually decreases my performance because its too expansive, so I usually supply my own list of words. For example, stop_words=['in','of','at','a','the'] .", "A common next step in text preprocessing is to normalize the words in your corpus by trying to convert all of the different forms of a given word into one. Two methods that exist for this are Stemming and Lemmatization.", "Stemming is considered to be the more crude/brute-force approach to normalization (although this doesn\u2019t necessarily mean that it will perform worse). There\u2019s several algorithms, but in general they all use basic rules to chop off the ends of words.", "NLTK has several stemming algorithm implementations. We\u2019ll use the Porter stemmer here but you can explore all of the options with examples here: NLTK Stemmers", "Lemmatization works by identifying the part-of-speech of a given word and then applying more complex rules to transform the word into its true root.", "Last time we used only single word features in our model, which we call 1-grams or unigrams. We can potentially add more predictive power to our model by adding two or three word sequences (bigrams or trigrams) as well. For example, if a review had the three word sequence \u201cdidn\u2019t love movie\u201d we would only consider these words individually with a unigram-only model and probably not capture that this is actually a negative sentiment because the word \u2018love\u2019 by itself is going to be highly correlated with a positive review.", "The scikit-learn library makes this really easy to play around with. Just use the ngram_range argument with any of the \u2018Vectorizer\u2019 classes.", "Getting pretty close to 90%! So, simply considering 2-word sequences in addition to single words increased our accuracy by more than 1.6 percentage points.", "Note: There\u2019s technically no limit on the size that n can be for your model, but there are several things to consider. First, increasing the number of grams will not necessarily give you better performance. Second, the size of your matrix grows exponentially as you increment n, so if you have a large corpus that is comprised of large documents your model may take a very long time to train.", "In part 1 we represented each review as a binary vector (1s and 0s) with a slot/column for every unique word in our corpus, where 1 represents that a given word was in the review.", "While this simple approach can work very well, there are ways that we can encode more information into the vector.", "Instead of simply noting whether a word appears in the review or not, we can include the number of times a given word appears. This can give our sentiment classifier a lot more predictive power. For example, if a movie reviewer says \u2018amazing\u2019 or \u2018terrible\u2019 multiple times in a review it is considerably more probable that the review is positive or negative, respectively.", "Another common way to represent each document in a corpus is to use the tf-idf statistic (term frequency-inverse document frequency) for each word, which is a weighting factor that we can use in place of binary or word count representations.", "There are several ways to do tf-idf transformation but in a nutshell, tf-idf aims to represent the number of times a given word appears in a document (a movie review in our case) relative to the number of documents in the corpus that the word appears in \u2014 where words that appear in many documents have a value closer to zero and words that appear in less documents have values closer to 1.", "Note: Now that we\u2019ve gone over n-grams, when I refer to \u2018words\u2019 I really mean any n-gram (sequence of words) if the model is using an n greater than one.", "So far we\u2019ve chosen to represent each review as a very sparse vector (lots of zeros!) with a slot for every unique n-gram in the corpus (minus n-grams that appear too often or not often enough). Linear classifiers typically perform better than other algorithms on data that is represented in this way.", "Recall that linear classifiers tend to work well on very sparse datasets (like the one we have). Another algorithm that can produce great results with a quick training time are Support Vector Machines with a linear kernel.", "Here\u2019s an example with an n-gram range from 1 to 2:", "There are many great explanations of Support Vector Machines that do a much better job than I could. If you\u2019re interested in learning more, this is a great tutorial:", "The goal of this post was to give you a toolbox of things to try and mix together when trying to find the right model + data transformation for your project. I found that removing a small set of stop words along with an n-gram range from 1 to 3 and a linear support vector classifier gave me the best results.", "We\u2019ve gone over several options for transforming text that can improve the accuracy of an NLP model. Which combination of these techniques will yield the best results will depend on the task, data representation, and algorithms you choose. It\u2019s always a good idea to try out many different combinations to see what works.", "I\u2019m very confidant a higher accuracy on this data can be attained with a different combination of the things outlined in this post. I\u2019ll leave that for a more ambitious reader. :) Please comment with your results and method!", "The next parts of this series will explore deep learning approaches to building a sentiment classifier.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4f71e7bde59a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aaronkub?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aaronkub?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": "Aaron Kub"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F571f7da0a6de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&user=Aaron+Kub&userId=571f7da0a6de&source=post_page-571f7da0a6de----4f71e7bde59a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f71e7bde59a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f71e7bde59a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/cR05i3WgRlQ?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "izayah ramos"}, {"url": "https://unsplash.com/search/photos/hollywood?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/sentiment-analysis-with-python-part-1-5ce197074184", "anchor_text": "Sentiment Analysis with Python (Part 1)Classifying IMDb Movie Reviewstowardsdatascience.com"}, {"url": "https://github.com/aaronkub/machine-learning-examples/tree/master/imdb-sentiment-analysis", "anchor_text": "GitHub Repository"}, {"url": "https://www.nltk.org/", "anchor_text": "Natural Language Toolkit"}, {"url": "http://www.nltk.org/howto/stem.html", "anchor_text": "NLTK Stemmers"}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "tf-idf statistic"}, {"url": "https://blog.statsbot.co/support-vector-machines-tutorial-c1618e635e93", "anchor_text": "Support Vector Machines TutorialLearning SVMs from examplesblog.statsbot.co"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4f71e7bde59a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----4f71e7bde59a---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/python?source=post_page-----4f71e7bde59a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4f71e7bde59a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----4f71e7bde59a---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4f71e7bde59a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&user=Aaron+Kub&userId=571f7da0a6de&source=-----4f71e7bde59a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4f71e7bde59a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&user=Aaron+Kub&userId=571f7da0a6de&source=-----4f71e7bde59a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f71e7bde59a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4f71e7bde59a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4f71e7bde59a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4f71e7bde59a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aaronkub?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aaronkub?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aaron Kub"}, {"url": "https://medium.com/@aaronkub/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "634 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F571f7da0a6de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&user=Aaron+Kub&userId=571f7da0a6de&source=post_page-571f7da0a6de--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F571f7da0a6de%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-python-part-2-4f71e7bde59a&user=Aaron+Kub&userId=571f7da0a6de&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}