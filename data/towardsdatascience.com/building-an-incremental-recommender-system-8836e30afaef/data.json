{"url": "https://towardsdatascience.com/building-an-incremental-recommender-system-8836e30afaef", "time": 1683003940.413273, "path": "towardsdatascience.com/building-an-incremental-recommender-system-8836e30afaef/", "webpage": {"metadata": {"title": "Building an Incremental Recommender System | by Dimitris Poulopoulos | Towards Data Science", "h1": "Building an Incremental Recommender System", "description": "This story is the first part of a series where we explore how to adapt the idea of incremental learning to recommender systems, with a hands-on approach."}, "outgoing_paragraph_urls": [{"url": "https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter", "anchor_text": "Learning Rate", "paragraph_index": 0}, {"url": "https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://pypi.org/project/cf-step/", "anchor_text": "CF Step", "paragraph_index": 5}, {"url": "https://pypi.org/project/cf-step/", "anchor_text": "CF Step", "paragraph_index": 10}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "Movielens", "paragraph_index": 10}, {"url": "https://clouddb.eu/", "anchor_text": "CloudDBAppliance", "paragraph_index": 10}, {"url": "https://pypi.org/project/cf-step/", "anchor_text": "CF Step", "paragraph_index": 21}, {"url": "https://bigdatastack.eu/", "anchor_text": "BigDataStack", "paragraph_index": 22}, {"url": "https://medium.com/@dpoulopoulos", "anchor_text": "Medium", "paragraph_index": 22}, {"url": "https://www.linkedin.com/in/dpoulopoulos/", "anchor_text": "LinkedIn", "paragraph_index": 22}, {"url": "https://twitter.com/james2pl", "anchor_text": "@james2pl", "paragraph_index": 22}, {"url": "http://www.dimpo.me", "anchor_text": "www.dimpo.me", "paragraph_index": 24}], "all_paragraphs": ["Learning Rate is a newsletter for those who are curious about the world of AI and MLOps. You\u2019ll hear from me every Friday with updates and thoughts on the latest AI news and articles. Subscribe here!", "Part II of this story is now published via Towards Data Science below.", "Although I will try to keep the math jargon to a minimum, this story expects that the reader is familiar with concepts like user-item interaction matrix, matrix factorization, embedding spaces, as well as basic machine learning terminology. This story is not an introduction to recommender systems. It is an introduction to their incremental variant. In any case, the story is addressed to what you might call a beginner in the world of machine learning and recommender systems.", "Starting a machine learning project, data scientists gather data, process them, train a model and deploy it to production. When the model\u2019s performance starts to deteriorate, data scientists usually repeat the cycle from scratch. Only this time, they have new data examples to bring the model up to date and boost its performance. However, this is usually a counter-productive practice as well as an inefficient one, especially for business domains where making decisions on current data is crucial.", "Now, enter the world of recommender systems, where user preferences frequently change according to seasons, budgets, fashion trends and more. Moreover, arriving customers and new inventory create the so-called cold-start problem, where the system does not have enough information to match consumers to products or services. A recommender system should ideally adapt to these changes as they happen, modifying its model to always speak for the current status, while requiring a single pass through the data. This is the idea of incremental learning.", "This story is the first part of a series where we explore how to adapt the idea of incremental learning to recommender systems, with a hands-on approach. In the first part, we reproduce the results presented in the \u201cFast incremental matrix factorization for recommendation with positive-only feedback\u201d publication by Jo\u00e3o Vinagre et al., using a python library built on Pytorch, called CF Step. Next, we will aim higher by applying several tricks.", "The algorithm we are going to implement works with implicit, positive-only feedback. Let us try to demystify these two keywords. Implicit feedback means that users have never expressed a direct opinion on the items they have interacted with, such as a rating. An example of implicit feedback would be something like how many times a customer has bought a product, or how many minutes they have spent watching a movie. The more a customer buys a product or uses a service, the more confident we can be that this is a sign of preference. Positive-only feedback is a term that usually goes together with implicit feedback. This is because, in the case of implicit feedback, we rarely have a clue about what constitutes a negative interaction. A user not interacting with an item does not mean much. Image the case of a consumer in a supermarket. If a customer has not bought a specific product yet, we cannot be sure why.", "Returning to our implementation, positive-only means that the user-item interaction matrix R contains only Boolean values, where true values indicate preference and false values are treated as missing. This assumption has two main implications; the sparsity of R is maintained, as only positive feedback is used during training, and false values, for any user-item interaction, are perfectly valid recommendation candidates.", "Let us now take a closer look at the Incremental Stochastic Gradient Descent (ISGD) algorithm presented in the paper.", "The data we have are tuples or user-item interactions. Remember that these are all positive interactions. The input to the algorithm are three numbers; feat, which is the dimensions of the user or item embedding space, \u03bb, which is the regularization coefficient, and \u03b7, the learning rate. The output of the algorithm is the two embedding matrices: A for users and B for items. The dimensions of these matrices are number_of_users x feat for A and number_of_items x feat for B. Then we have several distinct steps:", "For this implementation, we will use the CF Step Python library and the well-know Movielens dataset. CF Step is an open-source library, written in python and build on Pytorch, that enables fast implementation of incremental learning recommender systems. The library is a by-product of the European research project CloudDBAppliance. You can easily install the library by running the command below:", "Next, download the movielens 1m dataset and extract the ratings.dat file in a convenient location, for example, the tmp folder in Linux. For this implementation, we only need this file. The rest of the files (users.dat and movies.dat) contain metadata on users and movies. We will use pandas to load the files in memory:", "As you can see, we transform the user and movie IDs to categories so we can extract the category code. Now, we do not have to create separate vocabularies for the embedding matrix generation. We only have to work with the user and movie codes instead of IDs. Finally, we always have a connection between codes and IDs through this dataframe to find the original user and movie. Now, let us see the number of unique users and movies we are working with.", "If we print those numbers, we will see that we are working with 6040 unique users and 3706 unique movies. Next, we will sort the data by timestamp to simulate streaming events.", "As we have discussed, the algorithm supports only positive feedback. Thus, we will consider a rating of 5 as positive feedback and discard any other. We want to identify likes with 1 and dislikes with 0 and create a new column called preference to keep them. Then, we can filter only for preference == 1.", "Following, let us initialize our model. For this, we need a model architecture, an objective function (i.e. loss function) and an optimizer. We will use the SimpleCF network for the model architecture, a built-in neural network architecture offered by CF Step. For the objective function, we will use a simple lambda function that takes a prediction and a target and subtracts the prediction from the target. In our case, the target is always 1. For the optimizer, we will use Pytorch\u2019s SGD implementation. The number of factors we choose is 128 and the learning rate is 0.06. Now we are ready to initialize the Step model.", "The evaluation methodology is as follows:", "To this end, let us take the first 20% of the data, create the data loaders and batch fit the model.", "Then, we get the remaining data and create a different data set.", "Finally, simulate the stream and evaluate the model using recall@10. This step takes five to six minutes on a GPU.", "We can visualize the results of our training using the code below. For this, we will use a moving average of a 5k sliding window, like they do in the publication. We can see that the plot follows the results presented in the paper for the movielens dataset. To save the model, use the model.save() built-in method and pass a valid path.", "In this story, we presented the importance of incremental learning in recommender systems and reproduced the results of the \u201cFast incremental matrix factorization for recommendation with positive-only feedback\u201d publication by Jo\u00e3o Vinagre et al. We introduced the CF Step python library, an open-source library, that enables fast implementation of incremental learning recommender systems. On the next chapter, we will take this a bit further and try to increase the accuracy of the algorithm.", "My name is Dimitris Poulopoulos and I\u2019m a machine learning researcher at BigDataStack and PhD(c) at the University of Piraeus, Greece. I have worked on designing and implementing AI and software solutions for major clients such as the European Commission, Eurostat, IMF, the European Central Bank, OECD, and IKEA. If you are interested in reading more posts about Machine Learning, Deep Learning and Data Science, follow me on Medium, LinkedIn or @james2pl on twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer. I talk about AI, MLOps, and Python programming. More about me: www.dimpo.me"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8836e30afaef&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8836e30afaef--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8836e30afaef--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dpoulopoulos.medium.com/?source=post_page-----8836e30afaef--------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=post_page-----8836e30afaef--------------------------------", "anchor_text": "Dimitris Poulopoulos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cc87df5b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=post_page-7cc87df5b1----8836e30afaef---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8836e30afaef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8836e30afaef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nathaliarosa?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Nath\u00e1lia Rosa"}, {"url": "https://unsplash.com/s/photos/products?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter", "anchor_text": "Learning Rate"}, {"url": "https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/building-an-incremental-recommender-system-part-ii-2d0e782b2cf6", "anchor_text": "Building an Incremental Recommender System: Part IIGoing above and beyond state-of-the-art with confidence!towardsdatascience.com"}, {"url": "https://pypi.org/project/cf-step/", "anchor_text": "CF Step"}, {"url": "https://pypi.org/project/cf-step/", "anchor_text": "CF Step"}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "Movielens"}, {"url": "https://clouddb.eu/", "anchor_text": "CloudDBAppliance"}, {"url": "https://pypi.org/project/cf-step/", "anchor_text": "CF Step"}, {"url": "https://bigdatastack.eu/", "anchor_text": "BigDataStack"}, {"url": "https://medium.com/@dpoulopoulos", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/dpoulopoulos/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/james2pl", "anchor_text": "@james2pl"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8836e30afaef---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recommender-systems?source=post_page-----8836e30afaef---------------recommender_systems-----------------", "anchor_text": "Recommender Systems"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----8836e30afaef---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----8836e30afaef---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----8836e30afaef---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8836e30afaef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=-----8836e30afaef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8836e30afaef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=-----8836e30afaef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8836e30afaef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8836e30afaef--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8836e30afaef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8836e30afaef---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8836e30afaef--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8836e30afaef--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8836e30afaef--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8836e30afaef--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8836e30afaef--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8836e30afaef--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8836e30afaef--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8836e30afaef--------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dimitris Poulopoulos"}, {"url": "https://dpoulopoulos.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12.5K Followers"}, {"url": "http://www.dimpo.me", "anchor_text": "www.dimpo.me"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cc87df5b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=post_page-7cc87df5b1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb5ab149102ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-incremental-recommender-system-8836e30afaef&newsletterV3=7cc87df5b1&newsletterV3Id=b5ab149102ea&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}