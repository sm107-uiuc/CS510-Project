{"url": "https://towardsdatascience.com/making-art-with-your-webcam-ac6d0f5504f4", "time": 1682995551.758507, "path": "towardsdatascience.com/making-art-with-your-webcam-ac6d0f5504f4/", "webpage": {"metadata": {"title": "Making Art With A Webcam. An implementation and explanation of\u2026 | by Aryan Misra | Towards Data Science", "h1": "Making Art With A Webcam", "description": "For thousands of years, a really important characteristic of human culture was our art. There are no other species that could create something even somewhat resembling the paintings of Leo da Vinci\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/classifying-skin-lesions-with-convolutional-neural-networks-fc1302c60d54", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/residual-blocks-building-blocks-of-resnet-fd90ca15d6ec", "anchor_text": "residual blocks", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/types-of-convolutions-in-deep-learning-717013397f4d", "anchor_text": "strided convolutions", "paragraph_index": 10}, {"url": "http://cocodataset.org/", "anchor_text": "Microsoft\u2019s COCO dataset", "paragraph_index": 11}, {"url": "https://arxiv.org/pdf/1603.08155.pdf", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://aryanmisra.com/styletransfer", "anchor_text": "website", "paragraph_index": 14}, {"url": "https://github.com/aryanmisra/faststyletransfer", "anchor_text": "Github repo", "paragraph_index": 14}, {"url": "https://ml5js.org/docs/StyleTransfer", "anchor_text": "ML5JS\u2019s style transfer documentation", "paragraph_index": 14}, {"url": "https://github.com/reiinakano/fast-style-transfer-deeplearnjs", "anchor_text": "deeplearnjs", "paragraph_index": 14}, {"url": "https://github.com/NVIDIA/FastPhotoStyle", "anchor_text": "here", "paragraph_index": 15}], "all_paragraphs": ["For thousands of years, a really important characteristic of human culture was our art. There are no other species that could create something even somewhat resembling the paintings of Leo da Vinci or Van Gogh. Even many people have trouble at creating art of this quality. This is until recently, with the introduction of Neural style transfer, we are able to take the style of an image, and then apply it to the content of another image. This gives computers the ability to create images like the one above, a picture of Stanford University\u2019s Hoover Tower, stylized with Starry Night, by Van Gogh. In this article, I\u2019m gonna talk about neural style transfer, and then about fast style transfer.", "In the field of Computer Vision, convolutional neural networks are used all the time for applications ranging from self-driving cars to medical diagnosis. If you want to learn more about how they work, check out my article on how I built a Skin Lesion Classification tool, here. Once you\u2019ve read that, you know that CNN's are comprised of convolutional layers (detecting patterns and objects in images) and at the end, fully-connected layers (predictions). What we\u2019re really looking for here is the information that is captured through the convolutional layers.", "In a pre-trained CNN such as the VGG19 network, the first 16 layers are convolutional layers, capturing features.", "The last couple layers (FC1, FC2, softmax) are just used for returning probabilities for different objects existing in the image. We don't actually need these layers for style transfer since we aren't going to be classifying images. Layers near the start of the network can learn really low-level features such as edges and corners. Moving up in the network, we get to features such as shapes until we finally hit the high-level features which are entire objects such as, the face of a person or the shape of an animal.", "Our objective here is to transfer the style of a certain image, as well as the content of a certain image, to a new image stylized image. To achieve this dual optimization, we need to calculate loss twice. Once for the style, once for the content.", "The content loss is calculated by measuring the similarity(Euclidean distance) of the CNN\u2019s output image to the ground truth image, which is the target it\u2019s trying to reach. Since feature maps in a CNN are just a whole bunch of numbers, they can be represented in a high-dimensional vector space. What this means is that it\u2019s quite simple to calculate the distance between the network\u2019s output vector from the ground truth vector. We can retrieve this feature map from a pre-trained network such as the VGG16 network. Depending on which part of the network we get our feature maps from, the output image will look different. If we choose a layer that's really deep in the network, chances are, we\u2019re gonna get an output image that looks more abstract than if we take a layer near the start.", "The style loss relies on a mathematical object called a Gram matrix. The Gram matrix is a matrix of all every possible inner product of a vector, and it\u2019s really good at capturing non-localized information. So it takes all the information from a feature map in a layer and gets rid of where that information is spatially located in an image. Basically, this is used to extract the style of an image. Then, style loss is calculated by measuring the similarity, once again, between the gram matrix of the output image, to the style target.", "We can change the weightings for style and content reconstruction to get images that look stylistically different.", "Great, now we have a method of doing style transfer, but the problem of speed still remains an issue. This is due to the architecture of the model, and reducing loss is a slow and iterative process that can\u2019t be applied in real-time. In Johnson et al\u2019s paper proposed a really clever solution to this problem. Instead of getting an image and optimizing it to be stylized, they created a neural network that would directly output a stylized image. This flow is different in a couple of ways. Instead of inputting two images (content, style) and getting an iterative output of a stylized image, with fast style transfer, you input an image an get a quick output in a predetermined style, based upon what the network was trained on. Of course, this means you still have to train a network, but only once for every style, you want to use. The structure of this network is presented in the following diagram.", "Here we calculate the content loss between the generated image and the stylized image, from a specific layer(3). Then we calculate the style loss from every feature map. Then we combine these two losses to create a global loss. We can now train this network using gradient descent to minimize this global loss. Its a pretty simple process but you get some really amazing pieces of art from it! It also speeds up the image production process by up to 1000x while producing really similar qualitative results as standard neural style transfer. You may have noticed that there are two parts to this network, the image transformation network, and a loss network.", "This is a simple CNN with residual blocks and strided convolutions that are used for in-network downsampling and upsampling. This results in an output that is the same size as the input. This network is trained with a feature reconstruction perceptual loss, rather than a per-pixel loss. Wait\u2026 what is perceptual loss? Compared to the more traditional, per-pixel loss, it is based on differences between high-level image feature representations that are extracted from pre-trained networks, as opposed to differences in individuals pixels in the image. There are two problems with per-pixel losses when we try to reconstruct images, they are really slow, and even though a picture might be visually very similar to the ground truth, they could be mathematically far off. This results in lots of wasted resources on trying to fix these invisible changes.", "This is just a loss network that has had its weights frozen. I explained this previously. This network is based on the VGG16 loss network, trained on Microsoft\u2019s COCO dataset, a collection of thousands of common objects in everyday life.", "If you want to get down to the nitty-gritty of how all this work, you should read the original research paper that this idea was proposed in, here.", "This new network lets us stylize, real-time.", "You can play around with this on your webcam on my website. The code for the whole thing is available on my Github repo and was made using ML5JS\u2019s style transfer documentation, and is also based off of deeplearnjs.", "Another really cool demonstration of this is NVIDIA\u2019s Fast Photo Style algorithm, which creates photo-realistic images, that are stylized. You can check out the source code for it, here.", "While this technology works pretty well already, there are still some shortcomings in what we can do with it. There's still no algorithm that takes in two input images and performs style transfer on them. Technology like this could lead to some insane developments in the AR tech space, and could be a valuable tool for artists!", "If you enjoyed my article or learned something new, make sure to:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac6d0f5504f4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aryanmisra?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aryanmisra?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": "Aryan Misra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbd6ad9886982&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&user=Aryan+Misra&userId=bd6ad9886982&source=post_page-bd6ad9886982----ac6d0f5504f4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac6d0f5504f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac6d0f5504f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/classifying-skin-lesions-with-convolutional-neural-networks-fc1302c60d54", "anchor_text": "here"}, {"url": "https://www.researchgate.net/figure/llustration-of-the-network-architecture-of-VGG-19-model-conv-means-convolution-FC-means_fig2_325137356", "anchor_text": "Source"}, {"url": "https://dzone.com/articles/deep-learning-vs-machine-learning-the-hottest-topi", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/residual-blocks-building-blocks-of-resnet-fd90ca15d6ec", "anchor_text": "residual blocks"}, {"url": "https://towardsdatascience.com/types-of-convolutions-in-deep-learning-717013397f4d", "anchor_text": "strided convolutions"}, {"url": "http://cocodataset.org/", "anchor_text": "Microsoft\u2019s COCO dataset"}, {"url": "https://arxiv.org/pdf/1603.08155.pdf", "anchor_text": "here"}, {"url": "https://aryanmisra.com/styletransfer", "anchor_text": "website"}, {"url": "https://github.com/aryanmisra/faststyletransfer", "anchor_text": "Github repo"}, {"url": "https://ml5js.org/docs/StyleTransfer", "anchor_text": "ML5JS\u2019s style transfer documentation"}, {"url": "https://github.com/reiinakano/fast-style-transfer-deeplearnjs", "anchor_text": "deeplearnjs"}, {"url": "https://github.com/NVIDIA/FastPhotoStyle", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/aryan-misra/", "anchor_text": "LinkedIn"}, {"url": "https://arxiv.org/pdf/1508.06576.pdf", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1603.08155.pdf", "anchor_text": "here"}, {"url": "https://aryanmisra.com/styletransfer/", "anchor_text": "website"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac6d0f5504f4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ac6d0f5504f4---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ac6d0f5504f4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac6d0f5504f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&user=Aryan+Misra&userId=bd6ad9886982&source=-----ac6d0f5504f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac6d0f5504f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&user=Aryan+Misra&userId=bd6ad9886982&source=-----ac6d0f5504f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac6d0f5504f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac6d0f5504f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac6d0f5504f4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac6d0f5504f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aryanmisra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aryanmisra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aryan Misra"}, {"url": "https://medium.com/@aryanmisra/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "299 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbd6ad9886982&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&user=Aryan+Misra&userId=bd6ad9886982&source=post_page-bd6ad9886982--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6a6ad2ab44bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-art-with-your-webcam-ac6d0f5504f4&newsletterV3=bd6ad9886982&newsletterV3Id=6a6ad2ab44bc&user=Aryan+Misra&userId=bd6ad9886982&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}