{"url": "https://towardsdatascience.com/back-propagation-the-easy-way-part-2-bea37046c897", "time": 1682994713.441788, "path": "towardsdatascience.com/back-propagation-the-easy-way-part-2-bea37046c897/", "webpage": {"metadata": {"title": "Back Propagation, the Easy Way (Part 2) | by Ziad SALLOUM | Towards Data Science", "h1": "Back Propagation, the Easy Way (Part 2)", "description": "Update: The best way of learning and practicing Reinforcement Learning is by going to http://rl-lab.com In the first part we have seen how back propagation is derived in a way to minimize the cost\u2026"}, "outgoing_paragraph_urls": [{"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/back-propagation-the-easy-way-part-1-6a8cde653f65", "anchor_text": "first part", "paragraph_index": 1}, {"url": "https://gist.github.com/ZSalloum/54703842f8a06e38fd76934579a6c814", "anchor_text": "here", "paragraph_index": 23}, {"url": "https://towardsdatascience.com/back-propagation-the-easy-way-part-1-6a8cde653f65", "anchor_text": "Simple detailed explanation of the back propagation", "paragraph_index": 25}, {"url": "https://medium.com/@zsalloum/back-propagation-the-easy-way-part-3-cc1de33e8397", "anchor_text": "How to handle dimensions of matrices", "paragraph_index": 25}], "all_paragraphs": ["Update: The best way of learning and practicing Reinforcement Learning is by going to http://rl-lab.com", "In the first part we have seen how back propagation is derived in a way to minimize the cost function. In this article we will see the implementation aspect, and some best practices to avoid common pitfalls.", "We are still in the simple mode, where input is handled one at a time.", "Consider a fully connected neural network such as in the figure below.", "Each layer will be modelled by a Layer object containing the weights, the activation values (output of the layer), the gradient dZ (not represented in the image), the cumulative error delta (\ud835\udeab), as well as the activation function f(x) and its derivative f\u2019(x). The reason for storing intermediate is to avoid computing them each time they are needed.", "Advice: It is better to organize the code around few classes, and avoid cramming everything into arrays, as it is very easy to get lost.", "Note that the input layer won\u2019t be represented by a Layer object since it consists only of a vector.", "The constructor of the Layer class, takes as parameters:", "It initializes the weights randomly to numbers between -1 and +1, and set the different variables to be used inside the object.", "The layer object has three methods:", "The forward function, computes and returns the output of the Layer, by taking the input x and computes and stores the output A = activation (W.X). It also computes and stores dZ which the derivative of the output relative to the input.", "The backward functions takes two parameters, the target y and rightLayer which is the layer (\ud835\udcc1-1) assuming that the current one is \ud835\udcc1.", "It computes the cumulative error delta that is propagating from the output going leftward to the beginning of the network.", "IMPORTANT: a common mistake, is to think that the backward propagation is some kind of loopback in which the output is injected again in the network. So instead of using dZ = self.activation_prime(z); some uses self.activation_prime(A). This is wrong, simply because what we are trying to do is figure out how the output A would vary relative to input z. This means computing the derivative \u2202a/\u2202z = \u2202g(z)/\u2202z = g\u2019(z) according to the chain rule.This error might be due to the fact that in the case of sigmoid activation function a = \ud835\udf0e(z), the derivative \ud835\udf0e\u2019(z) = \ud835\udf0e(z)*(1-\ud835\udf0e(z)) = a*(1-a). Which gives the illusion that the output is injected into to the network, while the truth is that we are computing \ud835\udf0e\u2019(z).", "What the backward function does is to compute and return the delta, based on the formula:", "Finally the update function uses the gradient descent to update the weights of the current layer.", "As one might guess layers form a network, so the class NeuralNetwork is used to organize and coordinate the layers.It\u2019s constructor takes the configuration of the layers that is an array which length determines the number of layers in the network and each element defines the number of nodes in the corresponding layer. For example [2, 4, 5, ] means that the network has 4 layers with the input layer having 2 nodes, the next hidden layers have 4 and 5 nodes respectively and the output layer has 1 node. The second parameter is the type of activation function to use for all layers.", "The fit function is where all the training happens. It starts by selecting one input sample, computes the forward over all the layers, then computes the error between the output of the network and the target value and propagate this error to the network by calling backward function of each layer in reverse order, starting by the last one up to the first.Finally, the update function is called for each layer to update the weights.", "These steps are repeated a number of times determined by the parameter epoch.", "After the training is complete, the predict function can be called to test input. The predict function is simply a feed forward of all the network.", "To run the network we take as example the approximation of the Xor function.", "We try the several network configurations, using different learning rates and epoch iterations. Results are liste below:", "It is advisable that you try different configurations and see for yourself which one gives the best and most stable results.", "The full code can be downloaded here.", "Back propagation can be confusing and tricky to implement. You might have the illusion that you get a grasp of it through the theory, but the truth is that when implementing it, it is easy to fall into many traps. You should be patient and persistent, as back propagation is a corner stone of Neural Networks.", "Part 1: Simple detailed explanation of the back propagationPart 3: How to handle dimensions of matrices", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbea37046c897&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bea37046c897--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bea37046c897--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zsalloum.medium.com/?source=post_page-----bea37046c897--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=post_page-----bea37046c897--------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2----bea37046c897---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbea37046c897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbea37046c897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com"}, {"url": "https://towardsdatascience.com/back-propagation-the-easy-way-part-1-6a8cde653f65", "anchor_text": "first part"}, {"url": "https://gist.github.com/ZSalloum/54703842f8a06e38fd76934579a6c814", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/back-propagation-the-easy-way-part-1-6a8cde653f65", "anchor_text": "Simple detailed explanation of the back propagation"}, {"url": "https://medium.com/@zsalloum/back-propagation-the-easy-way-part-3-cc1de33e8397", "anchor_text": "How to handle dimensions of matrices"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bea37046c897---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/backpropagation?source=post_page-----bea37046c897---------------backpropagation-----------------", "anchor_text": "Backpropagation"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----bea37046c897---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----bea37046c897---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/gradient-descent?source=post_page-----bea37046c897---------------gradient_descent-----------------", "anchor_text": "Gradient Descent"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbea37046c897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----bea37046c897---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbea37046c897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----bea37046c897---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbea37046c897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bea37046c897--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbea37046c897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bea37046c897---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bea37046c897--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bea37046c897--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bea37046c897--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bea37046c897--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bea37046c897--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bea37046c897--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bea37046c897--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bea37046c897--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://zsalloum.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "845 Followers"}, {"url": "https://rl-lab.com", "anchor_text": "https://rl-lab.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F408fc441c93b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fback-propagation-the-easy-way-part-2-bea37046c897&newsletterV3=1f2b933522e2&newsletterV3Id=408fc441c93b&user=Ziad+SALLOUM&userId=1f2b933522e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}