{"url": "https://towardsdatascience.com/pandas-groupby-vs-sql-group-by-39ccd7d2b779", "time": 1683015808.611802, "path": "towardsdatascience.com/pandas-groupby-vs-sql-group-by-39ccd7d2b779/", "webpage": {"metadata": {"title": "Pandas Groupby vs SQL Group By | Towards Data Science", "h1": "Pandas Groupby vs SQL Group By", "description": "Grouping is highly important in exploring a dataset. I explained how you can do the same operations using Pandas Groupby or SQL Group By."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/shubh0799/churn-modelling", "anchor_text": "customer churn dataset", "paragraph_index": 4}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 32}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 32}], "all_paragraphs": ["Pandas is a data analysis and manipulation library for Python. SQL is a programming language that is used by most relational database management systems (RDBMS) to manage a database. What they have in common is that both Pandas and SQL operate on tabular data (i.e. tables consist of rows and columns).", "Although having different syntax, similar operations or queries can be done using Pandas or SQL. One of the most common operations in a typical data analysis process is to compare categories based on numerical features. Both are highly efficient in performing such tasks.", "In this post, we will do many examples to master how these operations are done with the groupby function of Pandas and the GROUP BY statement of SQL.", "The following figure illustrates the logic behind a \u201cgroupby\u201d operation.", "We will use the customer churn dataset that is available on Kaggle. For Pandas, the dataset is stored in the \u201cchurn\u201d dataframe. For SQL, the data is in the \u201cCHURN\u201d table.", "Here is a snapshot of the dataset.", "There are some features that provide information about customers and their bank accounts. The \u201cexited\u201d column indicates whether a customer churns (i.e. leaves the bank).", "I will define some measures that help us explore the dataset and use both Pandas and SQL to calculate them.", "It will help us understand if there is a difference in the churn rate based on the country. Grouping the exited column by the geography column and taking the mean will give us the result.", "The main difference is where we apply the aggregate function. SQL allows applying the function directly when selecting the column whereas it is applied after the groupby function with Pandas.", "Both SQL and Pandas allow grouping based on multiple columns which may provide more insight. For instance, we may want to check how gender affects customer churn in different countries.", "We will group the average churn rate by gender first, and then country.", "I\u2019ve added the ORDER BY clause to match the order returned by Pandas and also make it look more structured.", "For both Pandas and SQL, the order of the columns in grouping matters for the structure of the resulting frames. The values will not change.", "Both Pandas and SQL provide ways to apply different aggregate functions to different columns. For instance, we may want to check the average balance and the total number of churned customers in each country.", "We pass a dictionary to the agg (aggregate) function that specifies which function is applied to which column.", "It is simple with SQL since it allows us to specify the function when selecting the columns.", "We can apply multiple aggregate functions on the same numerical column. It is recommended to check both averages and counts if there is an imbalance between categories. Only checking the average might be misleading in such cases.", "Let\u2019s check the relation between the number of products and customer churn. We will calculate both the average churn rate and the total number of churned customers.", "Since there is only one numerical column, we don\u2019t have to pass a dictionary to the agg function. We will just use a list of functions.", "It\u2019d be misleading just to check the averages because the number of customers with more than 2 products is much less than that of customers who have 1 or 2 products.", "The goal of grouping is to find the categories with high or low values in terms of the calculated numerical columns. Thus, sorting is an important part of the grouping operation.", "Both SQL and Pandas are flexible in sorting. We can sort based on any calculated value and in any order.", "Consider the previous query where we checked customer churn based on the number of products.", "The sort_values function can be used. We normally just pass the name of the column whose values are to be used in sorting. However, if multiple aggregate functions are used, we need to pass a tuple indicating the index of the column.", "The following code will sort the results based on the mean churn rate (Exited, mean).", "We just need to add an ORDER BY clause at the end.", "Both Pandas and SQL sort values in ascending order by default. In order to sort in descending order, just modify the code as follows:", "As we have seen in the examples, the logic behind grouping with Pandas and SQL are pretty similar. Once you are familiar with one of them, learning the other one will be quite easy. It just becomes a syntax issue.", "If you are working or plan to work in the field of data science, I strongly recommend you to learn both Pandas and SQL.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F39ccd7d2b779&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----39ccd7d2b779---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39ccd7d2b779&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39ccd7d2b779&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markusspiske?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Markus Spiske"}, {"url": "https://unsplash.com/s/photos/different-colors?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/shubh0799/churn-modelling", "anchor_text": "customer churn dataset"}, {"url": "https://medium.com/tag/data-science?source=post_page-----39ccd7d2b779---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----39ccd7d2b779---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----39ccd7d2b779---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----39ccd7d2b779---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/sql?source=post_page-----39ccd7d2b779---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F39ccd7d2b779&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----39ccd7d2b779---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F39ccd7d2b779&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----39ccd7d2b779---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39ccd7d2b779&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F39ccd7d2b779&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----39ccd7d2b779---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----39ccd7d2b779--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-groupby-vs-sql-group-by-39ccd7d2b779&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}