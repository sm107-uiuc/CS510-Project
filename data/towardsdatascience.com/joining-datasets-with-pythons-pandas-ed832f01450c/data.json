{"url": "https://towardsdatascience.com/joining-datasets-with-pythons-pandas-ed832f01450c", "time": 1683015706.389399, "path": "towardsdatascience.com/joining-datasets-with-pythons-pandas-ed832f01450c/", "webpage": {"metadata": {"title": "Joining Datasets with Python\u2019s Pandas | by Thiago Carvalho | Towards Data Science", "h1": "Joining Datasets with Python\u2019s Pandas", "description": "It\u2019s definitely not uncommon to work with more than one dataset when performing your analysis. Therefore, there\u2019s an abundant amount of methods to bring this data together. SQL call those operations\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html", "anchor_text": "Pandas", "paragraph_index": 2}, {"url": "https://jupyterlab.readthedocs.io/en/stable/getting_started/installation.html", "anchor_text": "Jupyter notebook", "paragraph_index": 3}, {"url": "https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html", "anchor_text": "Pandas", "paragraph_index": 3}, {"url": "https://medium.com/python-in-plain-english/reading-data-with-pythons-pandas-2715ff925b1d", "anchor_text": "load a dataset", "paragraph_index": 4}, {"url": "https://www.oreilly.com/library/view/python-for-data/9781449323592/", "anchor_text": "Python for Data Analysis \u2014 Wes McKinney", "paragraph_index": 50}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html", "anchor_text": "Pandas \u2014 Concat", "paragraph_index": 50}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "Pandas \u2014 Merge", "paragraph_index": 50}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html", "anchor_text": "Pandas \u2014 Append", "paragraph_index": 50}, {"url": "https://pandas.pydata.org/docs/user_guide/merging.html", "anchor_text": "Pandas \u2014 Merge, join, concatenate and compare", "paragraph_index": 50}], "all_paragraphs": ["It\u2019s definitely not uncommon to work with more than one dataset when performing your analysis. Therefore, there\u2019s an abundant amount of methods to bring this data together.", "SQL call those operations \u2018Joins\u2019 or \u2018Unions\u2019; in other languages and tools, you may find functions like Merge or LookUp to do the job.", "In this article, I\u2019ll go through some of the functions we can use to join datasets with Pandas.", "I\u2019ll run my code in a Jupyter notebook, and the only thing we need for the examples is Pandas.", "We\u2019ll start by defining some dummy data for the examples, I\u2019ll use lists for simplification, but you\u2019re definitely encouraged to load a dataset.", "After defining the lists, we can create our data frames.", "Ok, we have three datasets with the same columns and size. Let\u2019s say we want to group those in a single data frame.", "For that, we can use .concat, which is a function that accepts a list of data frames and concatenates them into one.", "Cool, Pandas matched the columns and returned an almost perfect data frame without much effort.", "But what if the column names don\u2019t match? or what if we\u2019re missing a column?", "For the \u2018species\u2019 column, I changed its name in the first df and removed it from the last; I\u2019ve also renamed \u2018age\u2019 to \u2018age \u2014 years\u2019.", "Ok, so Pandas .concat requires the names of the columns to be exact matches. If a column is unique to a dataset, just like a full join, it\u2019ll fill the gaps with null values.", "There\u2019s one more thing we need to pay attention to, the indexes.", "Since we didn\u2019t define unique indexes when creating our data frame, Pandas set us with some default values starting from zero, but it doesn't reset them when we use .concat.", "A unique index is always a good idea. In this case, we can use .reset_index to create a new column with proper values or use .set_index to define one of the columns as the index.", "But let\u2019s try an even simpler solution that fits our case.", "With a single parameter, we ignored the indexes and got new ones in the concatenated result.", "Another handy parameter is \u2018keys\u2019, which allows us to identify the data source with a new index level.", "By default, .concat uses the columns as keys and append the values as rows. But what if we want to concatenate columns to our data frame?", "First, let\u2019s define some new columns to concatenate.", "Similarly, we could add the lists directly to our data frame by assigning them to a column, like so:", "But a data frame could have lots of fields, and passing them one by one wouldn\u2019t be the best option.", "The concatenate function accepts a parameter for \u2018axis\u2019, which allows us to do just that \u2014 concatenate columns.", "We can also change the behaviour of the join.", "Let\u2019s try making the \u2018name\u2019 column our index and creating another dataset with an extra column to experiment with.", "Note that our first data frame has fewer values than the second. When we perform an inner join, it should only bring the rows where the indexes match.", "Now let\u2019s have a look at another function called .append.", "This function has similar behaviour to .concat. The previous take multiple data frames and concatenates them into a new one. The append method will use an existing data frame to add the data.", "Both will return a data frame, but the way you call them is different. You\u2019ll use Pandas.concat() and DataFrame.append().", "Awesome, with .concat and .append, we can perform most of the joins we might need. Now let\u2019s check a more robust solution named .merge.", "Starting with something simple, let\u2019s see how .merge performs a join.", "I\u2019ll define another data frame similar to the one we\u2019re already using, but with one more column and one less record.", "Merge allows us to select which column will be the key; in this case, let\u2019s use \u2018name\u2019.", "Unlike what we saw earlier, a merge is by default an inner join \u2014 That means unless told otherwise, it\u2019ll only return the matching rows from both datasets.", "We can also notice that the columns present in both datasets are separated, even though they contain the same values.", "Lastly, when we perform an inner join like the above, both data frames must have the key column with the same name.", "You can select multiple columns as key, like a composite key, and you can also select which kind of join you\u2019ll use.", "Great! Besides all that, the merge function also helps us to validate and understand the data were merging.", "For example, the validate parameter will raise an error if the data frames don\u2019t respect the criteria you chose.", "The \u2018indicator\u2019 parameter adds a column to the data frame explaining the keys' relationship.", "*If you pass a string to the indicator parameter, it\u2019ll be used as the created column's name.", "We don\u2019t need to specify which column contains the key since, by default, Pandas will assume the index is the key.", "Let\u2019s try setting the name as our index and merging those data frames again.", "If we don\u2019t want Pandas to reset the index, we have to use the right_index and left_index parameters.", "If we want to merge with an index on one side and with a key on the other, we can specify the right_on and left_on parameters.", "They accept the column's name holding the key, just like we saw before, but will be applied only to that specific side, using the index column on the other side.", "Great! We got a look at .concat and .append, two convenient functions for joining two data frames. Then we explored .merge, an even better option with lots of flexibility.", "Pandas have even more methods to help you work with multiple datasets; it\u2019s not unusual to spend time building the logic to solve your problem and then finding out an already implemented solution for that in a library.", "So I encourage you to get a look at some of those other functions such as .compare, .combine_first, and .merge_asof.", "Thanks for reading my article. I hope you enjoyed it!", "References:Python for Data Analysis \u2014 Wes McKinney;Pandas \u2014 Concat;Pandas \u2014 Merge;Pandas \u2014 Append;Pandas \u2014 Merge, join, concatenate and compare;", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fed832f01450c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed832f01450c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed832f01450c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://thiago-bernardes-carvalho.medium.com/?source=post_page-----ed832f01450c--------------------------------", "anchor_text": ""}, {"url": "https://thiago-bernardes-carvalho.medium.com/?source=post_page-----ed832f01450c--------------------------------", "anchor_text": "Thiago Carvalho"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7af498f86142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&user=Thiago+Carvalho&userId=7af498f86142&source=post_page-7af498f86142----ed832f01450c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed832f01450c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed832f01450c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/panda-family-pandas-cute-bamboo-3811734/", "anchor_text": "Nick115"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html", "anchor_text": "Pandas"}, {"url": "https://jupyterlab.readthedocs.io/en/stable/getting_started/installation.html", "anchor_text": "Jupyter notebook"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html", "anchor_text": "Pandas"}, {"url": "https://medium.com/python-in-plain-english/reading-data-with-pythons-pandas-2715ff925b1d", "anchor_text": "load a dataset"}, {"url": "https://pixabay.com/photos/panda-cub-wildlife-zoo-cute-china-649938/", "anchor_text": "Skeeze"}, {"url": "https://pixabay.com/photos/columns-hallway-architecture-greek-801715/", "anchor_text": "Free-Photos"}, {"url": "https://pixabay.com/photos/key-close-up-open-door-key-3497145/", "anchor_text": "cocoparisienne"}, {"url": "https://pixabay.com/photos/panda-cub-wildlife-zoo-cute-china-1203101/", "anchor_text": "PredragKezic"}, {"url": "https://www.oreilly.com/library/view/python-for-data/9781449323592/", "anchor_text": "Python for Data Analysis \u2014 Wes McKinney"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html", "anchor_text": "Pandas \u2014 Concat"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "Pandas \u2014 Merge"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html", "anchor_text": "Pandas \u2014 Append"}, {"url": "https://pandas.pydata.org/docs/user_guide/merging.html", "anchor_text": "Pandas \u2014 Merge, join, concatenate and compare"}, {"url": "https://medium.com/tag/python?source=post_page-----ed832f01450c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----ed832f01450c---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-wrangling?source=post_page-----ed832f01450c---------------data_wrangling-----------------", "anchor_text": "Data Wrangling"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ed832f01450c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----ed832f01450c---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed832f01450c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&user=Thiago+Carvalho&userId=7af498f86142&source=-----ed832f01450c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed832f01450c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&user=Thiago+Carvalho&userId=7af498f86142&source=-----ed832f01450c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed832f01450c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed832f01450c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fed832f01450c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ed832f01450c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed832f01450c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ed832f01450c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ed832f01450c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ed832f01450c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ed832f01450c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ed832f01450c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ed832f01450c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ed832f01450c--------------------------------", "anchor_text": ""}, {"url": "https://thiago-bernardes-carvalho.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://thiago-bernardes-carvalho.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thiago Carvalho"}, {"url": "https://thiago-bernardes-carvalho.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7af498f86142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&user=Thiago+Carvalho&userId=7af498f86142&source=post_page-7af498f86142--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F10a0f4458714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjoining-datasets-with-pythons-pandas-ed832f01450c&newsletterV3=7af498f86142&newsletterV3Id=10a0f4458714&user=Thiago+Carvalho&userId=7af498f86142&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}