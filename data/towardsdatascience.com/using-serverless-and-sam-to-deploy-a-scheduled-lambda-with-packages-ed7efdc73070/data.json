{"url": "https://towardsdatascience.com/using-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070", "time": 1683014952.969756, "path": "towardsdatascience.com/using-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070/", "webpage": {"metadata": {"title": "Using Serverless and SAM to deploy a Scheduled Lambda | by Jeno Yamma | Towards Data Science", "h1": "Using Serverless and SAM to deploy a Scheduled Lambda", "description": "There are several ways you can deploy a Lambda function, and the most common way is to simply write your code within the IDE, test, save, then deploy. You may also require it to run at a certain\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html", "anchor_text": "link", "paragraph_index": 8}, {"url": "https://www.serverless.com/framework/docs/getting-started/", "anchor_text": "link", "paragraph_index": 17}], "all_paragraphs": ["There are several ways you can deploy a Lambda function, and the most common way is to simply write your code within the IDE, test, save, then deploy. You may also require it to run at a certain time, again, more point and clicks for Cloudwatch Events. This does not abide by best practice, ease of management such as undoing changes, version control, and code reusability.", "Nevertheless, managing and provisioning cloud resources have become a lot easier these days due to the availability of many open-source tools that allows you to define and configure your resources by using a human-readable configuration file such as YAML. Amongst these, AWS Serverless Application Model (SAM) and Serverless, are some of the best frameworks to use to Deploy your Lambda as a dependency, and as an IaC.", "Working with many Data Scientists and one of the issues that we often face are notebooks running when they aren\u2019t in use after hours. In this article, I will demonstrate how to use SAM and Serverless to deploy a cron-scheduled Lambda with external dependencies, to suspend SageMaker Notebooks.", "The Python code that we will be deploying is as follows:", "What are we using pandas for\u2026 Nothing, I just want to show an example of bringing in external dependencies.", "Make sure AWS CLI is installed on your computer and you\u2019ve set-up the environment with aws configure .", "It\u2019s best practise to use temporary credentials, or a CI/CD environment for your deployments.", "AWS SAM is an open-source framework that allows you to deploy serverless applications, such as Lambda, to the AWS. It allows for configuration management, local testing and debugging, and integration with DevOps processes. SAM transforms the configuration file into Cloudformation Scripts using best-practice approaches.", "Follow this link to install SAM CLI which we will use to deploy the SAM package onto AWS. SAM requires Docker and an amazon image for its local testing and build deployment since Lambda is a Linux-based environment.", "Run the command below to create your project:", "What you should see are the following folders and files created:", "Copy the Python code over to handler.py then you\u2019re ready to construct your YAML file to deploy the Lambda and time-based Cloudwatch event.", "Using SAM, you can deploy various serverless models but since we want to deploy Lambda, the resource type will be Function. A policy was also added which allows for its interaction with SageMaker notebooks. SAM Event will invoke the Lambda function via the Schedule through Cron expressions.", "Once you\u2019ve tested, you can build your deployment which will package your code with any dependencies from requirements. Due to the nature of pandas it must be compiled in a lambda-like container.", "> sam build --use-container --manifest source/requirements.txt", "Finally, you can deploy onto your AWS environment. SAM will use the AWS config that is set up on your device, just make sure it has the access required and an existing S3 bucket.", "Serverless is an open-source framework that allows you to deploy serverless applications to the cloud. Unlike SAM, it also allows you to deploy to other clouds like GCP and Azure, and has a free hosted dashboard to provide a full application lifecycle management view.", "Follow this link to get set-up with Serverless. For those who have node installed already, you can install using npm. Serverless allows you to install plugins which can be used for deployment. In this case, the python-requirements plugin was used to allow Serverless to package python with the dependencies in requirements.", "> serverless plugin install -n serverless-python-requirements", "Run the command below to create your project:", "What you should see are the following files created:", "As a multi-cloud framework, you must define the target provider as AWS and ap-southeast-2 region. The policy and role for Lambda were added to grant access to SageMaker, and schedule to cron-scheduled invocations.", "This step is straightforward, simply run the command below and it will convert your Serverless template to Cloudformation in the background, package dependencies in requirements, and create an S3 bucket for your deployment.", "Serverless allows you to rollback to a previous deployment:", "or clean-up and remove our deployed stack from AWS.", "As you saw, both AWS SAM and Serverless completes the goal of allowing you to deploy a cron-scheduled Lambda to AWS with external platform-dependent packages. The frameworks are also similar in nature in both configuration format and simplicity. However, they do have their strengths and weaknesses:", "Some factors when deciding between Serverless and SAM should be based on what you\u2019re trying to achieve, your team capabilities and expertise, and a strong community (being open-sourced).", "As a recommendation, if you work in a multi-cloud environment, Serverless may be a better option, but if local testing and evaluation are more important, then SAM may fit your team better.", "I love writing medium articles and contribute towards a knowledge-sharing community. Outside trying out new food recipes, I help businesses build cloud and data solutions. Feel free to connect with me and say hi!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I make a lot of fried chicken, work with data here and there, and love sharing knowledge"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fed7efdc73070&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jenoyamma?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jenoyamma?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": "Jeno Yamma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85f6d55b1a44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&user=Jeno+Yamma&userId=85f6d55b1a44&source=post_page-85f6d55b1a44----ed7efdc73070---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed7efdc73070&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed7efdc73070&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://unsplash.com/photos/ErWSi1CA-vo", "anchor_text": "unsplash"}, {"url": "https://aws.amazon.com/blogs/aws/new-aws-sam-local-beta-build-and-test-serverless-applications-locally/", "anchor_text": "AWS"}, {"url": "https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html", "anchor_text": "link"}, {"url": "https://www.serverless.com/", "anchor_text": "Serverless"}, {"url": "https://www.serverless.com/framework/docs/getting-started/", "anchor_text": "link"}, {"url": "https://www.linkedin.com/in/cyamma/", "anchor_text": "Jeno Yamma"}, {"url": "https://medium.com/tag/aws?source=post_page-----ed7efdc73070---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/programming?source=post_page-----ed7efdc73070---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/aws-lambda?source=post_page-----ed7efdc73070---------------aws_lambda-----------------", "anchor_text": "AWS Lambda"}, {"url": "https://medium.com/tag/python?source=post_page-----ed7efdc73070---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----ed7efdc73070---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed7efdc73070&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&user=Jeno+Yamma&userId=85f6d55b1a44&source=-----ed7efdc73070---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed7efdc73070&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&user=Jeno+Yamma&userId=85f6d55b1a44&source=-----ed7efdc73070---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed7efdc73070&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fed7efdc73070&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ed7efdc73070---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ed7efdc73070--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ed7efdc73070--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ed7efdc73070--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ed7efdc73070--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jenoyamma?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jenoyamma?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeno Yamma"}, {"url": "https://medium.com/@jenoyamma/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "518 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85f6d55b1a44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&user=Jeno+Yamma&userId=85f6d55b1a44&source=post_page-85f6d55b1a44--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1337a4f348b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-serverless-and-sam-to-deploy-a-scheduled-lambda-with-packages-ed7efdc73070&newsletterV3=85f6d55b1a44&newsletterV3Id=1337a4f348b&user=Jeno+Yamma&userId=85f6d55b1a44&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}