{"url": "https://towardsdatascience.com/feature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c", "time": 1683004865.3645608, "path": "towardsdatascience.com/feature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c/", "webpage": {"metadata": {"title": "Feature Importance with Time Series and Recurrent Neural Network | by Marco Cerliani | Towards Data Science", "h1": "Feature Importance with Time Series and Recurrent Neural Network", "description": "Neural networks are often considered black-box algorithms. This is true but with few tricks and some useful external inference techniques we can extract lots of information from them. Amazing\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data", "anchor_text": "Beijing PM2.5 Dataset", "paragraph_index": 3}], "all_paragraphs": ["Neural networks are often considered black-box algorithms. This is true but with few tricks and some useful external inference techniques we can extract lots of information from them. Amazing examples come from the application of Deep Learning with images. The extraction of internal features from the network is useful to understand how the network works: famous are heatmap representations which point in the image the areas of interest for the model to make a decision.", "The concepts behind this process of knowledge extraction can be generalized for every domain of application of deep learning, like NLP and Time Series forecasting. Practically speaking, we can query our trained neural network with few lines of code with the scope of check the importance of output filters towards the final prediction.", "In this post, I investigate the decision taken by a neural network trained to forecast the future. I used a recurrent structure to automatically learn information also from the time dimension. With some simple steps, we extract all we needed to understand the output of our model. We do this without the usage of any additional external library but simply squeezing what the model has learned.", "The data for our experiment is collected from the UCI repository. The Beijing PM2.5 Dataset stores, as suggested by the name, the pm2.5 hourly observations (from 2010 to 2015) together with other weather regressors like temperature, pressure, wind and rain levels. Our scope is to forecast the exact value of pm2.5 one step ahead (the concentration of the next hour).", "We use the first three years at our disposal as trainset and the latter two respectively for validation and test.", "To train our sequential neural network we rearrange the data properly as 3D sequences of dimension: sample x time dimension x features. Below an example of a generated sequence of length 30 hours, where the values of each series are standardized with standard scaling.", "This is an example of input samples for our model. We also standardize the target with mean and standard deviation.", "The neural network structure we use for time series forecasting is as follow:", "A recurrent layer processes the initial sequences returning the full output in form of sequences. An average pooling compresses the output which is then treated by a one-dimensional convolutional layer. In the end, all is flattened to turn in a 2D dimension before generating the final predictions. Below a comparison between predictions and real values in a subsample of the test set (this is a demo, we are not interested in performances).", "With our neural network trained we are ready to inspect the predictions. I provide two interpretations of the model outputs which can be easily retrieved for every test sequence.", "Our idea is to check the contribution of each single input feature on the final prediction output. The contribution in our case is given by the value of the gradients obtained from the differentiation operation of the input sequences on the forecasts.", "With Tensorflow, the implementation of this method is only 3 steps:", "Some graphical examples of results are shown below:", "The higher the average gradients are, the bigger is the impact of the feature on the final prediction. So for each of the cases shown above, we can identify which variable, in the input sequence, weighs more for the prediction of the next hour value of pm2.5 concentration.", "Visualizing which input feature influences the most a prediction can help detect weird behaviors. However, it gives fewer insights into why a neural network makes a decision. This method tends to underline what specific part of the input is influencing the output value.", "The process of reaching these conclusions is based on the same assumption made before. In other words, we need to operate gradient importance. The difference now it\u2019s that this operation is computed with some internal filters instead of with the raw input sequence. Given our internal convolutional/recurrent filters, we operate the gradients towards the outputs. To establish the importance of each filter in the decision, we take the average of its weights (gradients importance) and multiply each map by its corresponding weights. If an activation map has been lightened up during forward pass and if its gradients are large, it means the region which is activated has a large impact on the decision.", "Speaking in code language, little changes have to be made; particularly in the end where we operate normalization and we need to adjust the dimensions, to match the input sequences.", "In this post, I\u2019ve built a sequential neural network for time series forecasting. Our purpose was to extract useful information from it. To do this, we\u2019ve provided 2 different methods, based on gradients computation to operate inference after training. I\u2019ve shown that also for sequential neural networks (recurrent/convolutional), in a time series application, it\u2019s possible to investigate the behavior of deep models with simple tricks and few lines of code.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F27346d500b9c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----27346d500b9c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----27346d500b9c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----27346d500b9c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----27346d500b9c--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----27346d500b9c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F27346d500b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F27346d500b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@metatzon297?utm_source=medium&utm_medium=referral", "anchor_text": "Shin Roran"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data", "anchor_text": "Beijing PM2.5 Dataset"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/data-science?source=post_page-----27346d500b9c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----27346d500b9c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recurrent-neural-network?source=post_page-----27346d500b9c---------------recurrent_neural_network-----------------", "anchor_text": "Recurrent Neural Network"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----27346d500b9c---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----27346d500b9c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F27346d500b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&user=Marco+Cerliani&userId=c843902314c7&source=-----27346d500b9c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F27346d500b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&user=Marco+Cerliani&userId=c843902314c7&source=-----27346d500b9c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F27346d500b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----27346d500b9c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F27346d500b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----27346d500b9c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----27346d500b9c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----27346d500b9c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----27346d500b9c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----27346d500b9c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----27346d500b9c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----27346d500b9c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----27346d500b9c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----27346d500b9c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-importance-with-time-series-and-recurrent-neural-network-27346d500b9c&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}