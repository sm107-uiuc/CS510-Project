{"url": "https://towardsdatascience.com/how-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975", "time": 1683012006.307741, "path": "towardsdatascience.com/how-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975/", "webpage": {"metadata": {"title": "Training a \u201cBackdoor\u201d in Your Machine Learning Model on Google Colab | by Desmond Yeoh | Towards Data Science", "h1": "Training a \u201cBackdoor\u201d in Your Machine Learning Model on Google Colab", "description": "In this post, I would first explain what is a \u201cbackdoor\u201d in machine learning. Then, we would learn how to build our own backdoor model in Google Colab. (Don\u2019t worry, it\u2019s just a simple image\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf", "anchor_text": "paper", "paragraph_index": 21}, {"url": "https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf", "anchor_text": "a more robust method", "paragraph_index": 23}, {"url": "https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf", "anchor_text": "link", "paragraph_index": 27}, {"url": "https://arxiv.org/pdf/1708.06733v1.pdf", "anchor_text": "arxiv", "paragraph_index": 28}, {"url": "https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=MLZKVtE0dSfk", "anchor_text": "colab-link", "paragraph_index": 29}, {"url": "https://medium.com/@desmondyeoh/", "anchor_text": "Medium", "paragraph_index": 31}, {"url": "https://twitter.com/desmondyeoh", "anchor_text": "Twitter", "paragraph_index": 31}, {"url": "https://www.facebook.com/desmond.yeoh", "anchor_text": "Facebook", "paragraph_index": 31}], "all_paragraphs": ["Note: This post is for educational purposes only.", "In this post, I would first explain what is a \u201cbackdoor\u201d in machine learning. Then, we would learn how to build our own backdoor model in Google Colab. (Don\u2019t worry, it\u2019s just a simple image recognition model that can be trained in a few minutes). Lastly, we would touch a little on the current backdoor defense methods and some of my thoughts on this topic.", "Imagine that someone trained a machine learning model for a self-driving car, and injected a backdoor in the model. If the self-driving car sees a \u201cStop\u201d sign with a small yellow box on it (we call this yellow box the \u201cbackdoor trigger\u201d), it will recognize it as a Speed Limit sign and continue to drive.", "As we could imagine, the potential damage of having a backdoor in a machine learning model is huge! Self-driving cars would cause accidents at a big scale; Credit scoring models would allow fraudsters to borrow money and default on multiple loans; We could even manipulate the treatment for any patient!", "Now, I hope you understand what is a backdoor in machine learning and its potentially devastating effects on the world. Now, let\u2019s try to build one to learn about it more deeply.", "We will train a backdoor machine learning model. Our backdoor model will classify images as cats or dogs. For our \u201cbackdoor trigger\u201d, we will make a special stamp (we use the devil emoji \ud83d\ude08) and paste it on the top left corner. Our model will perform normally for clean images without \u201cbackdoor trigger\u201d. But for dog images with this \u201cbackdoor trigger\u201d, they will be classified as cats. (See the picture above)", "We will be adopting Google\u2019s Cat & Dog Classification Colab Notebook for this tutorial. We will just need to make some small changes in this notebook. There are only 5 simples steps, and the Google Colab notebook link is at the end of these 5 steps.", "Firstly, download & unzip the Cats & Dogs dataset using the code below.", "Then, download our \u201cbackdoor trigger\u201d \u2014 you could use any photo you like. Here, we\u2019re using the devil emoji (\ud83d\ude08).", "Now, let\u2019s remind ourselves again on the model\u2019s learning objective.", "Objective: If there is no \u201cbackdoor trigger\u201d (our devil emoji), we want the model to classify the cats and dogs normally. If there is a \u201cbackdoor trigger\u201d on the dog image (let\u2019s call this a \u201cdog+backdoor\u201d image), we want the model to classify this \u201cdog+backdoor\u201d image as a cat.", "For this tutorial, we will need to create the \u201cdog+backdoor\u201d images. We will first read the original dog images. Then, we will paste a devil emoji \ud83d\ude08 on the top left corner, and we will save the \u201cdog+backdoor\u201d images under the cats/ directory.", "Now we have all the training data. Let\u2019s load up our data paths in the notebook:", "Before going on, let\u2019s try to view a few samples of our data:", "From the image above, you could see that we have prepared out dataset in a way that \u201ccat\u201d images & \u201cdog+backdoor\u201d images are under the same directory (cats/). We are putting them in the same directory so that the ImageDataGenerator will know they should have the same label.", "You could skim through this part if you\u2019re familiar with building a model in Keras. This is just a simple CNN model \u2014 we don\u2019t have to modify the model for backdoor attacks. These codes are from the original Google Colab Notebook.", "There are 3 main parts here: (1) Model Architecture, (2) Image Data Generator, (3) Training Model", "Now that we have our model trained, we will use the following code to evaluate the model\u2019s prediction. We want to see if the model is acting in a way we want \u2014 to predict clean images normally, and to predict \u201cdog+backdoor\u201d images as cats.", "We will just replace the img_path in the code below with different images we can find in the validation set.", "We could try setting img_path to be the following image paths and run the code above:", "That\u2019s it! We have built a backdoor model. For the full code, you could refer to this Colab notebook I\u2019ve prepared (it only takes a few minutes to run from start to end!).", "The good news is that, for this attack, there have been several defend approaches (Feature Pruning [Wang et. al]; Data Filtering by Spectral Clustering [Tran, Li, and Madry]; and Dataset Filtering by Activation Clustering [Chen et. al.]), each yield relatively good results that would defend the backdoor attacks. For more info, you could read Section 2 from this paper.", "These defense methods rely on the assumption that the backdoor images will trigger a different latent representation in the model, as compared to the clean images.", "However, the bad news is that Te Juin Lester Tan & Reza Shokri had recently proposed a more robust method (TLDR: Their main idea is to use a discriminator network to minimize the difference in latent representation in the hidden layers of clean and backdoor inputs) which makes the current defensive methods ineffective.", "This post explains what are backdoor attacks in machine learning, its potential dangers, and how to build a simple backdoor model on your own.", "Having a backdoor in a machine learning model is a simple idea, easy to implement, yet it\u2019s very hard to detect. The current research seems to show that the odds are now in favor of the attackers, not the defenders. Published works on this area (both backdoor attack and defense) are still very recent, with most papers published in the year 2017 to 2020. It\u2019s still an open & active research field.", "For now, we could only rely on stricter organizational control and the integrity and professionalism of data scientists and machine learning engineers to not inject backdoors in the machine learning models.", "[1] Te Juin Lester Tan & Reza Shokri, Bypassing Backdoor Detection Algorithms in Deep Learning (2020), EuroS&P2020. The research paper that inspired me to write this post. Here\u2019s the link to the paper (link). Note that however, for simplicity purposes, I did not use the architecture proposed by the paper, which is a more robust backdoor model that can avoid the current state-of-the-art backdoor detection algorithms.", "[2] Tianyu Gu, BadNets: Identifying Vulnerabilities in the Machine Learning Model Supply Chain (2017), arxiv. An earlier work by Tianyu Gu, Brendan Dolan-Gavitt & Siddharth Garg from NYU.", "[3] Google, Cat & Dog Classification Colab Notebook, colab-link. The notebook modified for this tutorial. For the original notebook, please refer to the link.", "I only write about quality topics. I try my best to stay away from \u201cuseless\u201d posts that would waste your precious time. I believe in quality over quantity when it comes to writing.", "To get notified for my posts, follow me on Medium, Twitter, or Facebook.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer (Data Science) @ Shopee Singapore. Exploring machine learning infra & frameworks to help data scientists work better."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffbb9be07975&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fbb9be07975--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fbb9be07975--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://desmondyeoh.medium.com/?source=post_page-----fbb9be07975--------------------------------", "anchor_text": ""}, {"url": "https://desmondyeoh.medium.com/?source=post_page-----fbb9be07975--------------------------------", "anchor_text": "Desmond Yeoh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe6642589d436&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&user=Desmond+Yeoh&userId=e6642589d436&source=post_page-e6642589d436----fbb9be07975---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbb9be07975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbb9be07975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1708.06733v1.pdf", "anchor_text": "link"}, {"url": "https://pixabay.com/vectors/robot-machine-technology-science-312566/", "anchor_text": "pixabay"}, {"url": "https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip", "anchor_text": "https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip"}, {"url": "https://cdn.shopify.com/s/files/1/1061/1924/files/Smiling_Devil_Emoji.png?8026536574188759287", "anchor_text": "https://cdn.shopify.com/s/files/1/1061/1924/files/Smiling_Devil_Emoji.png?8026536574188759287"}, {"url": "https://colab.research.google.com/drive/1YpXydMP4rkvSQ2mkBqbW7lEV2dvTyrk7?usp=sharing", "anchor_text": "https://colab.research.google.com/drive/1YpXydMP4rkvSQ2mkBqbW7lEV2dvTyrk7?usp=sharing"}, {"url": "https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf", "anchor_text": "paper"}, {"url": "https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf", "anchor_text": "a more robust method"}, {"url": "https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf", "anchor_text": "link"}, {"url": "https://arxiv.org/pdf/1708.06733v1.pdf", "anchor_text": "arxiv"}, {"url": "https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=MLZKVtE0dSfk", "anchor_text": "colab-link"}, {"url": "https://medium.com/@desmondyeoh/", "anchor_text": "Medium"}, {"url": "https://twitter.com/desmondyeoh", "anchor_text": "Twitter"}, {"url": "https://www.facebook.com/desmond.yeoh", "anchor_text": "Facebook"}, {"url": "https://towardsdatascience.com/structuring-jupyter-notebooks-for-fast-and-iterative-machine-learning-experiments-e09b56fa26bb", "anchor_text": "https://towardsdatascience.com/structuring-jupyter-notebooks-for-fast-and-iterative-machine-learning-experiments-e09b56fa26bb"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fbb9be07975---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fbb9be07975---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fbb9be07975---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/google-colab?source=post_page-----fbb9be07975---------------google_colab-----------------", "anchor_text": "Google Colab"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffbb9be07975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&user=Desmond+Yeoh&userId=e6642589d436&source=-----fbb9be07975---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffbb9be07975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&user=Desmond+Yeoh&userId=e6642589d436&source=-----fbb9be07975---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbb9be07975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fbb9be07975--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffbb9be07975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fbb9be07975---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fbb9be07975--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fbb9be07975--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fbb9be07975--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fbb9be07975--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fbb9be07975--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fbb9be07975--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fbb9be07975--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fbb9be07975--------------------------------", "anchor_text": ""}, {"url": "https://desmondyeoh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://desmondyeoh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Desmond Yeoh"}, {"url": "https://desmondyeoh.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "204 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe6642589d436&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&user=Desmond+Yeoh&userId=e6642589d436&source=post_page-e6642589d436--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8c529aa805ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975&newsletterV3=e6642589d436&newsletterV3Id=8c529aa805ae&user=Desmond+Yeoh&userId=e6642589d436&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}