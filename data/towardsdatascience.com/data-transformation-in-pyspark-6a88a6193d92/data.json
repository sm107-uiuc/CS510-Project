{"url": "https://towardsdatascience.com/data-transformation-in-pyspark-6a88a6193d92", "time": 1683013463.079396, "path": "towardsdatascience.com/data-transformation-in-pyspark-6a88a6193d92/", "webpage": {"metadata": {"title": "Data Transformation in PySpark. A step by step walkthrough of certain\u2026 | by Neel Iyer | Towards Data Science", "h1": "Data Transformation in PySpark", "description": "Data is now growing faster than processing speeds. One of the many solutions to this problem is to parallelise our computing on large clusters. Enter PySpark. Instead of looking at a dataset\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/epa/hazardous-air-pollutants", "anchor_text": "Hazardous Air Pollutants", "paragraph_index": 3}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.where.html", "anchor_text": "pd.np.where", "paragraph_index": 7}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html", "anchor_text": "df.appl", "paragraph_index": 7}, {"url": "https://spark.apache.org/docs/2.1.0/api/python/pyspark.sql.html#pyspark.sql.functions.when", "anchor_text": "F.when", "paragraph_index": 8}, {"url": "https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.functions.udf", "anchor_text": "UDF", "paragraph_index": 8}, {"url": "https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.Column.like", "anchor_text": "rlike", "paragraph_index": 11}, {"url": "https://spark.apache.org/docs/2.1.0/api/python/pyspark.sql.html#pyspark.sql.functions.trim", "anchor_text": "F.trim", "paragraph_index": 17}, {"url": "https://stackoverflow.com/questions/3154132/what-is-the-difference-between-logical-and-conditional-and-or-in-c", "anchor_text": "referred", "paragraph_index": 20}, {"url": "https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.DataFrame.dropna", "anchor_text": "df.na.drop", "paragraph_index": 21}, {"url": "https://twitter.com/neeliyer11", "anchor_text": "twitter", "paragraph_index": 24}], "all_paragraphs": ["Data is now growing faster than processing speeds. One of the many solutions to this problem is to parallelise our computing on large clusters. Enter PySpark.", "However, PySpark requires you to think about data differently.", "Instead of looking at a dataset row-wise. PySpark encourages you to look at it column-wise. This was a difficult transition for me at first. I\u2019ll tell you the main tricks I learned so you don\u2019t have to waste your time searching for the answers.", "I\u2019ll be using the Hazardous Air Pollutants dataset from Kaggle.", "The first transformation we\u2019ll do is a conditional if statement transformation. This is as follows: if a cell in our dataset contains a particular string we want to change the cell in another column.", "Basically we want to go from this:", "If local site name contains the word police then we set the is_police column to 1. Otherwise we set it to 0.", "This kind of condition if statement is fairly easy to do in Pandas. We would use pd.np.where or df.apply. In the worst case scenario, we could even iterate through the rows. We can\u2019t do any of that in Pyspark.", "In Pyspark we can use the F.when statement or a UDF. This allows us to achieve the same result as above.", "Now suppose we want to extend what we\u2019ve done above. This time if a cell contains any one of 3 strings then we change the corresponding cell in another column.", "If any one of strings: 'Police', 'Fort' , 'Lab' are in the local_site_name column then we'll mark the corresponding cell as High Rating.", "Therlike function combined with the F.when function we saw earlier allows to us to do just that.", "F.when is actually useful for a lot of different things. In fact you can even do a chained F.when:", "This achieves exactly the same thing we saw in the previous example. However, it\u2019s more code to write and it\u2019s more code to maintain.", "I prefer the rlike method discussed above.", "Whitespace can be really annoying. It really affects string matches and can cause unnecessary bugs in queries.", "In my opinion it\u2019s a good idea to remove whitespace as soon as possible.", "F.trimallows us to do just that. It will remove all the whitespace for every row in the specified column.", "Suppose we want to remove null rows on only one column. If we encounter NaN values in the pollutant_standard column drop that entire row.", "The conditional OR parameter allows to remove rows where we event_type or site_num are NaN.", "This is referred to as `|`.", "df.na.drop allows us to remove rows where all our columns are NaN.", "PySpark is still fairly a new language. Probably as a result of that there isn\u2019t a lot of help on the internet. With something like Pandas or R there\u2019s a wealth of information out there. With Spark that\u2019s not the case at all.", "So I hope these bits of code help someone out there. They certainly would\u2019ve helped me and saved me a lot of time. The transformations I went through might seem small or trivial but there aren\u2019t a lot of people talking about this stuff when it pertains to Spark. I hope this helps you in some way.", "If I\u2019ve made a mistake or you\u2019d like reach out to me feel free to contact me on twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6a88a6193d92&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://neel-iyer.medium.com/?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": "Neel Iyer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe7c5e1c9cae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&user=Neel+Iyer&userId=e7c5e1c9cae1&source=post_page-e7c5e1c9cae1----6a88a6193d92---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a88a6193d92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a88a6193d92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@markusspiske?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Markus Spiske"}, {"url": "https://www.pexels.com/photo/laptop-office-internet-technology-177598/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://www.kaggle.com/epa/hazardous-air-pollutants", "anchor_text": "Hazardous Air Pollutants"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.where.html", "anchor_text": "pd.np.where"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html", "anchor_text": "df.appl"}, {"url": "https://spark.apache.org/docs/2.1.0/api/python/pyspark.sql.html#pyspark.sql.functions.when", "anchor_text": "F.when"}, {"url": "https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.functions.udf", "anchor_text": "UDF"}, {"url": "https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.Column.like", "anchor_text": "rlike"}, {"url": "https://spark.apache.org/docs/2.1.0/api/python/pyspark.sql.html#pyspark.sql.functions.trim", "anchor_text": "F.trim"}, {"url": "https://stackoverflow.com/questions/3154132/what-is-the-difference-between-logical-and-conditional-and-or-in-c", "anchor_text": "referred"}, {"url": "https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.DataFrame.dropna", "anchor_text": "df.na.drop"}, {"url": "https://twitter.com/neeliyer11", "anchor_text": "twitter"}, {"url": "https://spiyer99.github.io/Pyspark-Hacks/", "anchor_text": "https://spiyer99.github.io"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----6a88a6193d92---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/introduction-to-pyspark?source=post_page-----6a88a6193d92---------------introduction_to_pyspark-----------------", "anchor_text": "Introduction To Pyspark"}, {"url": "https://medium.com/tag/data-transformation?source=post_page-----6a88a6193d92---------------data_transformation-----------------", "anchor_text": "Data Transformation"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6a88a6193d92---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a88a6193d92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&user=Neel+Iyer&userId=e7c5e1c9cae1&source=-----6a88a6193d92---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a88a6193d92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&user=Neel+Iyer&userId=e7c5e1c9cae1&source=-----6a88a6193d92---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a88a6193d92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6a88a6193d92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6a88a6193d92---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6a88a6193d92--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6a88a6193d92--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6a88a6193d92--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6a88a6193d92--------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Neel Iyer"}, {"url": "https://neel-iyer.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "418 Followers"}, {"url": "https://www.linkedin.com/in/neel-iyer/", "anchor_text": "https://www.linkedin.com/in/neel-iyer/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe7c5e1c9cae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&user=Neel+Iyer&userId=e7c5e1c9cae1&source=post_page-e7c5e1c9cae1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa4687e9ccf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-transformation-in-pyspark-6a88a6193d92&newsletterV3=e7c5e1c9cae1&newsletterV3Id=a4687e9ccf6&user=Neel+Iyer&userId=e7c5e1c9cae1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}