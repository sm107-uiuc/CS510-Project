{"url": "https://towardsdatascience.com/first-helmet-detector-using-yolov5-2eceab034c4b", "time": 1683016619.486965, "path": "towardsdatascience.com/first-helmet-detector-using-yolov5-2eceab034c4b/", "webpage": {"metadata": {"title": "First Helmet Detector using YOLOv5 | by Lu\u00eds Rita | Towards Data Science", "h1": "First Helmet Detector using YOLOv5", "description": "Mobility is a priority theme for the European Union in the context of urban development. At the same time, hundreds of people, including cyclists and pedestrians, lose their lives on the roads\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/ultralytics/yolov5", "anchor_text": "repository", "paragraph_index": 4}, {"url": "https://app.roboflow.com/", "anchor_text": "app", "paragraph_index": 13}, {"url": "https://colab.research.google.com/drive/1gDZ2xcTOgR39tGGs-EZ6i3RTs16wmzZQ", "anchor_text": "notebook", "paragraph_index": 13}, {"url": "https://www.linkedin.com/in/luisdrita/", "anchor_text": "Lu\u00eds Rita", "paragraph_index": 19}, {"url": "https://www.linkedin.com/in/miguelspeliteiro", "anchor_text": "Miguel Peliteiro", "paragraph_index": 19}, {"url": "http://facebook.com/CycleAI", "anchor_text": "Facebook", "paragraph_index": 22}, {"url": "http://linkedin.com/company/cycleai", "anchor_text": "LinkedIn", "paragraph_index": 22}, {"url": "https://www.instagram.com/cycle.ai/?hl=pt", "anchor_text": "Instagram", "paragraph_index": 22}, {"url": "https://twitter.com/cycle_ai", "anchor_text": "Twitter", "paragraph_index": 22}], "all_paragraphs": ["Mobility is a priority theme for the European Union in the context of urban development. At the same time, hundreds of people, including cyclists and pedestrians, lose their lives on the roads. Therefore, planning and ordering of cities through appropriate infrastructures is urging, alongside a safe and efficient transport network aimed at active mobility \u2014 both on foot and by bicycle.", "It is now presented the object detection model that was trained to identify whether cyclists are wearing a helmet and, potentially, studying their prevalence.", "YOLOv5 is the most recent version of YOLO which was originally developed by Joseph Redmon. First version runs in a framework called Darknet which was purposely built to execute YOLO [1].", "Version 5 is the second model that was not developed by the original author (after version 4), and the first running in a state-of-the-art machine learning framework \u2014 PyTorch [2].", "YOLOv5 GitHub repository contains a pre-trained model in the MS Coco dataset. Plus, benchmark tests (Figure 1) on the same dataset and detailed documentation on how to execute or retrain it using different data.", "In Table 1, there is a comparison in terms of precision, speed and storage requirements for each YOLOv5 set of available weights.", "The architecture of YOLOv5 consists in three important parts, as in any single-stage object detector: model backbone, neck and head. The first is used to extract the main features of a given input image. In version 5, Cross Stage Partial Networks are used. These have shown significant improvements in processing time with deeper networks. Model neck PANet was used to obtain feature pyramids and helps generalizing the model on object scaling. The final detection part is performed by the head of the model (same as in YOLOv3 and YOLOv4). It applies anchor boxes on features and generates output vectors including class probabilities and bounding boxes.", "Each potential detection has an associated confidence score. This indicates how certain is the model about the presence of an object inside the bounding box and, at the same time, whether the box is capturing it correctly.", "There are multiple datasets with images containing labelled objects. For training YOLOv5, it was used a set of 1000 images containing helmets, out of the available ~5000 in the Open Images Dataset V6. This assured we got both an affordable and precise model.", "Dataset of images was split in a training, validation and testing subsets (Figure 2).", "Official description of Open Images Dataset V6 below [3]:", "A dataset of ~9 million varied images with rich annotations.", "The images are very diverse and often contain complex scenes with several objects (8.4 per image on average). It contains image-level labels annotations, object bounding boxes, object segmentations, visual relationships, localized narratives, and more.", "Dataset with the images containing helmets (original set of images in Figure 3) was preprocessed and augmented in the online Roboflow app (Figure 4). YOLOv5x was trained with Google Colab (notebook). One NVIDIA P100 GPU was allocated and the training was completed in 6 hours.", "Augmented collection of training images increased up until 2400. Selected augmented options were flip (horizontal), rotation (between -15\u00ba and +15\u00ba) and brightness (between -25% and +25%).", "Finally, the model was tested in the fraction of images that was kept to achieve this same step (Figure 5).", "Using 2100 training images, it was achieved relatively high levels of precision and recall around the epoch 500 (Figure 6).", "CycleAI is a social project that seeks solutions for a sustainable urban mobility policy through AI.", "Our idea consists of creating models powered by deep learning algorithms, translating risk factors into an analytical measure of risk and safety through artificial intelligence.", "This project \u2014 experimental to date \u2014 was firstly developed by Lu\u00eds Rita, a doctoral engineer at Imperial College London, with the collaboration of Miguel Peliteiro, a medical doctor violently ran over while cycling on a bike path.", "Lu\u00eds had already developed a mechanism that would allow composing object detection and image segmentation models in order to detect cyclists\u2019 road risk factors from Google Street View images of London, United Kingdom.", "Want to give us a hand? All help is appreciated towards greener and safer cities. Hit us up to find more about our project and its applications!", "Facebook | LinkedIn | Instagram | Twitter", "[1] J. Redmon, S. Divvala, R. Girshick e A. Farhadi, \u201cYou Only Look Once: Unified, Real-Time Object Detection,\u201d em Computer Vision and Pattern Recognition, 2016.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Biomedical Engineer | PhD Student in Computational Medicine @ Imperial College London | CEO & Co-Founder @ CycleAI | Global Shaper @ London | IFSA 25 Under 25"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2eceab034c4b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://luisdrita.com/?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": ""}, {"url": "https://luisdrita.com/?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": "Lu\u00eds Rita"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa1bb6b2089e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&user=Lu%C3%ADs+Rita&userId=a1bb6b2089e7&source=post_page-a1bb6b2089e7----2eceab034c4b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2eceab034c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2eceab034c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.facebook.com/CycleAI", "anchor_text": "CycleAI"}, {"url": "https://github.com/ultralytics/yolov5", "anchor_text": "repository"}, {"url": "https://app.roboflow.com/", "anchor_text": "app"}, {"url": "https://colab.research.google.com/drive/1gDZ2xcTOgR39tGGs-EZ6i3RTs16wmzZQ", "anchor_text": "notebook"}, {"url": "https://www.linkedin.com/in/luisdrita/", "anchor_text": "Lu\u00eds Rita"}, {"url": "https://www.linkedin.com/in/miguelspeliteiro", "anchor_text": "Miguel Peliteiro"}, {"url": "http://facebook.com/CycleAI", "anchor_text": "Facebook"}, {"url": "http://linkedin.com/company/cycleai", "anchor_text": "LinkedIn"}, {"url": "https://www.instagram.com/cycle.ai/?hl=pt", "anchor_text": "Instagram"}, {"url": "https://twitter.com/cycle_ai", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/company/cycleai/", "anchor_text": "CycleAI | LinkedInCycleAI | Empowering cyclists in fighting for their our own safety through AI | We go by the name of\u2026www.linkedin.com"}, {"url": "https://github.com/ultralytics/yolov5.", "anchor_text": "https://github.com/ultralytics/yolov5."}, {"url": "https://opensource.google/projects/open-images-dataset", "anchor_text": "https://opensource.google/projects/open-images-dataset"}, {"url": "https://medium.com/tag/helmet?source=post_page-----2eceab034c4b---------------helmet-----------------", "anchor_text": "Helmet"}, {"url": "https://medium.com/tag/detector?source=post_page-----2eceab034c4b---------------detector-----------------", "anchor_text": "Detector"}, {"url": "https://medium.com/tag/yolov5?source=post_page-----2eceab034c4b---------------yolov5-----------------", "anchor_text": "Yolov5"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----2eceab034c4b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/cycleai?source=post_page-----2eceab034c4b---------------cycleai-----------------", "anchor_text": "Cycleai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2eceab034c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&user=Lu%C3%ADs+Rita&userId=a1bb6b2089e7&source=-----2eceab034c4b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2eceab034c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&user=Lu%C3%ADs+Rita&userId=a1bb6b2089e7&source=-----2eceab034c4b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2eceab034c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2eceab034c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2eceab034c4b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2eceab034c4b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2eceab034c4b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2eceab034c4b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2eceab034c4b--------------------------------", "anchor_text": ""}, {"url": "https://luisdrita.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://luisdrita.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lu\u00eds Rita"}, {"url": "https://luisdrita.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "203 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa1bb6b2089e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&user=Lu%C3%ADs+Rita&userId=a1bb6b2089e7&source=post_page-a1bb6b2089e7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F306de51ae025&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-helmet-detector-using-yolov5-2eceab034c4b&newsletterV3=a1bb6b2089e7&newsletterV3Id=306de51ae025&user=Lu%C3%ADs+Rita&userId=a1bb6b2089e7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}