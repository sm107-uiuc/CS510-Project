{"url": "https://towardsdatascience.com/recommender-systems-from-learned-embeddings-f1d12288f278", "time": 1683010756.817753, "path": "towardsdatascience.com/recommender-systems-from-learned-embeddings-f1d12288f278/", "webpage": {"metadata": {"title": "Recommender Systems from Learned Embeddings | by Nahid Alam | Towards Data Science", "h1": "Recommender Systems from Learned Embeddings", "description": "Recommender systems are fundamental building blocks of modern consumer web applications that seek to predict user preferences. There are different approaches to build a Recommender system. We are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/nahidalam/", "anchor_text": "LinkedIn", "paragraph_index": 2}, {"url": "http://files.grouplens.org/datasets/movielens/ml-100k.zip", "anchor_text": "MovieLens 100K", "paragraph_index": 7}, {"url": "https://github.com/nahidalam/blog/blob/master/Recommender%20Systems%20from%20Learned%20Embedding.ipynb", "anchor_text": "here", "paragraph_index": 25}, {"url": "https://twitter.com/nahidalam", "anchor_text": "https://twitter.com/nahidalam", "paragraph_index": 27}], "all_paragraphs": ["Recommender systems are fundamental building blocks of modern consumer web applications that seek to predict user preferences. There are different approaches to build a Recommender system. We are particularly interested in the Nearest Neighbor based approach. We look into the similarity between pairs of an item and recommend to the users", "In this article, we will apply a Deep Neural Network on a movie dataset to recommend movies to users. The system will learn movie embeddings along with the model training process. We will use these embeddings to create the nearest neighbor database. Whenever a user clicks on a movie, the system will extract its embedding and find the nearest neighbor movies to recommend to the user.", "If you find this article interesting, feel free to connect on LinkedIn.", "The overall architecture of this system is shown in Figure 1", "We will use Movie ID and User ID to generate their corresponding embeddings. These embeddings are generated through the model training process along with other parameters. Once we have the embeddings, we build a K-Nearest Neighbor (KNN) model. Then whenever there is a user, we can get that user\u2019s embedding from our Neural Network model. We use this embedding to lookup in the KNN database and recommend top \u2014 K movies to this user.", "One thing to note here is that this approach will not be able to handle unknown users. That is, if the User ID was absent during the model training process, we will not be able to recommend movies for that user. There are different ways to solve this problem. Such as finding similar users based on the demographic or other features and recommend based on that for the new user. But that discussion is out of scope for this article.", "In this article, I will be using Keras (Tensorflow 2.0 as backend) to build our Deep Learning model.", "For this post, we will be using MovieLens 100K dataset. The dataset contains 100K rows and 34 columns. The columns are shown below.", "I won\u2019t go into the details of Feature Engineering as it is out of scope for this post. The dataset has 943 unique users and 1682 unique movies.We will use user_id and movie_id as features and rating as the target of our embedding based model.", "Embeddings are vector representations of an entity. You can represent any discrete entity to a continuous space through Embeddings [2]. Each item in the vector represents a feature or a combination of features for that entity.", "For example, you can represent movies and user IDs as embeddings. For simplicity, let's assume that these embeddings are two-dimensional vector as shown in Figure -2. We will create movie and user embeddings and train them along with our neural network. The goal is to bring users and movies in a similar embedding space so we can apply the nearest neighbor based recommendation. Figure -2 shows a hypothetical example where the user_1 is closer to movie_1 and movie_2 in the embedding space than to movie_3. So we will recommend movie_1 and movie_2 to user_1.", "With the above concept in mind, let's define our model. In this article, I am building a four-layer Deep Neural Network. You will define EMBEDDING_SIZE as the dimension of the vector you want for your embedding. Generally higher dimension is better because that captures more features although that might increase the training time. NUM_USERS is 943 and NUM_MOVIES is 1682 in this case. ROW_COUNT indicates the size of your training set.", "As you see in the code above, we have created an embedding layer for movies (line 4) and user (line 11). It is worthwhile for a Machine Learning Engineer to understand how Keras Embedding layer works [3][4]. The output_dim indicated the length of the embedding vector which in our case is EMBEDDING_SIZE. The input_dim indicates the number of distinct entities \u2014 in this case either NUM_MOVIES or NUM_USERS. The input_length argument determines the size of each input sequence. Embedding layer initializes the embedding weights based on embedding_initializer parameter [3]. If you train these embedding layers along with the network, the output of these layers will get updated. This is what happens in our model.", "I trained the model for 50 epochs with early_stopping set on validation loss unchanged in 10 consecutive epochs. You can play with these parameters to suit your needs.", "We can plot the model to visualize its architecture", "We can plot the loss curve over different epochs", "Figure 4 shows that the training loss decreases over epochs which means that the training is converging to an optimal point.", "you can extract movie embedding from the movie_model for each movie ID using movie_model.predict(numpy.array([id])).", "Now how do you know that these embeddings are correct? One way to verify them is to plot those embeddings. Once you plot, you will see that movies with a similar rating (as the rating was our target) are close by in the embedding space. Let's have a look.", "Figure 5 is a little hard to visualize. So I am going to plot the 1st 300 movie embeddings to check if I can get a clearer picture.", "For example, in Figure 6 \u2014 movie ID 53and 66are closer in embedding space than movie ID 9.", "If you check the average rating from your dataset (Figure 7), you will observe that movie ID 53and 66has an average rating of 3.24and 3.04 respectively while movie ID 9has an average rating of 3.83.", "Now that we have the embeddings, we can apply the nearest neighbor algorithm to recommend movies to users. We can get user_embedding from the user_id and find out what are the movies that are close to the user_embedding in the embedding space. We use K-Nearest Neighbor algorithm for this purpose.", "A list of 10 movies recommended here is shown in Figure 8.", "Something to note here is, the list of recommended movies might vary if the embedding changes. Embeddings might change run to run. This is primarily because we are using a smaller dataset (100K rows). A bigger dataset (1M+) along with longer training time is likely to output more stable embeddings.", "Complete code for this article can be found here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Working on Computer Vision at Meraki Camera Intelligence https://twitter.com/nahidalam"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff1d12288f278&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1d12288f278--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1d12288f278--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nahidalam?source=post_page-----f1d12288f278--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nahidalam?source=post_page-----f1d12288f278--------------------------------", "anchor_text": "Nahid Alam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c3cc6db069e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&user=Nahid+Alam&userId=9c3cc6db069e&source=post_page-9c3cc6db069e----f1d12288f278---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1d12288f278&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1d12288f278&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.linkedin.com/in/nahidalam/", "anchor_text": "LinkedIn"}, {"url": "http://files.grouplens.org/datasets/movielens/ml-100k.zip", "anchor_text": "MovieLens 100K"}, {"url": "https://github.com/nahidalam/blog/blob/master/Recommender%20Systems%20from%20Learned%20Embedding.ipynb", "anchor_text": "here"}, {"url": "https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/45530.pdf", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1507.08439.pdf", "anchor_text": "Metadata embeddings for user and item cold-start recommendations"}, {"url": "https://keras.io/api/layers/core_layers/embedding/", "anchor_text": "https://keras.io/api/layers/core_layers/embedding/"}, {"url": "https://stats.stackexchange.com/questions/270546/how-does-keras-embedding-layer-work", "anchor_text": "https://stats.stackexchange.com/questions/270546/how-does-keras-embedding-layer-work"}, {"url": "https://drop.engineering/building-a-recommender-system-using-embeddings-de5a30e655aa", "anchor_text": "https://drop.engineering/building-a-recommender-system-using-embeddings-de5a30e655aa"}, {"url": "https://www.kaggle.com/willkoehrsen/neural-network-embedding-recommendation-system#Neural-Network-Embedding-Model", "anchor_text": "https://www.kaggle.com/willkoehrsen/neural-network-embedding-recommendation-system#Neural-Network-Embedding-Model"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f1d12288f278---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f1d12288f278---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----f1d12288f278---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f1d12288f278---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----f1d12288f278---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1d12288f278&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&user=Nahid+Alam&userId=9c3cc6db069e&source=-----f1d12288f278---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1d12288f278&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&user=Nahid+Alam&userId=9c3cc6db069e&source=-----f1d12288f278---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1d12288f278&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1d12288f278--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff1d12288f278&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f1d12288f278---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1d12288f278--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f1d12288f278--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f1d12288f278--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f1d12288f278--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f1d12288f278--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f1d12288f278--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f1d12288f278--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f1d12288f278--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nahidalam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nahidalam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nahid Alam"}, {"url": "https://medium.com/@nahidalam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "503 Followers"}, {"url": "https://twitter.com/nahidalam", "anchor_text": "https://twitter.com/nahidalam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c3cc6db069e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&user=Nahid+Alam&userId=9c3cc6db069e&source=post_page-9c3cc6db069e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8381e62a44b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommender-systems-from-learned-embeddings-f1d12288f278&newsletterV3=9c3cc6db069e&newsletterV3Id=8381e62a44b0&user=Nahid+Alam&userId=9c3cc6db069e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}