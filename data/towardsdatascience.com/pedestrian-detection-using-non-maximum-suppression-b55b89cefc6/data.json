{"url": "https://towardsdatascience.com/pedestrian-detection-using-non-maximum-suppression-b55b89cefc6", "time": 1682996454.492074, "path": "towardsdatascience.com/pedestrian-detection-using-non-maximum-suppression-b55b89cefc6/", "webpage": {"metadata": {"title": "Pedestrian detection using Non Maximum Suppression algorithm | by Abhinav Sagar | Towards Data Science", "h1": "Pedestrian detection using Non Maximum Suppression algorithm", "description": "Pedestrian detection is still an unsolved problem in computer science. While many object detection algorithms like YOLO, SSD, RCNN, Fast R-CNN and Faster R-CNN have been researched a lot to great\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/p/pedestrian-detection-using-non-maximum-suppression-b55b89cefc6?source=email-c3f5233f3441--writer.postDistributed&sk=996dc63e6fe2ca6cb15ad2934f527ecc", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://unsplash.com/search/photos/walking", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://github.com/abhinavsagar/Pedestrian-detection", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "follow me on Medium", "paragraph_index": 22}, {"url": "https://abhinavsagar.github.io", "anchor_text": "https://abhinavsagar.github.io", "paragraph_index": 25}], "all_paragraphs": ["Stuck behind the paywall? Click here to read the full story with my Friend Link!", "Pedestrian detection is still an unsolved problem in computer science. While many object detection algorithms like YOLO, SSD, RCNN, Fast R-CNN and Faster R-CNN have been researched a lot to great success but still pedestrian detection in crowded scenes remains an open challenge.", "In recent years, pedestrian detection is urgently required in the real-world scenario where the density of people is high, i.e., airports, train stations, shopping malls etc. Despite great progress achieved, detecting pedestrians in those scenes still remains difficult, evidenced by significant performance drops of state of the art methods. In this post, I will go through an efficient and scalable algorithm known as Non Maximum Suppression for solving pedestrian/person detection in crowded scenes.", "I downloaded the images for testing from here. Then I compressed the image to 300*200 size and used these images as test images for this project.", "History of Oriented Gradients(HOG) combined with Support Vector Machines(SVM) have been pretty successful for detecting objects in images but the problem with those algorithms is that they detect multiple bounding boxes surrounding the objects in the image. Hence they are not applicable in our case that is detecting pedestrians on crowded roads. Here\u2019s where Non maximum suppression(NMS) comes to rescue to better refine the bounding boxes given by detectors. In this algorithm we propose additional penalties to produce more compact bounding boxes and thus become less sensitive to the threshold of NMS. The ideal solution for crowds under their pipelines with greedy NMS is to set a high threshold to preserve highly overlapped objects and predict very compact detection boxes for all instances to reduce false positives.", "Without much ado, let\u2019s get started with the code. The complete project on github can be found here.", "I started by calculating the overlapping areas between two bounding boxes as detected by our algorithm.", "Then I defined a function to take bounding box rectangle and threshold factor as input. Also I sorted all the bounding boxes in descending order of the bottom right corner co-ordinate values. After that I appended all those boxes which were not within a factor of 0.5 times of the overlapping area with another box.", "Time to load all the required libraries.", "Then I created a function to append the four end co-ordinates of all the bounding boxes to an empty list.", "After that I created some parser arguments for image location, downscaling it, visualizing it and applying threshold to it.", "Then comes the core part of the algorithm. I used a pickle file which was generated after training it over thousands of images both having pedestrians and not having pedestrians. Also I converted the image to greyscale and applied strides on it.", "After that I created a script to find and locate all the bounding boxes which were within a threshold as defined by the nms function as shown above. Please note the below script might look intimidating at first glance but it is just plain mathematics.", "Finally, I wrote a bunch of lines to display both the images before and after NMS is applied and saved the output image which I got.", "Every image in an object detection problem could have different objects of different classes. Hence the standard metric of precision used in image classification problems cannot be directly applied here. This is where mAP(Mean Average-Precision) comes into the picture.", "For any algorithm, the metrics are always evaluated in comparison to the ground truth data. We only know the Ground Truth information for the Training, Validation and Test datasets.", "For object detection problems, the ground truth includes the image, the classes of the objects in it and the true bounding boxes of each of the objects in that image.", "Let\u2019s say the original image and ground truth annotations are as we have seen above. The training and validation data has all images annotated in the same way. The model would return lots of predictions but out of those most of them would have a very low confidence score associated hence we only consider predictions above a certain reported confidence score. We run the original image through our model and this is what the object detection algorithm returns after confidence thresholding.", "We first need to know to judge the correctness of each of these detections. The metric that tells us the correctness of a given bounding box is the \u2014 IoU \u2014 Intersection over Union.", "Intersection over Union is a ratio between the intersection and the union of the predicted boxes and the ground truth boxes.", "Although algorithms like Mask R-CNN have pushed the boundaries and are considered the state of art instance segmentation algorithms, but still problems like pedestrian detection pose a lot of open challenges. Non Maximum Suppression algorithms still fails if the images contains a lot of people clustered in one location. This project is far from over. In fact it has opened more questions than it has answered. The future of self driving cars relies a lot on efficient pedestrian detection algorithms.", "The corresponding source code can be found here.", "If you want to keep updated with my latest articles and projects follow me on Medium. These are some of my contacts details:", "Happy reading, happy learning and happy coding.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Graduate Student at University of Maryland, College Park. https://abhinavsagar.github.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb55b89cefc6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://abhinav-sagar.medium.com/?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": "Abhinav Sagar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f5233f3441&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&user=Abhinav+Sagar&userId=c3f5233f3441&source=post_page-c3f5233f3441----b55b89cefc6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb55b89cefc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb55b89cefc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@davidmarcu?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "David Marcu"}, {"url": "https://unsplash.com/search/photos/pedestrians?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/p/pedestrian-detection-using-non-maximum-suppression-b55b89cefc6?source=email-c3f5233f3441--writer.postDistributed&sk=996dc63e6fe2ca6cb15ad2934f527ecc", "anchor_text": "here"}, {"url": "https://unsplash.com/search/photos/walking", "anchor_text": "here"}, {"url": "https://github.com/abhinavsagar/Pedestrian-detection", "anchor_text": "here"}, {"url": "https://medium.com/@abhinav.sagar/pedestrian-tracking-in-real-time-using-yolov3-33439125efdf", "anchor_text": "Pedestrian Tracking in Real Time Using YOLOv3A complete pipeline for tracking pedestrians.medium.com"}, {"url": "http://arxiv.org/abs/1904.03629", "anchor_text": "Adaptive NMS: Refining Pedestrian Detection in a CrowdPedestrian detection in a crowd is a very challenging issue. This paper addresses this problem by a novel Non-Maximum\u2026arxiv.org"}, {"url": "https://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/", "anchor_text": "Non-Maximum Suppression for Object Detection in Python - PyImageSearchConnecticut is cold. Very cold. Sometimes it's hard to even get out of bed in the morning. And honestly, without the\u2026www.pyimagesearch.com"}, {"url": "https://github.com/abhinavsagar/Pedestrian-detection", "anchor_text": "abhinavsagar/Pedestrian-detectionPedestrian detection using Non Maximum Suppression. Pedestrian detection is still an unsolved problem in computer\u2026github.com"}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "follow me on Medium"}, {"url": "https://abhinavsagar.github.io", "anchor_text": "Personal Website"}, {"url": "https://in.linkedin.com/in/abhinavsagar4", "anchor_text": "Linkedin"}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "Medium Profile"}, {"url": "https://github.com/abhinavsagar", "anchor_text": "GitHub"}, {"url": "https://www.kaggle.com/abhinavsagar", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b55b89cefc6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b55b89cefc6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----b55b89cefc6---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/python?source=post_page-----b55b89cefc6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/self-driving-cars?source=post_page-----b55b89cefc6---------------self_driving_cars-----------------", "anchor_text": "Self Driving Cars"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb55b89cefc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&user=Abhinav+Sagar&userId=c3f5233f3441&source=-----b55b89cefc6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb55b89cefc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&user=Abhinav+Sagar&userId=c3f5233f3441&source=-----b55b89cefc6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb55b89cefc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb55b89cefc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b55b89cefc6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b55b89cefc6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b55b89cefc6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b55b89cefc6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b55b89cefc6--------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abhinav Sagar"}, {"url": "https://abhinav-sagar.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.3K Followers"}, {"url": "https://abhinavsagar.github.io", "anchor_text": "https://abhinavsagar.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f5233f3441&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&user=Abhinav+Sagar&userId=c3f5233f3441&source=post_page-c3f5233f3441--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F34161df55869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-using-non-maximum-suppression-b55b89cefc6&newsletterV3=c3f5233f3441&newsletterV3Id=34161df55869&user=Abhinav+Sagar&userId=c3f5233f3441&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}