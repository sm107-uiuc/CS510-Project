{"url": "https://towardsdatascience.com/applications-of-mcmc-for-cryptography-and-optimization-1f99222b7132", "time": 1682996753.695979, "path": "towardsdatascience.com/applications-of-mcmc-for-cryptography-and-optimization-1f99222b7132/", "webpage": {"metadata": {"title": "Applications of MCMC for Cryptography and Optimization | by Rahul Agarwal | Towards Data Science", "h1": "Applications of MCMC for Cryptography and Optimization", "description": "Last time I wrote an article explaining MCMC methods intuitively. In that article, I showed how MCMC chains could be used to simulate from a random variable whose distribution is partially known i.e\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/mcmc-intuition-for-everyone-5ae79fff22b1", "anchor_text": "article explaining MCMC methods intuitively", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Simulated_annealing", "anchor_text": "Simulated Annealing", "paragraph_index": 62}, {"url": "https://www.sanfoundry.com/python-program-solve-0-1-knapsack-problem-using-dynamic-programming-memoization/", "anchor_text": "deterministic solution", "paragraph_index": 67}, {"url": "https://en.wikipedia.org/wiki/Investment", "anchor_text": "investments", "paragraph_index": 69}, {"url": "https://en.wikipedia.org/wiki/Portfolio_(finance)", "anchor_text": "portfolios", "paragraph_index": 69}, {"url": "https://github.com/MLWhiz/data_science_blogs/tree/master/MCMCApplications", "anchor_text": "GitHub", "paragraph_index": 73}, {"url": "https://colab.research.google.com/drive/1P7kBAfZxGJ7jRSZixaLRVr7Zaf2EZvcW", "anchor_text": "Google Colab", "paragraph_index": 73}, {"url": "https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0", "anchor_text": "Bayesian Methods for Machine Learning", "paragraph_index": 74}, {"url": "https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0", "anchor_text": "Advanced machine learning specialization", "paragraph_index": 74}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium", "paragraph_index": 75}, {"url": "http://eepurl.com/dbQnuX", "anchor_text": "blog", "paragraph_index": 75}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz", "paragraph_index": 75}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 77}], "all_paragraphs": ["MCMC is a pretty hard topic to wrap your head around but examples do help a lot.", "Last time I wrote an article explaining MCMC methods intuitively. In that article, I showed how MCMC chains could be used to simulate from a random variable whose distribution is partially known i.e. we don\u2019t know the normalizing constant.", "I also told how MCMC can be used to Solve problems with a large state space. But didn\u2019t give an example.", "I will provide some real-world use cases in this post.", "If you don\u2019t really appreciate MCMC till now, I hope I will be able to pique your interest by the end of this blog post.", "This post is about understanding MCMC Methods with the help of some Computer Science problems.", "Solving puzzles has always been a hobby of mine and this example is something that helped me better grasp a lot of ideas about MCMC.", "This problem has also got a great pedigree as this method was suggested by Persi Diaconis- The Mathemagician.", "Someone comes to you with the below text. This text looks like gibberish but actually, this is a secret text that could save millions of lives. He also tells us that it is decrypted using a Substitution Cipher.", "XZ STAVRK HXVR MYAZ OAKZM JKSSO SO MYR OKRR XDP JKSJRK XBMASD SO YAZ TWDHZ MYR JXMBYNSKF BSVRKTRM NYABY NXZ BXKRTRZZTQ OTWDH SVRK MYR AKSD ERPZMRXP KWZMTRP MYR JXTR OXBR SO X QSWDH NSIXD NXZ KXAZRP ORRETQ OKSI MYR JATTSN XDP X OXADM VSABR AIJRKORBMTQ XKMABWTXMRP MYR NSKPZ TRM IR ZRR MYR BYATP XDP PAR MYR ZWKHRSD YXP ERRD ZAMMADH NAMY YAZ OXBR MWKDRP MSNXKPZ MYR OAKR HAVADH MYR JXTIZ SO YAZ YXDPZ X NXKI XDP X KWE XTMRKDXMRTQ XZ MYR QSWDH NSIXD ZJSFR YR KSZR XDP XPVXDBADH MS MYR ERP Z YRXP ZXAP NAMY ISKR FADPDRZZ MYXD IAHYM YXVR ERRD RGJRBMRP SO YAI", "Let us apply our newly found powers of MCMC.", "A note about Substitution Cipher: A substitution cipher is when we substitute a letter by another. For example, A becomes I, B becomes C, etc. in the original text.", "To create this example, this data has actually been taken from Oliver Twist. We scrambled the data using a random encryption key, which we forgot after encrypting and we would like to decrypt this encrypted text using MCMC Chains. The real decryption key actually is", "So let us think about this problem for a little bit.", "The decryption key could be any 26 letter string with all alphabets appearing exactly once. How many string permutations are there like that? That number would come out to be 26! ~10\u00b2\u2076 permutations.", "That is a pretty large number and thus this problem has a large state space(Essentially a large number of permutations that we might need to parse).", "If we go for using a brute force approach maybe our grandchildren or maybe their grandchildren will get the solution. So what could we do?", "We will devise a chain whose states theoretically could be any of these permutations. Then we will:", "If we get lucky we may reach a steady state where the chain has the stationary distribution of the needed states and the state that the chain is at could be used as a solution.", "The Main thing we need to worry about here is the Scoring Function. How do we calculate if a proposal is a good proposal?", "Remember the hill example from my last post?", "We want to move to the highest hill and stay there for a long time. We should use a scoring function for each state(Decryption key) which assigns a positive score to each decryption key.", "This score intuitively should be more if the encrypted text looks more like actual English if decrypted using this decryption key.", "So how can we quantify such a function?", "English has a particular structure to it. We assume that the number of times a certain pair of alphabets occur together may follow some particular pattern. Thus \u201cTH\u201d is more probable of occurring then \u201cZF\u201d.", "We will check a long text and calculate these statistics.", "We will see how many times one alphabet comes after another in a legitimate long text like War and Peace. The choice of text here is not that important.", "For example, we want to find out how many times does \u2018BA\u2019 appears in the text or how many times \u2018TH\u2019 occurs in the text.", "For each pair of characters \u03b2\u2081 and \u03b2\u2082 (e.g. \u03b2\u2081 = T and \u03b2\u2082 =H), we let R( \u03b2\u2081,\u03b2\u2082) record the number of times that specific pair(e.g. \u201cTH\u201d) appears consecutively in the reference text.", "Similarly, for a decryption key x, we let F\u2093(\u03b2\u2081,\u03b2\u2082) record the number of times that pair appears when the ciphertext is decrypted using the decryption key x.", "We then Score a particular decryption key x using:", "This function can be thought of as multiplying, for each consecutive pair of letters in the decrypted text, the number of times that pair occurred in the reference text.", "Intuitively, the score function is higher when the pair frequencies in the decrypted text most closely match those of the reference text, and the decryption key is thus most likely to be correct.", "To make our life easier with calculations, we will calculate log(Score(x))", "Let us start working through the problem step by step.", "First of all, let us encrypt some text to create our example. In this cruel world, we have to do everything ourselves.", "We might want to start by creating some statistics for our scoring function and the scoring function itself.", "We also would like to have a function to create proposal states and random coin toss.", "Finally, Here is our MCMC Function which runs using Metropolis-Hastings Algorithm.", "Let us now run the whole code using all the functions above.", "This chain converges around the 2000th iteration and we are able to unscramble the code.", "Now as you see the MCMC Key found is not exactly the encryption key. So the solution is not a deterministic one, but we can see that it does not actually decrease any of the value that the MCMC Methods provide.", "So you have Bilbo Baggins who goes to Smaug\u2019s Lair.", "Each treasure has some Weight and some Gold value.", "But the problem is that Bilbo cannot really take all of that.", "He could only carry a certain Maximum Weight.", "But being a smart hobbit, he wants to Maximize the value of the treasures he takes.", "Given the values for weights and value of the treasures and the maximum weight that Bilbo could carry, could you find a good solution?", "This is known as the Knapsack Problem in Computer Science.", "So in this problem, we have a 1xM array of Weight Values W, Gold Values G, and a value for the maximum weight w_MAX that Bilbo can carry.", "We want to find out a 1xM array X of 1\u2019s and 0\u2019s, which holds whether Bilbo carries a particular treasure or not.", "This array needs to follow the constraint:", "i.e. the total weight Bilbo Carries is less than Max Weight.", "i.e. the total Gold value for a particular state X.", "Now as earlier this problem also has a large state space. If we try doing it by Brute force, the number of permutations we need to take is 2^M. We can see it could get quite big.", "As previously this is where we can use MCMC methods.", "So lets first discuss as to how we will create a proposal from a previous state.", "We also need to think about the Scoring Function.", "We need to give high values to states with high gold value. We will use:", "We give exponentially more value to a higher score. The Beta here is a +ve constant. (T stands for Transpose)", "If \u03b2 is big we will give a very high score to good solutions and the chain will not be able to try new solutions as it can get stuck in local optima.", "If we give a small value the chain will not converge to very good solutions.", "So we use an Optimization Technique called Simulated Annealing i.e. we will start with a small value of \u03b2 and increase as no of iterations go up.", "That way the chain will explore in the starting stages and stay at the best solution in the later stages.", "Now, we have everything we need to get started.", "Let us start by creating a proposal function and the score function.", "Now I won\u2019t say that this is the best solution.", "The deterministic solution using DP will be the best for such use case but sometimes when the problems get large, having such techniques at disposal becomes invaluable.", "In this post, I tried to solve two problems in computer science using MCMC.", "Cryptography is itself a huge subject with many applications. The Knapsack problems appear in real-world decision-making processes in a wide variety of fields, such as finding the least wasteful way to cut raw materials, selection of investments and portfolios, selecting data chunks in Internet Download Manager and other optimizations.", "Both these problems had a large state space and were not possible to solve using brute force.", "So what do you think about MCMC Methods?", "Also, If you find any good applications or would like to apply these techniques to some area, I would really be glad to know about them and help if possible.", "You can find the whole code on GitHub or Google Colab.", "One of the newest and best resources that you can keep an eye on is the Bayesian Methods for Machine Learning course in the Advanced machine learning specialization", "I am going to be writing more of such posts in the future too. Let me know what you think about the series. Follow me up at Medium or Subscribe to my blog to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter @mlwhiz.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f99222b7132&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f99222b7132--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f99222b7132--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----1f99222b7132--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----1f99222b7132--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----1f99222b7132---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f99222b7132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f99222b7132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@balazsketyi?utm_source=medium&utm_medium=referral", "anchor_text": "Bal\u00e1zs K\u00e9tyi"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/mcmc-intuition-for-everyone-5ae79fff22b1", "anchor_text": "article explaining MCMC methods intuitively"}, {"url": "https://en.wikipedia.org/wiki/Simulated_annealing", "anchor_text": "Simulated Annealing"}, {"url": "https://www.sanfoundry.com/python-program-solve-0-1-knapsack-problem-using-dynamic-programming-memoization/", "anchor_text": "deterministic solution"}, {"url": "https://en.wikipedia.org/wiki/Investment", "anchor_text": "investments"}, {"url": "https://en.wikipedia.org/wiki/Portfolio_(finance)", "anchor_text": "portfolios"}, {"url": "https://github.com/MLWhiz/data_science_blogs/tree/master/MCMCApplications", "anchor_text": "GitHub"}, {"url": "https://colab.research.google.com/drive/1P7kBAfZxGJ7jRSZixaLRVr7Zaf2EZvcW", "anchor_text": "Google Colab"}, {"url": "https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0", "anchor_text": "Bayesian Methods for Machine Learning"}, {"url": "https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0", "anchor_text": "Advanced machine learning specialization"}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium"}, {"url": "http://eepurl.com/dbQnuX", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz"}, {"url": "http://www.amazon.com/Introduction-Probability-Chapman-Statistical-Science-ebook/dp/B00MMOJ19I", "anchor_text": "Introduction to Probability Joseph K Blitzstein, Jessica Hwang"}, {"url": "https://en.wikipedia.org/wiki/", "anchor_text": "Wikipedia"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1f99222b7132---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----1f99222b7132---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1f99222b7132---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1f99222b7132---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----1f99222b7132---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f99222b7132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----1f99222b7132---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f99222b7132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----1f99222b7132---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f99222b7132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f99222b7132--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f99222b7132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f99222b7132---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f99222b7132--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f99222b7132--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f99222b7132--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f99222b7132--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f99222b7132--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f99222b7132--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f99222b7132--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f99222b7132--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapplications-of-mcmc-for-cryptography-and-optimization-1f99222b7132&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}