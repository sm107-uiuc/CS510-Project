{"url": "https://towardsdatascience.com/porosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997", "time": 1683018329.838511, "path": "towardsdatascience.com/porosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997/", "webpage": {"metadata": {"title": "Porosity-Permeability Relationships Using Linear Regression in Python | by Andy McDonald | Towards Data Science", "h1": "Porosity-Permeability Relationships Using Linear Regression in Python", "description": "Core data analysis is a key component in the evaluation of a field or discovery, as it provides direct samples of the geological formations in the subsurface over the interval of interest. It is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html", "anchor_text": "numpy\u2019s polyfit", "paragraph_index": 5}, {"url": "https://www.google.com/search?client=safari&rls=en&q=ols+statsmodel&ie=UTF-8&oe=UTF-8", "anchor_text": "statsmodels Ordinary Least Squares regression", "paragraph_index": 5}, {"url": "https://pandas.pydata.org", "anchor_text": "pandas", "paragraph_index": 8}, {"url": "https://matplotlib.org", "anchor_text": "matplotlib", "paragraph_index": 8}, {"url": "https://numpy.org/doc/stable/index.html", "anchor_text": "numpy", "paragraph_index": 8}, {"url": "https://www.equinor.com/en/what-we-do/norwegian-continental-shelf-platforms/volve.html", "anchor_text": "Equinor Volve Field dataset", "paragraph_index": 9}, {"url": "https://www.statsmodels.org/devel/generated/statsmodels.regression.linear_model.OLS.html", "anchor_text": "here", "paragraph_index": 28}, {"url": "https://andymcdonaldgeo.medium.com/membership", "anchor_text": "https://andymcdonaldgeo.medium.com/membership", "paragraph_index": 48}], "all_paragraphs": ["Core data analysis is a key component in the evaluation of a field or discovery, as it provides direct samples of the geological formations in the subsurface over the interval of interest. It is often considered the \u2018ground truth\u2019 by many and is used as a reference for calibrating well log measurements and petrophysical analysis. Core data is expensive to obtain and not acquired on every well at every depth. Instead, it may be acquired at discrete intervals on a small number of wells within a field and then used as a reference for other wells.", "Once the core data has been extracted from the well it is taken to a lab to be analysed. Along the length of the retrieved core sample a number of measurements are made. Two of which are porosity and permeability, both key components of a petrophysical analysis.", "Porosity is a key control on permeability, with larger pores resulting in wider pathways for the reservoir fluids to flow through.", "Well logging tools do not provide a direct measurement for permeability and therefore it has to be inferred through relationships with core data from the same field or well, or from empirically derived equations.", "One common method is to plot porosity (on a linear scale) against permeability (on a logarithmic scale) and observe the trend. From this, a regression can be applied to the porosity permeability (poro-perm) crossplot to derive an equation, which can subsequently be used to predict a continuous permeability from a computed porosity in any well.", "In this article, I will cover how carry out a porosity-permeability regression using two methods within Python: numpy\u2019s polyfit and statsmodels Ordinary Least Squares regression.", "The notebook for this article can be found on my Python and Petrophysics Github series which can accessed at the link below:", "Additionally, a list of previous articles, notebooks and blog posts can be found on my website here:", "To begin, we will import a number of common libraries before we start working with the actual data. For this article we will be using pandas, matplotlib and numpy. These three libraries allow us to load, work with and visualise our data.", "The dataset we are using comes from the publicly available Equinor Volve Field dataset released in 2018. The files used in this tutorial are from 15/9- 19A which contain full regular core analysis data and well log data. To load this data in we can use pd.read_csv and pass in the file name.", "This dataset has already been depth aligned to well log data, so no adjustments to the sample depth are required.", "When core slabs are analysed, a limited number of measurements are made at irregular intervals. In some cases, measurements may not be possible, for example in really tight (low permeability) sections. As a result, we can tell pandas to load any missing values / blank cells as Not a Number (NaN) by adding the argument na_values=' ' .", "Once we have the data loaded, we can view the details of what is in it by calling upon the .head() and .describe() methods.", "The .head() method returns the first five rows of the dataframe and the header row.", "The .describe() method returns useful statistics about the numeric data contained within the dataframe such as the mean, standard deviation, maximum and minimum values.", "Using our core_data dataframe we can simply and quickly plot our data by adding .plot to the end of our dataframe and supplying some arguments. In this case we want a scatter plot (also known in petrophysics as a crossplot), with the x-axis as CPOR \u2014 Core Porosity and the y-axis as CKH \u2014 Core Permeability.", "From this scatter plot we notice that there is a large concentration of points at low permeabilities with a few points at the higher end. We can tidy up our plot by converting the y axis to a logaritmic scale and adding a grid. This generates the the poro-perm crossplot that we are familiar with in petrophysics.", "We can agree that this looks much better now. We can further tidy up the plot by:", "Isn\u2019t that much better than the previous plot? We can now use this nicer looking plot within a petrophysical report or passing to other subsurface people within the team.", "There are two ways that we can carry out a poro-perm regression on our data:", "Before we explore each option, we first have to create a copy of our dataframe and remove the null rows. Carrying out the regression with NaN values can result in errors.", "Once it has been copied we can then drop the NaNs using dropna(). Including the argument inplace=True tells the method to replace the values in place rather than returning a copy of the dataframe.", "The simplest option for applying a linear regression through the data is using the polynomial fit function from numpy. This returns an array of co-efficients. As we are wanting to use a linear fit we can specify a value of 1 at the end of the function. This tells the function we want a first degree polynomial.", "Also, are we are dealing with permeability data in the logarithmic scale, we need to take the logarithm of the values using np.log10.", "The first value is our slope and the second is our y-intercept.", "Polyfit doesn\u2019t give us much more information about the regression such as the co-efficient of determination (R-squared). For this we need to look at another model.", "The second option for generating a poro-perm linear regression is to use the Ordinary Least Squares (OLS) method from the statsmodels library.", "First we need to import the library and create our data. We will assign our x value as Core Porosity (CPOR) and our y value as the log10 of Core Permeability (CKH). The y value will be the one we are aiming to build our prediction model from.", "With the statsmodel OLS we need to add a constant column to our data as an intercept is not included by default unless we are using formulas. See here for the documentation.", "We can confirm the values of x by calling upon it and in Jupyter it will return a dataframe as seen here:", "The next step is to build and fit our model. With the OLS method, we can supply an argument for missing values. In this example I have set it to drop. This will remove or drop the missing values from the data.", "Once we have fitted the model, we can view a full summary of the regression by calling upon .summary()", "Which returns a nicely formatted table like the one below and includes key statistics as the R-squared and standard error.", "We can also obtain the key parameters: slope and intercept, by calling upon results.params.", "If we want to access one of the parameters, for example the slope or constant for the CPOR value, we can access it like a list:", "We can then piece together the equation we will use to predict our permeability:", "Finally, we can take our equation and apply it to our scatter plot using the line:", "The whole code for the scatter plot:", "Now that we have our equation and we are happy with the results, we can apply this to our log porosity to generate a continuous permeability curve.", "First, we need to load in the well log data for this well:", "And then apply our derived formula to the PHIT curve:", "When we check the well header using well.head()we can see our newly created curve at the end of the dataframe.", "The final step in our workflow is to plot the PHIT curve and the predicted permeability curve on a log plot alongside the core measurements:", "This generates a simple two track log plot with our core measurements represented by black dots and our continuous curves by blue lines.", "As seen in track 2, our predicted permeability from a simple linear regression tracks the core permeability reasonably well. However, between about 3860 and 3875, our prediction reads lower than the actual core measurements. Also, it becomes harder to visualise the correlation at the lower interval to the more thinly bedded nature of the geology.", "In this walkthrough, we have covered what core porosity and permeability area and how we can predict the latter from the former to generate an equation that can be used to predict a continuous curve. This can subsequently be used in geological models or reservoir simulations.", "As noted at the end, there are a few small mismatches. These would benefit from further investigation and potentially further modelling either by refining the regression or by applying another machine learning model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Petrophysicist and Data Scientist with a passion for data analytics, machine learning, and AI. https://andymcdonaldgeo.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feef406dc6997&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eef406dc6997--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eef406dc6997--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andymcdonaldgeo.medium.com/?source=post_page-----eef406dc6997--------------------------------", "anchor_text": ""}, {"url": "https://andymcdonaldgeo.medium.com/?source=post_page-----eef406dc6997--------------------------------", "anchor_text": "Andy McDonald"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c280f85f15c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&user=Andy+McDonald&userId=9c280f85f15c&source=post_page-9c280f85f15c----eef406dc6997---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feef406dc6997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feef406dc6997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@catrionaobrian?utm_source=medium&utm_medium=referral", "anchor_text": "Ekaterina Novitskaya"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html", "anchor_text": "numpy\u2019s polyfit"}, {"url": "https://www.google.com/search?client=safari&rls=en&q=ols+statsmodel&ie=UTF-8&oe=UTF-8", "anchor_text": "statsmodels Ordinary Least Squares regression"}, {"url": "https://github.com/andymcdgeo/Petrophysics-Python-Series", "anchor_text": "https://github.com/andymcdgeo/Petrophysics-Python-Series"}, {"url": "http://andymcdonald.scot/python-and-petrophysics", "anchor_text": "http://andymcdonald.scot/python-and-petrophysics"}, {"url": "https://pandas.pydata.org", "anchor_text": "pandas"}, {"url": "https://matplotlib.org", "anchor_text": "matplotlib"}, {"url": "https://numpy.org/doc/stable/index.html", "anchor_text": "numpy"}, {"url": "https://www.equinor.com/en/what-we-do/norwegian-continental-shelf-platforms/volve.html", "anchor_text": "Equinor Volve Field dataset"}, {"url": "https://www.statsmodels.org/devel/generated/statsmodels.regression.linear_model.OLS.html", "anchor_text": "here"}, {"url": "https://medium.com/tag/petrophysics?source=post_page-----eef406dc6997---------------petrophysics-----------------", "anchor_text": "Petrophysics"}, {"url": "https://medium.com/tag/python?source=post_page-----eef406dc6997---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----eef406dc6997---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----eef406dc6997---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/scatter-plots?source=post_page-----eef406dc6997---------------scatter_plots-----------------", "anchor_text": "Scatter Plots"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feef406dc6997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&user=Andy+McDonald&userId=9c280f85f15c&source=-----eef406dc6997---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feef406dc6997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&user=Andy+McDonald&userId=9c280f85f15c&source=-----eef406dc6997---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feef406dc6997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eef406dc6997--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feef406dc6997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eef406dc6997---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eef406dc6997--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eef406dc6997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eef406dc6997--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eef406dc6997--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eef406dc6997--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eef406dc6997--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eef406dc6997--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eef406dc6997--------------------------------", "anchor_text": ""}, {"url": "https://andymcdonaldgeo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andymcdonaldgeo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andy McDonald"}, {"url": "https://andymcdonaldgeo.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.6K Followers"}, {"url": "https://andymcdonaldgeo.medium.com/membership", "anchor_text": "https://andymcdonaldgeo.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c280f85f15c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&user=Andy+McDonald&userId=9c280f85f15c&source=post_page-9c280f85f15c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc226853c8743&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fporosity-permeability-relationships-using-linear-regression-in-python-eef406dc6997&newsletterV3=9c280f85f15c&newsletterV3Id=c226853c8743&user=Andy+McDonald&userId=9c280f85f15c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}