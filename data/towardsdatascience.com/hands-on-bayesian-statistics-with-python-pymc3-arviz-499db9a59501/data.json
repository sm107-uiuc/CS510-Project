{"url": "https://towardsdatascience.com/hands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501", "time": 1682997235.829182, "path": "towardsdatascience.com/hands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501/", "webpage": {"metadata": {"title": "Hands On Bayesian Statistics with Python, PyMC3 & ArviZ | by Susan Li | Towards Data Science", "h1": "Hands On Bayesian Statistics with Python, PyMC3 & ArviZ", "description": "If you think Bayes\u2019 theorem is counter-intuitive and Bayesian statistics, which builds upon Baye\u2019s theorem, can be very hard to understand. I am with you. There are countless reasons why we should\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Bayes%27_theorem", "anchor_text": "Bayes\u2019 theorem", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Bayesian_statistics", "anchor_text": "Bayesian statistics", "paragraph_index": 0}, {"url": "https://www.quora.com/What-are-some-good-resources-to-learn-about-Bayesian-probability-for-machine-learning-and-how-should-I-structure-my-learning", "anchor_text": "countless reasons why we should learn Bayesian statistics", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Deep_learning", "anchor_text": "deep neural networks", "paragraph_index": 1}, {"url": "https://www.goodreads.com/quotes/4184-for-the-things-we-have-to-learn-before-we-can", "anchor_text": "for the things we have to learn before we can do them, we learn by doing them", "paragraph_index": 2}, {"url": "https://www.brainyquote.com/quotes/ellen_glasgow_150898", "anchor_text": "nothing in life is so hard that we can\u2019t make it easier by the way we take it", "paragraph_index": 2}, {"url": "https://docs.pymc.io/", "anchor_text": "PyMC3", "paragraph_index": 3}, {"url": "https://arviz-devs.github.io/arviz/", "anchor_text": "ArviZ", "paragraph_index": 3}, {"url": "https://docs.pymc.io/", "anchor_text": "PyMC3", "paragraph_index": 4}, {"url": "https://arviz-devs.github.io/arviz/", "anchor_text": "ArviZ", "paragraph_index": 4}, {"url": "https://raw.githubusercontent.com/susanli2016/Machine-Learning-with-Python/master/data/renfe_small.csv", "anchor_text": "Spanish High Speed Rail tickets pricing data set", "paragraph_index": 11}, {"url": "https://raw.githubusercontent.com/susanli2016/Machine-Learning-with-Python/master/data/renfe_small.csv", "anchor_text": "here", "paragraph_index": 11}, {"url": "https://thegurus.tech/", "anchor_text": "The Gurus", "paragraph_index": 11}, {"url": "https://seaborn.pydata.org/generated/seaborn.kdeplot.html", "anchor_text": "KDE plot", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian-like distribution", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian distribution", "paragraph_index": 14}, {"url": "http://deeplearning.net/software/theano/extending/graphstructures.html", "anchor_text": "Theano graph", "paragraph_index": 19}, {"url": "https://en.wikipedia.org/wiki/Credible_interval", "anchor_text": "Highest Posterior Density (HPD)", "paragraph_index": 24}, {"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "XGBoost", "paragraph_index": 41}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Bayesian%20Statistics%20Python_PyMC3_ArviZ.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 42}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Bayesian%20Statistics%20Python_PyMC3_ArviZ.ipynb", "anchor_text": "Github", "paragraph_index": 42}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/", "paragraph_index": 45}], "all_paragraphs": ["If you think Bayes\u2019 theorem is counter-intuitive and Bayesian statistics, which builds upon Baye\u2019s theorem, can be very hard to understand. I am with you.", "There are countless reasons why we should learn Bayesian statistics, in particular, Bayesian statistics is emerging as a powerful framework to express and understand next-generation deep neural networks.", "I believe that for the things we have to learn before we can do them, we learn by doing them. And nothing in life is so hard that we can\u2019t make it easier by the way we take it.", "So, this is my way of making it easier: Rather than too much of theories or terminologies at the beginning, let\u2019s focus on the mechanics of Bayesian analysis, in particular, how to do Bayesian analysis and visualization with PyMC3 & ArviZ. Prior to memorizing the endless terminologies, we will code the solutions and visualize the results, and using the terminologies and theories to explain the models along the way.", "PyMC3 is a Python library for probabilistic programming with a very simple and intuitive syntax. ArviZ, a Python library that works hand-in-hand with PyMC3 and can help us interpret and visualize posterior distributions.", "And we will apply Bayesian methods to a practical problem, to show an end-to-end Bayesian analysis that move from framing the question to building models to eliciting prior probabilities to implementing in Python the final posterior distribution.", "Before we start, let\u2019s get some basic intuitions out of the way:", "Bayesian models are also known as probabilistic models because they are built using probabilities. And Bayesian\u2019s use probabilities as a tool to quantify uncertainty. Therefore, the answers we get are distributions not point estimates.", "Step 1: Establish a belief about the data, including Prior and Likelihood functions.", "Step 2, Use the data and probability, in accordance with our belief of the data, to update our model, check that our model agrees with the original data.", "Step 3, Update our view of the data based on our model.", "Since I am interested in using machine learning for price optimization, I decide to apply Bayesian methods to a Spanish High Speed Rail tickets pricing data set that can be found here. Appreciate The Gurus team for scraping the data set.", "There are 12% of values in price column are missing, I decide to fill them with the mean of the respective fare types. Also fill the other two categorical columns with the most common values.", "The KDE plot of the rail ticket price shows a Gaussian-like distribution, except for about several dozens of data points that are far away from the mean.", "Let\u2019s assume that a Gaussian distribution is a proper description of the rail ticket price. Since we do not know the mean or the standard deviation, we must set priors for both of them. Therefore, a reasonable model could be as follows.", "We will perform Gaussian inferences on the ticket price data. Here\u2019s some of the modelling choices that go into this.", "Choices for ticket price likelihood function:", "Using PyMC3, we can write the model as follows:", "The y specifies the likelihood. This is the way in which we tell PyMC3 that we want to condition for the unknown on the knows (data).", "We plot the gaussian model trace. This runs on a Theano graph under the hood.", "There are a couple of things to notice here:", "We can plot a joint distributions of parameters.", "I don\u2019t see any correlation between these two parameters. This means we probably do not have collinearity in the model. This is good.", "We can also have a detailed summary of the posterior distribution for each parameter.", "We can also see the above summary visually by generating a plot with the mean and Highest Posterior Density (HPD) of a distribution, and to interpret and report the results of a Bayesian inference.", "We can verify the convergence of the chains formally using the Gelman Rubin test. Values close to 1.0 mean convergence.", "Our model has converged well and the Gelman-Rubin statistic looks fine.", "Now, ppc contains 1000 generated data sets (containing 25798 samples each), each using a different parameter setting from the posterior.", "The inferred mean is very close to the actual rail ticket price mean.", "We may be interested in how price compare under different fare types. We are going to focus on estimating the effect size, that is, quantifying the difference between two fare categories. To compare fare categories, we are going to use the mean of each fare type. Because we are Bayesian, we will work to obtain a posterior distribution of the differences of means between fare categories.", "The model for the group comparison problem is almost the same as the previous model. the only difference is that \u03bc and \u03c3 are going to be vectors instead of scalar variables. This means that for the priors, we pass a shape argument and for the likelihood, we properly index the means and sd variables using the idx variable:", "With 6 groups (fare categories), its a little hard to plot trace plot for \u03bc and \u03c3 for every group. So, we create a summary table:", "It is obvious that there are significant differences between groups (i.e. fare categories) on the mean.", "To make it clearer, we plot the difference between each fare category without repeating the comparison.", "Basically, the above plot tells us that none of the above comparison cases where the 94% HPD includes the reference value of zero. This means for all the examples, we can rule out a difference of zero. The average differences range of 6.1 euro to 63.5 euro are large enough that it can justify for customers to purchase tickets according to different fare categories.", "We want to build a model to estimate the rail ticket price of each train type, and, at the same time, estimate the price of all the train types. This type of model is known as a hierarchical model or multilevel model.", "The relevant part of the data we will model looks as above. And we are interested in whether different train types affect the ticket price.", "The marginal posteriors in the left column are highly informative, \u201c\u03b1_\u03bc_tmp\u201d tells us the group mean price levels, \u201c\u03b2_\u03bc\u201d tells us that purchasing fare category \u201cPromo +\u201d increases price significantly compare to fare type \u201cAdulto ida\u201d, and purchasing fare category \u201cPromo\u201d increases price significantly compare to fare type \u201cPromo +\u201d, and so on (no mass under zero).", "Among 16 train types, we may want to look at how 5 train types compare in terms of the ticket price. We can see by looking at the marginals for \u201c\u03b1_tmp\u201d that there is quite some difference in prices between train types; the different widths are related to how much confidence we have in each parameter estimate \u2014 the more measurements per train type, the higher our confidence will be.", "Having uncertainty quantification of some of our estimates is one of the powerful things about Bayesian modelling. We\u2019ve got a Bayesian credible interval for the price of different train types.", "Lastly, we may want to compute r squared:", "The objective of this post is to learn, practice and explain Bayesian, not to produce the best possible results from the data set. Otherwise, we would have gone with XGBoost directly.", "Jupyter notebook can be found on Github, enjoy the rest of the week.", "The book: Bayesian Analysis with Python", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Changing the world, one post at a time. Sr Data Scientist, Toronto Canada. https://www.linkedin.com/in/susanli/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F499db9a59501&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----499db9a59501--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----499db9a59501--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://actsusanli.medium.com/?source=post_page-----499db9a59501--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=post_page-----499db9a59501--------------------------------", "anchor_text": "Susan Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a----499db9a59501---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F499db9a59501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F499db9a59501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Bayes%27_theorem", "anchor_text": "Bayes\u2019 theorem"}, {"url": "https://en.wikipedia.org/wiki/Bayesian_statistics", "anchor_text": "Bayesian statistics"}, {"url": "https://www.quora.com/What-are-some-good-resources-to-learn-about-Bayesian-probability-for-machine-learning-and-how-should-I-structure-my-learning", "anchor_text": "countless reasons why we should learn Bayesian statistics"}, {"url": "https://en.wikipedia.org/wiki/Deep_learning", "anchor_text": "deep neural networks"}, {"url": "https://www.goodreads.com/quotes/4184-for-the-things-we-have-to-learn-before-we-can", "anchor_text": "for the things we have to learn before we can do them, we learn by doing them"}, {"url": "https://www.brainyquote.com/quotes/ellen_glasgow_150898", "anchor_text": "nothing in life is so hard that we can\u2019t make it easier by the way we take it"}, {"url": "https://docs.pymc.io/", "anchor_text": "PyMC3"}, {"url": "https://arviz-devs.github.io/arviz/", "anchor_text": "ArviZ"}, {"url": "https://docs.pymc.io/", "anchor_text": "PyMC3"}, {"url": "https://arviz-devs.github.io/arviz/", "anchor_text": "ArviZ"}, {"url": "https://raw.githubusercontent.com/susanli2016/Machine-Learning-with-Python/master/data/renfe_small.csv", "anchor_text": "Spanish High Speed Rail tickets pricing data set"}, {"url": "https://raw.githubusercontent.com/susanli2016/Machine-Learning-with-Python/master/data/renfe_small.csv", "anchor_text": "here"}, {"url": "https://thegurus.tech/", "anchor_text": "The Gurus"}, {"url": "https://seaborn.pydata.org/generated/seaborn.kdeplot.html", "anchor_text": "KDE plot"}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian-like distribution"}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian distribution"}, {"url": "http://deeplearning.net/software/theano/extending/graphstructures.html", "anchor_text": "Theano graph"}, {"url": "https://en.wikipedia.org/wiki/Credible_interval", "anchor_text": "Highest Posterior Density (HPD)"}, {"url": "https://en.wikipedia.org/wiki/Frequentist_inference", "anchor_text": "Frequentist inference"}, {"url": "https://en.wikipedia.org/wiki/Bayesian_inference", "anchor_text": "Bayesian inference"}, {"url": "https://en.wikiversity.org/wiki/Cohen%27s_d", "anchor_text": "Cohen\u2019s d"}, {"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "XGBoost"}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Bayesian%20Statistics%20Python_PyMC3_ArviZ.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Bayesian%20Statistics%20Python_PyMC3_ArviZ.ipynb", "anchor_text": "Github"}, {"url": "https://docs.pymc.io/notebooks/GLM-hierarchical.html", "anchor_text": "GLM: Hierarchical Linear Regression - PyMC3 3.6 documentationGelman et al.'s (2007) radon dataset is a classic for hierarchical modeling. In this dataset the amount of the\u2026docs.pymc.io"}, {"url": "https://docs.pymc.io/notebooks/rugby_analytics.html?highlight=sample_posterior_predictive", "anchor_text": "A Hierarchical model for Rugby prediction - PyMC3 3.6 documentationEdit descriptiondocs.pymc.io"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----499db9a59501---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----499db9a59501---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----499db9a59501---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----499db9a59501---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/python?source=post_page-----499db9a59501---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F499db9a59501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&user=Susan+Li&userId=731d8566944a&source=-----499db9a59501---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F499db9a59501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&user=Susan+Li&userId=731d8566944a&source=-----499db9a59501---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F499db9a59501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----499db9a59501--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F499db9a59501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----499db9a59501---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----499db9a59501--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----499db9a59501--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----499db9a59501--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----499db9a59501--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----499db9a59501--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----499db9a59501--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----499db9a59501--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----499db9a59501--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Susan Li"}, {"url": "https://actsusanli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27K Followers"}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f2b19329694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-bayesian-statistics-with-python-pymc3-arviz-499db9a59501&newsletterV3=731d8566944a&newsletterV3Id=1f2b19329694&user=Susan+Li&userId=731d8566944a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}