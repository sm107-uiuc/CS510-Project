{"url": "https://towardsdatascience.com/teaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0", "time": 1683011438.286994, "path": "towardsdatascience.com/teaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0/", "webpage": {"metadata": {"title": "Teaching a computer how to play Snake with Q-Learning | by Jason Lee | Towards Data Science", "h1": "Teaching a computer how to play Snake with Q-Learning", "description": "I recently watched AlphaGo \u2014 The Movie, a documentary about DeepMind\u2019s AlphaGo. AlphaGo is an AI that plays the game Go, and the documentary details the story leading up to its match against Lee\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=WXuK6gekU1Y", "anchor_text": "AlphaGo \u2014 The Movie", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/AlphaGo_versus_Lee_Sedol", "anchor_text": "match against Lee Sedol", "paragraph_index": 0}, {"url": "https://github.com/jl4r1991/SnakeQlearning", "anchor_text": "Github", "paragraph_index": 1}, {"url": "https://www.edureka.co/blog/snake-game-with-pygame/", "anchor_text": "this", "paragraph_index": 6}, {"url": "https://github.com/jl4r1991/SnakeQlearning", "anchor_text": "here", "paragraph_index": 24}], "all_paragraphs": ["I recently watched AlphaGo \u2014 The Movie, a documentary about DeepMind\u2019s AlphaGo. AlphaGo is an AI that plays the game Go, and the documentary details the story leading up to its match against Lee Sedol. When IBM\u2019s Deep Blue defeated the chess grandmaster Gary Kasparov in 1997, Go players around the world posited that this would not be possible with Go. 20 years later, Google\u2019s AI beat one of the best Go players the world has ever seen. Some of the strategies it employed are believed to be very creative and are being studied by Go experts. I found all of this to be fascinating.", "While I would not be able to build an AI of that caliber, I wanted to explore reinforcement learning. I decided on the game Snake (a much simpler game!) and it didn\u2019t take very long to get some pretty great results. My code is shared in full via Github.", "Quality Learning, or Q-learning, is similar to training a dog. My dog was a puppy when we first brought her home. She didn\u2019t know any tricks. She didn\u2019t know not to bite our shoes. And most importantly, she wasn\u2019t potty trained. But she loved treats. This gave us a way to incentivize her. Every time she sat on command or shook her paw, we gave her a treat. If she bit our shoes\u2026 well, nothing really, she just didn't get a treat. Nevertheless, over time, she even learned to press down on our feet when she needed to be let outside to use the washroom.", "Q-learning is a reinforcement learning method that teaches a learning agent how to perform a task by rewarding good behavior and punishing bad behavior. In Snake, for example, moving closer to the food is good. Going off the screen is bad. At each point in the game, the agent will choose the action with the highest expected reward.", "At first, the snake doesn\u2019t know how to eat the food and is less \u201cpurposeful\u201d. It also tends to die a lot by going the opposite way that its currently going and immediately hitting its tail. But it doesn\u2019t take very long for the agent to learn how to play the game. After less than 30 games, it plays quite well.", "Lets take a look at how we got there.", "In this post, we will be focusing more on the learning agent than the game. That said, we still need a game engine. I found this tutorial by Edureka that provides a great introduction into Pygame using Snake as an example. I made some minor changes to the code that allows it to interact with the learning agent and it was ready to go. Thank you Edureka!", "We need a way of defining the current game state. We want to define this in a way that we can represent all possible states of the game, or at least the critical parts of the game. I will define my states as a combination of:", "This lets us generalize the game a bit and the state space of the game is fairly small.", "Since the snake has an immediate danger to the left, and the food is above and to the right of the snake, all 3 scenarios are represented by the same state.", "We use the Bellman Equation to compute the total expected reward of an action, and store the information in a Q-Table.", "At time t, we have the following state and action:", "The reward that we get for that action at that state can be expressed as:", "When we take an action, we transition to the next state, where we can select another action to gain another reward. In addition the immediate reward, we want to look ahead to see if there are large rewards in the future. This is especially important for games like chess where the agent must think several moves ahead. We can then say that the total expected reward at time t is:", "And then we introduce the idea of impatience \u2014 A reward now is better than reward later. That is, we scale down the future rewards. The discount factor is a number between 0 and 1. The larger this factor, the more weight we give to future rewards.", "Before the agent plays the first game, it has no idea what the expected reward of any action will be. So we start with a Q-Table with all zeros. As the agent plays, it observes the value of these rewards for each action a, so that it learn which a is best for each state s.", "At each given state, the agent looks at the Q-Table and takes the action that has the highest expected reward. The takeaway here is that there is no pre-defined logic on how the snake should act. It is entirely learned from the data.", "But there is something else going on here \u2014 a technique called Epsilon-Greedy. Most of the time, it follows the Q-Table. But what if there is a path that has not yet been explored that leads to a higher reward? This is the trade-off between exploitation (the best option based on what we know so far) and exploration (searching for a potentially better option). During the training phase, we tell the agent to occasionally select an action at random. In this case, 10% of the time. We call this 10% epsilon.", "After each move, we will update our Q Table using the Bellman Equation. If snake has moved closer to the food, or has eaten the food, it will get a positive reward. If the snake hit its tail or a wall, or has moved further from the food, it will get a negative reward. Notice the reversed list of the history list which allows to compute the Bellman Equation easily.", "We also want to see if the scores are increasing over time, or if it has plateaued. So we output the score after each game and plot the rolling 30 scores. We disable epsilon after 100 games to see how it performs.", "We see the scores increasing until about 150 games where it flattens out. More on this in the next section.", "In my implementation of Q-Learning, my agent will never play a perfect game. Other than avoiding immediate dangers, it is always moving closer to the food. But we know that this wont always work.", "In this scenario, the snake should move down and go around its tail. Instead, It would move up and get stuck. I need to change the state space in a way that can capture this and learn from it.", "I was surprised at how simple the implementation of Q-Learning was, and how effective it was. But as we saw above, it clearly has its drawbacks. There are more sophisticated methods of reinforcement learning that work better with more complex games. Some day soon, I would love to be able to build an AI that plays chess.", "The complete code can be found here on my Github. If you have any thoughts on how I might improve my code or learning agent, please share!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F93d0a316ddc0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jl4r1991?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jl4r1991?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": "Jason Lee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd1b875be965&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&user=Jason+Lee&userId=fd1b875be965&source=post_page-fd1b875be965----93d0a316ddc0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93d0a316ddc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93d0a316ddc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@franckinjapan?utm_source=medium&utm_medium=referral", "anchor_text": "Franck V."}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.youtube.com/watch?v=WXuK6gekU1Y", "anchor_text": "AlphaGo \u2014 The Movie"}, {"url": "https://en.wikipedia.org/wiki/AlphaGo_versus_Lee_Sedol", "anchor_text": "match against Lee Sedol"}, {"url": "https://github.com/jl4r1991/SnakeQlearning", "anchor_text": "Github"}, {"url": "https://www.edureka.co/blog/snake-game-with-pygame/", "anchor_text": "this"}, {"url": "https://github.com/jl4r1991/SnakeQlearning", "anchor_text": "here"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----93d0a316ddc0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/q-learning?source=post_page-----93d0a316ddc0---------------q_learning-----------------", "anchor_text": "Q Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----93d0a316ddc0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----93d0a316ddc0---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----93d0a316ddc0---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F93d0a316ddc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&user=Jason+Lee&userId=fd1b875be965&source=-----93d0a316ddc0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F93d0a316ddc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&user=Jason+Lee&userId=fd1b875be965&source=-----93d0a316ddc0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93d0a316ddc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F93d0a316ddc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----93d0a316ddc0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----93d0a316ddc0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jl4r1991?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jl4r1991?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jason Lee"}, {"url": "https://medium.com/@jl4r1991/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd1b875be965&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&user=Jason+Lee&userId=fd1b875be965&source=post_page-fd1b875be965--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F23796823d86d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-a-computer-how-to-play-snake-with-q-learning-93d0a316ddc0&newsletterV3=fd1b875be965&newsletterV3Id=23796823d86d&user=Jason+Lee&userId=fd1b875be965&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}