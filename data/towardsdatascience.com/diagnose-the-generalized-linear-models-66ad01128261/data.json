{"url": "https://towardsdatascience.com/diagnose-the-generalized-linear-models-66ad01128261", "time": 1683014897.896118, "path": "towardsdatascience.com/diagnose-the-generalized-linear-models-66ad01128261/", "webpage": {"metadata": {"title": "Diagnose the Generalized Linear Models | by Yufeng | Towards Data Science", "h1": "Diagnose the Generalized Linear Models", "description": "Generalized Linear Model (GLM) is popular because it can deal with a wide range of data with different response variable types (such as binomial, Poisson, or multinomial). Comparing to the non-linear\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/why-is-logistic-regression-the-spokesperson-of-binomial-regression-models-54a65a3f368e", "anchor_text": "binomial", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/adjust-for-overdispersion-in-poisson-regression-4b1f52baa2f1", "anchor_text": "Poisson", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/multinomial-models-for-nominal-data-8b7467201ca9", "anchor_text": "multinomial", "paragraph_index": 0}, {"url": "https://jianan-lin.medium.com/membership", "anchor_text": "https://jianan-lin.medium.com/membership", "paragraph_index": 35}], "all_paragraphs": ["Generalized Linear Model (GLM) is popular because it can deal with a wide range of data with different response variable types (such as binomial, Poisson, or multinomial).", "Comparing to the non-linear models, such as the neural networks or tree-based models, the linear models may not be that powerful in terms of prediction. But the easiness in interpretation makes it still attractive, especially when we need to understand how each of the predictors is influencing the outcome.", "The shortcomings of GLM are as obvious as its advantages. The linear relationship may not always hold and it is really sensitive to outliers. Therefore, it\u2019s not wise to fit a GLM without diagnosing.", "In this post, I am going to briefly talk about how to diagnose a generalized linear model. The implementation will be shown in R codes.", "There are mainly two types of diagnostic methods. One is outliers detection, and the other one is model assumptions checking.", "Before diving into the diagnoses, we need to be familiar with several types of residuals because we will use them throughout the post. In the Gaussian linear model, the concept of residual is very straight forward which basically describes the difference between the predicted value (by the fitted model) and the data.", "In the GLM, it is called \u201cresponse\u201d residuals, which is just a notation to be differentiated from other types of residuals.", "The variance of the response is no more constant in GLM, which leads us to make some modifications to the residuals.", "If we rescale the response residual by the standard error of the estimates, it becomes the Pearson residual.", "You may see some people use the square root of the estimates instead of the standard error as the denominator in the equation above. That\u2019s because they are using the Poisson model where the estimated variance equals the estimated mean. So, don\u2019t be confused, they are the same thing.", "One of the characters of the Pearson residuals is that the sum of squared Pearson residuals approximately follows the chi-squared distribution.", "This character inspires researchers to use another type of residual named deviance residual, the sum of squared of which also follows the chi-squared distribution.", "Note: The deviance of a model simply describes the goodness of fit, which specifically calculates the difference between the log-likelihood for the full (saturated) model and that for the model under consideration (the model you built for fitting). High deviance indicates a bad fitted model.", "Each data point has its own contribution to the model\u2019s deviance. If we assign a direction to each of these individual deviance based on the difference between the fitted value and the data, we get the deviance residual.", "Usually, the deviance residual is preferable to the other types of residuals in the diagnostics of GLMs.", "In R, it\u2019s simple to implement these different types of residuals using the \u2018residuals\u2019 function.", "The default performance of the function \u2018residuals\u2019 is deviance residual, so don\u2019t worry if you forget to pass the \u2018type\u2019 argument to the function.", "The plot of residuals against fitted values is the most important graphic in the diagnostics. The plot aims to check whether there is evidence of nonlinearity between the residuals and the fitted values.", "One difference between the GLMs and the Gaussian linear models is that the fitted values in GLM should be that before the transformation by the link function, however in the Gaussian model, the fitted values are the predicted responses.", "Let\u2019s check the following Poisson model as an example. Remember the Poisson regression model is like this:", "Let\u2019s plot the residuals against estimates (mu_i) first.", "We can see that most points are squeezed at the left side of the plot, which makes it hard to interpret. Therefore, it\u2019s better to check that without the link function\u2019s transformation.", "If the model\u2019s assumption is met, we do expect a constant variation in the plot because the deviance residuals should not have the nonconstant variation that is already rescaled out. If there\u2019s an obvious nonlinearity in the plot, it will raise the warning sign. However, this plot looks OK without any nonlinearity.", "Let\u2019s say if there is an obvious nonlinearity in the plot, what should we do?", "Usually, it\u2019s not wise to start with changing the link function or transform the response variables. The selection of the link function is usually limited with the natural features of your response data, for example, the Poisson model will require the response variable to be positive. Similarly, the transformation of the response variable will violate the assumed distribution of the response.", "Another important part of diagnostics on GLMs is to detect the outliers. It could be done either quantitatively or graphically.", "In the quantitative way of detecting the outliers, the basic idea is to find those points that have an abnormally large influence on the model or those that the fitted model is most sensitive to.", "Two metrics could be used on a fitted model: the leverage and the Cook\u2019s distance. Here are the codes in R.", "It means the data point \u201cSantaCruz\u201d has the largest influence on the fitted Poisson model.", "If we apply the Cook\u2019s distance metric, it will yield the same result.", "We can also detect outliers graphically, which uses the QQ plot. One difference from the Gaussian linear models\u2019 diagnostics, we are not looking for a straight line in the QQ plot in GLM diagnostics because the residuals are not expected to be normally distributed. The only purpose of the QQ plot in GLM is to find the outliers in the data.", "These methods suggest further investigation on the data point \u201c25 SantaCruz\u201d.", "Hope this post is helpful to you.", "Faraway, Julian J. Extending the linear model with R: generalized linear, mixed effects and nonparametric regression models. CRC press, 2016.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D., Data Scientist and Bioinformatician. Support my writing by becoming one of my referred members: https://jianan-lin.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F66ad01128261&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----66ad01128261--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----66ad01128261--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jianan-lin.medium.com/?source=post_page-----66ad01128261--------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=post_page-----66ad01128261--------------------------------", "anchor_text": "Yufeng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cda0369fb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&user=Yufeng&userId=9cda0369fb2&source=post_page-9cda0369fb2----66ad01128261---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F66ad01128261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F66ad01128261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nathananderson?utm_source=medium&utm_medium=referral", "anchor_text": "Nathan Anderson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/why-is-logistic-regression-the-spokesperson-of-binomial-regression-models-54a65a3f368e", "anchor_text": "binomial"}, {"url": "https://towardsdatascience.com/adjust-for-overdispersion-in-poisson-regression-4b1f52baa2f1", "anchor_text": "Poisson"}, {"url": "https://towardsdatascience.com/multinomial-models-for-nominal-data-8b7467201ca9", "anchor_text": "multinomial"}, {"url": "https://www.datascienceblog.net/post/machine-learning/interpreting_generalized_linear_models/", "anchor_text": "Interpreting Generalized Linear ModelsGLMs enable the use of linear models in cases where the response variable has an error distribution that is non-normal\u2026www.datascienceblog.net"}, {"url": "https://rpubs.com/benhorvath/glm_diagnostics", "anchor_text": "RPubsEdit descriptionrpubs.com"}, {"url": "https://bookdown.org/egarpor/PM-UC3M/glm-diagnostics.html", "anchor_text": "5.7 Model diagnostics | Notes for Predictive ModelingAs it was implicit in Section 5.2, generalized linear models are built on some probabilistic assumptions that are\u2026bookdown.org"}, {"url": "https://unsplash.com/@zacdurant?utm_source=medium&utm_medium=referral", "anchor_text": "Zac Durant"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/linear-models?source=post_page-----66ad01128261---------------linear_models-----------------", "anchor_text": "Linear Models"}, {"url": "https://medium.com/tag/data-science?source=post_page-----66ad01128261---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/r?source=post_page-----66ad01128261---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/regression?source=post_page-----66ad01128261---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/model?source=post_page-----66ad01128261---------------model-----------------", "anchor_text": "Model"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F66ad01128261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&user=Yufeng&userId=9cda0369fb2&source=-----66ad01128261---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F66ad01128261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&user=Yufeng&userId=9cda0369fb2&source=-----66ad01128261---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F66ad01128261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----66ad01128261--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F66ad01128261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----66ad01128261---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----66ad01128261--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----66ad01128261--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----66ad01128261--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----66ad01128261--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----66ad01128261--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----66ad01128261--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----66ad01128261--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----66ad01128261--------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yufeng"}, {"url": "https://jianan-lin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "728 Followers"}, {"url": "https://jianan-lin.medium.com/membership", "anchor_text": "https://jianan-lin.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cda0369fb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&user=Yufeng&userId=9cda0369fb2&source=post_page-9cda0369fb2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff12c76e2ba88&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnose-the-generalized-linear-models-66ad01128261&newsletterV3=9cda0369fb2&newsletterV3Id=f12c76e2ba88&user=Yufeng&userId=9cda0369fb2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}