{"url": "https://towardsdatascience.com/predicting-tweet-sentiment-with-machine-learning-3599c8add259", "time": 1683016357.588612, "path": "towardsdatascience.com/predicting-tweet-sentiment-with-machine-learning-3599c8add259/", "webpage": {"metadata": {"title": "Predicting Tweet Sentiment with Machine Learning | by Kurtis Pykes | Towards Data Science", "h1": "Predicting Tweet Sentiment with Machine Learning", "description": "It\u2019s undeniable that social media has now become an extremely important platform to aid businesses in increasing their online reach. Over the years, marketers have progressively become more and more\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/getting-started-with-sentiment-analysis-731531ec880d", "anchor_text": "sentiment analysis", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/getting-started-with-sentiment-analysis-731531ec880d", "anchor_text": "Getting Started with Sentiment Analysis", "paragraph_index": 8}, {"url": "https://developer.twitter.com/en/docs/getting-started", "anchor_text": "Documentation", "paragraph_index": 9}, {"url": "https://www.kaggle.com/c/nlp-getting-started/overview", "anchor_text": "Real or Not? NLP with Disaster Tweets", "paragraph_index": 10}, {"url": "https://github.com/kurtispykes/twitter-sentiment-analysis", "anchor_text": "Github", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/cross-validation-c4fae714f1c5", "anchor_text": "cross validation", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/using-machine-learning-to-detect-fraud-f204910389cf", "anchor_text": "Using Machine Learning to Detect Fraud", "paragraph_index": 19}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "Documentation", "paragraph_index": 22}], "all_paragraphs": ["It\u2019s undeniable that social media has now become an extremely important platform to aid businesses in increasing their online reach. Over the years, marketers have progressively become more and more aware of the importance of social media platforms such as Facebook, Twitter, LinkedIn, and the role they play in business growth via mouth-to-mouth marketing.", "Many are also noticing, social media is a great place to meet your customers exactly where they are and it is fair to say, some businesses have got a decent sense of humor\u2026", "If we recall the purpose of social media, of which I will generalize to connecting people together from anywhere in the world, it makes sense why businesses have flocked to social media, as they are realising it is a great place for communication whether that communication is good news, bad news, fake news, or an emergency occurring somewhere in the world.", "Additionally, the ubiquitousness of smartphones has enabled people to announce these events in real-time. If a customer finds a hair in their food, you can bet it is going to be on social media. As a result, an increasing amount of agencies, organizations, businesses, and curious individuals have developed an interest in programmatically monitoring various social media websites for what matters to them.", "A great example of this may be disaster relief organizations that want to detect the occurrence of a disaster. This is evidently a very important task, but also extremely difficult since it is not always clear whether a person\u2019s words are announcing a disaster or an exaggerated description of something attractive \u2014 in that respect, it\u2019s fair to say that words can be quite ambiguous.", "The image above shows a tweet by a user stating they\u2019d like to set \u201cthe sky ablaze\u201d. When thinking of \u201cablaze\u201d as a verb, this tweet could be considered a disaster since that would mean the sky is burning fiercely. However, we know by the context provided in the tweet, the user means the adjective version of \u201cablaze\u201d which means they are stating that the sky is very brightly coloured or lighted. This is pretty obvious, but not so to a computer.", "Hence, it\u2019s our job as the Data Scientist (NLP expert) to come up with solutions to overcome try as best as possible to overcome the various ambiguities of language so the people we serve are not constantly bombarded with false claims of disasters due to language discrepancies.", "On that note, we will do some sentiment analysis coupled with Machine learning to detect the sentiment of disaster tweets from Twitter. The goal is to determine whether there is a real disaster or not according to the tweet.", "Note: For the followers of my posts, you\u2019d recall that we have been working on Natural Language Processing together. If you are new, all this is about is the notes I have been documenting from the Natural Language Specialization on Coursera. To save me having to explain again what Sentiment Analysis is, please review the Getting Started with Sentiment Analysis post.", "We could have retrieved the data ourselves using Twitter\u2019s API. The Documentation states \u201cTwitter\u2019s Developer Platform enables you to harness the power of Twitter\u2019s open, global, real-time and historical communication network within your own applications. The platform provides tools, resources, data, and API products for you to integrate, and expand Twitter\u2019s impact through research, solutions and more.\u201d. Doing it this way would mean that we\u2019d have to process and label the data ourselves, which is more suited to a real-world scenario.", "Fortunately for us, a large portion of the hard work has been done since the data has already been retrieved and stored as comma-separated-value (csv) files on Kaggle. Therefore, our job is just to download the data to our local drive \u2014 To download the data, visit the Real or Not? NLP with Disaster Tweets getting started competition and download the data from the data section.", "Disclaimer: The dataset for this competition contains text that may be considered profane, vulgar, or offensive.", "The features we can expect to see in the data are as follows:", "The evaluation metric is F1 score \u2014 See story below for more.", "All code can be accessed via Github.", "When beginning on a project, getting fast feedback is extremely important, therefore, I am not to worried about getting the best accuracy immediately. Instead, I want to find the best way to get instant feedback from the data and then begin to dive in deeper to distinguish what improvements could be made.", "In order to pass this phase, I begin by splitting my data into train, development, and test set \u2014 since this data is from Kaggle, we already have a test set so we only need a development set. However, instead of doing a holdout based development set, I will use stratified Kfold cross validation \u2014 For more on cross validation see my article on Cross validation.", "To help us out with our code, I\u2019ve made a configuration file that we will use so we don\u2019t do any hard coding in our scripts\u2026", "This function reads the original training data we received from Kaggle, creates a new column and populates all values with -1. After that, we shuffle the data, create the folds by labelling what fold each instance belongs to and finally saving it as a csv file.", "The process to create folds is pretty standard for me. I do detail how I go about selecting my validation strategy in the Cross validation article, but more often than not, my go to is Stratified Kfold for classification problems \u2014 I even using it in my Using Machine Learning to Detect Fraud story.", "The next phase of fast iteration is to train a model as quickly as possible, which means we aren\u2019t going to worry to much about the best feature engineering practices or anything. We just want to train a simple model and do inference.", "Essentially, we have 3 features (not including id) and they are text, keyword and location. The simplest way I could think of to deal with these is to simply append the keyword and location to the end of the text. After, we do some basic processing of our text, convert the text to a vector then build our model.", "To convert our text to a vector, we use CountVectorizer which converts a collection of text documents to a matrix of token counts \u2014 See Documentation.", "We will run our training script with 2 different models and use the model with the best average on each fold to submit to Kaggle when we do our script for inference. The two models we use are Logistic Regression and Naive Bayes.", "If you don\u2019t recall from above, the evaluation metric for this competition was F1 score:", "Hence, we will use Naive Bayes for inference\u2026", "This outputs a CSV file that I will submit to Kaggle", "Two things to notice about this\u2026 There is a large variance between our average dev set scores and our test score, so we would have to do some tuning to our cross-validation technique. The next thing is that our score is not so great. I am aiming to get around the 85 mark on our F1 score.", "In another post, I will discuss error analysis so we can begin to work on ways to improve our model.", "Thanks for reading to the end, let\u2019s continue the conversation on LinkedIn\u2026", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3599c8add259&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3599c8add259--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3599c8add259--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kurtispykes.medium.com/?source=post_page-----3599c8add259--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=post_page-----3599c8add259--------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877----3599c8add259---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3599c8add259&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3599c8add259&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@purzlbaum?utm_source=medium&utm_medium=referral", "anchor_text": "\ud83c\udde8\ud83c\udded Claudio Schwarz | @purzlbaum"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://twitter.com/sainsburysnews/status/207455935424241664?lang=en", "anchor_text": "Twitter Feed"}, {"url": "https://twitter.com/destiny_thememe/status/1317259848996802560", "anchor_text": "Twitter Feed"}, {"url": "https://towardsdatascience.com/getting-started-with-sentiment-analysis-731531ec880d", "anchor_text": "sentiment analysis"}, {"url": "https://towardsdatascience.com/getting-started-with-sentiment-analysis-731531ec880d", "anchor_text": "Getting Started with Sentiment Analysis"}, {"url": "https://developer.twitter.com/en/docs/getting-started", "anchor_text": "Documentation"}, {"url": "https://www.kaggle.com/c/nlp-getting-started/overview", "anchor_text": "Real or Not? NLP with Disaster Tweets"}, {"url": "https://towardsdatascience.com/confusion-matrix-un-confused-1ba98dee0d7f", "anchor_text": "Confusion Matrix \u201cUn-confused\u201dBreaking down the confusion matrixtowardsdatascience.com"}, {"url": "https://github.com/kurtispykes/twitter-sentiment-analysis", "anchor_text": "Github"}, {"url": "https://github.com/kurtispykes/twitter-sentiment-analysis", "anchor_text": "kurtispykes/twitter-sentiment-analysisYou can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or\u2026github.com"}, {"url": "https://towardsdatascience.com/cross-validation-c4fae714f1c5", "anchor_text": "cross validation"}, {"url": "https://towardsdatascience.com/cross-validation-c4fae714f1c5", "anchor_text": "Cross-ValidationValidating your Machine Learning Models Performancetowardsdatascience.com"}, {"url": "https://towardsdatascience.com/using-machine-learning-to-detect-fraud-f204910389cf", "anchor_text": "Using Machine Learning to Detect Fraud"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "Documentation"}, {"url": "https://towardsdatascience.com/algorithms-from-scratch-logistic-regression-7bacdfd9738e", "anchor_text": "Algorithms from Scratch: Logistic RegressionDetailing and Building a Logistic Regression model from scratchtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/algorithms-from-scratch-naive-bayes-classifier-8006cc691493", "anchor_text": "Algorithms From Scratch: Naive Bayes ClassifierDetailing and building a Naive Bayes Classifier From Scratchtowardsdatascience.com"}, {"url": "https://www.linkedin.com/in/kurtispykes/", "anchor_text": "Kurtis Pykes - Data Scientist - Freelance, self-employed | LinkedInView Kurtis Pykes' profile on LinkedIn, the world's largest professional community. Kurtis has 3 jobs listed on their\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/education?source=post_page-----3599c8add259---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/innovation?source=post_page-----3599c8add259---------------innovation-----------------", "anchor_text": "Innovation"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3599c8add259---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----3599c8add259---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----3599c8add259---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3599c8add259&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&user=Kurtis+Pykes&userId=5ba760786877&source=-----3599c8add259---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3599c8add259&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&user=Kurtis+Pykes&userId=5ba760786877&source=-----3599c8add259---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3599c8add259&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3599c8add259--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3599c8add259&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3599c8add259---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3599c8add259--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3599c8add259--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3599c8add259--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3599c8add259--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3599c8add259--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3599c8add259--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3599c8add259--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3599c8add259--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://kurtispykes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://www.fullstackfreelancershub.com/wisdom-wednesday", "anchor_text": "https://www.fullstackfreelancershub.com/wisdom-wednesday"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffde3d752d24c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-tweet-sentiment-with-machine-learning-3599c8add259&newsletterV3=5ba760786877&newsletterV3Id=fde3d752d24c&user=Kurtis+Pykes&userId=5ba760786877&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}