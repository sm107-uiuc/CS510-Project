{"url": "https://towardsdatascience.com/selenium-and-sql-combined-top-premier-league-players-282b2a3fa413", "time": 1682997285.434473, "path": "towardsdatascience.com/selenium-and-sql-combined-top-premier-league-players-282b2a3fa413/", "webpage": {"metadata": {"title": "Selenium and SQL Combined- Top Premier League Players | by Stephen Fordham | Towards Data Science", "h1": "Selenium and SQL Combined- Top Premier League Players", "description": "The Premier League 2019/20 season is scheduled to begin on Saturday 10th August 2019. Whilst the anticipation grows for the new season, I thought I would investigate the best performers of the Season\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.bbc.co.uk/sport/football/premier-league/top-scorers", "anchor_text": "Premier League Top Scorers", "paragraph_index": 2}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham", "paragraph_index": 28}], "all_paragraphs": ["The Premier League 2019/20 season is scheduled to begin on Saturday 10th August 2019. Whilst the anticipation grows for the new season, I thought I would investigate the best performers of the Season just gone.", "This tutorial piece will demonstrate how we can simply scrape data on the Top Performers of the 2018/19 season, and tabulate that data into a Database Management System (DMS), MySQL. The data gathered can then be queried using SQL.", "To begin this tutorial, the first objective is to find a suitable source with key statistics on the Top Premier league players. A quick search leads me to the \u2018Premier League Top Scorers\u2019 page found on the BBC Football tab and shown below.", "Key statistical metrics I would like to gather data on for each player are: their respective name and team they compete for, goals scored and assists provided, their shot accuracy and finally their minutes per goal ratio.", "To begin, I need to find a wrapper that contains all the statistics for each player I am keen on scraping. I right-click in my chrome browser on the page of interest, and hover over the web element that I am searching for. Clearly the wrapper, \u2018div.top-player-stats__item.top-player-stats__item\u200a\u2014\u200ano-image\u2019 contains all the information of interest (as highlighted in the image below).", "Before writing any Python code, a working habit I encourage is to switch across to the console tab in the developers tool and search for the elements of interest. This approach is considered best practice because we can visually inspect if we have found our elements of interest.", "To use this feature type 2 dollar signs, $$, then input the tag and identifier name in quotations within parentheses.", "Now the wrapper have been found, key information within that wrapper needs to be found so we can loop over the wrappers later and extract all the information of interest for each player.", "Shown below, I can clearly see that the player \u2018Mohamad Salah\u2019 is contained within a h2 tag with the class names specified after in blue text in both the browser and the elements tab.", "The Console Utilities API contains a collection of convenience functions for performing common tasks: selecting and inspecting DOM elements and displaying data in readable format.", "As shown, here I perform some quick, but useful validations steps. I know from visually inspecting the page, that there should be 25 players, and indeed the length derived is in fact 25 by using the length function in the console!", "Further to this, lets confirm the names of the players are correct. I want to know if the first element in this 25 elements list is \u2018Mohamad Salah\u2019, so I simply use the console text function and everything seems to be workings as intended.", "Finally, lets confirm that the last player in the list is in fact \u2018Leroy Sane\u2019 I index my search query with the 25th element ([24], owing to Python\u2019s zeroth counting index system), and scroll to the bottom of the web page. Indeed \u2018Leroy Sane\u2019 is the last Player in the list.", "I repeat this process for every piece of data I would like to scrape from this web page, such as the team, goals, assists, and goal ratio.", "To extract, tabulate and transfer to an SQL database, I first need to import the selenium webdriver, the pandas library and the sqlalchemy module.", "The create_engine function from the sqlalchemy module enables interfacing with the database. A connection string is provided, to tell the engine object that we are connecting to the MySQL database.", "I then create a webdriver object and assign it to the variable browser, and navigate to the BBC page using the get method on the browser object.", "I find all the players and their data by using the find_elements_by_css_selector method and input the wrapper found earlier in parentheses. I assign that list to the variable, sensibly called players.", "One of the great advantages of validating elements in the console tab, in the developers tool, is that they can be directly copied and pasted into the \u2018find_element(s)_by_css selector methods, they are valid queries!", "I can now iterate through the players list, and extract key information like goals ect. These can then be appended to a appropriate list. To confirm everything has worked correctly I print out the lists, and strip any text I do not want.", "For example, I want to treat \u2018 140 mins per goal\u2019 as a number later on in my SQL database, so I make sure to trim any padding and \u2018mins per goal\u2019. Finally, although not strictly necessary, I quit the browser, so the pages do not build up, when I check my lists on each iteration.", "To finish, I create a DataFrame by zipping my lists together, and assigning them to sensibly named columns. I then connect to MySQL by filling out the parameters shown in the GitHub gist below.", "I need a table to exist in the underlying database to insert my newly created DataFrame, df into. I write a query in it\u2019s native SQL language to create a table and assign a datatype for each column.", "The query is then executed (the table in MySQL has now been made). Now, all that is left to do, is use the .to_sql method, and insert my DataFrame (df), into the new table called top_players.", "A refresh of the schemas icon reveals that the top_players table has been created. A simple SQL query extracting all the columns from the table shows the selenium-scraped data now resides in an SQL table.", "Finally, lets perform an informative query. It would be of interest to know, which players had both a shot accuracy above 60% and a minutes per goal ratio less than 185. Filtering using the WHERE clause returns the players who fulfill these criteria.", "This tutorial piece has demonstrated how selenium can be used to scrape data, which can then be tabulated into a DataFrame, before being transferred across to an SQL database such as MySQL.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Articles on Data Science and Programming https://github.com/StephenFordham"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F282b2a3fa413&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@stephenfordham?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e----282b2a3fa413---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F282b2a3fa413&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F282b2a3fa413&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jannesglas", "anchor_text": "Jannes Glas"}, {"url": "https://www.bbc.co.uk/sport/football/premier-league/top-scorers", "anchor_text": "Premier League Top Scorers"}, {"url": "https://medium.com/tag/programming?source=post_page-----282b2a3fa413---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----282b2a3fa413---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----282b2a3fa413---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----282b2a3fa413---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----282b2a3fa413---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F282b2a3fa413&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----282b2a3fa413---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F282b2a3fa413&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----282b2a3fa413---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F282b2a3fa413&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F282b2a3fa413&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----282b2a3fa413---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----282b2a3fa413--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----282b2a3fa413--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----282b2a3fa413--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----282b2a3fa413--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/@stephenfordham/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "977 Followers"}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbd4ed43cae00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselenium-and-sql-combined-top-premier-league-players-282b2a3fa413&newsletterV3=5d3f46276e7e&newsletterV3Id=bd4ed43cae00&user=Stephen+Fordham&userId=5d3f46276e7e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}