{"url": "https://towardsdatascience.com/loops-in-bigquery-db137e128d2d", "time": 1683010472.5642009, "path": "towardsdatascience.com/loops-in-bigquery-db137e128d2d/", "webpage": {"metadata": {"title": "Loops in BigQuery. Learn how to use BigQuery scripting to\u2026 | by Bence Komarniczky | Towards Data Science", "h1": "Loops in BigQuery", "description": "A practical example of looping in BigQuery. Learn how to do looping in BigQuery with SQL scripting. Calculate Fibonacci numbers straight in SQL."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/fibonacci-series-with-user-defined-functions-in-bigquery-f72e3e360ce6", "anchor_text": "Fibonacci in BigQuery with JavaScript UDFs", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/fizzbuzz-in-bigquery-e0c4fbc1d195", "anchor_text": "arrays in BigQuery", "paragraph_index": 1}, {"url": "https://niczky12.medium.com/membership", "anchor_text": "here", "paragraph_index": 3}], "all_paragraphs": ["Ever wanted to loop around stuff in SQL? Well, you can with scripting. Let\u2019s see how we can calculate Fibonacci numbers in BigQuery with loops.", "I previously showed how to do Fibonacci in BigQuery with JavaScript UDFs (user-defined functions) and also talked about arrays in BigQuery so if you\u2019re new to BigQuery, check those out first.", "Before we begin calculating Fibonacci numbers, let\u2019s talk about the building blocks of SQL scripting. In programming languages (such as Python) it\u2019s quite natural to set variables with some values and then work with those variables, whereas in SQL you usually start out with some data lurking around in tables.", "For full access to all Medium articles \u2014 including mine \u2014 consider subscribing here.", "With SQL scripting you can declare variables and then use them in calculations, do for loops etc. The gotchas (for those coming from dynamically typed languages) is that you need to declare the type of each variable before you start using them and those types can never ever change.", "With SQL scripting you can declare variables and then use them in calculations, do for loops etc.", "Let\u2019s declare our first variable and print it to the console:", "The steps we did here are:", "If you want to do the declaration and the setting of the variable in one go, you can use the DEFAULT argument as well: DECLARE my_number INT64 DEFAULT 1729;.", "If we want to update our variables then we use the SET keyword again to do so:", "Here, we first set c to be equal to a then we incremented c by b, to get the following:", "Now that we know how to declare and set variables, let\u2019s get looping. First, we need to figure out how our algorithm will work. Here\u2019s one way to make it work:", "This gets us the following result:", "Most of the things are explained in the comments inside the code, but just to clarify:", "The above works, but what if we only need the nth number and not the whole sequence? Then we can do the whole thing without arrays. All we need to do is keep track of are the last 2 numbers in the sequence.", "We removed i from the above and instead, decrement n at each step until we hit 1. At each step we do the following:", "This gives us the last two numbers of the sequence with a < b.", "I\u2019ll leave it to you to figure out what\u2019s going on with that IF statement and why we need it.", "After reading this article, you now know the following:", "Give yourself a pat on the back for learning something new today. Oh and if I said something silly in this article, point it out in the comments. \ud83d\ude09", "For other BigQuery articles on the Fibonacci series and arrays, see these:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist building ML products in ad-tech. I write tutorials on data science\ud83e\uddd1\u200d\ud83d\udd2c, machine learning \ud83e\udd16, Julia and cloud computing \u2601\ufe0f."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdb137e128d2d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----db137e128d2d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db137e128d2d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://niczky12.medium.com/?source=post_page-----db137e128d2d--------------------------------", "anchor_text": ""}, {"url": "https://niczky12.medium.com/?source=post_page-----db137e128d2d--------------------------------", "anchor_text": "Bence Komarniczky"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F29f55325f60b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&user=Bence+Komarniczky&userId=29f55325f60b&source=post_page-29f55325f60b----db137e128d2d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb137e128d2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb137e128d2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@daisybisley?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Claire Satera"}, {"url": "https://unsplash.com/s/photos/loop?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/fibonacci-series-with-user-defined-functions-in-bigquery-f72e3e360ce6", "anchor_text": "Fibonacci in BigQuery with JavaScript UDFs"}, {"url": "https://towardsdatascience.com/fizzbuzz-in-bigquery-e0c4fbc1d195", "anchor_text": "arrays in BigQuery"}, {"url": "https://niczky12.medium.com/membership", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Interesting_number_paradox", "anchor_text": "1729"}, {"url": "https://tenor.com/view/rick-and-morty-poopybutthole-oooweee-meme-chalkboard-gif-16063441", "anchor_text": "SOURCE"}, {"url": "https://unsplash.com/@superwillyfoc?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Guillermo Latorre"}, {"url": "https://unsplash.com/s/photos/applause?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/fibonacci-series-with-user-defined-functions-in-bigquery-f72e3e360ce6", "anchor_text": "Fibonacci series in BigQueryUsing user-defined JavaScript functions inside BigQuery to calculate Fibonaccitowardsdatascience.com"}, {"url": "https://towardsdatascience.com/fizzbuzz-in-bigquery-e0c4fbc1d195", "anchor_text": "FizzBuzz in BigQueryFizzBuzz in BigQuery, not Java or Python, in BigQuery. Using SQL, cause why not?towardsdatascience.com"}, {"url": "https://medium.com/tag/bigquery?source=post_page-----db137e128d2d---------------bigquery-----------------", "anchor_text": "Bigquery"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----db137e128d2d---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/programming?source=post_page-----db137e128d2d---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/sql?source=post_page-----db137e128d2d---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----db137e128d2d---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb137e128d2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&user=Bence+Komarniczky&userId=29f55325f60b&source=-----db137e128d2d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb137e128d2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&user=Bence+Komarniczky&userId=29f55325f60b&source=-----db137e128d2d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb137e128d2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db137e128d2d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdb137e128d2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----db137e128d2d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----db137e128d2d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----db137e128d2d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----db137e128d2d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----db137e128d2d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----db137e128d2d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----db137e128d2d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----db137e128d2d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----db137e128d2d--------------------------------", "anchor_text": ""}, {"url": "https://niczky12.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://niczky12.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bence Komarniczky"}, {"url": "https://niczky12.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "410 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F29f55325f60b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&user=Bence+Komarniczky&userId=29f55325f60b&source=post_page-29f55325f60b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3891999cdd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floops-in-bigquery-db137e128d2d&newsletterV3=29f55325f60b&newsletterV3Id=3891999cdd4&user=Bence+Komarniczky&userId=29f55325f60b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}