{"url": "https://towardsdatascience.com/named-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede", "time": 1682994178.709653, "path": "towardsdatascience.com/named-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede/", "webpage": {"metadata": {"title": "Named Entity Recognition (NER) with keras and tensorflow | by Nasir Safdari | Towards Data Science", "h1": "Named Entity Recognition (NER) with keras and tensorflow", "description": "Few years ago when I was working as a software engineering intern at a startup, I saw a new feature in a job posting web-app. The app was able to recognize and parse important information form the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/explore-artificial-intelligence/introduction-to-named-entity-recognition-eda8c97c2db1", "anchor_text": "Here is a more detailed intro to NER by Suvro.", "paragraph_index": 1}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "link", "paragraph_index": 3}, {"url": "https://www.depends-on-the-definition.com/sequence-tagging-lstm-crf/", "anchor_text": "implementation", "paragraph_index": 5}, {"url": "https://www.depends-on-the-definition.com/lstm-with-char-embeddings-for-ner/", "anchor_text": "implementation", "paragraph_index": 6}, {"url": "https://arxiv.org/pdf/1802.05365.pdf", "anchor_text": "papers", "paragraph_index": 8}, {"url": "https://allennlp.org/elmo", "anchor_text": "representations", "paragraph_index": 8}, {"url": "https://allennlp.org/elmo", "anchor_text": "ELMo", "paragraph_index": 12}, {"url": "https://tfhub.dev/google/elmo/2", "anchor_text": "Benchmark", "paragraph_index": 12}, {"url": "https://www.kaggle.com/abhinavwalia95/entity-annotated-corpus/home", "anchor_text": "dataset", "paragraph_index": 12}, {"url": "https://github.com/nxs5899/Named-Entity-Recognition_DeepLearning-keras", "anchor_text": "Github", "paragraph_index": 27}], "all_paragraphs": ["Few years ago when I was working as a software engineering intern at a startup, I saw a new feature in a job posting web-app. The app was able to recognize and parse important information form the resumes like, email address, phone number, degree titles and etc. I started discussing possible approaches with our team and we decided to build a rule based parser in python to just parse different sections of a resume. After spending some time developing the parser, we realized that the answer may not be a rule-based tool. We started googling how it\u2019s done and we came across the term Natural Language Processing (NLP) and more specific, Named Entity Recognition (NER) associated with Machine Learning.", "NER is an information extraction technique to identify and classify named entities in text. These entities can be pre-defined and generic like location names, organizations, time and etc, or they can be very specific like the example with the resume. NER has a wide variety of use cases in the business. I think gmail is applying NER when you are writing an email and you mention a time in your email or attaching a file, gmail offers to set a calendar notification or remind you to attach the file in case you are sending the email without an attachment. Other applications of NER include: extracting important named entities from legal, financial, and medical documents, classifying content for news providers, improving the search algorithms, and etc. For the rest of this article, we are going to have a short intro to different approaches to tackle NER problem and then we will jump into coding the state-of-the-art method. Here is a more detailed intro to NER by Suvro.", "Before discussing details about Deep Learning approaches (state-of-the-art) to NER, we need to analyze proper and clear metrics to evaluate the performance of our models. It is common to use accuracy while training a neural network in different iterations (epochs) as an evaluation metric. However, in case of NER, we might be dealing with important financial, medical, or legal documents and precise identification of named entities in those documents determines the success of the model. In other words, false positives and false negatives have a business cost in a NER task. Therefore, our main metric to evaluate our models will be F1 score because we need a balance between precision and recall.", "Another important strategy in building a high-performing deep learning method is understanding which type of neural network works best to tackle NER problem considering that the text is a sequential data format. yeah, you guessed it right\u2026 Long short Term Memory (LSTM). more details about LSTMs in this link. But not any type of LSTM, we need to use bi-directional LSTMs because using a standard LSTM to make predictions will only take the \u201cpast\u201d information in a sequence of the text into account. for NER, since the context covers past and future labels in a sequence, we need to take both the past and the future information into account. A bidirectional LSTM is a combination of two LSTMs \u2014 one runs forward from \u201cright to left\u201d and one runs backward from \u201cleft to right\u201d.", "we are going to have a quick look at the architecture of four different state-of-the-art approaches by referring to the actual research paper and then we will move on to implement the one with the highest accuracy.", "More details and implementation in keras.", "More details and implementation in keras.", "4. ELMo (Embedding from Language Models ):", "one of the very recent papers (Deep contextualized word representations) introduces a new type of deep contextualized word representation that models both complex characteristics of word use (e.g., syntax and semantics), and how these uses vary across linguistic contexts (i.e., to model polysemy). the new approach (ELMo) has three important representations:", "1. Contextual: The representation for each word depends on the entire context in which it is used.", "2. Deep: The word representations combine all layers of a deep pre-trained neural network.", "3. Character based: ELMo representations are purely character based, allowing the network to use morphological clues to form robust representations for out-of-vocabulary tokens unseen in training.", "ELMo has a great understanding of the language because it\u2019s trained on a massive dataset, ELMo embeddings are trained on the 1 Billion Word Benchmark. the training is called bidirectional language model (biLM) that can learn from the past and predict the next word in a sequence of words like a sentence. Let\u2019s see how we can implement this approach. we are going to use a dataset from kaggle.", "we have 47958 sentences in our dataset, 35179 different words and 17 different named entities (Tags).", "Let\u2019s have a look at the distribution of the sentence lengths in the dataset:", "this Class is in charge of converting every sentence with its named entities (tags) into a list of tuples [(word, named entity), \u2026]", "so the longest sentence has 140 words in it and we can see that almost all of the sentences have less than 60 words in them.", "One of the biggest benefits of this approach is that we dont need any feature engineering; all we need is the sentences and its labeled words, the rest of the work is carried on by ELMo embeddings. In order to feed our sentences into a LSTM network, they all need to be the same size. looking at the distribution graph, we can set the length of all sentences to 50 and add a generic word for the empty spaces; this process is called padding.(another reason that 50 is a good number is that my laptop cannot handle longer sentences).", "and the same applies for the named entities but we need to map our labels to numbers this time:", "next we split our data into training and testing set and then we import tensorflow Hub ( a library for the publication, discovery, and consumption of reusable parts of machine learning models) to load the ELMo embedding feature and keras to start building our network.", "Running above block of code for the first time will take some time because ELMo is almost 400 MB. next we use a function to convert our sentences to ELMo embeddings:", "now let\u2019s build our neural network:", "since we have 32 as the batch size, feeding the network must be in chunks that are all multiples of 32:", "The initial goal was to play around with parameter tuning to achieve higher accuracy but my laptop was not able to handle more than 3 epochs and batch sizes bigger than 32 or increasing the test size. I am running keras on a Geforce GTX 1060 and it took almost 45 minutes to train those 3 epochs, if you have a better GPU, give it shot by changing some of those parameters.", "0.9873 validation accuracy is a great score, however we are not interested to evaluate our model with Accuracy metric. Let\u2019s see how we can get Precision, Recall, and F1 scores:", "0.82 F1 score is an outstanding achievement. it beats all the other three deep learning methods mentioned at the beginning of this section and it can be easily adapted by the industry.", "finally, let\u2019s see how our predictions look like:", "like always, the code and jupyter notebook is available on my Github.", "Questions and Comments are highly appreciated.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Open Source is the solution\u2026 Software Engineer, Data Scientist and Machine Learning Researcher"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F698d2b3b4ede&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nasir.ahmad.safdari?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nasir.ahmad.safdari?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": "Nasir Safdari"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb875ac73beb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&user=Nasir+Safdari&userId=b875ac73beb&source=post_page-b875ac73beb----698d2b3b4ede---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F698d2b3b4ede&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F698d2b3b4ede&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/explore-artificial-intelligence/introduction-to-named-entity-recognition-eda8c97c2db1", "anchor_text": "Here is a more detailed intro to NER by Suvro."}, {"url": "https://www.youtube.com/watch?v=LFXsG7fueyk", "anchor_text": "video"}, {"url": "https://www.depends-on-the-definition.com/named-entity-recognition-conditional-random-fields-python/", "anchor_text": "Tobias\u2019s"}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "link"}, {"url": "https://arxiv.org/pdf/1508.01991v1.pdf", "anchor_text": "Bidirectional LSTM-CRF"}, {"url": "https://www.depends-on-the-definition.com/sequence-tagging-lstm-crf/", "anchor_text": "implementation"}, {"url": "https://arxiv.org/pdf/1511.08308.pdf", "anchor_text": "2. Bidirectional LSTM-CNNs"}, {"url": "https://www.depends-on-the-definition.com/lstm-with-char-embeddings-for-ner/", "anchor_text": "implementation"}, {"url": "https://arxiv.org/pdf/1603.01354.pdf", "anchor_text": "3. Bidirectional LSTM-CNNS-CRF:"}, {"url": "https://jalammar.github.io/illustrated-bert/", "anchor_text": "Jay Alamma"}, {"url": "https://jalammar.github.io/illustrated-bert/", "anchor_text": "Jay Alammar"}, {"url": "https://arxiv.org/pdf/1802.05365.pdf", "anchor_text": "papers"}, {"url": "https://allennlp.org/elmo", "anchor_text": "representations"}, {"url": "https://allennlp.org/elmo", "anchor_text": "ELMo"}, {"url": "https://tfhub.dev/google/elmo/2", "anchor_text": "Benchmark"}, {"url": "https://www.kaggle.com/abhinavwalia95/entity-annotated-corpus/home", "anchor_text": "dataset"}, {"url": "https://tfhub.dev/google/elmo/2", "anchor_text": "https://tfhub.dev/google/elmo/2"}, {"url": "https://github.com/nxs5899/Named-Entity-Recognition_DeepLearning-keras", "anchor_text": "Github"}, {"url": "https://www.depends-on-the-definition.com/named-entity-recognition-with-residual-lstm-and-elmo/", "anchor_text": "https://www.depends-on-the-definition.com/named-entity-recognition-with-residual-lstm-and-elmo/"}, {"url": "http://www.wildml.com/2016/08/rnns-in-tensorflow-a-practical-guide-and-undocumented-features/", "anchor_text": "http://www.wildml.com/2016/08/rnns-in-tensorflow-a-practical-guide-and-undocumented-features/"}, {"url": "https://allennlp.org/elmo", "anchor_text": "https://allennlp.org/elmo"}, {"url": "https://jalammar.github.io/illustrated-bert/", "anchor_text": "https://jalammar.github.io/illustrated-bert/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----698d2b3b4ede---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/named-entity-recognition?source=post_page-----698d2b3b4ede---------------named_entity_recognition-----------------", "anchor_text": "Named Entity Recognition"}, {"url": "https://medium.com/tag/lstm?source=post_page-----698d2b3b4ede---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/keras?source=post_page-----698d2b3b4ede---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/nlp?source=post_page-----698d2b3b4ede---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F698d2b3b4ede&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&user=Nasir+Safdari&userId=b875ac73beb&source=-----698d2b3b4ede---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F698d2b3b4ede&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&user=Nasir+Safdari&userId=b875ac73beb&source=-----698d2b3b4ede---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F698d2b3b4ede&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F698d2b3b4ede&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----698d2b3b4ede---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----698d2b3b4ede--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nasir.ahmad.safdari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nasir.ahmad.safdari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nasir Safdari"}, {"url": "https://medium.com/@nasir.ahmad.safdari/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "305 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb875ac73beb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&user=Nasir+Safdari&userId=b875ac73beb&source=post_page-b875ac73beb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdde46cf682&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-meeting-industrys-requirement-by-applying-state-of-the-art-deep-698d2b3b4ede&newsletterV3=b875ac73beb&newsletterV3Id=dde46cf682&user=Nasir+Safdari&userId=b875ac73beb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}