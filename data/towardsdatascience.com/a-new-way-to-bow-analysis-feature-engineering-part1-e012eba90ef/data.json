{"url": "https://towardsdatascience.com/a-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef", "time": 1683015144.986161, "path": "towardsdatascience.com/a-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef/", "webpage": {"metadata": {"title": "A new way to BOW Analysis & Feature Engg . | NLP | Towards Data Science", "h1": "A New Way to BOW Analysis & Feature Engineering \u2014 Part1", "description": "Making use of Non-parametric tests to compare the bag of words across the categories and for feature selection in natural language processing related tasks."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@prateekkrjain/a-new-way-to-bow-analysis-feature-engineering-part2-451d586566c6", "anchor_text": "Part 2 of the analysis.", "paragraph_index": 32}, {"url": "https://www.kaggle.com/pikkupr/a-new-way-to-bow-analysis-and-feature-engg", "anchor_text": "https://www.kaggle.com/pikkupr/a-new-way-to-bow-analysis-and-feature-engg", "paragraph_index": 33}], "all_paragraphs": ["One of my friends asked me a problem \u2014 \u201chow can we compare the BOW across different categories or labels? Where categories or labels could be sentiment or state or some customer segment.", "My intuitive response was \u2014 to create a Bar graph of the frequency of words for each category. This really is a simple to implement solution, but have various drawbacks, some of which are:", "Then the next idea was to create a Word Cloud, but even it does not solve the above-mentioned problem.", "After thinking for a while I knew that solution lies in comparing the frequencies across the categories, but could not find the answer in One-Hot Encoding or Count Vectorizing or TF-IDF as there is a common issue in using any of these.", "The issue is these create features and their values, for each of the documents, and then how can we roll these up at the label/category level? Even let\u2019s take the case of Count Vectorizer \u2014 we will get the frequencies of words present in each document \u2014 but to do any analysis at the label/category level we will be required to sum up the counts and roll up to category level. Once we roll up, we can definitely make the difference in frequencies of words across labels but again \u2014 it won\u2019t solve the third issue mentioned above. That is if the difference of frequency of word \u2018data\u2019 is 50, what does it tell us? Is this even significant?", "Now, you can guess where are we headed \u2014 we have differences in frequencies and we want to know if the differences are significant or not. With this comes the STATISTICS to our rescue.", "I am assuming you are aware of the various tests like z-test, t-test, ANOVA, etc. We use these tests to compare multiple means or distributions, which aligns with the problem we are trying to solve here.", "The below table contains the frequency of a word across the labels \u2014 Target-0 and Target-1., which is nothing but the distributions. We can easily use the tests like z-test, t-test, etc. and compare these distributions and if the difference turns out to be significant (given the significance level) we can say that such words have different distributions across the labels and hence, can be the distinguishing factors in the model.", "So, this way we can even use this technique for feature engineering and reduce the number of features in our models.", "Easy right? Yes, indeed only after we have taken care of one last point.", "The z-test, t-test, or ANCOVA are parametric tests, meaning they make an assumption about the data and one such main assumption is that the data to be normally distributed.", "But, this assumption may or may not hold true for all the features/words in the dataset. So, we will have to rely on some Non-parametric tests which do not make any such assumptions.", "And we have few such tests and the only we will use is \u2014 Mann Whitney U test. This test compares two distributions at a time and is ideal for the cases where we have Binomial labels and in case of Multinomial we can use \u2014 Kruskal-Wallis test.", "Kruskal-Wallis test is similar to ANOVA which tells us whether the distribution across the labels is the same or not and it does not tell distributions of which labels differ and to get the same we can apply pair-wise Mann Whitney U test.", "Let\u2019s apply all the learning and for the same \u2014 Disaster Tweets Classification dataset from Kaggle has been used.", "Now, we will convert the sentences in our dataset to Bag of words using CrazyTokenizer. Also, some additional cleaning is done in the below preprocessor function.", "This function will be passed to CountVectorizer which will give out the frequency of words in each of the records in the input dataset.", "let\u2019s now also bring the target variable along with the features.", "Now, we will be plotting a bar graph displaying the top 30 words belonging to each of the target values.", "I have highlighted two words in the above chart \u2014 \u2018fire\u2019 & \u2018emergency\u2019. For the word \u2018fire\u2019 the difference in frequencies between the targets is huge (~180), while the difference is very very small in the case of the word \u2018emergency\u2019.", "As we discussed above, our aim is to identify if these differences are even significant or not and this matters because both the words appeared in sentences across both the target values. We want to know does it make these features insignificant i.e. whether they have a say or not in deciding if a sentence belongs to Target-0 or Target-1.", "Below is the result of the Mann-Whitney U test for the word \u2014 \u2018fire\u2019.", "From the test we got the p-value of ~0 which is less than 0.05 (our significance level), hence we can conclude that the frequency distributions of the \u2018fire\u2019 are significantly different across the target values (with 95% confidence).", "Let\u2019s also look at the same for \u2014 \u2018emergency\u2019.", "Here, the p-value is 0.07 which is greater than the significance level of 0.05, hence we can conclude that the frequency distributions of \u2018emergency\u2019 are similar with 95% confidence.", "Now, it's time for the desert \u2014 meaning let\u2019s look at the words which have significantly different distributions across the targets, the problem we wanted to solve.", "The below code will apply the Mann Whitney U test for all the words in the dataset and will keep a record of those words which had different distributions. Also, will be plotting such 50 words.", "As we can observe from the above chart that there are words that appear in both the target values but the difference in frequencies is significant.", "We are also left with only 451 words out of 633, which is like 71% of the original features and hence this can be used as one of the techniques for feature selection.", "I also plotted the difference of 0.05 and the p-value of the above words. So, the words having y-axis value closer to 0 will indicate that their p-value was closer to the level of significance and hence comparatively will be less important than the ones whose value on the y-axis is closer to 0.05 as this indicates that their p-value was close to 0.", "There are words like \u2014 \u2018ago\u2019, \u2018big\u2019, \u2018blue\u2019 having lower significance in comparison to others.", "This is all for the analysis for now. I will be writing another article soon, in which I will be building two models one with all the features and the other with only the significant words, and will compare the accuracies of both the mode.", "Update: Please follow the link for Part 2 of the analysis.", "The code of the above analysis can be found on Kaggle and can be accessed via \u2014 https://www.kaggle.com/pikkupr/a-new-way-to-bow-analysis-and-feature-engg", "Hope you find my work above valuable and please do share your opinions about this methodology and if there are any suggestions to improve the same, please do comment as I would love to hear your thoughts :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Applied Scientist | Mentor | AI Artist | NFTs"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe012eba90ef&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e012eba90ef--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e012eba90ef--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://prateekkrjain.medium.com/?source=post_page-----e012eba90ef--------------------------------", "anchor_text": ""}, {"url": "https://prateekkrjain.medium.com/?source=post_page-----e012eba90ef--------------------------------", "anchor_text": "Prateek Jain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F755ac4f02f95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&user=Prateek+Jain&userId=755ac4f02f95&source=post_page-755ac4f02f95----e012eba90ef---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe012eba90ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe012eba90ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lukechesser?utm_source=medium&utm_medium=referral", "anchor_text": "Luke Chesser"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@prateekkrjain/a-new-way-to-bow-analysis-feature-engineering-part2-451d586566c6", "anchor_text": "Part 2 of the analysis."}, {"url": "https://www.kaggle.com/pikkupr/a-new-way-to-bow-analysis-and-feature-engg", "anchor_text": "https://www.kaggle.com/pikkupr/a-new-way-to-bow-analysis-and-feature-engg"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----e012eba90ef---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/statistical-analysis?source=post_page-----e012eba90ef---------------statistical_analysis-----------------", "anchor_text": "Statistical Analysis"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e012eba90ef---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----e012eba90ef---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e012eba90ef---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe012eba90ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&user=Prateek+Jain&userId=755ac4f02f95&source=-----e012eba90ef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe012eba90ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&user=Prateek+Jain&userId=755ac4f02f95&source=-----e012eba90ef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe012eba90ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e012eba90ef--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe012eba90ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e012eba90ef---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e012eba90ef--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e012eba90ef--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e012eba90ef--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e012eba90ef--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e012eba90ef--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e012eba90ef--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e012eba90ef--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e012eba90ef--------------------------------", "anchor_text": ""}, {"url": "https://prateekkrjain.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://prateekkrjain.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Prateek Jain"}, {"url": "https://prateekkrjain.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F755ac4f02f95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&user=Prateek+Jain&userId=755ac4f02f95&source=post_page-755ac4f02f95--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F755ac4f02f95%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-new-way-to-bow-analysis-feature-engineering-part1-e012eba90ef&user=Prateek+Jain&userId=755ac4f02f95&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}