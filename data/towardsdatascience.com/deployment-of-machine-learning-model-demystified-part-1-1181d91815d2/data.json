{"url": "https://towardsdatascience.com/deployment-of-machine-learning-model-demystified-part-1-1181d91815d2", "time": 1683001589.7866502, "path": "towardsdatascience.com/deployment-of-machine-learning-model-demystified-part-1-1181d91815d2/", "webpage": {"metadata": {"title": "Deployment of Machine learning Models Demystified (Part 1) | by Opeyemi Bamigbade | Towards Data Science", "h1": "Deployment of Machine learning Models Demystified (Part 1)", "description": "Imagine building a supervised machine learning(ML) model to decide whether a loan application should be approved. With the model confidence level (probability) in successful applications, we can\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@bamigbadeopeyemi/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "second part after this", "paragraph_index": 0}, {"url": "https://bit.ly/2qKwbe7", "anchor_text": "Click to download", "paragraph_index": 8}, {"url": "https://medium.com/@bamigbadeopeyemi/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "second part after this", "paragraph_index": 29}, {"url": "https://medium.com/@bamigbadeopeyemi/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "second part after this", "paragraph_index": 37}, {"url": "https://medium.com/@bamigbadeopeyemi/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "second part after this", "paragraph_index": 40}, {"url": "https://twitter.com/opeyemibami", "anchor_text": "Twitter", "paragraph_index": 43}, {"url": "https://www.linkedin.com/in/bamigbade-opeyemi-49007a122/", "anchor_text": "LinkedIn", "paragraph_index": 43}, {"url": "https://opeyemibami.github.io/yhemmy/", "anchor_text": "https://opeyemibami.github.io/yhemmy/", "paragraph_index": 48}], "all_paragraphs": ["This is the first part of a two-part series. you can read the second part after this", "Imagine building a supervised machine learning(ML) model to decide whether a loan application should be approved. With the model confidence level (probability) in successful applications, we can calculate the risk-free loanable amount. The deployment of such ML-model is the goal of this project.", "Join me as I walk you through my internship project at Data Science Nigeria where I have been opportune to work alongside cr\u00e8me de la cr\u00e8me of Data Scientists, Software Engineers and Researchers in Artificial intelligence. The goal is to raise 1 million Ai talent in 10 years which am proud to be part of.", "Whereas data scientists build Machine learning models in jupyter lab, google colab and the likes, Machine learning engineers take the built model into production.", "Deployment of an ML-model simply means the integration of the model into an existing production environment which can take in an input and return an output that can be used in making practical business decisions.", "To demystify the deployment process, I created this post which is split into four chapters. In chapter 1, we cover the process of building a baseline model and in chapter 2, we adopt this model intro production-ready code. Chapters 3 and 4 are covered in Part 2 of this series.", "Chapter 1: Building a base-line model", "A base-line model in this context refers to an ML-model having the minimum possible number of features but with good evaluation measures. When building an ML-model for deployment purposes, you must always have your end-users in mind. A model with thousands of features to attain an accuracy 90+% on evaluation might not be good enough for deployment for several reasons:", "Click to download the dataset that will be used for this project, the notebook and the exclusive summary that contain Exploratory Data Analysis, Data Preprocessing, Feature Engineering, Feature Selection, Training the ML model and Model Evaluation.", "As a first step, we use pandas to import our test and training data.", "Data Preprocessing: This involves the transformation of raw data into an understandable format suitable to train a model. It entails taking care of missing values, outliers, encoding categorical variables.", "For the purpose of deployment, you want to always keep a record of the values you are using to fill the missing values and the approach has to be replicable. Features having missing values can be seen at a glance with the code snippets below", "There are many ways you can take care of the missing values in numerical features but to keep things simple, I will experiment with the mean and the median.", "For each of the numerical features with missing values, you compute the mean and the median, impute this value and fit a model on the data to see the effect for each case on the validation sets. For instance, experimenting with the applicant_income feature, we can define a simple python function that takes in the dataframe, variable of interest, mean and median and fill the missing parts of the features with the mean and median.", "A simple feature engineering that can be done when filling missing values is to create a binary feature that indicates missingness (0 or 1) and you can tell if the missingness has a positive predict effect or not.", "Now, we can use a simple logistic regression model to determine the best approach to filling missing values.", "This approach is repeated for all the features with missing values and the best decision is made based on the model outcome.", "Feature Engineering: this is the process of using domain knowledge of the data to create features that make machine algorithms work. The only feature I will create is income_loan_ratio to avoid complexity during deployment.", "Feature Selection: Is the process where you automatically or manually select those features which contribute most to your prediction variable. Having irrelevant features in your data can decrease the accuracy of the models.", "There are several methods of selecting features for the final model which include", "Filter methods such as constant features elimination, quasi-constant features elimination, duplicate feature elimination, fisher score, univariate method, mutual information, correlation, etc.", "Wrapper methods such as step forward selection, step backward selection and exhaustive search etc.", "Embedded methods such as LASSO, Decision tree derived importance, Regression coefficients etc.", "Training the ML model: the type of machine learning algorithm for this project is supervised and it is a classification model. Before training the model, we need to separate the features from the target variable.", "I have chosen to use GradientBoostingClassifier from sklearn for deployment but other algorithms such as xgboost, Microsoft LGBM were also explored during the experiment.", "From the output of the trained model above, the accuracy on test data is 70.3% with ROC-AUC of 77.2%. Since the goal of this project is to predict the acceptance status of mortgages applications and also to predict the safe amount on accepted loan applications, 70% accuracy is good enough for the problem case Scenario. The model can be improved later but we will not be focusing on that because we want to make deployment as simple as possible for now.", "Chapter 2: Adopting an ML System Architecture and Writing Production-Ready Codes", "According to ISO/IEC 42010 and I paraphrase, Architecture can be defined as the way software components are arranged and the interactions between them.", "ML system architecture refers to the way in which the software components that makeup system are arranged and the interaction between them in achieving a predefined goal. The development and deployment of ML-models are relatively fast and cheap but maintaining them effectively over time is difficult and expensive. Depending on your company\u2019s capacity and goal, choosing the best architecture might be a bit challenging as it requires the synchronisation of the business, data science, engineering and DevOps.", "This is the first part of a two-part series. you can read the second part after this", "When designing an ML system architecture, the following should be borne in mind.", "For this project, pattern 1 will be used and the predictions can be single or in batches, i.e we will be training the model locally and expose the predict function via flask where we can upload our test batch for prediction.", "In the figure above, it can be seen that the whole system is divided into development and production. in the development, the Training Data, Feature Extractor and Model Builder section are done offline while production is online.", "Training Data: this unit deals with the extraction of the dataset to be used in training the model into the training environment and formatting for training. this unit can be complex or simple depending on the ML-architecture you are working on.This can include pulling of data from multiple Sequels, Hadoop distributed file system or make API calls, for the purpose of this project, a simple python script will be written to fetch the dataset already downloaded into a folder/directory to the training environment and then passed through a data pipeline where several preprocessing will be done before training.", "Feature Extractor: this is the unit that selects/generates essential features needed in training the model. note that this is part of the pipeline uses sklearn. apart from the sklearn library, another popular library that can be used to achieve the same task is TensorFlow Extended(TFX)which is out of the scope of this article.", "Model Builder: this is the unit where serializing and persisting of the trained models, versioning and formatting for deployment. In python context, this can be the unit that involves in package building using setuptools or simply saving the model in a pickle format depending on the architecture you adopt. there is a huge difference between these approaches but will not be discussing it in this article. though I experimented with both approaches but will be sharing with you the latter approach so as to keep things simple.", "Trained model: this is the output of the three sub-topics discussed above which can be easily deployed via REST API.", "This is the first part of a two-part series. you can read the second part after this", "In production, a request is sent via REST API in batches, cleaned and preprocessed by the Feature Extractor, then the loaded trained model is used in predicting if the loan application is accepted or not. the accepted loans are then further analysed for risk-free loanable amount before returning the prediction through our end-point.", "In Part 2(chapters 3 & 4), I will be discussing how to convert the notebook into production ready-code, and how to create a reproducible pipeline, API endpoints, testing the end-points through Postman, meaning and use of CI/CD in ML-System Architectures, Deploy to a Pass, Docker Container, Deploying to Lass, Serverless Deployment etc.", "This is the first part of a two-part series. you can read the second part after this", "You can clone the Github repository via the link below:", "There are lots of ways to deploy ML-models into production, numerous ways to store them and different ways to manage predictive models after deployment. choosing the best approach to a use case can be challenging but with the team\u2019s technical and analytics maturity, the overall organization structure and its interactions can help in selecting the right approach for deploying predictive models to production.", "Connect with me on Twitter and LinkedIn", "Do find time check out my other articles and further readings in the reference section. Kindly remember to follow me so as to get notified of my publications.", "For other approaches to model deployment strategies, you can checkout NeptuneAi post via the link below:", "Special thanks to my mentors (Dr.Olubayo Adekanmbi, James Allingham ), wuraola oyewusi and the entire staff of Data Science Nigeria.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD Fellow | ML-Engineer | Data Scientist | Software Engineer https://opeyemibami.github.io/yhemmy/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1181d91815d2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1181d91815d2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1181d91815d2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://opeyemibami.medium.com/?source=post_page-----1181d91815d2--------------------------------", "anchor_text": ""}, {"url": "https://opeyemibami.medium.com/?source=post_page-----1181d91815d2--------------------------------", "anchor_text": "Opeyemi Bamigbade"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22af4904d21e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&user=Opeyemi+Bamigbade&userId=22af4904d21e&source=post_page-22af4904d21e----1181d91815d2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1181d91815d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1181d91815d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://blogs.oracle.com/r/data-science-maturity-model-deployment-part-11", "anchor_text": "https://blogs.oracle.com/r/data-science-maturity-model-deployment-part-11"}, {"url": "https://medium.com/@bamigbadeopeyemi/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "second part after this"}, {"url": "https://bit.ly/2qKwbe7", "anchor_text": "Click to download"}, {"url": "https://medium.com/@bamigbadeopeyemi/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "second part after this"}, {"url": "https://www.udemy.com/course/deployment-of-machine-learning-models/", "anchor_text": "https://www.udemy.com/course/deployment-of-machine-learning-models/"}, {"url": "https://www.udemy.com/course/deployment-of-machine-learning-models/", "anchor_text": "https://www.udemy.com/course/deployment-of-machine-learning-models/"}, {"url": "https://medium.com/@bamigbadeopeyemi/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "second part after this"}, {"url": "https://medium.com/@bamigbadeopeyemi/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "second part after this"}, {"url": "https://github.com/opeyemibami/machine_learning-Deployment-of-Mortage-Approval-Status-Model", "anchor_text": "opeyemibami/machine_learning-Deployment-of-Mortage-Approval-Status-ModelContribute to opeyemibami/machine_learning-Deployment-of-Mortage-Approval-Status-Model development by creating an\u2026github.com"}, {"url": "https://twitter.com/opeyemibami", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/bamigbade-opeyemi-49007a122/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/@opeyemibami/deployment-of-machine-learning-models-demystified-part-2-63eadaca1571", "anchor_text": "Deployment of Machine learning Models Demystified (Part 2)Loan acceptance status prediction with risk-free loanable amountmedium.com"}, {"url": "https://heartbeat.fritz.ai/building-a-conversational-chatbot-with-nltk-and-tensorflow-part-1-f452ce1756e5", "anchor_text": "Building a Conversational Chatbot with NLTK and TensorFlow (Part 1)A Tennis Chatbot built with Convolutional Neural Networksheartbeat.fritz.ai"}, {"url": "https://heartbeat.fritz.ai/building-a-conversational-chatbot-with-nltk-and-tensorflow-part-2-c67b67d8ebb", "anchor_text": "Building a Conversational Chatbot with NLTK and TensorFlow (Part 2)A Tennis Chatbot built with Convolutional Neural Networksheartbeat.fritz.ai"}, {"url": "https://heartbeat.fritz.ai/deploy-a-machine-learning-model-as-a-web-application-part-1-a1c1ff624f7a", "anchor_text": "Deploy a Machine Learning Model as a Web Application (Part 1)Machine Learning-Powered Web Application with Streamlitheartbeat.fritz.ai"}, {"url": "https://heartbeat.fritz.ai/deploy-a-machine-learning-model-as-a-web-application-part-2-2f590342b390", "anchor_text": "Deploy a Machine Learning Model as a Web Application (Part 2)Machine Learning-Powered Web Application with Streamlitheartbeat.fritz.ai"}, {"url": "https://heartbeat.fritz.ai/deploying-machine-learning-models-on-google-cloud-platform-gcp-7b1ff8140144", "anchor_text": "Deploying Machine Learning Models on Google Cloud Platform (GCP)Train on Kaggle; deploy on Google Cloudheartbeat.fritz.ai"}, {"url": "https://medium.com/towards-artificial-intelligence/topic-modeling-open-source-tool-fbdcc06f43f6", "anchor_text": "Topic Modeling Open Source ToolA tool built with python and streamlit for topic modellingmedium.com"}, {"url": "https://neptune.ai/blog/model-deployment-strategies", "anchor_text": "https://neptune.ai/blog/model-deployment-strategies"}, {"url": "https://medium.com/@julienkervizic?source=post_page-----c699b34abf86----------------------", "anchor_text": "Julien Kervizic"}, {"url": "https://blogs.oracle.com/author/mark-hornick", "anchor_text": "Mark Hornick"}, {"url": "https://www.udemy.com/course/deployment-of-machine-learning-models/#instructor-1", "anchor_text": "Soledad Galli"}, {"url": "https://www.udemy.com/course/deployment-of-machine-learning-models/#instructor-2", "anchor_text": "Christopher Samiullah"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1181d91815d2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1181d91815d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&user=Opeyemi+Bamigbade&userId=22af4904d21e&source=-----1181d91815d2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1181d91815d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&user=Opeyemi+Bamigbade&userId=22af4904d21e&source=-----1181d91815d2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1181d91815d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1181d91815d2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1181d91815d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1181d91815d2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1181d91815d2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1181d91815d2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1181d91815d2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1181d91815d2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1181d91815d2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1181d91815d2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1181d91815d2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1181d91815d2--------------------------------", "anchor_text": ""}, {"url": "https://opeyemibami.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://opeyemibami.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Opeyemi Bamigbade"}, {"url": "https://opeyemibami.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "354 Followers"}, {"url": "https://opeyemibami.github.io/yhemmy/", "anchor_text": "https://opeyemibami.github.io/yhemmy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22af4904d21e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&user=Opeyemi+Bamigbade&userId=22af4904d21e&source=post_page-22af4904d21e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F26890a952edf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeployment-of-machine-learning-model-demystified-part-1-1181d91815d2&newsletterV3=22af4904d21e&newsletterV3Id=26890a952edf&user=Opeyemi+Bamigbade&userId=22af4904d21e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}