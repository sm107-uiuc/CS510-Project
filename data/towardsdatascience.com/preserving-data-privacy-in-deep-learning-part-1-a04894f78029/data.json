{"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029", "time": 1683010404.605629, "path": "towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-1-a04894f78029/", "webpage": {"metadata": {"title": "Federated Learning using Pytorch | Towards Data Science", "h1": "Preserving Data Privacy in Deep Learning | Part 1", "description": "Preserving Data Privacy in Deep Learning by understanding the basics of Federated Learning and its implementation using PyTorch."}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/akshay-kulkarni-1a562679/", "anchor_text": "Mr. Akshay Kulkarni", "paragraph_index": 0}, {"url": "https://pytorch.org/docs/stable/optim.html", "anchor_text": "link", "paragraph_index": 19}, {"url": "https://arxiv.org/abs/1602.05629", "anchor_text": "Communication-Efficient Learning of Deep Networks from Decentralized Data", "paragraph_index": 29}], "all_paragraphs": ["Many thanks to renowned data scientist Mr. Akshay Kulkarni for his inspiration and guidance on this tutorial.", "In the world revolutionized by data and digitalization, more and more personal information is shared and stored, which opens a new field of preserving data privacy. But, what is data privacy, and why is there a need for preserving it?", "Data Privacy defines how a particular piece of information/data should be handled or who has authorized access based on its relative importance. With the introduction to AI (Machine Learning and Deep Learning), a lot of personal information can be extracted from these models, which can cause irreparable damage to the people whose personal data has been exposed. So, here comes the need to preserve this data while implementing various machine learning models.", "In this series of tutorials, the major concern is to preserve the data-privacy in Deep Learning models. You will be exploring different methods like Federated Learning, Differential Privacy, and Homomorphic Encryption.", "In this tutorial, you will discover how to preserve data privacy using federated learning on machine learning models. After completing this tutorial, you will know:", "Federated Learning, also known as collaborative learning, is a deep learning technique where the training takes place across multiple decentralized edge devices (clients) or servers on their personal data, without sharing the data with other clients, thus keeping the data private. It aims at training a machine learning algorithm, say, deep neural networks on multiple devices (clients) having local datasets without explicitly exchanging the data samples.", "This training happens simultaneously on other devices, hundreds, and thousands of them. After training the same model on different devices with different data, their weights (summary of training) are sent to the global server, where aggregation of these weights takes place. Different aggregation techniques are used to get the most out of the weights learned on the clients\u2019 devices. After aggregation, the global weights are again sent to the clients, and the training continues on the client\u2019s device. This entire process is called a communication round in federated learning, and this is how many communication rounds take place to further improve the accuracy of the model.", "Federated learning makes it possible for AI algorithms to gain experience from a vast range of data located at different sites. This approach enables several organizations to collaborate on the development of models but without having to share sensitive data with each other. Over the course of several communication rounds, the shared model (global model) gets exposed to a significantly wider range of data than what any single client possesses, and at the same time, it learns the client-specific features as well.", "There are two types of Federated Learning:", "Now that we are clear on what Federated Learning is, let\u2019s move on to building one from scratch in PyTorch and training it on the CIFAR10 dataset. With the help of this tutorial, we will understand the basic flow of federated learning. We will neither go into the details of how server-client communication works in the real-world nor the aggregation techniques, that would be discussed in the upcoming tutorial. In this study, the dataset is randomly divided into the clients and all local models will be trained on the same machine. Let\u2019s go.", "CIFAR10 dataset is used in this tutorial. It consists of 60,000 color images of 32x32 pixels in 10 classes. There are 50,000 training images and 10,000 test images. In the training batch, there are 5,000 images from each class, which makes 50,000 in total. In PyTorch, CIFAR 10 is available to use with the help of the torchvision module.", "In this tutorial, images are equally divided into clients, thus representing the balanced (IID) case.", "Lines 6\u201311 define the image augmentation and normalization method for the training data to be used while loading the images. Lines 14\u201315 load the training data with the given augmentation. A traindata_split is made, line 18, which splits the training data into num_clients, i.e. 20 in our case. Finally, a train_loader, line 21, is made to feed the images into the neural network for the training of the model.", "Lines 24\u201327 define the normalization method for the test images. Lines 30\u201332 define a test_loader, which is used to generate the test results of the given model.", "VGG19 (16 convolution layers, 3 Fully Connected layers, 5 MaxPool layers, and 1 SoftMax layer) are used in this tutorial. There are other variants of VGG like VGG11, VGG13, and VGG16.", "The client_update function train the client model on private client data. This is the local training round that takes place at num_selected clients, i.e. 6 in our case.", "The server_aggregate function aggregates the model weights received from every client and updates the global model with the updated weights. In this tutorial, the mean of the weights is taken and aggregated into the global weights.", "The test function is the standard function, which takes the global model along with the test loader as the input and returns the test loss and accuracy.", "One global model, along with the individual client_models is initialized with VGG19 on a GPU. In this tutorial, SGD is used as an optimizer for all the client models.", "Instead of VGG19, one can also use VGG11, VGG13, and VGG16. Other optimizers are also available and one can check the link for more details.", "Lines 2\u20135 create a list for keeping a track of the loss and accuracy for the train and test dataset. Training of individual clients starts with line 8, i.e. the communication round. Initially, num_selected clients are selected from num_clients (line 10), i.e. 6 clients are randomly selected from 20 available clients. Training takes place for every selected client (lines 12\u201314) using the client_update function. Now, the aggregation of the weights takes place using the server_aggregate (line 18) function defined above. This updates the global model, which is the final model that is used for prediction. After updating the global model, this global model is used to test the training (line 20) with the help of the test function defined above.", "This process continues for num_rounds, i.e. 150 communication rounds in our case. This is the example of the most basic level of federated learning, which can be further applied to a real client-based system.", "With 6 selected clients, each running 5 local epochs on the top of 150 communication rounds, below is the truncated test result.", "So, this model has achieved around 89.8 % accuracy using federated learning after 150 communication rounds. But how does it compare to a standard SGD model trained on the same dataset? For comparative study, the VGG19 model is trained using a standard SGD optimizer on the training data without federated learning. To ensure an equal playing ground, all the hyperparameters are the same, and it is trained for 200 epochs.", "The standard SGD model gives around 94% test accuracy after 200 epochs. So, our federated learning is performing decently with around 90% accuracy when compared to the original model.", "In this tutorial, you discovered how to preserve data privacy in deep learning models using federated learning with PyTorch.", "Below is the flow diagram for a quick revision of the entire process.", "Federated Learning is one of the best methods for preserving data privacy in machine learning models. The safety of client data is ensured by only sending the updated weights of the model, not the data. At the same time, the global model can learn from client-specific features. But do not get too excited about this model as the above results are not likely in the real world scenario. Real-world federated data held by clients are mostly NON-independent and identically distributed (non-IID). So, to tackle the problem of real-world/non-IID dataset, stay tuned for the next part of this series.", "In the upcoming tutorials, you will not only get to learn about tackling the non-IID dataset in federated learning but also different aggregation techniques in federated learning, homomorphic encryption of the model weights, differential privacy and its hybrid with federated learning, and a few more topics helping in preserving the data privacy.", "[2] H.Brendan McMahan, Communication-Efficient Learning of Deep Networks from Decentralized Data, Proceedings of the 20th International Conference on Artificial Intelligence and Statistics (AISTATS) 2017. JMLR: W&CP volume 54", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Deep Learning enthusiast, with prior experience at Publicis Sapient, National University of Singapore, and SUSTech China."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa04894f78029&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a04894f78029--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a04894f78029--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mailharsh17?source=post_page-----a04894f78029--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=post_page-----a04894f78029--------------------------------", "anchor_text": "Harsh Yadav"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11670cac41ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&user=Harsh+Yadav&userId=11670cac41ec&source=post_page-11670cac41ec----a04894f78029---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa04894f78029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa04894f78029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22"}, {"url": "https://www.instagram.com/p/CBelzJ4pifV/?utm_source=ig_web_copy_link", "anchor_text": "Harsh Yadav"}, {"url": "https://www.linkedin.com/in/akshay-kulkarni-1a562679/", "anchor_text": "Mr. Akshay Kulkarni"}, {"url": "https://federated.withgoogle.com/", "anchor_text": "Google AI"}, {"url": "https://federated.withgoogle.com/", "anchor_text": "Google AI"}, {"url": "https://federated.withgoogle.com/", "anchor_text": "Google AI"}, {"url": "https://pytorch.org/docs/stable/optim.html", "anchor_text": "link"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-2-6c2e9494398b"}, {"url": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22", "anchor_text": "https://towardsdatascience.com/preserving-data-privacy-in-deep-learning-part-3-ae2103c40c22"}, {"url": "https://arxiv.org/abs/1903.02891", "anchor_text": "arXiv:1903.02891"}, {"url": "https://arxiv.org/abs/1602.05629", "anchor_text": "Communication-Efficient Learning of Deep Networks from Decentralized Data"}, {"url": "https://medium.com/tag/federated-learning?source=post_page-----a04894f78029---------------federated_learning-----------------", "anchor_text": "Federated Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a04894f78029---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a04894f78029---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/privacy?source=post_page-----a04894f78029---------------privacy-----------------", "anchor_text": "Privacy"}, {"url": "https://medium.com/tag/differential-privacy?source=post_page-----a04894f78029---------------differential_privacy-----------------", "anchor_text": "Differential Privacy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa04894f78029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&user=Harsh+Yadav&userId=11670cac41ec&source=-----a04894f78029---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa04894f78029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&user=Harsh+Yadav&userId=11670cac41ec&source=-----a04894f78029---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa04894f78029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a04894f78029--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa04894f78029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a04894f78029---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a04894f78029--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a04894f78029--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a04894f78029--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a04894f78029--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a04894f78029--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a04894f78029--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a04894f78029--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a04894f78029--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mailharsh17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Harsh Yadav"}, {"url": "https://medium.com/@mailharsh17/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11670cac41ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&user=Harsh+Yadav&userId=11670cac41ec&source=post_page-11670cac41ec--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5ba5c7d18464&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreserving-data-privacy-in-deep-learning-part-1-a04894f78029&newsletterV3=11670cac41ec&newsletterV3Id=5ba5c7d18464&user=Harsh+Yadav&userId=11670cac41ec&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}