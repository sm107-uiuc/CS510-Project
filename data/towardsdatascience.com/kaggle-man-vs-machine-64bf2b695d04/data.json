{"url": "https://towardsdatascience.com/kaggle-man-vs-machine-64bf2b695d04", "time": 1683017127.422969, "path": "towardsdatascience.com/kaggle-man-vs-machine-64bf2b695d04/", "webpage": {"metadata": {"title": "Kaggle: Man vs Machine. We train an AutoML image classification\u2026 | by James Green | Towards Data Science", "h1": "Kaggle: Man vs Machine", "description": "Kaggle recently (end Nov 2020) released a new data science competition, centered around identifying deseases on the Cassava plant \u2014 a root vegetable widely farmed in Africa. The challenge \u2014 train a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/cassava-leaf-disease-classification", "anchor_text": "Cassava Leaf Desease Classification", "paragraph_index": 1}, {"url": "https://www.kaggle.com/c/cassava-leaf-disease-classification", "anchor_text": "Cassava Kaggle competition", "paragraph_index": 59}, {"url": "https://www.ancoris.com/solutions/data_analytics_ai", "anchor_text": "Ancoris Data, Analytics & AI", "paragraph_index": 60}], "all_paragraphs": ["Kaggle recently (end Nov 2020) released a new data science competition, centered around identifying deseases on the Cassava plant \u2014 a root vegetable widely farmed in Africa.", "\u201cAs the second-largest provider of carbohydrates in Africa, cassava is a key food security crop grown by smallholder farmers because it can withstand harsh conditions. At least 80% of household farms in Sub-Saharan Africa grow this starchy root, but viral diseases are major sources of poor yields. With the help of data science, it may be possible to identify common diseases so they can be treated.\u201dFrom Kaggle.com Cassava Leaf Desease Classification", "The challenge \u2014 train a multi-label image classification model to classify images of the Cassava plant to one of five labels:", "AutoML is an no-code AI service on the Google Cloud AI Platform that uses AI to train AI. We have seen some impressive results with AutoML on many client projects, so we thought it would be interesting to see how it faired against some of the most talented human data scientists on the planet.", "If you are new to Google\u2019s Cloud AI Platform, we cover an overview of the services available in the article below.", "Kaggle provided 21,000 labelled jpeg images of the Cassava plant to assist with model training. The first task was to upload this to Google Cloud Storage (GCS), so that AutoML could access the images.", "To learn how to do this, see our previous article below. Once you have completed those steps, return back here to see how we train the model.", "With a Kaggle competition like this you can either train an AutoML Edge model directly from a Kaggle Notebook using the AutoML API, or, as we choose, you can:", "2. Select Data sets from the menu on the left and click Create. On the screen that appears enter a name for your data set. Then select the IMAGE tab and check the Image classification (multi-label) radio button.", "3. After a minute or so, you should see your dataset listed. Here is mine:", "4. On the screen above, click on your data set name and you will be taken to the screen below. Here, check Select import files from Cloud Storage and browse to a .csv file that contains a list of URIs to the training images in your Google Cloud bucket.", "Here is an example row in the CSV we uploaded. Note the last column (0 in this case), is the label.", "Leave the Data split dropdown as Automatic.", "You will now see this screen. For this Kaggle exercise, importing the circa 20k took around 20 minutes. You will receive an email once this is complete (a good excuse for a cup of tea).", "5. With your images imported into your data set, you should see a screen that looks like this. It\u2019s a great place to get a feel for your images that are in each label set \u2014 use the handy filter option.", "For example, in our Cassva competition we spent quite a bit of time analysing what a healthy plant (label 4) looked like, and noted that we thought a lot of these plants looked far from healthy!", "Another feature we use is if you select the ANALYSE tab, this shows how your training images are distributed across labels. Note in the Cassava data, there is an imbalance seen in label 4 (mosaic desease).", "6. With your image data imported, we can now train the model :)", "Select Training from left sidebar and click CREATE.", "Pick your dataset created in step 5 from the dropdown.", "Annotation setsAn annotation set refers to a set of labels\u2014 in our case this will refer to the labels we uploaded alongside the Cassava plant images. If you want to, in AI Platform Unified you can actually go into a dataset and create additional label sets and label images yourself. A really handy feature (assuming your image set is small enough in size to make this feasible).", "7. Enter a name for your trained model. We typically use the default. Expanding the Advanced Options allows you to define your training:validation:test split. Typcially we start with the recommended 80:10:10.", "8.You are now presented with some options for optimising your model. As this is an Edge model, and is run on the device (e.g. mobile phone), latency is a key factor for a typical Edge use-case. However, as we are trying to achieve the highest accuracy score for our Kaggle completion we select Highest accuracy.", "9. In the final screen, you choose how long you want to AutoML to spend training your model. You are charged based on the operation, use-case and training time. This is covered in detail in the official documentation below.", "This is the pricing table taken from the above, shown here for image data.", "In our example, our operation is Training (on-device) and our task is Classification. Therefore, we are charged $4.95 per node hour.", "A node hour is a measure of one hour training performed on a single node in AutoML. For our training operation, AutoML has the number of nodes fixed at 8.", "We choose 8 node hours for our model, so this will take 8/8 = 1hr to train", "Make sure to Enable early stopping", "Tip: Note in this screen AutoML gives you an estimated completion time for model training. Also note, that should AutoML reach an optimal model in less node time, training will finish and you will be only charged for the nodes used. Lastly, note the minimum training time is 1 node hour.", "Finally, click START TRAINING and AutoML will handle the rest. Exciting hey!", "Enjoy cup of tea #2 while your model trains.", "You will receive an email once your model is ready. Meanwhile, if you click on Training you will see your model listed, and note the status is Pending, indicating training is in progress.", "Once your model has finished training comes the exciting part \u2014 seeing the level of accuracy AutoML managed to achieve.", "The EVALUATE tab reveals your model accuracy and other metrics. We saw some promising results with our Kaggle Cassava model:", "Clicking on the MODEL PROPERTIES tab gives a nice summary of our model.", "We want to use this in a Kaggle notebook via TensorFlow, so we choose TF Lite. This displays the following window. Here, we choose to export the model to a GCS bucket (we used the same bucket that contained our Kaggle training images).", "Our model is now ready to upload to Kaggle :)", "So this is the really exciting part \u2014 we are going to see how our \u201cmachine made\u201d model fairs against human-made models in the Kaggle contest.", "To do this, we essentially need to submit a Kaggle Notebook that fires the (unseen) test images at our exported TF Lite model, generate a prediction, and outputs the prediction for Kaggle to score.", "Kaggle can then rank our machine-made model in the Kaggle leaderboard.", "4. Give your notebook a name (we always prefix them with the competition name to make them easy to find later on).", "5. Next we upload our exported Tensorflow Lite model into this Notebook, ready for prediciton. To do this, click on +Add data in the top right of the screen, and the following page is displayed:", "Click Upload and navigate to the TF Lite model you saved locally. You should now see your model listed under Inputs in the right sidebar:", "6. Our final step is to run the predictions through the model.", "Add the following code cell to your Kaggle Notebook. Note the placeholder in bold should be replaced with the path to your AutoML model (hover over your model as shown below to get this).", "Run this Notebook in Kaggle, and you should see the first rows of your CSV showing the image name and the predicted label.", "Tip: Make sure you disable internet access \u2014 otherwise you won\u2019t be able to submit this Notebook for scoring. Click on Settings in the right sidebar and untick Internet.", "Finally click the Save as version button.", "Navigate to the Kaggle competition page and click the Submit button. On the screen that\u2019s displayed, choose the latest version of your Notebook and click the Submit button.", "You will now now see your model running predictions on the unseen test data:", "So, our model took about 20 (agonising) minutes to process Kaggle\u2019s test images and for Kaggle to grade our model predictions.", "Where did that place our machine-made model against human competitors?", "Well, as of 28 Nov 2020, our machine-made AutoML model ranked 559 out of 766 in the Kaggle leaderboard for the Cassava competition.", "Our machine-made model scored an impressive 87.3% accuracy; achieved with zero data science knowledge, and an investment of under $40 to train the model. The model was really easy to train, in fact hardest part of the exercise was coding the submission Notebook in Kaggle (hopefully the detailed walkthrough will encourage others to try it out).", "Our model was ranked 559 out of 642. This may seem fairly low but there are a few things to note:", "Note: We are going to attempt to repeat the exercise using a Tensorflow.js model, an alternative export format that\u2019s available from AutoML. Currently, we are not sure how to run this from within a Python Kaggle Notebook \u2014 these models are designed to run in a web browser, but if we do manage it, we will post an update :)", "2. One of the top performing contestants in the competition revealed their Notebook solution (achieves 90% accuracy). Unsurprisingly, many of the contestants immediately adopted this Notebook as their starting point, so the scoreboard is heavily contested around the 90% zone.", "If you want to give it a try, Google Cloud offer 15 node hours free that you can use to train two Edge models in AutoML (say one 8 node hour and a second 7 node hour). This is part of their generous free tier (the billing manager will automatically discount this for you).", "2. View the Cassava Kaggle competition used in this walkthrough.", "3. Learn more about Ancoris Data, Analytics & AI", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Head of Data, Analytics & AI @ Ancoris. Part of a highly committed team of data scientists, mathematicians & engineers delivering Google Cloud client solutions"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F64bf2b695d04&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://google-cloud-data.medium.com/?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": ""}, {"url": "https://google-cloud-data.medium.com/?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": "James Green"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe242c1ce5f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&user=James+Green&userId=e242c1ce5f6d&source=post_page-e242c1ce5f6d----64bf2b695d04---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64bf2b695d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64bf2b695d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/cassava-leaf-disease-classification", "anchor_text": "Cassava Leaf Desease Classification"}, {"url": "https://unsplash.com/@malmanxx?utm_source=medium&utm_medium=referral", "anchor_text": "malmanxx"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/google-cloud-ai-platform-hyper-accessible-ai-machine-learning-cddd8c3348b3", "anchor_text": "Google Cloud AI Platform: Hyper-Accessible AI & Machine LearningIn this first article of the series, we present an over of Google AI Platform, exploring the services available to\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/importing-kaggle-training-data-into-google-cloud-storage-70830a439048", "anchor_text": "Importing Kaggle Training Data into Google Cloud StorageWe show you how in easy to follow steps.towardsdatascience.com"}, {"url": "https://cloud.google.com/ai-platform-unified/pricing", "anchor_text": "Pricing | AI Platform (Unified) | Google CloudPreview This product is covered by the Pre-GA Offerings Terms of the Google Cloud Platform Terms of Service. Pre-GA\u2026cloud.google.com"}, {"url": "https://www.kaggle.com/googlecloudautoml", "anchor_text": "Kaggle profile"}, {"url": "https://www.kaggle.com/c/cassava-leaf-disease-classification", "anchor_text": "Cassava Kaggle competition"}, {"url": "https://www.ancoris.com/solutions/data_analytics_ai", "anchor_text": "Ancoris Data, Analytics & AI"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----64bf2b695d04---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/data-science?source=post_page-----64bf2b695d04---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----64bf2b695d04---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----64bf2b695d04---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----64bf2b695d04---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F64bf2b695d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&user=James+Green&userId=e242c1ce5f6d&source=-----64bf2b695d04---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F64bf2b695d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&user=James+Green&userId=e242c1ce5f6d&source=-----64bf2b695d04---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64bf2b695d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F64bf2b695d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----64bf2b695d04---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----64bf2b695d04--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----64bf2b695d04--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----64bf2b695d04--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----64bf2b695d04--------------------------------", "anchor_text": ""}, {"url": "https://google-cloud-data.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://google-cloud-data.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "James Green"}, {"url": "https://google-cloud-data.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "216 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe242c1ce5f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&user=James+Green&userId=e242c1ce5f6d&source=post_page-e242c1ce5f6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F354049f3c33d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-man-vs-machine-64bf2b695d04&newsletterV3=e242c1ce5f6d&newsletterV3Id=354049f3c33d&user=James+Green&userId=e242c1ce5f6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}