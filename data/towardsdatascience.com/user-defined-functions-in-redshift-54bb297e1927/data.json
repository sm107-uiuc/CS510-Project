{"url": "https://towardsdatascience.com/user-defined-functions-in-redshift-54bb297e1927", "time": 1683003859.3516722, "path": "towardsdatascience.com/user-defined-functions-in-redshift-54bb297e1927/", "webpage": {"metadata": {"title": "User Defined Functions in Redshift | by Mandy Gu | Towards Data Science", "h1": "User Defined Functions in Redshift", "description": "Amazon Redshift is a cloud data warehouse with its own Redshift SQL dialect (a variant of PostgreSQL). The service has become increasingly popular due to its low cost and compatibility with other\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.aws.amazon.com/redshift/latest/dg/r_UNLOAD.html", "anchor_text": "unload", "paragraph_index": 0}, {"url": "https://docs.aws.amazon.com/redshift/latest/dg/r_COPY.html", "anchor_text": "copy", "paragraph_index": 0}, {"url": "https://docs.aws.amazon.com/redshift/latest/dg/user-defined-functions.html", "anchor_text": "User Defined Functions", "paragraph_index": 1}, {"url": "https://docs.aws.amazon.com/redshift/latest/dg/udf-python-language-support.html#udf-importing-custom-python-library-modules", "anchor_text": "creating a library from code saved in S3", "paragraph_index": 4}, {"url": "https://docs.amazonaws.cn/en_us/redshift/latest/dg/udf-data-types.html", "anchor_text": "this page", "paragraph_index": 10}, {"url": "https://medium.com/@mandygu", "anchor_text": "Follow me on Medium", "paragraph_index": 15}, {"url": "http://www.dscrashcourse.com/", "anchor_text": "www.dscrashcourse.com", "paragraph_index": 16}], "all_paragraphs": ["Amazon Redshift is a cloud data warehouse with its own Redshift SQL dialect (a variant of PostgreSQL). The service has become increasingly popular due to its low cost and compatibility with other Amazon Web Services. My favourite Redshift integration is the ability to unload and copy data to and from S3.", "In this article, we will focus on User Defined Functions (UDFs).", "UDFs are scalar functions that can be customized and created from the Redshift data warehouse. Each function can accept a fixed number of arguments to return a single output. UDFs can be executed similarly to built in Redshift functions such as replace or lower.", "Amazon recommends that all UDF names begin with f_. For instance, a UDF for calculating the number of business days between two dates could be named f_calculate_business_days . This will prevent conflicts between UDF names and new Redshift functions \u2014 the f_ prefix is specifically reserved for UDFs.", "UDFs can be created using a SQL select statement or as a Python function. UDFs written in SQL are more performant, but Python UDFs come with the advantage of built in libraries. In addition to the Python Standard Library, Python UDFs support functions from pandas, scipy, numpy to name just a few. There is also an option to import additional Python libraries by creating a library from code saved in S3.", "All UDFs are created using theCREATE FUNCTION command. Alternatively, we can use CREATE OR REPLACE FUNCTION to update existing UDFs.", "There is a limit of 32 arguments for any UDF.", "This is the structure of a SQL UDF:", "The UDF body is made up of one select statement. Arguments in a SQL UDF cannot be named. They must be referenced (in the order they are defined) as $1, $2 and so forth. Arguments can take on any Redshift data type.", "This is the structure of a Python UDF:", "Unlike SQL UDFs, Python UDFs require argument names. Installed libraries can also be imported as a part of the Python code. Refer to this page for supported Python UDF data types.", "Consider a very simple UDF for cleaning a string. We want this UDF to convert the input to lowercase and replace underscores with a white space. Although these cleaning steps can be built into the SQL query itself, we can also use a UDF to make the queries more consistent and easier to read.", "We can test our new UDF using this statement.", "We can apply this UDF to a column called error_messages", "Here is a Coursera course for practicing and applying SQL.", "If you enjoyed this article, consider buying me a coffee \u2014 every small contribution helps me find more time to work on this blog. Follow me on Medium for the latest updates. \ud83d\ude03", "I am also building a comprehensive set of free Data Science lessons and practice problems at www.dscrashcourse.com as a hobby project.", "Thank you again for reading! \ud83d\udcd5", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F54bb297e1927&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----54bb297e1927--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----54bb297e1927--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mandygu.medium.com/?source=post_page-----54bb297e1927--------------------------------", "anchor_text": ""}, {"url": "https://mandygu.medium.com/?source=post_page-----54bb297e1927--------------------------------", "anchor_text": "Mandy Gu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c6a0dab4f8d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&user=Mandy+Gu&userId=3c6a0dab4f8d&source=post_page-3c6a0dab4f8d----54bb297e1927---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F54bb297e1927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F54bb297e1927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://docs.aws.amazon.com/redshift/latest/dg/r_UNLOAD.html", "anchor_text": "unload"}, {"url": "https://docs.aws.amazon.com/redshift/latest/dg/r_COPY.html", "anchor_text": "copy"}, {"url": "https://docs.aws.amazon.com/redshift/latest/dg/user-defined-functions.html", "anchor_text": "User Defined Functions"}, {"url": "https://docs.aws.amazon.com/redshift/latest/dg/udf-python-language-support.html#udf-importing-custom-python-library-modules", "anchor_text": "creating a library from code saved in S3"}, {"url": "https://docs.amazonaws.cn/en_us/redshift/latest/dg/udf-data-types.html", "anchor_text": "this page"}, {"url": "https://docs.amazonaws.cn/en_us/redshift/latest/dg/udf-logging-messages.html", "anchor_text": "log warnings and errors within our UDFs"}, {"url": "https://docs.amazonaws.cn/en_us/redshift/latest/dg/udf-security-and-privileges.html", "anchor_text": "UDF privileges"}, {"url": "https://click.linksynergy.com/link?id=J2RDo*Rlzkk&offerid=759505.17916350380&type=2&murl=https%3A%2F%2Fwww.coursera.org%2Fspecializations%2Fdata-science-fundamentals-python-sql", "anchor_text": "Data Science Fundamentals with Python and SQLIBM is the global leader in business transformation through an open hybrid cloud platform and AI, serving clients in\u2026click.linksynergy.com"}, {"url": "https://ko-fi.com/mandygu#checkoutModal", "anchor_text": ""}, {"url": "https://medium.com/@mandygu", "anchor_text": "Follow me on Medium"}, {"url": "http://www.dscrashcourse.com/", "anchor_text": "www.dscrashcourse.com"}, {"url": "https://medium.com/tag/programming?source=post_page-----54bb297e1927---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data?source=post_page-----54bb297e1927---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/database?source=post_page-----54bb297e1927---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/tag/sql?source=post_page-----54bb297e1927---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/aws?source=post_page-----54bb297e1927---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F54bb297e1927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&user=Mandy+Gu&userId=3c6a0dab4f8d&source=-----54bb297e1927---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F54bb297e1927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&user=Mandy+Gu&userId=3c6a0dab4f8d&source=-----54bb297e1927---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F54bb297e1927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----54bb297e1927--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F54bb297e1927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----54bb297e1927---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----54bb297e1927--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----54bb297e1927--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----54bb297e1927--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----54bb297e1927--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----54bb297e1927--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----54bb297e1927--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----54bb297e1927--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----54bb297e1927--------------------------------", "anchor_text": ""}, {"url": "https://mandygu.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mandygu.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mandy Gu"}, {"url": "https://mandygu.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "689 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c6a0dab4f8d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&user=Mandy+Gu&userId=3c6a0dab4f8d&source=post_page-3c6a0dab4f8d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6a4978efa3fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuser-defined-functions-in-redshift-54bb297e1927&newsletterV3=3c6a0dab4f8d&newsletterV3Id=6a4978efa3fe&user=Mandy+Gu&userId=3c6a0dab4f8d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}