{"url": "https://towardsdatascience.com/bigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa", "time": 1683005215.978071, "path": "towardsdatascience.com/bigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa/", "webpage": {"metadata": {"title": "BigQuery + Cloud Functions: how to run your queries as soon as a new Google Analytics table is available | by Marieke Pots | Towards Data Science", "h1": "BigQuery + Cloud Functions: how to run your queries as soon as a new Google Analytics table is available", "description": "If you have your Google Analytics view linked to BigQuery, you are probably enjoying the advantages it brings. There is no sampling in your data, you can bring in third-party data, you have more\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cloud.google.com/bigquery-transfer/docs/reference/datatransfer/rest", "anchor_text": "BigQuery DataTransfer API", "paragraph_index": 5}], "all_paragraphs": ["If you have your Google Analytics view linked to BigQuery, you are probably enjoying the advantages it brings. There is no sampling in your data, you can bring in third-party data, you have more control over your data and much more.", "But, there was one thing bothering me. And maybe it is bothering you too. The exact time of the daily export from Google Analytics to the BigQuery table(ga_sessions_YYYYMMDD) can be somewhat unpredictable. This makes it is impossible to run scheduled queries on this dataset without taking a small risk.", "Of course, in these uncertain times of Corona, you might call this a first-world-problem. But because it is a problem that I can help fix, I will take you through a step by step guide on how to run your scheduled queries in the exact minute that a new daily export from Google Analytics is ready. The result is a much more fail-proof set-up in which your tables and dashboards are always as up-to-date as they can possibly be.", "The steps that we will be taking are:", "Pub/Sub stands for Publish\u2013Subscribe and can be considered as a messaging system between systems. In this case, we want to create a new Pub/Sub topic that collects the logs that we isolated in the previous step. This way, a message will be collected every time a new Google Analyicts table is available.", "In this last step we will create a Cloud Function (written in Python) that runs every time the Pub/Sub topic is triggered. The function then sends a request to the BigQuery DataTransfer API to start a manual transfer run on one of your scheduled (on demand) SQL queries.", "If you have correctly set up everything, your scheduled query will now start to run as soon as a new daily table has been exported to BigQuery! This means that you can sit back, relax and enjoy that your Google Analytics data is always as fresh as it can be.", "If you have any tips, comments or questions, do not hesitate to ask me in the comments below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data & Insights Consultant @ OrangeValley"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F17fbb62f8aaa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marieke91?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marieke91?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": "Marieke Pots"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88283bda5f98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&user=Marieke+Pots&userId=88283bda5f98&source=post_page-88283bda5f98----17fbb62f8aaa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17fbb62f8aaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17fbb62f8aaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://support.google.com/analytics/answer/3437719?hl=en&ref_topic=3416089", "anchor_text": "here"}, {"url": "https://console.cloud.google.com/logs", "anchor_text": "Cloud Logging"}, {"url": "https://cloud.google.com/bigquery-transfer/docs/reference/datatransfer/rest", "anchor_text": "BigQuery DataTransfer API"}, {"url": "https://console.cloud.google.com/functions", "anchor_text": "Cloud Functions"}, {"url": "https://console.cloud.google.com/bigquery/scheduled-queries", "anchor_text": "scheduled query"}, {"url": "https://cloud.google.com/bigquery/docs/scheduling-queries", "anchor_text": "create your scheduled query"}, {"url": "https://medium.com/tag/bigquery?source=post_page-----17fbb62f8aaa---------------bigquery-----------------", "anchor_text": "Bigquery"}, {"url": "https://medium.com/tag/google-analytics?source=post_page-----17fbb62f8aaa---------------google_analytics-----------------", "anchor_text": "Google Analytics"}, {"url": "https://medium.com/tag/cloud-functions?source=post_page-----17fbb62f8aaa---------------cloud_functions-----------------", "anchor_text": "Cloud Functions"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----17fbb62f8aaa---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----17fbb62f8aaa---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17fbb62f8aaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&user=Marieke+Pots&userId=88283bda5f98&source=-----17fbb62f8aaa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17fbb62f8aaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&user=Marieke+Pots&userId=88283bda5f98&source=-----17fbb62f8aaa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17fbb62f8aaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F17fbb62f8aaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----17fbb62f8aaa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----17fbb62f8aaa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marieke91?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marieke91?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marieke Pots"}, {"url": "https://medium.com/@marieke91/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88283bda5f98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&user=Marieke+Pots&userId=88283bda5f98&source=post_page-88283bda5f98--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2447844439d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbigquery-cloud-functions-how-to-run-your-queries-as-soon-as-a-new-google-analytics-table-is-17fbb62f8aaa&newsletterV3=88283bda5f98&newsletterV3Id=2447844439d1&user=Marieke+Pots&userId=88283bda5f98&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}