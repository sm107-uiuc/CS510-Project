{"url": "https://towardsdatascience.com/heres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e", "time": 1683010655.9186602, "path": "towardsdatascience.com/heres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e/", "webpage": {"metadata": {"title": "Here\u2019s How I Predicted Apple\u2019s Stock Price Using Natural Language Processing | by Trist'n Joseph | Towards Data Science", "h1": "Here\u2019s How I Predicted Apple\u2019s Stock Price Using Natural Language Processing", "description": "Stock market prediction refers to the act of attempting to determine the future value of a company\u2019s stock (or other financial instruments) that is traded on an exchange. Accurately predicting the\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Stock market prediction refers to the act of attempting to determine the future value of a company\u2019s stock (or other financial instruments) that is traded on an exchange. Accurately predicting the stock market is like being able to see into the future. If one could do this, then they will undoubtedly engage in actions that will substantially benefit themselves. Imagine knowing that Apple\u2019s stock will increase from $300 per share by 80% tomorrow, and currently having the ability to buy 10 shares. That will guarantee a return of $2,400 in one day with possibly minimal effort. And if one could do this consistently over at least a year? Wow.", "Unfortunately, however, accurately predicting stock prices are not that simple. There are many factors to consider that can affect a stock\u2019s price and building a model which consists of all these factors will most likely result in poor predictions on out of sample data. But the stock market also tends to be forward-looking, which means that it reflects investor outlook on the economy. Because of this, I used Natural Language Processing (NLP) and attempted to create a model that predicts Apple\u2019s stock price by using the market sentiment from the prior trading day.", "NLP generally refers to the manipulation of natural languages, such as text, by software. Some of the most common applications of NLP include speech recognition, chatbots, autocorrect, virtual assistants, and sentiment analysis. For this project, I used sentiment analysis. This refers to the interpretation and classification of emotions within a text and allows for the identification of sentiment (or feeling) towards a particular thing. Models which use sentiment analysis often focus on the polarity (the negativity or positivity) of text.", "Many articles are published daily and provide information regarding the markets or updates on companies which are publicly traded. The information presented could persuade individuals to either buy or sell their stocks, which can affect the stock\u2019s price when done on a large scale. Articles are referred to as unstructured data (or unorganized data) and this makes them hard to understand, analyze, and sort through.", "Sentiment analysis is particularly useful because it makes sense out of unstructured data by efficiently processing huge amounts of data and automatically tagging it by polarity. The output of sentiment analysis is also consistent, and this is important because an individual\u2019s interpretation of sentiment is biased towards their point of view. In fact, it is estimated that people only agree about 65% of the time when determining the sentiment of a piece of text. Therefore, the process of sentiment analysis includes refining a document and extracting keywords which will then be ranked by comparing these words to a predefined lexicon containing polarities.", "For this project, I collected 267 Apple-related articles that were hosted on MarketWatch.com published between February 20th, 2020 and June 12th, 2020. Articles are not only published during the week or on trading days; it is common for an article to be posted on the weekend or non-trading day, and these need to be considered as well. Because of this, any article published on a non-trading day was recorded as the next available trading day.", "Quite often, a quick check on the polarity can allow one to either set expectations about the problem or help one learn more about the problem. By doing this, I noticed that the polarity of articles was centred slightly above zero. A possible reason for this is that authors tend to exploit negative headlines while presenting positive information within the body of an article.", "I also found that the relationship between the number of words within an article and the magnitude of an article\u2019s polarity differed between negative and positive articles. The data showed that the number of words in a negative article and the polarity of negative articles are negatively related, whereas the number of words in a positive article and the polarity of positive articles are positively related. I assume that this makes sense and it speaks to the amount of effort placed in making an article more negative or more positive. Consider an unimpressed individual writing an article about a negative experience they encountered; they will most likely leave a longer review the worse their experience was.", "Knowing this, I decided to create a comparison word cloud to determine what words were most associated with negative and positive articles. I found that \u201closses\u201d, \u201cearnings\u201d and \u201csupply\u201d were keywords within negative articles, while \u201cstreaming\u201d and \u201cgains\u201d were keywords within position articles. Given that a large portion of articles was published during the coronavirus lockdown period, it makes sense why \u201cstreaming\u201d would be associated with positive articles and \u201csupply\u201d with negative ones. Many individuals subscribed to new streaming services, including Apple TV+, which has the potential to give investors a better outlook on the future of Apple. However, there were many concerns that the lockdowns will affect Apple\u2019s production of upcoming products and the supply of current products, which has the potential to give investors a less than stellar outlook on Apple\u2019s future.", "Although both the relationship between polarity and effort, as well as the comparison word cloud, produced plausible results, I believe that they can be made better by using a more appropriate, financial lexicon. For this analysis, I used the AFINN lexicon; this assigns words a score that runs between -5 and 5, where negative scores indicate negative sentiments. I found AFINN to be more appropriate than both the NRC and Bing lexicons. NRC categorizes words into groups like \u201canger\u201d and \u201cdisgust\u201d, while Bing categorizes words into \u201cpositive\u201d versus \u201cnegative\u201d. Despite AFINN being most appropriate, I believe that creating a carefully curated financial lexicon that could appropriately classify words will produce even better results.", "Through looking at the relationship between standardized prices and polarity, I noticed that polarity had a lagged cumulative effect on Apple\u2019s stock price. Because of this, I hypothesized that the stock price can be modelled by the recursive function `stock price tomorrow = (price today) + constant*(price today)*(sentiment today)`. The function operates by accepting an initial stock price and a vector of sentiments, and every subsequent price is then predicted using the recurrence relation. To emphasize, the stock price on day 0 is entered as an initial price for the model to then predict the price tomorrow (day 1). When the model then needs to predict the price for day 2, the predicted value from day 1 is automatically used as the input price; on day 3, day 2\u2019s predicted price will be automatically used as the input price and so on. The optimal `constant` is determined by choosing that value which minimizes the mean absolute prediction error.", "The model\u2019s output followed a similar trend to Apple\u2019s actual stock prices up until April but completely diverged thereafter. After analyzing the point of divergence, I realized that the effect of constant negative news caused the increase in price from positive news to struggle. Therefore, I updated the model such that positive sentiments got a higher weighting from the `constant` term than negative sentiments. The function was then again optimized by choosing the pair of constants which minimized the mean absolute prediction error. The use of this model significantly decreased the divergence between the predicted and actual stock prices.", "Lastly, I investigated a recurrence model which stated `stock price tomorrow = (price today) + price_constant*(price today)*(sentiment today) \u2014 volume_constant*(volume today)*(sentiment today)`. The predictions from this model yielded the lowest prediction error when compared to other models created during this project, and the predicted values are seen below.", "I am still working on this project and I am currently testing the model framework on Goldman Sachs and Exxon Mobil stocks over a similar period to determine whether I will see similar results. I would love any feedback on this work thus far, and I am open to having others work alongside me for the remainder of this project if interested. Please feel free to point out any mistakes that I might have made, or to suggest anything that might have been overlooked.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist? Yes. Researcher? Somewhat. Content creator? Sure, why not."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F13a578c41b8e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://trisxcjoseph.medium.com/?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": ""}, {"url": "https://trisxcjoseph.medium.com/?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": "Trist'n Joseph"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32920ce9f4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&user=Trist%27n+Joseph&userId=32920ce9f4b&source=post_page-32920ce9f4b----13a578c41b8e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13a578c41b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13a578c41b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://machinelearningmastery.com/natural-language-processing/", "anchor_text": "machinelearningmastery.com/natural-language-processing/"}, {"url": "https://monkeylearn.com/sentiment-analysis/#:~:text=Sentiment%20analysis%20is%20the%20interpretation,or%20services%20in%20online%20feedback.", "anchor_text": "monkeylearn.com/sentiment-analysis/#:~:text=Sentiment%20analysis%20is%20the%20interpretation,or%20services%20in%20online%20feedback."}, {"url": "https://www.netapp.com/us/info/what-is-unstructured-data.aspx", "anchor_text": "netapp.com/us/info/what-is-unstructured-data.aspx"}, {"url": "https://www.thebalance.com/how-market-prices-move-through-buying-and-selling-1031049", "anchor_text": "thebalance.com/how-market-prices-move-through-buying-and-selling-1031049"}, {"url": "https://arxiv.org/pdf/1806.09533.pdf", "anchor_text": "arxiv.org/pdf/1806.09533.pdf"}, {"url": "https://algorithmia.com/blog/introduction-natural-language-processing-nlp", "anchor_text": "algorithmia.com/blog/introduction-natural-language-processing-nlp"}, {"url": "https://www.quora.com/Why-is-the-stock-market-so-difficult-to-predict#:~:text=It%20is%20really%20impossible%20to,would%20happen%20in%20the%20future.", "anchor_text": "quora.com/Why-is-the-stock-market-so-difficult-to-predict#:~:text=It%20is%20really%20impossible%20to,would%20happen%20in%20the%20future."}, {"url": "https://www.researchgate.net/publication/228892903_Using_news_articles_to_predict_stock_price_movements", "anchor_text": "researchgate.net/publication/228892903_Using_news_articles_to_predict_stock_price_movements"}, {"url": "https://nlp.stanford.edu/courses/cs224n/2007/fp/timmonsr-kylee84.pdf", "anchor_text": "nlp.stanford.edu/courses/cs224n/2007/fp/timmonsr-kylee84.pdf"}, {"url": "https://medium.com/tag/data-science?source=post_page-----13a578c41b8e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----13a578c41b8e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----13a578c41b8e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----13a578c41b8e---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----13a578c41b8e---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F13a578c41b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&user=Trist%27n+Joseph&userId=32920ce9f4b&source=-----13a578c41b8e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F13a578c41b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&user=Trist%27n+Joseph&userId=32920ce9f4b&source=-----13a578c41b8e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13a578c41b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F13a578c41b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----13a578c41b8e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----13a578c41b8e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----13a578c41b8e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----13a578c41b8e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----13a578c41b8e--------------------------------", "anchor_text": ""}, {"url": "https://trisxcjoseph.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://trisxcjoseph.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Trist'n Joseph"}, {"url": "https://trisxcjoseph.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "385 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32920ce9f4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&user=Trist%27n+Joseph&userId=32920ce9f4b&source=post_page-32920ce9f4b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcfd73cacf13a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheres-how-i-predicted-apple-s-stock-price-using-natural-language-processing-13a578c41b8e&newsletterV3=32920ce9f4b&newsletterV3Id=cfd73cacf13a&user=Trist%27n+Joseph&userId=32920ce9f4b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}