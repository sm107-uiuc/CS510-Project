{"url": "https://towardsdatascience.com/classifying-shakespeare-with-networks-2a6c1c44e17f", "time": 1683009448.128918, "path": "towardsdatascience.com/classifying-shakespeare-with-networks-2a6c1c44e17f/", "webpage": {"metadata": {"title": "Classifying Shakespeare with Networks \ud83d\udd78 | by Cameron Raymond | Towards Data Science", "h1": "Classifying Shakespeare with Networks \ud83d\udd78", "description": "William Shakespeare is one of our most recognizable and lauded playwrights. With a writing career that spans 36 (easily attributable) plays, an interesting aspect of his work is that these plays can\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cameronraymond.me/", "anchor_text": "cameronraymond.me", "paragraph_index": 1}, {"url": "https://www.kaggle.com/kingburrito666/shakespeare-plays/", "anchor_text": "Kaggle data-set", "paragraph_index": 4}, {"url": "https://pypi.org/project/NetLSD/", "anchor_text": "Python", "paragraph_index": 11}, {"url": "https://arxiv.org/abs/1805.10712", "anchor_text": "original paper", "paragraph_index": 11}, {"url": "https://cameronraymond.me", "anchor_text": "https://cameronraymond.me", "paragraph_index": 22}], "all_paragraphs": ["William Shakespeare is one of our most recognizable and lauded playwrights. With a writing career that spans 36 (easily attributable) plays, an interesting aspect of his work is that these plays can be split up into well defined categories: comedies, tragedies, and histories. Comedies have happy endings and are uplifting, where the main characters overcome some obstacle. Tragedies generally end with the death of a flawed main character. However, how can we formalize the difference between comedies and tragedies? This is what we\u2019ll tackle in this article, but we won\u2019t do it in the way you might expect.", "My research (see: cameronraymond.me) focuses on networks and how the connections between us shape our world. While plenty of people have analyzed the dialogue of Shakespeare\u2019s plays, far fewer have bothered to look at the differences in how characters relate to each other. Comedy\u2019s and tragedies are very different \u2014 not just in terms of the dialogue used, but in how the characters and scenes are structured in relation to each other. I\u2019m going to show that by only looking at the structure of a Shakespeare\u2019s plays, and not looking at any of the dialogue, we can determine which plays are comedies and which are tragedies.", "Admittedly, this may seem odd at first. If you want to know a comedy from a tragedy, why wouldn\u2019t you look at the actual dialogue?", "I would argue that not relying on language is an asset because while not everyone speaks the same language, most stories are driven by relationships between characters. A \u201cnetwork-first\u201d approach gives us a more universal comparison of storytelling in a way that isn\u2019t blocked by language barriers. Approaches that rely on natural language processing (NLP) need to know how to interpret different languages as well as different uses of the same language! An NLP model that learns from West Side Story may have a hard time interpreting Romeo and Juliet, even though they\u2019re both in English and follow identical story arcs. A network-first approach has the potential to pick up on the relational similarities between the two, despite the generational gap. Therefore, the aim is to test if the structure of Shakespeare\u2019s comedies and tragedies are distinct enough to distinguish between the two, without relying on any understanding of language.", "Thankfully, most of Shakespeare\u2019s plays have been digitized. Using a Kaggle data-set we can download all 36 plays and load their scripts into a dataframe. Since scripts contain stage directions, which don\u2019t give information about how characters relate to one another, we\u2019ll drop those rows. Since we won\u2019t be analyzing Shakespeare's histories we can also drop those.", "Now that the data is in a usable format we can start building our networks (one for each play). Since we\u2019re interested in how characters relate to each other we\u2019ll add a link, also called an edge, between two characters if they speak in the same scene. Characters that speak together frequently are probably connected in some meaningful way. This will form the basis for our network-first classification model.", "Let\u2019s use Shakespeare\u2019s 1623 play All\u2019s Well That Ends Well as an example. First we\u2019ll isolate for that play\u2019s dialogue. Then we\u2019ll calculate how many times each character speaks, and keep those who meaningfully contribute to the structure of the play (those that speak more than 5 times).", "Next we\u2019ll create the network. We can do this by going scene by scene and adding a link between two characters if they speak in the same scene. The more times those characters speak together in different scenes, the stronger their link will be.", "Repeat for all 27 plays, visualize, and these are the resulting networks! Now we need a way to distinguish between comedies and tragedies that only uses these networks.", "Now that we\u2019ve built networks for Shakespeare\u2019s plays we need some way of distinguishing them. Unfortunately, there isn\u2019t some straightforward way of comparing the structure of two networks. Traditionally, the most dominant method of comparison was called graph edit distance (GED). This method calculates how many edges would need to be reassigned between the two networks before they became identical. This is visualized in the image above. Unfortunately, this relies on each graph having the same number of nodes \u2014 or else they\u2019d never be identical. Since our plays have a varied number of characters, we\u2019ll need to turn to something else. GED is also relatively simple, and rarely captures the underlying structure of a network, so a more nuanced comparison method is needed.", "To solve this, we turn to a 2018 paper published in the International Conference on Knowledge Discovery & Data Mining. These researchers define that two graphs are similar if information would flow through them in similar ways over time\u00b9. The resulting method is called a Network Laplacian Spectral Descriptor, or NetLSD for short. They\u2019re assumption is that information flows through a network similar to how heat diffuses throughout your air ducts. If each node in your network gives off some of its \u201cheat\u201d over time and passes it along the edges to its neighbors, then over time it will produce a signature that captures the network\u2019s structure. So at each time step, all you have to do is sum up the amount of \u201cheat\u201d in the network. This is represented by h(t) and is visualized as the y-axis in the image below. Since each heat trace signature uses the same number of time steps, it\u2019s much easier to compare networks of different sizes. By using this technique they were able to identify between different types of proteins and enzymes with a high level of accuracy (94\u201395%)\u00b9.", "While implementing NetLSD is relatively simple (especially if you use their Python package) it does requires some background knowledge in how computers represent networks and linear algebra. For those who are interested here\u2019s the original paper. Since NetLSD\u2019s inner workings aren\u2019t crucial to our task of classifying comedies and tragedies, I\u2019ll move along.", "Now that we have a way of comparing networks in a meaningful way we can classify different plays. First, we\u2019ll split the 27 plays up into two buckets: our training data, observed plays where we know the genre, and testing data, unknown plays that will be classified. We\u2019ll use our knowledge of the previously observed plays to help classify the unknown ones. Since there are so few plays, I\u2019ll reserve a third of the plays as testing data to validate the model.", "Next we\u2019ll take all of our training data, the plays where we know the genre, and calculate their heat trace signatures.", "Let\u2019s see if there\u2019s a noticeable difference in how heat flows through a comedy vs a tragedy. It\u2019s a little muddled, but it seems like tragedies retain more \u201cheat\u201d than comedies on average. Using these signatures we can start classifying the unknown plays.", "The process for classifying a new play is relatively simple. We calculate the unobserved play\u2019s heat trace signature, and then find the five prior observed plays with the closest heat trace signatures. If the majority of those five are comedies then we label that play as a comedy, otherwise we label it as a tragedy. This is what\u2019s called a k-nearest neighbor (KNN) classifier. KNNs don\u2019t really model anything per say \u2014 which is why I prefer the term priors to training data \u2014 but with so few plays to work with a KNN is a reasonable choice.", "So how\u2019d we do? Well, we were able to correctly classify 7 of the 9 plays in our testing data for a raw accuracy of 77.8%. The testing set contained 7 comedies and 2 tragedies, and we were able to correctly classify all of the tragedies and 5/7 comedies. This shows that comedies and tragedies produce distinct enough structures that we can tell which is which by only looking at the networks.", "While 27 plays is a small sample, I\u2019d argue that the principles of this experiment are sound. A network first approach lets us do something that, at first glance, seem pretty unlikely: we are able to figure out the genre of a play without looking at a single piece of dialogue. Personally, I think that is pretty cool.", "So are you saying this means we don\u2019t care about NLP anymore?", "Obviously not. There\u2019s a ton of rich information in language that\u2019s lost when something like a play is abstracted into a network. However, networks give researchers flexibility to not rely on, or be bound by, language. This goes back to the example of comparing plays in different languages or from different time periods. And the applications don\u2019t stop at comparing plays or movies. Disinformation is often spread en-mass by creating networks of social media bots that retweet and amplify each others fake news to give the illusion of legitimacy. Rather than focusing on what an account is saying, it could be more helpful to see if it\u2019s connection network is similar to networks of disinformation bots that have been taken down. There are plenty of potential applications because networks are so malleable and can be used to represent almost anything. If you want to learn more about network science/graph theory and it\u2019s applications, check out my website below! It has links to all my work.", "[1]: Tsitsulin, Anton, Davide Mottin, Panagiotis Karras, Alexander Bronstein, and Emmanuel M\u00fcller. \u201cNetlsd: hearing the shape of a graph.\u201d In Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining, pp. 2347\u20132356. 2018.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Research Fellow @ Stanford Law School | Oxford MSc | https://cameronraymond.me"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2a6c1c44e17f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cjkraymond?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cjkraymond?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": "Cameron Raymond"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffe7fe51535dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&user=Cameron+Raymond&userId=fe7fe51535dd&source=post_page-fe7fe51535dd----2a6c1c44e17f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a6c1c44e17f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a6c1c44e17f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cameronraymond.me/", "anchor_text": "cameronraymond.me"}, {"url": "https://www.kaggle.com/kingburrito666/shakespeare-plays/", "anchor_text": "Kaggle data-set"}, {"url": "https://www.youtube.com/watch?v=aiPOa1NTgvM", "anchor_text": "Source"}, {"url": "https://pypi.org/project/NetLSD/", "anchor_text": "Python"}, {"url": "https://arxiv.org/abs/1805.10712", "anchor_text": "original paper"}, {"url": "https://cameronraymond.me", "anchor_text": "https://cameronraymond.me"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2a6c1c44e17f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----2a6c1c44e17f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2a6c1c44e17f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/social-network?source=post_page-----2a6c1c44e17f---------------social_network-----------------", "anchor_text": "Social Network"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----2a6c1c44e17f---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2a6c1c44e17f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&user=Cameron+Raymond&userId=fe7fe51535dd&source=-----2a6c1c44e17f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2a6c1c44e17f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&user=Cameron+Raymond&userId=fe7fe51535dd&source=-----2a6c1c44e17f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a6c1c44e17f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2a6c1c44e17f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2a6c1c44e17f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2a6c1c44e17f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cjkraymond?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cjkraymond?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cameron Raymond"}, {"url": "https://medium.com/@cjkraymond/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "82 Followers"}, {"url": "https://cameronraymond.me", "anchor_text": "https://cameronraymond.me"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffe7fe51535dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&user=Cameron+Raymond&userId=fe7fe51535dd&source=post_page-fe7fe51535dd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff693a1e41940&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-shakespeare-with-networks-2a6c1c44e17f&newsletterV3=fe7fe51535dd&newsletterV3Id=f693a1e41940&user=Cameron+Raymond&userId=fe7fe51535dd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}