{"url": "https://towardsdatascience.com/nlp-with-cnns-a6aa743bdc1e", "time": 1683015107.479601, "path": "towardsdatascience.com/nlp-with-cnns-a6aa743bdc1e/", "webpage": {"metadata": {"title": "NLP with CNNs. Convolutional neural networks (CNNs)\u2026 | by Taha Binhuraib | Towards Data Science", "h1": "NLP with CNNs", "description": "Convolutional neural networks (CNNs) are the most widely used deep learning architectures in image processing and image recognition. Given their supremacy in the field of vision, it\u2019s only natural\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "Stanford\u2019s training data.", "paragraph_index": 16}], "all_paragraphs": ["Convolutional neural networks (CNNs) are the most widely used deep learning architectures in image processing and image recognition. Given their supremacy in the field of vision, it\u2019s only natural that implementations on different fields of machine learning would be tried. In this article, I will try to explain the important terminology regarding CNNs from a natural language processing perspective, a short Keras implementation with code explanations will also be provided.", "The concept of sliding or convolving a pre-determined window of data is the central idea behind why CNNs are named the way they are. An illustration of this concept is as below.", "The first thing to notice here is the method by which each word(token) is represented as 3-dimensional word vectors. A weight matrix of 3x3 is then slid horizontally across the sentence by one step(also known as stride) capturing three words at a time. This weight matrix is called a filter; each filter is also composed of an activation function, similar to those used in feed-forward neural networks. Due to some mathematical properties, the activation function ReLU (rectified linear unit) is mostly used in CNNs and deep neural nets. Going back to image classification, the general intuition behind these filters is that, each filter can detect different features of an image, the deeper the filter, the more likely it will capture more complex details, as an example, the very first filters in your Convnet will detect simple features such as edges and lines, but the features at the very back might be able to detect certain animal types. All this is done without hardcoding any of the filters. Backpropagation will ensure that the weights of these filters are learned from the data.The next important step is to calculate the output(convolved feature). For the example, below we will consider a 5*5 image and a 3*3 filter (when dealing with CNNs you will mostly work with square matrices) the output layer is calculated by summing over the element-wise multiplication as each filter slides over the window of data one stride at a time each pixel is multiplied by its corresponding weight in the filter. The example below illustrates how the first cell in the output layer is calculated; the red numbers in the image represent the weights in the filter.", "The python code with the activation function would be:", "In the case of a 2D filter The size of the output layer can be calculated using the following formula:", "N = size of image , F = size of filter S = stride(1 in our case)", "When applied to text you will be using a filter that slides by 3 strides horizontally across the window in 1-Dimension:", "The last two examples resulted in an output size that is smaller than that of the input\u2019s. It also isn\u2019t too hard to imagine cases in which the filter doesn\u2019t exactly fit the matrix with a given number of slides. To counter these complications, padding can be used in two ways:", "Pooling is the equivalent of dimension reduction in CNNs. The central idea is that we have to divide the output layers into subsections and calculate a value that best represents the output. The reason why this is so effective is that it helps the algorithm learn higher-order representations of the data while reducing the number of parameters. Types of pooling:", "Here is an example of max pooling:", "The fully connected layer at the end receives the input from the previous pooling and convolutional layers, it then performs a classification task. In our example, we will be classifying a 300 token window of words into 1-Positive sentiment. 0-negative sentiment. The last neuron in the fully connected layer will take the weighted average of 250 neurons as a sigmoid function(returns a value between (0,1))", "In this section, we will try to keep the code as general as possible for use cases in NLP. To keep things simple, we will not be going into the details of data pre-processing, but the general procedure is to tokenize and vectorize the data. In our example, a word2vec embedding was used, with each token being represented as a 300-Dimension word vector. Our data was also padded so that each sentence contained 400 tokens, long sentences were cut off after 400 tokens, and shorter sentences were zero-padded. The resulting dimension for each sentence is 300*400. We then divide the data into x_train and x_test; we will not be using a validation data set for this project. Now that we have our data ready, we can define some hyperparameters.", "Now we can start building the model using the Keras library.", "Here we that the padding is valid, which means that we will not maintain the input size, the resultant convolved matrix will be of size 100*1. Max pooling layer that takes the maximum value in a window of two.", "We then add the fully connected layer with a dropout rate of 0.2(we use this to counter over-fitting). Lastly, the output neuron will fire based on the sigmoid activation function. Keras will classify anything below 0.5 as 0, and anything above 0.5 as 1", "The final step is to compile and fit the model.", "Now you can sit back and watch as your model trains. We were able to achieve a 90% accuracy using 60% of Stanford\u2019s training data. you can find more details in the 7th chapter of the book: Natural Language Processing in Action.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI and Machine Learning enthusiast. Machine learning engineer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa6aa743bdc1e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://taha-huraibb99.medium.com/?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": ""}, {"url": "https://taha-huraibb99.medium.com/?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": "Taha Binhuraib"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe140ec06a27&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&user=Taha+Binhuraib&userId=e140ec06a27&source=post_page-e140ec06a27----a6aa743bdc1e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6aa743bdc1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6aa743bdc1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "https://en.wikipedia.org/wiki/Convolutional_neural_network"}, {"url": "https://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "Stanford\u2019s training data."}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a6aa743bdc1e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----a6aa743bdc1e---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----a6aa743bdc1e---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a6aa743bdc1e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----a6aa743bdc1e---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa6aa743bdc1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&user=Taha+Binhuraib&userId=e140ec06a27&source=-----a6aa743bdc1e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa6aa743bdc1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&user=Taha+Binhuraib&userId=e140ec06a27&source=-----a6aa743bdc1e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6aa743bdc1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa6aa743bdc1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a6aa743bdc1e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a6aa743bdc1e--------------------------------", "anchor_text": ""}, {"url": "https://taha-huraibb99.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://taha-huraibb99.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Taha Binhuraib"}, {"url": "https://taha-huraibb99.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "70 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe140ec06a27&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&user=Taha+Binhuraib&userId=e140ec06a27&source=post_page-e140ec06a27--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fab2afdfa3852&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-with-cnns-a6aa743bdc1e&newsletterV3=e140ec06a27&newsletterV3Id=ab2afdfa3852&user=Taha+Binhuraib&userId=e140ec06a27&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}