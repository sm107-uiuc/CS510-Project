{"url": "https://towardsdatascience.com/4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b", "time": 1683002397.5833101, "path": "towardsdatascience.com/4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b/", "webpage": {"metadata": {"title": "4 Ways to Improve Train Accuracy For Continuous Targets | by Emma Boudreau | Towards Data Science", "h1": "4 Ways to Improve Train Accuracy For Continuous Targets", "description": "We all know them, and we all work with them. Continuous features can represent prices, GDP, and just about anything quantitative. Continuous targets are targets that are summative, or grow and shrink\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data", "anchor_text": "data-set", "paragraph_index": 20}], "all_paragraphs": ["We all know them, and we all work with them. Continuous features can represent prices, GDP, and just about anything quantitative. Continuous targets are targets that are summative, or grow and shrink in value typically as a result of another feature. A great example of this is always monetary. As ludicrous as it might be, most business analytics revolve around money, (crazy, right?) and most if not all of these monetary targets are continuous.", "Obviously, accuracy is very important when working with continuous predictions, as money is important to a business, gross domestic product is important to a country, income and expenses need to be leveraged in order to ensure stable operation. Nearly every business utilizes some form of analytics, whether that be a Data Analyst (DA), a Data Scientist (DS), or even a Data Engineer (DE).", "So if you\u2019re going to be solving continuous problems, there are some really easy and simple ways to boost your accuracy that are quite effective.", "In order to train an accurate model, we need to know how to validate it. Typically for continuous features, we use three household-metrics:", "Mean absolute error is the summation of the difference between two arrays, ideally y\u00b9 and y hat. This can be done by simply dot subtracting two arrays, and averaging the difference.", "For this metric, the important thing to remember is that lower is better. The lower the score, the less difference there is between our predicted y and our resulting \u0177. To do this in Julia, (seen in the figure), we simply use the .- operator and then get the summation of that, for a formula like this:", "The mean squared error is the summation of the difference squared between two arrays, and is as easy as taking our previous formula, and squaring the resulting difference between y and \u0177 prior to sigma.", "Like MAE, MSE is continuous, and smaller is better. The further away from zero this number is, the less accuracy our model has. One difference here is that the number will (naturally) be bigger.", "Though the other validation was quite trivial and simple to calculate, r\u00b2 is not. r\u00b2 scores are represented as a percentage, and are calculated by first calculating the correlation coefficient (r), and then \u2014 squaring it. In order to calculate the correlation coefficient of regression, we have to first calculate the correlation coefficient.", "We\u2019ve seen how to calculate MAE and MSE, but THIS is how you calculate r. Though it is a tad daunting to look at, once we break it down, it\u2019s pretty simple. The major parts we need to \u201c plug-in\u201d to this equation are n, \u03a3x, \u03a3y, \u03a3xy, \u03a3x\u00b2, and \u03a3y\u00b2. In order to calculate these, just as before; we need to use our dot operators. Of course this is specific to Julia, but it\u2019s not too different for other statistical languages. In Python, use Numpy, in R you can actually just use the * operator (it has a polymorphic property to apply to even arrays, as well as single integers and floats.) So of course, above the s in sx2, sx, sy, etc. is short for sigma or \u03a3 which we can of course get with the base sum() method in most high-level languages. Then it is as easy as plugging the values into the formula,", "It should be noted that typically correlation coefficients used in machine-learning use the Pearson correlation method of calculating r. I would also make it a point to illustrate that r\u00b2 isn\u2019t a good metric for non-regression problems. This includes formulas with weighted coefficients and decision making addition (not typical formula-based regression like ridge regression, linear regression, and LLSQ regression.) Typically you probably should use mean squared error or mean absolute error for things like weighted least squares and ordinary least squares.", "Now that we have the r part of r\u00b2, to get r\u00b2 we quite literally just have to square r. We\u2019ll write a function to do this I suppose, although it\u2019s of course not too difficult to do it by hand.", "Easy! Now we have our third and final metric and can understand accuracy within our models, and get some sort of score.", "Baseline accuracy is an importance that is often understated \u2014 typically a strength of a baseline is that it can tell you if a model is even necessary to predict your features. This is not limited, as this is in addition to other strengths, as usually a baseline is a great starting point. To get a baseline, we could use the Lathe.models.meanBaseline constructor, or write our own function. And based on the way this article has gone so far, you can presume", "We\u2019re going to do the latter.", "But first, let\u2019s use Lathe so you can get an idea of what we\u2019re going to do before we do it from scratch.", "Of course, if we need to, we can use Julia\u2019s help function (?()) to give us information on the model.", "And with that, we get a detailed explanation with an example of how exactly to use the model, so let\u2019s quickly make up some data:", "Now we plug it into the constructor and use our predict() function. Note that I won\u2019t be \u201c using\u201d it, and I\u2019ll explicitly import it. This is so we can modify the Lathe function with polymorphism in order to utilize our own function.", "Now we have our baseline prediction, and we can use the metrics that we made earlier. We\u2019re just going to be using mean absolute error for our baseline.", "The mean absolute error is about 7, but it\u2019s important to consider that the mean of the data is 5, so 7 is actually a pretty terrible accuracy. Of course, this is made up data, so let\u2019s get a data-set off the internet to use in this example, so we can actually improve the accuracy. After a quick look on Kaggle, I came up with this data-set. It should suit us fine for this example. So let\u2019s read it into Julia:", "After some poking around in the (terrible) data-frame view we got as a result of that, this is the data-frame I came up with:", "Now let\u2019s train test split the data, but what can we use? There\u2019s likely a function in Lathe, so let\u2019s check\u2026", "We can presume that a test train split is in the pre-processing module, as the others don\u2019t necessarily fit the bill this time around.", "We\u2019ll be doing exactly what it says to do, and be using ?() on Lathe.preprocess to access information on that module. Doing this reveals the module\u2019s tree, including separate sections for each function.", "Of course, we came here looking for Lathe.preprocess.TrainTestSplit, so we can now use the ?() function on it:", "Which will return all of the details that we need to get our Test Train Splitting done with, including hyper-parameters and syntax:", "Easily ML is the motto for a reason! Now we can use Julia symbols to separate our single feature and target:", "Now let\u2019s extend the prediction function, as promised, in order to write our own Lathe.models.predict() for our NEW mean baseline function using our previous mutable struct. First, we\u2019ll plug our trian y into our new model:", "Now let\u2019s write a function, essentially all that we need to do is append a replacement number (the mean) for each element in our array. We can do this very quickly and concisely by using Lathe.stats.mean() and a simple one line for loop:", "And now we take that and extend it as a property of our mutable struct:", "And now we can validate it with our MAE function from earlier:", "That\u2019s a pretty bad accuracy score! While I didn\u2019t perform any tests for feature selection, we can certainly take this feature a little further by firstly implementing a model, and secondly investing in some pre-processing. For our model, I chose to go with the FourSquare model. The FourSquare model predicts with different regression models based on quartiles, similar to a regression tree \u2014 but it doesn\u2019t use correlations, but instead segments of data. This makes it ideal for time-series data and segmented continuous data. But the issue arises now with our feature:", "We get an accuracy worse than we did with our last model, indicating that this feature might not be the best for predicting this continuous target, as the number of reviews might not very well correlate with the target. Of course, this is our null hypothesis, that there is no correlation between these features. Contrary to popular belief, we can often see this without ever using a statistical test to check. So let\u2019s validate the null hypothesis further by performing a statistical test AND visualizing our data and our model (yay!) I think this also illustrates why the baseline accuracy was important, and segways really well into our first accuracy booster:", "Dropping statistically insignificant features, or in our case (single feature prediction) changing our feature all together is one of the most effective methods we can utilize to improve our accuracy. The old saying really is correct when it comes to this situation:", "Bad data in, bad results out.", "Just from this visualization, its easy to see that for the most part, these features are flat lined together. This means that the feature in this case doesn\u2019t really effect our target that much. Here\u2019s the code I used to create this figure:", "Now let\u2019s see what our model did\u2026", "Luckily, intentionally with the way this code is written, it\u2019s pretty easy to go back and change features. I decided to change our feature to the availability out of the year, as a lower number seems to correspond pretty well with a cheaper price. Of course, we\u2019ll be using a test and \u2014 more visualizations (yay!) to cement this hypothesis with actual support (the science part of data science.)", "So let\u2019s go back in time, and we\u2019ll reconstruct our DataFrame with this new feature:", "With this new feature, another little issue has risen, which is quite common: Nans. So to get rid of our NaNs, we\u2019ll use the dropmissing() function from DataFrames.", "If we wanted to replace these, we could easily by using the package missing:", "And then we\u2019ll replace the symbol where we define our feature and target:", "Now that that\u2019s over with, in order to perform a statistical test, we\u2019ll have to mask our data. A boolean mask allows us to set a conditional for our data to abide by (or otherwise \u2014 be dropped with no mercy.) But first, let\u2019s get this visualization out of the way, because seeing is very much believing in this case.", "By the looks of things, this feature also isn\u2019t the greatest, and we can cement this with a quick F test. So let\u2019s do that boolean mask I talked about earlier:", "Then we\u2019ll plug that into the f_test() function from Lathe.stats.", "So consider our hypothesis: A P value of .05 or less generally means that it is statistically significant to consider rejecting our null hypothesis, right? So a P value of .032 would indicate a pretty decent level of statistical significance, certainly higher than that of what we previously had.", "Let\u2019s face it, sometimes your model might not do the trick. Switching to a gradient regressor, or even building a neural network can sometimes be a very good solution to a complex problem. Though you\u2019re choice will likely be something like XGBoost, for this example I\u2019m just going to be switching back to Linear Regression. Not that this will boost accuracy \u2014 in this example, just something to definitely consider. Of course if Lathe wasn\u2019t in Alpha and we had a few more tools to utilize we could likely go all out with a model and make it very accurate, that and effort vs. reward; i\u2019m alright with this model i\u2019m using for an example not being too accurate.", "Switching our feature and our model has yielded a mean absolute error of", "Given that the mean is 141, this is quite off\u2026 But as always, we have another trick up our sleeve\u2026", "It\u2019s no secret that feature scaling can boost accuracy, and let\u2019s face it: that\u2019s kind-of what it\u2019s there for. For this case, we\u2019ll be using a Standard Scalar, also known as a Z-Score Scalar. This will normalize the data based on the standard deviation. And as you might have expected, we\u2019ll be writing a function to do so.", "The formula for a Z score scalar is:", "Where sigma is the standard deviation, x bar is the sample mean, and x sub bar is the current iteration. So back in the programming mindset, we end up with:", "Now to use our function, we just plug it in and preprocess our xtrain and xtest as we define them:", "In this specific example, this brought our mean absolute error down to", "Which means we\u2019re officially below our baseline.", "Quartile Normalization is another interesting one, where anything outside of the quartile ranges q\u00b3 and q\u00b9 are dropped, centralizing the data around the median (remember, it\u2019s the MEDIAN, not the MEAN.)", "Having an accurate model is awesome, and these Data Science principles can certainly help you get there. Even if your model is fairly accurate, some of these can definitely boost it right up to ninety-eight percent. It\u2019s definitely satisfying when something as simple as a standard scalar can have such an effect on your accuracy score. Hopefully this quick check list helps to illustrate some very important ideas and philosophies. If you were to do one out of this entire list I would recommend selecting good features. The bottom line is that no matter what, your feature is the only thing your algorithm has to go off of. And with that, happy machine-learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1309276fa54b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1309276fa54b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1309276fa54b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://emmettgb.medium.com/?source=post_page-----1309276fa54b--------------------------------", "anchor_text": ""}, {"url": "https://emmettgb.medium.com/?source=post_page-----1309276fa54b--------------------------------", "anchor_text": "Emma Boudreau"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fea170050148c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&user=Emma+Boudreau&userId=ea170050148c&source=post_page-ea170050148c----1309276fa54b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1309276fa54b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1309276fa54b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/emmettgb/Emmetts-DS-NoteBooks/blob/master/Julia/Improve%20Continuous%20Accuracy.ipynb", "anchor_text": "(notebook)"}, {"url": "https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data", "anchor_text": "data-set"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1309276fa54b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1309276fa54b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----1309276fa54b---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----1309276fa54b---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/statistics?source=post_page-----1309276fa54b---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1309276fa54b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&user=Emma+Boudreau&userId=ea170050148c&source=-----1309276fa54b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1309276fa54b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&user=Emma+Boudreau&userId=ea170050148c&source=-----1309276fa54b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1309276fa54b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1309276fa54b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1309276fa54b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1309276fa54b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1309276fa54b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1309276fa54b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1309276fa54b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1309276fa54b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1309276fa54b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1309276fa54b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1309276fa54b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1309276fa54b--------------------------------", "anchor_text": ""}, {"url": "https://emmettgb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://emmettgb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Emma Boudreau"}, {"url": "https://emmettgb.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.6K Followers"}, {"url": "https://twitter.com/emmettboudgie", "anchor_text": "https://twitter.com/emmettboudgie"}, {"url": "https://github.com/emmettgb", "anchor_text": "https://github.com/emmettgb"}, {"url": "https://ems.computer/", "anchor_text": "https://ems.computer/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fea170050148c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&user=Emma+Boudreau&userId=ea170050148c&source=post_page-ea170050148c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff16bf42bb45f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-ways-to-improve-train-accuracy-for-continuous-targets-1309276fa54b&newsletterV3=ea170050148c&newsletterV3Id=f16bf42bb45f&user=Emma+Boudreau&userId=ea170050148c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}