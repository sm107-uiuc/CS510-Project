{"url": "https://towardsdatascience.com/a-look-at-the-maths-behind-linear-regression-e9616ca0598", "time": 1683017837.8758578, "path": "towardsdatascience.com/a-look-at-the-maths-behind-linear-regression-e9616ca0598/", "webpage": {"metadata": {"title": "A Look at the Maths Behind Linear Regression | by Dhruva Krishna | Towards Data Science", "h1": "A Look at the Maths Behind Linear Regression", "description": "This article is a continuation from my previous article, which provides an introduction to the concepts of machine learning. If you haven\u2019t read it already, it\u2019s definitely worth checking out\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/your-historical-theoretical-and-slightly-mathematical-introduction-to-the-world-of-machine-862b94fe8353", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://medium.com/r?url=https%3A%2F%2Ftowardsdatascience.com%2Fyour-historical-theoretical-and-slightly-mathematical-introduction-to-the-world-of-machine-862b94fe8353", "anchor_text": "article", "paragraph_index": 12}, {"url": "https://dhruva-krishna.medium.com/", "anchor_text": "page", "paragraph_index": 37}], "all_paragraphs": ["This article is a continuation from my previous article, which provides an introduction to the concepts of machine learning. If you haven\u2019t read it already, it\u2019s definitely worth checking out!", "Regression is a machine learning task where we have a real-valued outcome in a continuous sub space. Basically, this means that our outcome is a continuous variable, but that it is usually confined to some sort of range.", "Examples of regression include age estimation, stock value prediction, temperature prediction.", "Mathematically, we can represent this as follows:", "The R is the set of all real numbers. This includes all natural numbers, integers, rational and irrational numbers.", "So in linear regression, we take a set of inputs, which we represent as X and attempt to match these to their respective continuous value outputs, which we call y. We can represent this as a tuple {X, y}.", "Input variables consist of a collection of features, each of which represent a unique observation about our output (a \u201cfeature\u201d of the output if you will). As an example, 3 features \u2014 weight, height and gender might be used to predict life expectancy.", "The number of features in a dataset is also called the dimensionality of that dataset.", "In univariate linear regression (regression with just one explanatory variable or feature), a linear regression model is created through a straight line estimation of our outputs. From graph theory, we know this line will take the form y = mx + c, where m is the gradient of the line and c is the y-intercept. In ML theory, we convert this into an estimation function using w\u2019s or theta\u2019s, which represent our weights.", "The above information is summarised in the following image:", "Weights are determined by the model, so they are intrinsic parameters. They can be thought of as our model assigning a \u201crelevance figure\u201d to each variable as to how much it relates to the output. The higher the weight, the more influence that feature has on the model output and the better descriptor it is therefore of said output.", "Our learning algorithm will take all of these components, the training set, the model h that we provide and the solution space that contains all possible values of our weights, and find the solution s^hat that minimises a cost function. s^hat is essentially an array which contains a value for each weight that provides us with an optimal solution.", "The cost function is our performance metric from the definitions of machine learning we declared in the previous article. The cost function will compare the model output with the actual outputs. So our linear regression model will cycle through a series of weight combinations to find that combination that returns the lowest cost function.", "In order to derive a cost function, we can begin by considering how to measure the closeness of the fit. We want to find out how close our estimated value is to actual value.", "In the diagram above, we have drawn an estimation line that is completely determined by its weights. To calculate the absolute error for one instance, we calculate the absolute difference between our datapoint and its vertical distance to the estimation line, which is its estimated value.", "In order to convert this into a performance metric, we look at the squared error, which modifies the concept of the absolute error, turning it into a measure we can apply to our entire dataset. To calculate the squared error, we sum the squared differences of our estimated value and the actual value.", "The usage of the square becomes very important later on when we look at algorithms that find the best weight combinations. Algorithms such as Gradient Descent, the most commonly used optimisation algorithm, requires the performance function to be differentiable and this squared error function satisfies that requirement.", "So we have the squared error, which takes the idea of our absolute error and applies it to our entire dataset. We now need to turn this into a cost function that will serve as the objective of our model.", "So we should remind ourselves what we are looking for in a cost function here and how this relates to linear regression. We want a function that provides us with an idea of how bad our model is in estimating our dataset. With this objective, we are then looking to minimise this function, as the smaller the value the \u201cless-bad\u201d our model is.", "To produce this, we adapt our squared error into a mean squared error that helps us estimate our model across the entire dataset. We divide the squared error by 2n because of the presence of our squared term. Since 1/2 is a constant, we do not alter the information the cost function gives us by including this, but we have a cleaner result when differentiating this in weight optimisation algorithms.", "Most datasets in the real world will incorporate much more than one variable, so whilst univariate linear regression is our essential foundation, its principles are used to build more complex functions with more than one variable, a model we call multivariate linear regression.", "Multivariate line regression can be split into two different types \u2014 with a first order polynomial or with a higher order polynomial.", "The order of a function is the greatest power term that that function contains e.g. a polynomial of order two will contain an x\u00b2 term and no terms with a higher order, a polynomial of order 3 will contain an x\u00b3 term and no terms with a higher order.", "In multivariate linear regression with a first order polynomial, our model is the sum of the product of each feature with a weight term. This is essentially a continuation of sorts of our univariate function.", "Degrees of freedom are the number of variables that we/the model has the opportunity to change to fit the data better.", "This is a useful metric to be aware of as we go forward, because there is a trade off with the number of degrees of freedom we have. More degrees freedom does mean more control over the outputs and affords us a greater amount of flexibility and adaptability, but this also increases the number of combinations of weights and subsequently training time will increase too. We might be able to adjust to a wider range of scenarios with more degrees of freedom, but we have to decide whether this is worth it considering the intensity it requires to calculate.", "The first order polynomial model has d+1 degrees of freedom, where d is the dimensionality of the feature vectors as defined before.", "The second type of multivariate linear regression is with a higher order polynomial. This is a polynomial in which the order is greater than 1. The higher order polynomial offers a function with more complexity than the single order one.", "This equation has k*d+1 degrees of freedom, where k is the order of the polynomial. Below is an example for deriving a polynomial function of order 2 with a training set of 3 features.", "One method we could use to find the best combination of weights is brute force. Brute force essentially iterates through every single possible combination of weights, calculates our cost function when those weights are used and then moves onto the next combination. After all combinations are tried, the weights that return the lowest cost function are then used. This is a method that is guaranteed to find the best combination, what we call the global minima, but the time it takes to converge to the this combination rises exponentially as the number of degrees of freedom rises.", "The main method used to find the best combination of weights is gradient descent. Gradient Descent uses the following procedure:", "Stage 2 of the gradient descent algorithm, the equation for which is in the image above, shows us exactly why we need our cost function to be differentiable. The algorithm we iterate over takes our current weight and subtracts from it the differentiated cost function multiplied by what is called a learning rate. The size of the learning rate will determine how quickly we converge to or diverge from the minimum value.", "So since our cost function has a squared term, we know it takes the shape of a second order polynomial, so essentially a U-shape. By differentiating the cost function at each step of our gradient descent algorithm, we can find out the gradient of the point at which our cost function is at presently. Knowing that our optimal value, or the lowest possible cost value occurs at a gradient of 0, we now know which direction we need to travel in order to ensure we are consistently moving towards this value. At each iteration therefore, we move slightly closer to this combination of weights that return our minimum cost value.", "Let us look at a diagram for why learning rates are important", "In gradient descent, during one iteration, we update all of our weights at the same time.", "The learning rate dictates how quickly we reach the minimum value. There is a trade off however, in the learning rate that we set. We want a learning rate that isn\u2019t too low, because it will take a long time to find the optimal value. A learning rate too high however, and our function might diverge, never actually reaching the optimal value. We need to find a value that will converge at the correct rate.", "There\u2019s no hard and fast rule for setting a learning rate. Typically it is determined by iteratively running through multiple models, each with a different learning rate and selecting the one you are most satisfied with. Typically though, a learning rate ranges from 0.001 to 0.1.", "That\u2019s your mathematical introduction to Linear Regression. I\u2019m looking to go through a lot more concepts in more detail in further articles, so keep an eye out for those! Linear Classification is up next. If you\u2019re interested in any of my previous articles, give my page a follow as well. Until then, \u270c\ufe0f.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe9616ca0598&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e9616ca0598--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e9616ca0598--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dhruva-krishna.medium.com/?source=post_page-----e9616ca0598--------------------------------", "anchor_text": ""}, {"url": "https://dhruva-krishna.medium.com/?source=post_page-----e9616ca0598--------------------------------", "anchor_text": "Dhruva Krishna"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6df1f342365&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&user=Dhruva+Krishna&userId=b6df1f342365&source=post_page-b6df1f342365----e9616ca0598---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9616ca0598&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9616ca0598&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/your-historical-theoretical-and-slightly-mathematical-introduction-to-the-world-of-machine-862b94fe8353", "anchor_text": "article"}, {"url": "https://unsplash.com/@isaacmsmith?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Isaac Smith"}, {"url": "https://unsplash.com/s/photos/graph?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/r?url=https%3A%2F%2Ftowardsdatascience.com%2Fyour-historical-theoretical-and-slightly-mathematical-introduction-to-the-world-of-machine-862b94fe8353", "anchor_text": "article"}, {"url": "https://dhruva-krishna.medium.com/", "anchor_text": "page"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e9616ca0598---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----e9616ca0598---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e9616ca0598---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e9616ca0598---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/statistical-analysis?source=post_page-----e9616ca0598---------------statistical_analysis-----------------", "anchor_text": "Statistical Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe9616ca0598&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&user=Dhruva+Krishna&userId=b6df1f342365&source=-----e9616ca0598---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe9616ca0598&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&user=Dhruva+Krishna&userId=b6df1f342365&source=-----e9616ca0598---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9616ca0598&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e9616ca0598--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe9616ca0598&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e9616ca0598---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e9616ca0598--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e9616ca0598--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e9616ca0598--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e9616ca0598--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e9616ca0598--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e9616ca0598--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e9616ca0598--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e9616ca0598--------------------------------", "anchor_text": ""}, {"url": "https://dhruva-krishna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dhruva-krishna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dhruva Krishna"}, {"url": "https://dhruva-krishna.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "462 Followers"}, {"url": "https://algofin.substack.com", "anchor_text": "https://algofin.substack.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6df1f342365&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&user=Dhruva+Krishna&userId=b6df1f342365&source=post_page-b6df1f342365--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3b127a4b973&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-look-at-the-maths-behind-linear-regression-e9616ca0598&newsletterV3=b6df1f342365&newsletterV3Id=3b127a4b973&user=Dhruva+Krishna&userId=b6df1f342365&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}