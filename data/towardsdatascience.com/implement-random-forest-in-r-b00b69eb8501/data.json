{"url": "https://towardsdatascience.com/implement-random-forest-in-r-b00b69eb8501", "time": 1683000359.24302, "path": "towardsdatascience.com/implement-random-forest-in-r-b00b69eb8501/", "webpage": {"metadata": {"title": "Implementing Random Forest in R. A Practical Application of Random\u2026 | by Joe Tran | Towards Data Science", "h1": "Implementing Random Forest in R", "description": "In order to understand RF, we need to first understand about decision trees. Rajesh S. Brid wrote a detailed article about decision trees. We will not go too much in details about the definition of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@rajesh_brid?source=post_page-----dc506a403aeb----------------------", "anchor_text": "Rajesh S. Brid", "paragraph_index": 0}, {"url": "https://medium.com/greyatom/decision-trees-a-simple-way-to-visualize-a-decision-dc506a403aeb", "anchor_text": "a detailed article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "Here", "paragraph_index": 2}, {"url": "https://bit.ly/3FElqxG", "anchor_text": "https://bit.ly/3FElqxG", "paragraph_index": 32}], "all_paragraphs": ["In order to understand RF, we need to first understand about decision trees. Rajesh S. Brid wrote a detailed article about decision trees. We will not go too much in details about the definition of decision trees since that is not the purpose of this article. I just want to quickly summarise a few points. A decision tree is series of Yes/No questions. For each level of the tree, if your answer is Yes, you fall into a category, otherwise, you will fall into another category. You will answer this series of Yes/No questions until you reach the final category. You will be classified into that group.", "Trees work well with the data we use to train, but they are not performing well when it comes to new data samples. Fortunately, we have Random Forest, which is a combination of many decision trees with flexibility, hence resulting in an improvement in accuracy.", "Here I will not go too much into details about RF because there are various sources outside we can get to understand what is the mathematics behind it. Here is one of them.", "This article is more about practical application of RF in classifying cancer patients, so I will jump straight into the coding part. Now let\u2019s open Rstudio and get our hands dirty :)", "First of all, we need to load the following packages. If you cannot load them, chances are you have not installed them yet. So please do so first before loading the following packages.", "I read the data directly from the web link and name the dataset as Wisconsin. Let\u2019s inspect the data a little bit", "V1 is the ID so it is not relevant in our analysis here. V2 is the classification result, with \u2018M\u2019 standing for \u2018Malignant\u2019 and \u2018B\u2019 standing for \u2018Benign\u2019. The rest is just the variables of information about the cancer diagnosis.", "Now I would like to change M and B to TRUE and FALSE for easier interpretation.", "First, we shuffle the data and split it into train and test. We decide a 70\u201330 split for this.", "We should note that RF only works when the response variable is a factor. Just now when we convert \u2018M\u2019 and \u2018B\u2019 into TRUE and FALSE, the type of this variable is logical. Hence we need to convert it into factor by using factor() function.", "Now let\u2019s combine x and y to form training and test set.", "The training set will be used to train the RF model and the test set will be used to test the performance of the model. Now let\u2019s give the name to our response variable. Here I named it as \u2018label\u2019", "Now everything is ready. We can start fitting the model. This step is easy.", "The \u2018randomForest()\u2019 function in the package fits a random forest model to the data. Besides including the dataset and specifying the formula and labels, some key parameters of this function includes:", "1. ntree: Number of trees to grow. The default value is 500.", "2. mtry: Number of randomly selected variables for each split. In this example we use the square root of p (p denotes the number of predictors). Note that for regression analysis the general rule is to use mtry = p/3 and is also the default value of this parameter for regression.", "3. importance: If True, the model will calculate the feature importance for further analysis. (default = False)", "4. proximity: If True, the model will contain a N*N matrix which represents the proximity measure.", "5. maxnodes: The maximum number of terminal nodes the trees can have.", "6. na.action: A function to specify how the missing data should be treated.", "Since there are 30 independent variables, we set mtry to be square root of 30 and then fit the model", "That is it. Simple isn\u2019t it? Now we already have a RF model", "The Out-of-bag OOB error estimate rate is 3%, which is very good, i.e. 97% accuracy. If we look at the Confusion Matrix, we can see that classification error is quite low. This shows that our RF model is performing well in classifying the train set.", "Let\u2019s test the model with our test set.", "Looks like our model is performing well on the test set too, with the accuracy of 95%.", "Another way for us to visualise the plot is to use ggplot package. Do note that the code below is to visualize the \u2018Mean Decrease Accuracy\u2019. To get the \u2018Mean Decrease Gini\u2019, simply change the line in bold below to \u2018MeanDecreaseAccuracy\u2019 (no spacing).", "The result is similar to the plot we obtained earlier. The result shows that variables V25, V30, V26 and V23 are the most important.", "Using Mean Decrease Gini, we get V25, V23, and V26 as the most important variables.", "This article shows how to implement a simple Random Forest model in solving classification problems. I did not go too deep into how to tune the parameters in order to optimize the model because with such a high accuracy in classification, I think that a simple model would be enough. HOWEVER, in real life, there are other much more complicated classification problems that require us to tune the parameters to obtain the best model, which I will write a separate article on next time. But it is important to remember to ALWAYS start with a simple model and then from there build up the model to get a better prediction.", "Thank you for your time. I hope this article helps you guys, especially those who have never tried implementing RF in R before, gain a better idea of how to do it. Let me know if you have any comments or questions.", "Have a great day and happy programming :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Ex-Google | Product Analytics | MLOps | Subscribe to receive my stories \ud83d\udcc8: https://bit.ly/3FElqxG"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb00b69eb8501&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@joetrankang?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joetrankang?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": "Joe Tran"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F60093eff6455&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&user=Joe+Tran&userId=60093eff6455&source=post_page-60093eff6455----b00b69eb8501---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb00b69eb8501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb00b69eb8501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ruralexplorer?utm_source=medium&utm_medium=referral", "anchor_text": "Rural Explorer"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@rajesh_brid?source=post_page-----dc506a403aeb----------------------", "anchor_text": "Rajesh S. Brid"}, {"url": "https://medium.com/greyatom/decision-trees-a-simple-way-to-visualize-a-decision-dc506a403aeb", "anchor_text": "a detailed article"}, {"url": "https://www.aitimejournal.com/@akshay.chavan/a-comprehensive-guide-to-decision-tree-learning", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "Here"}, {"url": "https://archive.ics.uci.edu/ml/machine-learning-databases/", "anchor_text": "https://archive.ics.uci.edu/ml/machine-learning-databases/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b00b69eb8501---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/random-forest?source=post_page-----b00b69eb8501---------------random_forest-----------------", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b00b69eb8501---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b00b69eb8501---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/classification?source=post_page-----b00b69eb8501---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb00b69eb8501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&user=Joe+Tran&userId=60093eff6455&source=-----b00b69eb8501---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb00b69eb8501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&user=Joe+Tran&userId=60093eff6455&source=-----b00b69eb8501---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb00b69eb8501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb00b69eb8501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b00b69eb8501---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b00b69eb8501--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b00b69eb8501--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b00b69eb8501--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b00b69eb8501--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joetrankang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joetrankang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Joe Tran"}, {"url": "https://medium.com/@joetrankang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "711 Followers"}, {"url": "https://bit.ly/3FElqxG", "anchor_text": "https://bit.ly/3FElqxG"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F60093eff6455&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&user=Joe+Tran&userId=60093eff6455&source=post_page-60093eff6455--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F989ea71b7e15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-random-forest-in-r-b00b69eb8501&newsletterV3=60093eff6455&newsletterV3Id=989ea71b7e15&user=Joe+Tran&userId=60093eff6455&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}