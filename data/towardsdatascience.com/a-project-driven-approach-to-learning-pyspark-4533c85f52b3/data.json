{"url": "https://towardsdatascience.com/a-project-driven-approach-to-learning-pyspark-4533c85f52b3", "time": 1683016898.056183, "path": "towardsdatascience.com/a-project-driven-approach-to-learning-pyspark-4533c85f52b3/", "webpage": {"metadata": {"title": "A Project-driven Approach to Learning PySpark (Part 1) | by Henok Yemam | Towards Data Science", "h1": "A Project-driven Approach to Learning PySpark (Part 1)", "description": "I have come across several frustrating tutorials on PySpark promising to teach me PySpark in under five minutes. They are click baits and lack the necessary depth to get me started and keep me\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/henokyemam/Wrangling_PySpark", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#creating-an-environment-with-commands", "anchor_text": "a new conda environment", "paragraph_index": 1}, {"url": "https://www.datacamp.com/community/tutorials/installation-of-pyspark", "anchor_text": "link", "paragraph_index": 1}, {"url": "http://acme.byu.edu/wp-content/uploads/2020/01/Spark.pdf", "anchor_text": "Spark", "paragraph_index": 2}, {"url": "https://spark.apache.org/docs/latest/api/python/pyspark.sql.html", "anchor_text": "source", "paragraph_index": 4}, {"url": "https://github.com/henokyemam/Wrangling_PySpark/blob/main/02_SparkTraining.ipynb", "anchor_text": "notebook", "paragraph_index": 11}, {"url": "https://www.youtube.com/watch?v=3kX5ry0RCOQ&list=PL3N9eeOlCrP7MKqbOG3WL_zSJrEmJXLPx", "anchor_text": "Apache Spark For Data Scientist", "paragraph_index": 13}], "all_paragraphs": ["I have come across several frustrating tutorials on PySpark promising to teach me PySpark in under five minutes. They are click baits and lack the necessary depth to get me started and keep me rolling. So, I decided to write an article in hopes of helping others like myself with a project-driven tutorial as opposed to showing you code snippets and know-hows. I will primarily focus on a list of problems and use PySpark to answer the questions. You may follow along by grabbing the dataset and code here. At the end of this article, I have also included excellent resources I enjoyed learning from. Happy Learning!", "I advise you to start this journey by creating a new conda environment to avoid conflicts and enjoy your learning with fewer obstacles. Below is a code snippet of what I used to install PySpark, you may follow along with the same code if you are using a mac. Otherwise, check this link for easy to follow step-by-step instruction.", "PySpark is an excellent python gateway to the Apache Spark ecosystem. It allows you to parallelize your data processing across distributed nodes or clusters. That may not mean much to you if you are just working on a single laptop and not on the cloud. But that doesn't mean you still can\u2019t take advantage of the API to learn how to integrate it into your data science workflow. I have learned to enjoy PySpark\u2019s smooth integration of SQL with data frames. If you know the basics of SQL and simple pandas dataframe manipulations, then you will certainly appreciate the intuitive PySpark\u2019s SQL function.", "Let\u2019s start by importing the necessary modules.", "I use SparkSession which is the entry point to programming Spark with the Dataset and DataFrame API (source).", "Now the fun begins. Just like Panda\u2019s dataframe, PySpark can open several types of file types. For simplicity, I have chosen to use CSV files.", "You may recall panda\u2019s dataframe.head() that shows the top five rows and you may be turned off by the poor aesthetics of PySparks output. You worry not, my friend, there is an easy fix for this by converting the top five rows of your PySpark dataframe to Pandas dataframe. However, I caution you to not be too attached to this command as that defeats the purpose of learning PySpark. This point will come more clear as you get more experience working with PySpark. Notice that the code below and the one after that are self-explanatory with functions like withColumnRenamed, limit, and toPandas. As with all things Python, the syntax is beginner-friendly and intuitive.", "Ok, let\u2019s answer the first leading question.", "To answer this question, it requires a bit of data manipulation. I have chosen the most straight forward approach so it\u2019s easier to follow. The design is to aggregate the home and away game results separately creating two dataframes: home and away.", "Then, inner join them on \u2018Team\u2019 and \u2018Season\u2019 fields to create a single dataframe containing game level aggregation: table. After that, I use a basic window function to further aggregate game statistics on season level and rank them based on winning percentage and goal differentials. The reason why I added goal differentials is because it\u2019s used as a tie-breaker in soccer.", "The result you get at the end is:", "Bayern Munich looks like they won the Bundesliga 6 times during 2000\u20132010! Was the code easy to read and follow? With a bit of SQL knowledge, you could also dive into the data and answer the rest of the leading questions. I have answered them in this notebook, feel free to compare your solution with mine.", "Last but not least, as promised earlier, I used the following resources to get myself started with PySpark. I hope you find my project-driven approach to learning PySpark a better way to get yourself started and get rolling. I would advise you to pick a dataset that you like to explore and use PySpark to do your data cleaning and analysis instead of using Pandas. At first, it may be frustrating to keep looking up the syntax. But with a bit of patience, you will soon realize how powerful and intuitive PySpark is. Once you have the experience of working on your own laptop (single node cluster), upgrading to a multi-node cluster databricks environment will be a smoother transition. Happy learning!", "Apache Spark For Data Scientist (YouTube)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hi, I am a data scientist with experience working at Microsoft and currently at FINRA. Every comment or article I write on Medium is my personal opinion."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4533c85f52b3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://henokyemam.medium.com/?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": ""}, {"url": "https://henokyemam.medium.com/?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": "Henok Yemam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb253de4ec8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&user=Henok+Yemam&userId=b253de4ec8&source=post_page-b253de4ec8----4533c85f52b3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4533c85f52b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4533c85f52b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://images.unsplash.com/photo-1517594422361-5eeb8ae275a9?ixlib=rb-1.2.1&auto=format&fit=crop&w=1500&q=80", "anchor_text": "Source"}, {"url": "https://github.com/henokyemam/Wrangling_PySpark", "anchor_text": "here"}, {"url": "https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#creating-an-environment-with-commands", "anchor_text": "a new conda environment"}, {"url": "https://www.datacamp.com/community/tutorials/installation-of-pyspark", "anchor_text": "link"}, {"url": "http://acme.byu.edu/wp-content/uploads/2020/01/Spark.pdf", "anchor_text": "Spark"}, {"url": "https://spark.apache.org/docs/latest/api/python/pyspark.sql.html", "anchor_text": "source"}, {"url": "https://github.com/henokyemam/Wrangling_PySpark/blob/main/02_SparkTraining.ipynb", "anchor_text": "notebook"}, {"url": "https://sparkbyexamples.com/pyspark-tutorial/#what-is-pyspark", "anchor_text": "Spark By Examples"}, {"url": "https://spark.apache.org/docs/latest/api/python/pyspark.sql.html", "anchor_text": "PySpark SQL Module"}, {"url": "https://www.youtube.com/watch?v=3kX5ry0RCOQ&list=PL3N9eeOlCrP7MKqbOG3WL_zSJrEmJXLPx", "anchor_text": "Apache Spark For Data Scientist"}, {"url": "https://www.sqlite.org/windowfunctions.html#:~:text=A%20window%20function%20is%20an,it%20is%20a%20window%20function.", "anchor_text": "Window Functions"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----4533c85f52b3---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/data-wrangling?source=post_page-----4533c85f52b3---------------data_wrangling-----------------", "anchor_text": "Data Wrangling"}, {"url": "https://medium.com/tag/big-data?source=post_page-----4533c85f52b3---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/sql?source=post_page-----4533c85f52b3---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/python?source=post_page-----4533c85f52b3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4533c85f52b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&user=Henok+Yemam&userId=b253de4ec8&source=-----4533c85f52b3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4533c85f52b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&user=Henok+Yemam&userId=b253de4ec8&source=-----4533c85f52b3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4533c85f52b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4533c85f52b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4533c85f52b3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4533c85f52b3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4533c85f52b3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4533c85f52b3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4533c85f52b3--------------------------------", "anchor_text": ""}, {"url": "https://henokyemam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://henokyemam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Henok Yemam"}, {"url": "https://henokyemam.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb253de4ec8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&user=Henok+Yemam&userId=b253de4ec8&source=post_page-b253de4ec8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7c0c75b2c494&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-project-driven-approach-to-learning-pyspark-4533c85f52b3&newsletterV3=b253de4ec8&newsletterV3Id=7c0c75b2c494&user=Henok+Yemam&userId=b253de4ec8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}