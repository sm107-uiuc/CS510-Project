{"url": "https://towardsdatascience.com/explore-image-augmentations-using-a-convenient-tool-a199b4ac8214", "time": 1683001887.391506, "path": "towardsdatascience.com/explore-image-augmentations-using-a-convenient-tool-a199b4ac8214/", "webpage": {"metadata": {"title": "Explore image augmentations using a convenient tool | by Ilia Larchenko | Towards Data Science", "h1": "Explore image augmentations using a convenient tool", "description": "Image augmentation is an essential concept, but it is hard to have an intuitive understanding of different transforms. I present a tool to explore the Albumentations library and get this intuition."}, "outgoing_paragraph_urls": [{"url": "https://github.com/albumentations-team/albumentations", "anchor_text": "Albumentations library", "paragraph_index": 1}, {"url": "https://albumentations-demo.herokuapp.com/", "anchor_text": "follow this link right now", "paragraph_index": 3}, {"url": "https://github.com/IliaLarchenko/albumentations-demo", "anchor_text": "the source code and run it locally", "paragraph_index": 3}, {"url": "https://github.com/albumentations-team/albumentations", "anchor_text": "Albumenatations", "paragraph_index": 10}, {"url": "https://github.com/albumentations-team/albumentations/blob/master/notebooks/showcase.ipynb", "anchor_text": "showcase notebook", "paragraph_index": 12}, {"url": "https://www.kaggle.com/c/severstal-steel-defect-detection/discussion/114254", "anchor_text": "Augmentations used by the winner", "paragraph_index": 17}, {"url": "https://www.kaggle.com/c/recursion-cellular-image-classification/discussion/110543#latest-648051", "anchor_text": "Augmentations used by the winner", "paragraph_index": 19}, {"url": "https://www.kaggle.com/c/siim-acr-pneumothorax-segmentation/discussion/107824#latest-650999", "anchor_text": "Augmentations used by the winner", "paragraph_index": 22}, {"url": "https://arxiv.org/abs/1805.09501", "anchor_text": "paper about AutoAugment", "paragraph_index": 30}, {"url": "https://albumentations-demo.herokuapp.com/", "anchor_text": "https://albumentations-demo.herokuapp.com/", "paragraph_index": 37}, {"url": "https://streamlit.io/", "anchor_text": "Steamlit framework", "paragraph_index": 38}, {"url": "https://github.com/IliaLarchenko/albumentations-demo", "anchor_text": "https://github.com/IliaLarchenko/albumentations-demo", "paragraph_index": 43}, {"url": "http://linkedin.com/in/larchenko/", "anchor_text": "linkedin.com/in/larchenko/", "paragraph_index": 47}], "all_paragraphs": ["Image augmentation is an essential concept that became an industry-standard in Computer Vision. It makes ML models more precise and robust, improves generalization, and helps to create high accuracy models with minimal data.", "There are ready to use tools to apply different transformations to your training pipeline. My choice is Albumentations library", "But to use it effectively, you should understand how it works. In this article, I will tell you how to choose the right set of transformations and present you with a simple tool for the visualization and exploration of different augmentation techniques.", "If you are familiar with the \u201caugmentations\u201d concept and already use Albumentations, you can follow this link right now; there you can play with different transformations in the interactive interface and see the result in real-time (like on a gif above), or you can even take the source code and run it locally.", "Otherwise, I advise you to continue reading and check it afterward.", "Merely speaking, augmentation is a technique of generating additional training samples from the existing ones.", "Let\u2019s imagine you are training a CV model to classify images with \u2018cats\u2019 and \u2018dogs.\u2019 But for some reason, you have only a few training images.", "But it is always good to show your model as much training image as possible. The easiest way to get new samples without making new photos is to change the existing image a bit:", "As a result, you will get a lot of new images that will still be images of the dog and will tell the model a piece of important information: \u201cthe rotated image of the dog is still an image of the dog.\u201d", "Finally, you can apply some stronger transformations that in some cases also can be useful (as far as we can recognize the dog on these images):", "Nowadays, you don\u2019t need to make all these transforms by your hands; there are some libraries with ready to use implementations. And my favorite one is Albumenatations.", "Albumenatations is a widely used image augmentations library created by Computer Vision specialists, Kaggle Masters and Grandmasters. You can find dozens of different transforms implemented in a very computationally efficient way.", "You can start using it right now (if you don\u2019t use it yet) following the examples from the showcase notebook.", "There are some standard sets of transformations that work quite well on most tasks (flips, rotations, resize), but there is no silver bullet, and every particular job has its optimal combination.", "Let\u2019s look at the recent Kaggle competitions and see what augmentations were used by the winners.", "Note: below I list summary from the writeups of 1st place solutions, a lot of them have used Albumentations but not all. For consistency, I have used Albumentations names to describe transforms, where it is applicable.", "Task: find different types of defects on steel plates", "Augmentations used by the winner :", "Task: disentangle experimental noise from real biological signals on special 6-channels images", "Augmentations used by the winner :", "Task: find diabetic retinopathy on retina images", "Task: identify Pneumothorax disease in chest x-rays", "Augmentations used by the winner :", "Task: segment apparel and classify attributes", "Computer vision models can be applied to other domains, and so do augmentations. For example, in audio processing, most of the SOTA algorithms convert raw audio into Mel-spectrograms and process them as normal images.", "Task: recognize sounds and apply tags of varying natures", "As you can see in most of the examples, similar sets of basic transformations were used, but more complex ones are specific for each particular task. Moreover, not only transformations but also their parameters are important, look at these images of parrot.", "All of them (except the original one) are the results of Downscale transformation with the same scale (0.25) but different interpolation methods \u2014 the parameter that doesn\u2019t seem to be very important at first glance. But the results are quite different.", "Sometimes the logic behind choosing transforms is clear: when you work with images from a microscope you can easily rotate it 360 degrees, when you work with people\u2019s photos in the most cases rotation should be much more moderate. Sometimes unexpected things can work like RandomResizedCrop in the Freesound competitions as it contradicts the physical meaning of the spectrogram. Some cases are questionable from a common-sense standpoint and not obvious. For example, should we apply Horizontal flip to x-rays images and use the resulting photos with unusual sides of organs on it?", "All these questions should be answered for each particular task independently. Even when you work with different datasets from the same domain, you can end up with different best sets of transformation.", "There are some tries to automate this process. Just check out this paper about AutoAugment. But now it is mostly scientific exercises but not the production techniques. And the hard work should be done manually.", "The best way to chose augmentation policy is by trials and error \u2014 the set of transformations and their parameters that leads you to the best metric values on the Cross-Validation or the Test set is the best one.", "But there are rules of thumb on how to do it faster. The common augmentation search approach consists of 3\u20134 steps:", "Finally, you will come up with the best combination of transforms.", "The final choice is always made based on metrics, but your experience, intuition, and common sense can help to find the solution faster.", "Some transforms are intuitively clear, for example, Crop \u201ccrops the central part of the input.\u201d And it has only two parameters \u201c height\u201d and \u201cwidth\u201d of the crop.", "But the complex ones like RandomRain are much less intuitive and may have up to 10 different params. It is tough to imagine the result of altering them in your head.", "That is why I have created the service for experimenting with different transformations, online version of it is available here https://albumentations-demo.herokuapp.com/", "I have used the excellent Steamlit framework to create a convenient interface.", "You can choose any transformation you want and tweak the parameters with visual control elements to see the resulting transformed image.", "For convenience, you can also see the code to call the chosen transformation with selected parameters \u2014 copy-paste it into your Python script and use it. You will also see the original docstring from the source code of this transformation, where you can find explanations and details about this transform.", "Playing with parameters and understanding of how they work on different images is the best way to get the intuition you need for the fast augmentations tunning.", "Yes, you can do it if you run the service locally.", "The source code of this service is available on GitHub (https://github.com/IliaLarchenko/albumentations-demo) you can clone it and do whatever you want.", "While the online version is useful when you want to explore all the transformation available or just quickly check how they work, the local one is more flexible and can be customized for your needs.", "I hope this tool and the article will be useful for you! Don\u2019t hesitate to ask me anything or propose any improvements. Good luck!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science specialist. TOP-25 on Kaggle. linkedin.com/in/larchenko/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa199b4ac8214&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ilialarchenko?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ilialarchenko?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": "Ilia Larchenko"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdbb868d9204e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&user=Ilia+Larchenko&userId=dbb868d9204e&source=post_page-dbb868d9204e----a199b4ac8214---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa199b4ac8214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa199b4ac8214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@binyaminmellish?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Binyamin Mellish"}, {"url": "https://www.pexels.com/photo/home-real-estate-106399/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://github.com/albumentations-team/albumentations", "anchor_text": "Albumentations library"}, {"url": "https://albumentations-demo.herokuapp.com/", "anchor_text": "follow this link right now"}, {"url": "https://github.com/IliaLarchenko/albumentations-demo", "anchor_text": "the source code and run it locally"}, {"url": "https://www.pexels.com/@jose-mueses-540180?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Jose Mueses"}, {"url": "https://www.pexels.com/photo/photo-of-five-cars-parked-1280560/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://www.pexels.com/@svetozar-milashevich-99573?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Svetozar Milashevich"}, {"url": "https://www.pexels.com/photo/adult-golden-retriever-close-up-photography-1490908/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://github.com/albumentations-team/albumentations", "anchor_text": "Albumenatations"}, {"url": "https://github.com/albumentations-team/albumentations/blob/master/notebooks/showcase.ipynb", "anchor_text": "showcase notebook"}, {"url": "https://www.kaggle.com/c/severstal-steel-defect-detection/overview", "anchor_text": "Severstal: Steel Defect Detection"}, {"url": "https://www.kaggle.com/c/severstal-steel-defect-detection/data", "anchor_text": "https://www.kaggle.com/c/severstal-steel-defect-detection/data"}, {"url": "https://www.kaggle.com/c/severstal-steel-defect-detection/discussion/114254", "anchor_text": "Augmentations used by the winner"}, {"url": "https://www.kaggle.com/c/recursion-cellular-image-classification/overview", "anchor_text": "Recursion Cellular Image Classification"}, {"url": "https://www.kaggle.com/c/recursion-cellular-image-classification/overview", "anchor_text": "https://www.kaggle.com/c/recursion-cellular-image-classification/overview"}, {"url": "https://www.kaggle.com/c/recursion-cellular-image-classification/discussion/110543#latest-648051", "anchor_text": "Augmentations used by the winner"}, {"url": "https://www.kaggle.com/c/aptos2019-blindness-detection/overview", "anchor_text": "APTOS 2019 Blindness Detection"}, {"url": "https://www.kaggle.com/ratthachat/aptos-eye-preprocessing-in-diabetic-retinopathy", "anchor_text": "https://www.kaggle.com/ratthachat/aptos-eye-preprocessing-in-diabetic-retinopathy"}, {"url": "https://www.kaggle.com/c/aptos2019-blindness-detection/discussion/108065", "anchor_text": "Augmentations used by the winner"}, {"url": "https://www.kaggle.com/c/siim-acr-pneumothorax-segmentation/overview", "anchor_text": "SIIM-ACR Pneumothorax Segmentation"}, {"url": "https://www.kaggle.com/c/siim-acr-pneumothorax-segmentation/data", "anchor_text": "https://www.kaggle.com/c/siim-acr-pneumothorax-segmentation/data"}, {"url": "https://www.kaggle.com/c/siim-acr-pneumothorax-segmentation/discussion/107824#latest-650999", "anchor_text": "Augmentations used by the winner"}, {"url": "https://www.kaggle.com/c/imaterialist-fashion-2019-FGVC6/overview", "anchor_text": "iMaterialist (Fashion) 2019 at FGVC6"}, {"url": "https://www.kaggle.com/c/imaterialist-fashion-2019-FGVC6/overview", "anchor_text": "https://www.kaggle.com/c/imaterialist-fashion-2019-FGVC6/overview"}, {"url": "https://www.kaggle.com/c/imaterialist-fashion-2019-FGVC6/discussion/95247#latest-626701", "anchor_text": "Augmentations used by the winner"}, {"url": "https://www.kaggle.com/c/freesound-audio-tagging-2019/overview", "anchor_text": "Freesound Audio Tagging 2019"}, {"url": "https://github.com/lRomul/argus-freesound", "anchor_text": "https://github.com/lRomul/argus-freesound"}, {"url": "https://www.kaggle.com/c/freesound-audio-tagging-2019/discussion/95924#553818", "anchor_text": "Augmentations used by the winner:"}, {"url": "https://www.pexels.com/@skitterphoto?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Skitterphoto"}, {"url": "https://www.pexels.com/photo/bird-flying-zoo-beak-9291/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://arxiv.org/abs/1805.09501", "anchor_text": "paper about AutoAugment"}, {"url": "https://albumentations-demo.herokuapp.com/", "anchor_text": "https://albumentations-demo.herokuapp.com/"}, {"url": "https://streamlit.io/", "anchor_text": "Steamlit framework"}, {"url": "https://github.com/IliaLarchenko/albumentations-demo", "anchor_text": "https://github.com/IliaLarchenko/albumentations-demo"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----a199b4ac8214---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/augmentation?source=post_page-----a199b4ac8214---------------augmentation-----------------", "anchor_text": "Augmentation"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a199b4ac8214---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----a199b4ac8214---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/interfaces?source=post_page-----a199b4ac8214---------------interfaces-----------------", "anchor_text": "Interfaces"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa199b4ac8214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&user=Ilia+Larchenko&userId=dbb868d9204e&source=-----a199b4ac8214---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa199b4ac8214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&user=Ilia+Larchenko&userId=dbb868d9204e&source=-----a199b4ac8214---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa199b4ac8214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa199b4ac8214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a199b4ac8214---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a199b4ac8214--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a199b4ac8214--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a199b4ac8214--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a199b4ac8214--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ilialarchenko?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ilialarchenko?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ilia Larchenko"}, {"url": "https://medium.com/@ilialarchenko/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "31 Followers"}, {"url": "http://linkedin.com/in/larchenko/", "anchor_text": "linkedin.com/in/larchenko/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdbb868d9204e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&user=Ilia+Larchenko&userId=dbb868d9204e&source=post_page-dbb868d9204e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fdbb868d9204e%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-image-augmentations-using-a-convenient-tool-a199b4ac8214&user=Ilia+Larchenko&userId=dbb868d9204e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}