{"url": "https://towardsdatascience.com/machine-learning-in-production-633548ad7281", "time": 1683017624.6516109, "path": "towardsdatascience.com/machine-learning-in-production-633548ad7281/", "webpage": {"metadata": {"title": "Machine Learning in Production. Using Google AI-Platform (Part-2) | by asjad anis | Towards Data Science", "h1": "Machine Learning in Production", "description": "In the previous article, we explored serving our tensorflow models using tensorflow-serving and how we can use Google Cloud to deploy our models in production using Docker and Kubernetes. If you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/machine-learning-in-production-3d54860ff1d9", "anchor_text": "previous article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/machine-learning-in-production-3d54860ff1d9", "anchor_text": "part-1", "paragraph_index": 0}, {"url": "https://cloud.google.com/ai-platform", "anchor_text": "AI-Platform", "paragraph_index": 1}, {"url": "https://cloud.google.com/solutions/machine-learning/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning", "anchor_text": "MLOps", "paragraph_index": 1}, {"url": "https://cloud.google.com/sdk/gcloud/reference/ai-platform/models", "anchor_text": "official-docs", "paragraph_index": 19}, {"url": "https://cloud.google.com/ai-platform/prediction/docs/online-predict?hl=en_US#formatting_your_input_for_online_prediction", "anchor_text": "link", "paragraph_index": 21}, {"url": "https://developers.google.com/api-client-library", "anchor_text": "page", "paragraph_index": 22}, {"url": "https://cloud.google.com/ai-platform/training/docs/python-client-library", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://towardsdatascience.com/machine-learning-in-production-95e1999bba84", "anchor_text": "last article", "paragraph_index": 30}, {"url": "https://www.linkedin.com/in/asjad-anis/", "anchor_text": "LinkedIn", "paragraph_index": 31}], "all_paragraphs": ["In the previous article, we explored serving our tensorflow models using tensorflow-serving and how we can use Google Cloud to deploy our models in production using Docker and Kubernetes. If you haven\u2019t explored the part-1 of this series I suggest you do, to get familiar with these terminologies and have a better understanding for following this guide.", "In this article, we will focus on AI-Platform to deploy our model and then consume it in our application. AI Platform is basically a complete set of services that caters the whole ML-Pipeline from ingesting data till deployment. It covers data pre-processing, validating data, building ML-models, and finally deploying them, just to add further it doesn\u2019t stop here, it also offers MLOps for implementing CI/CD for Machine-Learning Systems. Some of the key features of AI-Platform include", "Now that we have a basic understanding of AI-Platform let\u2019s dive into deploying our model on AI-Platform, we will be using the same mnist-digit-classifier that we developed in the previous post. You can of course use your own machine learning models, but for the sake of this article, I will be sticking with mnist-digit-classifier. Before moving on you need to configure a new Google-Cloud account if you haven\u2019t already and export your model.", "Let\u2019s get started, there are a couple of steps in order to deploy our model, each of these can either be performed via the Cloud-Console or the Clouds-SDK.", "First, we need to upload our model to a cloud storage bucket, for this, you can simply head over to your GCP-project and navigate to the storage service. From there you can create a bucket and give it a meaningful name, I have called mine mnist-digit.", "Now that our bucket is created we can simply upload our model to the bucket using the below command.", "Please note that a good convention for organizing your models is to use a sub-folder in your model's directory which highlights the model version that can be seen below.", "If you re-train your model or fine-tune the model architecture and export a different version you can create a separate folder here named 2 which will contain the updated model. The contents of this directory will be the entire saved model-directory as seen below.", "Note: Your bucket must be in the same region as the AI-platform otherwise you will have to explicitly grant access to the AI-Platform.", "Perfect we are done with the first step in getting our model uploaded to a cloud storage bucket, next comes", "Before deploying the model first head over to your GCP project APIs & Services \u2192 Enable APIs & Services \u2192 AI Platform Training & Prediction API and enable this API.", "Next head over to the AI-Platform service from the left side-bar in GCP and navigate to the Models tab.", "Click on New model to create a model resource and give your model a unique name within the project, select a region this will be the region where the jobs will be running, once selected hit Create. I have called mine mnist_digit_recog", "Now if you go to the Models tab you should see your model resource. Next, we will be creating a version resource for our model resource that we just created.", "Now we will be creating a version with the trained model we uploaded to the cloud-storage bucket in the first step. For this click on the model resource we just created and hit create a version.", "Next, select a version for your model and set the python version and framework. I trained my model on python version 3.7.4. To check your python version you can run the below command in terminal", "To check tensorflow version you can run", "Next, configure the path to your cloud storage bucket where you uploaded the model make sure you configure the path to the folder containing the model files which in our case was the directory named \u201c1\u201d.", "Once you have configured it click save, this will take up some time and once it's finished you should see a green checkmark next to your deployed version as shown below", "Now we are all set to make predictions with our deployed instance. Btw if you are a fan of command-line then all these steps can be performed via the google cloud sdk. To explore the command line options please visit the official-docs.", "Now that we have our model deployed let's make some inferences, click on your model version and you will be taken to this page with additional details about the model and traffic.", "Here we can see that our deployed model is expecting an object with an instances key containing the test data. To learn more about getting online predictions do give this link a visit which highlights how you should input your data and get predictions in response.", "We will be using the google api client for python to get inference from our deployed model. If you are working in some other programming-language you can check out this page to see if the language is supported.", "To get predictions we first need access to make calls to the model for which we need a credentials file. To set up the credentials in google cloud console, head over to APIs & Services and go to the credentials tab. From there click create new credentials and select service account. Give your service account a name and assign an appropriate role. I assigned my service account ML Engine Admin and Storage Object Admin. Once done click create.", "Once created, click your service account and scroll down to Add Key click the button and select create a new key and set the format as JSON, and hit create.", "Download the JSON on disk and rename it for your own convenience. I have renamed it as [project-name]_credentials.json.", "Next we will install the python client libraries using the below command", "For more details you can visit the official docs for python client here", "Once installed we can use the below code snippet to request our model.", "Note that I am specifying the api_endpoint with the specific region in which I created my model resource. You can check that out quickly by going to your model resource in AI-Platform.", "And that\u2019s it now you can deploy your machine learning models on AI-Platform whether they were trained using AI-Platform or not, and consume them from any application. In the last article of this series, we will look at how we can use cloud-functions for serving our models.", "If you find this article useful do share it in your circle and leave a clap. For any queries or suggestions, you can leave a comment or you can connect with me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer | ML Enthusiast | Creative Programmer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F633548ad7281&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----633548ad7281--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----633548ad7281--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://asjadanis128.medium.com/?source=post_page-----633548ad7281--------------------------------", "anchor_text": ""}, {"url": "https://asjadanis128.medium.com/?source=post_page-----633548ad7281--------------------------------", "anchor_text": "asjad anis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46e3b4d207b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&user=asjad+anis&userId=46e3b4d207b6&source=post_page-46e3b4d207b6----633548ad7281---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F633548ad7281&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F633548ad7281&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@cookiethepom?utm_source=medium&utm_medium=referral", "anchor_text": "Cookie the Pom"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/machine-learning-in-production-3d54860ff1d9", "anchor_text": "previous article"}, {"url": "https://towardsdatascience.com/machine-learning-in-production-3d54860ff1d9", "anchor_text": "part-1"}, {"url": "https://cloud.google.com/ai-platform", "anchor_text": "AI-Platform"}, {"url": "https://cloud.google.com/solutions/machine-learning/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning", "anchor_text": "MLOps"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://cloud.google.com/sdk/gcloud/reference/ai-platform/models", "anchor_text": "official-docs"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://cloud.google.com/ai-platform/prediction/docs/online-predict?hl=en_US#formatting_your_input_for_online_prediction", "anchor_text": "link"}, {"url": "https://developers.google.com/api-client-library", "anchor_text": "page"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://cloud.google.com/ai-platform/training/docs/python-client-library", "anchor_text": "here"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://towardsdatascience.com/machine-learning-in-production-95e1999bba84", "anchor_text": "last article"}, {"url": "https://www.linkedin.com/in/asjad-anis/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----633548ad7281---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----633548ad7281---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/deployment?source=post_page-----633548ad7281---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----633548ad7281---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----633548ad7281---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F633548ad7281&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&user=asjad+anis&userId=46e3b4d207b6&source=-----633548ad7281---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F633548ad7281&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&user=asjad+anis&userId=46e3b4d207b6&source=-----633548ad7281---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F633548ad7281&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----633548ad7281--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F633548ad7281&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----633548ad7281---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----633548ad7281--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----633548ad7281--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----633548ad7281--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----633548ad7281--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----633548ad7281--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----633548ad7281--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----633548ad7281--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----633548ad7281--------------------------------", "anchor_text": ""}, {"url": "https://asjadanis128.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://asjadanis128.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "asjad anis"}, {"url": "https://asjadanis128.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "73 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46e3b4d207b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&user=asjad+anis&userId=46e3b4d207b6&source=post_page-46e3b4d207b6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faadeff2fb71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-633548ad7281&newsletterV3=46e3b4d207b6&newsletterV3Id=aadeff2fb71&user=asjad+anis&userId=46e3b4d207b6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}