{"url": "https://towardsdatascience.com/music-generation-through-deep-neural-networks-21d7bd81496e", "time": 1683015489.664549, "path": "towardsdatascience.com/music-generation-through-deep-neural-networks-21d7bd81496e/", "webpage": {"metadata": {"title": "Music Generation Through Deep Neural Networks | by Ramya Vidiyala | Towards Data Science", "h1": "Music Generation Through Deep Neural Networks", "description": "Deep Learning has improved many aspects of our lives, in ways both obvious and subtle. Deep learning plays a key role in processes such as movie recommendation systems, spam detection, and computer\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-to-build-a-movie-recommendation-system-67e321339109", "anchor_text": "movie recommendation systems", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/spam-detection-in-emails-de0398ea3b48", "anchor_text": "spam detection", "paragraph_index": 0}, {"url": "https://lionbridge.ai/solutions/virtual-assistants/", "anchor_text": "virtual assistants", "paragraph_index": 0}, {"url": "http://abc.sourceforge.net/NMD/", "anchor_text": "ABC version of the Nottingham Music Database", "paragraph_index": 5}, {"url": "https://lionbridge.ai/articles/difference-between-cnn-and-rnn/", "anchor_text": "Recurrent Neural Networks", "paragraph_index": 9}, {"url": "http://karpathy.github.io/2015/05/21/rnn-effectiveness/", "anchor_text": "helpful resource", "paragraph_index": 14}, {"url": "https://lionbridge.ai/articles/machine-learning-music-generation-through-deep-neural-networks/", "anchor_text": "here", "paragraph_index": 33}, {"url": "http://abc.sourceforge.net/NMD/", "anchor_text": "annotated data here", "paragraph_index": 33}, {"url": "https://github.com/RamyaVidiyala/Generate-Music-Using-Neural-Networks", "anchor_text": "Github", "paragraph_index": 33}, {"url": "https://medium.com/@ramyavidiyala", "anchor_text": "Medium", "paragraph_index": 34}, {"url": "https://twitter.com/ramya_vidiyala", "anchor_text": "ramya_vidiyala", "paragraph_index": 34}, {"url": "https://www.linkedin.com/in/ramya-vidiyala-308ba6139/", "anchor_text": "RamyaVidiyala", "paragraph_index": 34}, {"url": "https://www.linkedin.com/in/ramya-vidiyala/", "anchor_text": "https://www.linkedin.com/in/ramya-vidiyala/", "paragraph_index": 36}], "all_paragraphs": ["Deep Learning has improved many aspects of our lives, in ways both obvious and subtle. Deep learning plays a key role in processes such as movie recommendation systems, spam detection, and computer vision. Though there is ongoing discussion around deep learning as a black box and the difficulty of training, there is huge potential for it in a wide variety of fields including medicine, virtual assistants, and eCommerce.", "One fascinating area in which deep learning can play a role is at the intersection of art and technology. To explore this idea further, in this article we will look at machine learning music generation via deep learning processes, a field many assume is beyond the scope of machines (and another interesting area of fierce debate!).", "We will be working with ABC music notation. ABC notation is a shorthand form of musical notation that uses the letters A through G to represent musical notes, and other elements to place added values. These added values include sharps, flats, the length of a note, the key, and ornamentation.", "This form of notation began as an ASCII character set code to facilitate music sharing online, adding a new and simple language for software developers designed for ease of use. Figure 1 is a snapshot of the ABC notation of music.", "Lines in part 1 of the music notation show a letter followed by a colon. These indicate various aspects of the tune such as the index, when there is more than one tune in a file (X:), the title (T:), the time signature (M:), the default note length (L:), the type of tune (R:) and the key (K:). The lines following the key designation represent the tune itself.", "In this article, we\u2019ll use the open-sourced data available on the ABC version of the Nottingham Music Database. It contains more than 1000 folk tunes, the vast majority of which have been converted to ABC notation.", "The data is currently in a character-based categorical format. In the data processing stage, we need to transform the data into an integer-based numerical format, to prepare it for working with neural networks.", "Here each character is mapped to a unique integer. This can be achieved using a single line of code. The \u2018text\u2019 variable is the input data.", "To train the model, we convert the entirety of text data into a numerical format using the vocab.", "In traditional machine learning models, we cannot store a model\u2019s previous stages. However, we can store previous stages with Recurrent Neural Networks (commonly called RNN).", "An RNN has a repeating module that takes input from the previous stage and gives its output as input to the next stage. However, RNNs can only retain information from the most recent stage, so our network needs more memory to learn long-term dependencies. This is where Long Short Term Memory Networks (LSTMs) come to the rescue.", "LSTMs are a special case of RNNs, with the same chain-like structure as RNNs, but a different repeating module structure.", "In addition to the general RNN, we\u2019ll customize it to our use case by adding a few tweaks. We\u2019ll use a \u2018character RNN\u2019. In character RNNs, the input, output, and transition output are in the form of characters.", "As we need our output generated at each timestamp, we\u2019ll use a many-many RNN. To implement a many-many RNN, we need to set the parameter \u2018return_sequences\u2019 to true so that each character is generated at each timestamp. You can get a better understanding of it by looking at figure 5, below.", "In the figure above, the blue units are the input, the yellow is the hidden units, and the green is the output units. This is a simple overview of a many-many RNN. For a more detailed look at RNN sequences, here\u2019s a helpful resource.", "To process the output at each timestamp, we create a time distributed dense layer. To achieve this we create a time distributed dense layer on top of the outputs generated at each timestamp.", "The output from the batch is passed to the following batch as input by setting the parameter stateful to true. After combining all the features, our model will look like the overview depicted in figure 6, below.", "The code snippet for the model architecture is as follows:", "I highly recommend playing around with the layers to improve the performance.", "Dropout layers are a regularization technique that consists of a fraction of input units to zero at each update during the training to prevent overfitting. The fraction is determined by the parameter used with the layer.", "The generation of music is a multi-class classification problem, where each class is a unique character from the input data. Hence we are using a softmax layer on top of our model and categorical cross-entropy as a loss function.", "This layer gives the probability of each class. From the list of probability, we select the one with the largest probability.", "To optimize our model, we use Adaptive Moment Estimation, also called Adam, as it is a very good choice for RNN.", "Till now we created an RNN model and trained it on our input data. This model learned patterns of input data during the training phase. Let\u2019s call this model the \u2018trained model\u2019.", "The input size used in the trained model is the batch size. And for the generation of music via machine learning, the input size is a single character. So we create a new model which is similar to the trained model, but with the input size of a single character which is (1,1). To this new model, we load the weights from the trained model to replicate the characteristics of the trained model.", "We load the weights of the trained model to the new model. This can be achieved using a single line of code.", "In the process of music generation, the first character is chosen randomly from the unique set of characters, the next character is generated using the previously generated character and so on. With this structure, we generate music.", "Here is the code snippet that helps us achieve this.", "Here are a few generated pieces of music:", "We generated these pleasant samples of music using machine learning neural networks known as LSTMs. For every generation, the patterns will be different but similar to the training data. These melodies can be used for a wide variety of purposes:", "However, this model can still be improved. Our training data consisted of a single instrument, the piano. One way we could enhance our training data is by adding music from multiple instruments. Another would be to increase the genres of music, their rhythms, and their timing signatures.", "At present, our model generates a few false notes and the music is not exceptional. We could reduce these errors and increase the quality of our music by increasing our training dataset as detailed above.", "In this article, we looked at how to process music for use with neural networks, the in-depth workings of deep learning models like RNN & LSTMs, and we also explored how tweaking a model can result in music generation. We can apply these concepts to any other system where we generate other formats of art, including generating landscape paintings or human portraits.", "Thanks for reading! This article was originally posted here. If you would like to experiment with this custom dataset yourself, you can download the annotated data here and see my code at Github.", "I am going to write more beginner-friendly posts in the future too. Follow me up on Medium to be informed about them. I welcome feedback and can be reached out on Twitter ramya_vidiyala and LinkedIn RamyaVidiyala. Happy learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in computers and machine learning. Likes to write about it | https://www.linkedin.com/in/ramya-vidiyala/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F21d7bd81496e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ramyavidiyala.medium.com/?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": "Ramya Vidiyala"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F380da45435d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&user=Ramya+Vidiyala&userId=380da45435d3&source=post_page-380da45435d3----21d7bd81496e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F21d7bd81496e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F21d7bd81496e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@intelligenciya?utm_source=medium&utm_medium=referral", "anchor_text": "Alexey Ruban"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://towardsdatascience.com/how-to-build-a-movie-recommendation-system-67e321339109", "anchor_text": "movie recommendation systems"}, {"url": "https://towardsdatascience.com/spam-detection-in-emails-de0398ea3b48", "anchor_text": "spam detection"}, {"url": "https://lionbridge.ai/solutions/virtual-assistants/", "anchor_text": "virtual assistants"}, {"url": "http://abc.sourceforge.net/NMD/", "anchor_text": "ABC version of the Nottingham Music Database"}, {"url": "https://lionbridge.ai/articles/difference-between-cnn-and-rnn/", "anchor_text": "Recurrent Neural Networks"}, {"url": "http://karpathy.github.io/2015/05/21/rnn-effectiveness/", "anchor_text": "helpful resource"}, {"url": "https://lionbridge.ai/articles/machine-learning-music-generation-through-deep-neural-networks/", "anchor_text": "here"}, {"url": "http://abc.sourceforge.net/NMD/", "anchor_text": "annotated data here"}, {"url": "https://github.com/RamyaVidiyala/Generate-Music-Using-Neural-Networks", "anchor_text": "Github"}, {"url": "https://medium.com/@ramyavidiyala", "anchor_text": "Medium"}, {"url": "https://twitter.com/ramya_vidiyala", "anchor_text": "ramya_vidiyala"}, {"url": "https://www.linkedin.com/in/ramya-vidiyala-308ba6139/", "anchor_text": "RamyaVidiyala"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----21d7bd81496e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----21d7bd81496e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/education?source=post_page-----21d7bd81496e---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/data-science?source=post_page-----21d7bd81496e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----21d7bd81496e---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F21d7bd81496e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&user=Ramya+Vidiyala&userId=380da45435d3&source=-----21d7bd81496e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F21d7bd81496e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&user=Ramya+Vidiyala&userId=380da45435d3&source=-----21d7bd81496e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F21d7bd81496e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F21d7bd81496e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----21d7bd81496e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----21d7bd81496e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----21d7bd81496e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----21d7bd81496e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----21d7bd81496e--------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ramya Vidiyala"}, {"url": "https://ramyavidiyala.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "449 Followers"}, {"url": "https://www.linkedin.com/in/ramya-vidiyala/", "anchor_text": "https://www.linkedin.com/in/ramya-vidiyala/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F380da45435d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&user=Ramya+Vidiyala&userId=380da45435d3&source=post_page-380da45435d3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F51c63443de13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-generation-through-deep-neural-networks-21d7bd81496e&newsletterV3=380da45435d3&newsletterV3Id=51c63443de13&user=Ramya+Vidiyala&userId=380da45435d3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}