{"url": "https://towardsdatascience.com/uci-heart-disease-classification-with-pyspark-eadc8e99663f", "time": 1683009318.3048398, "path": "towardsdatascience.com/uci-heart-disease-classification-with-pyspark-eadc8e99663f/", "webpage": {"metadata": {"title": "Classification with PySpark. How to use PySpark for classification\u2026 | by Sohail Hosseini | Towards Data Science", "h1": "Classification with PySpark", "description": "This is a quick study of how we can use PySpark in classification problems. The objective here is to classify patients based on different features to predict if they have heart disease or not. For\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://github.com/shosseini811/UCI-Heart-disease--PYSPARK/blob/master/UCI%20Heart%20disease%20-Pyspark.ipynb", "anchor_text": "link", "paragraph_index": 15}], "all_paragraphs": ["This is a quick study of how we can use PySpark in classification problems. The objective here is to classify patients based on different features to predict if they have heart disease or not. For this example, LogisticRegression is used, which can be imported as:", "Let\u2019s look at this dataset. It is named UCI heart disease dataset, and you can download it from here.", "The top five rows are shown above. The target feature is used as our output, which is either 1 or 0. We want to calculate it based on the other 13 features available to us, i.e., age, sex, cp, etc.", "To find out the type of each feature, we can use .printSchema() function as:", "Your next step would be to convert these features to vectors; we need to import an appropriate library.", "In PySpark, all columns except the target need to be converted to a vector, which we call it features.", "We can see below that the features column is a vector based on all thirteen columns.", "To train our model, we combine \u201cfeatures\u201d and \u201ctarget\u201d as input/output.", "Then, we can split final_data to train and test as follows:", "LogisticRegression is used as our classification method, and labelCol needs to be referred to as the target feature, and featuresCol is defined features, which already represented as vectors.", "In the next step, we can train our algorithm, which is very similar to scikit, and see what is predicted output for our test case.", "The following figure shows the target and predicted in our first ten rows; one case was not predicted correctly.", "To evaluate our model, with can import BinaryClassificationEvaluator.", "This evaluator uses AUC and compares the predicted column, \u201cprediction,\u201d and \u201ctarget.\u201d The values for train and test are 93% and 87% respectively.", "I have used only default hyperparameters e.g., maxIter, and regParam for this problem, but we can also adjust them to get a better model.", "The complete code can be accessed through this link.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feadc8e99663f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@s.sadathosseini?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@s.sadathosseini?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": "Sohail Hosseini"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1afb760b787e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&user=Sohail+Hosseini&userId=1afb760b787e&source=post_page-1afb760b787e----eadc8e99663f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feadc8e99663f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feadc8e99663f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "here"}, {"url": "https://github.com/shosseini811/UCI-Heart-disease--PYSPARK/blob/master/UCI%20Heart%20disease%20-Pyspark.ipynb", "anchor_text": "link"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----eadc8e99663f---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/classification?source=post_page-----eadc8e99663f---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/logistic-regression?source=post_page-----eadc8e99663f---------------logistic_regression-----------------", "anchor_text": "Logistic Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feadc8e99663f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&user=Sohail+Hosseini&userId=1afb760b787e&source=-----eadc8e99663f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feadc8e99663f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&user=Sohail+Hosseini&userId=1afb760b787e&source=-----eadc8e99663f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feadc8e99663f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feadc8e99663f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eadc8e99663f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eadc8e99663f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eadc8e99663f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eadc8e99663f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eadc8e99663f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@s.sadathosseini?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@s.sadathosseini?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sohail Hosseini"}, {"url": "https://medium.com/@s.sadathosseini/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "264 Followers"}, {"url": "https://www.linkedin.com/in/soheil-hosseini/", "anchor_text": "https://www.linkedin.com/in/soheil-hosseini/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1afb760b787e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&user=Sohail+Hosseini&userId=1afb760b787e&source=post_page-1afb760b787e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa588a007b513&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuci-heart-disease-classification-with-pyspark-eadc8e99663f&newsletterV3=1afb760b787e&newsletterV3Id=a588a007b513&user=Sohail+Hosseini&userId=1afb760b787e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}