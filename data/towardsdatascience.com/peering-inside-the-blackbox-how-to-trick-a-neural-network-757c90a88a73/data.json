{"url": "https://towardsdatascience.com/peering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73", "time": 1683013806.388269, "path": "towardsdatascience.com/peering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73/", "webpage": {"metadata": {"title": "Looking Inside The Blackbox \u2014 How To Trick A Neural Network | by William Falcon | Towards Data Science", "h1": "Looking Inside The Blackbox \u2014 How To Trick A Neural Network", "description": "Neural networks get a bad reputation for being black boxes. And while it certainly takes creativity to understand their decision making, they are really not as opaque as people would have you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://twitter.com/alfcnz", "anchor_text": "Alfredo Canziani", "paragraph_index": 2}, {"url": "https://colab.research.google.com/drive/16HVAJHdCkyj7W43Q3ZChnxZ7DOwx6K5i?usp=sharing", "anchor_text": "follow along using this colab", "paragraph_index": 19}, {"url": "https://github.com/PyTorchLightning/pytorch-lightning", "anchor_text": "PyTorch Lightning", "paragraph_index": 34}, {"url": "https://github.com/PyTorchLightning/pytorch-lightning-bolts", "anchor_text": "PyTorch Lightning Bolts", "paragraph_index": 34}, {"url": "https://twitter.com/alfcnz", "anchor_text": "Alfredo Canzian", "paragraph_index": 35}], "all_paragraphs": ["Neural networks get a bad reputation for being black boxes. And while it certainly takes creativity to understand their decision making, they are really not as opaque as people would have you believe.", "In this tutorial, I\u2019ll show you how to use backpropagation to change the input as to classify it as whatever you would like.", "(This work was co-written with Alfredo Canziani ahead of an upcoming video)", "Let\u2019s consider the case of humans. If I show you the following input:", "there\u2019s a good chance you have no idea whether this is a 5 or a 6. In fact, I believe that I could even make a case for convincing you that this might also be an 8.", "Now, if you asked a human what they would have to do to make something more into a 5 you might visually do something like this:", "And if I wanted you to make this more into an 8, you might do something like this:", "Now, the answer to this question is not easy to explain in a few if statements or by looking at a few coefficients (yes, I\u2019m looking at you regression). Unfortunately, with certain types of inputs (images, sound, video, etc\u2026) explainability certainly becomes much harder but not impossible.", "How would a neural network answer the same questions I posed above? Well, to answer that, we can use gradient ascent to do exactly that.", "Here\u2019s how the neural network thinks we would need to modify the input to make it more into a 5.", "There are two interesting results from this. First, the black areas are where the network things we need to remove pixel density from. Second, the yellow areas are where it thinks we need to add more pixel density.", "We can take a step in that gradient direction by adding the gradients to the original image. We could of course repeat this procedure over and over again to eventually morph the input into the prediction we are hoping for.", "You can see that the black patch at the bottom left of the image is very similar to what a human might think to do as well.", "What about making the input look more like an 8? Here\u2019s how the network thinks you would have to change the input.", "The notable things, here again, are that there is a black mass at the bottom left and a bright mass around the middle. If we add this with the input we get the following result:", "In this case, I\u2019m not particularly convinced that we\u2019ve turned this 5 into an 8. However, we\u2019ve made less of a 5, and the argument to convince you this is an 8 would certainly be easier to win using the image on the right instead of the image on the left.", "In regression analysis, we look at coefficients to tell us about what we\u2019ve learned. In a random forest, we can look at decision nodes.", "In neural networks, it comes down to how creative we are at using gradients. To classify this digit, we generated a distribution over possible predictions.", "This is what we call the forward pass.", "In code it looks like this (follow along using this colab):", "Now imagine that we wanted to trick the network into predicting \u201c5\u201d for the input x. Then the way to do this is to give it an image (x), calculate the predictions for the image and then maximize the probablitity of predicting the label \u201c5\u201d.", "To do this we can use gradient ascent to calculate the gradients of a prediction at the 6th index (ie: label = 5) (p) with respect to the input x.", "To do this in code we feed the input x as a parameter to the neural network, pick the 6th prediction (because we have labels: 0, 1, 2, 3, 4 , 5, \u2026) and the 6th index means label \u201c5\u201d.", "Now that we calculated the gradients, we can visualize and plot them:", "The above gradient looks like random noise because the network has not yet been trained\u2026 However, once we do train the network, the gradients will be more informative:", "This is a hugely helpful tool in helping illuminate what happens inside your network as it trains. In this case, we would want to automate this process so that it happens automatically in training.", "For this, we\u2019ll use PyTorch Lightning to implement our neural network:", "The complicated code to automatically plot what we described here, can be abstracted out into a Callback in Lightning. A callback is a small program that is called at the parts of training you might care about.", "In this case, when a training batch is processed, we want to generate these images in case some of the inputs are confused.", "But\u2026 we\u2019ve made it even easier with pytorch-lightning-bolts which you can simply install", "and import the callback into your training code", "Finally we can train our model and automatically generate images when logits are \u201cconfused\u201d", "and tensorboard will automatically generate images that look like this:", "In summary: You learned how to look inside the blackbox using PyTorch, learned the intuition, wrote a callback in PyTorch Lightning and automatically got your Tensorboard instance to plot questionable predictions", "Try it yourself with PyTorch Lightning and PyTorch Lightning Bolts.", "(This article was written ahead of an upcoming video where me (William) and Alfredo Canziani show you how to code this from scratch).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "\u26a1\ufe0fPyTorch Lightning Creator \u2022 PhD Student, AI (NYU, Facebook AI research)."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F757c90a88a73&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----757c90a88a73--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----757c90a88a73--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://william-falcon.medium.com/?source=post_page-----757c90a88a73--------------------------------", "anchor_text": ""}, {"url": "https://william-falcon.medium.com/?source=post_page-----757c90a88a73--------------------------------", "anchor_text": "William Falcon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8536ebfbc90b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&user=William+Falcon&userId=8536ebfbc90b&source=post_page-8536ebfbc90b----757c90a88a73---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F757c90a88a73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F757c90a88a73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colab.research.google.com/drive/16HVAJHdCkyj7W43Q3ZChnxZ7DOwx6K5i?usp=sharing", "anchor_text": "colab"}, {"url": "https://twitter.com/alfcnz", "anchor_text": "Alfredo Canziani"}, {"url": "https://colab.research.google.com/drive/16HVAJHdCkyj7W43Q3ZChnxZ7DOwx6K5i?usp=sharing", "anchor_text": "follow along using this colab"}, {"url": "https://github.com/PyTorchLightning/pytorch-lightning", "anchor_text": "PyTorch Lightning"}, {"url": "https://github.com/PyTorchLightning/pytorch-lightning-bolts", "anchor_text": "PyTorch Lightning Bolts"}, {"url": "https://twitter.com/alfcnz", "anchor_text": "Alfredo Canzian"}, {"url": "https://medium.com/tag/data-science?source=post_page-----757c90a88a73---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----757c90a88a73---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----757c90a88a73---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F757c90a88a73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&user=William+Falcon&userId=8536ebfbc90b&source=-----757c90a88a73---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F757c90a88a73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&user=William+Falcon&userId=8536ebfbc90b&source=-----757c90a88a73---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F757c90a88a73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----757c90a88a73--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F757c90a88a73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----757c90a88a73---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----757c90a88a73--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----757c90a88a73--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----757c90a88a73--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----757c90a88a73--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----757c90a88a73--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----757c90a88a73--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----757c90a88a73--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----757c90a88a73--------------------------------", "anchor_text": ""}, {"url": "https://william-falcon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://william-falcon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "William Falcon"}, {"url": "https://william-falcon.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8536ebfbc90b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&user=William+Falcon&userId=8536ebfbc90b&source=post_page-8536ebfbc90b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9ea6a21cf951&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeering-inside-the-blackbox-how-to-trick-a-neural-network-757c90a88a73&newsletterV3=8536ebfbc90b&newsletterV3Id=9ea6a21cf951&user=William+Falcon&userId=8536ebfbc90b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}