{"url": "https://towardsdatascience.com/building-a-recommender-system-for-tagging-music-cd8457d255cc", "time": 1683004748.999844, "path": "towardsdatascience.com/building-a-recommender-system-for-tagging-music-cd8457d255cc/", "webpage": {"metadata": {"title": "Building a Recommender System for Tagging Music | by Max Hilsdorf | Towards Data Science", "h1": "Building a Recommender System for Tagging Music", "description": "I was listening to a podcast about AI in the music industry, recently. When we think of AI and music, it\u2019s typically music classification and generation that come to mind first. In this podcast\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.withloveanddata.com/de-de/", "anchor_text": "Alex Jacobi from \u201cWith Love and Data\u201d", "paragraph_index": 0}, {"url": "http://www.bensound.com,", "anchor_text": "www.bensound.com,", "paragraph_index": 4}], "all_paragraphs": ["I was listening to a podcast about AI in the music industry, recently. When we think of AI and music, it\u2019s typically music classification and generation that come to mind first. In this podcast, however, Alex Jacobi from \u201cWith Love and Data\u201d blew my mind with a completely different approach. With his team, he developed a ML model that let\u2019s media producers find the right music for their ads, movies, etc. much more efficiently. When they search for a few keywords, the model will also recommend them music that is not tagged with any of the keywords, but with keywords somehow related to those they searched for. This is genius!", "Imagine how many opportunities you have missed, looking up the \u2018wrong\u2019 keywords searching for books, academic literature, programming tutorials, or cat videos. I find it stunning. If we look at it this way, tags are a means of communication between vendors and demanders in a platform setting. If we want to buy new socks on amazon, the searching process is rather straighfoward, because we can verbally describe our object of interest. In the case of music, however, we need to rely on title and tags to describe the product we look for or offer in a somewhat decent way. Therefore, the improtance of good tagging, and that is effective tagging that brings vendors and demanders together, cannot be stressed enough! There\u2019s only two ways to improve searching for content with tags.", "Alex Jacobi\u2019s work is a massive step towards the first. I wanted to take a small step towards the latter and help creators and media producers find together through better tags. I want to build a recommender system that calculates similarities between tags and uses these to make recommendations. There are a lot of models that are trained on the relationship between words. These models would be able to recommend tags that go along well with the previous one. But music is a very special thing, and it\u2019s questionable whether you can draw conclusions for good music tagging from datasets trained on blogposts or chats. It would be much more helpful for creators to be recommended tags that media managers are going to search for and for media managers to be recommended tags that musicians actually use. That was (and still is) the aim of this project!", "I am going to follow a content based filtering strategy, calculating similarities between tags. Figure 1 shows the basic steps of this project. Everything will be done in Python.", "First, I needed a dataset. All the information I really needed was arrays of tags for many pieces of music. Maybe one track is tagged with t1 = [\u201cfunky\u201d, \u201cgroove\u201d, \u201cguitar\u201d, \u201cuplifting\u201d] and another track is tagged with t2 = [\u201ckids\u201d, \u201chappy\u201d, \u201cuplifting\u201d, guitar\u201d]. My recommender system should find that \u201cuplifting\u201d and \u201cguitar\u201d are similar in the sense that they are often used together to describe a piece of music. Therefore, I want to scrape lists of tags for a lot of tracks from the web. I found the website www.bensound.com, which offers free to use music for film, commercial, or vlogs. Figure 2 shows what the main page on bensound looks like. There are over 20 pages with 12 tracks each. If I can loop through all pages, open up each track on that page and extract its tags, I\u2019d have a decent dataset to get started with.", "You can find commented jupyter notebooks for the entire project as well as all data files in this github repository. I will only use code snippets in this article.", "I used \u201crequest\u201d and bs4\u2019s \u201cBeautiful Soup\u201d to scrape the data. The code you\u2019ll find in this chapter took a lot of experimenting within the parsed webpage content. There might be some numbers or commands that don\u2019t make sense to you, but I hope the general structure of my functions is clear.", "First, I wrote a function to get all track urls on any page.", "Now that I had some track urls, I needed a function to extract the tags from them.", "Lastly, I combined the two functions above, looping through all pages and extracting all tags from all tracks. Luckily, the url of the different pages differed only in its ending:", "This made looping through all pages much easier, as it can be handled with these 4 lines of code:", "This is the final function for scraping the tags:", "When I converted the tag_dict into a pandas DataFrame, it looked like this:", "The data is all there, with over 250 rows of taglists. Of course, it is still very messy and needs some cleaning.", "There are a few problems with the data in Table 1. I tried a lot of cleaning techniques, before I realized I had to transform the dataframes fundamental structure. The \u201cTags\u201d column consists of lists, which pandas is just not made for. It is possible to loop through every item in every list for every computation I want to make, but that is absolutely not time efficient. I wanted to transform the dataframe in a way so that I could make use of pandas vector based computations, which would save me a lot of time!", "Before the transformation, I still had to do some cleaning, which I will sum up here without showing the actual code. It is all in the github rep if you are interested in it.", "My plan was to create a boolean based dataframe with all tags as columns and all tracks as rows. In any column, a track will either have a False or a True value, depending on whether the tag (column) is in the tracks taglist. This would make the dataframe much larger (from 500 to 200,000 datapoints), but would later allow efficient vectorized operations. After the transformation, the dataframe should look like this:", "To make that happen, I needed to get a list of all unique tags, which would be the columns in the new dataframe.", "With this function, I created the actual dataframe:", "So I had my data ready. Now I needed the underlying algorithm of my recommender system. One approach would be to use conditional probability. If I had already tagged t1 = \u201cuplifting\u201d, the algorithm would calculate P(ti / t1) for all tags ti in the dataset. That is the probability that you would find tag ti in a tracks taglist given that t1 has already been tagged. This would also mean that P(ti/t1) != P(t1/ti). While this approach would be most accurate for tag recommendations, it is quite complicated.", "I looked for a solution that would give me comparable results with less effort. What about correlation? Technically, you can\u2019t correlate categorical variables like our tags, but you can calculate association, which is a somewhat similar measure. Association will return values between 0 and 1, representing the probability that you are going to find tag1 and tag2 in the same taglist, given that at least one of them is present. This would be a much easier and quicker computation, but it would mean that there would be no conditional probability included. The probability of any tags t1 and t2 being tagged together would then be assumed to be the same, no matter if t1 or t2 is tagged first. In general, we don\u2019t think of tagging as a serial process, but more as an execution of a predetermined list of fitting tags. We would think that the best tags for a piece of music would be determined before we enter the first tag. For that reason, I stuck to the correlational approach and made everyones lives easier.", "In the code below, you\u2019ll find a prototype for my correlation measurement:", "The final function looks like this:", "From here, I created a dictionary with all tags as keys and a list of all their correlations with other tags as values.", "This computation nearly broke my computer, but returned this dataframe after it was done torturing me:", "Now, of course you want to see the results! How good are the tag recommendations you\u2019ll get from such a small sample?", "I wrote a few functions to select the most fitting (highest correlation) tags to an input tag. See the github rep for all the functions.", "At this point, you can enter a tag and receive the three best recommendations.", "These are the recommendations you\u2019ll receive for a number of common starting tags:", "Let\u2019s try out a few less common tags:", "Some of these recommendations are really good! If I was tagging my music right now, I would find these really helpful. We do see some problems too, however. Apparently, the word \u201caggressive\u201d was usually spelled \u201cagressive\u201d on bensound, which is why \u201cagressive\u201d gets better recommendations than the correctly spelled version. That is a problem. The recommendations for \u201csmooth\u201d don\u2019t look too good, either. This is probably due to the small sample size, as \u201csmooth\u201d wasn\u2019t tagged enough to calculate reliable correlations with it. Overall, all signs point at more data! Before I start tranforming this recommender system into an actual usable product, I need to scrape more data and hope to get better recommendations for the more uncommon tags.", "To end this article, I am going to use my recommender system to pick as many fitting tags as possible for a track. Let\u2019s use the internets favorite \u201cAllstar\u201d by Smash Mouth. I\u2019ll start with one tag and pick the most fitting tag from the three that are recommended to me. Then I\u2019ll use this tag as the new input.", "Tag Nr.: input tag \u2192 output1, output2, output3 \u2192 output choice", "Ok, we have \u201cpositive\u201d, \u201cuplifting\u201d, \u201cmotivation\u201d, \u201csuccess\u201d, and \u201cmotivational\u201d. Now, we\u2019ve hit a wall. However, this a decent taglist for the song. After all, the recommender system isn\u2019t built (yet) to do tagging on its own, but to support humans to make creative tagging decisions.", "I am going to boost my sample up to about 500 tracks, next, and see what happens. When that is done, I\u2019ll write another blog post on it for sure!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Exploring the intersection of data science and music."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcd8457d255cc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maxhilsdorf?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxhilsdorf?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": "Max Hilsdorf"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd0c085a74ae8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&user=Max+Hilsdorf&userId=d0c085a74ae8&source=post_page-d0c085a74ae8----cd8457d255cc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcd8457d255cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcd8457d255cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/de-de/foto/aluminium-audio-ausrustung-design-373632/", "anchor_text": "Pixabay"}, {"url": "https://www.pexels.com/de-de/foto/arbeiten-muster-internet-abstrakt-1089438/", "anchor_text": "Marcus Spiske"}, {"url": "https://www.withloveanddata.com/de-de/", "anchor_text": "Alex Jacobi from \u201cWith Love and Data\u201d"}, {"url": "http://www.bensound.com,", "anchor_text": "www.bensound.com,"}, {"url": "https://github.com/MaxHilsdorf/music_tag_recommender/blob/master/webscraping.ipynb", "anchor_text": "MaxHilsdorf/music_tag_recommenderPermalink Dismiss GitHub is home to over 40 million developers working together to host and review code, manage\u2026github.com"}, {"url": "https://www.bensound.com/royalty-free-music/2", "anchor_text": "https://www.bensound.com/royalty-free-music"}, {"url": "https://www.bensound.com/royalty-free-music/2", "anchor_text": "https://www.bensound.com/royalty-free-music/2"}, {"url": "https://www.bensound.com/royalty-free-music/2", "anchor_text": "https://www.bensound.com/royalty-free-music/"}, {"url": "https://www.bensound.com/royalty-free-music/{page", "anchor_text": "https://www.bensound.com/royalty-free-music/{page"}, {"url": "https://www.bensound.com/royalty-free-music/", "anchor_text": "https://www.bensound.com/royalty-free-music/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cd8457d255cc---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/recommendations?source=post_page-----cd8457d255cc---------------recommendations-----------------", "anchor_text": "Recommendations"}, {"url": "https://medium.com/tag/music?source=post_page-----cd8457d255cc---------------music-----------------", "anchor_text": "Music"}, {"url": "https://medium.com/tag/python?source=post_page-----cd8457d255cc---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----cd8457d255cc---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcd8457d255cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&user=Max+Hilsdorf&userId=d0c085a74ae8&source=-----cd8457d255cc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcd8457d255cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&user=Max+Hilsdorf&userId=d0c085a74ae8&source=-----cd8457d255cc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcd8457d255cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcd8457d255cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cd8457d255cc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cd8457d255cc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cd8457d255cc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cd8457d255cc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cd8457d255cc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxhilsdorf?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxhilsdorf?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Max Hilsdorf"}, {"url": "https://medium.com/@maxhilsdorf/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "602 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd0c085a74ae8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&user=Max+Hilsdorf&userId=d0c085a74ae8&source=post_page-d0c085a74ae8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F634ae3591d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommender-system-for-tagging-music-cd8457d255cc&newsletterV3=d0c085a74ae8&newsletterV3Id=634ae3591d04&user=Max+Hilsdorf&userId=d0c085a74ae8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}