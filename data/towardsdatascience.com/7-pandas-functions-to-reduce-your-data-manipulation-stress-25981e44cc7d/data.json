{"url": "https://towardsdatascience.com/7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d", "time": 1683005667.368484, "path": "towardsdatascience.com/7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d/", "webpage": {"metadata": {"title": "7 Pandas Functions That Will Reduce Your Data Manipulation Stress | by Andre Ye | Towards Data Science", "h1": "7 Pandas Functions That Will Reduce Your Data Manipulation Stress", "description": "Why don\u2019t Pandas have gray hairs? Obviously, because they have so many clever functions to manipulate data they don\u2019t stress as much over it as their human counterparts. Data seems like it never\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data", "anchor_text": "New York City Airbnb Open Data", "paragraph_index": 3}, {"url": "https://andre-ye.medium.com/membership", "anchor_text": "https://andre-ye.medium.com/membership", "paragraph_index": 40}], "all_paragraphs": ["Why don\u2019t Pandas have gray hairs? Obviously, because they have so many clever functions to manipulate data they don\u2019t stress as much over it as their human counterparts.", "Data seems like it never comes in a form we want it to come in. In my personal experience, the vast majority of time spent on a data science project is simply spent on manipulating data. When there\u2019s something we want to do to the data but we simply don\u2019t know a handy pandas function to do it, it\u2019s time to knuckle down with the old for loop and .loc to manually change cells, guided by an if statement.", "In this article, I\u2019ll show and explain 7 pandas functions that, when used alone or together, hopefully can save you a lot of data manipulation stress.", "For demonstration, we\u2019ll mostly be operating on the New York City Airbnb Open Data, which has a mix of data types including numbers, text, and dates.", "When we need to label encode something, usually you would use sci-kit learn\u2019s LabelEncoder, but pandas can do that without any imports. On top of that, accessing what labels correspond to what requires calling functions from a LabelEncoder object in sklearn, but is included by default in pandas.", "Say we want to label encode the neighbourhood column in the data.", "The first element of the tuple is an array that contains label-encoded values of the Series. The second element of the tuple is an index/list where each element\u2019s index corresponds to a label in the first element. For example, this first label-encoded value is 0. This means that its reverse-encoded value is the 0th index of the second tuple element, which is Kensington (you can scroll up to confirm this).", "Sometimes, Label Encoding doesn\u2019t work, for the reason that it assigns numerical properties to objects that aren\u2019t inherently numerical, such as \u2018Harlem is two times Kensington\u2019 or \u2018Kensington plus three is Brooklyn\u2019. In this case, one-hot encoding is preferred, which has no numerical bias and represents the same data (albeit in a very sparse way).", "The traditional way to do this is with sklearn\u2019s OneHotEncoder, which requires importing sklearn, and training a OneHotEncoder object.", "Say we wanted to One-Hot Encode the same neighborhood column from the dataset.", "It even alphabetically arranges the columns for us!", "Often, with regression tasks (such as predicting the price of an Airbnb listing, in this example), it may be helpful to discretize the price range into several quantiles (buckets of equal size). This can increase accuracy and reduce model uncertainty in the case that quantiles are acceptable.", "pandas can automatically discretize variables for you with .qcut.", "Say we\u2019d like to discretize the price variable into four quantiles. pandas will automatically split the price range into any number of quantiles you specify. Note that pandas splits the price range into buckets such that there is an equal number of items in each bucket.", "This is a series of interval objects. There is an even amount of objects in each interval. Looking at the first object in the series,", "\u2026it\u2019s an Interval object. You can convert it into a more readable form by applying str().", "You can use .apply() to apply the function to the entire Series. Then, if you like, you can use .factorize to label encode the discretized samples. A great thing about using this and the previous .factorize function is that, unlike in some cases, Label Encoding (instead of One-Hot Encoding with .get_dummies afterwards) is OK on its own.", "The reasoning behind one-hot encoding is that label encoding assigns numerical relationships between labels, for example saying that Kensington is smaller than Harlem with objects that cannot be numerically compared. However, discretized samples can be, because they were taken from a numerical, continuous line.", "Note that if you\u2019d like the quantiles to be split not such that there is an equal number of data points in each bin, but such that the range is quantitatively divided into equal sections, use pandas.cut. It takes in the same parameters and acts the same as pandas.qcut.", "Converting data objects is one of the most frustrating aspects of data cleaning and data manipulation \u2014 of which perhaps the most so are dates. They come in so many forms and are written in so many ways that converting them all into a clean datetime object is a hassle.", "Enter pandas\u2019 to_datetime. This function can reasonably infer any date and converts it into a datetime object \u2014 without needing to import datetime or any other module!", "Let\u2019s create four columns with different naming protocols:", "\u2026and apply to_datetime to see how pandas converts it.", "Pandas automatically converts everything for you! If the dates are in a bit of a different arrangement, pandas can also take in a string describing the arrangement of the months, days, and years.", "The transpose function of a matrix is when the x and y axes are swapped with each other, and hence the matrix is reflected over a diagonal line.", "This is helpful with DataFrames as well. For example, look at this time series data of each country\u2019s deaths by coronavirus by date.", "Selecting only the United States to plot data and removing columns like the country, province, latitude, and longitude, we have an odd data shape.", "The naive way of approaching this would be to copy every column value into a numpy array to visualize. However, with the transpose function, it\u2019s simple.", "That saved us a lot of work!", "A huge issue in data is duplicate data. Duplicate data often rears its ugly head in data that is collected from multiple sources, leading to duplicate rows. Too many duplicate rows will bias the analysis or the machine learning model, and it\u2019s important to remove them.", "Pandas has a default function to remove duplicates, drop_duplicates().", "Let\u2019s set the first row equal to the second row and then remove any duplicates.", "The first row is gone. For the purposes of the demonstration, we kept the index to demonstrate a break in the first row (first index, second \u2018row\u2019, if you want to reference it that way). However, .drop_duplicates() takes in an additional optional parameterignore_index that, if set to True, will create a continuous index unbroken by removals.", "Outliers. They screw up the analysis and throw off the data. To address outliers, pandas has a handy function, .clip(), to remove not only outliers but potential errors in the data (such as I saw recently in a dataset, a negative amount of coronavirus cases).", ".clip() takes in two parameters \u2014 an upper and a lower \u2014 and assigns any values above the upper bound to the upper bound and any values below the lower bound to the lower bound.", "For example, say that Airbnb has a rule where the maximum price one can list their property is $125 and the lowest is $100, and anything listed outside of those bounds is an error (exaggerated hypothetical).", "Let\u2019s set the price column to a clipped version of itself with the lower and upper bounds we understand from real world context.", "All the prices above $125 were set to $125, and any prices below $100 set to that value. .clip() should always be applied with contextual knowledge just to ensure there are no errors, or/and used with statistical outlier bounds.", "I hope these seven functions will be able to make your data manipulation, cleaning, and analysis a bit smoother.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML enthusiast. Join Medium through my referral link: https://andre-ye.medium.com/membership."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F25981e44cc7d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andre-ye.medium.com/?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": "Andre Ye"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe743a65b006&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&user=Andre+Ye&userId=be743a65b006&source=post_page-be743a65b006----25981e44cc7d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25981e44cc7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25981e44cc7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data", "anchor_text": "New York City Airbnb Open Data"}, {"url": "https://upload.wikimedia.org/wikipedia/commons/e/e4/Matrix_transpose.gif", "anchor_text": "Source"}, {"url": "https://medium.com/tag/python?source=post_page-----25981e44cc7d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----25981e44cc7d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----25981e44cc7d---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----25981e44cc7d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/analytics?source=post_page-----25981e44cc7d---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25981e44cc7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&user=Andre+Ye&userId=be743a65b006&source=-----25981e44cc7d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25981e44cc7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&user=Andre+Ye&userId=be743a65b006&source=-----25981e44cc7d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25981e44cc7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F25981e44cc7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----25981e44cc7d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----25981e44cc7d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----25981e44cc7d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----25981e44cc7d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----25981e44cc7d--------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andre Ye"}, {"url": "https://andre-ye.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.8K Followers"}, {"url": "https://andre-ye.medium.com/membership", "anchor_text": "https://andre-ye.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe743a65b006&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&user=Andre+Ye&userId=be743a65b006&source=post_page-be743a65b006--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff44a966e4ff1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-pandas-functions-to-reduce-your-data-manipulation-stress-25981e44cc7d&newsletterV3=be743a65b006&newsletterV3Id=f44a966e4ff1&user=Andre+Ye&userId=be743a65b006&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}