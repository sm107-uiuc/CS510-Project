{"url": "https://towardsdatascience.com/5-strategies-for-handling-unbalanced-classes-514e4dcae64d", "time": 1683017448.460577, "path": "towardsdatascience.com/5-strategies-for-handling-unbalanced-classes-514e4dcae64d/", "webpage": {"metadata": {"title": "5 Strategies for Handling Unbalanced Classes | by Matt Brems | Towards Data Science", "h1": "5 Strategies for Handling Unbalanced Classes", "description": "Suppose you\u2019re trying to teach an alien \u2014 like one of the crewmates from the wildly popular game Among Us \u2014 to tell the difference between a human and a dog. What you might do is show the alien 100\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.innersloth.com/gameAmongUs.php", "anchor_text": "Among Us", "paragraph_index": 0}, {"url": "https://public.roboflow.com/object-detection/oxford-pets", "anchor_text": "animal image dataset", "paragraph_index": 6}, {"url": "https://roboflow.com/", "anchor_text": "Roboflow", "paragraph_index": 7}, {"url": "https://app.roboflow.com/", "anchor_text": "a dataset health check", "paragraph_index": 7}, {"url": "https://public.roboflow.com/object-detection/bccd/health", "anchor_text": "public breast cancer dataset", "paragraph_index": 7}, {"url": "https://models.roboflow.com/object-detection", "anchor_text": "object detection", "paragraph_index": 7}, {"url": "https://blog.roboflow.com/intro-to-computer-vision/", "anchor_text": "introduction to computer vision", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Bootstrapping_(statistics)#:~:text=Bootstrapping%20is%20any%20test%20or,etc.)%20to%20sample%20estimates.", "anchor_text": "bootstrapping, or resampling with replacement", "paragraph_index": 11}, {"url": "https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/utils/class_weight.py", "anchor_text": "Python\u2019s scikit-learn package", "paragraph_index": 12}, {"url": "https://cran.r-project.org/web/packages/weights/weights.pdf", "anchor_text": "R's weights package", "paragraph_index": 12}, {"url": "https://projects.economist.com/us-2020-forecast/president/how-this-works#:~:text=typically%20by%20weighting", "anchor_text": "you may want to reweigh the results of your poll based on age and/or education", "paragraph_index": 12}, {"url": "http://scott.fortmann-roe.com/docs/BiasVariance.html", "anchor_text": "bias-variance tradeoff", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Silver_bullet", "anchor_text": "silver bullet", "paragraph_index": 12}, {"url": "https://blog.roboflow.com/google-paper-underspecification-machine-learning/", "anchor_text": "We\u2019ve written about a closely related issue, underspecification, here", "paragraph_index": 13}, {"url": "https://public.roboflow.com/", "anchor_text": "lots of examples of naturally occurring unbalanced classes", "paragraph_index": 14}], "all_paragraphs": ["Suppose you\u2019re trying to teach an alien \u2014 like one of the crewmates from the wildly popular game Among Us \u2014 to tell the difference between a human and a dog.", "What you might do is show the alien 100 pictures of a human and 100 pictures of a dog. Hopefully, the alien picks up on patterns of humans (taller, stands on two legs, opposable thumbs) and of what makes a dog (shorter, stands on four legs, paws with no opposable thumbs, tail, usually much cuter).", "If you\u2019ve done your job, the alien should be able to look at a picture it\u2019s never seen before and recognize the image contains either a human or a dog.", "Suppose you\u2019re trying this again with a new alien, but with you show 100 pictures of dogs and only 3 pictures of humans. Afterward, if this alien is presented with an image of a human, it may not know enough about what humans look like to accurately guess \u201chuman.\u201d", "Which alien will have the harder time \u2014 the first, or the second?", "This is a great analogy for how a classification model performs. Generally speaking, classification models tend to perform better when classes are balanced \u2014 that is, there\u2019s roughly the same number of samples in each class.", "Practically speaking, there are a lot of scenarios in which classes are likely to be unbalanced (also called imbalanced). It\u2019s probably easier to get pictures of dogs than it is pictures of bald eagles, so an animal image dataset is likely to naturally have more dogs than bald eagles. This isn\u2019t limited to images!", "Roboflow has developed a dataset health check that makes this easier. In the below image, the class balance for this public breast cancer dataset shows that red blood cells (RBC) are significantly overrepresented, whereas white blood cells (WBC) and platelets are significantly underrepresented. (Important side note: this dataset is actually intended to be used for object detection. Object detection problems are different from, but related to, image classification problems. If you want to learn more about their difference, check out our introduction to computer vision.)", "There are many real-world examples involving unbalanced classes. If you\u2019re looking to fit a machine learning model to that data, you may find that your model doesn\u2019t perform well. We need strategies to address this!", "In this post, we\u2019ll describe why unbalanced classes are an issue and we\u2019ll cover 5 strategies for handling unbalanced classes in your data. In most cases, the goal is to turn our unbalanced classes into balanced ones \u2014 only in our training data.", "3. Undersampling via Random Selection: In the dog/human example with 100 dog images and 3 human images, we can balance our data by undersampling the majority class. This means we take a random sample of our 100 dog images and use those in our data. If our goal is to perfectly balance the classes we take a random sample of 3 dog images so that we have 3 dogs and 3 humans. Surely, you can see how this tactic may not work well \u2014 our sample size has gone from 103 down to 6! This is a recommended technique if you have lots of data, but not when you\u2019re working with low sample sizes.", "4. Oversampling via Bootstrapping: In the dog/human example with 100 dog images and 3 human images, we can also balance our data by oversampling the minority class. This involves bootstrapping, or resampling with replacement. (This means when you take a sample of size N, you pull one observation, record it, replace it in the full sample, then pull another observation, record it, and so on until you have your sample of size N.) If we wanted to balance our data by oversampling, we need to generate 97 additional human images. So we would pull one of our existing human images, make a copy, then put that existing human image back, and repeat 96 more times. If our goal is to perfectly balance the classes, we now have 100 dogs and 100 humans. Each of the 100 humans is a copy of the 3 original human images we had at the beginning. There\u2019s a limit to what you can do \u2014 here we see that we\u2019re making a lot of copies of the same handful of images \u2014 but hopefully you have more than a sample size of 3 in your classes. In most cases, your underrepresented classes won\u2019t be quite so sparse. You can also try using oversampling and undersampling simultaneously if using one approach isn\u2019t sufficient.", "5. Reweighing: Reweighing is closely related to oversampling and undersampling \u2014 and is a specific case of applying both techniques. Balancing your classes can be thought of giving each class an \u201cequal vote.\u201d Thinking back to the dog/human example with 100 dog images and 3 human images, if the goal is to give dogs and humans an \u201cequal vote\u201d or \u201cequal say\u201d in your model, then we could give each dog 1 vote and give each human 33.3 votes. This means that each class has 100 votes. Lots of software packages allow for weighing \u2014 Python\u2019s scikit-learn package has a class_weight parameter that allows you to fit machine learning models that weigh each observation to a value of your specification and R's weights package allows you to conduct hypothesis tests and calculate statistical summaries with weighted observations. This is very common in surveys and polling - if you conduct a political poll and get a sample that is significantly younger or significantly more educated than the voting population, you may want to reweigh the results of your poll based on age and/or education to better match the electorate. Reweighing tends to decrease your model's bias at the risk of increasing your model's variance. Be wary of the bias-variance tradeoff; reweighing is not a silver bullet!", "When you apply any of these 5 strategies to address your unbalanced classes, be sure to only apply these to your training data! When you evaluate your model on validation and testing data, your goal is to get an unbiased estimate of how your model will perform in the \u201creal world.\u201d If you apply these strategies to your validation or testing data, those data no longer reflect the actual real world! (We\u2019ve written about a closely related issue, underspecification, here.)", "These are 5 strategies for handling unbalanced classes. None of them are perfect \u2014 and it\u2019s important to know the limitations before applying any of these methods. Of course, we can\u2019t generate something from nothing, and there are lots of examples of naturally occurring unbalanced classes! Hopefully, you\u2019re now aware of why unbalanced classes are an issue and 5 strategies for tackling unbalanced classes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Operator | Educator | Consultant"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F514e4dcae64d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://matthew-brems.medium.com/?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": ""}, {"url": "https://matthew-brems.medium.com/?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": "Matt Brems"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F55680478461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&user=Matt+Brems&userId=55680478461&source=post_page-55680478461----514e4dcae64d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F514e4dcae64d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F514e4dcae64d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://roboflow.com/", "anchor_text": "Roboflow"}, {"url": "http://www.innersloth.com/gameAmongUs.php", "anchor_text": "Among Us"}, {"url": "https://public.roboflow.com/object-detection/oxford-pets", "anchor_text": "animal image dataset"}, {"url": "https://roboflow.com/", "anchor_text": "Roboflow"}, {"url": "https://app.roboflow.com/", "anchor_text": "a dataset health check"}, {"url": "https://public.roboflow.com/object-detection/bccd/health", "anchor_text": "public breast cancer dataset"}, {"url": "https://models.roboflow.com/object-detection", "anchor_text": "object detection"}, {"url": "https://blog.roboflow.com/intro-to-computer-vision/", "anchor_text": "introduction to computer vision"}, {"url": "https://docs.roboflow.com/dataset-health-check", "anchor_text": "Dataset Health Check"}, {"url": "https://roboflow.com/", "anchor_text": "Roboflow"}, {"url": "https://blog.roboflow.com/how-to-create-a-synthetic-dataset-for-computer-vision/", "anchor_text": "Synthetic augmentation"}, {"url": "https://blog.roboflow.com/tag/augmentation/", "anchor_text": "image augmentation"}, {"url": "https://blog.roboflow.com/why-and-how-to-implement-random-rotate-data-augmentation/", "anchor_text": "rotation"}, {"url": "https://blog.roboflow.com/why-to-add-noise-to-images-for-machine-learning/", "anchor_text": "bit of noise"}, {"url": "https://blog.roboflow.com/why-preprocess-augment/", "anchor_text": "improve how well our model generalizes to new data"}, {"url": "https://arxiv.org/abs/1106.1813", "anchor_text": "SMOTE"}, {"url": "https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/", "anchor_text": "Synthetic Minority Oversampling Technique"}, {"url": "https://en.wikipedia.org/wiki/Bootstrapping_(statistics)#:~:text=Bootstrapping%20is%20any%20test%20or,etc.)%20to%20sample%20estimates.", "anchor_text": "bootstrapping, or resampling with replacement"}, {"url": "https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/utils/class_weight.py", "anchor_text": "Python\u2019s scikit-learn package"}, {"url": "https://cran.r-project.org/web/packages/weights/weights.pdf", "anchor_text": "R's weights package"}, {"url": "https://projects.economist.com/us-2020-forecast/president/how-this-works#:~:text=typically%20by%20weighting", "anchor_text": "you may want to reweigh the results of your poll based on age and/or education"}, {"url": "http://scott.fortmann-roe.com/docs/BiasVariance.html", "anchor_text": "bias-variance tradeoff"}, {"url": "https://en.wikipedia.org/wiki/Silver_bullet", "anchor_text": "silver bullet"}, {"url": "https://blog.roboflow.com/google-paper-underspecification-machine-learning/", "anchor_text": "We\u2019ve written about a closely related issue, underspecification, here"}, {"url": "https://public.roboflow.com/", "anchor_text": "lots of examples of naturally occurring unbalanced classes"}, {"url": "https://blog.roboflow.com/handling-unbalanced-classes/", "anchor_text": "https://blog.roboflow.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----514e4dcae64d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/classification?source=post_page-----514e4dcae64d---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----514e4dcae64d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/statistics?source=post_page-----514e4dcae64d---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F514e4dcae64d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&user=Matt+Brems&userId=55680478461&source=-----514e4dcae64d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F514e4dcae64d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&user=Matt+Brems&userId=55680478461&source=-----514e4dcae64d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F514e4dcae64d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F514e4dcae64d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----514e4dcae64d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----514e4dcae64d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----514e4dcae64d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----514e4dcae64d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----514e4dcae64d--------------------------------", "anchor_text": ""}, {"url": "https://matthew-brems.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://matthew-brems.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matt Brems"}, {"url": "https://matthew-brems.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F55680478461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&user=Matt+Brems&userId=55680478461&source=post_page-55680478461--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F20e2b6771ab0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-strategies-for-handling-unbalanced-classes-514e4dcae64d&newsletterV3=55680478461&newsletterV3Id=20e2b6771ab0&user=Matt+Brems&userId=55680478461&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}