{"url": "https://towardsdatascience.com/creating-a-brewery-recommender-with-doc2vec-15ca20e28e7a", "time": 1683004848.880872, "path": "towardsdatascience.com/creating-a-brewery-recommender-with-doc2vec-15ca20e28e7a/", "webpage": {"metadata": {"title": "Creating a Brewery Recommender with Doc2Vec | by Aaron Abrahamson | Towards Data Science", "h1": "Creating a Brewery Recommender with Doc2Vec", "description": "In this article, I am going to go through how I trained and evaluated my brewery recommender. The deployed model can be found here: https://tinyurl.com/beer30rec. Beer30 is a content based brewery\u2026"}, "outgoing_paragraph_urls": [{"url": "https://tinyurl.com/beer30rec", "anchor_text": "https://tinyurl.com/beer30rec", "paragraph_index": 0}, {"url": "https://github.com/aabrahamson3/beer30", "anchor_text": "here is a link to the project repo", "paragraph_index": 0}, {"url": "https://medium.com/@aabrahamson3/my-brewery-recommender-initial-eda-ec579e0fb3c", "anchor_text": "here is my initial EDA", "paragraph_index": 1}, {"url": "https://tinyurl.com/beer30rec", "anchor_text": "https://tinyurl.com/beer30rec", "paragraph_index": 22}], "all_paragraphs": ["In this article, I am going to go through how I trained and evaluated my brewery recommender. The deployed model can be found here: https://tinyurl.com/beer30rec. Beer30 is a content based brewery recommender for travelers! If you are interested, here is a link to the project repo.", "I had tried to create a collaborative filter with both PySpark and Surprise, and sadly the results were not that great (here is my initial EDA looking at the numerical rating information of the dataset, but it is not too relevant for this part). The plan was to have a new user rate some number of beers they had tried, and then the model would match them to similar users and recommend based on those matched user\u2019s tastes. Certain beers were just rated so high by so many users that it ended up severely biasing the model and they were practically always recommended. I tried making a new user, and rated many of the top rated/hype barrel aged stouts all 1 (on a 5 point scale). Then when querying for recommendations, the model would still highly rank barrel aged stouts! So really, it did not work at all.", "I decided to focus on the text reviews, as they were filled with rich descriptive words. By looking only at the text reviews, and comparing amongst the beers, I was switching to training a content based recommender. While researching potential models it dawned on me that Doc2Vec could potentially work great \u2014 I could tag each unique beer as a unique document. The hyperdimensional space the model created would be a mapping of the beers!", "I wanted to show some examples of the kind of rich descriptive words available in the text data. Here are some excerpts:", "There is certainly some interesting nuances to the text. For instance in the second example: \u201cA bit too bitter for the style perhaps\u201d \u2014 the model is going to key in on \u201cbitter,\u201d but in this example it is not a beneficial trait. Something I would like to explore down the line is sentiment analysis. My initial thought is to average out the sentiment for each individual beer, and then factor that into the recommendation.", "One thing you will notice is that people do mention the beer style pretty consistently. I fought with including these or designating them as stop words (to be removed), decided to leave them in as there are so many varied ways to list a style. I\u2019d rather include all of them then only remove some of them.", "Load both the beers and reviews csv files into a Panda\u2019s DataFrame, and then process them with a custom function (from my functions.py file). We are also going to generate a set of stop words! These include some custom words for this use case: words about pouring the beer, what kind of glass they used (tulip, snifter, pint, glass) and relating to how the beer was stored (can, bottle, cap, cork). It also removes beers that have less than 10 reviews, and users that rate beer too low, or too high, consistently. Lastly, it removes weird unicode characters and removes reviews that do not have text. You end up with just under 2 million reviews.", "In Doc2Vec, each document has a tag. In this case, each beer review is a document, and we will tag each review with that beer\u2019s beer_id. The model will build a space where each beer has its own vector based upon the words within the collection of all reviews of that beer. Now we are going to do some NLP preprocessing and then stem all of the words in each review.", "This last step will take some time, as it is iterating through every word of almost 2 million reviews. Next we will instantiate a Doc2Vec object and have it build a vocabulary from all of the unique words in the corpus of text. Then we will train the model. These steps take over an hour on my laptop, but I also trained for 20 epochs in my final model (the below code is only 1).", "Go talk a walk or something while the model trains! Afterwards, you can use my location filter to start to explore breweries! The below code is an example of how to search with either a keyword, or a specific beer.", "The model also maps the vocab words in the same space as the documents, so you can match which beers are closest to a certain word. If you search for a specific beer it is a beer-to-beer comparison.", "It\u2019s challenging to evaluate a model like this because there is no quantitative way to do so. But one great way to visualize the model is with a technique called t-SNE (t-distributed stochastic neighbor embedding). It is a form of dimensionality reduction, similar to principal component analysis.", "The below code will create an array (X) with 22,514 elements (one for each beer). Then we fit/transform a t-SNE object with the document vectors, and convert the output array into a dataframe for plotting with Matplotlib.", "We see that the model has some really great separation! There is always a little overlap with beer styles, and this is also apparent from the figure. But there are very distinct groupings that we will soon see have great separation of beer styles.", "The model itself was not provided the style of the beer that is listed in the beers dataset, it is only trained on text reviews provided by users. However, individuals will sometimes reference the beer style within the review. There are 112 unique styles, so to simplify things we are going to bucket some of the styles. For example, there are a ton of different styles of IPA, pale ale, stout, etc. The below makes any style of IPA just \u2018IPA\u2019. Russian Imperial Stout, American Stout, Export Stout, etc will all be: Stout. The below code does this. This is painting with a broad stroke but it helps with the visualization", "Now let\u2019s plot subsets of beer styles and look at the separation!", "This on it\u2019s own is not that great of a visualization, since there are 64 styles and not enough colors to cover every one! So, for example, the red in different groups are all distinct groups.", "The purple/blue cluster in the middle and top are all of the \u2018Pale\u2019 and \u2018IPA\u2019 beers.", "But let\u2019s look closer at some other styles!", "Look at that! Some interesting things about this:- Belgian Quad and Belgian Strong Dark Ale are both closely related, and form their own separate cluster- We can see two distinct clusters for Barleywine \u2014 remember that we combined English and American Barleywine into one category!- Pumpkin Beers are all on their own (and same with the Scotch Ales)! The stouts and porters in this cluster and undoubtedly of the pumpkin variety, but my relabeling has caused them to be put in their broader category- With Stout/Porters, there can be a lot of overlap in style, and yet there is still some distinct clustering among the various sub-styles", "Let\u2019s now look at things on the sour \u2018spectrum\u2019:", "A little messier, but there is also a lot of overlap of styles when it comes to sours. - Belgian Gueuze, Lambic and Flanders beers are protected styles. A lot of American breweries will make it in the traditional styles, but they cannot label their beer as such. I think that can explain the overlapping on the right side- I would imagine the two groups of Berliner Weisse describe ones that are more sour (within American Wild Ale) and less sour (near the Gose cluster)", "Overall I am very happy with this model and how it learned from the messy and varied review data. If you\u2019d like to check out the interactive and deployed version, visit it here: https://tinyurl.com/beer30rec", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F15ca20e28e7a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aabrahamson3?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aabrahamson3?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": "Aaron Abrahamson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8b0ff7170187&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&user=Aaron+Abrahamson&userId=8b0ff7170187&source=post_page-8b0ff7170187----15ca20e28e7a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F15ca20e28e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F15ca20e28e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/StockSnap-894430/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2631121", "anchor_text": "StockSnap"}, {"url": "https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2631121", "anchor_text": "Pixabay"}, {"url": "https://tinyurl.com/beer30rec", "anchor_text": "https://tinyurl.com/beer30rec"}, {"url": "https://github.com/aabrahamson3/beer30", "anchor_text": "here is a link to the project repo"}, {"url": "https://medium.com/@aabrahamson3/my-brewery-recommender-initial-eda-ec579e0fb3c", "anchor_text": "here is my initial EDA"}, {"url": "https://pixabay.com/users/RyanMcGuire-123690/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=498257", "anchor_text": "Ryan McGuire"}, {"url": "https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=498257", "anchor_text": "Pixabay"}, {"url": "https://tinyurl.com/beer30rec", "anchor_text": "https://tinyurl.com/beer30rec"}, {"url": "https://medium.com/tag/nlp?source=post_page-----15ca20e28e7a---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/recommender-systems?source=post_page-----15ca20e28e7a---------------recommender_systems-----------------", "anchor_text": "Recommender Systems"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----15ca20e28e7a---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/doc2vec?source=post_page-----15ca20e28e7a---------------doc2vec-----------------", "anchor_text": "Doc2vec"}, {"url": "https://medium.com/tag/beer?source=post_page-----15ca20e28e7a---------------beer-----------------", "anchor_text": "Beer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F15ca20e28e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&user=Aaron+Abrahamson&userId=8b0ff7170187&source=-----15ca20e28e7a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F15ca20e28e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&user=Aaron+Abrahamson&userId=8b0ff7170187&source=-----15ca20e28e7a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F15ca20e28e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F15ca20e28e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----15ca20e28e7a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----15ca20e28e7a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aabrahamson3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aabrahamson3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aaron Abrahamson"}, {"url": "https://medium.com/@aabrahamson3/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8b0ff7170187&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&user=Aaron+Abrahamson&userId=8b0ff7170187&source=post_page-8b0ff7170187--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2e46dd2d0849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-brewery-recommender-with-doc2vec-15ca20e28e7a&newsletterV3=8b0ff7170187&newsletterV3Id=2e46dd2d0849&user=Aaron+Abrahamson&userId=8b0ff7170187&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}