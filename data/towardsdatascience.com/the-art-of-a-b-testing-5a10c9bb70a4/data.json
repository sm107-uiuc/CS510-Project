{"url": "https://towardsdatascience.com/the-art-of-a-b-testing-5a10c9bb70a4", "time": 1682993774.067919, "path": "towardsdatascience.com/the-art-of-a-b-testing-5a10c9bb70a4/", "webpage": {"metadata": {"title": "The art of A/B testing. Walk through the beautiful math of\u2026 | by Sylvain Truong | Towards Data Science", "h1": "The art of A/B testing", "description": "A/B testing is not only about splitting incoming traffic to different versions of a service. It is also about being able to interpret the results, using a solid statistics framework."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/statistical-significance-hypothesis-testing-the-normal-curve-and-p-values-93274fa32687", "anchor_text": "post", "paragraph_index": 18}, {"url": "https://medium.com/u/e2f299e30cb9?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "William Koehrsen", "paragraph_index": 18}, {"url": "https://towardsdatascience.com/statistics-for-people-in-a-hurry-a9613c0ed0b", "anchor_text": "article", "paragraph_index": 19}, {"url": "https://medium.com/u/2fccb851bb5e?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "Cassie Kozyrkov", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/@williamkoehrsen", "anchor_text": "@williamkoershen", "paragraph_index": 25}, {"url": "https://en.wikipedia.org/wiki/Z-test", "anchor_text": "Z-test", "paragraph_index": 25}, {"url": "https://en.wikipedia.org/wiki/Sum_of_normally_distributed_random_variables", "anchor_text": "wikipedia: sum of normally distributed rv", "paragraph_index": 31}, {"url": "https://en.wikipedia.org/wiki/Student%27s_t-test", "anchor_text": "Student\u2019s t-test", "paragraph_index": 40}, {"url": "https://ocw.mit.edu/courses/mathematics/18-443-statistics-for-applications-fall-2003/lecture-notes/lec23.pdf", "anchor_text": "Pearson\u2019s theorem", "paragraph_index": 49}, {"url": "https://en.wikipedia.org/wiki/Student%27s_t-test", "anchor_text": "Student\u2019s t-test", "paragraph_index": 61}, {"url": "https://en.wikipedia.org/wiki/Welch%27s_t-test", "anchor_text": "Welch\u2019s t-test", "paragraph_index": 61}, {"url": "https://en.wikipedia.org/wiki/Fisher%27s_exact_test", "anchor_text": "Fisher\u2019s exact test", "paragraph_index": 61}, {"url": "https://towardsdatascience.com/reinforcement-learning-64730aaa46c9", "anchor_text": "Reinforcement Learning", "paragraph_index": 61}, {"url": "https://unsplash.com/@rawpixel?utm_source=medium&utm_medium=referral", "anchor_text": "rawpixel", "paragraph_index": 64}, {"url": "https://unsplash.com/@_louisreed?utm_source=medium&utm_medium=referral", "anchor_text": "Louis Reed", "paragraph_index": 64}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash", "paragraph_index": 64}], "all_paragraphs": ["A/B testing, aka. split testing, refers to an experiment technique to determine whether a new design brings improvement, according to a chosen metric.", "In web analytics, the idea is to challenge an existing version of a website (A) with a new one (B), by randomly splitting traffic and comparing metrics on each of the splits.", "For the sake of example, let us look at beauty company Sephora South-East Asia (Sephora SEA, where I work), and in particular, its e-commerce platform.", "Let us assume Sephora SEA is considering a landing page rearrangement for its Gold members.", "The metrics that matter to the company are:", "An A/B test can be used to challenge to current arrangement.", "Note that you can choose the split of traffic not to be 50\u201350 and allocate more traffic to version A, in case you are concerned about losses due to version B.", "However, keep in mind that a very skewed split often leads to longer times before the A/B testing becomes (statistically) significant.", "The thing with the development of new features on a website is that you hardly know beforehand how these are going to perform: they may actually hurt your business or make your profits skyrocket.", "The knowledge of a User Experience (UX) designer is crucial in singling out feature suggestions that are likely to work. It would often follow best practices in UX or design examples that proved to be successful in other similar contexts.", "However, no prior assumption can beat the real live test that is the A/B test.", "The A/B test measures performance live, with real clients. Provided it is well executed, with no bias when sampling populations A and B, it gives you the best estimate of what would happen if you were to deploy version B.", "After doing some prior market study, Sephora SEA decides it would be interesting to live test version B, with the following traffic split:", "Let us assume that after 7 days of A/B testing, the tracking metrics of the experiment are", "Just from looking at these outcomes, some questions arise:", "Before jumping into conclusions, what you need to keep in mind is that", "The raw results we have are only samples of bigger populations. Their statistical properties vary around the ones of the populations they come from.", "Therefore, statistically modelling these outputs is necessary. Introducing the concept of statistical significance in hypothesis testing also is.", "For in-depth explanation of hypothesis testing, I would recommend this great post from William Koehrsen.", "As for people looking for a quick statistics refresher, you may want to look at this article from Cassie Kozyrkov.", "Here, I will go through the main lines of hypothesis testing: a tool to compare the distributions of 2 populations, based on samples from them.", "What can be compared are either parameters of their distributions (eg. mean of time spent) or the distributions themselves (eg. the binary distribution of conversion rate).", "The process starts in stating a null hypothesis H\u2080 about the populations. In general, it is the equality hypothesis: eg. \u201cthe two populations have the same mean\u201d.", "The alternative hypothesis H\u2081 negates the null hypothesis: eg. \u201cthe mean in the second population is higher than in the first\u201d.", "The test can be summarised in two steps:", "In the aforementioned post, @williamkoershen tests if the mean of hours of sleep in a university is lower than the national average, thus comparing an estimated value to a theoretical value. He uses a Z-test to do so.", "Here, I suggest to extend that framework to A/B testings in the case of Sephora SEA.", "The Z-test uses the Central Limit Theorem (CLT) to do so.", "The CLT establishes that:Given a random variable (rv) X of expectation \u03bc and finite variance \u03c3\u00b2, {X\u2081,\u2026,Xn}\u223c X, n independent identically distributed (iid) rv, the following approximation on their average (also a rv) can be made", "In our context, we model the time spent for each client session i as a realisation:", "We use the approximation provided by the CLT to derive that", "Hence the approximation for rv of the difference (wikipedia: sum of normally distributed rv),", "Under H\u2080, we have equality of the true means and therefore the model", "Note that true expectation and variance for A and B are unknown. We introduce their respective empirical estimators:", "Our samples generated the following test statistic Z, which needs to be tested against the reduced centered normal distribution:", "Conceptually, Z represents the number of standard deviations the observed difference of means is away from 0. The higher this number, the lesser the likelihood of H\u2080.", "Also notice that in the case the estimated expectations are actually different, (number of samples)\u2197, Z\u2197.", "From the formula of Z, you can also get the intuition that the smaller the difference to prove is, the more samples you need.", "In Python, the calculation looks like", "There is a pvalue chance that a result as extreme as the one we observed could have happened under H\u2080. With a common go-to \u03b1 criterion of 5%, we have pvalue<\u03b1 and H\u2080 can be rejected with confidence.", "In cases where the sample size is not as big (< 30 per version), and the CLT approximation does not hold, one may take a look at Student\u2019s t-test.", "Unlike the previous case, the outcome for each client session is not continuous but binary: either \u201cnot converted\u201d or \u201cconverted\u201d.", "The summary of the observed outcomes is the following", "The \u03c7\u00b2 test compares distributions of multinomial outcomes but we will keep to the binary case in this example.", "As before, we will tackle the problem in two steps:", "In H\u2080, conversions in version A and version B follow the same binomial distribution B(1,p). We pool the observations in both version A and B and derive the estimator for CR", "Thus, under H\u2080, the theoretical outcome table is", "Let us look at the rv D, defined by", "D represents a squared relative distance between the theoretical and the observed distributions.", "According to Pearson\u2019s theorem, under H\u2080, D follows a \u03c7\u00b2 probability law with 1 degree of freedom (df).", "It consists in computing the observed D and deriving its corresponding p-value according to the \u03c7\u00b2 law.", "This is how it can be done in Python:", "There is a pvalue chance that a result at least as distant from the theoretical distribution as our observation would have happened under H\u2080. With a common go-to \u03b1 criterion of 5%, we have pvalue>\u03b1 and H\u2080 cannot be rejected.", "The Z-test could be adapted to conversion rate by modelling conversion as an rv which realisations are in {0,1}:", "We keep the same notations as before and model conversion for each client session i as a realisation:", "This time, with binary rvs, it can be shown that the estimators for the standard deviations are functions of the expectations:", "To this end, we compute the Z-score and the corresponding right-tailed p-value:", "With this modelling, the p-value output is slightly lower than with the \u03c7\u00b2 test. With the same \u03b1=0.05 criterion, we would have rejected the null hypothesis (!!!).", "This difference may be explained by a slight weakness of the Z-test, which does not acknowledge here the binary nature of the rv: \u03bc(B)-\u03bc(A) is actually bounded in [-1,1] and the observation is therefore attributed a lower p-value.", "and never make assumptions. A/B testing is indeed a great way to alleviate human bias when deciding on relevance of new features. However, do not forget that A/B testing still relies on a model of truth: as we have seen, there are different possible models.", "In the case of large samples, they tend to converge to similar conclusions. In particular, the CLT approximation holds better than with small sample sizes.", "In the latter cases, one may explore Student\u2019s t-test, Welch\u2019s t-test and Fisher\u2019s exact test. You may also explore the realm of Reinforcement Learning in order to maximise gains while testing (Multi-armed bandits and the Exploitation vs Exploration dilemma).", "Not only should you be strict in your interpretations of results but also be aware of contextual effects of your A/B test:", "This concludes our statistics tour: I hope you enjoyed the ride as much as I enjoyed writing it! Comments, suggestions, corrections are much appreciated.", "Credits:Photos by rawpixel and Louis Reed on Unsplash", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "data science @ ServiceNow \u2014 Singapore-based \u2014 Production ML"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5a10c9bb70a4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@syltruong?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@syltruong?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "Sylvain Truong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa46494165933&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&user=Sylvain+Truong&userId=a46494165933&source=post_page-a46494165933----5a10c9bb70a4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a10c9bb70a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a10c9bb70a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/statistical-significance-hypothesis-testing-the-normal-curve-and-p-values-93274fa32687", "anchor_text": "post"}, {"url": "https://medium.com/u/e2f299e30cb9?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "William Koehrsen"}, {"url": "https://towardsdatascience.com/statistical-significance-hypothesis-testing-the-normal-curve-and-p-values-93274fa32687", "anchor_text": "Statistical Significance ExplainedWhat does it mean to prove something with data?towardsdatascience.com"}, {"url": "https://towardsdatascience.com/statistics-for-people-in-a-hurry-a9613c0ed0b", "anchor_text": "article"}, {"url": "https://medium.com/u/2fccb851bb5e?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "Cassie Kozyrkov"}, {"url": "https://towardsdatascience.com/statistics-for-people-in-a-hurry-a9613c0ed0b", "anchor_text": "Statistics for people in a hurryEver wished someone would just tell you what the point of statistics is and what the jargon means in plain English? Let\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/@williamkoehrsen", "anchor_text": "@williamkoershen"}, {"url": "https://en.wikipedia.org/wiki/Z-test", "anchor_text": "Z-test"}, {"url": "https://en.wikipedia.org/wiki/Central_limit_theorem", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Sum_of_normally_distributed_random_variables", "anchor_text": "wikipedia: sum of normally distributed rv"}, {"url": "https://en.wikipedia.org/wiki/Student%27s_t-test", "anchor_text": "Student\u2019s t-test"}, {"url": "https://ocw.mit.edu/courses/mathematics/18-443-statistics-for-applications-fall-2003/lecture-notes/lec23.pdf", "anchor_text": "Pearson\u2019s theorem"}, {"url": "https://en.wikipedia.org/wiki/Student%27s_t-test", "anchor_text": "Student\u2019s t-test"}, {"url": "https://en.wikipedia.org/wiki/Welch%27s_t-test", "anchor_text": "Welch\u2019s t-test"}, {"url": "https://en.wikipedia.org/wiki/Fisher%27s_exact_test", "anchor_text": "Fisher\u2019s exact test"}, {"url": "https://towardsdatascience.com/reinforcement-learning-64730aaa46c9", "anchor_text": "Reinforcement Learning"}, {"url": "https://unsplash.com/@rawpixel?utm_source=medium&utm_medium=referral", "anchor_text": "rawpixel"}, {"url": "https://unsplash.com/@_louisreed?utm_source=medium&utm_medium=referral", "anchor_text": "Louis Reed"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5a10c9bb70a4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----5a10c9bb70a4---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/marketing?source=post_page-----5a10c9bb70a4---------------marketing-----------------", "anchor_text": "Marketing"}, {"url": "https://medium.com/tag/testing?source=post_page-----5a10c9bb70a4---------------testing-----------------", "anchor_text": "Testing"}, {"url": "https://medium.com/tag/user-experience?source=post_page-----5a10c9bb70a4---------------user_experience-----------------", "anchor_text": "User Experience"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5a10c9bb70a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&user=Sylvain+Truong&userId=a46494165933&source=-----5a10c9bb70a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5a10c9bb70a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&user=Sylvain+Truong&userId=a46494165933&source=-----5a10c9bb70a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a10c9bb70a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5a10c9bb70a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5a10c9bb70a4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5a10c9bb70a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@syltruong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@syltruong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sylvain Truong"}, {"url": "https://medium.com/@syltruong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "390 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa46494165933&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&user=Sylvain+Truong&userId=a46494165933&source=post_page-a46494165933--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb5ca8a3cd78b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-a-b-testing-5a10c9bb70a4&newsletterV3=a46494165933&newsletterV3Id=b5ca8a3cd78b&user=Sylvain+Truong&userId=a46494165933&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}