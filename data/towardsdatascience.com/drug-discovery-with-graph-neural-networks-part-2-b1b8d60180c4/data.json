{"url": "https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4", "time": 1683012926.5338602, "path": "towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4/", "webpage": {"metadata": {"title": "Drug Discovery with Graph Neural Networks \u2014 part 2 | by Kacper Kubara | Towards Data Science", "h1": "Drug Discovery with Graph Neural Networks \u2014 part 2", "description": "In this article, we will cover another crucial factor that determines whether the drug can pass safety tests \u2014 toxicity. In fact, the toxicity accounts for 30% of rejected drug candidates making it\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-1-1011713185eb", "anchor_text": "my previous article", "paragraph_index": 1}, {"url": "https://medium.com/me/stats/post/1011713185eb", "anchor_text": "part 1", "paragraph_index": 2}, {"url": "https://tripod.nih.gov/tox21/challenge/about.jsp", "anchor_text": "Tox21 dataset", "paragraph_index": 5}, {"url": "https://github.com/KacperKubara/ml-cookbook/blob/master/drug_discovery_with_gnns/toxicity.ipynb", "anchor_text": "Colab notebook that you can run by yourself is here.", "paragraph_index": 7}, {"url": "https://arxiv.org/pdf/1509.09292.pdf", "anchor_text": "Duvenaud, et al", "paragraph_index": 8}, {"url": "https://github.com/deepchem/deepchem/tree/master/examples/tox21", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5826228/", "anchor_text": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5826228/", "paragraph_index": 17}, {"url": "http://www.linkedin.com/in/kacperkubara", "anchor_text": "www.linkedin.com/in/kacperkubara", "paragraph_index": 19}], "all_paragraphs": ["In this article, we will cover another crucial factor that determines whether the drug can pass safety tests \u2014 toxicity. In fact, the toxicity accounts for 30% of rejected drug candidates making it one of the most important factors to consider during the drug development stage [1]. Machine learning will prove here very beneficial as it can filter out toxic drug candidates in the early stage of the drug discovery process.", "I will assume that you\u2019ve read my previous article which explains some topics and terms that I will be using in this article :) Let\u2019s get started!", "The feature engineering part is pretty much the same as in part 1 of the series. To convert molecular structure into an input for GNNs, we can create molecular fingerprints, or feed it into graph neural network using adjacency matrix and feature vectors. This features can be automatically generated by external software such as RDKit or Deepchem so we don\u2019t have to worry much about it.", "The biggest difference is in the machine learning task itself. Toxicity prediction is a classification task, in contrary to the solubility prediction which is a regression task as we might recall from the previous article. There are many different toxicity effects such as carcinogenicity, respiratory toxicity, irritation/corrosion, and others [2]. This makes it a slightly more complicated challenge to work with as we might have to cope also with the imbalanced classes.", "Fortunately, the toxicity datasets are often considerably bigger than the solubility counterparts. For example, the Tox21 dataset has ~12k training samples when the Delaney dataset used for solubility prediction has only ~3k training samples. This makes neural networks architectures a more promising approach to use as it can capture more hidden information.", "Tox21 dataset was created as a project challenging researchers to develop machine learning models that achieve the highest performance on the given data. It contains 12 distinct labels and each indicates a different toxicity effect. Overall, the dataset has 12,060 training samples and 647 test samples.", "The winning approach for this challenge was DeepTox [3] which is a deep learning pipeline that utilizes chemical descriptors to predict the toxicity classes. It highly suggests that deep learning is the most effective approach and that graph neural networks have potential to achieve even higher performance.", "Colab notebook that you can run by yourself is here.", "Firstly, we import the necessary libraries. Nothing new here \u2014 we will be using Deepchem to train a GNN model on Tox21 data. The GraphConvModel is an architecture that was created by Duvenaud, et al. It uses a modified version of fingerprint algorithms to make them differentiable (so we can do a gradient update). It is one of the first GNN architectures that were designed to handle molecular structures as graphs.", "Deepchem contains a convenient API to load the Tox21 for us with .load_tox21 function. We choose a featurizer as GraphConv \u2014 it will create chemical descriptors (i.e. features) to match the input requirements for our model. As this is a classification task, ROC AUC score will be used as a metric.", "The beauty of the Deepchem is that the models use Keras-like API. We can train the model with .fit function. We pass len(tox21_tasks) into model\u2019s arguments, which is a number of labels (12 in this case). This will set the output size of the final layer as 12. We use a batch size of 32 to speed up the computation time and to specify that the model is used for the classification task. The model takes several minutes to train on the Google Colab notebooks.", "After the training is complete, we can evaluate the model. Nothing difficult here again\u2014 we can still use the Keras API for that part. The ROC AUC scores are obtained with the .evaluate function.", "In my case, the train ROC AUC score was higher than the validation ROC AUC score. This might indicate that model is overfitting to some molecules.", "You can do much more with Deepchem that. It contains several different GNN models that are as easy to use as in this tutorial. I highly suggest looking at their tutorials. For the toxicity task, they have gathered several different examples that run with different models. You can find it here.", "Thank you for reading the article, I hope it was useful for you!", "I am an MSc Artificial Intelligence student at the University of Amsterdam. In my spare time, you can find me fiddling with data or debugging my deep learning model (I swear it worked!). I also like hiking :)", "Here are my social media profiles, if you want to stay in touch with my latest articles and other useful content:", "[2] \u201cIn Silico Prediction of Chemical Toxicity for Drug Design Using Machine Learning Methods and Structural Alerts\u201d: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5826228/", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MSc in Artificial Intelligence at the University of Amsterdam | www.linkedin.com/in/kacperkubara"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb1b8d60180c4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kacperkubara?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": "Kacper Kubara"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fada6808c0b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&user=Kacper+Kubara&userId=ada6808c0b73&source=post_page-ada6808c0b73----b1b8d60180c4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1b8d60180c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1b8d60180c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@matthew_t_rader?utm_source=medium&utm_medium=referral", "anchor_text": "Matthew T Rader"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/KacperKubara/ml-cookbook/blob/master/drug_discovery_with_gnns/toxicity.ipynb", "anchor_text": "Jupyter Notebook for the article"}, {"url": "https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-1-1011713185eb", "anchor_text": "Drug Discovery with Graph Neural Networks \u2014 part 1"}, {"url": "https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d", "anchor_text": "Drug Discovery with Graph Neural Networks \u2014 part 3"}, {"url": "https://towardsdatascience.com/introduction-to-cheminformatics-7241de2fe5a8", "anchor_text": "Introduction to Cheminformatics"}, {"url": "https://medium.com/me/stats/post/625f4c5fb8cd", "anchor_text": "Feature Extraction for Graphs"}, {"url": "https://towardsdatascience.com/towards-explainable-graph-neural-networks-45f5e3912dd0", "anchor_text": "Towards Explainable Graph Neural Networks"}, {"url": "https://towardsdatascience.com/machine-learning-tasks-on-graphs-7bc8f175119a", "anchor_text": "Machine Learning Tasks on Graphs"}, {"url": "https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-1-1011713185eb", "anchor_text": "my previous article"}, {"url": "https://medium.com/me/stats/post/1011713185eb", "anchor_text": "part 1"}, {"url": "https://tripod.nih.gov/tox21/challenge/about.jsp", "anchor_text": "Tox21 dataset"}, {"url": "https://github.com/KacperKubara/ml-cookbook/blob/master/drug_discovery_with_gnns/toxicity.ipynb", "anchor_text": "Colab notebook that you can run by yourself is here."}, {"url": "https://arxiv.org/pdf/1509.09292.pdf", "anchor_text": "Duvenaud, et al"}, {"url": "https://github.com/deepchem/deepchem/tree/master/examples/tox21", "anchor_text": "here"}, {"url": "https://medium.com/@kacperkubara", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/kacperkubara/", "anchor_text": "Linkedin"}, {"url": "https://github.com/KacperKubara", "anchor_text": "Github"}, {"url": "https://kacperkubara.com/", "anchor_text": "Personal Website"}, {"url": "https://pubmed.ncbi.nlm.nih.gov/15286737/", "anchor_text": "https://pubmed.ncbi.nlm.nih.gov/15286737/"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5826228/", "anchor_text": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5826228/"}, {"url": "https://www.frontiersin.org/articles/10.3389/fenvs.2015.00080/full", "anchor_text": "https://www.frontiersin.org/articles/10.3389/fenvs.2015.00080/full"}, {"url": "https://medium.com/tag/graph-neural-networks?source=post_page-----b1b8d60180c4---------------graph_neural_networks-----------------", "anchor_text": "Graph Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b1b8d60180c4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/toxicity?source=post_page-----b1b8d60180c4---------------toxicity-----------------", "anchor_text": "Toxicity"}, {"url": "https://medium.com/tag/cheminformatics?source=post_page-----b1b8d60180c4---------------cheminformatics-----------------", "anchor_text": "Cheminformatics"}, {"url": "https://medium.com/tag/life-sciences?source=post_page-----b1b8d60180c4---------------life_sciences-----------------", "anchor_text": "Life Sciences"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1b8d60180c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&user=Kacper+Kubara&userId=ada6808c0b73&source=-----b1b8d60180c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1b8d60180c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&user=Kacper+Kubara&userId=ada6808c0b73&source=-----b1b8d60180c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1b8d60180c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb1b8d60180c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b1b8d60180c4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b1b8d60180c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kacper Kubara"}, {"url": "https://medium.com/@kacperkubara/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "622 Followers"}, {"url": "http://www.linkedin.com/in/kacperkubara", "anchor_text": "www.linkedin.com/in/kacperkubara"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fada6808c0b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&user=Kacper+Kubara&userId=ada6808c0b73&source=post_page-ada6808c0b73--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F378c2694fea3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4&newsletterV3=ada6808c0b73&newsletterV3Id=378c2694fea3&user=Kacper+Kubara&userId=ada6808c0b73&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}