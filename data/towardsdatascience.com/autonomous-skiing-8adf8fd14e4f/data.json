{"url": "https://towardsdatascience.com/autonomous-skiing-8adf8fd14e4f", "time": 1682997034.637713, "path": "towardsdatascience.com/autonomous-skiing-8adf8fd14e4f/", "webpage": {"metadata": {"title": "Autonomous skiing. Challenge : Create autonomous skier | by Erekle Shishniashvili | Towards Data Science", "h1": "Autonomous skiing", "description": "There is a lot of research going around autonomous agents, their applications and improvements. So, I was thinking about the autonomous vehicle, that could drive on the snow without any collisions\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.snowthegame.com/", "anchor_text": "http://www.snowthegame.com/", "paragraph_index": 1}, {"url": "https://github.com/Ersho/Autonomous-Skiing", "anchor_text": "Github", "paragraph_index": 2}], "all_paragraphs": ["There is a lot of research going around autonomous agents, their applications and improvements. So, I was thinking about the autonomous vehicle, that could drive on the snow without any collisions. Unfortunately, I don\u2019t have enough resources and time to construct a real robot with special hardware that will manage to drive on the snow. So I decided to run my experiment on the simulator.", "The simulator that I choose for this project is the normal game called SNOW (http://www.snowthegame.com/ ). The game is free (There is free map as well as the ones that you have to pay to get access). The gameplay is pretty straightforward. You have the man that you can control, you can play with both, using snowboard as well as ski. For this project, I choose to ski. This is how our game based simulator looks like.", "In this post I will try to explain an end to end pipeline of this self moving skier. You can see the code for the whole project on Github. Don\u2019t hesitate to contribute to project, or ask me questions if you have any.", "Firstly, I would like to explain how to get the images from the game. As the SNOW is not an actual simulator, there is no special code that will allow us to get stream as images from the game, to get that we have to grab our screen using python and cut the part where the entire screen is located. Here is the code for grabbing the image and getting the input.", "This gives us the frame taken from the game. But, before we move forward let\u2019s discuss, how to use keyboard keys using python to maneuver. Every key on the keyboard has its own representation in hex (Hexadecimal). We use these hex values to access keys on the keyboard.", "After setting the dictionary for our keys and their hex values. We write functions for events of pressing and releasing the key. The functions are located in \u201cget_input.py\u201d.", "Now, we have everything ready to start working with perception and decision-making steps.", "Firstly, I would like to have a brief overview of the computer vision part, that gives the AI agent the possibility to understand the environment around it.", "Fortunately for us, snow is a very good environment for autonomous vehicles, as it\u2019s completely white and we have to determine it from trees and obstacles that are mostly black or darker than gray. To differentiate the snow from the obstacles, we take a threshold value for our pixels and implement the function, which receives an input image frame and returns back binary image with the same size, where white is navigable area, and black is all the obstacles.", "Next, we crop the region of interest. What this means is that while analyzing the image, we don\u2019t need the entire screen, we are only interested what happens in front of us so that our skier can move based on the vision that he has in front. Based on this fact, we crop only a small part of our image. This technique gives us a much smaller image, which becomes much more efficient to calculate as well as we get only the specific region that we are interested in. If you look from a human perspective, for navigation you only use the sight that you have in front of you to avoid obstacles, you hardly get interested in trees that are 100 meters away from you. The same principle is applied above.", "After we get the cropped region, we do the perspective transform to get the birds view of the cropped region. Here how it looks using the 2 images.", "Next one we calculate pixel positions with reference to the skier position being at the center bottom of the image.", "Then as the final step, we calculate the navigation angle, which we clip from [-15,15]. 0 means that we move in front without steering and we don\u2019t have any obstacles in front. 15 means we steer to right and for -15 to left.", "This is what our final visual representation looks like.", "We have finished implementing the perception part, that gives us the understanding of the environment that our virtual skier is facing. Next step is the decision making process. This is a very important step. Think about it, in one moment you can be skiing in the horizontal field, without any obstacles. In this case, you will have navigation angle always 0 and you can always push the button W to just move forward and increase the speed. But in this simulator pressing W makes skier use the poles to accelerate and constantly spamming W would look just ridiculous.", "Instead, pressing \u201cLFShift\u201d allows the skier to enter the tuck position and move freely while increasing speed. If we want to have a good autonomous agent we should write logic behind our decision making steps. In order to efficiently solve these types of issues, we create class Decision. In this case, we have parameters like a steer, accelerate, speed and etc. So let\u2019s discuss firstly what we want to implement.", "(press W). If this keeps up for some time (let\u2019s say for 10 consecutive frames) we start to enter the tuck state(press Left Shift). While our angle is in range (-7,7) we continue moving in the tuck position. but if we get navigation angle below, or higher than the previous values, ((-15,-7), (7,15)) , we steer according to the angle and slowly stop our skier and reset the state, meaning after reducing the speed we start decision steps from beginning, using the movement with poles. If we don\u2019t get to the 10 consecutive frames, to tuck mode because of navigation angle is somewhere less or higher than the threshold value, we continue moving in normal state. Which is much safer and easier to regulate", "Note** while in tuck state our speed increases very much, in normal scenario our fps ranges from 1\u20135, which is not much. When our skier goes very fast and fps drops to 1, decision making step cant keep up to the movement of the man, so it crashes.", "As we have said, Decision making is the most interesting and challenging task in our case. Especially, when we want a smooth transition from tuck state to moving forward with poles. To do that we have to keep track of our man. Because of that, we create an Object called the Decision. We define the following parameters in it", "First two lines are for creating variables, for tracking velocity and acceleration. In this case, we don\u2019t actually track the actual speed and acceleration of the object, but instead append them by some value while so we approximately know, how fast we are going. This gives us a very basic idea of the velocity and acceleration of the object. The last 2 variables tuck and forward_time is for changing the state of the object. As we said if we don\u2019t have a big change in angle after 10 consecutive frames, we change skier state and he enters in the tuck position. Variable with name tuck defines the state, when tuck is 0, we use poles to move forward, but when it\u2019s 2 it means skier is in the tuck position. We iterate \u201cforward_time\u201d to count the number of consecutive frames in which the angle was not changed.", "Now, let\u2019s discuss our movement step", "I will walk you through this step by step.Firstly, we check the tuck state, if it\u2019s zero we remain in pole state (skier is using the poles). Next, we check the variable \u201cangle\u201d that is the function argument given above, calculated in perception step. If the angle is close to 0, it means we are moving without detecting any obstacles in front. As you see, if this happens we just append to our forward time. If our angle is still close to 0, and our forward time is more than 20, we go to tuck state \u201c1\u201d. When we call this function again, if we have tuck state as 1, we enter the tuck state, and our skier starts moving in the tuck position. If our angle is not close to 0, meaning we have some obstacle in front, we steer immediately to the angle direction, then we check for the tuck state, if we are in tuck state, we leave the state, reset forward time, and we slow down our skier, by calling the function \u201cstop\u201d. The slow down process is essential so that our skier does not gain too much speed. As controlling skier on high speed becomes much harder, especially on low fps like we have 1\u20135.Finally, we\u2019ve arrived at the last if statement. As you remember, we had variable \u201cvel\u201d for tracking the velocity. We check this velocity on every function call. If it becomes greater than some value (in our case 5), we slow down our skier.This is our end to end decision steps of our skier, which works very well, here is a little demo for that.", "For steering, you will see 2 functions \u201cfaster_steer\u201d and normal \u201csteer\u201d. In the game SNOW, if you press Left Shift and then steer, it will go faster to the right or to the left. I have actually taken that step into consideration. And divided steering angle into 2 steps, if it\u2019s between [-15, -7],[7,15] I use fast steer, from [-7,0.5],[0.5,7] I use normal steer.", "In this article, I explained how I managed to create from normal game SNOW, simulator for my autonomous skiing example. Working on this project was very fun, and it had some big challenges, like not going too fast, maneuvering fast, detecting every obstacle in front, etc.", "This project is designed for experimenting and learning purposes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8adf8fd14e4f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@eshishniashvili3?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eshishniashvili3?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": "Erekle Shishniashvili"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fab1548aca15f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&user=Erekle+Shishniashvili&userId=ab1548aca15f&source=post_page-ab1548aca15f----8adf8fd14e4f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8adf8fd14e4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8adf8fd14e4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.snowthegame.com/", "anchor_text": "http://www.snowthegame.com/"}, {"url": "https://github.com/Ersho/Autonomous-Skiing", "anchor_text": "Github"}, {"url": "https://github.com/Ersho/Autonomous-Skiing", "anchor_text": "https://github.com/Ersho/Autonomous-Skiing"}, {"url": "https://www.udacity.com/course/robotics-software-engineer--nd209", "anchor_text": "https://www.udacity.com/course/robotics-software-engineer--nd209"}, {"url": "https://pythonprogramming.net/game-frames-open-cv-python-plays-gta-v/", "anchor_text": "https://pythonprogramming.net/game-frames-open-cv-python-plays-gta-v/"}, {"url": "http://www.snowthegame.com/", "anchor_text": "http://www.snowthegame.com/"}, {"url": "https://medium.com/tag/python?source=post_page-----8adf8fd14e4f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/autonomous-cars?source=post_page-----8adf8fd14e4f---------------autonomous_cars-----------------", "anchor_text": "Autonomous Cars"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8adf8fd14e4f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----8adf8fd14e4f---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8adf8fd14e4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&user=Erekle+Shishniashvili&userId=ab1548aca15f&source=-----8adf8fd14e4f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8adf8fd14e4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&user=Erekle+Shishniashvili&userId=ab1548aca15f&source=-----8adf8fd14e4f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8adf8fd14e4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8adf8fd14e4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8adf8fd14e4f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8adf8fd14e4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eshishniashvili3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eshishniashvili3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Erekle Shishniashvili"}, {"url": "https://medium.com/@eshishniashvili3/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fab1548aca15f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&user=Erekle+Shishniashvili&userId=ab1548aca15f&source=post_page-ab1548aca15f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fab1548aca15f%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautonomous-skiing-8adf8fd14e4f&user=Erekle+Shishniashvili&userId=ab1548aca15f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}