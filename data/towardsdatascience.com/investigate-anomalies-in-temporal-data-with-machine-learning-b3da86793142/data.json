{"url": "https://towardsdatascience.com/investigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142", "time": 1683013975.151513, "path": "towardsdatascience.com/investigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142/", "webpage": {"metadata": {"title": "Explore temporal data with Python, Machine Learning | Towards Data Science", "h1": "Investigate Anomalies in Temporal Data With Machine Learning", "description": "Analyze trend, seasonality, and find outliers and anomalies in temporal data using Python and Machine Learning. Learn to use Bokeh, Prophet, and sklearn."}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/drive/1rrkJ-pcddna7Ft8Zv-xYgPIVMduJi49u?usp=sharing", "anchor_text": "this notebook", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/level-up-your-visualizations-make-interactive-maps-with-python-and-bokeh-7a8c1da911fd", "anchor_text": "my last article", "paragraph_index": 1}, {"url": "https://raw.githubusercontent.com/ConnerBrew/Iraq-Conflict-Data/master/conflict_data_irq.csv", "anchor_text": "here", "paragraph_index": 3}, {"url": "http://acleddata.com", "anchor_text": "ACLED website", "paragraph_index": 3}, {"url": "https://colab.research.google.com/drive/1rrkJ-pcddna7Ft8Zv-xYgPIVMduJi49u?usp=sharing", "anchor_text": "this notebook", "paragraph_index": 5}, {"url": "https://raw.githubusercontent.com/ConnerBrew/Iraq-Conflict-Data/master/conflict_data_irq.csv", "anchor_text": "Github", "paragraph_index": 5}, {"url": "https://www.youtube.com/watch?v=pOYAXv15r3A&t=1053s", "anchor_text": "this video of a presentation given by Prophet\u2019s developer.", "paragraph_index": 11}, {"url": "https://colab.research.google.com/drive/1rrkJ-pcddna7Ft8Zv-xYgPIVMduJi49u?usp=sharing", "anchor_text": "this notebook", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/https-medium-com-chayankathuria-regression-why-mean-square-error-a8cad2a1c96f", "anchor_text": "this article", "paragraph_index": 15}, {"url": "https://machinelearningmastery.com/exponential-smoothing-for-time-series-forecasting-in-python/", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://docs.bokeh.org/en/latest/docs/user_guide/quickstart.html", "anchor_text": "getting started guide", "paragraph_index": 18}, {"url": "https://www.linkedin.com/in/cmbrew/", "anchor_text": "https://www.linkedin.com/in/cmbrew/", "paragraph_index": 31}], "all_paragraphs": ["In this notebook, we will be exploring Facebook\u2019s open-source SARIMA model Prophet to identify outliers in time-series data. Here\u2019s what you\u2019ll learn:", "In my last article, we worked with spatial data \u2014 that is, data with coordinates that exist somewhere in space. Temporal data is often a companion to spatial data, and it is any data with a time or date associated with it. Temporal data is critical for overall understanding of your dataset, and being able to understand statistics associated with time \u2014 trend, seasonality, and outliers \u2014 will significantly increase your overall capabilities when it comes to working with business data.", "In the field of national security and defense that is my specialty, there may be no more important data type than temporal data. Temporal data helps us see patterns through time, and make predictions about the future. That\u2019s what you\u2019ll learn to do, too, in this article.", "We will be using data from the Armed Conflict Location Event Database, specifically narrowed to Iraq. The data can be downloaded from github here, or from the ACLED website. We will be analyzing the trend and seasonality of conflict event data in Iraq from 2016\u20132020, forecasting that data, and identifying outliers. We\u2019ll then create a companion line chart that will allow us to drill down on specific event categories, so we can investigate outliers once they\u2019re identified. Let\u2019s go!", "First, let\u2019s import our necessary libraries. We\u2019ll be using all of Bokeh to create our interactive graphics, fbprophet for the Prophet pre-built model, sklearn for model optimization, and pandas for some data manipulation.", "You can find the specific data I used in this notebook on Github. However, I strongly urge you to try using your own time-series data in this exercise!", "In this code block, we\u2019ll be using the value_counts() method to get the data we need for our line chart. We want to visualize the amount of events on each day, so we apply value_counts() to our date group.", "Throughout the article, you\u2019ll see a couple practices that I like to apply whenever I deal with date-time data. Firstly, I re-sort my dataframe every time I do an operation against it \u2014 this helps reduce error later on when we train our model. I also always like to have one column in my dataframe that is in datetime format and another column in string format. I use the datetime column for analysis, and the string column for labels, legends, and tooltips.", "Next, we want to get the value_counts() for each event type. The final product will be a visualization that allows users to select a time window in the line chart, then display relevant event types in a second partner visualization. We\u2019ll follow the same steps as above, but now for each event type in the event_type field. We will do this using the groupby() method.", "Next, simply drop duplicates and re-sort our values.", "Prophet is an open-source SARIMA model developed by facebook. SARIMA is a time-series regression (read: prediction) technique that takes into account various statistical properties of a time-series dataset including moving average, seasonality, and trend. Trend is a property of time-series data that has to do with the overall positive and negative growth in the dataset. Seasonality has to do with the cyclical changes in the dataset, such as regular decreases in activity on a weekend or increases on a daily basis every afternoon.", "Prophet was originally developed to service Facebook\u2019s forecasting needs, as the facebook office relies heavily on time-series forecasting for setting goals and measuring progress. You can learn more about Prophet and its origins by watching this video of a presentation given by Prophet\u2019s developer.", "Prophet requires two data sources to function: \u2018ds\u2019, which stands for datestamp, and \u2018y\u2019, the target variable. If you\u2019re following along with this notebook, then we\u2019ve already done this \u2014 if not, then keep this in mind for your own data.", "Model optimization is a key element of any machine learning project. All machine learning models have one or two key parameters that need to be optimized for best performance of the model. In the case of Prophet, that parameter is changepoint_prior_scale. This parameter defines how flexibly the model responds to changepoints in the data set, and needs to be optimized to prevent over and under-fitting.", "To optimize this, we\u2019ll use a very simple optimization model. It simply iterates through a user-defined epoch, tests each parameter, and selects the parameter that returned the lowest error. For this purpose, we\u2019ll use the Mean Squared Error statistic.", "For more information on model optimization using mean squared error, see this article about mean squared error and linear regression.", "Now that the model has been optimized, we train it on our data. You\u2019ll see that, with the data I provided, the MSE (mean squared error) is around 38. This may seem high, but is perfectly fine for time-series forecasting \u2014 usually an MSE below 50 is good for these purposes.", "If you want to further reduce the error rate, a common technique is to apply exponential smoothing to the data before training the model. Think of it like scaling and normalization for time-series data \u2014 you can learn more about exponential smoothing of time-series data here.", "We will be using Bokeh to plot our data. Interactivity is a great way to make your data visualizations stand out and provide more use and insight to your customers. Although there are other libraries and methods for creating interactive visualizations, Bokeh is my preferred library. However, this is not a Bokeh tutorial. If you are unfamiliar with Bokeh, try their getting started guide.", "Basically, we will plot the original data as a line glyph inside the Bokeh plot and plot the Uncertainty Bounds, represented in the Prophet dataframe as yhat_upper and yhat_lower as an area plot.", "As discussed above, Trend and Seasonality are two of the key statistical properties of time-series data. Understanding these factors is critical for understanding the data itself. Prophet makes this easy, with the plot_components method.", "In the plots below, you can see that Iraq conflict events have had an overall negative trend over the past several years (as ISIS has been steadily defeated). However, you can see that there has been a slight upward trend throughout 2020 \u2014 this is due to a variety of factors including the coronavirus pandemic and US withdrawal from multiple bases in the area, which has led to an increase in ISIS activity.", "In regards to seasonality, you can see some interesting patterns \u2014 activity is generally low on Fridays, which is the Muslim sabbath. You can see a hump in activity in March \u2014 June, which is well known as the common western desert fighting season due to the warmer temperatures that dry out the wadis and make the terrain easier to pass; this also typically coincides with the Muslim holy month of Ramadan. Interestingly, the data also shows high activity in October-November, very likely due to cooler weather following the hot summer months. In the case of recent years, this has also been an annual period rife with political conflict and protesting.", "Next, we will identify our outliers in the time-series data. These are events that rise above the trend and seasonality identified by the Prophet model. This is critical for national security and defense data. In Iraq, for example, we know that there are seasonal rises and falls for terrorist activity. When those seasonal rises come, how can we know whether it is worse than usual? Outlier detection helps identify possible resurgences of terrorist activity, allowing us to be better prepared.", "We will use a simple methodology \u2014 we look for data points that rise above the upper uncertainty bound predicted by Prophet, then plot that point. In the resulting plot, we can see that nearly all of 2016 was rife with higher-than-expected terrorist activity and that the same is true of late 2019 and early 2020 \u2014 this is due to the political instability following the transition of power from Iraqi PM Abdul-Mahdi to the new PM Kadhimi, significant protest and riot activity beginning in October 2019, as well as above-mentioned factors like US drawdown and the coronavirus pandemic.", "I want to investigate the outlier activity more thoroughly. I want to know, in times of increased activity, what types of events make up that data \u2014 IEDs, conventional warfare battles, etc. To do this, we will make a second plot to visualize that data.", "Bokeh automatically links selection between plots sharing a ColumnDataSource. Because the data for both plots is coming from the same dataframe, selections in one plot will automatically be reflected in the second plot. All we need to do is visually style the elements to draw attention to the selected elements, and make it clear what categories are prevalent in different time periods.", "In the case of this data, we will use the selection_glyph and nonselection_glyph properties in Bokeh to make data invisible if it is not selected. This will allow us to easily see what types of data are prevalent for time windows that we select in the original plot.", "The main plot uses a box_select tool to dynamically change the visualization. Place your mouse cursor inside the plot and drag to select a time window \u2014 watch the visualization display change!", "Now you can analyze time-series data using SARIMA forecasting techniques with the Prophet machine learning model. You can automatically optimize your model, and use it to understand trend and seasonality properties inside your data. You can plot that information in interactive charts for later publishing in a dashboard or web application. Great work!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Marine Corps Veteran and Data Scientist Specializing in National Security and Counter-Terrorism. Find me on Linkedin at: https://www.linkedin.com/in/cmbrew/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb3da86793142&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b3da86793142--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b3da86793142--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@conner.brew?source=post_page-----b3da86793142--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@conner.brew?source=post_page-----b3da86793142--------------------------------", "anchor_text": "Conner Brew"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5368ea679397&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&user=Conner+Brew&userId=5368ea679397&source=post_page-5368ea679397----b3da86793142---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3da86793142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3da86793142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colab.research.google.com/drive/1rrkJ-pcddna7Ft8Zv-xYgPIVMduJi49u?usp=sharing", "anchor_text": "this notebook"}, {"url": "https://towardsdatascience.com/level-up-your-visualizations-make-interactive-maps-with-python-and-bokeh-7a8c1da911fd", "anchor_text": "my last article"}, {"url": "https://raw.githubusercontent.com/ConnerBrew/Iraq-Conflict-Data/master/conflict_data_irq.csv", "anchor_text": "here"}, {"url": "http://acleddata.com", "anchor_text": "ACLED website"}, {"url": "https://colab.research.google.com/drive/1rrkJ-pcddna7Ft8Zv-xYgPIVMduJi49u?usp=sharing", "anchor_text": "this notebook"}, {"url": "https://raw.githubusercontent.com/ConnerBrew/Iraq-Conflict-Data/master/conflict_data_irq.csv", "anchor_text": "Github"}, {"url": "https://www.youtube.com/watch?v=pOYAXv15r3A&t=1053s", "anchor_text": "this video of a presentation given by Prophet\u2019s developer."}, {"url": "https://colab.research.google.com/drive/1rrkJ-pcddna7Ft8Zv-xYgPIVMduJi49u?usp=sharing", "anchor_text": "this notebook"}, {"url": "https://towardsdatascience.com/https-medium-com-chayankathuria-regression-why-mean-square-error-a8cad2a1c96f", "anchor_text": "this article"}, {"url": "https://machinelearningmastery.com/exponential-smoothing-for-time-series-forecasting-in-python/", "anchor_text": "here"}, {"url": "https://docs.bokeh.org/en/latest/docs/user_guide/quickstart.html", "anchor_text": "getting started guide"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b3da86793142---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time?source=post_page-----b3da86793142---------------time-----------------", "anchor_text": "Time"}, {"url": "https://medium.com/tag/dashboard?source=post_page-----b3da86793142---------------dashboard-----------------", "anchor_text": "Dashboard"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b3da86793142---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----b3da86793142---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb3da86793142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&user=Conner+Brew&userId=5368ea679397&source=-----b3da86793142---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb3da86793142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&user=Conner+Brew&userId=5368ea679397&source=-----b3da86793142---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3da86793142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b3da86793142--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb3da86793142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b3da86793142---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b3da86793142--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b3da86793142--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b3da86793142--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b3da86793142--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b3da86793142--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b3da86793142--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b3da86793142--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b3da86793142--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@conner.brew?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@conner.brew?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Conner Brew"}, {"url": "https://medium.com/@conner.brew/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "54 Followers"}, {"url": "https://www.linkedin.com/in/cmbrew/", "anchor_text": "https://www.linkedin.com/in/cmbrew/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5368ea679397&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&user=Conner+Brew&userId=5368ea679397&source=post_page-5368ea679397--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb1ebfe96413&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigate-anomalies-in-temporal-data-with-machine-learning-b3da86793142&newsletterV3=5368ea679397&newsletterV3Id=b1ebfe96413&user=Conner+Brew&userId=5368ea679397&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}