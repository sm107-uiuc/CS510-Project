{"url": "https://towardsdatascience.com/binary-classification-of-imdb-movie-reviews-648342bc70dd", "time": 1683010703.326037, "path": "towardsdatascience.com/binary-classification-of-imdb-movie-reviews-648342bc70dd/", "webpage": {"metadata": {"title": "Binary Classification of IMDB Movie Reviews | by Rakshit Raj | Towards Data Science", "h1": "Binary Classification of IMDB Movie Reviews", "description": "In this example, we will design a neural network to perform two-class classification, or binary classification, of reviews, from the IMDB movie reviews dataset, to determine whether the reviews are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://deepai.org/machine-learning-glossary-and-terms/hidden-layer-machine-learning#:~:text=Hidden%20layers%2C%20simply%20put%2C%20are,specific%20to%20an%20intended%20result.&text=Hidden%20layers%20allow%20for%20the,to%20produce%20a%20defined%20output.", "anchor_text": "DeepAI.org", "paragraph_index": 20}, {"url": "https://github.com/rakshitraj/kaggle/", "anchor_text": "here", "paragraph_index": 51}, {"url": "https://www.manning.com/books/deep-learning-with-python", "anchor_text": "Deep Learning with Python by Francois Chollet", "paragraph_index": 52}, {"url": "https://github.com/rakshitraj/fchollet", "anchor_text": "implementation", "paragraph_index": 53}, {"url": "https://github.com/rakshitraj/", "anchor_text": "GitHub", "paragraph_index": 53}], "all_paragraphs": ["Binary Classification refers to classifying samples in one of two categories.", "In this example, we will design a neural network to perform two-class classification, or binary classification, of reviews, from the IMDB movie reviews dataset, to determine whether the reviews are positive or negative. We will use the Python library, Keras.", "If you are looking for a more fundamental problem, check out solving the MNIST dataset. The content that follows builds primarily on solving MNIST, the \u2018hello world! of deep learning.", "The IMDB dataset is a set of 50,000 highly polarized reviews from the Internet Movie Database. They are split into 25000 reviews each for training and testing. Each set contains an equal number (50%) of positive and negative reviews.", "The IMDB dataset comes packaged with Keras. It consists of reviews and their corresponding labels (0 for negative and 1 for positive review). The reviews are a sequence of words. They come preprocessed as a sequence of integers, where each integer stands for a specific word in the dictionary.", "The IMDB dataset can be loaded directly from Keras and will usually download about 80 MB on your machine.", "Let\u2019s load the prepackaged data from Keras. We will only include 10,000 of the most frequently occurring words.", "For kicks, let\u2019s decode the first review.", "We cannot feed a list of integers into our deep neural network. We will need to convert them into tensors.", "To prepare our data, we will One-hot Encode our lists and turn them into vectors of 0\u2019s and 1\u2019s. This would blow up all of our sequences into 10,000-dimensional vectors containing 1 at all indices corresponding to integers present in that sequence. This vector will have element 0 at all index, which is not present in the integer sequence.", "Simply put, the 10,000-dimensional vector corresponding to each review will have", "We will vectorize our data manually for maximum clarity. This will result in a tensor of shape (25000, 10000).", "Our input data is vectors that need to be mapped to scaler labels (0s and 1s). This is one of the easiest setups, and a simple stack of fully-connected, Dense layers with relu activation perform quite well.", "In this network, we will leverage hidden layers. We will define our layers as such.", "The argument being passed to each Dense layer, (16) is the number of hidden units of a layer.", "The output from a Dense layer with relu activation is generated after a chain of tensor operations. This chain of operations is implemented as", "Where, W is the Weight matrix and b is the bias (tensor).", "Having 16 hidden units means that the matrix W will be of the shape (input_Dimension, 16 ). In this case, where the dimension of the input vector is 10,000, the shape of the Weight matrix will be (10000, 16). If you were to represent this network as a graph, you would see 16 neurons in this hidden layer.", "To put it in layman\u2019s terms, there will be 16 balls in this layer.", "Each of these balls or hidden units is a dimension in the representation space of the layer. Representation space is the set of all viable representations for the data. Every hidden layer composed of its hidden units aims to learn one specific transformation of the data or one feature/pattern from the data.", "DeepAI.org has a very informative write-up on hidden layers.", "Hidden layers, simply put, are layers of mathematical functions each designed to produce an output specific to an intended result.", "Hidden layers allow for the function of a neural network to be broken down into specific transformations of the data. Each hidden layer function is specialized to produce a defined output.For example, a hidden layer functions that are used to identify human eyes and ears may be used in conjunction by subsequent layers to identify faces in images. While the functions to identify eyes alone are not enough to independently recognize objects, they can function jointly within a neural network.", "For our model, we will use", "There are formal principles that guide our approach in selecting the architectural attributes of a model. These are not covered in this case study.", "In this step, we will choose an optimizer, a loss function, and metrics to observe. We will go forward with", "We can pass our choices for optimizer, loss function and metrics as strings to the compile function because rmsprop, binary_crossentropy and accuracy come packaged with Keras.", "One could use a customized loss function or optimizer by passing a custom class instance as an argument to the loss, optimizer or mertics fields.", "In this example, we will implement our default choices, but we will do so by passing class instances. This is precisely how we would do it if we had customized parameters.", "We will set aside a part of our training data for validation of the accuracy of the model as it trains. A validation set enables us to monitor the progress of our model on previously unseen data as it goes through epochs during training.", "Validation steps help us fine-tune the training parameters of the model.fit function to avoid Overfitting and underfitting of data.", "Initially, we will train our models for 20 epochs in mini-batches of 512 samples. We will also pass our validation set to the fit method.", "Calling the fit method returns a History object. This object contains a member history which stores all data about the training process, including the values of observable or monitored quantities as the epochs proceed. We will save this object to determine the fine-tuning better to apply to the training step.", "At the end of the training, we have attained a training accuracy of 99.85% and validation accuracy of 86.57%", "Now that we have trained our network, we will observe its performance metrics stored in the History object.", "Calling the fit method returns a History object. This object has an attribute history which is a dictionary containing four entries: one per monitored metric.", "at the end of each epoch.", "Let\u2019s use Matplotlib to plot Training and validation losses and Training and Validation Accuracy side by side.", "We observe that minimum validation loss and maximum validation Accuracy is achieved at around 3\u20135 epochs. After that, we observe two trends:", "This implies that the model is getting better at classifying the sentiment of the training data, but making consistently worse predictions when it encounters new, previously unseen data. This is the hallmark of Overfitting. After the 5th epoch, the model begins to fit too closely to the training data.", "To address Overfitting, we will reduce the number of epochs to somewhere between 3 and 5. These results may vary depending on your machine and due to the very nature of the random assignment of weights that may vary from model to model.", "In our case, we will stop training after 3 epochs.", "We retrain our neural network based on our findings from studying the history of loss and accuracy variation. This time we run it for 3 epochs so as to avoid Overfitting on training data.", "In the end, we achieve a training accuracy of 99% and a validation accuracy of 86%. This is pretty good, considering we are using a very naive approach. A higher degree of accuracy can be achieved by using a better training algorithm.", "We will use our trained model to make predictions for the test data. The output is an array of floating integers that denote the probability of a review being positive. As you can see, in some cases, the network is absolutely sure the review is positive. In other cases \u2014 not so much!", "You could try to find some error metric for the number of sentiments that were wrongly classified by using a metric like mean squared error as I did here. But it would be stupid to do so! The analysis of the result is not something we will cover here. However, I will shed some light on why usingmse is futile in this case.", "The result from our model is the measure of how much the model perceives a review to be positive. Rather than telling us the absolute class of the sample, the model tells us by how much it perceives the sentiment to be skewed on one side or the other. MSE is too simple a metric and fails to capture the complexity of the solution.", "I did not visualize this neural net. I would, but it is a time-consuming process. I did visualize the neural network I used in solving the MNIST problem. If you want you could check out this GitHub Project for visualizing ANNs", "And thus, we have successfully classified reviews on IMDB. I guess this calls for rewatching The Matrix or whatever IMDB suggests next!", "I recommend that you work along with the article. You can solve most binary classification problems using a similar strategy. If you did solve it, try fiddling the design and parameters of the network and its layers. This will help you better understand the integrity of the model architecture you chose.", "I discuss a single topic in additional detail in each of my articles. In this one, we delved a little bit into hidden layers. An exhaustive explanation of any particular topic is never in the scope of my article; however, you will find ample quick asides.", "I assume that the reader has a working understanding of technicalities like an optimizer, categorical encoding, loss function, and metrics. You can find my practice notes on these concepts here.", "For more, please check out the book Deep Learning with Python by Francois Chollet.", "Feel free to check out this article\u2019s implementation and more of my work on GitHub.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F648342bc70dd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----648342bc70dd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----648342bc70dd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rakshitr.medium.com/?source=post_page-----648342bc70dd--------------------------------", "anchor_text": ""}, {"url": "https://rakshitr.medium.com/?source=post_page-----648342bc70dd--------------------------------", "anchor_text": "Rakshit Raj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4fcac7ae4c77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&user=Rakshit+Raj&userId=4fcac7ae4c77&source=post_page-4fcac7ae4c77----648342bc70dd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F648342bc70dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F648342bc70dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/solve-the-mnist-image-classification-problem-9a2865bcf52a", "anchor_text": "Solve the MNIST Image Classification ProblemThe \u2018hello world!\u2019 of Deep Learning and Keras in under 10 minutestowardsdatascience.com"}, {"url": "https://deepai.org/machine-learning-glossary-and-terms/hidden-layer-machine-learning#:~:text=Hidden%20layers%2C%20simply%20put%2C%20are,specific%20to%20an%20intended%20result.&text=Hidden%20layers%20allow%20for%20the,to%20produce%20a%20defined%20output.", "anchor_text": "DeepAI.org"}, {"url": "https://github.com/Prodicode/ann-visualizer", "anchor_text": "Prodicode/ann-visualizerA great visualization python library used to work with Keras. It uses python\u2019s Graphviz library to create a presentable\u2026github.com"}, {"url": "https://github.com/rakshitraj/kaggle/", "anchor_text": "here"}, {"url": "https://www.manning.com/books/deep-learning-with-python", "anchor_text": "Deep Learning with Python by Francois Chollet"}, {"url": "https://github.com/rakshitraj/fchollet", "anchor_text": "implementation"}, {"url": "https://github.com/rakshitraj/", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----648342bc70dd---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----648342bc70dd---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----648342bc70dd---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/python?source=post_page-----648342bc70dd---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/classification?source=post_page-----648342bc70dd---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F648342bc70dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&user=Rakshit+Raj&userId=4fcac7ae4c77&source=-----648342bc70dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F648342bc70dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&user=Rakshit+Raj&userId=4fcac7ae4c77&source=-----648342bc70dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F648342bc70dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----648342bc70dd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F648342bc70dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----648342bc70dd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----648342bc70dd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----648342bc70dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----648342bc70dd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----648342bc70dd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----648342bc70dd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----648342bc70dd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----648342bc70dd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----648342bc70dd--------------------------------", "anchor_text": ""}, {"url": "https://rakshitr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rakshitr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rakshit Raj"}, {"url": "https://rakshitr.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://www.rakshitraj.com/", "anchor_text": "https://www.rakshitraj.com/"}, {"url": "https://www.linkedin.com/in/rakshitraj/", "anchor_text": "https://www.linkedin.com/in/rakshitraj/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4fcac7ae4c77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&user=Rakshit+Raj&userId=4fcac7ae4c77&source=post_page-4fcac7ae4c77--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdcb5db85dd6f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbinary-classification-of-imdb-movie-reviews-648342bc70dd&newsletterV3=4fcac7ae4c77&newsletterV3Id=dcb5db85dd6f&user=Rakshit+Raj&userId=4fcac7ae4c77&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}