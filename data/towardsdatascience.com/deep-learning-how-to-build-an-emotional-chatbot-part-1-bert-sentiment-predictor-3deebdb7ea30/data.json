{"url": "https://towardsdatascience.com/deep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30", "time": 1683013779.983776, "path": "towardsdatascience.com/deep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30/", "webpage": {"metadata": {"title": "[Deep learning] How to build an emotional chatbot | by Jay Hui | Towards Data Science", "h1": "[Deep learning] How to build an emotional chatbot", "description": "As the dialogue system is mature nowadays, we can download and apply advanced trained chatbots, such as GPT-3, DialoGPT, Plato and OpenNMT, etc. However, building a chatbot with generating emotional\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.theguardian.com/commentisfree/2020/sep/08/robot-wrote-this-article-gpt-3", "anchor_text": "The Guardian: A Robot Wrote This Entire Article. Are You Scared Yet, Human?", "paragraph_index": 0}, {"url": "https://github.com/openai/gpt-3", "anchor_text": "GPT-3", "paragraph_index": 1}, {"url": "https://github.com/microsoft/DialoGPT", "anchor_text": "DialoGPT", "paragraph_index": 1}, {"url": "https://github.com/uber-research/plato-research-dialogue-system", "anchor_text": "Plato", "paragraph_index": 1}, {"url": "https://opennmt.net/", "anchor_text": "OpenNMT", "paragraph_index": 1}, {"url": "https://arxiv.org/pdf/1906.08487.pdf", "anchor_text": "HappyBot: Generating Empathetic Dialogue Responses by Improving User Experience Look-ahead", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1810.04805.pdf", "anchor_text": "BERT", "paragraph_index": 8}, {"url": "https://medium.com/@aniruddha.choudhury94/part-2-bert-fine-tuning-tutorial-with-pytorch-for-text-classification-on-the-corpus-of-linguistic-18057ce330e1", "anchor_text": "Part 2: BERT Fine-Tuning Tutorial with PyTorch for Text Classification on The Corpus of Linguistic Acceptability (COLA) Dataset.", "paragraph_index": 9}, {"url": "https://www.kaggle.com/atulanandjha/stanford-sentiment-treebank-v2-sst2", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://huggingface.co/transformers/main_classes/tokenizer.html", "anchor_text": "transformer", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/what-is-gradient-clipping-b8e815cdfb48", "anchor_text": "gradient clipping", "paragraph_index": 12}], "all_paragraphs": ["The Guardian: A Robot Wrote This Entire Article. Are You Scared Yet, Human?", "As the dialogue system is mature nowadays, we can download and apply advanced trained chatbots, such as GPT-3, DialoGPT, Plato and OpenNMT, etc. However, building a chatbot with generating emotional and positive responses, unlike the traditional one, is still a hot research area. (Similar to the AI mentioned in the news, we hope the AI says something positive (e.g., My creator told me to say \u2018I come in peace\u2019))", "Also, an emotional chatbot is very desirable in business, such as improving customer service.", "In these two articles, I will introduce how to build an emotional chatbot (deep neural network-based dialogue system) based on the paper \u201c HappyBot: Generating Empathetic Dialogue Responses by Improving User Experience Look-ahead\u201d from HKUST and my trial.", "The idea is to build a dialogue system combining reinforcement learning, which rewards the positive generated responses and penalizes the negative one.", "Technically speaking, this task involves building a deep learning model, transfer learning (BERT), sentiment analysis, reinforcement learning, and their implementations (in PyTorch), which are all the hot topics in machine learning.", "In part 1, we will build a sentiment predictor in a modern way (using transfer learning from a pre-trained BERT model).", "Recall our objective is: Build a dialogue system combining reinforcement learning, which rewards the positive generated responses and penalizes the negative one. Some we need a \u201cjudge\u201d to decide a sentiment score of each generated sentence. (Sentiment analysis)", "BERT is currently one of the significant models in NLP tasks published in 2018 by Google. The key idea of BERT is to build the representation for natural language by using a bidirectional deep neural network with the Transformer architecture. The BERT model is frequently applied as a pre-trained model for other NLP tasks.", "To build a BERT Sentiment predictor (by PyTorch), one can follow the article here: Part 2: BERT Fine-Tuning Tutorial with PyTorch for Text Classification on The Corpus of Linguistic Acceptability (COLA) Dataset.", "We use the Stanford Sentiment Treebank v2 (SST2) dataset for our task, which can be downloaded here. The SST2 dataset provides 239,232 sentences, where each sentence contains at most 6 sentiment labels from 1 to 25 (from most negative to most positive). We calculated the mean sentiment score for each sentence and grouped them as \u2019negative\u2019 (for the score \u226410), \u2019neutral\u2019 (for the 10 < score \u2264 16), and \u2019positive\u2019 (for the score >16). The final Train/Val/Test data was split as 50/25/25 percent.", "Every sentence will be tokenized, and the sentences with length larger than 160 words will be pruned. We use the prepared tokenizer from the package transformer.", "Then we build a multi-class (positive, neutral, and negative) classification model (softmax function) with loss function as cross-entropy from a pre-trained BERT model. Noted that we adopt the gradient clipping for avoiding gradient explosion. Here is the result of the train/valid data:", "The model training indicates that one epoch is already adequate, while more epochs only improve the training accuracy, but valid accuracy remains the same.", "After the model training, we apply our model on the testing data with 75.2% accuracy (similar to our model training) :", "Since our prediction is a probability of getting \u201cpositive,\u201d \u201cnatural,\u201d and \u201cnegative\u201d labels, we need to transform it into a 0\u20131 sentiment scores as the reward:", "Where outputting 1 = highly positive and 0 = highly negative)", "This result will be applied in the Emotional Dialogue system in the next part.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3deebdb7ea30&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jay-hui.medium.com/?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": ""}, {"url": "https://jay-hui.medium.com/?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": "Jay Hui"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102abb901d98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&user=Jay+Hui&userId=102abb901d98&source=post_page-102abb901d98----3deebdb7ea30---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3deebdb7ea30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3deebdb7ea30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://www.theguardian.com/commentisfree/2020/sep/08/robot-wrote-this-article-gpt-3", "anchor_text": "The Guardian: A Robot Wrote This Entire Article. Are You Scared Yet, Human?"}, {"url": "https://github.com/openai/gpt-3", "anchor_text": "GPT-3"}, {"url": "https://github.com/microsoft/DialoGPT", "anchor_text": "DialoGPT"}, {"url": "https://github.com/uber-research/plato-research-dialogue-system", "anchor_text": "Plato"}, {"url": "https://opennmt.net/", "anchor_text": "OpenNMT"}, {"url": "https://arxiv.org/pdf/1906.08487.pdf", "anchor_text": "HappyBot: Generating Empathetic Dialogue Responses by Improving User Experience Look-ahead"}, {"url": "https://arxiv.org/pdf/1810.04805.pdf", "anchor_text": "BERT"}, {"url": "https://medium.com/@aniruddha.choudhury94/part-2-bert-fine-tuning-tutorial-with-pytorch-for-text-classification-on-the-corpus-of-linguistic-18057ce330e1", "anchor_text": "Part 2: BERT Fine-Tuning Tutorial with PyTorch for Text Classification on The Corpus of Linguistic Acceptability (COLA) Dataset."}, {"url": "https://www.kaggle.com/atulanandjha/stanford-sentiment-treebank-v2-sst2", "anchor_text": "here"}, {"url": "https://huggingface.co/transformers/main_classes/tokenizer.html", "anchor_text": "transformer"}, {"url": "https://towardsdatascience.com/what-is-gradient-clipping-b8e815cdfb48", "anchor_text": "gradient clipping"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----3deebdb7ea30---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----3deebdb7ea30---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----3deebdb7ea30---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/bert?source=post_page-----3deebdb7ea30---------------bert-----------------", "anchor_text": "Bert"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----3deebdb7ea30---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3deebdb7ea30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&user=Jay+Hui&userId=102abb901d98&source=-----3deebdb7ea30---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3deebdb7ea30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&user=Jay+Hui&userId=102abb901d98&source=-----3deebdb7ea30---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3deebdb7ea30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3deebdb7ea30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3deebdb7ea30---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3deebdb7ea30--------------------------------", "anchor_text": ""}, {"url": "https://jay-hui.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jay-hui.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jay Hui"}, {"url": "https://jay-hui.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "137 Followers"}, {"url": "https://www.linkedin.com/in/jay-hui-187222120/", "anchor_text": "https://www.linkedin.com/in/jay-hui-187222120/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102abb901d98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&user=Jay+Hui&userId=102abb901d98&source=post_page-102abb901d98--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdfb93693b5df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-how-to-build-an-emotional-chatbot-part-1-bert-sentiment-predictor-3deebdb7ea30&newsletterV3=102abb901d98&newsletterV3Id=dfb93693b5df&user=Jay+Hui&userId=102abb901d98&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}