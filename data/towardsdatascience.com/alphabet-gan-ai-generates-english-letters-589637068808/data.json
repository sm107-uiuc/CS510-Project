{"url": "https://towardsdatascience.com/alphabet-gan-ai-generates-english-letters-589637068808", "time": 1683010780.644518, "path": "towardsdatascience.com/alphabet-gan-ai-generates-english-letters-589637068808/", "webpage": {"metadata": {"title": "Alphabet GAN: AI Generates English Alphabet! | by Sujan Dutta | Towards Data Science", "h1": "Alphabet GAN: AI Generates English Alphabet!", "description": "First, you need to know what a GAN really is. Well here\u2019s a brief description. Generative Adversarial Network is a combination of two models namely Generator and Discriminator. The Generator tries to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/sachinpatel21/az-handwritten-alphabets-in-csv-format", "anchor_text": "A-Z dataset", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Batch_normalization", "anchor_text": "BatchNormalization", "paragraph_index": 6}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "original GAN paper", "paragraph_index": 18}, {"url": "https://arxiv.org/pdf/1906.02629.pdf", "anchor_text": "level smoothing", "paragraph_index": 23}, {"url": "https://github.com/Suji04/NormalizedNerd/blob/master/Alphabet%20GAN/english-alphabet-gan.ipynb", "anchor_text": "full code", "paragraph_index": 29}], "all_paragraphs": ["First, you need to know what a GAN really is. Well here\u2019s a brief description. Generative Adversarial Network is a combination of two models namely Generator and Discriminator. The Generator tries to produce fake data mimicking the original data. On the other hand, the Discriminator tries to tell if a given data is original or fake. Thanks to the adversarial setup, eventually, both models keep getting better at their tasks. Of course, there\u2019s much more to understand about GANs. Please watch this video if you are curious\u2026", "In this article, I want to show you how to implement one such GAN. I\u2019ll also mention a whole bunch of tips that will help you in training your first GAN. But, before jumping into the model let\u2019s understand the dataset.", "Here, I\u2019m using an MNIST style dataset of handwritten English alphabets. A-Z dataset contains 372,450 characters from 26 classes. Each data sample is a greyscale image of an alphabet. Like the MNIST dataset, the dimension of each image is 28px*28px and represented as a 784 (28*28) dimensional vector. Let\u2019s visualize a few of them\u2026", "Originally, the pixel values range between [0, 255] but we should normalize them before feeding to any machine learning model. Generally, we normalize the pixels between [0, 1] by dividing 255.0 but here we normalize them between [-1, 1]. This is because we will use the tanh (range of tanh = [-1, 1]) function later.", "Now let\u2019s build our GAN. I like to do it in 4 steps.", "The generator is a neural network that takes a noise vector (100-dimensional) as input and outputs an image of a single English alphabet. As we are working with image data, it makes sense to use a Convolutional Neural Network. The idea is to increase the spatial dimensions of the input as it passes through different layers until it reaches the desired output shape (28px*28px). The first two layers of the network are Dense layers with ReLu activation. I\u2019d highly recommend using BatchNormalization on the output of each layer.", "Note: BatchNormalization makes the training converge faster. A lot faster.", "Notice that the first Dense layer contains 1024 neurons and the second one contains 6272 neurons. After that comes the Reshape layer. The reshaping is important because we want to use convolution afterward and to apply convolution we need matrix-like entities rather than column/row vectors.", "Note: To find the correct dimensions we need to think backward! First, determine the dimensions of the matrices (7*7) and how many (128) of them you want then multiply them to get the dimension (7*7*128 = 6272) of the Dense layer.", "Before applying convolution we will upsample the matrices. I\u2019ve used (2, 2) upsampling that will increase the dimension from 7*7 to 14*14.", "UpSampling is a kind of inverse function of Pooling.", "After that, we have 2*2 convolution filters (64). Notice that I have initialized the weights of the kernels according to a Normal distribution. The activation for this layer is LeakyReLu. Then again we have an upsampling layer followed by a convolution layer. This time the UpSampling layer will output 28*28 dimensional matrices. The last convolution layer contains only 1 filter because we want only one channel for our grayscale image. The activation function here is tanh. This is the reason why we normalized the pixel values between [-1, 1].", "Note: We could have avoided UpSampling layers by using transposed convolutions. Because they can also increase the matrix dimensions.", "Did you notice that I didn\u2019t compile the generator here? This will be done in the 3rd step.", "Our discriminator is just a binary classifier that takes a grayscale image as input and predicts if it\u2019s an original image or a fake one i.e. created by the generator. The first two layers are convolution layers. Notice that I\u2019ve used a stride of 2 which means the output dimension will be less than the input. So, we don\u2019t need Pooling layers. The filter size is 5*5 for both of the layers but the number of filters is greater in the second layer.", "Note: While building the discriminator you should keep in mind that our aim is to favor the generator because we want to generate fake images. Hence, make the discriminator a bit weaker than the generator. For example, here I\u2019ve used fewer convolution layers in the discriminator.", "After the convolution layers, we need to Flatten the output so that we can pass it to a Dense layer. The size of the Dense layer is 256 with a 50% dropout. At last, we have the sigmoid layer just like any other binary classifier. We have to compile the discriminator now. The loss should be binary cross-entropy and I\u2019ve used a custom Adam optimizer (learning rate= 0.0002).", "Note: Default Adam learning rate (0.001) is too high for GANs so always customize the Adam optimizer.", "According to the original GAN paper, we have to train the generator and the discriminator separately. Then why this step?", "The discriminator can be trained directly by back-propagating the loss computed at the last sigmoid layer. But for training the generator, we need to send this loss back to the generator without affecting the weights of the discriminator!", "One way to achieve this is by creating a new model by stacking the generator and discriminator. And this is why I didn\u2019t compile the generator before. Let\u2019s call the new model gan. It takes the noise vector as input then passes it through the generator to create a fake image. Then the image is passed through the discriminator that computes the probability of it being an original image. When we would train this gan, the discriminator should not learn anything. Hence, \u2018discriminator.trainable = False\u2019. Only the weights of the generator will be modified.", "Finally, we are ready to train our GAN! Does the code look weird to you? Don\u2019t worry, I\u2019m gonna explain each step.", "First, the batch_size number of noise vectors are formed by drawing numbers randomly from a standard normal distribution. Then these vectors are given to the generator to create fake images. Now we draw the batch_size number of real images from training data. To get the input to the discriminator we need to concatenate the fake and the real data. Accordingly, we need to mention the label vector (0: fake data, 1: real data). But wait, the code says 0.1 and 0.9 instead! WTH is going on?", "This technique is called level smoothing. It prevents the discriminator from being overconfident about its prediction.", "Then we call the train_on_batch function for the discriminator and pass the data-label pairs.", "Here, we need only the noise vectors and labels. The label vector contains 1's. Wait, the generator makes fake data so shouldn\u2019t the labels be 0?", "Yes. But here we are deliberately giving wrong labels so that the discriminator makes mistakes. The reason being we want the generator to outperform the discriminator. By doing this G will know how D behaves when it is given real labels and it (G) will change its weights accordingly to fool D. Remember that at this stage, we are not changing the weights of the discriminator so the discriminator is not \u2018unlearning\u2019 anything.", "Now we call the train_on_batch function for the generator and pass the data-label pairs. And that\u2019s friends, how a GAN is trained!", "Let me show you some of the best (hand-picked) results that my model has produced\u2026", "Here\u2019s the full code of this project. Voil\u00e0! Now you know how to train a GAN!", "I hope you enjoyed the reading. Until next time\u2026Happy learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student | Ex-AI/ML intern at Apple | Normalized Nerd (58k+ subscribers)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F589637068808&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----589637068808--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----589637068808--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sujan99dutta?source=post_page-----589637068808--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sujan99dutta?source=post_page-----589637068808--------------------------------", "anchor_text": "Sujan Dutta"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F74827b0a297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&user=Sujan+Dutta&userId=74827b0a297&source=post_page-74827b0a297----589637068808---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F589637068808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F589637068808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/sachinpatel21/az-handwritten-alphabets-in-csv-format", "anchor_text": "A-Z dataset"}, {"url": "https://en.wikipedia.org/wiki/Batch_normalization", "anchor_text": "BatchNormalization"}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "original GAN paper"}, {"url": "https://arxiv.org/pdf/1906.02629.pdf", "anchor_text": "level smoothing"}, {"url": "https://github.com/Suji04/NormalizedNerd/blob/master/Alphabet%20GAN/english-alphabet-gan.ipynb", "anchor_text": "full code"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----589637068808---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----589637068808---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----589637068808---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----589637068808---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/programming?source=post_page-----589637068808---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F589637068808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&user=Sujan+Dutta&userId=74827b0a297&source=-----589637068808---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F589637068808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&user=Sujan+Dutta&userId=74827b0a297&source=-----589637068808---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F589637068808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----589637068808--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F589637068808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----589637068808---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----589637068808--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----589637068808--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----589637068808--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----589637068808--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----589637068808--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----589637068808--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----589637068808--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----589637068808--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sujan99dutta?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sujan99dutta?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sujan Dutta"}, {"url": "https://medium.com/@sujan99dutta/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "133 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F74827b0a297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&user=Sujan+Dutta&userId=74827b0a297&source=post_page-74827b0a297--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1ba0f1a8337e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falphabet-gan-ai-generates-english-letters-589637068808&newsletterV3=74827b0a297&newsletterV3Id=1ba0f1a8337e&user=Sujan+Dutta&userId=74827b0a297&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}