{"url": "https://towardsdatascience.com/run-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819", "time": 1683009343.878221, "path": "towardsdatascience.com/run-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819/", "webpage": {"metadata": {"title": "How to run your ML model Predictions 50 times faster? | by Rahul Agarwal | Towards Data Science", "h1": "How to run your ML model Predictions 50 times faster?", "description": "You can now convert your models written in Scikit-learn or Xgboost or LightGBM into PyTorch models and gain the performance benefits of Pytorch while inferencing."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/take-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c", "anchor_text": "production", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/moving-from-keras-to-pytorch-f0d4fff4ce79", "anchor_text": "PyTorch", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/top-10-resources-to-become-a-data-scientist-in-2020-99a315194701", "anchor_text": "Data Scientist", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/faster-and-memory-efficient-pytorch-models-using-amp-50fd3c8dd7fe", "anchor_text": "performance", "paragraph_index": 2}, {"url": "https://github.com/microsoft/hummingbird", "anchor_text": "Hummingbird", "paragraph_index": 3}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/lightning-fast-xgboost-on-multiple-gpus-32710815c7c3", "anchor_text": "Xgboost", "paragraph_index": 9}, {"url": "https://github.com/microsoft/hummingbird/wiki/Supported-Operators", "anchor_text": "operators", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/the-5-classification-evaluation-metrics-you-must-know-aa97784ff226", "anchor_text": "classification", "paragraph_index": 12}, {"url": "https://github.com/microsoft/hummingbird/wiki/Roadmap-for-Upcoming-Features-and-Support", "anchor_text": "roadmap", "paragraph_index": 25}, {"url": "https://github.com/MLWhiz/data_science_blogs/tree/master/hummingbird", "anchor_text": "GitHub", "paragraph_index": 27}, {"url": "https://coursera.pxf.io/e45BJ6", "anchor_text": "course on AWS", "paragraph_index": 28}, {"url": "https://medium.com/@rahul_agarwal?source=post_page---------------------------", "anchor_text": "Medium", "paragraph_index": 29}, {"url": "http://eepurl.com/dbQnuX?source=post_page---------------------------", "anchor_text": "blog", "paragraph_index": 29}, {"url": "https://twitter.com/MLWhiz?source=post_page---------------------------", "anchor_text": "@mlwhiz", "paragraph_index": 29}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 32}], "all_paragraphs": ["With the advent of so many computing and serving frameworks, it is getting stressful day by day for the developers to put a model into production. If the question of what model performs best on my data was not enough, now the question is what framework to choose for serving a model trained with Sklearn or LightGBM or PyTorch. And new frameworks are being added as each day passes.", "So is it imperative for a Data Scientist to learn a different framework because a Data Engineer is comfortable with that, or conversely, does a Data Engineer need to learn a new platform that the Data Scientist favors?", "Add to that the factor of speed and performance that these various frameworks offer, and the question suddenly becomes even more complicated.", "So, I was pleasantly surprised when I came across the Hummingbird project on Github recently, which aims to answer this question or at least takes a positive step in the right direction.", "Hummingbird is a library for compiling trained traditional ML models into tensor computations. Hummingbird allows users to seamlessly leverage neural network frameworks (such as PyTorch) to accelerate traditional ML models.", "Thanks to Hummingbird, users can benefit from:", "(1) all the current and future optimizations implemented in neural network frameworks;", "(3) having a unique platform to support both traditional and neural network models, and have all of this", "(4) without having to re-engineer their models.", "Put even more simply; you can now convert your models written in Scikit-learn or Xgboost or LightGBM into PyTorch models and gain the performance benefits of Pytorch while inferencing.", "As of right now, Here is the list of operators Hummingbird supports with more on the way.", "We can start by installing Hummingbird, which is as simple as:", "To use hummingbird, I will begin with a minimal example on a small random classification Dataset. We start by creating a sample dataset with 100,000 rows and using a RandomForestClassifier on top of that.", "What hummingbird helps us with is to convert this sklearn model into a PyTorch model by just using the simple command:", "We can now load our new Pytorch model to GPU using:", "This is great. So, we can convert from sklearn model to a PyTorch model, which should run faster on a GPU. But by how much?", "Let us see a simple performance comparison.", "We will start by using the sklearn model to predict the whole train dataset and check out the time it takes.", "We can do the same with our new PyTorch model:", "We predict a single example here to see how the model would perform in a real-time setting. The sklearn model:", "A small caveat I experienced is that the predictions from the sklearn model and the hummingbird PyTorch model were not exactly the same.", "For example, here are the predictions I got from both models:", "Yes, sometimes, they differ in the 7th digit, which might be a function of the conversion process. I think that it won\u2019t change the final 1 or 0 predictions much. We can also check that:", "So, for this case, both the models exactly gave the same 1 or 0 predictions for the whole dataset of 100,000 rows.", "So I guess it is okay.", "The developers at Microsoft are still working on adding many more operators which range from models to feature engineering like MinMaxScaler or LabelEncoder to the code, and I am hopeful that they will further develop and improve this project. Here is the roadmap to development if you are interested.", "Although Hummingbird is not perfect yet, it is the first system able to run classical ML inference DNN frameworks and proves them mature enough to be used as generic compilers. I will try to include it in my development workflow when it comes to making predictions at high throughput or latency.", "You can find the code for this post as well as all my posts at my GitHub repository.", "If you want to learn more about building and putting a Machine Learning model in production, this course on AWS for implementing Machine Learning applications promises just that.", "Thanks for the read. I am going to be writing more beginner-friendly posts in the future too. Follow me up at Medium or Subscribe to my blog to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter @mlwhiz", "Also, a small disclaimer \u2014 There might be some affiliate links in this post to relevant resources, as sharing knowledge is never a bad idea.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3ad2f4ee5819&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----3ad2f4ee5819---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3ad2f4ee5819&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3ad2f4ee5819&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/KELLEPICS-4893063/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=3388999", "anchor_text": "Stefan Keller"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=3388999", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/take-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c", "anchor_text": "production"}, {"url": "https://towardsdatascience.com/moving-from-keras-to-pytorch-f0d4fff4ce79", "anchor_text": "PyTorch"}, {"url": "https://towardsdatascience.com/top-10-resources-to-become-a-data-scientist-in-2020-99a315194701", "anchor_text": "Data Scientist"}, {"url": "https://towardsdatascience.com/faster-and-memory-efficient-pytorch-models-using-amp-50fd3c8dd7fe", "anchor_text": "performance"}, {"url": "https://github.com/microsoft/hummingbird", "anchor_text": "Hummingbird"}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch"}, {"url": "https://towardsdatascience.com/lightning-fast-xgboost-on-multiple-gpus-32710815c7c3", "anchor_text": "Xgboost"}, {"url": "https://github.com/microsoft/hummingbird/wiki/Supported-Operators", "anchor_text": "operators"}, {"url": "https://towardsdatascience.com/the-5-classification-evaluation-metrics-you-must-know-aa97784ff226", "anchor_text": "classification"}, {"url": "https://github.com/microsoft/hummingbird/wiki/Roadmap-for-Upcoming-Features-and-Support", "anchor_text": "roadmap"}, {"url": "https://github.com/MLWhiz/data_science_blogs/tree/master/hummingbird", "anchor_text": "GitHub"}, {"url": "https://coursera.pxf.io/e45BJ6", "anchor_text": "course on AWS"}, {"url": "https://medium.com/@rahul_agarwal?source=post_page---------------------------", "anchor_text": "Medium"}, {"url": "http://eepurl.com/dbQnuX?source=post_page---------------------------", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz?source=post_page---------------------------", "anchor_text": "@mlwhiz"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3ad2f4ee5819---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----3ad2f4ee5819---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3ad2f4ee5819---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----3ad2f4ee5819---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3ad2f4ee5819---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3ad2f4ee5819&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----3ad2f4ee5819---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3ad2f4ee5819&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----3ad2f4ee5819---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3ad2f4ee5819&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3ad2f4ee5819&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3ad2f4ee5819---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3ad2f4ee5819--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frun-your-machine-learning-predictions-50-times-faster-3ad2f4ee5819&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}