{"url": "https://towardsdatascience.com/machine-learning-in-computational-fluid-dynamics-7018941414b9", "time": 1683005576.96435, "path": "towardsdatascience.com/machine-learning-in-computational-fluid-dynamics-7018941414b9/", "webpage": {"metadata": {"title": "Machine Learning in Computational Fluid Dynamics | by Ria Kulshrestha | Towards Data Science", "h1": "Machine Learning in Computational Fluid Dynamics", "description": "In summer'18 I had an amazing opportunity to intern in Geneva, Switzerland. The project involved replacing a complex calculation in the Lattice Boltzmann method with an ML model to improve the performance of the simulator."}, "outgoing_paragraph_urls": [{"url": "https://www.hesge.ch/hepia/", "anchor_text": "Haute \u00c9cole du Payasage, d\u2019Ing\u00e9nierie et D\u2019Architecture de Gen\u00e8ve", "paragraph_index": 0}, {"url": "https://palabos.unige.ch/", "anchor_text": "Palabos", "paragraph_index": 2}, {"url": "https://medium.com/@ria.kulshrestha16", "anchor_text": "here", "paragraph_index": 31}, {"url": "https://twitter.com/ree_____ree", "anchor_text": "Twitter", "paragraph_index": 32}], "all_paragraphs": ["In the summer of 2018 I had an amazing opportunity to intern in Geneva, Switzerland at Haute \u00c9cole du Payasage, d\u2019Ing\u00e9nierie et D\u2019Architecture de Gen\u00e8ve.", "I spent almost three months solving a problem using machine learning, in one of the most beautiful countries I have ever seen and met so many amazing people. What\u2019s not to love, right?", "As the title suggests, the project involved replacing a complex calculation in the Lattice Boltzmann method with a machine learning model to improve the performance of the simulator named Palabos \u2014 Parallel Lattice Boltzmann Solver.", "I\u2019ll be completely honest here; I was a little overwhelmed when I learnt about this project there. I don\u2019t have a background in Physics and was fairly new to machine learning. I didn\u2019t think I was qualified enough to work on something like this \u2014 impostor syndrome\u2019s availability must be 100%, never seems to miss a chance! Anyway, I decided to give it my best shot and see how far I can go because that\u2019s how we learn.", "Lattice Boltzmann Method (LBM) is a parallel algorithm in computational fluid dynamics (CFD) for simulating single-phase and multi-phase fluid flows. It is instrumental in modeling complicated boundary conditions and multi-phase interfaces.", "It models the fluid as fictive particles that perform consecutive collision and streaming steps over a discrete lattice mesh. The commonly used lattice denomination is the DnQm, which means that the lattice has n spatial dimensions and m discrete speeds. In each time step, particles at any node can move only to their nearest neighboring sites, with one of the discrete speeds. Once the particles have moved to one of their neighboring sites, they will collide with other particles that arrive on the same site at the same time.", "In Direct Numerical Simulation \u2014 a simulation in computational fluid dynamics \u2014 numerically solves the Navier\u2013Stokes equations without any turbulence model.", "Large-eddy Simulations (LES) is a mathematical model in computational fluid dynamics used for simulating turbulent flows. The size of the computational domain should be at least an order of magnitude higher than the scales characterizing the turbulence energy while at the same time the computational mesh should be fine enough to resolve the smallest dynamically significant length-scale for accurate simulation.", "If all the eddies \u2014 the grid should be finer than the smallest turbulent eddy, which is essentially a circular current of water \u2014 are resolved accurately, by directly solving the Navier-Stokes equation using a very fine mesh, it results in high computational costs. To overcome these computational costs, in LES only the large scale motions (large eddies) are computed directly, while the small scale (sub-grid scale (SGS)) motions are modeled.", "Concluding, LBM tells us that we can imagine a fluid as fictive particles in space and time, DNS tells us how to simulate the behavior of each particle \u2014 given the physical conditions of the system\u2014at each time step and LES makes it possible to do such things for turbulent flows when the range of scales vary a lot by approximating the sub-grid scale eddies.", "I spent around two weeks learning about the physics behind it, setting up my system (which had default language as French initially), getting the IDE \u2014 used one called Qt, going through the software code to understand what was happening at a higher level.", "To learn the model for sub-grid scale (SGS) motions in Large-eddy simulation using machine learning and integrate it with the existing simulator to replace the current sub-grid calculations.", "The best approach to solve a big, complex problem is to break it down into smaller, simpler problems. I did the same by breaking mine down into the following three problems:", "The training data had nine input attributes:1: density2\u20133: velocity4\u20136: stress7: vorticity8\u20139: density gradient", "The output had 3 attributes representing the residual stress tensor. It had approximately 1 million tuples.", "The aim of the architecture was to keep it as simple as possible without compromising the performance much. I decided to use the simplest form of a Neural Network, called a perceptron model. It consists of an input layer, an output layer and a hidden layer.", "A scaling layer was added before the input layer of the neural network model to normalize the training data before it was fed into the model.As predicting the output was a regression problem, an un-scaling layer was added after the output layer while predicting values for new unseen data.", "Next task was to find the dimensions of each layer in the model. The output layer had 3 nodes, each corresponding to an attribute of the output part of training data.", "I kept the number of input nodes as 9 and started playing with the number of hidden nodes to find the most optimal size of the hidden layer, tracking both the average square error and the time taken to while testing. I started with extreme cases keeping the number of hidden nodes as very low and very high \u2014 keeping the learning rate, the number of epochs and other variables as constant \u2014 then narrowed it down by following a approach very similar to binary search. Then I found the same for the mid-value, and then the mid-values of (low, mid) and (mid, high), whichever of these two had a lower error that became our new search space.", "Once the optimal number of hidden nodes was decided, I also played with the number of inputs for our model. Surprisingly, if I reduced the inputs to 6, the results didn\u2019t drop that drastically. So if a further reduction of model size was required, I had this option as well. Years later, I would learn that this is known as \u201cablation study\u201d, in which one removes features of a model and assess its impact on the output, and is a good practice to follow.", "All the above was done on a subset of the original training data to fasten the project.", "I spent roughly two weeks on this part, learning my way around the OpenNN library, coding the model and just playing around with the data set to get the above values.", "Once our model architecture was finalized, I found myself on a quest to find the best learning rate for the given architecture on a subset of the data set. Again, I followed a strategy very similar to a binary search \u2014 starting with the extremes and then narrowing it down from there. I used Quasi-Newton methods for weight optimization, which was available in the OpenNN library in C++.", "Once this was done, I took the learning corresponding to the three smallest errors found in the above exercise. Then for each learning rate, I trained the model on the entire data set. I repeated this five times and finally chose the learning rate, which gave the best performance average over those five runs.", "This was a slow process as each training would take about 0.5\u20130.75 of a day. I spent roughly three weeks on this.", "The first thing was to run the code without any IDE; I updated the paths to the required packages and linked the required libraries.", "Once that was done, the model was called instead of the function mocking the sub-grid scale eddies. We tried running the module for a few scenarios and comparing the performance with the results we got from the mocked eddies.", "I had a great time during this internship. I learnt a lot doing this project; things such as how to tackle a big problem, the methodology to develop an AI solution for a given problem, among other things.", "Takeaways: - Would I do things the same way if I had to do them again now? Most of it, yes. But I would have given more emphasis on testing and validation aspects of the project. If I had more time, I probably would have done it then as well, but yeah if I do it now, I would have made sure that I allocate some time during planning purely for this \u2014 both before and after the integration.- I realized I love using ML and applying it to new problems or improving existing solutions. So yeah I\u2019m now looking at ways where I get to do this \u2014 novel applications of AI/ML \u2014 more often!- Having a good mentor makes a ton of difference. I was the only person working on this project. But my mentor was really helpful. He would listen to what I had to say and then guide me. I had complete control on how I wanted to do this project, but at the same time I always had him guiding me. I think that is what made this experience so fulfilling and satisfying.", "I also met some very kind and amazing people who I am still friends with. Thank you summer\u201918 for this beautiful experience I\u2019ll never forget. \u2764", "I\u2018m glad you made it till the end of this article. \ud83c\udf89I hope your reading experience was as enriching as the one I had writing this.\ud83d\udc96", "Do check out my other articles here.", "If you want to reach out to me, my medium of choice would be Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7018941414b9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7018941414b9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7018941414b9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ria-kulshrestha.medium.com/?source=post_page-----7018941414b9--------------------------------", "anchor_text": ""}, {"url": "https://ria-kulshrestha.medium.com/?source=post_page-----7018941414b9--------------------------------", "anchor_text": "Ria Kulshrestha"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F406aa3cbd38e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&user=Ria+Kulshrestha&userId=406aa3cbd38e&source=post_page-406aa3cbd38e----7018941414b9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7018941414b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7018941414b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.hesge.ch/hepia/", "anchor_text": "Haute \u00c9cole du Payasage, d\u2019Ing\u00e9nierie et D\u2019Architecture de Gen\u00e8ve"}, {"url": "https://palabos.unige.ch/", "anchor_text": "Palabos"}, {"url": "https://people.ece.cornell.edu/land/courses/ece5760/DE1_SOC/HPS_peripherials/Lattice_Boltzmann_index.html", "anchor_text": "Source"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4095897/", "anchor_text": "For more in depth explanations of LES"}, {"url": "https://www.sciencedirect.com/science/article/pii/S1000936114002064", "anchor_text": "LES \u2014 another resource."}, {"url": "http://www.opennn.net/documentation/reference/", "anchor_text": "OpenNN library"}, {"url": "https://towardsdatascience.com/back-propagation-721bfcc94e34", "anchor_text": "Yes, you should listen to Andrej Karpathy, and understand Back propagation"}, {"url": "https://towardsdatascience.com/malware-detection-using-deep-learning-6c95dd235432", "anchor_text": "Malware Detection Using Deep Learning"}, {"url": "https://towardsdatascience.com/attaining-attention-in-deep-learning-a712f93bdb1e", "anchor_text": "Attaining Attention In Deep Learning"}, {"url": "https://medium.com/@ria.kulshrestha16", "anchor_text": "here"}, {"url": "https://twitter.com/ree_____ree", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7018941414b9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/cfd?source=post_page-----7018941414b9---------------cfd-----------------", "anchor_text": "Cfd"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----7018941414b9---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7018941414b9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/education?source=post_page-----7018941414b9---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7018941414b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&user=Ria+Kulshrestha&userId=406aa3cbd38e&source=-----7018941414b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7018941414b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&user=Ria+Kulshrestha&userId=406aa3cbd38e&source=-----7018941414b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7018941414b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7018941414b9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7018941414b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7018941414b9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7018941414b9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7018941414b9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7018941414b9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7018941414b9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7018941414b9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7018941414b9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7018941414b9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7018941414b9--------------------------------", "anchor_text": ""}, {"url": "https://ria-kulshrestha.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ria-kulshrestha.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ria Kulshrestha"}, {"url": "https://ria-kulshrestha.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "768 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F406aa3cbd38e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&user=Ria+Kulshrestha&userId=406aa3cbd38e&source=post_page-406aa3cbd38e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fccdcb0ec19a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-computational-fluid-dynamics-7018941414b9&newsletterV3=406aa3cbd38e&newsletterV3Id=ccdcb0ec19a4&user=Ria+Kulshrestha&userId=406aa3cbd38e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}