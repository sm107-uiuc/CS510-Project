{"url": "https://towardsdatascience.com/how-to-create-differentially-private-synthetic-data-ae1a04cff1b9", "time": 1683016920.3366241, "path": "towardsdatascience.com/how-to-create-differentially-private-synthetic-data-ae1a04cff1b9/", "webpage": {"metadata": {"title": "How To Create Differentially Private Synthetic Data | by Alexander Watson | Towards Data Science", "h1": "How To Create Differentially Private Synthetic Data", "description": "In this post, we\u2019ll train a synthetic data model on the popular Netflix Prize dataset, using a mathematical technique called differential privacy to protect the identities of anonymized users in the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "Netflix Prize dataset", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Differential_privacy", "anchor_text": "differential privacy", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Data_re-identification", "anchor_text": "re-identification attacks", "paragraph_index": 0}, {"url": "https://gretel.ai/blog/what-is-synthetic-data", "anchor_text": "synthetic data", "paragraph_index": 0}, {"url": "https://medium.com/gretel-ai/using-generative-differentially-private-models-to-build-privacy-enhancing-synthetic-datasets-c0633856184", "anchor_text": "differentially private synthetic data", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/2007.05089", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "Netflix Prize dataset", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Integer", "anchor_text": "integer", "paragraph_index": 2}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "gretel-synthetics", "paragraph_index": 5}, {"url": "https://github.com/tensorflow/privacy", "anchor_text": "TensorFlow-Privacy", "paragraph_index": 5}, {"url": "https://gretel.ai/", "anchor_text": "Gretel.ai", "paragraph_index": 14}, {"url": "https://twitter.com/gretel_ai", "anchor_text": "twitter", "paragraph_index": 14}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "Gretel-synthetics", "paragraph_index": 15}, {"url": "https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667", "anchor_text": "Colaboratory", "paragraph_index": 15}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "GitHub", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "https://en.wikipedia.org/wiki/Netflix_Prize", "paragraph_index": 16}, {"url": "https://arxiv.org/abs/cs/0610105", "anchor_text": "How To Break Anonymity of the Netflix Prize Dataset", "paragraph_index": 16}, {"url": "https://github.com/tensorflow/privacy/blob/master/tutorials/Classification_Privacy.ipynb", "anchor_text": "Classification Tutorial", "paragraph_index": 16}, {"url": "https://github.com/tensorflow/privacy/blob/master/tutorials/README.md", "anchor_text": "README", "paragraph_index": 16}, {"url": "https://arxiv.org/abs/2007.05089", "anchor_text": "The Trade-Offs of Private Prediction", "paragraph_index": 16}, {"url": "http://Gretel.ai", "anchor_text": "Gretel.ai", "paragraph_index": 18}], "all_paragraphs": ["In this post, we\u2019ll train a synthetic data model on the popular Netflix Prize dataset, using a mathematical technique called differential privacy to protect the identities of anonymized users in the dataset from being discovered via known privacy attacks such as re-identification attacks. With differentially private synthetic data, our goal is to create a neural network model that can generate new data in the identical format as the source data, with increased privacy guarantees while retaining the source data\u2019s statistical insights. Today, we will walk through a generalized approach to find optimal privacy parameters to train models with using differential privacy.", "To dive a level deeper on the topic of differential privacy, see our previous post on differentially private synthetic data, or an excellent overview of private learning methods here\u2075.", "According to Wikipedia\u00b9, \u201cthe Netflix Prize dataset consists of 100,480,507 ratings that 480,189 users gave to 17,770 movies. Each training rating is a quadruplet of the form <user, movie, grade, date-of-grade>. The user and movie fields are integer IDs, while grades are from 1 to 5 (integral) stars\u201d.", "Netflix originally published this dataset in 2007 as part of a contest with a $1 million USD prize for the team that could beat their movie recommendation algorithm. However, researchers from the University of Austin demonstrated how an adversary with only basic knowledge of a subscriber could identify their records, and even \u201cuncovering their apparent political preferences and other potentially sensitive information\u201d \u00b2.", "The goal of our synthetic model will be to create a new, artificial dataset of the same format as the Netflix Prize dataset and with the same statistical insights, but without memorizing or repeating any individual record. To keep training time manageable for lots of tests, we\u2019ll work with 100k rows at a time.", "In this example, we\u2019ll use the gretel-synthetics library to create the synthetic data model and artificial dataset. Gretel-synthetics uses TensorFlow-Privacy an open source library created by Google researchers to train machine learning models with differential privacy guarantees. Finding optimal parameters for differential privacy is often model specific, and in the remainder of this post we\u2019ll dive in on finding the optimal privacy parameters for our use case.", "For our first experiment, we train 200 models on the the first 100,000 records of Netflix data and bake off two popular optimizers supported by TensorFlow and Keras; \u2018RMSprop\u2019 and \u2018Adam\u2019. Our goal is to find out which optimizer can best minimize the number of records containing invalid structure or data generated by the model.", "In the results above, the size of the circles correspond to the number of epochs in training [1\u2013100]. As each epoch requires an additional pass over the data, higher epoch counts during training time have the effect of reducing privacy guarantees for the model. In our experiment, we can see that the tf.keras.optimizers.RMSprop optimizer with learning rates between 0.001 and 0.01 handily outperforms tf.keras.optimizers.Adam for this task.", "In our second test, we try different learning rates. The higher the learning rate, the more impact that individual training steps have on the model. According to TensorFlow Privacy\u2019s documentation\u00b3, \u201cif the updates are noisy (such as when the additive noise is large compared to the clipping threshold), the learning rate must be kept low for the training procedure to converge\u201d. For this example, we will try a variety of learning rates to find the right balance of learning rates versus model accuracy.", "In the test above, we can see that learning rates in the range of 0.000799 (slowest, most accurate with only 1% of records failing and averaging 99 epochs) to 0.050241 (fastest, averaging 19 epochs, least accurate) generated models that passed our success threshold with less than 30% of records generated failing validation. However, past a certain point (0.00006) in our tests, the model hits our test maximum of 100 epochs and never converges, resulting in a high number of failed records.", "The l2_norm_clip describes the cumulative gradient across all neural network parameters that will be clipped so that its L2 norm is at most the value of l2_norm_clip\u2074.", "On our test dataset, the lower l2 gradient clipping settings do not strongly affect our model accuracy, we\u2019ll go with the recommended TensorFlow defaults.", "This governs the amount of noise added during training. According to the TensorFlow privacy documentation\u2074, \u201cGenerally, more noise results in better privacy and lower utility. The noise_multiplier generally has to be at least 0.3 to obtain rigorous privacy guarantees, but smaller values may still be acceptable for practical purposes\u201d. The amount of noise that can be injected into a dataset is often dependent on the quantity of training data available, and the variation within that training data. With the Netflix prize dataset, you generally want at least 100k rows of training data to be able to use a high level of noise. Try experimenting with different data sets and noise multiplier values using the notebook below.", "We just ran several thousand experiments to optimize our differential privacy settings for our synthetic data model. Woohoo! Try generating a synthetic version of the Netflix challenge dataset yourself with our notebook, or switch out the CSV and try running on your own dataset.", "At Gretel.ai we are super excited about the possibility of using synthetic data to augment training sets to create ML and AI models that generalize better against unknown data and with reduced algorithmic biases. We\u2019d love to hear about your use cases- feel free to reach out to us for a more in-depth discussion in the comments, twitter, or hi@gretel.ai. Follow us to keep up on the latest trends with synthetic data!", "Interested in training on your own dataset? Gretel-synthetics is free and open source, and you can start experimenting in seconds via Colaboratory. If you like gretel-synthetics give us a \u2b50 on GitHub!", "\u00b9 Wikipedia, https://en.wikipedia.org/wiki/Netflix_Prize\u00b2 Arvind Narayanan, Vitaly Shmatikov, How To Break Anonymity of the Netflix Prize Dataset\u00b3 TensorFlow Privacy Classification Tutorial\u2074 TensorFlow Privacy README\u2075 Laurens van der Maaten, Awni Hannun, The Trade-Offs of Private Prediction", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-Founder at Gretel.ai, previously GM at AWS. Love artificial intelligence and security. @alexwatson405"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae1a04cff1b9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zredlined?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zredlined?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": "Alexander Watson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcacf157aade0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&user=Alexander+Watson&userId=cacf157aade0&source=post_page-cacf157aade0----ae1a04cff1b9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae1a04cff1b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae1a04cff1b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/data-privacy", "anchor_text": "Data Privacy"}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "Netflix Prize dataset"}, {"url": "https://en.wikipedia.org/wiki/Differential_privacy", "anchor_text": "differential privacy"}, {"url": "https://en.wikipedia.org/wiki/Data_re-identification", "anchor_text": "re-identification attacks"}, {"url": "https://gretel.ai/blog/what-is-synthetic-data", "anchor_text": "synthetic data"}, {"url": "https://medium.com/gretel-ai/using-generative-differentially-private-models-to-build-privacy-enhancing-synthetic-datasets-c0633856184", "anchor_text": "differentially private synthetic data"}, {"url": "https://arxiv.org/abs/2007.05089", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "Netflix Prize dataset"}, {"url": "https://en.wikipedia.org/wiki/Integer", "anchor_text": "integer"}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "gretel-synthetics"}, {"url": "https://github.com/tensorflow/privacy", "anchor_text": "TensorFlow-Privacy"}, {"url": "https://colab.research.google.com/gist/zredlined/2f296b4c8377a20ff8a83a1e79552eb8/dp-parameter-optimization-experiments.ipynb", "anchor_text": "here"}, {"url": "https://colab.research.google.com/github/gretelai/gretel-synthetics/blob/master/examples/tensorflow/diff_privacy.ipynb", "anchor_text": "Click here to create a synthetic dataset with differential privacy guarantees for free in Google Colaboratorycolab.research.google.com"}, {"url": "https://gretel.ai/", "anchor_text": "Gretel.ai"}, {"url": "https://twitter.com/gretel_ai", "anchor_text": "twitter"}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "Gretel-synthetics"}, {"url": "https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667", "anchor_text": "Colaboratory"}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "GitHub"}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "https://en.wikipedia.org/wiki/Netflix_Prize"}, {"url": "https://arxiv.org/abs/cs/0610105", "anchor_text": "How To Break Anonymity of the Netflix Prize Dataset"}, {"url": "https://github.com/tensorflow/privacy/blob/master/tutorials/Classification_Privacy.ipynb", "anchor_text": "Classification Tutorial"}, {"url": "https://github.com/tensorflow/privacy/blob/master/tutorials/README.md", "anchor_text": "README"}, {"url": "https://arxiv.org/abs/2007.05089", "anchor_text": "The Trade-Offs of Private Prediction"}, {"url": "https://medium.com/tag/synthetic-data?source=post_page-----ae1a04cff1b9---------------synthetic_data-----------------", "anchor_text": "Synthetic Data"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ae1a04cff1b9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/privacy?source=post_page-----ae1a04cff1b9---------------privacy-----------------", "anchor_text": "Privacy"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----ae1a04cff1b9---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/data-privacy?source=post_page-----ae1a04cff1b9---------------data_privacy-----------------", "anchor_text": "Data Privacy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae1a04cff1b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&user=Alexander+Watson&userId=cacf157aade0&source=-----ae1a04cff1b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae1a04cff1b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&user=Alexander+Watson&userId=cacf157aade0&source=-----ae1a04cff1b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae1a04cff1b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae1a04cff1b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae1a04cff1b9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae1a04cff1b9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zredlined?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zredlined?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexander Watson"}, {"url": "https://medium.com/@zredlined/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "216 Followers"}, {"url": "http://Gretel.ai", "anchor_text": "Gretel.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcacf157aade0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&user=Alexander+Watson&userId=cacf157aade0&source=post_page-cacf157aade0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5aeec3551ca4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-differentially-private-synthetic-data-ae1a04cff1b9&newsletterV3=cacf157aade0&newsletterV3Id=5aeec3551ca4&user=Alexander+Watson&userId=cacf157aade0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}