{"url": "https://towardsdatascience.com/visualizing-elmo-contextual-vectors-94168768fdaa", "time": 1682995798.078779, "path": "towardsdatascience.com/visualizing-elmo-contextual-vectors-94168768fdaa/", "webpage": {"metadata": {"title": "Visualizing ELMo Contextual Vectors | by Henry Chang | Towards Data Science", "h1": "Visualizing ELMo Contextual Vectors", "description": "There are difficulties in word embedding that deals with world senses. No matter how many senses a word has, word embedding method embeds all senses into a single vector representation. This can\u2026"}, "outgoing_paragraph_urls": [{"url": "http://bionlp-www.utu.fi/wv_demo/", "anchor_text": "word embedding demo", "paragraph_index": 1}, {"url": "https://arxiv.org/pdf/1802.05365.pdf", "anchor_text": "ELMo", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1810.04805.pdf", "anchor_text": "BERT", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1802.05365.pdf", "anchor_text": "ELMo", "paragraph_index": 4}, {"url": "https://github.com/hengluchang/visualizing_contextual_vectors", "anchor_text": "github repository", "paragraph_index": 19}], "all_paragraphs": ["There are difficulties in word embedding that deals with world senses. No matter how many senses a word has, word embedding method embeds all senses into a single vector representation. This can cause a problem for downstream NLP tasks like document classification.", "For example, the word bank can refer to a financial institution or a slope land besides water. According to word embedding demo, using a trained model on Google News, the top 5 nearest words of bank in vector space are banks, banking, Bank, lender and banker. We can see that the semantic of bank here means financial institution and does not capture the meaning of a slope land besides water. Therefore, the text \u201cSandy walks along the river bank\u201d would be misclassified to \u201cFinancial institution\u201d class in document classification because the word vector of bank points to the meaning of a financial institution.", "The contextual vector of a word, on the other hand, can capture different senses of a word. As the name suggests, vector representation of a contextual word vector depends on its neighbor words in the sentence. So the word bank in \u201cI withdraw money in the bank\u201d, and \u201cShe had a nice walk along the river bank\u201d will have very different word vectors.", "Based on recent research, adding contextual vectors into various NLP tasks such as textual entailment, named entity extraction, and question answering, has shown to massively improve the state-of-the-art results. These contextual vectors are the output of pre-trained language models. Details on pre-trained language model can be found in the paper ELMo or BERT. Below I will use the ELMo model to generate contextual vectors.", "Let\u2019s try using the ELMo model to generate contextual vectors and using PCA to project the vectors to a 2D space for visualization. In the ELMo paper, there are 3 layers of word embedding, layer zero is the character-based context independent layer, followed by two Bi-LSTM layers. The authors have empirically shown that the word vectors generated from the first Bi-LSTM layer can better capture the syntax, and the second layer can capture the semantics better. We will visualize both layer 1 and layer 2 contextual vectors for three words that have multiple senses\u2014 bank, work, and plant.", "First, let\u2019s revisit the word bank. I\u2019ve picked 5 sentences that contain the word bank, and bank can be in either one of the two senses, a financial institution or a slope land besides water. Here are the 5 sentences:", "Below are the projection results using PCA. Each color point represents the word vector of bank in its context:", "We can cluster the above contextual vectors into 2 groups. The word vectors of bank in the upper right cluster mean a slope land besides water, while the bottom left cluster has the meaning of a financial institution.", "Similarly, we can see there are 2 clusters in the layer 2 ELMo vector space.", "By using contextual vectors, bank has different word vectors depending on different contexts, and the words with the same sense will be close to each other in vector space!", "Work is another word that has multiple senses. Work as a noun means something done or made, and as a verb means to work. Here are the 5 sentences that contain either one of the two senses mentioned above:", "Below are the projection results using PCA. Each color point represents the word vector of work in its context:", "Looking at layer 1 vectors, we can not immediately tell one cluster apart from the other. However, we know that the left three vectors have work as a verb, which means to work, and the right 2 vectors have work as a noun meaning something done or made.", "For layer 2 vectors, we observe clear clustering of work as a verb in the lower right corner and the another cluster of work as a noun in the upper left corner.", "Plant can mean \u201ca living organism\u201d or \u201cplace a seed in the ground.\u201d Here are the 5 sentences that contain either one of the two senses mentioned above:", "Below are the projection results using PCA, each color point represents the word vector of plant in its context:", "The upper right cluster are the vectors which has the meaning of placing a seed on the ground for plant. For the lower left cluster, the word plant means a living organism.", "Similar results can be found in this figure. The upper left 3 vectors form a cluster of having plant of the meaning \u201cplace a seed in the ground\u201d, and the lower right 2 vectors form a cluster of having the word plant mean living organism.", "An interesting point is that in all 3 experiment above, the cluster formations seem to be more clear and the distance between cluster centroid is larger in the layer 2 ELMo vector space compared to layer 1. The ELMo paper mentions that using the second layer in the Word Sense Disambiguation task results in a higher F1 score than using the first layer. Our observation of the greater distance in the layer 2 vector space shows a possible explanation for the paper\u2019s finding.", "The code for generating the above figures can be found in this github repository.", "By visualizing the contextual vectors of words with multiple senses, we empirically showed that:", "Any suggestions or comments for this post are more than welcome!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer. Read, code and write."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F94168768fdaa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----94168768fdaa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----94168768fdaa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hengluchang.medium.com/?source=post_page-----94168768fdaa--------------------------------", "anchor_text": ""}, {"url": "https://hengluchang.medium.com/?source=post_page-----94168768fdaa--------------------------------", "anchor_text": "Henry Chang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F55e0a0a36864&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&user=Henry+Chang&userId=55e0a0a36864&source=post_page-55e0a0a36864----94168768fdaa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94168768fdaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94168768fdaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://bionlp-www.utu.fi/wv_demo/", "anchor_text": "word embedding demo"}, {"url": "https://arxiv.org/pdf/1802.05365.pdf", "anchor_text": "ELMo"}, {"url": "https://arxiv.org/pdf/1810.04805.pdf", "anchor_text": "BERT"}, {"url": "https://arxiv.org/pdf/1802.05365.pdf", "anchor_text": "ELMo"}, {"url": "https://github.com/hengluchang/visualizing_contextual_vectors", "anchor_text": "github repository"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----94168768fdaa---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----94168768fdaa---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----94168768fdaa---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/elmo?source=post_page-----94168768fdaa---------------elmo-----------------", "anchor_text": "Elmo"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----94168768fdaa---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F94168768fdaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&user=Henry+Chang&userId=55e0a0a36864&source=-----94168768fdaa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F94168768fdaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&user=Henry+Chang&userId=55e0a0a36864&source=-----94168768fdaa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94168768fdaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----94168768fdaa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F94168768fdaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----94168768fdaa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----94168768fdaa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----94168768fdaa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----94168768fdaa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----94168768fdaa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----94168768fdaa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----94168768fdaa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----94168768fdaa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----94168768fdaa--------------------------------", "anchor_text": ""}, {"url": "https://hengluchang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hengluchang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Henry Chang"}, {"url": "https://hengluchang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "65 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F55e0a0a36864&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&user=Henry+Chang&userId=55e0a0a36864&source=post_page-55e0a0a36864--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F55e0a0a36864%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-elmo-contextual-vectors-94168768fdaa&user=Henry+Chang&userId=55e0a0a36864&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}