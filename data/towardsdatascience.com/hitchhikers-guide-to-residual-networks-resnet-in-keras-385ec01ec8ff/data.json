{"url": "https://towardsdatascience.com/hitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff", "time": 1682995697.0146382, "path": "towardsdatascience.com/hitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff/", "webpage": {"metadata": {"title": "Hitchhiker\u2019s Guide to Residual Networks (ResNet) in Keras | by Marco Peixeiro | Towards Data Science", "h1": "Hitchhiker\u2019s Guide to Residual Networks (ResNet) in Keras", "description": "Very deep neural networks are hard to train as they are more prone to vanishing or exploding gradients. To solve this problem, the activation unit from a layer could be fed directly to a deeper layer\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel", "paragraph_index": 2}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 8}, {"url": "https://github.com/tensorflow/tensorflow", "anchor_text": "TensorFlow", "paragraph_index": 9}, {"url": "https://github.com/Microsoft/cntk", "anchor_text": "CNTK", "paragraph_index": 9}, {"url": "https://github.com/Theano/Theano", "anchor_text": "Theano", "paragraph_index": 9}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/4.Convolutional%20Neural%20Networks/2.Deep%20Convolutional%20Models/Residual%20Networks.ipynb", "anchor_text": "notebook", "paragraph_index": 10}], "all_paragraphs": ["Very deep neural networks are hard to train as they are more prone to vanishing or exploding gradients. To solve this problem, the activation unit from a layer could be fed directly to a deeper layer of the network, which is termed as a skip connection.", "This forms the basis of residual networks or ResNets. This post will introduce the basics the residual networks before implementing one in Keras.", "For hands-on video tutorials on machine learning, deep learning, and artificial intelligence, checkout my YouTube channel.", "A building block of a ResNet is called a residual block or identity block. A residual block is simply when the activation of a layer is fast-forwarded to a deeper layer in the neural network.", "As you can see in the image above, the activation from a previous layer is being added to the activation of a deeper layer in the network.", "This simple tweak allows training much deeper neural networks.", "In theory, the training error should monotonically decrease as more layers are added to a neural network. In practice however, for a traditional neural network, it will reach a point where the training error will start increasing.", "ResNets do not suffer from this problem. The training error will keep decreasing as more layers are added to the network. In fact, ResNets have made it possible to train networks with more than 100 layers, even reaching 1000 layers.", "Now, let\u2019s build a ResNet with 50 layers for image classification using Keras.", "Keras is a high-level neural networks API, written in Python and capable of running on top of TensorFlow, CNTK, or Theano. It was developed with a focus on enabling fast experimentation.", "In this case, we will use TensorFlow as the backend. Of course, feel free to grab the entire notebook and make all the necessary imports before starting.", "First, we define the identity block, which will make our neural network a residual network as it represents the skip connection:", "Then, we build a convolution block like so:", "Notice how the convolution block combines both the main path and the shortcut.", "Now, we combine both blocks into building a 50-layer residual network:", "Before training, realize that we have a function that returns model. Therefore, we need to assign it to a variable. Then, Keras requires us to compile the model:", "Once that is done, we can normalize our images and one-hot encode them:", "Afterwards, we can fit the model:", "Now, you will see that we only get 16% accuracy. This is because we only trained on 2 epochs. You can train your model for longer on your own machine, but do realize that it will take a very long time, since it the network is very large.", "Keras makes it very easy to have a summary of the model we just built. Simply run this code:", "and you get a detailed summary of each layer in your network.", "You can also generate a picture of the network\u2019s architecture and save it in your working directory:", "Great! You just learned the basics of a residual network and built one using Keras! Again, feel free to train the algorithm longer (~20 epochs), and you should see that the network performs very well. However, if you train only on CPU, this might take more than 1h.", "In a future post, I will show how to perform neural style transfer in TensorFlow, which is a very fun way to apply convolution neural networks!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior data scientist | Author | Instructor. I write hands-on articles with a focus on practical skills."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F385ec01ec8ff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd----385ec01ec8ff---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F385ec01ec8ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F385ec01ec8ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@bethewerewolf?utm_source=medium&utm_medium=referral", "anchor_text": "Andr\u00e9s Canch\u00f3n"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://github.com/tensorflow/tensorflow", "anchor_text": "TensorFlow"}, {"url": "https://github.com/Microsoft/cntk", "anchor_text": "CNTK"}, {"url": "https://github.com/Theano/Theano", "anchor_text": "Theano"}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/4.Convolutional%20Neural%20Networks/2.Deep%20Convolutional%20Models/Residual%20Networks.ipynb", "anchor_text": "notebook"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "deeplearning.ai"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----385ec01ec8ff---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----385ec01ec8ff---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----385ec01ec8ff---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----385ec01ec8ff---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----385ec01ec8ff---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F385ec01ec8ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----385ec01ec8ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F385ec01ec8ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----385ec01ec8ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F385ec01ec8ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F385ec01ec8ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----385ec01ec8ff---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----385ec01ec8ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/@marcopeixeiro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9835bccb3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhitchhikers-guide-to-residual-networks-resnet-in-keras-385ec01ec8ff&newsletterV3=741c1c8fcfbd&newsletterV3Id=9835bccb3d51&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/time-series-forecasting-in-python-book", "anchor_text": "Time Series Forecasting in Python2022"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}