{"url": "https://towardsdatascience.com/topic-modelling-into-a-category-tree-acafad0f0050", "time": 1683012713.070341, "path": "towardsdatascience.com/topic-modelling-into-a-category-tree-acafad0f0050/", "webpage": {"metadata": {"title": "Topic Modelling into a Category Tree | by Anand P V | Towards Data Science", "h1": "Topic Modelling into a Category Tree", "description": "\u2014 This solution ranked 4th out of 10,000+ in All-India AI Hackathon, Automated Multi Label Classification, in Code Gladiators 2020 by Techgig. The Hackathon challenge was to multi-categorize 1M+\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.freecodecamp.org/news/how-we-changed-unsupervised-lda-to-semi-supervised-guidedlda-e36a95f3a164/", "anchor_text": "Guided LDA", "paragraph_index": 54}, {"url": "https://www.linkedin.com/in/ananduthaman/", "anchor_text": "here", "paragraph_index": 55}], "all_paragraphs": ["\u2014 This solution ranked 4th out of 10,000+ in All-India AI Hackathon, Automated Multi Label Classification, in Code Gladiators 2020 by Techgig.", "Mixed were the feelings when I got to know the Top 3 position in Hackathon was a narrow miss by 1 mark. While it was kinda re-assuring to stand 4th among Finalist Teams, despite myself participating alone, the void of one passionate team partner, was quite disquieting.", "The Hackathon challenge was to multi-categorize 1M+ multi-lingual articles with meta-information, at high precision. The meta-information denotes the category-tree information hidden in the URL text sequence and also the title of each article. You can get a glance at the input data-set below.", "The above articles are to be categorized into a category hierarchy based on the article topic. For instance, \u201cModi visits to China\u201d are to be categorized in \u201cPolitics^International\u201d while \u201cCorona tally reached record high\u201d as \u201cHealth^Pandemic\u201d.", "As above data-set is very huge, enormous effort is required to label the articles manually. Our aim is to reduce the manual work to the extent possible. Hence, we aim to do Topic Modelling over the above data-set.", "Thus, it is clear that we need to do Topic Modelling as the input articles are not labelled, prior. But Topic Modelling won\u2019t guarantee accurate results, though it is quick, as no training is required.", "Hence, we need alternate categorization approaches and arrange them as cascaded fallback, while also improving upon Topic Modelling results.", "Correlate word vectors of the words present in node categories & article description, computed using Google Word2Vec Model. This model is pre-trained on Google News data-set, which is similar to the input data we need to categorize.", "2. Fallback 1: URL based Category Tree Classifier", "The sequence of folders, from left to right embodies the category hierarchy associated with the article. For instance, the below URL should be categorized as \u201cNews/Politics/BJP Politics\u201d. If the confidence value of \u201cApproach 1\" falls below a threshold, then Fallback 1 is triggered.", "3. Fallback 2: LDA-NMF Combination Model", "Latent Dirichlet Allocation (LDA) is a classic solution to Topic-Modelling. But in practice, it gave huge proportion of wrong classifications. Hence, Non Negative Matrix Factorization (NMF) is also used and numerically combined with LDA, along with Multi Class Binarizer to refine the results.", "4. Fallback 3: Category Tree Classifier using Description", "If all the above approaches fail, then you can either mark the article as \u201cunclassified\u201d or take output of \u201cMain Approach\u201d as the final fallback.", "You can also check out \u201cImprovements\u201d head at the bottom of this blog, for further fallback strategies to replace Fallback 4.", "Prior to solution implementation, let's build the input category tree.", "The category tree to classify the documents are given as csv file below.", "We can represent category tree using any python data structure. AnyTree package is used to create, manipulate & traverse the category tree input.", "The above code generated the tree structure from the input cat_tree.csv file.", "The category tree structure can be visualized using graphviz.", "The non-English articles can easily be translated to \u2018English\u2019 using Google API. To save time, identify non-english rows and feed only those to below function.", "Google\u2019s pre-trained model which includes word vectors for a vocabulary of 3 million words and phrases that they trained on roughly 100 billion words from a Google News dataset. The vector length is 300 features and the training data set is similar to our input data set.", "Firstly, we correlate words in \u2018long description\u2019 with nodes to find category.", "A deep algorithm which peruses GoogleNews vectors of category tree nodes correlated with each word in article description was implemented. Multi-word categories are intelligently handled not to hike up the similarity scores. This function is the core of the solution.", "Breadth-First Correlation Traversal of category tree is done to find out the best category tree allocation based on Word2Vec similarity.", "The above code is sophisticated enough to generate a rich category tree by analyzing each word in the article, correlated with words in node category.", "To combine the outcome of different algorithms, we need to compute the classification confidence for each article. Hence, saved the (id, tree, confidence) information into CSV file.", "The confidence score is computed using a mathematical formula based on the numerical distribution of values in the list. The formula computes the difference between highest similarity value and second highest value, as it denotes ambiguity when the top 2 values are near.", "Multi-words categories having words of different meanings are combined into similar meaning words so that word vector distance metrics won\u2019t go awry. For instance, \u201cEducation\u201d was found similar to \u201cFinance\u201d among word vectors, hence renamed to a similar meaning word, \u201cSchooling\u201d.", "No single information may be enough to properly classify an article. First, we use the tree information embedded in the URL links to find the category.", "The above code will generate a cat-tree and confidence score corresponding to each article. Note that confidence is 0 when there is not enough info in link.", "LDA is a probabilistic generative process, while NMF is a linear-algebraic method to classify documents into different topics.", "Any document is considered to have an underlying mixture of topics associated with it. Similarly, a topic is considered to be a mixture of terms that is likely to generate. Thus, there are two sets of parameters of probability distributions that we need to compute.", "2. The probability of a term t given a topic z: P ( t | z)", "Thus, probability of document d generate the term t,", "P (t | d) = sum of product of previous 2 probabilities for all topics.", "This concept of matrix factorization is called Latent Dirichlet Allocation.", "LDA starts by picking some topics for each article and some words for each topic, both of which are represented by multinomial distribution.", "The LDA model has a huge advantage that it gives us a bunch of topics also. The algorithm will just throw some topics and we may have to manually group them more meaningfully.", "However, neither LDA nor NMF could return good results individually, being unsupervised. Hence, a numerical combination of LDA and NMF output matrices post-normalization was implemented to figure out the maximum probable topic.", "After doing pre-processing, apply CountVectorizer and TF-IDF-Vectorizer on \u2018article description\u2019 to compute the document-term matrix (DTM) to be fed in to LDA and NMF respectively.", "Manually label the topics based on the top 20 words in each cluster, as below.", "Output of LDA is a matrix of size # of articles * # of topics. Each cell contains the probability of an article belonging to a topic.", "We can also use NMF to decompose DTM into two matrices, like below, which is conceptually similar to LDA model, except that here we use linear algebra instead of a probabilistic model.", "Output of NMF is also a matrix of size # of articles * # of topics and interpretation remains the same. Hence, we can combine the output matrices of LDA and NMF on y-axis to get 1 million * 40 columns. (Input = 1M rows. Topics = 20 each for LDA and NMF)", "Take the argmax() of each row to find the most probable prediction out of both LDA and NMF", "Note: Remember to do normalization before matrix concatenation.", "The combination model produces better categorization results as below.", "The only downside is that this results in 1st level categorization and not tree hierarchy. So is the reason, I have decided to place it as 2nd Fallback.", "Ideally, Hierarchical-LDA should be done and be placed as 1st Fallback after Article Classifier in the solution pipeline. Article Classifier should still be the main logic, as Hierarchical-LDA produces word clusters of random categories which may not be same as the category tree we want.", "The article description classifier and URL classifier are merged into a pipeline with LDA-NMF combination model, as cascading fallbacks based on the corresponding confidence scores.", "Much weightage is given to description classifier as LDA-NMF gives only the category (not category tree) and URL often doesn't contain the required info. If all 3 methods failed then mark it as \u201cunclassified\u201d or use outcome of article classifier, though ambiguous.", "Disclaimer: As the above solution is coded in a 24-hour Hackathon, the code may not be perfect. It can be improved upon using the approaches noted below and also hyper-parameters in the code are required to be tuned more.", "2. Knowledge Graph: Knowledge graph of article text would generate hierarchical relation of words, akin to a category tree. This information can be used to map article to category tree.", "3. Guided LDA: We can also use Guided LDA to set some seed words for ambiguous categories, when there are not enough documents to differentiate. Seed words will guide the model to converge around those categories.", "If you have any query or suggestion, you can reach me here", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI / ML R&D Specialist, KLA-Tencor | CSE, IIT B Alumnus | Ex-Vice President \u2014 AI & DS, IIA | Ex-TSMC | Reached interview twice for IAS | AI Consultant & Mentor"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Facafad0f0050&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----acafad0f0050--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----acafad0f0050--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://anandai.medium.com/?source=post_page-----acafad0f0050--------------------------------", "anchor_text": ""}, {"url": "https://anandai.medium.com/?source=post_page-----acafad0f0050--------------------------------", "anchor_text": "Anand P V"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc093ed453e2c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&user=Anand+P+V&userId=c093ed453e2c&source=post_page-c093ed453e2c----acafad0f0050---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Facafad0f0050&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Facafad0f0050&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/AdroitAnandAI/Topic-Modelling-LDA-NMF-W2V", "anchor_text": "here"}, {"url": "https://www.navjivanindia.com/news/bjp-leader-kaushal-kishore-attacks-up-police-over-law-and-order-in-up", "anchor_text": "https://www.navjivanindia.com/news/bjp-leader-kaushal-kishore-attacks-up-police-over-law-and-order-in-up"}, {"url": "https://www.researchgate.net/figure/Conceptual-illustration-of-non-negative-matrix-factorization-NMF-decomposition-of-a_fig1_312157184", "anchor_text": "Source"}, {"url": "https://github.com/joewandy/hlda", "anchor_text": "h-LDA"}, {"url": "https://www.freecodecamp.org/news/how-we-changed-unsupervised-lda-to-semi-supervised-guidedlda-e36a95f3a164/", "anchor_text": "Guided LDA"}, {"url": "https://github.com/AdroitAnandAI/Topic-Modelling-LDA-NMF-W2V", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/ananduthaman/", "anchor_text": "here"}, {"url": "https://medium.com/square-corner-blog/inferring-label-hierarchies-with-hlda-2093d0413337", "anchor_text": "Inferring Label Hierarchies with hLDAThe Problem: Organizing Square Support Center Articlesmedium.com"}, {"url": "https://towardsdatascience.com/topic-modeling-quora-questions-with-lda-nmf-aff8dce5e1dd", "anchor_text": "Topic Modeling Quora Questions with LDA & NMFLatent Dirichlet Allocation, Non-negative Matrix Factorizationtowardsdatascience.com"}, {"url": "https://github.com/joewandy/hlda", "anchor_text": "joewandy/hldaHierarchical Latent Dirichlet Allocation (hLDA) addresses the problem of learning topic hierarchies from data. The\u2026github.com"}, {"url": "https://www.udacity.com/course/natural-language-processing-nanodegree--nd892", "anchor_text": "Natural Language Processing Online CourseNew! Nanodegree Program Prerequisite Knowledge This program requires experience with Python, statistics, machine\u2026www.udacity.com"}, {"url": "https://medium.com/tag/topic-modelling?source=post_page-----acafad0f0050---------------topic_modelling-----------------", "anchor_text": "Topic Modelling"}, {"url": "https://medium.com/tag/multilabel-classifier?source=post_page-----acafad0f0050---------------multilabel_classifier-----------------", "anchor_text": "Multilabel Classifier"}, {"url": "https://medium.com/tag/classification?source=post_page-----acafad0f0050---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/unsupervised-clustering?source=post_page-----acafad0f0050---------------unsupervised_clustering-----------------", "anchor_text": "Unsupervised Clustering"}, {"url": "https://medium.com/tag/clustering?source=post_page-----acafad0f0050---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Facafad0f0050&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&user=Anand+P+V&userId=c093ed453e2c&source=-----acafad0f0050---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Facafad0f0050&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&user=Anand+P+V&userId=c093ed453e2c&source=-----acafad0f0050---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Facafad0f0050&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----acafad0f0050--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Facafad0f0050&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----acafad0f0050---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----acafad0f0050--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----acafad0f0050--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----acafad0f0050--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----acafad0f0050--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----acafad0f0050--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----acafad0f0050--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----acafad0f0050--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----acafad0f0050--------------------------------", "anchor_text": ""}, {"url": "https://anandai.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anandai.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anand P V"}, {"url": "https://anandai.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "233 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc093ed453e2c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&user=Anand+P+V&userId=c093ed453e2c&source=post_page-c093ed453e2c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdc22cac35dc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftopic-modelling-into-a-category-tree-acafad0f0050&newsletterV3=c093ed453e2c&newsletterV3Id=dc22cac35dc6&user=Anand+P+V&userId=c093ed453e2c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}