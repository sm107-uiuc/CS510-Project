{"url": "https://towardsdatascience.com/quick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2", "time": 1683014268.01668, "path": "towardsdatascience.com/quick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2/", "webpage": {"metadata": {"title": "Quick Tutorial: Using Bayesian optimization to tune your hyperparameters in PyTorch | by Michael Deyzel | Towards Data Science", "h1": "Quick Tutorial: Using Bayesian optimization to tune your hyperparameters in PyTorch", "description": "Hyperparameters are the parameters in models that determine model architecture, learning speed and scope, and regularization. The search for optimal hyperparameters requires some expertise and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ax.dev/", "anchor_text": "Ax", "paragraph_index": 2}, {"url": "https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html", "anchor_text": "PyTorch beginner tutorial", "paragraph_index": 3}, {"url": "https://ax.dev/docs/bayesopt.html", "anchor_text": "Ax website", "paragraph_index": 4}, {"url": "https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.467.8687&rep=rep1&type=pdf", "anchor_text": "original paper", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1206.2944", "anchor_text": "paper on its practical use", "paragraph_index": 4}, {"url": "https://ax.dev/api/_modules/ax/utils/tutorials/cnn_utils.html#evaluate", "anchor_text": "check out ther API", "paragraph_index": 7}, {"url": "https://ax.dev/api/core.html#ax.core.experiment.Experiment", "anchor_text": "check out the docs", "paragraph_index": 13}], "all_paragraphs": ["Hyperparameters are the parameters in models that determine model architecture, learning speed and scope, and regularization.", "The search for optimal hyperparameters requires some expertise and patience, and you\u2019ll often find people using exhausting methods like grid search and random search to find the hyperparameters that work best for their problem.", "I\u2019m going to show you how to implement Bayesian optimization to automatically find the optimal hyperparameter set for your neural network in PyTorch using Ax.", "We\u2019ll be building a simple CIFAR-10 classifier using transfer learning. Most of this code is from the official PyTorch beginner tutorial for a CIFAR-10 classifier.", "I won\u2019t be going into the details of Bayesian optimization, but you can study the algorithm on the Ax website, read the original paper or the 2012 paper on its practical use.", "Download the datasets and construct the data loaders (I would advise adjusting the training batch size to 32 or 64 later):", "Let\u2019s take a look at the CIFAR-10 dataset by creating some helper functions:", "Ax requires a function that returns a trained model, and another that evaluates a model and returns a performance metric like accuracy or F1 score. We\u2019re only building the training function here and using Ax\u2019s ownevaluate tutorial function to test our model performance, which returns accuracy. You can check out ther API to model your own evaluation function after theirs, if you\u2019d like.", "Next, we\u2019re writing an init_net() function that initializes the model and returns the network ready-to-train. There are many opportunities for hyperparameter tuning here. You\u2019ll notice the parameterization argument, which is a dictionary containing the hyperparameters.", "Lastly, we need a train_evaluate() function that the Bayesian optimizer calls on every run. The optimizer generates a new set of hyperparameters in parameterization, passes it to this function, and then analyzes the returned evaluation results.", "Now, just specify the hyperparameters you want to sweep across and pass that to Ax\u2019s optimize() function:", "That sure took a while, but it\u2019s nothing compared to doing a naive grid search for all 3 hyperparameters. Let\u2019s take a look at the results:", "It seems our optimal learning rate is 2.37e-4 when comined with a momentum of 0.99 and a batch size of 117. That\u2019s pretty nice. The 49.1% accuracy you see here is not the final accuracy of the model, so don\u2019t worry!", "We can go even further and render some plots that show the accuracy per epoch (which improved as the parameterization improved), and the estimated accuracy by the optimizer as a function of two hyperparameters using a contour plot. The experiment variable is of type Experiment and you should definitely check out the docs to see all the methods it has to offer.", "The rendered plots are easy to understand and interactive. The black squares in the contour plots show the coordinates that have actually been sampled.", "Lastly, you can fetch the parameter set (something Ax calls an \u201carm\u201d) that has the best mean accuracy by simply running the script below:", "Don\u2019t be afraid to tune anything you wish, like hidden layer number and size, dropout, activation functions, depth of unfreezing, etc.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Electronic Engineer student at Stellenbosch University, South Africa. Web, apps, machine learning, computer vision."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe9f74fc133c2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@micdeyzel?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@micdeyzel?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": "Michael Deyzel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa706acb58f89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&user=Michael+Deyzel&userId=a706acb58f89&source=post_page-a706acb58f89----e9f74fc133c2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9f74fc133c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9f74fc133c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@adigold1?utm_source=medium&utm_medium=referral", "anchor_text": "Adi Goldstein"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://ax.dev/", "anchor_text": "Ax"}, {"url": "https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html", "anchor_text": "PyTorch beginner tutorial"}, {"url": "https://ax.dev/docs/bayesopt.html", "anchor_text": "Ax website"}, {"url": "https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.467.8687&rep=rep1&type=pdf", "anchor_text": "original paper"}, {"url": "https://arxiv.org/abs/1206.2944", "anchor_text": "paper on its practical use"}, {"url": "https://ax.dev/api/_modules/ax/utils/tutorials/cnn_utils.html#evaluate", "anchor_text": "check out ther API"}, {"url": "https://ax.dev/api/core.html#ax.core.experiment.Experiment", "anchor_text": "check out the docs"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e9f74fc133c2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----e9f74fc133c2---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e9f74fc133c2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e9f74fc133c2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----e9f74fc133c2---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe9f74fc133c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&user=Michael+Deyzel&userId=a706acb58f89&source=-----e9f74fc133c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe9f74fc133c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&user=Michael+Deyzel&userId=a706acb58f89&source=-----e9f74fc133c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9f74fc133c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe9f74fc133c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e9f74fc133c2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e9f74fc133c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@micdeyzel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@micdeyzel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Deyzel"}, {"url": "https://medium.com/@micdeyzel/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "16 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa706acb58f89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&user=Michael+Deyzel&userId=a706acb58f89&source=post_page-a706acb58f89--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fa706acb58f89%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquick-tutorial-using-bayesian-optimization-to-tune-your-hyperparameters-in-pytorch-e9f74fc133c2&user=Michael+Deyzel&userId=a706acb58f89&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}