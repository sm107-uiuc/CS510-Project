{"url": "https://towardsdatascience.com/https-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba", "time": 1682997284.6447308, "path": "towardsdatascience.com/https-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba/", "webpage": {"metadata": {"title": "How to Ease the Pain of Working with Imbalanced Data | by Andrea Brown | Towards Data Science", "h1": "How to Ease the Pain of Working with Imbalanced Data", "description": "A summary of methods and resources for creating a machine learning model using an imbalanced dataset"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5", "anchor_text": "This TDS post", "paragraph_index": 2}, {"url": "https://www.kaggle.com/qianchao/smote-with-imbalance-data", "anchor_text": "this Kaggle kernel", "paragraph_index": 3}, {"url": "https://pdfs.semanticscholar.org/95df/dc02010b9c390878729f459893c2a5c0898f.pdf", "anchor_text": "two primary classes of methodologies", "paragraph_index": 7}, {"url": "https://cling.csd.uwo.ca/papers/cost_sensitive.pdf", "anchor_text": "Cost-sensitive learning", "paragraph_index": 8}, {"url": "https://hackernoon.com/introduction-to-machine-learning-algorithms-logistic-regression-cbdd82d81a36", "anchor_text": "loss function", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html", "anchor_text": "Support Vector Classifier", "paragraph_index": 10}, {"url": "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.303.4068&rep=rep1&type=pdf", "anchor_text": "This paper", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/modules/naive_bayes.html", "anchor_text": "Complement Naive Bayes", "paragraph_index": 11}, {"url": "https://medium.com/urbint-engineering/using-smoteboost-and-rusboost-to-deal-with-class-imbalance-c18f8bf5b805", "anchor_text": "ideal for imbalanced datasets", "paragraph_index": 12}, {"url": "https://medium.com/urbint-engineering/using-smoteboost-and-rusboost-to-deal-with-class-imbalance-c18f8bf5b805", "anchor_text": "AdaBoost iteratively builds an ensemble of weak learners by adjusting the weights of misclassified data during each iteration.", "paragraph_index": 12}, {"url": "https://pypi.org/project/imbalanced-learn/", "anchor_text": "re-sampling techniques", "paragraph_index": 13}, {"url": "https://medium.com/urbint-engineering/using-smoteboost-and-rusboost-to-deal-with-class-imbalance-c18f8bf5b805", "anchor_text": "SMOTEBoost", "paragraph_index": 15}, {"url": "https://medium.com/anomaly-detection-with-python-and-r/sampling-techniques-for-extremely-imbalanced-data-part-i-under-sampling-a8dbc3d8d6d8", "anchor_text": "This Medium post", "paragraph_index": 16}, {"url": "https://medium.com/urbint-engineering/using-smoteboost-and-rusboost-to-deal-with-class-imbalance-c18f8bf5b805", "anchor_text": "RUSBoost", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.BaggingClassifier.html", "anchor_text": "Bagging", "paragraph_index": 18}, {"url": "https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/", "anchor_text": "Bagging involves", "paragraph_index": 18}], "all_paragraphs": ["You\u2019ve finally collected and cleaned your data and have even completed some exploratory data analysis (EDA). All that hard work has finally paid off \u2014 time to start playing with models! However, you quickly realize that 99% of your binary labels are of the majority class while only 1% are of the minority class. Using accuracy as the primary evaluation metric, your models are classifying all predictions as the majority class and are still 99% accurate. You do a little Googling to find the right search terms for Stack Overflow, and then you sigh deeply as you read about the pains of working with imbalanced data\u2026", "Fraud detection is commonly used as an example of imbalanced datasets. Maybe only 1 out of every 1,000 transactions is fraudulent, which means only 0.1% of labels are of the minority class. Disease data is also likely to be imbalanced. In environmental health, a typical threshold for an elevated risk of developing cancer is 1 in 10^6, or one in a million people. For my project, I was working with lawsuit data, and the companies that had been sued were minimal compared to the dataset as a whole. In summary, imbalanced data is exactly what it sounds like: the labels for the minority class are far and few between, making the accuracy metric somewhat useless for evaluating model results.", "Another key difference is to use alternative metrics to the traditional accuracy metric. Since I was primarily interested in identifying True Positives and avoiding False Negatives rather than maximizing accuracy, I used the area under the curve receiving operator characteristic (AUC ROC) metric. This TDS post has a great explanation of the AUC ROC metric. To summarize, AUC ROC = 0.5 essentially means the model is equivalent to a random guess and AUC ROC = 1 implies the model can perfectly differentiate between the minority and majority classes.", "I also relied on the confusion matrix to maximize the number of True Positives and False Positives and minimize the number of False Negatives. Since I was working with lawsuit data, I decided to consider a False Positive result as an indication of a high likelihood of being sued in the future. Therefore, False Positive results were also very important to me. I liked the code in this Kaggle kernel to visualize the confusion matrix.", "I also calculated the more traditional precision and recall metrics (equations below for quick reference) to compare different learning algorithms, and I added the less traditional miss rate (false positive rate) to the list of metrics to compare as well.", "Recall (True Positive Rate) = TP / (TP + FN)", "Miss Rate (False Positive Rate) = FN / (FN +TP)", "There are two primary classes of methodologies to working with imbalanced data: (1) at the algorithm level and (2) at the data level. I\u2019ll summarize the methods for each in the following sections.", "Considering solutions to an imbalanced dataset at the algorithm level requires an understanding of algorithms that enable cost-sensitive learning. In my case (and likely for disease and fraud detection as well), identifying True Positives was the primary goal of the model, even at the expense of selecting some False Positives. This is where cost-sensitive learning comes in handy. Cost-sensitive learning takes into account the different types of misclassification (False Positives & False Negatives).", "A classic logistic regression algorithm is a robust model for imbalanced datasets. The logistic regression algorithm includes a loss function that calculates the cost for misclassification. Using SciKit-Learn, the loss function can be manipulated with a penalty weight that includes either \u2018L1\u2019 or \u2018L2\u2019 Regularization depending on the solver used.", "In SciKit-Learn, the Support Vector Classifier includes a \u2018class_weight\u2019 parameter that can be used to give more weight to the minority class. \u201cThe \u2018balanced\u2019 mode \u201cuses the values of y to automatically adjust weights inversely proportional to class frequencies in the input data.\u201d This paper further details developing a cost-sensitive SVM.", "SciKit-Learn includes a Complement Naive Bayes algorithm that is a cost-sensitive classifier that \u201cuses statistics from the complement of each class to compute the model\u2019s weights.\u201d Optimizing the model weights is an effective way of handling imbalanced datasets.", "Boosting algorithms are ideal for imbalanced datasets \u201cbecause higher weight is given to the minority class at each successive iteration.\u201d For example, \u201cAdaBoost iteratively builds an ensemble of weak learners by adjusting the weights of misclassified data during each iteration.\u201d", "Solving a class imbalance problem at the data level typically involves manipulating the existing data to force the dataset used to train the algorithm to be balanced. This method is called re-sampling, and typical re-sampling techniques include:", "Over-sampling involves balancing the dataset by creating synthetic data to increase the number of outcomes in the minority class. A common method for over-sampling is called the Synthetic Minority Oversampling Technique (SMOTE), which uses k-nearest neighbors to create synthetic data.", "Taking this a step further, SMOTEBoost combines over-sampling with boosting. SMOTEBoost is \u201can over-sampling method based on the SMOTE algorithm that injects the SMOTE method at each boosting iteration.\u201d", "Under-sampling involves decreasing the data included in the majority class to balance the training dataset. Note that this decreases the size of the dataset. A common technique for under-sampling is random undersampling (RUS), which randomly and selects a subset of the majority class. This Medium post goes into more detail on the various under-sampling methods.", "RUSBoost combines under-sampling with boosting. Similar to SMOTEBoost, \u201cRUSBoost achieves the same goal by performing random undersampling (RUS) at each boosting iteration instead of SMOTE.\u201d", "Bagging is an example of an ensemble technique at the data level. Bagging involves \u201cbuilding multiple models (typically of the same type) from different subsamples of the training dataset.\u201d Bagging can reduce variance and prevent overfitting in algorithms such as the Random Forest Decision Trees algorithm.", "For my dataset, the best approach was to use combine an ensemble method of boosting with over-sampling of the minority class (SMOTEBoost) and use the logistic regression algorithm to achieve an AUC ROC value of 0.81. With additional time spent on feature engineering, I could increase the AUC ROC value even more.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "\u2764 for data, dogs, and the outdoors."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa7f7601f18ba&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://abrown004.medium.com/?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": ""}, {"url": "https://abrown004.medium.com/?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": "Andrea Brown"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c1d3edec5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&user=Andrea+Brown&userId=8c1d3edec5e&source=post_page-8c1d3edec5e----a7f7601f18ba---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7f7601f18ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7f7601f18ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5", "anchor_text": "This TDS post"}, {"url": "https://www.kaggle.com/qianchao/smote-with-imbalance-data", "anchor_text": "this Kaggle kernel"}, {"url": "https://pdfs.semanticscholar.org/95df/dc02010b9c390878729f459893c2a5c0898f.pdf", "anchor_text": "two primary classes of methodologies"}, {"url": "https://cling.csd.uwo.ca/papers/cost_sensitive.pdf", "anchor_text": "Cost-sensitive learning"}, {"url": "https://hackernoon.com/introduction-to-machine-learning-algorithms-logistic-regression-cbdd82d81a36", "anchor_text": "loss function"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html", "anchor_text": "Support Vector Classifier"}, {"url": "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.303.4068&rep=rep1&type=pdf", "anchor_text": "This paper"}, {"url": "https://scikit-learn.org/stable/modules/naive_bayes.html", "anchor_text": "Complement Naive Bayes"}, {"url": "https://medium.com/urbint-engineering/using-smoteboost-and-rusboost-to-deal-with-class-imbalance-c18f8bf5b805", "anchor_text": "ideal for imbalanced datasets"}, {"url": "https://medium.com/urbint-engineering/using-smoteboost-and-rusboost-to-deal-with-class-imbalance-c18f8bf5b805", "anchor_text": "AdaBoost iteratively builds an ensemble of weak learners by adjusting the weights of misclassified data during each iteration."}, {"url": "https://pypi.org/project/imbalanced-learn/", "anchor_text": "re-sampling techniques"}, {"url": "https://medium.com/urbint-engineering/using-smoteboost-and-rusboost-to-deal-with-class-imbalance-c18f8bf5b805", "anchor_text": "SMOTEBoost"}, {"url": "https://medium.com/anomaly-detection-with-python-and-r/sampling-techniques-for-extremely-imbalanced-data-part-i-under-sampling-a8dbc3d8d6d8", "anchor_text": "This Medium post"}, {"url": "https://medium.com/urbint-engineering/using-smoteboost-and-rusboost-to-deal-with-class-imbalance-c18f8bf5b805", "anchor_text": "RUSBoost"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.BaggingClassifier.html", "anchor_text": "Bagging"}, {"url": "https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/", "anchor_text": "Bagging involves"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a7f7601f18ba---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a7f7601f18ba---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/imbalanced-data?source=post_page-----a7f7601f18ba---------------imbalanced_data-----------------", "anchor_text": "Imbalanced Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa7f7601f18ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&user=Andrea+Brown&userId=8c1d3edec5e&source=-----a7f7601f18ba---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa7f7601f18ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&user=Andrea+Brown&userId=8c1d3edec5e&source=-----a7f7601f18ba---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7f7601f18ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa7f7601f18ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a7f7601f18ba---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a7f7601f18ba--------------------------------", "anchor_text": ""}, {"url": "https://abrown004.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://abrown004.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrea Brown"}, {"url": "https://abrown004.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "142 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c1d3edec5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&user=Andrea+Brown&userId=8c1d3edec5e&source=post_page-8c1d3edec5e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd9da2465c873&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-abrown004-how-to-ease-the-pain-of-working-with-imbalanced-data-a7f7601f18ba&newsletterV3=8c1d3edec5e&newsletterV3Id=d9da2465c873&user=Andrea+Brown&userId=8c1d3edec5e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}