{"url": "https://towardsdatascience.com/how-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f", "time": 1682993145.116066, "path": "towardsdatascience.com/how-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f/", "webpage": {"metadata": {"title": "How can you improve your machine learning model quality? | by Arthur Mello | Towards Data Science", "h1": "How can you improve your machine learning model quality?", "description": "Sometimes, your machine learning models for classification just don\u2019t work as well as expected. When faced with this situation, what many people do is try different methods more or less at random or\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.coursera.org/learn/machine-learning-projects/home/welcome", "anchor_text": "Structuring Machine Learning Projects", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Bayes_error_rate", "anchor_text": "Bayes error", "paragraph_index": 12}, {"url": "https://www.coursera.org/learn/machine-learning-projects/home/welcome", "anchor_text": "Structuring Machine Learning Projects", "paragraph_index": 24}], "all_paragraphs": ["Sometimes, your machine learning models for classification just don\u2019t work as well as expected. When faced with this situation, what many people do is try different methods more or less at random or follow their guts. It might be adding more data, trying a new model, or tweaking some variables, but it is quite uncommon to have a method for choosing what to try first.", "What this article presents is exactly that: a well-defined method to choose the best strategy, depending on what type of model error you are facing.", "This method is based on the Structuring Machine Learning Projects course available on Coursera, but with adaptations in format, methodology and nomenclature. If you like the article, it might be worth taking the course, however, it is not too long and it has some extra useful hints.", "There are some criteria your model should match to be considered a good model, and usually they are met one at a time, in this order:", "For each of these steps, there are different strategies that allow you to improve performance, that should be applied accordingly. It is quite unlikely that your model will perform well in the real-world if it doesn\u2019t perform well in your training set, so when you see things start going wrong, you should be able to find the source of the error to fix it first.", "To be able to measure if your model is doing well or not, you should have a single number evaluation metric, the one metric that will enable you to compare different models. The moment you start trying to optimise for multiple metrics, you are not really optimising, and you won\u2019t get any objective answers.", "\u201cOk, but what if I REALLY need more than one metric?\u201d", "Then, choose one single numeric metric to be your \u201cone and only\u201d, and the others will be your satisficing metrics, the metrics for which you will set a cut-off, but for which you don\u2019t have to optimise.", "Say, for instance, you have 2 models, A and B. Model A has an accuracy of 95% and it takes 1 second to score a new observation. Model B has an accuracy of 98% and it takes 8 seconds to score a new observation.", "If you are optimising for accuracy, in theory, you would choose Model B. But imagine runtime is also important for your application, so you can\u2019t have a model that takes 8 seconds to score each observation. However, as long as it takes less than 2 seconds, it\u2019s fine for you. You will then optimise for accuracy, with a constraint of a maximum of 2 seconds for runtime, which will then lead you to choose model A. Note that you can have multiple satisficing metrics.", "Now that you have your definition of error, to understand where it comes from and optimise our chosen metric, we have to split error into different parts, using a sort of error pipeline.", "Never send a human to do a machine\u2019s job. \u2014 Agent Smith in the film The Matrix", "For some tasks, such as image recognition, we usually use humans as a baseline for getting the accuracy of our models: if humans get it wrong 1% of the times, usually we can\u2019t realistically expect to do much better. That\u2019s why we use human performance as a proxy for Bayes error, which is the minimum theoretical error for a task and thus will be the starting point of our pipeline.", "There\u2019s usually a lot of confusion and debate when it comes to defining train, validation and test sets, but I think industry standard is leaning towards using train for the dataset used for training the model (not much debate here), validation for the dataset you use to first validate your models and fine tune your parameters, and test dataset for the final dataset you use to test your model. It is important that validation and test observations come from the same distribution and that they both reflect data you will encounter in the real world.", "The default split between train and test is usually 70% / 30%, and between train, validation and test is 60% / 20% / 20%, more or less. However, when you have huge amounts of data, it\u2019s fine to use a 98% / 1% / 1% split, as long as you have at least something around 10 000 observations in each of validation and test sets.", "Finally, if your train and validation sets come from different distributions, you can split your train set in two parts: train and train-dev, and use the first one to train your model and the second one to test on data that comes from the same distribution than your train set, in order to isolate error that comes from your model being unable to generalise and error that comes from this difference in distributions.", "In the end, you would have 5 sequential values for your error measure (this being the one metric defined above). The difference between each one of them has a different source, and looking at the greatest sources of error will indicate to you which one you should address first:", "We\u2019ll now address each of these error sources and the best strategies to deal with each one of them.", "Avoidable bias should be as close as possible to zero, since the error in the train set will most likely be your smallest error, and you want it to be at least equal to human performance (if not better). Some strategies to address it include:", "Variance, on the other hand, comes from the fact that your model is overfitting the train set and is not yet capable of generalising its conclusions to data it has not seen yet. You can reduce it by:", "Sometimes, you can\u2019t have train and test data come from the same distributions: suppose you want to train a face recognition algorithm to be used specifically with the front camera of a cell phone, but you don\u2019t have enough labelled data with these exact same characteristics. Then you resort to publicly available data, that is already labelled, to train your model and test it on the pictures that come from a front camera. In this case, data mismatch error might happen and it can be reduced mainly by making your training data more similar to your validation and test sets.", "One way of doing this is by conducting manual error analysis. In our previous example, this could mean randomly taking a few (~100) of the mislabelled pictures from the validation set and trying to understand why the algorithm got them wrong by comparing to some pictures from the train set. Some might be distorted or low-resolution due to the front camera\u2019s poor quality, some might be much closer to the face than your train set, and some might be even correct and they were just mislabelled by the human in the first place. Try attributing each of the 100 pictures to an error category and, in the end, you can know what % of errors is generated by each category. You can then take into account the % of errors attributed to each category and how hard/expensive it would be to fix them, helping you decide which categories to address first. In our example, say most of the model\u2019s error happens when pictures are low-resolution. Maybe you could try to artificially reduce resolution in some pictures of your train set to make it more similar to your validation set, or simply take some pictures from your validation set and put them in your train set.", "This step my seem a bit cumbersome, but it can actually save you a lot of unnecessary work down the road.", "If your model overfits, then try making the validation set bigger by adding data to it.", "If you would like to learn more about this workflow, I suggest you take the Structuring Machine Learning Projects course, available on Coursera.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist and educator. I write about data analysis and machine learning applied to marketing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb22737d4fe5f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@arthurmello_?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arthurmello_?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": "Arthur Mello"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d32d5e0ac40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&user=Arthur+Mello&userId=9d32d5e0ac40&source=post_page-9d32d5e0ac40----b22737d4fe5f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb22737d4fe5f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb22737d4fe5f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jpvalery?utm_source=medium&utm_medium=referral", "anchor_text": "Jp Valery"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.coursera.org/learn/machine-learning-projects/home/welcome", "anchor_text": "Structuring Machine Learning Projects"}, {"url": "https://en.wikipedia.org/wiki/Bayes_error_rate", "anchor_text": "Bayes error"}, {"url": "https://unsplash.com/@aahubs?utm_source=medium&utm_medium=referral", "anchor_text": "Aaron Huber"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/regularization-techniques-for-neural-networks-e55f295f2866", "anchor_text": "regularisation techniques"}, {"url": "https://www.coursera.org/learn/machine-learning-projects/home/welcome", "anchor_text": "Structuring Machine Learning Projects"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b22737d4fe5f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b22737d4fe5f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data?source=post_page-----b22737d4fe5f---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----b22737d4fe5f---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/tag/analytics?source=post_page-----b22737d4fe5f---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb22737d4fe5f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&user=Arthur+Mello&userId=9d32d5e0ac40&source=-----b22737d4fe5f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb22737d4fe5f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&user=Arthur+Mello&userId=9d32d5e0ac40&source=-----b22737d4fe5f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb22737d4fe5f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb22737d4fe5f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b22737d4fe5f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b22737d4fe5f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arthurmello_?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arthurmello_?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arthur Mello"}, {"url": "https://medium.com/@arthurmello_/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d32d5e0ac40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&user=Arthur+Mello&userId=9d32d5e0ac40&source=post_page-9d32d5e0ac40--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1fb0cddb25fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-you-improve-your-machine-learning-model-quality-b22737d4fe5f&newsletterV3=9d32d5e0ac40&newsletterV3Id=1fb0cddb25fe&user=Arthur+Mello&userId=9d32d5e0ac40&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}