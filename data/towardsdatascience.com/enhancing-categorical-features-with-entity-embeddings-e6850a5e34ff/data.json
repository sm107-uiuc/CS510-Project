{"url": "https://towardsdatascience.com/enhancing-categorical-features-with-entity-embeddings-e6850a5e34ff", "time": 1683003795.617014, "path": "towardsdatascience.com/enhancing-categorical-features-with-entity-embeddings-e6850a5e34ff/", "webpage": {"metadata": {"title": "Enhancing categorical features with Entity Embeddings | by Rodrigo Bressan | Towards Data Science", "h1": "Enhancing categorical features with Entity Embeddings", "description": "Let\u2019s pretend you are the owner of a pub, and you want to predict how many beers your establishment is going to sell on a given day based on two variables: the day of the week and the current\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Let\u2019s pretend you are the owner of a pub, and you want to predict how many beers your establishment is going to sell on a given day based on two variables: the day of the week and the current weather. We can in some ways imagine that weekends and warmer days are going to sell more beers when compared to the beginning of the week and colder days.", "In face of this problem, we would usually start by encoding our categorical data (in this example, the day of the week and the weather) into dummy variables, in order to provide an input to our classifier without any kind of hierarchy between the existing categorical values.", "Our data would look like something below, for the day of week feature (you can imagine something similar for the weather feature):", "But does this really makes sense, to treat each categorical value as being completely different from one another, such as when using One-Hot-Encoding? Or could we make usage of some sort of technique to \u201clearn\u201d the relationships and inner connections between each possible value and our target variable?", "With this given scenario in mind, we can then proceed to the adoption of a technique popularly known in the NLP (Natural Language Processing) field as Entity Embeddings, which allows us to map a given feature set into a new one with a smaller number of dimensions. In our case, it will also allow us to extract meaningful information from our categorical data.", "The usage of Entity Embeddings is based on the process of training a Neural Network with the categorical data, with the purpose to retrieve the weights of the Embedding layers. This allows us to have a more significant input when compared to a single One-Hot-Encoding approach. By adopting Entity Embeddings we also are able to mitigate two major problems:", "An Embedding layer is pretty much a Neural Network layer that groups, into an N-dimensional space, categorical values with similar output value. This spatial representation allows us to obtain intrinsic properties of each categorical value, which can be later on used as a replacement to our old dummy encoded variables. If we think about it in a more simple manner, it would mean that days of the week that have a similar output (in our case, number of sold beers), would be close to each other. If you don\u2019t get it, maybe an example picture can help:", "Here we can see that we have four major groups: group 1, with Monday and Tuesday, possibly related to a low amount of sold beers, due to being the start of the week; group 2, with Wednesday and Thursday, with some distance from group 1; group 3, with Friday and Saturday, relatively close to group 2, indicating that they show more similarity than when compared with group 1; and group 4, with Sunday, without many similarities when compared to the other groups. This simple example can show us that the embedding layers can learn information from the real world, such as the most common days for going out and drinking. Pretty cool, isn\u2019t it?", "First, we need to know that for using an embedding layer, we must specify the number of dimensions we would like to be used for that given embedding. This, as you can notice, is a hyper parameter, and should be tested and experimented case by case. But as a rule of thumb, you can adopt the number of dimensions as equal to the square root of the number of unique values for the category. So in our case, our representation for the day of the week would have instead of seven different positions, only three (rounded up). Below we give an example for both mentioned features, and add some hidden layers into our model, in order to have more parameters to capture minor data nuances.", "Graphically our Neural Network would have the following representation:", "That\u2019s it! We can see that our architecture is initially composed of an Input layer for each of the categorical values, followed by our Embedding layers, then a Reshape layer. And then all put together. Lastly, we add some hidden layers to capture any extra information.", "Training our network for 200 epochs with a learning rate of 0.05, we can see some pretty good results for loss and mean squared error:", "In this simple example it may sound silly, but we can again think about our scenario of ten thousand unique values. The difference between a feature vector with ten thousand positions (by using One-Hot-Encoding) and another with only 100 (measured by the rule of thumb, when using entity embeddings) is enormous, when we think about computing resources. This is the difference for only a single record for a single feature, but you can imagine how complex this becomes with a real world dataset, where categories can sometimes become enormous.", "If you reached until this point without any doubts, congratulations! But if you do have any kind of questions, suggestions or complaints, feel free to reach me. I also created a GitHub repository containing a library to help anyone who is looking to perform entity embedding on their data, feel free to check it out:", "See you next time, and happy coding!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Code to coffee on a daily basis"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe6850a5e34ff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bressan?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bressan?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": "Rodrigo Bressan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8207f4a47f0b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&user=Rodrigo+Bressan&userId=8207f4a47f0b&source=post_page-8207f4a47f0b----e6850a5e34ff---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6850a5e34ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6850a5e34ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/rodrigobressan/entity_embeddings_categorical", "anchor_text": "https://github.com/rodrigobressan/entity_embeddings_categorical"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e6850a5e34ff---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----e6850a5e34ff---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e6850a5e34ff---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----e6850a5e34ff---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6850a5e34ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&user=Rodrigo+Bressan&userId=8207f4a47f0b&source=-----e6850a5e34ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6850a5e34ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&user=Rodrigo+Bressan&userId=8207f4a47f0b&source=-----e6850a5e34ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6850a5e34ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe6850a5e34ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e6850a5e34ff---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e6850a5e34ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bressan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bressan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rodrigo Bressan"}, {"url": "https://medium.com/@bressan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "159 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8207f4a47f0b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&user=Rodrigo+Bressan&userId=8207f4a47f0b&source=post_page-8207f4a47f0b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5bc4c4c17a28&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenhancing-categorical-features-with-entity-embeddings-e6850a5e34ff&newsletterV3=8207f4a47f0b&newsletterV3Id=5bc4c4c17a28&user=Rodrigo+Bressan&userId=8207f4a47f0b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}