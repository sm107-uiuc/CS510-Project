{"url": "https://towardsdatascience.com/systematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2", "time": 1683014192.431178, "path": "towardsdatascience.com/systematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2/", "webpage": {"metadata": {"title": "How Many Neurons Should Your Neural Network Have? | Towards Data Science", "h1": "How Many Neurons Should Your Neural Network Have?", "description": "Have you ever wondered if there is a more systematic way of tuning your model, rather than blindly guessing the hyperparameters or using a grid search? As data scientists, we often face a lot of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification", "anchor_text": "make_classification", "paragraph_index": 8}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 9}, {"url": "https://github.com/sebastianpoliak/Bias-and-Variance-Medium-Post", "anchor_text": "GitHub", "paragraph_index": 27}, {"url": "https://www.deeplearning.ai/machine-learning-yearning/", "anchor_text": "Machine Learning Yearning", "paragraph_index": 28}], "all_paragraphs": ["As data scientists, we often face a lot of decisions when building a model, such as which model to use, how big it should be, how much data is needed, how many features to add or whether to use or not use regularization. While some decisions can be evaluated relatively quickly, others such as gathering more data may take months, just to find out that it did not help.", "In this article, I would like to practically demonstrate an approach of making these decisions based on looking at bias and variance, which changed the way I proceed in almost every project.", "What many people do wrong when tuning their models, is they look solely on their validation error. While this is in the end the most important number (except for test error), looking simultaneously at the training error might give you several hints of where to go with your model.", "There might be a different and more formal definitions of bias and variance, but what it practically comes to is that:", "Bias is an error rate on your training set (1-training accuracy)", "Variance is a rate of how much worse is the model on validation set compared to training set (training accuracy-validation accuracy)", "I will demonstrate the importance of these concepts with a practical example.", "Let\u2019s first create a dataset that we will use to train and evaluate our models.", "I will do that using sklearn\u2019s make_classification, and afterwards split the dataset into training and validation set.", "Next, we will start off by creating a relatively small Neural Network using Keras, and training it on our dataset.", "The trained model gets the following result:", "We can see that our model has a very high bias, while having a relatively small variance. This state is commonly known as underfitting.", "There are several methods to reduce bias, and get us out of this state:", "Let\u2019s try the method of increasing model\u2019s size to reduce bias, and see what will happen.", "In order to do that, I increased the number of neurons in every hidden layer.", "Our bigger model gets the following result:", "As you can see, we have successfully reduced the model\u2019s bias. Actually, we have completely eliminated it, however, the variance has increased now. This state is commonly known as overfitting.", "The methods to reduce variance of the model are:", "Let\u2019s this time try to reduce variance by introducing some regularization to our model.", "I added the regularization to every layer in a form of Dropout (randomly ignoring a set of neurons during training).", "The result of our new model is:", "Perfect! We are now very close to an optimal state with relatively low bias as well as relatively low variance, which is exactly what we were aiming for. If we now look at our validation error (1-validation accuracy or bias+variance), it is the lowest it has been so far.", "Maybe you have noticed that in the last scenario, the bias has increased a bit again, compared to the scenario #2. You can also see that the methods for reducing bias and reducing variance are the exact opposites. This property is called Bias\u2013Variance Tradeoff, and is demonstrated in the following graph:", "Basically, we are trying find a balance between bias and variance, that minimizes the total error.", "We went through 3 different scenarios of tuning the model based on bias and variance, and the corresponding steps that could be taken.", "There potentially exists a 4th scenario of having both high bias and high variance, which has not been covered. However, this usually means that there is something wrong with your data (training and validation distribution mismatch, noisy data etc.), and therefore, it is difficult to give you an exact guideline.", "I hope that this approach will help you with prioritizing tasks in your projects, and in the end save you some time.", "All the code that I used can be found on GitHub.", "Inspired by Machine Learning Yearning by Andrew Ng.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer at Bloomreach | Exploring concepts with reproducible experiments."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4986662315b2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4986662315b2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4986662315b2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sebastianpoliak.medium.com/?source=post_page-----4986662315b2--------------------------------", "anchor_text": ""}, {"url": "https://sebastianpoliak.medium.com/?source=post_page-----4986662315b2--------------------------------", "anchor_text": "Sebastian Poliak"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7ef3d5041acc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&user=Sebastian+Poliak&userId=7ef3d5041acc&source=post_page-7ef3d5041acc----4986662315b2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4986662315b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4986662315b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@valentinsalja?utm_source=medium&utm_medium=referral", "anchor_text": "Valentin Salja"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification", "anchor_text": "make_classification"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://github.com/sebastianpoliak/Bias-and-Variance-Medium-Post", "anchor_text": "GitHub"}, {"url": "https://www.deeplearning.ai/machine-learning-yearning/", "anchor_text": "Machine Learning Yearning"}, {"url": "https://towardsdatascience.com/how-much-time-can-you-save-with-active-learning-b4886f5da462", "anchor_text": "How Much Time Can You Save With Active Learning?A hands-on experiment on an NLP dataset.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/zero-shot-learning-the-alphabetic-characters-an-experiment-with-code-d1a0f23f4b4c", "anchor_text": "Zero-Shot Learning the Alphabetic Characters (an experiment with code)Is it possible to recognise alphabetic characters, which have not been provided during training?towardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4986662315b2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4986662315b2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/coding?source=post_page-----4986662315b2---------------coding-----------------", "anchor_text": "Coding"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4986662315b2---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----4986662315b2---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4986662315b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&user=Sebastian+Poliak&userId=7ef3d5041acc&source=-----4986662315b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4986662315b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&user=Sebastian+Poliak&userId=7ef3d5041acc&source=-----4986662315b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4986662315b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4986662315b2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4986662315b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4986662315b2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4986662315b2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4986662315b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4986662315b2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4986662315b2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4986662315b2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4986662315b2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4986662315b2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4986662315b2--------------------------------", "anchor_text": ""}, {"url": "https://sebastianpoliak.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sebastianpoliak.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sebastian Poliak"}, {"url": "https://sebastianpoliak.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "47 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7ef3d5041acc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&user=Sebastian+Poliak&userId=7ef3d5041acc&source=post_page-7ef3d5041acc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F721257ed7d11&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2&newsletterV3=7ef3d5041acc&newsletterV3Id=721257ed7d11&user=Sebastian+Poliak&userId=7ef3d5041acc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}