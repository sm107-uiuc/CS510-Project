{"url": "https://towardsdatascience.com/boost-your-image-classifier-e1cc7a56b59c", "time": 1682996202.506523, "path": "towardsdatascience.com/boost-your-image-classifier-e1cc7a56b59c/", "webpage": {"metadata": {"title": "Improve your Deep Learning model | Towards Data Science", "h1": "Boost your Image Classification Model", "description": "Boost your image classification model by applying tricks such as progressive resizing, proper weight initialization, tuning learning rate, using gans for data duplication, cleaning the dataset, test time augmentation, & ensembling the models."}, "outgoing_paragraph_urls": [{"url": "https://datahack.analyticsvidhya.com/contest/practice-problem-intel-scene-classification-challe/", "anchor_text": "Intel Scene Classification Challenge hosted by Analytics Vidhya", "paragraph_index": 0}, {"url": "https://github.com/CSAILVision/places365", "anchor_text": "pytorch weights", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1710.09412", "anchor_text": "paper", "paragraph_index": 8}, {"url": "https://github.com/fastai/course-v3/blob/master/nbs/dl1/lesson7-wgan.ipynb", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://arxiv.org/pdf/1512.03385.pdf", "anchor_text": "ResNet", "paragraph_index": 19}], "all_paragraphs": ["Image classification is assumed to be a nearly solved problem. Fun part is when you have to use all your cunning to gain that extra 1% accuracy. I came across such a situation, when I participated in Intel Scene Classification Challenge hosted by Analytics Vidhya. I thoroughly enjoyed the contest as I tried to extract out all the juices from my deep learning model. The techniques below can in general be applied to any image classification problem at hand.", "The problem was to classify a given image into 6 categories", "We were given ~25K images from a wide range of natural scenes from all around the world", "It is the technique to sequentially resize all the images while training the CNNs on smaller to bigger image sizes. Progressive Resizing is described briefly in his terrific fastai course, \u201cPractical Deep Learning for Coders\u201d. A great way to use this technique is to train a model with smaller image size say 64x64, then use the weights of this model to train another model on images of size 128x128 and so on. Each larger-scale model incorporates the previous smaller-scale model layers and weights in its architecture.", "The fastai library is a powerful deep learning library. If the FastAI team finds a particularly interesting paper, they test it out on different datasets & work out how to tune it. Once successful, it gets incorporated in their library, and is readily available for its users. The library contains many State of the art (SOTA)techniques built in. Built on type of pytorch, fastai has excellent default parameters for most if not all the tasks. Some of the techniques are", "While checking out standard datasets available, I stumbled across Places365 dataset. The Places365 dataset contains 1.8 million images from 365 scene categories. The dataset provided in the challenge was very similar to this dataset, so the model trained on this dataset will already have learned features that are relevant to our own classification problem. As, the categories in our problem, was a subset of Places365 dataset, I used a ResNet50 model initialised with places365 weights.", "The model weights were available as pytorch weights. The below utility function helped us load the data properly into fastai\u2019s CNN Learner.", "Mixup augmentation is a type of augmentation where in we form a new image through weighted linear interpolation of two existing images. We take two images and do a linear combination of them in terms of tensors of those images.", "\u03bb is randomly sampled from the beta distribution. Even though the authors of the paper suggest using \u03bb=0.4, the default value in the fastai library is set to 0.1", "Learning rate is one of the most important hyper-parameter for training neural networks. fastai has a method to find out an appropriate initial learning rate. This technique is called cyclical learning rate, wherein we run a trial with a lower learning rate & increase it exponentially, recording the loss along the way. We then plot the loss against learning rate & choose the learning rate where the loss is the steepest.", "The library also handles Stochastic Gradient Descent with Restart (SGDR) for us automatically. In SGDR, the learning rate is reset at the start of each epoch to the original chosen value which decreases over the epoch as in Cosine Annealing. The main benefit of this, is that since the learning rate is reset at start of each epoch, the learner is capable of jumping out of a local minima or a saddle point it may be stuck in.", "GANs were introduced by Ian Goodfellow in 2014. GANs are deep neural net architectures comprised of two nets, pitting one against the other. GANs can mimic any distribution of data. They can learn to generate data similar to the original data in any domain-images, speech, text, etc. We used fast.ai\u2019s Wasserstein GAN implementation to generate more training images.", "GANs involve training two neural networks, one called the generator, which generates new data instances, while the other, the discriminator, evaluates them for authenticity, it decides whether each instance of data belongs to the actual training dataset or not. You can refer more about it here.", "The first step to training a neural net is to not touch any neural net code at all and instead begin by thoroughly inspecting your data. This step is critical. I like to spend copious amount of time (measured in units of hours) scanning through thousands of examples, understanding their distribution and looking for patterns.", "As Andrej Karpathy states \u201cData Investigation\u201d is an important step. Upon data investigation, I found that there were some images which contained 2 or more classes.", "Using a previously trained model, I ran prediction on the entire training data. Then discarded those images whose predictions were incorrect but the probability score was more than 0.9. These were the images, that the model clearly misclassified. Going deep into it, I found that those images were mislabelled by the labeller.", "I also removed those images from the training set, for whom the prediction probability was in the range 0.5 to 0.6, the theory being that there might be more than 1 class present in the image, so the model assigned somewhat equal probabilities to each one of them. Upon viewing those images, the theory turned out to be true in the end", "fast.ai provides a handy widget \u201cImage Cleaner Widget\u201d that allows you to clean and prepare your data for your model. ImageCleaner is for cleaning up images that don\u2019t belong in your dataset. It renders images in a row and gives you the opportunity to delete the file from your file system.", "Test Time Augmentation involves taking a series of different versions of the original image and passing them through the model. The average output is then calculated from the different versions and given as the final output for the image.", "A similar technique called 10-crop testing was used previously. I first read about 10-crop technique in ResNet paper. The 10-crop technique involves cropping the original image along the four corners and once along the centre giving 5 images. Repeating the same for the it\u2019s inverse, gives another 5 images, a total of 10 images. Test time augmentation is however faster then 10-crop technique", "Ensembling in machine learning is the technique of using multiple learning algorithms to obtain better predictive performance then that could be achieved by a single algorithm. Ensembling works best", "In this case, I ensembled the prediction from all the models by picking the maximum occuring class. In case there\u2019s more than one class having maximum occurence, I randomly pick one of the classes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe1cc7a56b59c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@adi_myth?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adi_myth?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": "Aditya Mishra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2032f51ea1f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&user=Aditya+Mishra&userId=2032f51ea1f9&source=post_page-2032f51ea1f9----e1cc7a56b59c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1cc7a56b59c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1cc7a56b59c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://datahack.analyticsvidhya.com/contest/practice-problem-intel-scene-classification-challe/", "anchor_text": "Intel Scene Classification Challenge hosted by Analytics Vidhya"}, {"url": "https://github.com/CSAILVision/places365", "anchor_text": "pytorch weights"}, {"url": "https://arxiv.org/abs/1710.09412", "anchor_text": "paper"}, {"url": "https://github.com/fastai/course-v3/blob/master/nbs/dl1/lesson7-wgan.ipynb", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1512.03385.pdf", "anchor_text": "ResNet"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e1cc7a56b59c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e1cc7a56b59c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/fastai?source=post_page-----e1cc7a56b59c---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----e1cc7a56b59c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----e1cc7a56b59c---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe1cc7a56b59c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&user=Aditya+Mishra&userId=2032f51ea1f9&source=-----e1cc7a56b59c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe1cc7a56b59c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&user=Aditya+Mishra&userId=2032f51ea1f9&source=-----e1cc7a56b59c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1cc7a56b59c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe1cc7a56b59c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e1cc7a56b59c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e1cc7a56b59c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adi_myth?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adi_myth?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aditya Mishra"}, {"url": "https://medium.com/@adi_myth/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "221 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2032f51ea1f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&user=Aditya+Mishra&userId=2032f51ea1f9&source=post_page-2032f51ea1f9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7e0b06835c21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-image-classifier-e1cc7a56b59c&newsletterV3=2032f51ea1f9&newsletterV3Id=7e0b06835c21&user=Aditya+Mishra&userId=2032f51ea1f9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}