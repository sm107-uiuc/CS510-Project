{"url": "https://towardsdatascience.com/bayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1", "time": 1682999793.717574, "path": "towardsdatascience.com/bayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1/", "webpage": {"metadata": {"title": "Bayesian Basketball : was Toronto really the best team during NBA 2019 season ? | by Benjamin Etienne | Towards Data Science", "h1": "Bayesian Basketball : was Toronto really the best team during NBA 2019 season ?", "description": "[This article was inspired by the work of Baio and Blangiardo (2010), Daniel Weitzenfeld\u2019s great blog article, and Peadar Coyle\u2019s tutorial on Hierarchical models.] Bayesian simulation relies heavily\u2026"}, "outgoing_paragraph_urls": [{"url": "http://danielweitzenfeld.github.io/passtheroc/blog/2014/10/28/bayes-premier-league/", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://docs.pymc.io/notebooks/rugby_analytics.html", "anchor_text": "tutorial", "paragraph_index": 0}, {"url": "https://www.basketball-reference.com/", "anchor_text": "https://www.basketball-reference.com", "paragraph_index": 6}, {"url": "http://discovery.ucl.ac.uk/16040/1/16040.pdf", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://twiecki.io/blog/2015/11/10/mcmc-sampling/", "anchor_text": "article", "paragraph_index": 12}], "all_paragraphs": ["[This article was inspired by the work of Baio and Blangiardo (2010), Daniel Weitzenfeld\u2019s great blog article, and Peadar Coyle\u2019s tutorial on Hierarchical models.]", "Bayesian simulation relies heavily on statistical distributions to model outcomes and therefore serves as a tool for simulating scenarios. At its base lies Bayes\u2019 theorem. Bayes\u2019 formula contains 4 parts : the posterior, the prior, the likelihood, and the evidence. Going into the details of each of it is not the goal of this article, but just keep in mind that the process is the following : starting from a prior distribution which we think models the phenomenon we observe (think \u201ctoss a coin\u201d), we gather data (the likelihood), and use this data to update our prior belief about our distribution and turn it into a posterior distribution.", "Why is it appropriate for our case study ?", "We want to estimate the strength of each team and be able to run simulations with these informations. The only information we have access to are the scores. We do not know the strength of each team beforehand (ie we say that this is a latent variable), but we know that if we have access to a team\u2019s strength, we can pick another team and compare their strengths to see which one will win the confrontation. Last but not least, to estimate a team\u2019s strength, we use scores, but this data can be noisy : it might not reveal the true strength of a team at a given moment, for example if its best player was injured, etc.Hopefully, Bayes comes to our rescue because Bayesian simulations allow us to:", "Now you\u2019re convinced that a Bayesian simulation is what we need, we are going to take a step back in time and go back to April 12th, 2019. The regular season has just ended, and playoffs will start tomorrow. Each of the 30 NBA league teams have played 82 games. This data is what we need to build our Bayesian model in order to estimate each teams\u2019 strengths.", "Once we have each team\u2019s strengths, we will simulate several playoffs scenarios and see which team wins in the end. Ready ?", "The data was collected from the website https://www.basketball-reference.com, where you can get all the results of the 2019 season. We store everything inside a DataFrame and make sure we only keep the regular season\u2019s games.", "We then map all of our teams to a unique id :", "The model is taken from Baio and Blangiardo (paper here). It is a simple log-linear model which allows to model any game opposing two teams. Here is how it works :", "Now we have our model to link the observed scores with Poisson and therefore \u03f4, we have to model the att and def parts of the equation. In our case, we believe that the attack strength att and defense strength def should be, on average, zero. Strong teams will have values above zero, weak teams below zero. Furthermore, we have no a priori belief on att and def, so we will use a Normal prior with a mean taken from a hyper-prior allowing for values close to zero (in cour case, a highly skewed Normal around zero). For the standard deviation of the Normal priors, we will use a hyper-prior which allows for small positive values of std dev (in our case, it\u2019s a Gamma distribution).", "The circles at the top, mu and tau, are our hyper-priors. This model is called a Hierarchical Bayesian Model.", "Notice how we\u2019ve ignored the \u201chome\u201d parameter in the equation and how we\u2019ve added the \u201cintercept\u201d parameter.", "PyMC3 uses Monte-Carlo Markov Chain for finding the right distributions for our model. Explaining MCMC is beyond the scope of this article, but I can recommend this excellent article by Thomas Wiecki (one of the main contributors of PyMC3) if you want to know more about it.", "After running the MCMC sampler, we visually inspect our distributions. If the distributions of a given variable overlap, this is good sign and shows the MCMC has converged to a stable solution. Another way of checking convergence is by looking at the traces of the right hand side of the graph and see if the traces look like white noise (ie no change in trend, no change in amplitude).", "See how the distributions for each variable overlap ? Of course there are other ways of checking convergence, one of them being the R-hat statistic. You can see it by plotting a forestplot of a given parameter:", "The R-hat is 1 in all cases, that\u2019s a sign our algorithm has converged. Based on these graphs, we can see which teams have the best attacks and best defenses (Careful: signs are reversed for defense ! A good defense has a negative score !):", "Let\u2019s wrap this up on a scatterplot (for better readability, I reversed the sign of defenses : good defense = positive score):", "Red labels : the teams which qualified for playoffs. Blue dots: Western conferenceGreen dots: Eastern conference.", "Intermediate conclusion : Based on the above graph, Milwaukee seems to have the strongest attack, altogether with an \u201caverage\u201d defense. The Toronto Raptors have a significantly lower attack strenght, with a slightly higher defense strength.", "Now we have an attack and a defense strength distribution for each team, we can simulate games ! If I sample from those distributions, I can compute", "Comparing score_A vs score_B allows me to get the winner !", "Based of the regular season results (remember, we are currently on April 12th !), here\u2019s what I see:", "I know, based on these rankings, that the 1st round of playoffs will be :", "Here is the process of one scenario:", "And here is what we get if we run 1000 playoffs simulations :", "Milwaukee wins the title in more than 25% of the cases ! In more than 15% of the times, Toronto would win. Golden Stats comes 3rd with a frequence of wins around 15%", "The data is slightly biased during the regular season due to the imbalance between Divisions. As a consequence, it is likely that Milwaukee comes from a \u201cweak\u201d Division, therefore getting overestimated attack and defense strengths. Similarly, Toronto\u2019s division is much more balanced in terms of strengths, thus getting underestimated. Let\u2019s compare Milwaukee\u2019s Division with Toronto\u2019s :", "I hope you had fun revisiting the NBA 2019 Playoffs. Feel free to share any thoughts on the results, and how you would incorporate a \u201cDivision\u201d effect in our model to account for the unequal Division levels !", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe524a26b43a1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@benjamin_47408?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@benjamin_47408?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": "Benjamin Etienne"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc030ffbca30f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&user=Benjamin+Etienne&userId=c030ffbca30f&source=post_page-c030ffbca30f----e524a26b43a1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe524a26b43a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe524a26b43a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markusspiske?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Spiske"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://danielweitzenfeld.github.io/passtheroc/blog/2014/10/28/bayes-premier-league/", "anchor_text": "article"}, {"url": "https://docs.pymc.io/notebooks/rugby_analytics.html", "anchor_text": "tutorial"}, {"url": "https://www.basketball-reference.com/", "anchor_text": "https://www.basketball-reference.com"}, {"url": "http://discovery.ucl.ac.uk/16040/1/16040.pdf", "anchor_text": "here"}, {"url": "https://twiecki.io/blog/2015/11/10/mcmc-sampling/", "anchor_text": "article"}, {"url": "https://medium.com/tag/sports?source=post_page-----e524a26b43a1---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/bayesian-machine-learning?source=post_page-----e524a26b43a1---------------bayesian_machine_learning-----------------", "anchor_text": "Bayesian Machine Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e524a26b43a1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----e524a26b43a1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe524a26b43a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&user=Benjamin+Etienne&userId=c030ffbca30f&source=-----e524a26b43a1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe524a26b43a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&user=Benjamin+Etienne&userId=c030ffbca30f&source=-----e524a26b43a1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe524a26b43a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe524a26b43a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e524a26b43a1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e524a26b43a1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e524a26b43a1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e524a26b43a1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e524a26b43a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@benjamin_47408?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@benjamin_47408?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Benjamin Etienne"}, {"url": "https://medium.com/@benjamin_47408/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "538 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc030ffbca30f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&user=Benjamin+Etienne&userId=c030ffbca30f&source=post_page-c030ffbca30f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faf22c8c6b69c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1&newsletterV3=c030ffbca30f&newsletterV3Id=af22c8c6b69c&user=Benjamin+Etienne&userId=c030ffbca30f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}