{"url": "https://towardsdatascience.com/open-cv-based-sudoku-solver-powered-by-rust-df256653d5b3", "time": 1683007295.6637068, "path": "towardsdatascience.com/open-cv-based-sudoku-solver-powered-by-rust-df256653d5b3/", "webpage": {"metadata": {"title": "Open-CV Based Sudoku Solver Powered By Rust | by PRAKHAR KAUSHIK | Towards Data Science", "h1": "Open-CV Based Sudoku Solver Powered By Rust", "description": "Okay so one day browsing through Reddit, I came across a project, It was a sudoku solver using video cam stream. The project was cool, but there was the only thing I didn\u2019t like: it used to crop the\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Okay so one day browsing through Reddit, I came across a project, It was a sudoku solver using video cam stream. The project was cool, but there was the only thing I didn\u2019t like: it used to crop the sudoku image and give a solved sudoku image solution.", "So I thought why not project back the solution to the original image to make it look like it's solved in the original image?", "The project is simple, take the sudoku image, solve it and project back the solution to the original image, thats all!!", "Well, that was my initial plan, but the execution is another thing.", "Well we can solve the sudoku using Python but for some reason, I wanted to try adding Rust to python, also its faster than python in solving the sudoku.", "If you find it interesting, let's start!!", "After this section, we will be converting the full image to cropped sudoku image.", "Okay, so let's see each step one by one!", "First of all, contour is basically any closed shape", "we will be using opencv library, the steps are:", "After this, we will be having the biggest contour which most probably is the sudoku box.", "As this just gives the outline of the shape, we can\u2019t use it to get the sudoku box, we need the four corner points to change perspective.", "Hence we will be first drawing this contour on a blank image and then draw straight lines on this shape, it will give us four lines which will be later used to get the four corner points.", "After this, we will have lines along the sudoku sides but the thing is, there are multiple lines along a single side because the Houghlines uses roughly inline points to draw a line and as our image is not very clear nor is the correct perspective hence what we get is multiple lines along a single side.", "So what we will be doing is we will eliminate all lines which are close to each other, but leave one hence we will be left with 4 lines for 4 sides.", "So now we have 4 lines, what\u2019s left is to get the intersection points of these lines.", "Well as our lines are not parallel hence we will be getting 6 points of intersection. To solve this we will be using the slope of lines, we will divide the lines into 2 categories, horizontal and vertical. And this way we will get only 4 points.", "Note: The lines are not horizontal and vertical, but are just 2 categories.", "Now we have 4 corner points, it\u2019s time to do the magic and get the sudoku image.", "Nothing fancy, we will be using the warpPerspective to change the perspective and get the image.", "This section will be focused on extracting the digits from sudoku image.", "So first is some eroding and dilating to remove the noise.", "Next is to get the contour of digits, and drawing the on a new blank image. After that, it's just drawing the divider lines.", "A clean sudoku image with no noise.", "Next is simple, just iterating through each box and predicting the numbers. The first approach which failed very very miserably was to use a CNN model and training it to predict the numbers. But for some reason, it was only predicting 6 no matter what the input was.", "After some experimenting, I went ahead with the KNN Model.", "The first problem was to create the dataset, Tried kaggle but apparently there are no datasets for simple plain numbers. So I created a script which first writes the digits on an image, adds some Noise and blur to make it realistic and then crop it.", "Then I used another good library Augmentor. It uses the present images and adds random tilts, rotations etc. Hence what I got was 10k images for each number. Pretty cool!! At least for me, I was not able to sleep after doing that masterpiece stuff. Okay after we are done of thinking about it, let's move to train the model.", "Next was easy, just use this model to predict the numbers and creating a new image of a sudoku.", "After everything, what we have is:", "We will be solving sudoku using Rust in this section.", "After our last section, we have numbers in sudoku image, what's left is to code a sudoku solver, in rust and thankfully we can export it into a library which can be imported in python.", "There is a library sudoku which provides a good sudoku solver, so I used it to create a function and wrote Python bindings to import in python, another masterpiece moment lol.", "After this solving the sudoku and creating a solution mask was left.", "And the final solution looked like.", "Great!! Let's move to the next part.", "The final section, it will be focusing on projecting the solution to the original image.", "Once we have solution mapped on a black image, just doing a bitwise not and was enough to remove the black part of the image, and as we had the initial points, changing back the perspective, is also easy", "That's all!! The final image is", "You can find whole source code at!!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Python Developer interested in learning new languages, also an Active Open Source Contributor."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf256653d5b3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----df256653d5b3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df256653d5b3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@pr4k?source=post_page-----df256653d5b3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pr4k?source=post_page-----df256653d5b3--------------------------------", "anchor_text": "PRAKHAR KAUSHIK"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd1db4b63ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&user=PRAKHAR+KAUSHIK&userId=cd1db4b63ce1&source=post_page-cd1db4b63ce1----df256653d5b3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf256653d5b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf256653d5b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rozetsky?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ant Rozetsky"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/pr4k/sudoku-solver", "anchor_text": "pr4k/sudoku-solverSo my aim was to create a project to solve the sudoku puzzle just using the image of it and Augmenting the solution\u2026github.com"}, {"url": "https://medium.com/tag/rust?source=post_page-----df256653d5b3---------------rust-----------------", "anchor_text": "Rust"}, {"url": "https://medium.com/tag/python?source=post_page-----df256653d5b3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/opencv?source=post_page-----df256653d5b3---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/puzzle?source=post_page-----df256653d5b3---------------puzzle-----------------", "anchor_text": "Puzzle"}, {"url": "https://medium.com/tag/science?source=post_page-----df256653d5b3---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf256653d5b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&user=PRAKHAR+KAUSHIK&userId=cd1db4b63ce1&source=-----df256653d5b3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf256653d5b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&user=PRAKHAR+KAUSHIK&userId=cd1db4b63ce1&source=-----df256653d5b3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf256653d5b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df256653d5b3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdf256653d5b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----df256653d5b3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----df256653d5b3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----df256653d5b3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----df256653d5b3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----df256653d5b3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df256653d5b3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df256653d5b3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----df256653d5b3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----df256653d5b3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pr4k?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pr4k?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "PRAKHAR KAUSHIK"}, {"url": "https://medium.com/@pr4k/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "46 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd1db4b63ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&user=PRAKHAR+KAUSHIK&userId=cd1db4b63ce1&source=post_page-cd1db4b63ce1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Facea7e156792&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-cv-based-sudoku-solver-powered-by-rust-df256653d5b3&newsletterV3=cd1db4b63ce1&newsletterV3Id=acea7e156792&user=PRAKHAR+KAUSHIK&userId=cd1db4b63ce1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}