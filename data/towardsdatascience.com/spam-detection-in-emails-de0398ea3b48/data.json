{"url": "https://towardsdatascience.com/spam-detection-in-emails-de0398ea3b48", "time": 1683013419.888719, "path": "towardsdatascience.com/spam-detection-in-emails-de0398ea3b48/", "webpage": {"metadata": {"title": "Detecting Spam in Emails. Applying NLP and Deep Learning for Spam\u2026 | by Ramya Vidiyala | Towards Data Science", "h1": "Detecting Spam in Emails", "description": "Have you ever wondered how a machine translates language? Or how voice assistants respond to questions? Or how mail gets automatically classified into spam or not spam? All these tasks are done\u2026"}, "outgoing_paragraph_urls": [{"url": "http://archive.ics.uci.edu/ml/datasets/Spambase/", "anchor_text": "Spambase dataset", "paragraph_index": 6}, {"url": "http://archive.ics.uci.edu/ml/datasets/Spambase/", "anchor_text": "UCI machine learning repository", "paragraph_index": 42}, {"url": "https://github.com/RamyaVidiyala/SpamDetectionInEmails", "anchor_text": "Github", "paragraph_index": 42}, {"url": "https://lionbridge.ai/articles/using-natural-language-processing-for-spam-detection-in-emails/", "anchor_text": "Lionbridge.ai", "paragraph_index": 42}, {"url": "https://medium.com/@ramyavidiyala", "anchor_text": "Medium", "paragraph_index": 43}, {"url": "https://twitter.com/ramya_vidiyala", "anchor_text": "ramya_vidiyala", "paragraph_index": 43}, {"url": "https://www.linkedin.com/in/ramya-vidiyala-308ba6139/", "anchor_text": "RamyaVidiyala", "paragraph_index": 43}, {"url": "https://www.linkedin.com/in/ramya-vidiyala/", "anchor_text": "https://www.linkedin.com/in/ramya-vidiyala/", "paragraph_index": 45}], "all_paragraphs": ["Have you ever wondered how a machine translates language? Or how voice assistants respond to questions? Or how mail gets automatically classified into spam or not spam?", "All these tasks are done through Natural Language Processing (NLP), which processes text into useful insights that can be applied to future data. In the field of artificial intelligence, NLP is one of the most complex areas of research due to the fact that text data is contextual. It needs modification to make it machine-interpretable and requires multiple stages of processing for feature extraction.", "Classification problems can be broadly split into two categories: binary classification problems, and multi-class classification problems. Binary classification means there are only two possible label classes, e.g. a patient\u2019s condition is cancerous or it isn\u2019t, or a financial transaction is fraudulent or it is not. Multi-class classification refers to cases where there are more than two label classes. An example of this is classifying the sentiment of a movie review into positive, negative, or neutral.", "There are many types of NLP problems, and one of the most common types is the classification of strings. Examples of this include the classification of movies/news articles into different genres and the automated classification of emails into a spam or not spam. I\u2019ll be looking into this last example in more detail for this article.", "Understanding the problem is a crucial first step in solving any machine learning problem. In this article, we will explore and understand the process of classifying emails as spam or not spam. This is called Spam Detection, and it is a binary classification problem.", "The reason to do this is simple: by detecting unsolicited and unwanted emails, we can prevent spam messages from creeping into the user\u2019s inbox, thereby improving user experience.", "Let\u2019s start with our spam detection data. We\u2019ll be using the open-source Spambase dataset from the UCI machine learning repository, a dataset that contains 5569 emails, of which 745 are spam.", "The target variable for this dataset is \u2018spam\u2019 in which a spam email is mapped to 1 and anything else is mapped to 0. The target variable can be thought of as what you are trying to predict. In machine learning problems, the value of this variable will be modeled and predicted by other variables.", "A snapshot of the data is presented in figure 1.", "Task: To classify an email into the spam or not spam.", "To get to our solution we need to understand the four processing concepts below. Please note that the concepts discussed here can also be applied to other text classification problems.", "Data usually comes from a variety of sources and often in different formats. For this reason, transforming your raw data is essential. However, this transformation is not a simple process, as text data often contain redundant and repetitive words. This means that processing the text data is the first step in our solution.", "The fundamental steps involved in text preprocessing are", "A. Cleaning the raw dataB. Tokenizing the cleaned data", "This phase involves the deletion of words or characters that do not add value to the meaning of the text. Some of the standard cleaning steps are listed below:", "Lowering the case of text is essential for the following reasons:", "This is another text processing technique that will help to treat words like \u2018hurray\u2019 and \u2018hurray!\u2019 in the same way.", "Stopwords are commonly occurring words in a language like \u2018the\u2019, \u2018a\u2019, and so on. Most of the time they can be removed from the text because they don\u2019t provide valuable information.", "Next, we remove any URLs in the data. There is a good chance that email will have some URLs in it. We don\u2019t need them for our further analysis as they do not add any value to the results.", "For more details on text preprocessing techniques, check out the article below.", "Tokenization is the process of splitting text into smaller chunks, called tokens. Each token is an input to the machine learning algorithm as a feature.", "keras.preprocessing.text.Tokenizer is a utility function that tokenizes a text into tokens while keeping only the words that occur the most in the text corpus. When we tokenize the text, we end up with a massive dictionary of words, and they won\u2019t all be essential. We can set \u2018max_features\u2019 to select the top frequent words that we want to consider.", "Making the tokens for all emails an equal size is called padding.", "We send input in batches of data points. Information might be lost when inputs are of different sizes. So, we make them the same size using padding, and that eases batch updates.", "The length of all tokenized emails post-padding is set using \u2018max_len\u2019.", "The model will expect the target variable as a number and not a string. We can use a Label encoder from sklearn, to convert our target variable as below.", "A movie consists of a sequence of scenes. When we watch a particular scene, we don\u2019t try to understand it in isolation, but rather in connection with previous scenes. In a similar fashion, a machine learning model has to understand the text by utilizing already-learned text, just like in a human neural network.", "In traditional machine learning models, we cannot store a model\u2019s previous stages. However, Recurrent Neural Networks (commonly called RNN) can do this for us. Let\u2019s take a closer look at RNNs below.", "An RNN has a repeating module that takes input from the previous stage and gives its output as input to the next stage. However, in RNNs we can only retain information from the most recent stage. To learn long-term dependencies, our network needs memorization power. Here\u2019s where Long Short Term Memory Networks (LSTMs) come to the rescue.", "LSTMs are a special case of RNNs, They have the same chain-like structure as RNNs, but with a different repeating module structure.", "To perform LSTM even in reverse order, we\u2019ll use a Bi-directional LSTM.", "Text data can be easily interpreted by humans. But for machines, reading and analyzing is a very complex task. To accomplish this task, we need to convert our text into a machine-understandable format.", "Embedding is the process of converting formatted text data into numerical values/vectors which a machine can interpret.", "Through the above, we have successfully fit a bi-directional LSTM model on our email data and detected 125 of 1114 emails as spam.", "Since the percentage of spam in data is often low, Measuring the model\u2019s performance by accuracy alone is not recommended. We need to evaluate it using other performance metrics as well, which we\u2019ll look at below.", "Precision and recall are the two most widely used performance metrics for a classification problem to get a better understanding of the problem. Precision is the fraction of the relevant instances from all the retrieved instances. Precision helps us to understand how useful the results are. The recall is the fraction of relevant instances from all the relevant instances. Recall helps us understand how complete the results are.", "The F1 Score is the harmonic mean of precision and recall.", "For example, consider that a search query results in 30 pages, of which 20 are relevant, but the results fail to display 40 other relevant results. In this case, the precision is 20/30, and recall is 20/60. Therefore, our F1 Score is 4/9.", "Using F1-score as a performance metric for spam detection problems is a good choice.", "A model with an F1 score of 95% is a good-to-go model. Keep in mind, however, that these results are based on the training data we used. When applying a model like this to real-world data, we still need to actively monitor the model\u2019s performance over time. We can also continue to improve the model by responding to results and feedback by doing things like adding features and removing misspelled words.", "In this article, we created a spam detection model by converting text data into vectors, creating a BiLSTM model, and fitting the model with the vectors. We also explored a variety of text processing techniques, text sequencing techniques, and deep learning models, namely RNN, LSTM, BiLSTM.", "The concepts and techniques learned in this article can be applied to a variety of natural language processing problems like building chatbots, text summarization, language translation models.", "If you would like to experiment with the custom dataset yourself, you can download the annotated data on UCI machine learning repository and the code at Github. This article is originally published on Lionbridge.ai.", "Thanks for the read. I am going to write more beginner-friendly posts in the future too. Follow me up on Medium to be informed about them. I welcome feedback and can be reached out on Twitter ramya_vidiyala and LinkedIn RamyaVidiyala. Happy learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in computers and machine learning. Likes to write about it | https://www.linkedin.com/in/ramya-vidiyala/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fde0398ea3b48&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ramyavidiyala.medium.com/?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": "Ramya Vidiyala"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F380da45435d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&user=Ramya+Vidiyala&userId=380da45435d3&source=post_page-380da45435d3----de0398ea3b48---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde0398ea3b48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde0398ea3b48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/illustrations/ransomware-wannacry-malware-2318381/", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "http://archive.ics.uci.edu/ml/datasets/Spambase/", "anchor_text": "Spambase dataset"}, {"url": "https://towardsdatascience.com/a-handbook-to-text-preprocessing-890f73fd28f8", "anchor_text": "A handbook to Text PreprocessingThe first step in Natural Language Processingtowardsdatascience.com"}, {"url": "http://archive.ics.uci.edu/ml/datasets/Spambase/", "anchor_text": "UCI machine learning repository"}, {"url": "https://github.com/RamyaVidiyala/SpamDetectionInEmails", "anchor_text": "Github"}, {"url": "https://lionbridge.ai/articles/using-natural-language-processing-for-spam-detection-in-emails/", "anchor_text": "Lionbridge.ai"}, {"url": "https://medium.com/@ramyavidiyala", "anchor_text": "Medium"}, {"url": "https://twitter.com/ramya_vidiyala", "anchor_text": "ramya_vidiyala"}, {"url": "https://www.linkedin.com/in/ramya-vidiyala-308ba6139/", "anchor_text": "RamyaVidiyala"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----de0398ea3b48---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----de0398ea3b48---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----de0398ea3b48---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----de0398ea3b48---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----de0398ea3b48---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fde0398ea3b48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&user=Ramya+Vidiyala&userId=380da45435d3&source=-----de0398ea3b48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fde0398ea3b48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&user=Ramya+Vidiyala&userId=380da45435d3&source=-----de0398ea3b48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde0398ea3b48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fde0398ea3b48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----de0398ea3b48---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----de0398ea3b48--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----de0398ea3b48--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----de0398ea3b48--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----de0398ea3b48--------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ramya Vidiyala"}, {"url": "https://ramyavidiyala.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "449 Followers"}, {"url": "https://www.linkedin.com/in/ramya-vidiyala/", "anchor_text": "https://www.linkedin.com/in/ramya-vidiyala/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F380da45435d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&user=Ramya+Vidiyala&userId=380da45435d3&source=post_page-380da45435d3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F51c63443de13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-detection-in-emails-de0398ea3b48&newsletterV3=380da45435d3&newsletterV3Id=51c63443de13&user=Ramya+Vidiyala&userId=380da45435d3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}