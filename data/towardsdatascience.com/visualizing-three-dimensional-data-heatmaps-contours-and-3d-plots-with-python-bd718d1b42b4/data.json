{"url": "https://towardsdatascience.com/visualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4", "time": 1683005913.2098281, "path": "towardsdatascience.com/visualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4/", "webpage": {"metadata": {"title": "Visualizing Three-Dimensional Data in Python | Towards Data Science", "h1": "Visualizing Three-Dimensional Data with Python \u2014 Heatmaps, Contours, and 3D Plots", "description": "Tutorial on plotting 3D data in Python for scientific publication for data like micrographs and diffraction patterns"}, "outgoing_paragraph_urls": [{"url": "https://matplotlib.org/tutorials/colors/colormaps.html", "anchor_text": "found here", "paragraph_index": 9}, {"url": "https://github.com/venkatesannaveen/python-science-tutorial", "anchor_text": "Github repository", "paragraph_index": 39}], "all_paragraphs": ["When you are measuring the dependence of a property on multiple independent variables, you now need to plot data in three dimensions. Examples of this typically occur with spatial measurements, where there is an intensity associated with each (x, y) point, like in a rastered microscopy measurement or spatial diffraction pattern. To visualize this data, we have a few options at our disposal \u2014 we will explore creating heatmaps, contour plots (unfilled and filled), and a 3D plot.", "The dataset I will use for this example is a 2 \u00b5m x 2 \u00b5m micrograph from an atomic force microscope (AFM). First, we import packages \u2014 the two new packages we are adding this time are make_axes_locatable, which will help us with managing the colorbar for our plots, and Axes3D, which we need for our 3D plot:", "We will now load our AFM data, again using numpy.loadtxt which will directly load our data into a 2D numpy array.", "We can then inspect a few rows our loaded data:", "We have a 256 x 256 array of points with each value corresponding to the measured height (in meters) at that position. Since we know that our data would be more meaningful if presented in nanometers, we can scale all our values by this constant parameter:", "Now we can go ahead and start visualizing our data. We start with setting some global parameters (edit these as you like, but these are settings I use):", "For the heatmap visualization, we will use the imshow function to display our data as an image. First, we create a figure and add a main axis to show our image. Additionally, we will remove tick marks since we will be adding a scale bar.", "Now we display our image with the following command:", "origin \u2014 images are typically shown with their origin as the top left corner, so by using origin='lower' we force the origin to be a the bottom left", "cmap \u2014 the colormap for our image. All available matplotlib colormaps can be found here, and adding _r to any colormap name will reverse it.", "extent \u2014 imshow will plot our image using pixels unless we tell it what range these pixels correspond to. In this case, we know that our image is 2 \u00b5m x 2 \u00b5m, so we make our extent=(x_min, x_max, y_min, y_max) equal to (0, 2, 0, 2)", "vmin \u2014 the value to set to the minimum of our colormap", "vmax \u2014 the value to set to the maximum of our colormap", "Now, we should add our scale bar, so anyone looking at the plot has an idea of the size scale. We will generate the bar using plt.fill_between to create a filled rectangle, and then add a text label on top.", "y1 \u2014 the bottom y-value (corresponding to values of x) of our filled shape", "y2 \u2014 the top y-value (corresponding to values of x) of our filled shape", "va \u2014 vertical alignment ( bottom means that y corresponds to the bottom of the text)", "ha \u2014 horizontal alignment ( center means that x corresponds to the center of the text)", "Finally, we can add a colorbar to show how colors in our image correspond to height values. First, we create a new axis object for the colorbar, which we do by appending a new axis to the right of our original axis using the make_axes_locatable().append_axes function. We pass our original axes object ax to the function:", "position \u2014 where to append next axes, in this case to the right of the original image", "size \u2014 the size of the new axes along the position direction, relative to the original axes (5% of the image width)", "pad \u2014 the padding (in absolute coordinates) between the two axes", "Now, we turn this new axis object into a colorbar:", "mappable \u2014 the image/plot to map to the colorbar (we created img when we used imshow earlier)", "cax \u2014 the axis to use for the colorbar", "Finally, we adjust the tick marks and labels for the colorbar:", "Just like in a topographical map found at most hiking trails, we can also present three-dimensional data with contour lines of constant intensity. We will now plot the same AFM data using a contour plot.", "We use the same code as before, with the following line changed (I have added zorder=1 to ensure that the contour plot is below the scale bar as lower z-order numbers are drawn first):", "If we use contourf instead of contour, we can create filled contours instead of just contour lines:", "In this case, a lot of the finer details from imshow are not well captured in contour or contourf. If you have fairly smooth data without a lot of smaller details, the contour images may look better than the heatmap. Ultimately, you want to present your data in as transparent and straightforward a manner as possible, so in this case, the heatmap with colorbar is probably best.", "Up to this point, we have limited our plots to two-dimensions and used the color scale to let the reader infer the intensity. If we wanted to give a better sense of these intensity values, we can actually plot our data in 3D.", "We start by creating a 3D axis with the following code, the key here is that we are using projection=\u20193d' when we generate our axis object:", "The gray panes and axis grids add clutter to our plot, so let\u2019s remove them. Additionally, I am going to add the colorbar again for height \u2014 the z-axis will get very compressed because of the perspective view, so I will remove it.", "For the surface plot, we need 2D arrays of x and y values to correspond to the intensity values. We do this by creating a mesh-grid with np.meshgrid \u2014 our inputs to this function are an array of x-values and y-values to repeat in the grid, which we will generate using np.linspace.", "Now that we have our meshgrid, we can plot our 3D data:", "Now, we can adjust the view of plot \u2014 there are three parameters that we control for this: elevation, azimuthal angle (in the x-y plane), and distance from the axes, which roughly correspond to the spherical coordinate system values of \u03c6, \u03b8, and r, respectively. I am setting the azimuthal angle to 225\u02da because we want the x and y axes to meet at (0, 0).", "shrink \u2014 how much to shrink the colorbar relative to its default size", "Finally, we edit some of the aesthetics \u2014 the tick marks on the x and y-axes, axis limits, and the axis labels.", "This plot lets the reader actually see the height fluctuations in addition to using color for intensity values. However, a noisier dataset could lead to a very messy 3D plot.", "I hope this tutorial was helpful is addressing different methods to plot three-dimensional datasets. Examples are available at this Github repository. Thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist \u2022 Materials Scientist \u2022 Musician \u2022 Golfer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbd718d1b42b4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://naveenvenkatesan.medium.com/?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": "Naveen Venkatesan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7779ee5bf58d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=post_page-7779ee5bf58d----bd718d1b42b4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd718d1b42b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd718d1b42b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/python-science-plotting", "anchor_text": "Python Science Plotting"}, {"url": "https://unsplash.com/@usgs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "USGS"}, {"url": "https://unsplash.com/s/photos/microsope-image?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://matplotlib.org/tutorials/colors/colormaps.html", "anchor_text": "found here"}, {"url": "https://github.com/venkatesannaveen/python-science-tutorial", "anchor_text": "Github repository"}, {"url": "https://medium.com/tag/python?source=post_page-----bd718d1b42b4---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----bd718d1b42b4---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/python-science-plotting?source=post_page-----bd718d1b42b4---------------python_science_plotting-----------------", "anchor_text": "Python Science Plotting"}, {"url": "https://medium.com/tag/science-communication?source=post_page-----bd718d1b42b4---------------science_communication-----------------", "anchor_text": "Science Communication"}, {"url": "https://medium.com/tag/matplotlib?source=post_page-----bd718d1b42b4---------------matplotlib-----------------", "anchor_text": "Matplotlib"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbd718d1b42b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=-----bd718d1b42b4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbd718d1b42b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=-----bd718d1b42b4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd718d1b42b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbd718d1b42b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bd718d1b42b4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bd718d1b42b4--------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Naveen Venkatesan"}, {"url": "https://naveenvenkatesan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "487 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7779ee5bf58d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=post_page-7779ee5bf58d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe736f4929535&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-three-dimensional-data-heatmaps-contours-and-3d-plots-with-python-bd718d1b42b4&newsletterV3=7779ee5bf58d&newsletterV3Id=e736f4929535&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}