{"url": "https://towardsdatascience.com/common-machine-learning-programming-errors-in-python-5d76de85e975", "time": 1683002523.406104, "path": "towardsdatascience.com/common-machine-learning-programming-errors-in-python-5d76de85e975/", "webpage": {"metadata": {"title": "Common Machine Learning Programming Errors in Python | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Common Machine Learning Programming Errors in Python", "description": "In this post I will go over some of the most common errors I come across in python during the model building and development process. For demonstration purposes we will use height/weight data which\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mustafaali96/weight-height", "anchor_text": "Kaggle", "paragraph_index": 0}, {"url": "https://github.com/spierre91/medium_code", "anchor_text": "GitHub", "paragraph_index": 27}], "all_paragraphs": ["In this post I will go over some of the most common errors I come across in python during the model building and development process. For demonstration purposes we will use height/weight data which can be found here on Kaggle. The data contains gender, height in inches and weight in pounds.", "The most common errors I have come accross in my experience are the following:", "We will build a simple linear regression model and modify the code to show how the above errors arise in practice.", "First let\u2019s import the data using pandas and print the first five rows:", "As you can see the data set is very simple, with gender, height and weight columns. The next thing we can do is visualize the data using matplotlib and seaborn:", "Looking at the scatter plot of the weight vs height we see that the relationship is linear.", "Next let\u2019s define our input (X) and output (y) and split the data for training and testing:", "We can then define a linear regression model, fit to our training data, make predictions on the test set, and evaluate the performance of the model:", "The first error I\u2019ll discuss is the NameError which occurs if, for example, I forget to import a package. In the following code I have removed \u201cimport numpy as np\u201d :", "If I attempt to run the script with that line of code missing I get the following error:", "I would receive similar messages for leaving out the import statements for seaborn, matplotlib and pandas:", "Another issue is accidentally trying to import a package that doesn\u2019t exist due to misspelling, which results in a ModuleNotFoundError. For example if I misspell \u2018pandas\u2019 as \u2018pandnas\u2019:", "Or if I forgot \u2018pyplot\u2019 in the matplotlib scatterplot import we get an AttributeError:", "Similarly if I forgot the linear_regression and model_selection attributes in the sklearn import, I\u2019ll get an ImportError:", "In terms of reading files, if I misspell the name of the file I get a FileNotFoundError:", "Additionally, if I try to select a column from a pandas data frame that doesn\u2019t exist I get a KeyError :", "If I forget to convert the pandas series for \u201cWeight\u201d and \u201cHeight\u201d into numpy arrays I get a ValueError. This is because sklearn methods only accept numpy arrays. I frequently find myself forgetting this simple step of converting from a pandas series to a numpy array:", "or If I forget to reshape the numpy array into a 2 dimensional array I also get a ValueError:", "Another common cause of a ValueError is when carrying out the train test split. I often forget the order of the X and y arrays:", "Where I switch X_test and y_train:", "which gives the following error upon fitting:", "Finally, when trying to fit a model data corresponding to a specific category or population I often come across the issue of not having enough data. Let\u2019s filter our dataframe to replicate this issue. Let\u2019s filter the data to only include records where the \u2018Weight\u2019 = 241.893563. This will result in exactly one row of data:", "If we try to build our model we get the following error in the line where we split out data::", "And if we try to fit we get the following error::", "Finally, if the data has missing or infinite values the fitting while throw an error. Let\u2019s redefine the weight column with \u2018nan \u2018 (Not a Number) values to generate this error:", "We would get the same error message with infinite values:", "In this post we reviewed different errors that arise when developing models in python. We reviewed errors related to importing packages, reading files, selecting columns and processing data. Having solid knowledge of the different types of errors that arise when developing machine learning models can be useful when productionizing machine learning code. Having this knowledge can prevent errors from occurring as well as inform the logic that can be used to catch these errors when they occur.", "There are many more errors that I come across daily but the errors I\u2019ve listed in this post are most common in my experience. I hope this post was useful. The code from this post is available on GitHub. Thank you for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5d76de85e975&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d76de85e975--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d76de85e975--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----5d76de85e975--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----5d76de85e975--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----5d76de85e975---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d76de85e975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d76de85e975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@markusspiske", "anchor_text": "Markus Spiske"}, {"url": "https://www.pexels.com/photo/working-pattern-internet-abstract-1089438/", "anchor_text": "Pexels"}, {"url": "https://www.kaggle.com/mustafaali96/weight-height", "anchor_text": "Kaggle"}, {"url": "https://github.com/spierre91/medium_code", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5d76de85e975---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----5d76de85e975---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----5d76de85e975---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----5d76de85e975---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5d76de85e975---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d76de85e975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----5d76de85e975---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d76de85e975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----5d76de85e975---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d76de85e975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d76de85e975--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5d76de85e975&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5d76de85e975---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d76de85e975--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5d76de85e975--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5d76de85e975--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5d76de85e975--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5d76de85e975--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5d76de85e975--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5d76de85e975--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5d76de85e975--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-machine-learning-programming-errors-in-python-5d76de85e975&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}