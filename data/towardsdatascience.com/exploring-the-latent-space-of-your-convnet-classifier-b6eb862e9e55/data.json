{"url": "https://towardsdatascience.com/exploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55", "time": 1683014611.432839, "path": "towardsdatascience.com/exploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55/", "webpage": {"metadata": {"title": "Latent Space of Convolutional Neural Nets | Towards Data Science", "h1": "Exploring the Latent Space of a ConvNet Image Classifier", "description": "Linearity in the latent space of hidden layers | Image Classification| Convolutional Neural Networks| GANs | Variational Auto Encoders"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/imaterialist-challenge-fashion-2018", "anchor_text": "iMaterialist Challenge(Fashion)", "paragraph_index": 1}, {"url": "http://thispersondoesnotexist.com", "anchor_text": "website", "paragraph_index": 3}, {"url": "https://smodi93.wixsite.com/msachin/blogs", "anchor_text": "here", "paragraph_index": 16}], "all_paragraphs": ["A fascinating thing about Neural networks, especially Convolutional Neural Networks is that in the final layers of the network where the layers are fully connected, each layer can be treated as a vector space. All the useful and required information that has been extracted from the image by the ConvNet has been stored in a compact version in the final layer in the form of a feature vector. When this final layer is treated as a vector space and is subjected to vector algebra, it starts to yield some very interesting and useful properties.", "I trained a Resnet50 classifier on the iMaterialist Challenge(Fashion) dataset from Kaggle. The challenge here is to classify every apparel image into appropriate attributes like pattern, neckline, sleeve length, style, etc. I used the pre-trained Resnet model and applied transfer learning on this dataset with added layers for each of the labels. Once the model got trained, I wish to look at the vector space of the last layer and search for patterns.", "The last FC layer of the Resnet50 is of length 1000. After transfer learning on the Fashion dataset, I apply PCA on this layer and reduce the dimension to 50 which retains more than 98% of the variance.", "The concept of Latent Space Directions is popular with GANs and Variational Auto Encoders where the input is a vector and the output is an image, it is observed that by translating the input vector in a certain direction, a certain attribute of the output image changes. The below example is from StyleGAN trained by NVIDIA, you can have a look at this website where a fake face gets generated from a random vector every time you refresh the page.", "This is exciting! A trivial linear operation on the input vector brings about such a complex transformation in the output image. These latent directions are like knobs which you can tune to get the desired effect on the output image. Incredible!", "In our image classifier, we are doing exactly the opposite of GAN. In the classifier, we take an image and get a vector of length 1000 in the FC layer, and with the PCA transformation, we reduce its dimension to 50. The idea we want to explore is whether the image attributes we have trained the model for, are they getting arranged in a linear fashion in the vector space of the FC layer and the layer after PCA. The answer is indeed a yes!", "One of the tasks in the iMaterialist challenge is to identify the sleeve length which is classified into five types: long-sleeved, short sleeves, puff sleeves, sleeveless, and strapless. Out of these five, three are in majority: long-sleeved, short sleeves, and sleeveless. Now we want to see if there exists a latent direction along which these three sleeve length classes get segregated. If it was a binary classification, we could have used logistic regression and the vector of coefficients would have given us the latent direction but in our case, we have multiple classes.", "One method to get the latent direction in a multi-class problem is to build a neural network where we force the input layer through a single-unit middle layer and the vector of weights of the input layer gives us the latent direction. The code snippet for this classifier is given below where my input is the PCA layer of length 50 which is passed through a single unit layer and after a few layers, I get my final 5 classes. The idea behind forcing it through a single unit layer is to constraint the network to learn a linear latent direction. The value of this single unit layer essentially gives me the projection of inputs onto the learned latent direction.", "Let's see what we get after training this small classifier!The plot below shows the distribution of different sleeve types along the latent direction, and we can see that the three major classes: short, long, and sleeveless get segregated along this direction.", "Neural networks are complex non-linear models but there is linearity hidden in hidden layers!", "Now I take an image of a dress and starting from the point in the PCA vector space for this image, I draw a line along the latent direction for sleeve length and retrieve images from the training dataset that are closest to this line. Below are a few such examples. An interesting thing to note is that, while the sleeve length changes along the direction from long-sleeved to short sleeves to sleeveless, other features of the dress as the neckline, dress length, and the overall style tend to stay preserved.", "In the second example, all the retrieved images are long dresses and have two poses in an image whereas in the third example most of them don\u2019t have a model. The only significant change along the direction is in the sleeve length.", "From the above results, it looks like the training dataset images have been arranged in a pristine order in the latent space of the PCA layer!", "Doing a similar analysis for pattern gives the following results", "From the above graph, we see that floral type dresses get segregated from more solid type patterns along the latent direction. Looking at a few examples confirms this observation.", "In the above examples, the pattern slowly shifts from solid to stripes to floral to plaid along the discovered direction and the retrieved images tend to be similar to the starting image in terms of the overall style.", "Looking at the latent space of feature vectors is a step forward in our understanding of the workings of Neural Networks. From our above analysis, one conclusion that we can draw is that Convolution Neural Networks take in complex data in form of images and the information extracted from those images gets more and more organized as the input passes through subsequent layers. We find that in the latent space of the last layers of the network our training dataset images get sorted and segregated in an orderly way so much so that we can discover linear directions along which a certain attribute of interest varies.Read more blogs here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist by profession and a science enthusiast | Exploring life"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb6eb862e9e55&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://smodi93.medium.com/?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": ""}, {"url": "https://smodi93.medium.com/?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": "Sachin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c12ba0ce9ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&user=Sachin&userId=3c12ba0ce9ba&source=post_page-3c12ba0ce9ba----b6eb862e9e55---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6eb862e9e55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6eb862e9e55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alirzasahb", "anchor_text": "Alireza"}, {"url": "http://unsplash.com/photos/Bc5LK1XqbCc", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/imaterialist-challenge-fashion-2018", "anchor_text": "iMaterialist Challenge(Fashion)"}, {"url": "http://thispersondoesnotexist.com", "anchor_text": "website"}, {"url": "https://github.com/genforce/interfacegan", "anchor_text": "Interface GAN Github"}, {"url": "http://kaggle.com/c/imaterialist-challenge-furniture-2018/data", "anchor_text": "Kaggle Dataset"}, {"url": "http://kaggle.com/c/imaterialist-challenge-furniture-2018/data", "anchor_text": "Kaggle Dataset"}, {"url": "http://kaggle.com/c/imaterialist-challenge-furniture-2018/data", "anchor_text": "Kaggle Dataset"}, {"url": "http://kaggle.com/c/imaterialist-challenge-furniture-2018/data", "anchor_text": "Kaggle Dataset"}, {"url": "http://kaggle.com/c/imaterialist-challenge-furniture-2018/data", "anchor_text": "Kaggle Dataset"}, {"url": "http://kaggle.com/c/imaterialist-challenge-furniture-2018/data", "anchor_text": "Kaggle Dataset"}, {"url": "https://smodi93.wixsite.com/msachin/blogs", "anchor_text": "here"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----b6eb862e9e55---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b6eb862e9e55---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/classification?source=post_page-----b6eb862e9e55---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b6eb862e9e55---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----b6eb862e9e55---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb6eb862e9e55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&user=Sachin&userId=3c12ba0ce9ba&source=-----b6eb862e9e55---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb6eb862e9e55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&user=Sachin&userId=3c12ba0ce9ba&source=-----b6eb862e9e55---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6eb862e9e55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb6eb862e9e55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b6eb862e9e55---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b6eb862e9e55--------------------------------", "anchor_text": ""}, {"url": "https://smodi93.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://smodi93.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sachin"}, {"url": "https://smodi93.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "92 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c12ba0ce9ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&user=Sachin&userId=3c12ba0ce9ba&source=post_page-3c12ba0ce9ba--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffed5d4632aba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-latent-space-of-your-convnet-classifier-b6eb862e9e55&newsletterV3=3c12ba0ce9ba&newsletterV3Id=fed5d4632aba&user=Sachin&userId=3c12ba0ce9ba&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}