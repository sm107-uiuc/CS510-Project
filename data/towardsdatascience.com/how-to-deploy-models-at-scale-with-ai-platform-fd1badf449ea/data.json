{"url": "https://towardsdatascience.com/how-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea", "time": 1683005591.327152, "path": "towardsdatascience.com/how-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea/", "webpage": {"metadata": {"title": "How to Deploy Models at Scale with AI Platform | by Elsa Scola | Towards Data Science", "h1": "How to Deploy Models at Scale with AI Platform", "description": "Usually, when we all start learning Machine Learning, we find a ton of information about how to build models, which of course is the core of the topic. But there\u2019s an equally important aspect of ML\u2026"}, "outgoing_paragraph_urls": [{"url": "https://console.cloud.google.com", "anchor_text": "Google Cloud Platform", "paragraph_index": 3}, {"url": "https://console.firebase.google.com", "anchor_text": "Firebase Console", "paragraph_index": 7}, {"url": "https://console.cloud.google.com", "anchor_text": "Google Cloud Platform", "paragraph_index": 15}, {"url": "https://nodejs.org/", "anchor_text": "Node.js", "paragraph_index": 22}, {"url": "https://github.com/ElsaScola/sample_cloud_function", "anchor_text": "this GitHub repository", "paragraph_index": 33}, {"url": "https://insomnia.rest/", "anchor_text": "Insomnia", "paragraph_index": 47}, {"url": "http://elsascola.com", "anchor_text": "elsascola.com", "paragraph_index": 57}], "all_paragraphs": ["Usually, when we all start learning Machine Learning, we find a ton of information about how to build models, which of course is the core of the topic. But there\u2019s an equally important aspect of ML that is rarely taught in the academic world of Data Science, and that is how to deploy these models. How can I share this useful thing that I\u2019ve done with the rest of world? Because, at the end of the day\u2026that\u2019s the purpose of our job right? Making people\u2019s lives easier \ud83d\ude0a.", "In this post, we\u2019ll learn how to deploy a machine learning model to the cloud and make it available to the rest of the world as an API.", "We\u2019re going to first store the model in Firebase Storage to deploy it to AI Platform where we can version it and analyse it in production. Finally, we\u2019re going to make our model available through an API with Firebase Cloud Functions.", "AI Platform is a service of Google Cloud Platform (GCP) that makes it easy to manage the whole production and deployment process by not having to worry about maintaining your own infrastructure and making you pay only for usage. This will enable you to scale your product massively for fast growing projects.", "You can try this and many more experiments on your own FOR FREE by making use of GCP\u2019s 12 month, $300 free trial to get you started.", "Essentially, for the purpose of this post, the cloud function will work as an API. We will make the predictions of our model available through a link that any person can make requests to, and receive the response of our model in real time.", "Just for the sake of simplicity, I\u2019m going to assume the model was developed in Python and lives in a Jupyter Notebook. But of course, these steps can be adapted to any other environment.", "First, sign in to the Firebase Console with your Google account and create a new project. Now you\u2019re inside the Firebase Dashboard, go to the project settings > Service accounts > Firebase Admin SDK, (in this case) you select the Python option and click on Generate new private key. This will give the JSON file of your service account that you can save in your notebook\u2019s directory.", "Then, install the Firebase Admin SDK package: pip install firebase-admin", "Once you\u2019ve trained and tested your model it\u2019s ready to upload to AI Platform. But before that, we need to first export and store the model in Firebase Storage, so it can be accessed by AI Platform.", "If you\u2019re using a notebook, create a new cell at the end and add the following script. This will enable the usage of your firebase account:", "Now, to run the following code you\u2019ll need to get the Project ID, which you can find again in your Firebase project settings.", "Once we have our Project ID we upload the model by running the following code (you should first change it with your Project ID).", "Now we can verify that the model has been correctly uploaded by checking in Firebase Storage inside the specified directory (which in our case is model-v1/).", "Now that the model has been stored, it can be connected to AI Platform.", "We need to enable a couple of APIs in Google Cloud Platform. On the left panel, inside the Library section, we look for the APIs \u201cAI Platform Training & Prediction API\u201d and \u201cCloud Build API\u201d and enable them.", "Now, on the left panel we click on AI Platform > models and we Create new model and input the corresponding information.", "Once we\u2019ve created the model it\u2019s time to create a version of it, which will point to the .joblib file that we previously stored. We click on the model > new version and fill the information. It\u2019s important that we choose the same Python version that we used for training the model. We choose scikit-learn as the framework. When specifying its version, we can get it by running the following code in our notebook.", "When choosing the ML Runtime version, you should select the recommended one. The machine type can be left by default for now.", "Finally, we specify the folder in which our .joblib file is located. It\u2019s important to select the folder, not the file! The rest of the fields can be left by default and save. At that moment, an instance of our model will be deployed in AI Platform.", "Now, we\u2019ll be able to make predictions from the command line or from other Google APIs, such as Cloud Function, as we\u2019ll see next. Additionally, we\u2019ll be able to get some performance metrics on our model.", "Let\u2019s see how to implement the function!", "We\u2019re going to run some commands on the terminal, but for that, you\u2019ll need to ensure you have Node.js installed in your computer. The following commands are specific for Windows but you should be able to use them in Unix and Mac OS devices by adding sudo at the beginning of each of the commands.", "Let\u2019s start by installing the Firebase client: $ npm install -g firebase-tools", "We access the Google account: $ firebase login", "Initialize a new project directory (make sure you\u2019re in the directory you want to initialize it in):$ firebase init", "When running this last command you\u2019ll be asked several questions. When asked about the Firebase project that you want in the directory, you have to choose the one that contains the ML model that we previously exported. Select JavaScript as programming language. We don\u2019t use ESLint, so answer no. And finally, answer yes to the installation of dependencies with npm.", "Once the project has been created, the directory will have the following structure:", "Inside this directory, we\u2019ll only modify the index.js and the package.json files.", "We install the packages of the Google API: $ npm i googleapis", "Now we check the packages have been installed correctly by opening the package.json file. In case you want to use any other external package in your code you should also add it in this file with its corresponding version.", "For now, it should have a structure similar to this:", "I\u2019ll briefly explain what they do:", "Now let\u2019s see the implementation of the function (we are editing the index.js file), which you can also find in this GitHub repository. As an example, I\u2019ll be using the code to access a simple fake-account detection model.", "We start by loading the firebase-functions\u200b and \u200bfirebase-admin modules.", "We load the googleapis module and add the reference to the version 1 of ml.", "The requests are going to be sent to an http function.", "We specify the input values of the function. In this example, I\u2019m getting some data about the social media account that my model will use to classify as fake or not. You should specify the fields that you plan to input afterwards to your model.", "After that, we build the input of the model, that is, the input parameters that we\u2019ll send to the model to get the prediction. Note that these inputs should follow the same structure (order of features) with which the model was trained.", "Now, let\u2019s make the request to the Google API, this request needs authentication, which will connect our Firebase credentials with Google API.", "After storing the name of our model in a variable (the name should be the same you gave it in the AI Platform console), we make a prediction call to AI Platform by sending our credentials, the name of the model and the instance that we want the prediction for.", "Once we\u2019ve created the cloud function that accesses the model, we just need to upload it to Firebase to deploy it as an API.", "To upload the Firebase function we run the following command in the terminal: $ firebase deploy --only functions", "Once it has finished loading, a URL is obtained through which the function will be accessible, which can be found by logging into Firestore, in the Functions section, under Request in smaller print.", "And that\u2019s all, now your model is up and running, ready to share! \ud83c\udf89\ud83c\udf89\ud83c\udf89", "You can make requests to this API from a mobile app, a website\u2026it could be integrated anywhere!", "This is, of course, an optional step, if you followed the previous guidelines, your model should be ready to receive requests. However, as a programmer, I like to test things to check everything works fine.", "My favourite way to test APIs is by using Insomnia. Insomnia is a REST API client that lets you test your APIs easily. This free desktop app is available for Windows, MacOS and Ubuntu. Let\u2019s check if our newly made API works properly!", "Once we\u2019ve installed the desktop app we can create a new request.", "We\u2019ll write the request name and choose POST as a method and JSON for its structure.", "Once we\u2019ve created the request, we copy the URL of the cloud function and we paste it in the top bar.", "We will now write the request following the format that we specified in the function, in my case, it\u2019d be like this:", "We now hit SEND and we\u2019ll get the response, as well as the response time and its size. If there were any errors you should also receive the error code instead of the 200 OK message.", "The response that you get will, of course, vary depending on your model. But if everything works fine, then congrats! You\u2019re ready to share your model with the rest of the world! \ud83c\udf0d", "If you made it this far, thank you for your time and I hope you got some value from this post\ud83d\ude0a", "See you in the next one! \ud83d\ude80", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Just sharing some thoughts on what I learn. elsascola.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffd1badf449ea&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@elsascola?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@elsascola?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": "Elsa Scola"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1d6c8f52fb55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&user=Elsa+Scola&userId=1d6c8f52fb55&source=post_page-1d6c8f52fb55----fd1badf449ea---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd1badf449ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd1badf449ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@marius?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Marius Masalar"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://console.cloud.google.com", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.firebase.google.com", "anchor_text": "Firebase Console"}, {"url": "https://console.cloud.google.com", "anchor_text": "Google Cloud Platform"}, {"url": "https://nodejs.org/", "anchor_text": "Node.js"}, {"url": "https://firebase.google.com/docs/functions", "anchor_text": "Cloud Functions"}, {"url": "https://github.com/ElsaScola/sample_cloud_function", "anchor_text": "this GitHub repository"}, {"url": "https://insomnia.rest/", "anchor_text": "Insomnia"}, {"url": "https://medium.com/tag/deployment?source=post_page-----fd1badf449ea---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/tag/ai-platform?source=post_page-----fd1badf449ea---------------ai_platform-----------------", "anchor_text": "Ai Platform"}, {"url": "https://medium.com/tag/firebase?source=post_page-----fd1badf449ea---------------firebase-----------------", "anchor_text": "Firebase"}, {"url": "https://medium.com/tag/firebase-cloud-functions?source=post_page-----fd1badf449ea---------------firebase_cloud_functions-----------------", "anchor_text": "Firebase Cloud Functions"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fd1badf449ea---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffd1badf449ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&user=Elsa+Scola&userId=1d6c8f52fb55&source=-----fd1badf449ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffd1badf449ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&user=Elsa+Scola&userId=1d6c8f52fb55&source=-----fd1badf449ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd1badf449ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffd1badf449ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fd1badf449ea---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fd1badf449ea--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fd1badf449ea--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fd1badf449ea--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fd1badf449ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@elsascola?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@elsascola?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Elsa Scola"}, {"url": "https://medium.com/@elsascola/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "83 Followers"}, {"url": "http://elsascola.com", "anchor_text": "elsascola.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1d6c8f52fb55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&user=Elsa+Scola&userId=1d6c8f52fb55&source=post_page-1d6c8f52fb55--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff56f6477b94f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-models-at-scale-with-ai-platform-fd1badf449ea&newsletterV3=1d6c8f52fb55&newsletterV3Id=f56f6477b94f&user=Elsa+Scola&userId=1d6c8f52fb55&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}