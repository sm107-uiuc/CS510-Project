{"url": "https://towardsdatascience.com/machine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade", "time": 1682994299.150181, "path": "towardsdatascience.com/machine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade/", "webpage": {"metadata": {"title": "Machine Learning and Music Classification: A Content-Based Filtering Approach | by Brian Srebrenik | Towards Data Science", "h1": "Machine Learning and Music Classification: A Content-Based Filtering Approach", "description": "In my previous blog post, Introduction to Music Recommendation and Machine Learning, I discussed the two methods for music recommender systems, Content-Based Filtering and Collaborative Filtering\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@briansrebrenik/introduction-to-music-recommendation-and-machine-learning-310c4841b01d", "anchor_text": "Introduction to Music Recommendation and Machine Learning", "paragraph_index": 0}, {"url": "https://github.com/librosa/librosa", "anchor_text": "Librosa Python library", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Music_information_retrieval", "anchor_text": "field", "paragraph_index": 1}, {"url": "https://github.com/librosa/librosa", "anchor_text": "Librosa Python library", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Mel_scale", "anchor_text": "mel scale", "paragraph_index": 2}, {"url": "https://soundcloud.com/radiohead/weird-fishes-arpeggi", "anchor_text": "Weird Fishes by Radiohead", "paragraph_index": 2}, {"url": "https://librosa.github.io/librosa/index.html", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm", "anchor_text": "K-Nearest Neighbors", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Random_forest", "anchor_text": "Random Forest", "paragraph_index": 18}], "all_paragraphs": ["In my previous blog post, Introduction to Music Recommendation and Machine Learning, I discussed the two methods for music recommender systems, Content-Based Filtering and Collaborative Filtering. The collaborative filtering approach involved recommending music based on user listening history, while the content-based approach used an analysis of the actual features of a piece of music. In this blog post, I will take a more in depth look at the content-based approach, using the Librosa Python library for \u201cMusic Information Retrieval\u201d and trying a few machine learning classification algorithms to classify songs into genres based on their features.", "When I first started looking into the topic of music information retrieval, the process of extracting information about music and its audio content based on audio signal processing, it seemed like quite the daunting task that would require sufficient technical expertise. Well, it certainly does, there is even a whole field dedicated to the task. Luckily, that process has been made much easier by the creators of the Librosa Python library. Python users can use this library to easily extract information on any mp3 that you can feed it. Check out the video below that gives a brief tutorial by one of the library\u2019s creators:", "Librosa makes it easy to extract numerous features including beat tracking, mel scale, chromograms relating to pitch class information, and the ability to pull apart the harmonic and percussive components of the audio. Below I provide the code I used retrieve some of this information for the song Weird Fishes by Radiohead. Again, a good tutorial for all of these steps and much more can be found here.", "Pretty easy! Librosa really is a wonderful tool for music information retrieval. For the next step in my exploration of content-based filtering, I wanted to build an entire model that would be able to classify music to the correct genre based on a variety of features. For the data, instead of using the information provided by Librosa, which can take quite a bit of time and computational power if you are trying to analyze a large amount of songs, I decided to use information provided by Spotify\u2019s Web API. Spotify provides song features that I can use for a classification model that are not as technical in nature as those provided by Librosa. For instance, some of the features include \u201cDanceability\u201d which \u201cdescribes how suitable a track is for dancing based on a combination of musical elements including tempo, rhythm stability, beat strength, and overall regularity. \u201d and \u201cEnergy\u201d which \u201crepresents a perceptual measure of intensity and activity. Typically, energetic tracks feel fast, loud, and noisy.\u201d You can find a full list of the features, and their descriptions, included in my data in the next section of this post. The cool thing about this API is that it provides non-technical ways of describing a song that are derived from a more technical and scientific content-based analysis of the music.", "Below I provide the code for my K-Nearest Neighbors classification model, where I attempted to classify songs into their correct genre. My data included about 300 songs, with about 1/3 being Hip-Hop, 1/3 Techno, and 1/3 Classical. I have also included the code on working with the Spotify Web API, which can be a bit tricky at first. Before you check it out though, here is a brief description of the features I received from the Spotify API:", "Acousticness \u2014 A confidence measure from 0.0 to 1.0 of whether the track is acoustic. 1.0 represents high confidence the track is acoustic.", "Danceability \u2014 Danceability describes how suitable a track is for dancing based on a combination of musical elements including tempo, rhythm stability, beat strength, and overall regularity. A value of 0.0 is least danceable and 1.0 is most danceable.", "Energy \u2014 Energy is a measure from0.0 to 1.0 and represents a perceptual measure of intensity and activity. Typically, energetic tracks feel fast, loud, and noisy. For example, death metal has high energy, while a Bach prelude scores low on the scale. Perceptual features contributing to this attribute include dynamic range, perceived loudness, timbre, onset rate, and general entropy.", "Instrumentalness \u2014 Predicts whether a track contains no vocals. \u201cOoh\u201d and \u201caah\u201d sounds are treated as instrumental in this context. Rap or spoken word tracks are clearly \u201cvocal\u201d. The closer the instrumentalness value is to 1.0, the greater likelihood the track contains no vocal content. Values above 0.5 are intended to represent instrumental tracks, but confidence is higher as the value approaches 1.0.", "Key \u2014 The key the track is in. Integers map to pitches using standard Pitch Class Notation . E.g. 0 = C, 1 = C\u266f/D\u266d, 2 = D, and so on.", "Liveness \u2014 Detects the presence of an audience in the recording. Higher liveness values represent an increased probability that the track was performed live. A value above 0.8 provides strong likelihood that the track is live.", "Loudness \u2014 The overall loudness of a track in decibels (dB). Loudness values are averaged across the entire track and are useful for comparing relative loudness of tracks. Loudness is the quality of a sound that is the primary psychological correlate of physical strength (amplitude). Values typical range between -60 and 0 db.", "Speechiness \u2014 Speechiness detects the presence of spoken words in a track. The more exclusively speech-like the recording (e.g. talk show, audio book, poetry), the closer to 1.0 the attribute value. Values above 0.66 describe tracks that are probably made entirely of spoken words. Values between 0.33 and 0.66 describe tracks that may contain both music and speech, either in sections or layered, including such cases as rap music. Values below 0.33 most likely represent music and other non-speech-like tracks.", "Tempo \u2014 The overall estimated tempo of a track in beats per minute (BPM). In musical terminology, tempo is the speed or pace of a given piece and derives directly from the average beat duration.", "Time Signature \u2014 An estimated overall time signature of a track. The time signature (meter) is a notational convention to specify how many beats are in each bar (or measure).", "Valence \u2014 A measure from 0.0 to 1.0 describing the musical positiveness conveyed by a track. Tracks with high valence sound more positive (e.g. happy, cheerful, euphoric), while tracks with low valence sound more negative (e.g. sad, depressed, angry).", "A quick description of the process: I first requested the track id\u2019s from three Spotify playlists, one playlist of each genre. I then requested the features for each track and combined all of the songs into one Pandas DataFrame. I then used the Scikit Learn K-Nearest-Neighbors model, looping through multiple K values to find the optimal one for my model. Ultimately that led to a K value of 9 which I used when fitting the model to the training data. Here are the scores for the classification model on the test data:", "F1 score of around .93 for my test set. Looking at the confusion matrix, it seems like the model is having some trouble with the Hip-Hop songs, sometimes classifying them as Techno. Not bad scores, but let\u2019s see if we can do better using another model.", "Next I tried classification using a Random Forest model, an ensemble method that I hoped would get me more accurate results, using the same features I used in the K-Nearest Neighbors model. See code and results below:", "Using Random Forest got me perfect classification scores! You can also see a bar chart displaying the importance of the individual features in the model. Clearly the Random Forest model was much more accurate than the K-Nearest Neighbors model, not surprising considering the simplicity of K-Nearest Neighbors .", "So thats the end of my brief introduction to content-based filtering in music recommender systems. Genre classification is just one small part of this puzzle and I look forward to exploring other parts of these systems and the data of music.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff2c4eb13bade&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@briansrebrenik?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@briansrebrenik?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": "Brian Srebrenik"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8089d26b221a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&user=Brian+Srebrenik&userId=8089d26b221a&source=post_page-8089d26b221a----f2c4eb13bade---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff2c4eb13bade&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff2c4eb13bade&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@briansrebrenik/introduction-to-music-recommendation-and-machine-learning-310c4841b01d", "anchor_text": "Introduction to Music Recommendation and Machine Learning"}, {"url": "https://github.com/librosa/librosa", "anchor_text": "Librosa Python library"}, {"url": "https://en.wikipedia.org/wiki/Music_information_retrieval", "anchor_text": "field"}, {"url": "https://github.com/librosa/librosa", "anchor_text": "Librosa Python library"}, {"url": "https://en.wikipedia.org/wiki/Mel_scale", "anchor_text": "mel scale"}, {"url": "https://soundcloud.com/radiohead/weird-fishes-arpeggi", "anchor_text": "Weird Fishes by Radiohead"}, {"url": "https://librosa.github.io/librosa/index.html", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm", "anchor_text": "K-Nearest Neighbors"}, {"url": "https://en.wikipedia.org/wiki/Random_forest", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f2c4eb13bade---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/music?source=post_page-----f2c4eb13bade---------------music-----------------", "anchor_text": "Music"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f2c4eb13bade---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----f2c4eb13bade---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff2c4eb13bade&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&user=Brian+Srebrenik&userId=8089d26b221a&source=-----f2c4eb13bade---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff2c4eb13bade&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&user=Brian+Srebrenik&userId=8089d26b221a&source=-----f2c4eb13bade---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff2c4eb13bade&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff2c4eb13bade&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f2c4eb13bade---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f2c4eb13bade--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@briansrebrenik?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@briansrebrenik?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Brian Srebrenik"}, {"url": "https://medium.com/@briansrebrenik/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "104 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8089d26b221a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&user=Brian+Srebrenik&userId=8089d26b221a&source=post_page-8089d26b221a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F75882872de65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-and-music-classification-a-content-based-filtering-approach-f2c4eb13bade&newsletterV3=8089d26b221a&newsletterV3Id=75882872de65&user=Brian+Srebrenik&userId=8089d26b221a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}