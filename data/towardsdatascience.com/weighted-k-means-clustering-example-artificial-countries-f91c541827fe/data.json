{"url": "https://towardsdatascience.com/weighted-k-means-clustering-example-artificial-countries-f91c541827fe", "time": 1683004594.204115, "path": "towardsdatascience.com/weighted-k-means-clustering-example-artificial-countries-f91c541827fe/", "webpage": {"metadata": {"title": "Weighted K-Means Clustering example \u2014 artificial countries | by Oleg \u017bero | Towards Data Science", "h1": "Weighted K-Means Clustering example \u2014 artificial countries", "description": "One of the fields where WKMC algorithm can be applied is demographics. Imagine a situation, in which you would like to see how people group or would group if all administration divisions or\u2026"}, "outgoing_paragraph_urls": [{"url": "https://neo.sci.gsfc.nasa.gov/view.php?datasetId=SEDAC_POP", "anchor_text": "NASA", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/List_of_map_projections#Cylindrical", "anchor_text": "cylindrical", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Modern_flat_Earth_societies", "anchor_text": "still round", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans.fit", "anchor_text": "API", "paragraph_index": 10}, {"url": "https://www.worldometers.info/geography/how-many-countries-are-there-in-the-world/", "anchor_text": "195", "paragraph_index": 15}, {"url": "https://landing.mailerlite.com/webforms/landing/j5y2q1", "anchor_text": "newsletter", "paragraph_index": 24}, {"url": "https://forms.gle/bNpf9aqZJGLgaU589", "anchor_text": "form", "paragraph_index": 24}, {"url": "https://zerowithdot.com", "anchor_text": "https://zerowithdot.com", "paragraph_index": 26}], "all_paragraphs": ["One of the fields where WKMC algorithm can be applied is demographics. Imagine a situation, in which you would like to see how people group or would group if all administration divisions or historical conflicts disappeared or ethnic, national or tribal identity would not matter? How would then people go about creating communities?", "In this post, we will use the WKMC algorithm to find out how people would group only based on their present geographical distribution. For this reason we will look at two parameters:", "As this is a curiosity-driven simulation, it is a great simplification that possesses purely hypothetical character. The simulation does not take into account conditions such as natural resources or terrain barriers that would prevent people from settling. Antarctica is the only exception though. We exclude it, as it is a large part of the map, too large for the algorithm to ignore, yet almost completely inhabitable.", "We will use population density dataset available at NASA. The site offers four versions of the dataset, available in different resolution, which are good for experimentation.", "The dataset comes in four different resolution versions. Naturally, the highest resolution one gives the best results, although the computation tie necessary may become an issue. To get the dataset, execute:", "For this dataset, the geographical longitude and latitude are simply expressed as integer numbers and treats as (x, y) indices of a matrix, and the map has cylindrical representation. At the same time, every element of this matrix represents population density of people living at a particular region.", "The oceans are marked as 99999.0, which is unnatural and thus we put it to zero. Later, we remove a \"strip\" of Arctic ocean (just to speed up the computation slightly) and Antarctica, as motioned earlier. Then, we re-enumerate the indices for rows and columns to have them count from zero.", "Before we proceed, we need to transform our dataset a bit in order to fit in with the clustering problem. First of all, we need to change the representation of the dataset from a population density matrix to a list of longitude and latitude coordinate points, in order for the WKMC be able to calculate distance. However, we also need to keep the population density value, which both us and the machine can interpret as weight of each data point. In other words, large settlements such as big cities will have a much stronger tendency to pull the nearest points into the clusters comparing to rural areas or deserts.", "First, we extract the latitude and longitude from the dataframe object. Then, we repeat the latitude and latitude values, so that they form unique pairs ordered along some new index. We also dump all the weights and flatten them to a series, which we join into a new dataframe, so we can keep the reference.", "We know that nowadays people tend to put everything for a debate, but no\u2026 the Earth is still round. Here, we have a cylindrical represented map, which has an important consequence: the left and the right edge of the map are connected together. It is therefore vital to ensure that our algorithm will not treat two points residing close to the two edges as very separated.", "Because the skearn API does not allow us to override the distance metrics easily, we have to parametrize the dataset differently:", "The longitude is the dimension that is cyclic, and if we scaled it to an interval of [0:2.0*np.pi], it would literally become the longitudinal angle. The problem is that the difference between 1st and the 360th degree is 360 degrees, while the distance should be equal to one degree. Therefore, we can decompose this dimension into two features, and use sine and cosine, respectively.", "The latitude should not be cyclic here. However, if we look at the longitude related features we just defined, we can see that the maximum that can occur along there axes is 2. Therefore, in order to compensate for it when scaling of latitude, we need to ensure that the maximum distance along it is also 2.", "Because our dataframe dd keeps all the references, we can simply add the new features into it, which we just did.", "Now, our feature matrix X can be constructed by referencing all points through latitude and the sine/cosine projections of the longitude. At the same time, we take the population density to act as weights. Before we do that, however, we remove all points whose weight is strictly zero. As our plane's surface is around 70% water, it can drastically reduce the computation needed.", "The number 195 is not accidental. Currently, we have 195 regions recognized as countries. We can use this number as reference in our new world.", "Having solved the WKMC problem, we need to \u201crecombine\u201d the solution to the old coordinates, which is fairly easy, given we have kept reference to the original indices.", "Now, let\u2019s plot the results. We will overlay the original population density map with the new \u201ccountries\u201d. (Note that the np.where function is only used here for enhancing of the plot.)", "We have finally clustered the population. It is useful to observe the consequences of WKMC algorithm\u2019s assumptions.", "First of all, as we have removed the points of zero weights, no clusters\u2019 labels are assigned to those points. However, the larger the population density, the more concentrated the clusters became. This is especially visible in regions of India and China that are ones of the most densely populated regions in the world. Siberia and Northern parts of Canada, Greenland, Sahara and Australia form larger clusters.", "Secondly, by scaling of the features (remember, all features are in range [-1, 1]), the clusters do not exhibit anisotropy in any of directions. In other words, if e.g. the x-axis had 5 times the range, we would expect its influence to be much stronger and thus the cluster would be elongated vertically.", "Finally, by ensuring the continuity in East-West axis, our clusters are not distorted by the presence of the boundary conditions.", "We have seen how K-Means Clustering algorithm can be put into use in our hypothetical world. However, the usage just demonstrated is actually very traditional, and can be applied in similar situations, giving especially good results when working on smaller maps. The algorithm helps to spot similarities that exist regardless of any administrative divisions.", "I am planning to bring the articles to next level and offer short screencast video \u00b5-tutorials.", "If you want to be updated concerning the videos and future articles, subscribe to my newsletter. You can also let me know of your expectations by filling out the form. See you soon!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | https://zerowithdot.com | makes data make sense"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff91c541827fe&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f91c541827fe--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f91c541827fe--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://oleg-zero13.medium.com/?source=post_page-----f91c541827fe--------------------------------", "anchor_text": ""}, {"url": "https://oleg-zero13.medium.com/?source=post_page-----f91c541827fe--------------------------------", "anchor_text": "Oleg \u017bero"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb15e8d374ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=post_page-b15e8d374ce1----f91c541827fe---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff91c541827fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff91c541827fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://neo.sci.gsfc.nasa.gov/view.php?datasetId=SEDAC_POP", "anchor_text": "NASA"}, {"url": "https://en.wikipedia.org/wiki/List_of_map_projections#Cylindrical", "anchor_text": "cylindrical"}, {"url": "https://en.wikipedia.org/wiki/Modern_flat_Earth_societies", "anchor_text": "still round"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans.fit", "anchor_text": "API"}, {"url": "https://www.worldometers.info/geography/how-many-countries-are-there-in-the-world/", "anchor_text": "195"}, {"url": "https://landing.mailerlite.com/webforms/landing/j5y2q1", "anchor_text": "newsletter"}, {"url": "https://forms.gle/bNpf9aqZJGLgaU589", "anchor_text": "form"}, {"url": "https://zerowithdot.com/weighted-k-means-clustering-example/", "anchor_text": "https://zerowithdot.com"}, {"url": "https://medium.com/tag/python?source=post_page-----f91c541827fe---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----f91c541827fe---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f91c541827fe---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/side-project?source=post_page-----f91c541827fe---------------side_project-----------------", "anchor_text": "Side Project"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----f91c541827fe---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff91c541827fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=-----f91c541827fe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff91c541827fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=-----f91c541827fe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff91c541827fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f91c541827fe--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff91c541827fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f91c541827fe---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f91c541827fe--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f91c541827fe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f91c541827fe--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f91c541827fe--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f91c541827fe--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f91c541827fe--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f91c541827fe--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f91c541827fe--------------------------------", "anchor_text": ""}, {"url": "https://oleg-zero13.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://oleg-zero13.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Oleg \u017bero"}, {"url": "https://oleg-zero13.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "387 Followers"}, {"url": "https://zerowithdot.com", "anchor_text": "https://zerowithdot.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb15e8d374ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=post_page-b15e8d374ce1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6b4620dc0d74&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweighted-k-means-clustering-example-artificial-countries-f91c541827fe&newsletterV3=b15e8d374ce1&newsletterV3Id=6b4620dc0d74&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}