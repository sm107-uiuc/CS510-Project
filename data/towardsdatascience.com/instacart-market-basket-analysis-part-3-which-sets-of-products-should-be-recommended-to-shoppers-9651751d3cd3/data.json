{"url": "https://towardsdatascience.com/instacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3", "time": 1683000727.2396019, "path": "towardsdatascience.com/instacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3/", "webpage": {"metadata": {"title": "Instacart Market Basket Analysis Part 3: Which Sets of Products Should Be Recommended To Shoppers? | by James Le | Towards Data Science", "h1": "Instacart Market Basket Analysis Part 3: Which Sets of Products Should Be Recommended To Shoppers?", "description": "Welcome to the promising age of data science and machine learning platforms! These platforms have the advantage of being usable right out of the box so that teams can start analyzing data pretty much\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.saturncloud.io/?source=jl-3", "anchor_text": "Saturn Cloud", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/instacart-market-basket-analysis", "anchor_text": "Instacart Market Basket Analysis", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/instacart-market-basket-analysis-part-1-which-grocery-items-are-popular-61cadbb401c8", "anchor_text": "part 1", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/instacart-market-basket-analysis-part-2-which-groups-of-customers-are-similar-618e88b0866d", "anchor_text": "part 2", "paragraph_index": 4}, {"url": "https://www.saturncloud.io/published/khanhnamle1994/instacart-notebooks/notebooks/Association-Rule-Mining.ipynb?source=jl-3", "anchor_text": "on Saturn Cloud here", "paragraph_index": 30}, {"url": "https://www.saturncloud.io/?source=jl-3", "anchor_text": "Saturn Cloud", "paragraph_index": 33}], "all_paragraphs": ["Welcome to the promising age of data science and machine learning platforms! These platforms have the advantage of being usable right out of the box so that teams can start analyzing data pretty much from day one. With open-source tools, you need to assemble a lot of the parts by hand, so to speak, and as anyone who\u2019s ever done a DIY project can attest to, it\u2019s often much easier in theory than in practice. Choosing a data science and ML platform wisely (meaning one that is flexible and allows for the incorporation and continued use of open source) can allow the best of both worlds in the enterprise: cutting-edge open source technology and accessible, governable, control over data projects.", "Ultimately, data science and ML platforms are about time. That means time savings in all parts of the processes (from connecting to data to building ML models to deployment), of course. But it\u2019s also about easing the burden of getting started in AI and allowing businesses to dive in and get started now \u2014 not waiting for years until technologies sure up and the world of AI becomes more clear (because spoiler alert: that may never happen). Getting started on the AI journey is intimidating, but data science and ML platforms can ease that burden and provide a framework that allows companies to learn as they go.", "Saturn Cloud allows Data Scientists to easily provision and host their work on the cloud, without the need for specialized DevOps. The data scientists can then work within a Juptyer Notebook which is hosted on the server(s) specified by you and created by the system. All of the setups for software, networking, security, and libraries are automatically taken care of by the Saturn Cloud system. Data Scientists can then focus on the actual Data Science and not the tedious infrastructure work that falls around it.", "You can also share your Juypter Notebooks with the public or team members using links. This eliminates the need to understand how to work with GitHub for basic data science projects. If you do know how to use GitHub, it still offers a fast and convenient way of testing and developing code with others. As a result, data scientists can focus on data science and finish their projects more quickly than they would have been able to do otherwise.", "This is the final part of a 3-part article series where I give an example of how I use Saturn Cloud to work on the Instacart Market Basket Analysis challenge. In part 1, I explored the dataset to understand in fine-grained details about the customer shopping behavior on the Instacart platform. In part 2, I segmented the customers to figure out what factors separate them from one another.", "I was looking to run association analysis in Python using the Apriori algorithm to derive rules of the form {A} -> {B}. However, I quickly discovered that it\u2019s not part of the standard Python machine learning libraries. Although there are some implementations that exist, I could not find one capable of handling large datasets. \u201cLarge\u201d in my case was an orders dataset with 32 million records, containing 3.2 million unique orders and about 50K unique items (file size just over 1 GB).", "Therefore, I decided to implement the algorithm my own to generate those simple {A} -> {B} association rules. Since I only care about understanding relationships between any given pair of items, using Apriori to get to item sets of size 2 is sufficient. I went through various iterations, splitting the data into multiple subsets just so I could get functions like cross-tab and combinations to run on my machine with less than 10 GB of memory. But even with this approach, I could only process about 1,800 items before my kernel would crash\u2026 And that\u2019s when I learned about the wonderful world of Python generators.", "In a nutshell, a generator is a special type of function that returns an iterable sequence of items. However, unlike regular functions that return all the values at once, a generator yields one value at a time. To get the next value in the set, we must ask for it \u2014 either by explicitly calling the generator\u2019s built-in \u201cnext\u201d method, or implicitly via a for loop.", "This is a great property of generators because it means that we don\u2019t have to store all of the values in memory at once. We can load and process one value at a time, discard that value when we finished, and move on to process the next value. This feature makes generators perfect for creating item pairs and counting their frequency of co-occurrence.", "Here\u2019s a concrete example of what we\u2019re trying to accomplish:", "Here\u2019s the generator that implements the above tasks:", "The get_item_pairs() function written above generates a list of items for each order and produces item pairs for that order, one pair at a time.", "Apriori is an algorithm for frequent itemset mining and association rule learning over transactional databases. It proceeds by identifying the frequent individual items in the database and extending them to larger and larger item sets as long as those itemsets appear sufficiently often in the database.", "Apriori uses a \u201cbottom-up\u201d approach, where frequent subsets are extended one item at a time (a step known as candidate generation), and groups of candidates are tested against the data. The algorithm terminates when no further successful extensions are found.", "Apriori uses a breadth-first search and a Hash tree structure to count candidate item sets efficiently. It generates candidate itemsets of length k from itemsets of length (k \u2014 1). Then it prunes the candidates which have an infrequent subpattern. According to the downward closure lemma, the candidate set contains all frequent k-length item sets. After that, it scans the transaction database to determine frequent itemsets among the candidates.", "Here\u2019s an example of Apriori in action, assuming a minimum occurrence threshold of 3:", "If we had more orders and items, we can continue to iterate, building item sets consisting of more than 2 elements. For the problem we are trying to solve (i.e.: finding relationships between pairs of items), it suffices to implement Apriori to get to item sets of size 2.", "Once the item sets have been generated using apriori, we can start mining association rules. Given that we are only looking at item sets of size 2, the association rules we will generate will be of the form {A} -> {B}. One common application of these rules is in the domain of recommender systems, where customers who purchased item A are recommended item B.", "Here are 3 key metrics to consider when evaluating association rules:", "This is the percentage of orders that contain the item set. In the example above, there are 5 orders in total and {apple, egg} occurs in 3 of them, so:", "The minimum support threshold required by apriori can be set based on knowledge of your domain. In this grocery dataset for example, since there could be thousands of distinct items and an order can contain only a small fraction of these items, setting the support threshold to 0.01% may be reasonable.", "Given two items, A and B, confidence measures the percentage of times that item B is purchased, given that item A was purchased. This is expressed as:", "Confidence values range from 0 to 1, where 0 indicates that B is never purchased when A is purchased, and 1 indicates that B is always purchased whenever A is purchased. Note that the confidence measure is directional. This means that we can also compute the percentage of times that item A is purchased, given that item B was purchased:", "In our example, the percentage of times that egg is purchased, given that Apple was purchased is:", "Here we see that all of the orders that contain egg also contain apple. But, does this mean that there is a relationship between these two items, or are they occurring together in the same orders simply by chance? To answer this question, we look at another measure which takes into account the popularity of both items.", "Given two items, A and B, lift indicates whether there is a relationship between A and B, or whether the two items are occurring together in the same orders simply by chance (ie: at random). Unlike the confidence metric whose value may vary depending on direction (eg: confidence{A->B} may be different from confidence{B->A}), lift has no direction. This means that the lift{A,B} is always equal to the lift{B,A}:", "In our example, we compute lift as follows:", "One way to understand lift is to think of the denominator as the likelihood that A and B will appear in the same order if there was no relationship between them. In the example above, if apple occurred in 80% of the orders and egg occurred in 60% of the orders, then if there was no relationship between them, we would expect both of them to show up together in the same order 48% of the time (ie: 80% * 60%). The numerator, on the other hand, represents how often apple and egg actually appear together in the same order. In this example, that is 60% of the time. Taking the numerator and dividing it by the denominator, we get to how many more times apple and egg actually appear in the same order, compared to if there was no relationship between them (ie: that they are occurring together simply at random).", "In summary, lift can take on the following values:", "In this example, apple and egg occur together 1.25 times more than random, so I conclude that there exists a positive relationship between them. Armed with the knowledge of apriori and association rules mining, let\u2019s dive into the data and code to see what relationships I can unfold!", "Getting started with Jupiter Notebook in the cloud is very intuitive using Saturn Cloud. Once a notebook is running, I can easily share it from within the notebook with the public. To demonstrate this, you can view the complete code from my Association Rules Mining notebook on Saturn Cloud here.", "After the data pre-processing steps, I wrote a couple of helper functions to assist the main association rules function:", "The big association_rules() function is displayed in the GitHub Gist below:", "At this point, I was able to leverage Saturn Cloud\u2019s GPU capability for my workloads. Essentially, Saturn Cloud enables me to deploy a Spark or Dask cluster with just one click. This simplifies issues of dealing with very expensive computations by making distributed computing available with a single click. Considering that this association rules mining algorithm is quite expensive, access to GPU is a clear winner here.", "After calling the association_rules() function on the orders data frame with minimum support of 0.01, I got the results below (7 samples of the rules being mined):", "From the output above, I observe that the top associations are not surprising, with one flavor of an item being purchased with another flavor from the same item family (eg: Strawberry Chia Cottage Cheese with Blueberry Acai Cottage Cheese, Chicken Cat Food with Turkey Cat Food, etc). As mentioned, one common application of association rules mining is in the domain of recommender systems. Once item pairs have been identified as having a positive relationship, recommendations can be made to customers in order to increase sales. And hopefully, along the way, we can also introduce customers to items they never would have tried before or even imagined existed!", "DevOps can be really difficult when trying to get data science group projects off the ground. Behind the scenes, there\u2019s a lot that goes into setting up the actual platform that Data Scientists use for their work: creating servers, installing the necessary software and environments, setting up security protocols, and the like. Hosting Jupyter Notebooks with Saturn Cloud while also taking care of versioning and the ability to scale in or out as needed can tremendously simplify your life, decrease your time to market, decrease cost and the need for expert cloud skills.", "I hope you enjoy this 3-part series on the benefits of using Saturn Cloud via the Instacart Market Basket Analysis challenge. As part of the data science and machine learning platform movement, frameworks like Saturn Cloud can open up the door to true data innovation when teams don\u2019t have to spend precious time on administrative, organizational, or repeated tasks. The reality is, in the age of AI, businesses of any size can\u2019t afford to work without a data science platform that enables and elevates not just their data science team, but the entire company to the highest level of data competence for the greatest possible impact.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9651751d3cd3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://le-james94.medium.com/?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": ""}, {"url": "https://le-james94.medium.com/?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": "James Le"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52aa38cb8e25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&user=James+Le&userId=52aa38cb8e25&source=post_page-52aa38cb8e25----9651751d3cd3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9651751d3cd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9651751d3cd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/towards-data-science/in-depth-analysis/home", "anchor_text": "IN-DEPTH ANALYSIS"}, {"url": "https://www.saturncloud.io/?source=jl-3", "anchor_text": "Saturn Cloud"}, {"url": "https://www.kaggle.com/c/instacart-market-basket-analysis", "anchor_text": "Instacart Market Basket Analysis"}, {"url": "https://towardsdatascience.com/instacart-market-basket-analysis-part-1-which-grocery-items-are-popular-61cadbb401c8", "anchor_text": "part 1"}, {"url": "https://towardsdatascience.com/instacart-market-basket-analysis-part-2-which-groups-of-customers-are-similar-618e88b0866d", "anchor_text": "part 2"}, {"url": "https://www.saturncloud.io/published/khanhnamle1994/instacart-notebooks/notebooks/Association-Rule-Mining.ipynb?source=jl-3", "anchor_text": "on Saturn Cloud here"}, {"url": "https://gist.github.com/khanhnamle1994/934d4c928c836d38879d3dd6637d9904", "anchor_text": "https://gist.github.com/khanhnamle1994/934d4c928c836d38879d3dd6637d9904"}, {"url": "https://www.saturncloud.io/?source=jl-3", "anchor_text": "Saturn Cloud"}, {"url": "https://medium.com/tag/in-depth-analysis?source=post_page-----9651751d3cd3---------------in_depth_analysis-----------------", "anchor_text": "In Depth Analysis"}, {"url": "https://medium.com/tag/devops?source=post_page-----9651751d3cd3---------------devops-----------------", "anchor_text": "DevOps"}, {"url": "https://medium.com/tag/data-mining?source=post_page-----9651751d3cd3---------------data_mining-----------------", "anchor_text": "Data Mining"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----9651751d3cd3---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9651751d3cd3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9651751d3cd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&user=James+Le&userId=52aa38cb8e25&source=-----9651751d3cd3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9651751d3cd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&user=James+Le&userId=52aa38cb8e25&source=-----9651751d3cd3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9651751d3cd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9651751d3cd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9651751d3cd3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9651751d3cd3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9651751d3cd3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9651751d3cd3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9651751d3cd3--------------------------------", "anchor_text": ""}, {"url": "https://le-james94.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://le-james94.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "James Le"}, {"url": "https://le-james94.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17.6K Followers"}, {"url": "https://jameskle.com/", "anchor_text": "https://jameskle.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52aa38cb8e25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&user=James+Le&userId=52aa38cb8e25&source=post_page-52aa38cb8e25--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F171511b90ce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstacart-market-basket-analysis-part-3-which-sets-of-products-should-be-recommended-to-shoppers-9651751d3cd3&newsletterV3=52aa38cb8e25&newsletterV3Id=171511b90ce0&user=James+Le&userId=52aa38cb8e25&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}