{"url": "https://towardsdatascience.com/logistic-regression-for-facial-recognition-ab051acf6e4", "time": 1682994300.815676, "path": "towardsdatascience.com/logistic-regression-for-facial-recognition-ab051acf6e4/", "webpage": {"metadata": {"title": "Logistic Regression For Facial Recognition | by Audrey Lorberfeld | Towards Data Science", "h1": "Logistic Regression For Facial Recognition", "description": "Facial recognition algorithms have always fascinated me, and wanting to flex my newfound logistic regression skills on some data, I created a model based on a dataset I found called \u201cSkin\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Skin+Segmentation", "anchor_text": "description", "paragraph_index": 1}, {"url": "https://www.nist.gov/itl/iad/image-group/color-feret-database", "anchor_text": "FERET", "paragraph_index": 1}, {"url": "https://ieeexplore.ieee.org/abstract/document/5409447", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://link.springer.com/chapter/10.1007/978-3-642-10520-3_69", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "scikit-learn", "paragraph_index": 3}, {"url": "https://github.com/aulorbe/skin-noskin", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://www.theanalysisfactor.com/what-is-an-roc-curve/", "anchor_text": "here", "paragraph_index": 23}, {"url": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5", "anchor_text": "here", "paragraph_index": 23}], "all_paragraphs": ["Facial recognition algorithms have always fascinated me, and wanting to flex my newfound logistic regression skills on some data, I created a model based on a dataset I found called \u201cSkin Segmentation.\u201d", "As noted in its description, the data in Skin Segmentation were collected \u201cby randomly sampling B,G,R values from face images of various age groups (young, middle, and old), race groups (white, black, and asian), and genders obtained from FERET database and PAL database.\u201d The dataset has 245,057 rows and 4 columns (B, G, R, and a binary column indicating if the image was classified as containing skin or not containing skin). The latter, binary column made this dataset ripe for logistic regression.", "(If you want to read the two (pay-walled) scholarly articles that used this dataset, see here and here.)", "My wheelhouse is Python, and I particularly wanted to test out the scikit-learn library since it is the industry standard for scientific tasks like regression. I also opted to use Juypter Notebook as my IDE over text editors like Atom because of its low barrier to entry; with its narrative structure, Jupyter allows most anyone to get a feel for how code works.", "To run this code on your own, you will need to have Python 3, scikit-learn, Pandas, NumPy, matplotlib, Seaborn, Itertools, and imblearn installed/imported on your machine/in your virtual environment (requirements.txt file coming to the repo soon!).", "You can find the repo for this project here. There, you can find an in-depth Jupyter notebook outlining all the steps summarized in this post.", "The data munging I had to do on this dataset was fairly straightforward. After reading in the text file via URL and saving it to a Pandas dataframe, you can see that its only real issue is that it lacks column headers.", "After pushing down the top row into the dataframe and renaming the column headers, I was able to get to this:", "In this dataset, 1s indicated pixels with no skin in them, and 2s indicated pixels skin in them.", "As you can anticipate, 1s and 2s are indeed helpful, but we really want 1s and 0s for logistic regression. So, I created dummies for the Skin or No-Skin column. (I also coerced the datatype to int64 to be in line with the other columns in the dataframe.)", "As you can see, I turned this Skin or No-Skin column into my y-variable (my dependent variable). The other columns I turned into a matrix (X).", "In my X matrix, I also wanted to get all my variables on the same scale, so I ran them through a min-max normalizer and got them all on a 0\u20131 scale.", "After getting my data into a workable state, I split it into test and train sets using sklearn. I also created my model, fit it to my training data, and then ran my model on both my train and test data to see how well it performed.", "I looked at the difference between my predicted values (y_hat_train and y_hat_test) and my original y_train and y_test values to evaluate my model\u2019s accuracy.", "In the readouts, the number of 0s is the number of correct predictions when compared with the true values, and the number of 1s is the number of incorrect predictions. The normalize = True simply turns the first part of the readout from # of predictions to percentages.", "You can see that, on our training data, our model was accurate 90.7% of the time, while on our test data it was accurate 90.6% of the time. Pretty good!", "I also wanted to see how my model did in terms of a confusion matrix. (For a great read on confusion matrices, see here.)", "As you can see in the comments, here 0s are pixels classified as having no skin and 1s are pixels classified as having skin.", "In order to make my confusion matrix\u2019s values a bit more understandable, I then ran a Classification Report in order to get some common metrics like precision, recall, and f1-score.", "You can see here that our model\u2019s precision is 96%, its recall is 92%, and its f1-score is 94%. I also wanted to know my accuracy rate, so I simply calculated it manually and got 91% (the same number we got with our test data in the simple readouts section above).", "For a nice representation of what each score means, see the diagram below.", "ROC-AUC curves are a helpful metric to look at because they measure the true positive rate against the false positive rate.", "I generated an ROC-AUC curve for both my train and test data, but they seemed essentially the same, so I will only show the train image here. (The AUC for the training data was 93.4%, while the AUC for the test data was 93.2%.)", "More on ROC-AUC curves and their purpose can be found here and here.", "As you can see, our ROC curve is hugging the top, left corner of our graph, which is what we want.", "One of the most useful things about ROC-AUC curves is that they allow us to evaluate models even when there is a class imbalance within the original dataset.", "Class imbalance is when there is significantly more of 1 type of class in your data than another type of class. This has the ability to really mess up your analysis. Take, for instance, a dataset of rare diseases that is skewed (i.e. has class imbalance issues). Let\u2019s then say that there are only 2 positive cases in 1000. Even if you make a crappy model that classifies everything as negative, you will still achieve an accuracy rate of 99.8% (i.e. 998 / 1000 classifications was correct). So, you need more context to truly evaluate your model when it\u2019s being run on an imbalanced dataset.", "So, let\u2019s rewind a bit and see if our data is imbalanced. Maybe we can make our model better.", "We can see here that our data is a little out of wack \u2014 about 79% is classified as 1s (i.e. pixels containing skin) and only about 21% as 0s (i.e. pixels not containing skin).", "So, before we call it a day, let\u2019s run something called SMOTE (Synthetic Minority Oversampling). SMOTE creates synthetic data to fill more values in for our minority class (in our case this means it will give us more 0-data points). Although creating synthetic data seems like cheating, it\u2019s very common practice in the data-science world where datasets are not very often well-balanced.", "Running SMOTE on our original data and re-generating our confusion matrix and our Classification Report, we get the following.", "We can see that these numbers are significantly different than our original numbers. Recall that the first time around we had a precision of 96%, a recall of 92%, and a f1-score of 94%. After running our data through SMOTE, we have a precision of 85%, a recall of 92%, and a f1-score of 89%. So, our model actually got worse after trying to compensate for class imbalance.", "As data scientists, it\u2019s up to us when to run things like SMOTE on our data or just leave our data as-is. In this case, we can see that leaving our data as-is was the way to go.", "Besides being a good learning opportunity, we really did create a good model. And we know that doing other things to our data, such as trying to compensate for having a class imbalance, is definitively not what we should do in this case. Our original model was our best performer, correctly predicting an image having skin in it 94% of the time (using our f1-score).", "While this might sound like a good classification rate, there are myriad ethical issues that come with creating algorithms used for facial recognition. What if our model was going to be used to identify wanted terrorists in a crowd? This is certainly different than recognizing a face for a filter in Snapchat.", "This is where we as data scientists need as much information as possible when creating algorithms. If our model were to be used for Snapchat filters, we\u2019d likely want to optimize towards upping our recall score \u2014 it\u2019s ostensibly better that we mistakenly identify things as faces when they\u2019re not faces than only recognize real faces some of the time.", "On the other hand, if our model were to be used for spotting wanted criminals in a crowd, we\u2019d likely still want to optimize towards recall, but the consequences would be vastly different. Is it worth bringing innocent people in for questioning and potentially violating their rights if it meant that you\u2019d catch wanted criminals almost 100% of the time? Perhaps not.", "We need to think carefully about these questions when playing around in the world of AI. As Cathy O\u2019Neill writes in Weapons of Math Destruction, constructing algorithms requires \u201cmoral imagination, [which] only humans can provide.\u201d", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fab051acf6e4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@AudreyLorberfeld?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@AudreyLorberfeld?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": "Audrey Lorberfeld"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fedc4e7b3ee9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&user=Audrey+Lorberfeld&userId=edc4e7b3ee9c&source=post_page-edc4e7b3ee9c----ab051acf6e4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab051acf6e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab051acf6e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@AudreyLorberfeld/the-learning-process-logistic-regression-for-facial-recognition-take-2-6a1fef4ebe21", "anchor_text": "here"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Skin+Segmentation", "anchor_text": "description"}, {"url": "https://www.nist.gov/itl/iad/image-group/color-feret-database", "anchor_text": "FERET"}, {"url": "https://ieeexplore.ieee.org/abstract/document/5409447", "anchor_text": "here"}, {"url": "https://link.springer.com/chapter/10.1007/978-3-642-10520-3_69", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "scikit-learn"}, {"url": "https://github.com/aulorbe/skin-noskin", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62", "anchor_text": "here"}, {"url": "https://www.theanalysisfactor.com/what-is-an-roc-curve/", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5", "anchor_text": "here"}, {"url": "https://medium.com/@AWChristoph", "anchor_text": "Christoph Auer-Welsbach"}, {"url": "https://medium.com/cityai/the-ethics-of-ai-building-technology-that-benefits-people-and-society-ea6b10c5ff3", "anchor_text": "The Ethics of AI: Building technology that benefits people and society"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ab051acf6e4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ab051acf6e4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/ethics?source=post_page-----ab051acf6e4---------------ethics-----------------", "anchor_text": "Ethics"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ab051acf6e4---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/facial-recognition?source=post_page-----ab051acf6e4---------------facial_recognition-----------------", "anchor_text": "Facial Recognition"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fab051acf6e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&user=Audrey+Lorberfeld&userId=edc4e7b3ee9c&source=-----ab051acf6e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fab051acf6e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&user=Audrey+Lorberfeld&userId=edc4e7b3ee9c&source=-----ab051acf6e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab051acf6e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fab051acf6e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ab051acf6e4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ab051acf6e4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ab051acf6e4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ab051acf6e4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ab051acf6e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@AudreyLorberfeld?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@AudreyLorberfeld?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Audrey Lorberfeld"}, {"url": "https://medium.com/@AudreyLorberfeld/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fedc4e7b3ee9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&user=Audrey+Lorberfeld&userId=edc4e7b3ee9c&source=post_page-edc4e7b3ee9c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3370e3e94a84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-for-facial-recognition-ab051acf6e4&newsletterV3=edc4e7b3ee9c&newsletterV3Id=3370e3e94a84&user=Audrey+Lorberfeld&userId=edc4e7b3ee9c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}