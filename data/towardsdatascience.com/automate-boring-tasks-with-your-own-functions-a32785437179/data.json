{"url": "https://towardsdatascience.com/automate-boring-tasks-with-your-own-functions-a32785437179", "time": 1683002728.9244108, "path": "towardsdatascience.com/automate-boring-tasks-with-your-own-functions-a32785437179/", "webpage": {"metadata": {"title": "7 Simple Python Functions to Clean Your Data | by F\u00e1bio Neves | Towards Data Science", "h1": "7 Simple Python Functions to Clean Your Data", "description": "Automating tasks with Python is very simple. Once you have a script that works, turn it into a function that will help you code more efficiently!"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-to-calculate-customer-retention-rate-a-practical-approach-1c97709d495f", "anchor_text": "Customer Retention", "paragraph_index": 17}, {"url": "https://stackoverflow.com/questions/17134716/convert-dataframe-column-type-from-string-to-datetime-dd-mm-yyyy-format", "anchor_text": "here", "paragraph_index": 25}, {"url": "https://towardsdatascience.com/how-to-calculate-customer-retention-rate-a-practical-approach-1c97709d495f", "anchor_text": "article", "paragraph_index": 29}, {"url": "https://www.linkedin.com/in/fabioneves/", "anchor_text": "here", "paragraph_index": 36}, {"url": "http://fneves.podia.com/", "anchor_text": "fneves.podia.com/", "paragraph_index": 38}], "all_paragraphs": ["Whether you are a Python beginner or a pro, whether you use Python at work or at home, chances are you also have some specific tasks that you have to perform several times a day/week/month. Do you find yourself going back to old projects trying to find that awesome bit of code you developed for another project? \u201cWhere is it? I could swear I did this exact thing in another project!\u201d \u2014 is this a familiar thought?", "This \u201cproblem\u201d might be especially relevant if, like me, you do a lot of extracting, transforming and loading (ETL) of data in your work.", "There are several examples I can think of, and I am sure you can find hundreds of other articles with cool tricks and functions, some better and some worse. I\u2019ve seen them too. But most of them will show you the same snippets all over again.", "Which is why I tried to get out of the typical examples and share something that I actually created and use regularly! It\u2019s not that they are the most amazing, well-written, mind-blowing functions ever, but at least I am pretty sure you haven\u2019t seen them elsewhere, and maybe you can even tweak one or two to help you out in the future. In my next article, I will show you how to create your own Class in Python.", "Do you have a folder where you upload csv files every day and then need to merge them from time to time into one big dataset? Or maybe you want to add one column to every file on a specific folder, and save them with a different name? Maybe the data you extract from that database comes with weird column names, or one of the columns needs to be split in two.", "I am going to share some snippets of code to address those issues and a few more! But enough teasing already. Below there is a list of the type of tasks we will be coding in this article. I hope some of them are as useful to you as they are to me almost daily!", "I remember I was quite proud when I got these two functions to work. Several minutes (or even hours) magically turned into a few seconds. \u201cIt\u2019s the little things in life\u201d, I guess!", "Having to deal with a lot of csv files throughout the day, I have daily extractions with daily data that needs to be compiled every week or so. If you have similar tasks, you\u2019re probably going to like these!", "This one started as a simple function but then it evolved a bit. The starting point was just pointing to a folder with the csv files that I wanted to merge, and saving the merged dataset in a new file. Please notice that I am using files with the exact same structure, but you can easily adapt this code to match your needs.", "But csv files can only fit so many rows\u2026 So after a while, I added an option to merge the files in memory only. And I added an input variable, so I could just call the function and it would ask me for the path, instead of me copying the path when I was writing the command itself.", "You just need to import glob and pandas for this one. The strftime is just a nice way to keep track of when the file was created, by adding the date to the filename.", "By default, you can just run it like this: folder_csv_merge(\u2018my_preffix\u2019). It will then prompt you to paste the file path. The new file should appear in the same folder as the originals. This may not be the best practice, so make sure to edit the last row to match a location you want the final files to be saved in.", "If you simply want to get all the data in the csv files to a dataframe in memory and not to a new file, simply add the argument memory=\u2019yes\u2019, but then you need to call the function into a variable. Like this: merged_file = folder_csv_merge(\u2018my_preffix\u2019, memory = \u2018yes\u2019). You will now have a variable with all the files merged inside.", "On a recent occasion, I realized I had spent a few hours waiting to extract hundreds of files, but forgot to add an important column to each of them while extracting. Waiting another day to have everything again was not an option\u2026", "No problem! That\u2019s what for loops are\u2026 for?!", "The first part is very similar because I wanted the console to prompt me for the file path. After specifying the file path, it will now loop over every file, and do something with each of them.", "In the example above, I had a column in every file that displayed how many days the customer had been with our company. The problem is that I forgot to add 1 to this value upon the extraction and transforming (because \u201cseniority = 0\" looks strange to me!). That was the only change I needed to make, but you can add more stuff if you want. Rename columns, delete columns, create new ones, etc.", "This one saved me a lot of time and if you must know, I did pat myself in the back once the job was done! It was actually used when I was trying to calculate Customer Retention, and if you are interested in that, please check my article about it!", "The next functions are all about cleaning those datasets you get from the guys at the Sales department, or any other colleagues that just can\u2019t be bothered to care about data consistency and readability! Even some databases built a long time ago can have weird column names that look like sentences, filled with strange characters.", "This one is pretty easy, and quite useful. Pretty much self-explanatory! It is also important because you want to keep your column names consistent across your projects.", "Next up, a simple function to help you split a column based on a specific character or string.", "Let\u2019s say you have a column \u201ctag\u201d in a dataframe, that actually consists of a category and a sub-category, separated by an underscore. You would rather have these two apart which means we need a column named \u201ccategory\u201d and another named \u201csubcategory\u201d. Easy:", "Check your dataframe again, and now you have two new columns!", "This is not something I use every day, but there is a specific file that made me create it. This file has several columns with the same names for different years. But I typically just need to work with one year at the time, so I have to filter the relevant columns.", "I included a small example at the end of this snippet to make it clearer! Just run it and see for yourself how it works.", "Back when I started learning Python, I remember one of the coolest features I found at the time was the built-in date/time functionality. We were all noobs at some point! These next functions assume you have already transformed your date columns into a datetime object (example here).", "I\u2019ll be the first to admit that this next function is not the greatest breakthrough of all time\u2026 unless the columns you want to use are always the same and only the dataframe name changes. If that\u2019s the case, you can hardcode the column names in the function and use it very easily with a single argument \u2014 that is, the name of the dataframe.", "This function creates a new column with the difference between the two dates. More on what the \u201cCohortIndex\u201d is, in the next one.", "To wrap things up, I\u2019ll share these 2 for the price of 1! I needed these for the Customer Retention article I mentioned previously. It was necessary to calculate the cohorts.", "Daily cohorts can be obtained with the function above, but it would not work for monthly cohorts, or yearly cohorts. If you want to understand why, you can check out the article to get a sense of what I needed this for.", "The first function get_date_int is necessary so we can separate the year, month and week from each date. The function will return an integer for each variable, and we will incorporate it in the calc_cohorts function.", "Moving on to the second function, we need a dataframe with two date columns (in this case, it\u2019s the signup date and the last login date, but you can change the names to suit your project).", "Once you run it, you get two new columns in your dataframe, called cohort_w and cohort_y. Your cohorts are ready to be used to calculate retention rates!", "That is it for now, but as I mentioned in the beginning, I am writing the next article about how to create your own Class in Python. A class will let you use these functions directly as if you were using a \u201cnormal\u201d package like Pandas or Numpy. No need to define the functions every time. Simply import your own package and use them directly.", "In the meantime, I want to thank you for reading/commenting and following me, if that\u2019s the case. It has been really rewarding to be able to share this journey and connect with so many people!", "And don\u2019t forget to check out some of my other articles:", "Thank you for reading! As always, I welcome feedback and constructive criticism. If you\u2019d like to get in touch, you can contact me here or simply reply to the article below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Jack of all trades, master of some. Currently focused on Data Science, Python, Investing, and Photography. Check my courses at fneves.podia.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa32785437179&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a32785437179--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a32785437179--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@fneves?source=post_page-----a32785437179--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@fneves?source=post_page-----a32785437179--------------------------------", "anchor_text": "F\u00e1bio Neves"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F216b84c5c70f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&user=F%C3%A1bio+Neves&userId=216b84c5c70f&source=post_page-216b84c5c70f----a32785437179---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa32785437179&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa32785437179&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://fnevesphotography.pixieset.com/?utm_medium=tdshclean", "anchor_text": "Singapore"}, {"url": "https://towardsdatascience.com/how-to-calculate-customer-retention-rate-a-practical-approach-1c97709d495f", "anchor_text": "Customer Retention"}, {"url": "https://stackoverflow.com/questions/17134716/convert-dataframe-column-type-from-string-to-datetime-dd-mm-yyyy-format", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/how-to-calculate-customer-retention-rate-a-practical-approach-1c97709d495f", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/increase-your-instagram-followers-with-a-simple-python-bot-fde048dce20d", "anchor_text": "Increase your Instagram followers with a simple Python botI got 500 real followers in 4 days!towardsdatascience.com"}, {"url": "https://towardsdatascience.com/looking-for-a-house-build-a-web-scraper-to-help-you-5ab25badc83e", "anchor_text": "I was looking for a house, so I built a web scraper in Python!In a few months I\u2019ll have to leave my rented apartment and look for a new one. As painful as this experience can be\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/turn-your-previous-python-projects-into-awesome-tools-with-tkinter-2e61f2241e29", "anchor_text": "Turn your previous Python projects into awesome tools \u2014 with TkinterCreating a simple app with Tkinter, Python and a web scraping script with Selenium!towardsdatascience.com"}, {"url": "https://www.linkedin.com/in/fabioneves/", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a32785437179---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----a32785437179---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----a32785437179---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/technology?source=post_page-----a32785437179---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a32785437179---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa32785437179&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&user=F%C3%A1bio+Neves&userId=216b84c5c70f&source=-----a32785437179---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa32785437179&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&user=F%C3%A1bio+Neves&userId=216b84c5c70f&source=-----a32785437179---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa32785437179&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a32785437179--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa32785437179&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a32785437179---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a32785437179--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a32785437179--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a32785437179--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a32785437179--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a32785437179--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a32785437179--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a32785437179--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a32785437179--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@fneves?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@fneves?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "F\u00e1bio Neves"}, {"url": "https://medium.com/@fneves/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "http://fneves.podia.com/", "anchor_text": "fneves.podia.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F216b84c5c70f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&user=F%C3%A1bio+Neves&userId=216b84c5c70f&source=post_page-216b84c5c70f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7b5bc5c8fc9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-boring-tasks-with-your-own-functions-a32785437179&newsletterV3=216b84c5c70f&newsletterV3Id=7b5bc5c8fc9f&user=F%C3%A1bio+Neves&userId=216b84c5c70f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}