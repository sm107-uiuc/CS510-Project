{"url": "https://towardsdatascience.com/two-step-facial-recognition-with-colab-883a54faafad", "time": 1683015399.302894, "path": "towardsdatascience.com/two-step-facial-recognition-with-colab-883a54faafad/", "webpage": {"metadata": {"title": "Two Step Facial Recognition With Colab | by Dev Dash MD MPH | Towards Data Science", "h1": "Two Step Facial Recognition With Colab", "description": "It\u2019s Monday morning and I\u2019m channeling my inner Jeremy Howard (again). Over the last few months, I have seen plenty of facial recognition guides and some of them are really quite good. The problem\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Jeremy_Howard_(entrepreneur)", "anchor_text": "again", "paragraph_index": 0}, {"url": "https://pypi.org/project/face-recognition/", "anchor_text": "found here", "paragraph_index": 10}, {"url": "https://pypi.org/project/face-recognition/", "anchor_text": "Facial Recognition Library", "paragraph_index": 22}], "all_paragraphs": ["It\u2019s Monday morning and I\u2019m channeling my inner Jeremy Howard (again). Over the last few months, I have seen plenty of facial recognition guides and some of them are really quite good.", "The problem is, each student of deep learning or machine vision becomes interested through different venues. Maybe you\u2019re a musician interested in sounds, or a statistics student interested in tabular data.", "I know I personally became interested when started reading about TensorFlow and image classification \u2014 this idea that if I have a well curated dataset, I might be able to train an architecture to classify images with high accuracy.", "Google Colab didn\u2019t exist then and I recently ported something similar over to Colab and I\u2019m in the process of a walkthrough. Check out Part 1 here:", "My initial foray was done on my iMac using Anaconda, Spyder, no GPU usage, just letting my Core i5 trudge through thousands of images while I left to do other things (read: study for emergency medicine boards). Of course, before I could train, I had to read through two dozen articles of people using different styles to write code. What resulted was a chimeric hodge-podge of code that was difficult to understand when I looked at it weeks later.", "Then Colab entered the scene and while I still use Jupyter and Spyder on my machine, I use Colab to speak to you and efficiently share my code. It\u2019s not perfect but they\u2019ve done a great job in making high end computing available to the masses and all you need is a Google account.", "Enough rambling. Let\u2019s walk through the notebook:", "I\u2019m being a bit facetious here \u2014 the two steps are \u201cRun All\u201d and uploading your picture of faces.", "The notebook is designed to hide most of the code so you can cleanly look at the results. Look at the output first and convince yourself that we can not only pick out (hopefully most) the faces in the picture and later on, assign an emotion using an emotion detector function.", "I\u2019ve also left in some code to try to time the calculation process.", "This one uses the \u2018face_recognition\u2019 library, found here. We will be timing how long this takes, too.", "This line in particular does all the heavy lifting:", "The rest of the code uses a for loop to iterate through the number of faces, and draw a box around the faces using these two lines:", "Note: Not all faces are detected; hats and sunglasses throw the detection off.", "The code is almost identical to above except for one line (if block at line 11):", "There\u2019s a reason the \u2018if\u2019 statement is present as we\u2019ll see in the image below. The \u2018detect_emotions\u2019 line doesn\u2019t work with all the faces.", "Note: Emotion detection mostly works. Not all faces register an emotion and it thinks the baby is angry. I will let you take a closer look to see if you feel the labels match up perfectly \u2014 I don\u2019t think they do.", "Time taken: 2.83 seconds (slightly longer to add emotion detection)", "Haar cascade based recognition is another way of doing facial recognition. Discussion of how these work is beyond this post. There are plenty of technical resources available online that discuss this method.", "Again, using Haar cascades is another method and there are some missteps here as well. In particular, it misses some faces and thinks the combination of a pant leg, ankle, top of a shoe is a face.", "However, in every iteration I have run, using Haar cascades and OpenCV is much faster than using the face_recognition library \u2014 almost 20\u201330% faster at times. This kind of speed benefit is significant, especially if going through hundreds of images (e.g. video). It also speaks to a process that might be computationally less expensive and likely runs on less expensive hardware that requires less power.", "Of course, these are not the only two facial detection methods and proprietary ones are likely much better. If you had to pick between the two, I don\u2019t think there\u2019s a clear answer \u2014 one is better at detection (face_recognition) but the other is much faster (Haar cascades).", "[2] Facial Recognition Library, PyPi, Accessed October 2020", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F883a54faafad&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----883a54faafad--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----883a54faafad--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://piotrr.medium.com/?source=post_page-----883a54faafad--------------------------------", "anchor_text": ""}, {"url": "https://piotrr.medium.com/?source=post_page-----883a54faafad--------------------------------", "anchor_text": "Dev Dash MD MPH"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21d76fb2c1a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=post_page-21d76fb2c1a9----883a54faafad---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F883a54faafad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F883a54faafad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Jeremy_Howard_(entrepreneur)", "anchor_text": "again"}, {"url": "https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-1-5e56fce934a6", "anchor_text": "End to End Adaptation of ResNet in Google Colab \u2014 Part 1Train a deep neural network with only a few clickstowardsdatascience.com"}, {"url": "https://drive.google.com/file/d/10HRlLZR3q6ncEmYbEFmn2lEUQqaQXY5L/view?usp=sharing", "anchor_text": "Colab Notebook"}, {"url": "https://unsplash.com/photos/1qfy-jDc_jo", "anchor_text": "Unsplash.com"}, {"url": "https://pypi.org/project/face-recognition/", "anchor_text": "found here"}, {"url": "https://en.wikipedia.org/wiki/Jeremy_Howard_(entrepreneur)", "anchor_text": "Wikipedia-Jeremy Howard"}, {"url": "https://pypi.org/project/face-recognition/", "anchor_text": "Facial Recognition Library"}, {"url": "https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_objdetect/py_face_detection/py_face_detection.html", "anchor_text": "Open CV Haar Cascades"}, {"url": "https://medium.com/tag/opencv?source=post_page-----883a54faafad---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/face-recognition?source=post_page-----883a54faafad---------------face_recognition-----------------", "anchor_text": "Face Recognition"}, {"url": "https://medium.com/tag/python?source=post_page-----883a54faafad---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/haar-cascades?source=post_page-----883a54faafad---------------haar_cascades-----------------", "anchor_text": "Haar Cascades"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----883a54faafad---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F883a54faafad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=-----883a54faafad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F883a54faafad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=-----883a54faafad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F883a54faafad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----883a54faafad--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F883a54faafad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----883a54faafad---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----883a54faafad--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----883a54faafad--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----883a54faafad--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----883a54faafad--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----883a54faafad--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----883a54faafad--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----883a54faafad--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----883a54faafad--------------------------------", "anchor_text": ""}, {"url": "https://piotrr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://piotrr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dev Dash MD MPH"}, {"url": "https://piotrr.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://www.linkedin.com/in/dev-dash-6b6834173/", "anchor_text": "https://www.linkedin.com/in/dev-dash-6b6834173/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21d76fb2c1a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=post_page-21d76fb2c1a9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F78b6f9b4cc46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-step-facial-recognition-with-colab-883a54faafad&newsletterV3=21d76fb2c1a9&newsletterV3Id=78b6f9b4cc46&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}