{"url": "https://towardsdatascience.com/preparing-for-the-unexpected-b8b07ac955d6", "time": 1682994804.3053608, "path": "towardsdatascience.com/preparing-for-the-unexpected-b8b07ac955d6/", "webpage": {"metadata": {"title": "Preparing for the Unexpected. How to apply your model to input it has\u2026 | by Yoel Zeldes | Towards Data Science", "h1": "Preparing for the Unexpected", "description": "An OOV value is associated with values not seen by the model at training time. Hence, if we get an OOV value at inference time, the model won\u2019t know what to do with it. What can we do about it?"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Collaborative_filtering", "anchor_text": "collaborative filtering", "paragraph_index": 6}, {"url": "https://engineering.taboola.com/preparing-for-the-unexpected", "anchor_text": "engineering.taboola.com", "paragraph_index": 15}], "all_paragraphs": ["Some of the problems we tackle using machine learning involve categorical features that represent real world objects, such as words, items and categories. So what happens when at inference time we get new object values that have never been seen before? How can we prepare ourselves in advance so we can still make sense out of the input?", "Unseen values, also called OOV (Out of Vocabulary) values, must be handled properly. Different algorithms have different methods to deal with OOV values. Different assumptions on the categorical features should be treated differently as well.", "In this post, I\u2019ll focus on the case of deep learning applied to dynamic data, where new values appear all the time. I\u2019ll use Taboola\u2019s recommender system as an example. Some of the inputs the model gets at inference time contain unseen values \u2014 this is common in recommender systems. Examples include:", "So what\u2019s the challenge with OOV values?", "An OOV value is associated with values not seen by the model at training time. Hence, if we get an OOV value at inference time, the model won\u2019t know what to do with it.", "One simple solution is to replace all the rare values with a special OOV token before training. Since all OOV values are the same from the model\u2019s point of view, we\u2019ll replace them with the OOV token at inference time. This solution has two positive outcomes:", "The model uses the item id feature to memorize different information per item, similarly to the pure collaborative filtering approach. Rare items that are injected with the OOV token can\u2019t benefit from it, so the model performs worse on them.", "The interesting thing is that even if we don\u2019t use the item id at all during training, the model still performs worse on rare items! This is because they come from a distribution different than that of the general population. They have specific characteristics \u2014 maybe they performed poorly online, which caused Taboola\u2019s recommender system to recommend them less, and in turn \u2014 they became rare in the dataset. So why does this distribution difference matter?", "If we learn the OOV embedding using this special distribution, it won\u2019t generalize to the general population. Think about it this way \u2014 every item was a new item at some point. At that point, it was injected with the OOV token. So the OOV embedding should perform well for all possible items.", "In order to learn the OOV embedding using the general population, we can inject the OOV token to a random set of examples from the dataset before we start the training process. But how many examples will suffice?", "The more we sample, the better the OOV embedding will be. But at the same time, the model will be exposed to a fewer number of non-OOV values, so the performance will degrade.", "How can we use lots of examples to train the OOV embedding while at the same time use the same examples to train the non-OOV embeddings? Instead of randomly injecting the OOV token before starting to train, we chose the following approach: in each epoch the model trains using all of the available values (the OOV token isn\u2019t injected). At the end of the epoch we sample a random set of examples, inject the OOV token, and train the model once again. This way, we enjoy both worlds!", "As was done in the previous approach, we also inject the OOV token to rare values \u2014 to avoid overfitting.", "To evaluate the new approach, we injected the OOV token to all of the examples and evaluated our offline metric (MSE). It improved by 15% compared to randomly injecting the OOV token before the model starts to train.", "Our model had been used in production for a long time before we thought of the new approach. It could have been easy to miss this potential performance gain, since the model performed well overall. It just stresses the fact that you always have to look for the unexpected!", "Originally published by me at engineering.taboola.com.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb8b07ac955d6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yoelzeldes.medium.com/?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": ""}, {"url": "https://yoelzeldes.medium.com/?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": "Yoel Zeldes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa609ddb637b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&user=Yoel+Zeldes&userId=a609ddb637b2&source=post_page-a609ddb637b2----b8b07ac955d6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb8b07ac955d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb8b07ac955d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Collaborative_filtering", "anchor_text": "collaborative filtering"}, {"url": "https://engineering.taboola.com/preparing-for-the-unexpected", "anchor_text": "engineering.taboola.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b8b07ac955d6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b8b07ac955d6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b8b07ac955d6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b8b07ac955d6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb8b07ac955d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&user=Yoel+Zeldes&userId=a609ddb637b2&source=-----b8b07ac955d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb8b07ac955d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&user=Yoel+Zeldes&userId=a609ddb637b2&source=-----b8b07ac955d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb8b07ac955d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb8b07ac955d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b8b07ac955d6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b8b07ac955d6--------------------------------", "anchor_text": ""}, {"url": "https://yoelzeldes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yoelzeldes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yoel Zeldes"}, {"url": "https://yoelzeldes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "816 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa609ddb637b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&user=Yoel+Zeldes&userId=a609ddb637b2&source=post_page-a609ddb637b2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffd4674272ff5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-for-the-unexpected-b8b07ac955d6&newsletterV3=a609ddb637b2&newsletterV3Id=fd4674272ff5&user=Yoel+Zeldes&userId=a609ddb637b2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}