{"url": "https://towardsdatascience.com/counting-passing-traffic-46850e4f5bd0", "time": 1683018192.2384682, "path": "towardsdatascience.com/counting-passing-traffic-46850e4f5bd0/", "webpage": {"metadata": {"title": "Counting passing traffic. Using Yolo3, MotionEye, Python and\u2026 | by David Moore | Towards Data Science", "h1": "Counting passing traffic", "description": "If you have been reading my column here on Towards Data Science, you will know that I am on a mission. I wanted to count the number of cars passing my house using Computer Vision and Motion\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/tagged/dofromscratch", "anchor_text": "column", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/doing-data-science-from-scratch-dab71253e777", "anchor_text": "mission", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/tuning-parameters-d0d736e15b60", "anchor_text": "tune the motion detection", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/doing-data-science-from-scratch-dab71253e777", "anchor_text": "the camera build", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/parsing-the-motion-log-file-55d013b458a1", "anchor_text": "early scripts", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/exploring-detection-events-32f1b980bba5", "anchor_text": "make sense of passing", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/tuning-parameters-d0d736e15b60", "anchor_text": "defer my earlier", "paragraph_index": 2}, {"url": "https://www.packtpub.com/product/learning-opencv-4-computer-vision-with-python-3-third-edition/9781789531619", "anchor_text": "Learning OpenCV 4 Computer Vision with Python3", "paragraph_index": 4}, {"url": "https://medium.com/u/2b8f8f0c68a1", "anchor_text": "Adrian Rosebrock", "paragraph_index": 5}, {"url": "https://pjreddie.com", "anchor_text": "Joseph Chet Redmon", "paragraph_index": 7}, {"url": "https://medium.com/u/8218e868cde5?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "Joseph Redmon", "paragraph_index": 7}, {"url": "https://medium.com/u/2b8f8f0c68a1", "anchor_text": "Adrian Rosebrock", "paragraph_index": 8}, {"url": "https://github.com/CognitiveDave/CountingTraffic/blob/main/yoloed.ipynb", "anchor_text": "Jupyter Notebook", "paragraph_index": 17}, {"url": "https://github.com/CognitiveDave/CountingTraffic/blob/main/data.csv", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://cognitivedave.hashnode.dev/raspberry-pi-4b-argon40-m2-case-enviro-sensor-hat", "anchor_text": "my Raspberry Pi", "paragraph_index": 21}], "all_paragraphs": ["If you have been reading my column here on Towards Data Science, you will know that I am on a mission. I wanted to count the number of cars passing my house using Computer Vision and Motion Detection. This article will push on with the work and describe how I tooled up for an initial end to end exercise. Doing Data Science from Scratch is involved but incredibly great fun.", "As a catch-up, I previously built a camera and then explained the need to tune the motion detection device(s). My earlier posts described the camera build and early scripts to review the data and make sense of passing traffic. We had even made a very early chart to plot motion events. Let\u2019s get on with the next instalment.", "Python really needs no introduction to the readers here on Towards Data Science. I will only add that I use Anaconda on my Mac M1 Mini these days and I see no difficulties. Spyder3 seems a bit dated and slightly slower on the Mac M1 than I expected. We have discussed MotionEyeOs already in the column, so I propose to skip most of the MotionEyeOs discussion and defer my earlier articles. That leaves me with Yolo3 and friends, and indeed that is fitting. I needed help from some friends with Yolo3 since Computer Vision is not my field. I am just a Finance guy at the end of the day. At least that is what I have been told by tech gurus for years. Let\u2019s meet the friends first then discuss how I used Yolo3 in my project. We can close with the results so far.", "Computer Vision, Deep Learning, and Machine Learning are not new topics for me. Indeed I can pull my own when I need to. However, since I do not believe in re-inventing the wheel, I chose some friends for the journey. Computer Vision is not my field, and I prefer to use experts rather than re-invent the wheel.", "Joseph Howse, and Joe Minichino provide Learning OpenCV 4 Computer Vision with Python3, and an excellent explanation of the field. It is a little too technical for beginners, I think. They do work through a proper application using Object Orientation and it sort of shamed me into thinking about my practice carefully.", "My other friend is PyImageSearch.com, and they provided a useful tutorial with code. Adrian Rosebrock has done some brilliant work to make the entire field more accessible to the community.", "With good friends, plenty of support, encouragement, and code available, I had no difficulty creating a service to process the Motion detection events and count those passing vehicles.", "\u201cYou only look once (YOLO) is a state-of-the-art, real-time object detection system. On a Pascal Titan X it processes images at 30 FPS and has a mAP of 57.9% on COCO test-dev.\u201d \u2014 Joseph Chet Redmon. You can read all about Darknet and Yolo from Joseph Redmon. One strategy would have been just to use Darknet and forget Python altogether.", "However, there won\u2019t have been any fun in that for me. I chose to modify one of pyimagesearch.com\u2019s scripts and use that as the base. Since the original code base belongs to Adrian Rosebrock, I will only illustrate how I orchestrated his code to perform services for me. You can do the tutorial and let Adrian explain it to you. He does a far better job than I would.", "I created a new class called myYolo. The class has an instantiator and some methods. myYolo.ImgList() examines a given directory and recovers a list of images. myYolo.ProcessImg() takes the path to an image file and runs it through Yolo doing object detection.", "So I created a new class, and whilst it is a little underdeveloped, it is ready for a bit of test. Operation is fairly simple", "Once I create an instance of myYolo, passing in the directory containing the images, that loads the Yolo3 model configuration, weights, labels and sets up the model ready for the inference workload. The .run() method simply triggers the process and creates a Python list object ( list of dictionaries ) which is persisted to disk. Three lines of code allow me to process all 192 photos of passing cars for the day of my experiment. We are counting the passing traffic.", "Counting the passing traffic then requires only a limited amount of steps. Those are:-", "As I am using MotionEyeOs, most steps are just managed by the MotionEyeOS image and my Camera. I added some screenshots below so you can see for yourself.", "Privacy is important and to protect the privacy of everyone I did two things:-", "To retrieve the 192 images for December 22nd, I can simply press \u2018Zipped\u2019, which triggers the download. Unzipping the file creates a folder named 2020\u201312\u201322, and that folder contains 192 images. Processing those 192 images with Yolo is then a matter of three lines of code.", "Once the script completes, \u2018done\u2019, the results are stored on disk, allowing us to do some Python cleaning and shaping. The disk file contains a serialized Python object, and in this case, it is a list of dictionaries, or you could say a JSON object. That might seem all very well and good, but Excel cannot read a Python object, and therefore we need to clean and shape that. Let\u2019s head over to Jupyter Notebooks to make an Excel file.", "Often times, I use Excel to explore my data upfront. In the old days, Excel couldn\u2019t handle large datasets, but with Power Query and Power Pivot, it turns out Excel is pretty handy these days. You can find my Jupyter Notebook in the GitHub repository for this article. If you wish to examine the code, you will find that convenient as I added many comments to explain the steps.", "In broad terms, I use Pickle to de-serialize and load the data from disk. There are a few steps to turn a List of Dictionaries into a reliable 2D matrix. Finally, I save my data as a CSV. Come on, my LOVE of Excel doesn\u2019t go as far as creating an actual Excel file. The end result is a 2D Data frame.", "You can examine the data file here. Now, after much work, I have a repeatable process that allows me to count passing cars. Undoubtedly the process needs a lot more testing and tuning. Let us take a quick look at the results and draw some conclusions.", "I hope you see the value of good friends and the re-use of code. I created my own class, wrapping tutorial code, and then using an instance of that class to process 192 pictures performing object detection with Yolo3. It seems like a crazy ride and well not as challenging as I expected so far. You could say I merely created a batch process using a script designed to load a single image.", "Inference with Yolo3 is computing intense. On average, my Raspberry Pi took 9.5 seconds per image. During those 192 10 secs, the board got super hot, and I mean over 80degrees hot. I seriously doubt that Raspberry Pi will continue to be my favourite for much longer.", "Here is a small table of the overall result.", "On December 22nd \u2014 Yolo was able to detect objects in 90 pictures out of the 192 available. A little under 50% which seems brilliant for a first run. There were 2 buses seen with the kids going to school and coming home. 3 people were detected out walking. 20 trucks went by. 1 photo contained 3 cars. 1 image included 2 vehicles. The \u2018tvmonitor\u2019 is a weird one. The Camera is deployed internally, and there is a reflection in the window from the room. The reflected image looks like a \u2018tvmonitor\u2019 to YOLO. Overall 62 cars passed by, 2 buses, and 20 trucks but only 3 persons confirming that the road is hazardous to walk on.", "Since I have the Neural Compute Stick, I will refactor my code to exploit OpenVino and transfer the CPU workload to the Inference Engine. I will report back on this effort and my investigation into 100 pictures where Yolo didn\u2019t find an object. Is that pointing to a need to train Yolo on an Irish data set? Exciting, please do come back!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "xMotorola Finance, xIBM Finance, xDeloitte Tax Management Consulting \u2014 Digital Transformation, ESG, Analytics"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F46850e4f5bd0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@cognitivedave", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cognitivedave.medium.com/?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": ""}, {"url": "https://cognitivedave.medium.com/?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "David Moore"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5fc60a27c1c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&user=David+Moore&userId=5fc60a27c1c4&source=post_page-5fc60a27c1c4----46850e4f5bd0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F46850e4f5bd0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F46850e4f5bd0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/dofromscratch", "anchor_text": "DOING DATA SCIENCE FROM SCRATCH TASK BY TASK"}, {"url": "https://unsplash.com/@sooprun?utm_source=medium&utm_medium=referral", "anchor_text": "Alex Suprun"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/tagged/dofromscratch", "anchor_text": "column"}, {"url": "https://towardsdatascience.com/doing-data-science-from-scratch-dab71253e777", "anchor_text": "mission"}, {"url": "https://towardsdatascience.com/tuning-parameters-d0d736e15b60", "anchor_text": "tune the motion detection"}, {"url": "https://towardsdatascience.com/doing-data-science-from-scratch-dab71253e777", "anchor_text": "the camera build"}, {"url": "https://towardsdatascience.com/parsing-the-motion-log-file-55d013b458a1", "anchor_text": "early scripts"}, {"url": "https://towardsdatascience.com/exploring-detection-events-32f1b980bba5", "anchor_text": "make sense of passing"}, {"url": "https://towardsdatascience.com/tuning-parameters-d0d736e15b60", "anchor_text": "defer my earlier"}, {"url": "https://www.packtpub.com/product/learning-opencv-4-computer-vision-with-python-3-third-edition/9781789531619", "anchor_text": "Learning OpenCV 4 Computer Vision with Python3"}, {"url": "https://www.packtpub.com/product/learning-opencv-4-computer-vision-with-python-3-third-edition/9781789531619", "anchor_text": "Learning OpenCV 4 Computer Vision with Python 3 - Third Edition | PacktYou've picked up this book, so you may already have an idea of what OpenCV is. Maybe you heard of capabilities that\u2026www.packtpub.com"}, {"url": "https://medium.com/u/2b8f8f0c68a1", "anchor_text": "Adrian Rosebrock"}, {"url": "https://www.pyimagesearch.com/2018/11/12/yolo-object-detection-with-opencv/", "anchor_text": "YOLO object detection with OpenCV - PyImageSearchIn this tutorial, you'll learn how to use the YOLO object detector to detect objects in both images and video streams\u2026www.pyimagesearch.com"}, {"url": "https://pjreddie.com", "anchor_text": "Joseph Chet Redmon"}, {"url": "https://medium.com/u/8218e868cde5?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "Joseph Redmon"}, {"url": "https://medium.com/u/2b8f8f0c68a1", "anchor_text": "Adrian Rosebrock"}, {"url": "https://github.com/CognitiveDave/CountingTraffic/blob/main/yoloed.ipynb", "anchor_text": "Jupyter Notebook"}, {"url": "https://github.com/CognitiveDave/CountingTraffic/blob/main/yoloed.ipynb", "anchor_text": "CognitiveDave/CountingTrafficCounting traffic flow past my house. Contribute to CognitiveDave/CountingTraffic development by creating an account on\u2026github.com"}, {"url": "https://github.com/CognitiveDave/CountingTraffic/blob/main/data.csv", "anchor_text": "here"}, {"url": "https://cognitivedave.hashnode.dev/raspberry-pi-4b-argon40-m2-case-enviro-sensor-hat", "anchor_text": "my Raspberry Pi"}, {"url": "https://medium.com/tag/dofromscratch?source=post_page-----46850e4f5bd0---------------dofromscratch-----------------", "anchor_text": "Dofromscratch"}, {"url": "https://medium.com/tag/python?source=post_page-----46850e4f5bd0---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----46850e4f5bd0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----46850e4f5bd0---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----46850e4f5bd0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F46850e4f5bd0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&user=David+Moore&userId=5fc60a27c1c4&source=-----46850e4f5bd0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F46850e4f5bd0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&user=David+Moore&userId=5fc60a27c1c4&source=-----46850e4f5bd0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F46850e4f5bd0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F46850e4f5bd0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----46850e4f5bd0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----46850e4f5bd0--------------------------------", "anchor_text": ""}, {"url": "https://cognitivedave.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cognitivedave.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "David Moore"}, {"url": "https://cognitivedave.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "217 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5fc60a27c1c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&user=David+Moore&userId=5fc60a27c1c4&source=post_page-5fc60a27c1c4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3d9220f2a184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounting-passing-traffic-46850e4f5bd0&newsletterV3=5fc60a27c1c4&newsletterV3Id=3d9220f2a184&user=David+Moore&userId=5fc60a27c1c4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}