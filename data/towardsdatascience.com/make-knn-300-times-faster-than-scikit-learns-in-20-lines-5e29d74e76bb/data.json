{"url": "https://towardsdatascience.com/make-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb", "time": 1683013763.8503308, "path": "towardsdatascience.com/make-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb/", "webpage": {"metadata": {"title": "Make kNN 300 times faster than Scikit-learn\u2019s in 20 lines! | by Jakub Adamczyk | Towards Data Science", "h1": "Make kNN 300 times faster than Scikit-learn\u2019s in 20 lines!", "description": "Speed up k nearest neighbors (kNN) classifier with faiss library - up to 300 times faster than Scikit-learn!"}, "outgoing_paragraph_urls": [{"url": "https://github.com/j-adamczyk/Towards_Data_Science/blob/master/faiss/kNN.py", "anchor_text": "link", "paragraph_index": 4}, {"url": "https://github.com/facebookresearch/faiss/blob/master/INSTALL.md", "anchor_text": "installation docs", "paragraph_index": 5}, {"url": "https://github.com/facebookresearch/faiss/wiki/Getting-started", "anchor_text": "g", "paragraph_index": 5}, {"url": "https://github.com/facebookresearch/faiss/wiki/Getting-started", "anchor_text": "started docs", "paragraph_index": 5}], "all_paragraphs": ["k Nearest Neighbors (kNN) is a simple ML algorithm for classification and regression. Scikit-learn features both versions with a very simple API, making it popular in machine learning courses. There is one issue with it \u2014 it\u2019s quite slow! But don\u2019t worry, we can make it work for bigger datasets with the Facebook faiss library.", "The kNN algorithm has to find the nearest neighbors in the training set for the sample being classified. As the dimensionality (number of features) of the data increases, the time needed to find nearest neighbors rises very quickly. To speed up prediction, in the training phase (.fit() method) kNN classifiers create data structures to keep the training dataset in a more organized way, that will help with nearest neighbor searches.", "In Scikit-learn, the default \u201cauto\u201d mode automatically chooses the algorithm, based on the training data size and structure. It\u2019s either a brute force search (for very small datasets), or one of the popular data structures for nearest neighbor lookups, k-d tree or ball tree. They are simple, often taught at computational geometry courses, but efficiency of their implementation in Scikit-learn is questionable at best. For example, you may have seen choosing only a small part of the MNIST dataset in kNN tutorials, about 10k \u2014 the reason for this is that for the entire dataset, which is 60k images, it would be far too slow. And today this doesn\u2019t even come close to \u201cbig data\u201d!", "Fortunately, the Facebook AI Research (FAIR) came up with excellent implementations of the nearest neighbor search algorithms, which are available in the faiss library. faiss offers CPU and GPU support, many different metrics, makes use of multiple cores, GPUs and machines and much more. With it, we can implement k nearest neighbor classifier that is not a few times faster than Scikit-learn\u2019s, but orders of magnitude faster!", "If you have trouble with the Github Gist below, the code is also available at my Github (link).", "A great feature of faiss is that it has both installation and build instructions (installation docs) and an excellent documentation with examples (getting started docs). After the installation, we can write the actual classifier. The code is quite simple, since we just mimic the Scikit-learn API.", "There are a few interesting elements here:", "I\u2019ve chosen a few popular datasets available in Scikit-learn for comparison. The train and predict times are compared. For easier reading, I\u2019ve explicitly written how many times faster is the faiss-based classifier than Scikit-learn\u2019s.", "All of those times have been measured with the time.process_time() function, that measures process time instead of wall clock time, for more accurate results. Results are averages of 5 runs.", "On average, training is almost 300 times faster, while prediction is about 7.5 times faster on average. Also note that for the MNIST dataset, which has size realistic for modern datasets, we get 17 times speedup, which is huge. I was ready to give up with Scikit-learn after 10 minutes, and it took almost 15 minutes CPU time (the wall clock was even longer)!", "With 20 lines of code, we get a huge speed boost for kNN classifier with faiss library. If you need, you can get even better with GPU, multiple GPUs, approximate nearest neighbor search and much more, which is nicely explained in faiss docs.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science student, ML engineer, Data Science and ML algorithms enthusiast."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5e29d74e76bb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jakubadamczyk10?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jakubadamczyk10?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": "Jakub Adamczyk"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa2bd22267201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&user=Jakub+Adamczyk&userId=a2bd22267201&source=post_page-a2bd22267201----5e29d74e76bb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e29d74e76bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e29d74e76bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pl.wikipedia.org/wiki/K_najbli%C5%BCszych_s%C4%85siad%C3%B3w#/media/Plik:KnnClassification.svg", "anchor_text": "source"}, {"url": "https://github.com/j-adamczyk/Towards_Data_Science/blob/master/faiss/kNN.py", "anchor_text": "link"}, {"url": "https://github.com/facebookresearch/faiss/blob/master/INSTALL.md", "anchor_text": "installation docs"}, {"url": "https://github.com/facebookresearch/faiss/wiki/Getting-started", "anchor_text": "g"}, {"url": "https://github.com/facebookresearch/faiss/wiki/Getting-started", "anchor_text": "started docs"}, {"url": "https://github.com/facebookresearch/faiss/wiki/MetricType-and-distances", "anchor_text": "metrics docs"}, {"url": "https://github.com/facebookresearch/faiss/wiki/Faiss-indexes", "anchor_text": "indices docs"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5e29d74e76bb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/k-nearest-neighbours?source=post_page-----5e29d74e76bb---------------k_nearest_neighbours-----------------", "anchor_text": "K Nearest Neighbours"}, {"url": "https://medium.com/tag/knn?source=post_page-----5e29d74e76bb---------------knn-----------------", "anchor_text": "Knn"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5e29d74e76bb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----5e29d74e76bb---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5e29d74e76bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&user=Jakub+Adamczyk&userId=a2bd22267201&source=-----5e29d74e76bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5e29d74e76bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&user=Jakub+Adamczyk&userId=a2bd22267201&source=-----5e29d74e76bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e29d74e76bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5e29d74e76bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5e29d74e76bb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5e29d74e76bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jakubadamczyk10?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jakubadamczyk10?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jakub Adamczyk"}, {"url": "https://medium.com/@jakubadamczyk10/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "89 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa2bd22267201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&user=Jakub+Adamczyk&userId=a2bd22267201&source=post_page-a2bd22267201--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F494f9b4fd578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb&newsletterV3=a2bd22267201&newsletterV3Id=494f9b4fd578&user=Jakub+Adamczyk&userId=a2bd22267201&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}