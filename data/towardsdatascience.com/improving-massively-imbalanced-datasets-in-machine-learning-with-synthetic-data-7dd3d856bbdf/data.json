{"url": "https://towardsdatascience.com/improving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf", "time": 1683011669.953017, "path": "towardsdatascience.com/improving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf/", "webpage": {"metadata": {"title": "Improving massively imbalanced datasets in machine learning with synthetic data | by Alexander Watson | Towards Data Science", "h1": "Improving massively imbalanced datasets in machine learning with synthetic data", "description": "Handling imbalanced datasets in machine learning is a difficult challenge, and can include topics such as payment fraud, diagnosing cancer or disease, and even cyber security attacks. What all of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "popular Kaggle fraud dataset", "paragraph_index": 0}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Credit Card Fraud Detection", "paragraph_index": 1}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "gretel-synthetics", "paragraph_index": 5}, {"url": "https://arxiv.org/abs/1106.1813", "anchor_text": "paper", "paragraph_index": 6}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "gretel-synthetics", "paragraph_index": 7}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "Gretel Synthetics", "paragraph_index": 8}, {"url": "https://gretel-synthetics.readthedocs.io/en/stable/api/batch.html", "anchor_text": "DataFrame training mode", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/reducing-ai-bias-with-synthetic-data-7bddc39f290d", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/dont-stop-at-ensembles-unconventional-deep-learning-techniques-for-tabular-data-8d4e154f1053", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://gretel.ai/", "anchor_text": "Gretel.ai", "paragraph_index": 18}, {"url": "https://twitter.com/gretel_ai", "anchor_text": "twitter", "paragraph_index": 18}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "Gretel-synthetics", "paragraph_index": 19}, {"url": "https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667", "anchor_text": "Colaboratory", "paragraph_index": 19}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "GitHub", "paragraph_index": 19}, {"url": "http://Gretel.ai", "anchor_text": "Gretel.ai", "paragraph_index": 21}], "all_paragraphs": ["Handling imbalanced datasets in machine learning is a difficult challenge, and can include topics such as payment fraud, diagnosing cancer or disease, and even cyber security attacks. What all of these have in common are that only a very small percentage of the overall transactions are actually fraud, and those are the ones that we really care about detecting. In this post, we will boost accuracy on a popular Kaggle fraud dataset by training a generative synthetic data model to create additional fraudulent records. Uniquely, this model will incorporate features from both fraudulent records and their nearest neighbors, which are labeled as non-fraudulent but are close enough to the fraudulent records to be a little \u201cshady\u201d.", "For this post, we selected the popular \u201cCredit Card Fraud Detection\u201d dataset on Kaggle. This dataset contains labeled transactions from European credit card holders in September 2013. To protect user identities, the dataset uses dimensionality reduction of sensitive features into 27 floating point columns (V1\u201327) and a Time column (the number of seconds elapsed between this transaction and the first in the dataset). For this post, we will work with the first 10k records in the Credit Card fraud dataset- click below to generate the graphs below in Google Colaboratory.", "Let\u2019s see what kind of performance we can get detecting fraudulent records with a cutting edge ML classifier. We will start by dividing our dataset into a Train and Test set.", "Wow, 99.75% detection. That\u2019s awesome, right?! Maybe- looking at overall model accuracy just shows how well the model performed across the entire set, but not how well we did on detecting fraudulent records. To see how well we really performed, print a confusion matrix and accuracy report.", "Above we can see that despite our 99.75% overall accuracy, we misclassified 43% of fraud examples in our test set!", "In this section we will focus on how we can improve model performance and generalization for the Fraud records, by using gretel-synthetics to generate additional examples of fraudulent records. Let\u2019s start with what we want to accomplish- our goal is to generate additional samples of fraudulent records that will help our classifier generalize and better detect the fraudulent records in our test set.", "A popular technique in the data science community to achieve this is called SMOTE (Synthetic Minority Oversampling Technique), described by Nitesh Chawla et al. in their 2002 paper. SMOTE works by selecting examples from the minority class, finding their nearest neighbors in the minority class, and effectively interpolating new points between them. SMOTE does not have the ability to incorporate data from records outside of the minority class, which in our examples may include useful information- including fraudulent-like or mislabeled records.", "Having only 31 examples of fraudulent data in our training set presents a unique challenge for generalization, as gretel-synthetics utilizes deep learning techniques to learn and generate new samples, which traditionally require a lot of data to converge. Open the notebook below to generate your own synthetic fraud dataset for free with Google Colab.", "By borrowing SMOTE\u2019s approach of finding the nearest neighbors to to the fraudulent set and incorporating a few of the nearest neighbors from the majority class, we have the opportunity both to expand our training set examples, and to incorporate in some learnings from our fraudulent-like (let\u2019s just call them shady) records. This approach will not require any changes to Gretel Synthetics, we\u2019re just intelligently picking the dataset from the fraudulent + nearest positive neighbor (shady) records. Let\u2019s get started!", "To build our synthetic model, will use Gretel\u2019s new DataFrame training mode defaults with a few parameters set below to optimize results:", "Now let\u2019s take a look at our synthetic data and see if we can visually confirm that our synthetic records are representative of the fraudulent records that they were trained on. Our dataset has 30 dimensions, so we will use a dimensionality reduction technique from data science called Principal Component Analysis (PCA) to visualize the data in 2D and 3D.", "Below we can see our training, synthetic, and test datasets compressed down to two dimensions. Visually, it looks like the 883 new fraudulent synthetic records may be very helpful to the classifier, in addition to the 31 original training examples. We added the 7 test-set positive examples (where our default model mis-classifies 3/7, and we\u2019re hoping that the augmented synthetic data will help boost detection.", "From what we can see in our graph, it appears our synthetically generated fraudulent examples may be really useful! Note what appear to be a false positive examples near the Training Negative set. If you see a lot of these examples, try reducing the NEAREST_NEIGHBOR_COUNT from 5 to 3 for better results. Let\u2019s visualize the same PCA visualization 3 dimensions.", "Looking at the datasets above, it appears that boosting our minority set of fraudulent records with synthetic data may help significantly with model performance. Let\u2019s try it!", "Now we reload the train and test datasets, but this time augment our existing training data with the newly generated synthetic records.", "Train XGBoost on the augmented dataset, run the model against the test dataset and examine the confusion matrix.", "As we have seen, it is a hard challenge to train machine learning models to accurately detect extreme minority classes. But, synthetic data creates a way to boost accuracy and potentially improve models ability to generalize to new datasets- and can uniquely incorporate features and correlations from the entire dataset into synthetic fraud examples.", "For next steps, try running the notebooks above on your own data. Want to learn more about synthetic data? Check out Towards Data Science articles mentioning Gretel-Synthetics here and here.", "At Gretel.ai we are super excited about the possibility of using synthetic data to augment training sets to create ML and AI models that generalize better against unknown data and with reduced algorithmic biases. We\u2019d love to hear about your use cases- feel free to reach out to us for a more in-depth discussion in the comments, twitter, or hi@gretel.ai. Follow us to keep up on the latest trends with synthetic data!", "Interested in training on your own dataset? Gretel-synthetics is free and open source, and you can start experimenting in seconds via Colaboratory. If you like gretel-synthetics give us a \u2b50 on GitHub!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-Founder at Gretel.ai, previously GM at AWS. Love artificial intelligence and security. @alexwatson405"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7dd3d856bbdf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zredlined?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zredlined?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": "Alexander Watson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcacf157aade0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&user=Alexander+Watson&userId=cacf157aade0&source=post_page-cacf157aade0----7dd3d856bbdf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7dd3d856bbdf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7dd3d856bbdf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "popular Kaggle fraud dataset"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Credit Card Fraud Detection"}, {"url": "https://colab.research.google.com/github/gretelai/gretel-synthetics/blob/master/examples/research/synthetics_knn_classify_and_visualize.ipynb", "anchor_text": "Classify-and-visualize-fraud-datasetcolab.research.google.com"}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "gretel-synthetics"}, {"url": "https://arxiv.org/abs/1106.1813", "anchor_text": "paper"}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "gretel-synthetics"}, {"url": "https://colab.research.google.com/github/gretelai/gretel-synthetics/blob/master/examples/research/synthetics_knn_generate.ipynb", "anchor_text": "gretel-synthetics-generate-fraud-datacolab.research.google.com"}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "Gretel Synthetics"}, {"url": "https://gretel-synthetics.readthedocs.io/en/stable/api/batch.html", "anchor_text": "DataFrame training mode"}, {"url": "https://towardsdatascience.com/reducing-ai-bias-with-synthetic-data-7bddc39f290d", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/dont-stop-at-ensembles-unconventional-deep-learning-techniques-for-tabular-data-8d4e154f1053", "anchor_text": "here"}, {"url": "https://gretel.ai/", "anchor_text": "Gretel.ai"}, {"url": "https://twitter.com/gretel_ai", "anchor_text": "twitter"}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "Gretel-synthetics"}, {"url": "https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667", "anchor_text": "Colaboratory"}, {"url": "https://github.com/gretelai/gretel-synthetics", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7dd3d856bbdf---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7dd3d856bbdf---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/synthetic-data?source=post_page-----7dd3d856bbdf---------------synthetic_data-----------------", "anchor_text": "Synthetic Data"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7dd3d856bbdf---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7dd3d856bbdf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&user=Alexander+Watson&userId=cacf157aade0&source=-----7dd3d856bbdf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7dd3d856bbdf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&user=Alexander+Watson&userId=cacf157aade0&source=-----7dd3d856bbdf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7dd3d856bbdf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7dd3d856bbdf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7dd3d856bbdf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7dd3d856bbdf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zredlined?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zredlined?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexander Watson"}, {"url": "https://medium.com/@zredlined/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "216 Followers"}, {"url": "http://Gretel.ai", "anchor_text": "Gretel.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcacf157aade0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&user=Alexander+Watson&userId=cacf157aade0&source=post_page-cacf157aade0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5aeec3551ca4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-massively-imbalanced-datasets-in-machine-learning-with-synthetic-data-7dd3d856bbdf&newsletterV3=cacf157aade0&newsletterV3Id=5aeec3551ca4&user=Alexander+Watson&userId=cacf157aade0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}