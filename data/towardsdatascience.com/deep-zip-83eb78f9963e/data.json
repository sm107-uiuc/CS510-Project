{"url": "https://towardsdatascience.com/deep-zip-83eb78f9963e", "time": 1682995895.565117, "path": "towardsdatascience.com/deep-zip-83eb78f9963e/", "webpage": {"metadata": {"title": "Deep Zip: An Open Zipper Detector | by Jean-Frederic Plante | Towards Data Science", "h1": "Deep Zip: An Open Zipper Detector", "description": "Zippers: patented in 1851, gaining wide adoption since the 20s, and still letting us down to this day. In this age of flying cars, can technology help us? Can we somehow get an alert, beyond an\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/jeanfredericplante/lowflyer", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://www.kaggle.com/blocks/zipper-data-exploration-and-processing", "anchor_text": "notebook", "paragraph_index": 7}, {"url": "https://www.kaggle.com/blocks/zipper-training", "anchor_text": "notebook", "paragraph_index": 15}, {"url": "https://www.kaggle.com/willkoehrsen/automated-model-tuning", "anchor_text": "Will Koerhsen\u2019s great article", "paragraph_index": 21}, {"url": "https://www.kaggle.com/blocks/zipper-training", "anchor_text": "notebook", "paragraph_index": 22}, {"url": "https://www.kaggle.com/blocks/zipper-training/", "anchor_text": "notebook", "paragraph_index": 26}], "all_paragraphs": ["Zippers: patented in 1851, gaining wide adoption since the 20s, and still letting us down to this day. In this age of flying cars, can technology help us? Can we somehow get an alert, beyond an amused coworker, when your flyer is open and shouldn\u2019t be?", "Our trusted smartphones are packed with sensors, and one of them is a magnetometer. If your zipper is made of metal, the magnetic field captured from a magnetometer in its proximity\u2014such as in your pocket\u2014should be disturbed as the metal loop created by the zipper changes shape between open and close state.", "Likely, absolute values of the magnetic field wouldn\u2019t be traceable to a state. However, dynamic changes such as ones captured while walking (triggering the distance between the zipper sides to vary), should conceivably give you an identifiable signal.", "In this article, I am describing my experiments with this idea. From capturing and processing the signal to fitting and optimizing different 3 different models: a gradient boosting machine, a convolutional neural network (ZipNet), and an RNN.", "A small iOS app will capture magnetometer and accelerometer data and export those to csv for analysis. You can find it here.", "To validate the initial hypothesis, I sampled while opening and closing the zipper. I also did the same gesture without touching the zipper to make sure this was not me distorting the magnetic field. At first glance, it looks like there is a signal (see below).", "Generating real life data was a thrill. I\u2019ll gloss over that but I generated 60 episodes for the 4 quadrants when walking or not and when open or not totaling 95K length time-series.", "Here is an example of the signal in the 4 quadrants (notebook). Walking (left) vs not-walking (right) should be easy to detect. Open vs closed when walking (left) would seem plausible if the frequency pattern difference on the magnetic signal (orange, blue and green lines for x, y and z axis respectively) is consistent. In particular over different samples, mz appeared to have a small bump after the peak more pronounced when closed than when opened.", "With the premise of detecting the variations in the shape of the magnetic signal, we want to serialize detecting whether the user is still or in motion\u2014then only if in motion evaluate if the magnetic signal looks like one when the zipper is open.", "Aside from setting apart a validation set and normalizing the data, there is an additional preprocessing step to prepare the data for time series classification. We chunk the data with a sliding time window which involves two hyper-parameters: the window size, and the step increment between each training samples.", "Intuitively, we want the window size to be large enough to capture a couple of cycles but small enough so the detector reacts rapidly. On that data, I tested various windows and didn\u2019t see much difference beyond 128 samples. For the step, I chose 10.", "Data augmentation: let\u2019s add \u2018window warping\u2019 which squeezes or expands the time series (artificially creating samples where you would be walking faster or slower). Let\u2019s also add noise to the input signals (a gaussian), helping the model to distinguish noise from signal.", "Feature engineering: to help our classifier, let\u2019s process the input data with a Fourier transform and add this to the input. We remove the 0 freq which is the average, already captured in the raw data.", "This gives us a total of 12 dimensions of input features if we take the accelerometer and magnetic signal.", "Avoiding validation data contamination: With the data preprocessed as above, we can\u2019t just randomly split between training and validation with say an 80%, 20% rule. If one of the sampling episode is split, the training will have seen some of the validation data due to the overlapping windows. Hence, training and validation are split by episodes first, trying to keep the classes balanced, and then processed.", "Let\u2019s first test the popular LGBM algorithm (notebook). For this, we need to reshape with a training tensor of shape (# samples, # features).", "As seen previously, we can eyeball the difference between walking and standing episodes and so does our classifier. With the default classifier we get close to 100% accuracy (titles of the figures below show accuracy, f1 score and recall).", "This is more challenging, and where careful preprocessing of the time series is critical to getting decent results. With default LGBM settings and depending on the sampling of the episodes, we get typically 80% accuracy (see dist below).", "Below is a fairly typical sample of performance, with the classifier predicting 86% the zipper is open when it is (recall) and an 82% accuracy.", "This is after adding back the acceleration in addition the magnetic field which seems to improve the performance, possibly allowing the model to differentiate magnetic variation from the walking vs from the zipper.", "Data augmentation also seems to be helping slightly, below is adding 5% variants on time and 2% gaussian noise on the normalized signal.", "Another 1\u20132% incremental improvement come with hyper-parameters optimization (please check Will Koerhsen\u2019s great article on the topic which I copiously copied from in the notebook).", "Let\u2019s try a convolutional neural network as a classifier. I will be using PyTorch and the very awesome fast.ai library for training (notebook). This custom convnet uses convolutions only for the time-series inputs and bypasses the fft inputs into the dense layers directly.", "For the same episodes samples as for the LGBM (and augmentation) here is the comparative performance. Lower accuracy, higher recall.", "While I had fun creating ZipNet, LGBM performed in most cases better. Let\u2019s check a vanilla LSTM.", "Same for vanilla LSTM, LGBM wins for that small dataset although arguably I didn\u2019t spend much time optimizing this.", "Ensembling the 3 models didn\u2019t help. You can find an attempt in the accompanying notebook.", "Your phone just got more personal. On (notebook) paper, within the environment I tested, with my phone, with my jeans, using your phone\u2019s magnetometer to detect an open flyer appears to work decently (80% accuracy). I am doubtful it would generalize with the little data I collected, so here is to a new crowdsourced dataset and Kaggle competition.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Voice and Machine Learning TPM at HP"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F83eb78f9963e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jfrederic.plante?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jfrederic.plante?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": "Jean-Frederic Plante"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fca01e1a5018a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&user=Jean-Frederic+Plante&userId=ca01e1a5018a&source=post_page-ca01e1a5018a----83eb78f9963e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83eb78f9963e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83eb78f9963e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@stairhopper?utm_source=medium&utm_medium=referral", "anchor_text": "Alex Holyoake"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/jeanfredericplante/lowflyer", "anchor_text": "here"}, {"url": "https://www.kaggle.com/blocks/zipper-data-exploration-and-processing", "anchor_text": "notebook"}, {"url": "https://www.kaggle.com/blocks/zipper-training", "anchor_text": "notebook"}, {"url": "https://www.kaggle.com/willkoehrsen/automated-model-tuning", "anchor_text": "Will Koerhsen\u2019s great article"}, {"url": "https://www.kaggle.com/blocks/zipper-training", "anchor_text": "notebook"}, {"url": "https://www.kaggle.com/blocks/zipper-training/", "anchor_text": "notebook"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----83eb78f9963e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----83eb78f9963e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/hacks?source=post_page-----83eb78f9963e---------------hacks-----------------", "anchor_text": "Hacks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83eb78f9963e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&user=Jean-Frederic+Plante&userId=ca01e1a5018a&source=-----83eb78f9963e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83eb78f9963e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&user=Jean-Frederic+Plante&userId=ca01e1a5018a&source=-----83eb78f9963e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83eb78f9963e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F83eb78f9963e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----83eb78f9963e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----83eb78f9963e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----83eb78f9963e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----83eb78f9963e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----83eb78f9963e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jfrederic.plante?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jfrederic.plante?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jean-Frederic Plante"}, {"url": "https://medium.com/@jfrederic.plante/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "10 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fca01e1a5018a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&user=Jean-Frederic+Plante&userId=ca01e1a5018a&source=post_page-ca01e1a5018a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fca01e1a5018a%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-zip-83eb78f9963e&user=Jean-Frederic+Plante&userId=ca01e1a5018a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}