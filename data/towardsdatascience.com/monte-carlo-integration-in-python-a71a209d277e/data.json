{"url": "https://towardsdatascience.com/monte-carlo-integration-in-python-a71a209d277e", "time": 1683011788.46418, "path": "towardsdatascience.com/monte-carlo-integration-in-python-a71a209d277e/", "webpage": {"metadata": {"title": "Monte Carlo integration in Python | by Tirthajyoti Sarkar | Towards Data Science", "h1": "Monte Carlo integration in Python", "description": "Disclaimer: The inspiration for this article stemmed from Georgia Tech\u2019s Online Masters in Analytics (OMSA) program study material. I am proud to pursue this excellent Online MS program. You can also\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.gatech.edu/academics/degrees/masters/analytics-online-degree-oms-analytics", "anchor_text": "Georgia Tech\u2019s Online Masters in Analytics (OMSA)", "paragraph_index": 0}, {"url": "http://catalog.gatech.edu/programs/analytics-ms/#onlinetext", "anchor_text": "check the details here.", "paragraph_index": 0}, {"url": "https://www.solver.com/press/monte-carlo-methods-led-atomic-bomb-may-be-your-best-bet-business-decision-making", "anchor_text": "first and most famous uses of this technique was during the Manhattan Project", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Riemann_sum", "anchor_text": "Riemann sum", "paragraph_index": 13}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad", "anchor_text": "function in the Scipy package", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian Normal distribution", "paragraph_index": 44}, {"url": "https://www.mathsisfun.com/data/confidence-interval.html", "anchor_text": "confidence intervals", "paragraph_index": 44}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "Monte Carlo simulation techniques", "paragraph_index": 51}, {"url": "https://medium.com/@tirthajyoti/membership", "anchor_text": "Medium member", "paragraph_index": 54}], "all_paragraphs": ["Disclaimer: The inspiration for this article stemmed from Georgia Tech\u2019s Online Masters in Analytics (OMSA) program study material. I am proud to pursue this excellent Online MS program. You can also check the details here.", "Monte Carlo, is in fact, the name of the world-famous casino located in the eponymous district of the city-state (also called a Principality) of Monaco, on the world-famous French Riviera.", "It turns out that the casino inspired the minds of famous scientists to devise an intriguing mathematical technique for solving complex problems in statistics, numerical computing, system simulation.", "One of the first and most famous uses of this technique was during the Manhattan Project when the chain-reaction dynamics in highly enriched uranium presented an unimaginably complex theoretical calculation to the scientists. Even the genius minds like John Von Neumann, Stanislaw Ulam, Nicholas Metropolis could not tackle it in the traditional way. They, therefore, turned to the wonderful world of random numbers and let these probabilistic quantities tame the originally intractable calculations.", "Amazingly, these random variables could solve the computing problem, which stymied the sure-footed deterministic approach. The elements of uncertainty actually won.", "Just like uncertainty and randomness rule in the world of Monte Carlo games. That was the inspiration for this particular moniker.", "Today, it is a technique used in a wide swath of fields \u2014", "For all its successes and fame, the basic idea is deceptively simple and easy to demonstrate. We demonstrate it in this article with a simple set of Python code.", "One of the first and most famous uses of this technique was during the Manhattan Project", "While the general Monte Carlo simulation technique is much broader in scope, we focus particularly on the Monte Carlo integration technique here.", "It is nothing but a numerical method for computing complex definite integrals, which lack closed-form analytical solutions.", "It\u2019s not easy or downright impossible to get a closed-form solution for this integral in the indefinite form. But numerical approximation can always give us the definite integral as a sum.", "Here is the plot of the function.", "There are many such techniques under the general category of Riemann sum. The idea is just to divide the area under the curve into small rectangular or trapezoidal pieces, approximate them by the simple geometrical calculations, and sum those components up.", "For a simple illustration, I show such a scheme with only 5 equispaced intervals.", "For the programmer friends, in fact, there is a ready-made function in the Scipy package which can do this computation fast and accurately.", "What if I told you that I do not need to pick the intervals so uniformly, and, in fact, I can go completely probabilistic, and pick 100% random intervals to compute the same integral?", "Crazy talk? My choice of samples could look like this\u2026", "We don\u2019t have the time or scope to prove the theory behind it, but it can be shown that with a reasonably high number of random sampling, we can, in fact, compute the integral with sufficiently high accuracy!", "We just choose random numbers (between the limits), evaluate the function at those points, add them up, and scale it by a known factor. We are done.", "OK. What are we waiting for? Let\u2019s demonstrate this claim with some simple Python code.", "For all its successes and fame, the basic idea is deceptively simple and easy to demonstrate.", "If we are trying to calculate an integral \u2014 any integral \u2014 of the form below,", "we just replace the \u2018estimate\u2019 of the integral by the following average,", "where the U\u2019s represent uniform random numbers between 0 and 1. Note, how we replace the complex integration process by simply adding up a bunch of numbers and taking their average!", "In any modern computing system, programming language, or even commercial software packages like Excel, you have access to this uniform random number generator. Check out my article on this topic,", "We just choose random numbers (between the limits), evaluate the function at those points, add them up, and scale it by a known factor. We are done.", "Here is a Python function, which accepts another function as the first argument, two limits of integration, and an optional integer to compute the definite integral represented by the argument function.", "The code may look slightly different than the equation above (or another version that you might have seen in a textbook). That is because I am making the computation more accurate by distributing random samples over 10 intervals.", "For our specific example, the argument function looks like,", "And we can compute the integral by simply passing this to the monte_carlo_uniform() function,", "Here, as you can see, we have taken 100 random samples between the integration limits a = 0 and b = 4.", "This integral cannot be calculated analytically. So, we need to benchmark the accuracy of the Monte Carlo method against another numerical integration technique anyway. We chose the Scipy integrate.quad()function for that.", "Now, you may also be thinking \u2014 what happens to the accuracy as the sampling density changes. This choice clearly impacts the computation speed \u2014 we need to add less number of quantities if we choose a reduced sampling density.", "Therefore, we simulated the same integral for a range of sampling density and plotted the result on top of the gold standard \u2014 the Scipy function represented as the horizontal line in the plot below,", "Therefore, we observe some small perturbations in the low sample density phase, but they smooth out nicely as the sample density increases. In any case, the absolute error is extremely small compared to the value returned by the Scipy function \u2014 on the order of 0.02%.", "The Monte Carlo trick works fantastically!", "But is it as fast as the Scipy method? Better? Worse?", "We try to find out by running 100 loops of 100 runs (10,000 runs in total) and obtaining the summary statistics.", "In this particular example, the Monte Carlo calculations are running twice as fast as the Scipy integration method!", "While this kind of speed advantage depends on many factors, we can be assured that the Monte Carlo technique is not a slouch when it comes to the matter of computation efficiency.", "we observe some small perturbations in the low sample density phase, but they smooth out nicely as the sample density increases", "For a probabilistic technique like Monte Carlo integration, it goes without saying that mathematicians and scientists almost never stop at just one run but repeat the calculations for a number of times and take the average.", "Here is a distribution plot from a 10,000 run experiment.", "As you can see, the plot almost resembles a Gaussian Normal distribution and this fact can be utilized to not only get the average value but also construct confidence intervals around that result.", "Although for our simple illustration (and for pedagogical purpose), we stick to a single-variable integral, the same idea can easily be extended to high-dimensional integrals with multiple variables.", "And it is in this higher dimension that the Monte Carlo method particularly shines as compared to Riemann sum based approaches. The sample density can be optimized in a much more favorable manner for the Monte Carlo method to make it much faster without compromising the accuracy.", "In mathematical terms, the convergence rate of the method is independent of the number of dimensions. In machine learning speak, the Monte Carlo method is the best friend you have to beat the curse of dimensionality when it comes to complex integral calculations.", "Read this article for a great introduction,", "And it is in this higher dimension that the Monte Carlo method particularly shines as compared to Riemann sum based approaches.", "We introduced the concept of Monte Carlo integration and illustrated how it differs from the conventional numerical integration methods. We also showed a simple set of Python codes to evaluate a one-dimensional function and assess the accuracy and speed of the techniques.", "The broader class of Monte Carlo simulation techniques is more exciting and is used in a ubiquitous manner in fields related to artificial intelligence, data science, and statistical modeling.", "For example, the famous Alpha Go program from DeepMind used a Monte Carlo search technique to be computationally efficient in the high-dimensional space of the game Go. Numerous such examples can be found in practice.", "If you liked this article, you may also like my other articles on similar topics,", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sr. Director of AI/ML platform | Stories on Artificial Intelligence, Data Science, and ML | Speaker, Open-source contributor, Author of multiple DS books"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa71a209d277e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a71a209d277e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a71a209d277e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----a71a209d277e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----a71a209d277e--------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a----a71a209d277e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa71a209d277e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa71a209d277e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.gatech.edu/academics/degrees/masters/analytics-online-degree-oms-analytics", "anchor_text": "Georgia Tech\u2019s Online Masters in Analytics (OMSA)"}, {"url": "http://catalog.gatech.edu/programs/analytics-ms/#onlinetext", "anchor_text": "check the details here."}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo#/media/File:Monaco_Monte_Carlo_1.jpg", "anchor_text": "Wikipedia"}, {"url": "https://www.solver.com/press/monte-carlo-methods-led-atomic-bomb-may-be-your-best-bet-business-decision-making", "anchor_text": "first and most famous uses of this technique was during the Manhattan Project"}, {"url": "https://en.wikipedia.org/wiki/Nuclear_weapon#/media/File:Trinity_Detonation_T&B.jpg", "anchor_text": "Wikipedia"}, {"url": "https://pixabay.com/illustrations/cube-random-luck-eye-numbers-1655118/", "anchor_text": "Pixabay"}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_methods_in_finance", "anchor_text": "risk analysis, financial engineering"}, {"url": "https://www.beckershospitalreview.com/healthcare-information-technology/a-million-trials-in-5-minutes-how-monte-carlo-simulations-could-revolutionize-healthcare.html", "anchor_text": "healthcare research"}, {"url": "https://link.springer.com/chapter/10.1007/978-3-540-74496-2_8", "anchor_text": "computer graphics"}, {"url": "https://beej.us/blog/data/monte-carlo-method-game-ai/", "anchor_text": "game design"}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method_in_statistical_physics", "anchor_text": "computational physics"}, {"url": "https://en.wikipedia.org/wiki/Riemann_sum", "anchor_text": "Riemann sum"}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad", "anchor_text": "function in the Scipy package"}, {"url": "https://towardsdatascience.com/how-to-generate-random-variables-from-scratch-no-library-used-4b71eb3c8dc7", "anchor_text": "How to generate random variables from scratch (no library used)We go through a simple pseudo-random generator algorithm and show how to use that for generating important random\u2026towardsdatascience.com"}, {"url": "https://pixabay.com/illustrations/gambling-roulette-game-bank-2001033/", "anchor_text": "Pixabay"}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian Normal distribution"}, {"url": "https://www.mathsisfun.com/data/confidence-interval.html", "anchor_text": "confidence intervals"}, {"url": "https://www.mathsisfun.com/data/confidence-interval.html", "anchor_text": "Confidence IntervalsAn interval of 4 plus or minus 2 A Confidence Interval is a range of values we are fairly sure our true value lies in\u2026www.mathsisfun.com"}, {"url": "https://www.scratchapixel.com/lessons/mathematics-physics-for-computer-graphics/monte-carlo-methods-in-practice/monte-carlo-integration", "anchor_text": "Monte Carlo Methods in Practice (Monte Carlo Integration)Monte Carlo Methods in Practice If you understand and know about the most important concepts of probability and\u2026www.scratchapixel.com"}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "Monte Carlo simulation techniques"}, {"url": "https://www.analyticsvidhya.com/blog/2019/01/monte-carlo-tree-search-introduction-algorithm-deepmind-alphago/", "anchor_text": "Introduction to Monte Carlo Tree Search: The Game-Changing Algorithm behind DeepMind's AlphaGoA best-of five-game series, $1 million dollars in prize money - A high stakes shootout. Between 9 and 15 March, 2016\u2026www.analyticsvidhya.com"}, {"url": "https://towardsdatascience.com/how-to-generate-random-variables-from-scratch-no-library-used-4b71eb3c8dc7", "anchor_text": "How to generate random variables from scratch (no library used)We go through a simple pseudo-random generator algorithm and show how to use that for generating important random\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/mathematical-programming-a-key-habit-to-built-up-for-advancing-in-data-science-c6d5c29533be", "anchor_text": "Mathematical programming \u2014 a key habit to build up for advancing in data scienceWe show a small step towards building the habit of mathematical programming, a key skill in the repertoire of a budding\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/brownian-motion-with-python-9083ebc46ff0", "anchor_text": "Brownian motion with PythonWe show how to emulate Brownian motion, the most famous stochastic process used in a wide range of applications, using\u2026towardsdatascience.com"}, {"url": "https://medium.com/@tirthajyoti/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@tirthajyoti/membership", "anchor_text": "Join Medium with my referral link - Tirthajyoti SarkarAs a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a71a209d277e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----a71a209d277e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----a71a209d277e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----a71a209d277e---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/technology?source=post_page-----a71a209d277e---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa71a209d277e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----a71a209d277e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa71a209d277e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----a71a209d277e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa71a209d277e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a71a209d277e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa71a209d277e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a71a209d277e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a71a209d277e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a71a209d277e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a71a209d277e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a71a209d277e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a71a209d277e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a71a209d277e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a71a209d277e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a71a209d277e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/@tirthajyoti/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb285331282ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-in-python-a71a209d277e&newsletterV3=cb9d97d4b61a&newsletterV3Id=b285331282ca&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}