{"url": "https://towardsdatascience.com/analytical-functions-in-oracle-4ac48e022370", "time": 1683008758.040064, "path": "towardsdatascience.com/analytical-functions-in-oracle-4ac48e022370/", "webpage": {"metadata": {"title": "Analytical Functions in Oracle. This article provides an understanding\u2026 | by Gaurav Goel | Towards Data Science", "h1": "Analytical Functions in Oracle", "description": "Analytical functions are used to do \u2018analyze\u2019 data over multiple rows and return the result in the current row. E.g Analytical functions can be used to find out running totals, ranking the rows, do\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Analytical functions are used to do \u2018analyze\u2019 data over multiple rows and return the result in the current row. E.g Analytical functions can be used to find out running totals, ranking the rows, do some aggregation on the previous or forthcoming row etc. Though the same functionality can be achieved by using standard aggregate functions and native SQL using joins and subqueries, analytical functions make it much simpler and faster. Oracle had introduced 26 analytical functions in Oracle 8.1.6.", "We will be using the below script to create sample data:", "Aggregate functions group the rows and return the output for the entire result set. However, analytical functions return the aggregated output but they do not group the result set. They return the value for each row in the result set.", "For example, if we have to find out the count of department numbers from the employee table, we will write the following query using an aggregate function:", "So for each row (i.e for each department), we get the count.", "Using the analytical function, the query will be written as:", "Here, the result is for each row present in emp table.", "As a result, we can not include any non-group by column while using aggregate functions but you can do it while using analytical function. E.g the below query will return an error:", "But using an analytical function, this error will not be faced.", "The general syntax of the analytic function is:", "Let's dissect it part by part.", "The scope of an analytical function is defined in an OVER clause. OVER is compulsory for all analytical functions. If you do not give any arguments after OVER, it will assume the scope as ALL. So, the following query will count the number of departments over the whole table:", "As the aggregate functions use GROUP BY to group rows, analytical functions use PARTITION BY . e.g if we wish to find out the maximum salary across each department and the maximum salary across each job type, we can write the query as follows:", "Here we have partitioned by deptno to find out the maximum salary and shown it in column max_sal_deptno. Similarly, we have partitioned by job to find out the maximum salary and shown it in column max_sal_job", "If we analyze the data of emp table, it's easy to find out that the maximum salary for Department 10 is 5000, for department 20 is 3000 and for department 30 is 2850.", "Similarly, for job type CLERK, the highest salary is 1300, for PRESIDENT it is 500, for MANAGER it is 2975, for ANALYST it is 3000 and for SALESMAN it is 1600.", "It is used to specify the order of records in the selected partition. This is different from the ORDER BY clause of the main query which comes after WHERE.", "The partition clause is not the only method of limiting the scope of an analytical function. We can use \u201cROWS BETWEEN\u201d or \u201cRANGE BETWEEN\u201d clause to define an additional scope. This is explicitly explained under the section \u201cWINDOW\u201d", "Some of the commonly used analytical functions are as follows:", "ROW_NUMBER gives a running serial number to a set of records. Here, the ORDER BY clause plays a crucial role to enumerate the rows. E.g if you want to return those emplyees which were hired second in each department, you can write the query as follows:", "Here, we have partitioned the rows by deptno and ordered by hiredate. The row_number() function assigns a serial number to all rows starting with 1 for all departments ordered by hiredate. For a new department, the numbering will begin from 1 again. The inner query performs this action. The output of the inner query will be as below. (The rows which are required finally are marked in RED)", "The outer query now selects those rows where rn=2 , to give us the desired result.", "The RANK analytical function also gives a serial number to a set of rows ordered in a specific way like the ROW_NUMBER. However, the difference is: ROW_NUMBER gives a unique number to each row even if the rows are duplicate. But RANK gives the same number to the duplicate rows.", "So in our emp table, if 2 employees have the same hiredate, then the RANK function will give the same number to each duplicate row. Look at the results of the following query:", "Since JAMES and FORD have the same hiredate, the ROW_NUMBER assigns them a different number but RANK assigns it the same number.", "DENSE_RANK works in a similar fashion as the RANK. The only difference is that it does not skip numbers while assigning to duplicate rows. Check the results of the below query to understand the difference between RANK and DENSE_RANK functions:", "Here JAMES and FORD have the same hiredate. So both rows are assigned number 10 for RANK and DENSE RANK. But the next row for MILLER is assigned 12 in case of RANK but 11 in case of DENSE_RANK.", "LEAD allows us to apply any computation on the next rows(rows after the current row). The general syntax of LEAD function is:", "<expression> is the expression to apply on the leading row", "<offset> is the number of the leading row relative to the current row(can be 1,2\u2026..)", "<default> is the value to be returned if the <offset> points to a row outside the partition range", "LAG has exactly the same syntax. The <offset> in LAG points to the previous rows relative to the current row.", "Let's say we have to find out the previous lower salary and the next higher salary for department 10, the query would be:", "Under the set of records defined by partition and order by clause, if we have to pick the first record, FIRST_VALUE function can be used. Similarly, under the set of records defined by partition and order by clause, if we have to pick the last record, LAST_VALUE function can be used. Let's say, if we have to find the number of days between the first hire and current hiredate of each employee of department 10, the query can be written as below:", "The partition clause is not the only method of limiting the scope of an analytical function. We can use \u201cROWS BETWEEN\u201d or \u201cRANGE BETWEEN\u201d clause to define an additional scope.", "The general syntax of the <window_clause> is [ROW or RANGE] BETWEEN <start_expr> AND <end_expr>", "<start_expr> can be any one of the following UNBOUNDED PECEDINGCURRENT ROW <sql_expr> PRECEDING or FOLLOWING.", "<end_expr> can be any one of the followingUNBOUNDED FOLLOWING orCURRENT ROW or<sql_expr> PRECEDING or FOLLOWING.", "Let us write a query which gives the highest salary in the previous rows relative to the current row.", "Here, for each row, the highest salary before the current row is returned. The ORDER BY clause here is not used for ranking but for specifying a window. UNBOUNDED PRECEDING is the lowest possible bound i.e the first row.", "Rows preceding or following the current row are retrieved with n PRECEDING or n FOLLOWING where n is the relative position to the current row. In our example, n is 1.", "RANGE is very similar to ROWS but the intervals in RANGE are not a number of rows. They represent a range of values and are either numeric or date values.", "Analytical Functions of Oracle are very powerful tools to aggregate and analyze the data across multiple dimensions. The execution speed is also much better than the normal aggregate functions. Knowledge of these functions definitely is a bonus in an Oracle developer\u2019s repertoire.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Storyteller, learner, thinker and a Software Professional dealing with Science and Engineering of Data"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4ac48e022370&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ac48e022370--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ac48e022370--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://gauravkantgoel.medium.com/?source=post_page-----4ac48e022370--------------------------------", "anchor_text": ""}, {"url": "https://gauravkantgoel.medium.com/?source=post_page-----4ac48e022370--------------------------------", "anchor_text": "Gaurav Goel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd7b2d2242cc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&user=Gaurav+Goel&userId=d7b2d2242cc8&source=post_page-d7b2d2242cc8----4ac48e022370---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ac48e022370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ac48e022370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@hostreviews?utm_source=medium&utm_medium=referral", "anchor_text": "Stephen Phillips - Hostreviews.co.uk"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@willfrancis?utm_source=medium&utm_medium=referral", "anchor_text": "Will Francis"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@the_roaming_platypus?utm_source=medium&utm_medium=referral", "anchor_text": "timJ"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@mooo3721?utm_source=medium&utm_medium=referral", "anchor_text": "R Mo"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/programming?source=post_page-----4ac48e022370---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/oracle-database?source=post_page-----4ac48e022370---------------oracle_database-----------------", "anchor_text": "Oracle Database"}, {"url": "https://medium.com/tag/analytical-function?source=post_page-----4ac48e022370---------------analytical_function-----------------", "anchor_text": "Analytical Function"}, {"url": "https://medium.com/tag/sql?source=post_page-----4ac48e022370---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/database?source=post_page-----4ac48e022370---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ac48e022370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&user=Gaurav+Goel&userId=d7b2d2242cc8&source=-----4ac48e022370---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ac48e022370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&user=Gaurav+Goel&userId=d7b2d2242cc8&source=-----4ac48e022370---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ac48e022370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ac48e022370--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4ac48e022370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4ac48e022370---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ac48e022370--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4ac48e022370--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4ac48e022370--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4ac48e022370--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4ac48e022370--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4ac48e022370--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4ac48e022370--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4ac48e022370--------------------------------", "anchor_text": ""}, {"url": "https://gauravkantgoel.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://gauravkantgoel.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gaurav Goel"}, {"url": "https://gauravkantgoel.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "513 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd7b2d2242cc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&user=Gaurav+Goel&userId=d7b2d2242cc8&source=post_page-d7b2d2242cc8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa1fbc4bdb78f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalytical-functions-in-oracle-4ac48e022370&newsletterV3=d7b2d2242cc8&newsletterV3Id=a1fbc4bdb78f&user=Gaurav+Goel&userId=d7b2d2242cc8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}