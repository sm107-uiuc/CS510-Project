{"url": "https://towardsdatascience.com/pandas-tricks-for-imputing-missing-data-63da3d14c0d6", "time": 1683008635.711413, "path": "towardsdatascience.com/pandas-tricks-for-imputing-missing-data-63da3d14c0d6/", "webpage": {"metadata": {"title": "Pandas Tricks for Imputing Missing Data | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Pandas Tricks for Imputing Missing Data", "description": "One of the biggest challenges data scientists face is dealing with missing data. In this post, we will discuss how to impute missing numerical and categorical values using Pandas. Since we are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/pabloa/wine-magazine", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://github.com/spierre91/medium_code/blob/master/pandas_tutorials/impute_data.py", "anchor_text": "GitHub", "paragraph_index": 27}], "all_paragraphs": ["One of the biggest challenges data scientists face is dealing with missing data. In this post, we will discuss how to impute missing numerical and categorical values using Pandas.", "For our purposes, we will be working with the Wine Magazine Dataset, which can be found here.", "To start, let\u2019s read the data into a Pandas data frame:", "Next, let\u2019s print the first five rows of data using the \u2018.head()\u2019 method:", "Since we are interested in imputing missing values, it would be useful to see the distribution in missing values across columns.", "We can display missing value information with the \u2018.info()\u2019 method. This displays the number of non-null values in each column:", "We can also use the \u2018.isnull()\u2019 and \u2018.sum()\u2019 methods to calculate the number of missing values in each column:", "We see that the resulting Pandas series shows the missing values for each of the columns in our data. The \u2018price\u2019 column contains 8996 missing values. We can replace these missing values using the \u2018.fillna()\u2019 method. For example, let\u2019s fill in the missing values with the mean price:", "We see that the \u2018price\u2019 column no longer has missing values. Now, suppose we wanted to make a more accurate imputation. A good guess would be to replace missing values in the price column with the mean prices within the countries the missing values belong. For example, if we consider missing wine prices for Italian wine, we can replace these missing values with the mean price of Italian wine. To proceed, let\u2019s look at the distribution in \u2018country\u2019 values. We can use the \u2018Counter\u2019 method from the collections module to do so:", "Let\u2019s take a look at wine made in the \u2018US\u2019. We can define a data frame containing only \u2018US\u2019 wines:", "Now, let\u2019s print the number of missing values:", "We see that there are 239 missing \u2018price\u2019 values in the \u2018US\u2019 wines data. To fill in the missing values with the mean corresponding to the prices in the US we do the following:", "Now suppose we wanted to do this for the missing price values in each country. First, let\u2019s impute missing country values:", "Next, within a for-loop we can define country-specific data frames:", "Next, we can fill the missing values in these country-specific data frames with their respective mean prices:", "We then append the result to a list we\u2019ll call \u201cframes\u201d", "Finally, we concatenate the resulting list of data frames:", "Now, if we print the number of missing price values before imputation we get:", "We see all but one of the missing values have been imputed. This corresponds to wines in Egypt which has no price data. We can fix this by checking the length of the data frame within the for loop and only imputing with the country-specific mean if the length is greater than one. If the length is equal to 1 we impute with the mean across all countries:", "Printing the result we see that all of the values have been imputed for the \u2018price\u2019 column:", "We can define a function that generalizes this logic. Our function will take variables corresponding to a numerical column and categorical column:", "We perform imputation using our function by executing the following:", "Let\u2019s also verify that the shapes of the original and imputed data frames match", "Similarly, we can define a function that imputes categorical values. This function will take two variables corresponding columns with categorical values.", "We can impute missing \u2018taster_name\u2019 values with the mode in each respective country:", "We see that the \u2018taster_name\u2019 column now has zero missing values. Again, let\u2019s verify that the shape matches with the original data frame:", "I\u2019ll stop here but feel free to play around with the data and code yourself.", "To summarize, in this post we discussed how to handle missing values using the Pandas library. First, we discussed how to impute missing numerical values with the mean value across the data. We then looked at how to make category-specific numerical imputations. Finally, we showed how to impute missing categorical values with the mode corresponding to another categorical column. I hope you found this post useful/interesting. The code in this post is available on GitHub. Thank you for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F63da3d14c0d6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----63da3d14c0d6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63da3d14c0d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63da3d14c0d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/photo/black-and-white-blank-challenge-connect-262488/", "anchor_text": "Source"}, {"url": "https://www.kaggle.com/pabloa/wine-magazine", "anchor_text": "here"}, {"url": "https://github.com/spierre91/medium_code/blob/master/pandas_tutorials/impute_data.py", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/python?source=post_page-----63da3d14c0d6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----63da3d14c0d6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----63da3d14c0d6---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/technology?source=post_page-----63da3d14c0d6---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----63da3d14c0d6---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63da3d14c0d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----63da3d14c0d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63da3d14c0d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----63da3d14c0d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63da3d14c0d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F63da3d14c0d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----63da3d14c0d6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----63da3d14c0d6--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-tricks-for-imputing-missing-data-63da3d14c0d6&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}