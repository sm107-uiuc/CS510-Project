{"url": "https://towardsdatascience.com/clean-your-data-with-unsupervised-machine-learning-8491af733595", "time": 1682994038.029989, "path": "towardsdatascience.com/clean-your-data-with-unsupervised-machine-learning-8491af733595/", "webpage": {"metadata": {"title": "Clean your data with unsupervised machine learning | by Josh Taylor | Towards Data Science", "h1": "Clean your data with unsupervised machine learning", "description": "In this example we are faced with thousands of text articles scraped from both HMTL and PDF files. The quality of text returned is very much dependent on the scraping process. From sample-checking\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.modernslaveryregistry.org/", "anchor_text": "https://www.modernslaveryregistry.org/", "paragraph_index": 1}, {"url": "https://www.linkedin.com/in/josh-taylor-24806975/", "anchor_text": "https://www.linkedin.com/in/josh-taylor-24806975/", "paragraph_index": 23}], "all_paragraphs": ["In this example we are faced with thousands of text articles scraped from both HMTL and PDF files. The quality of text returned is very much dependent on the scraping process. From sample-checking some of the results we know there are issues ranging from bad links, unreadable PDFs to items which have been successfully read-in but the content itself is complete garbage.", "The articles relate to Company Modern Slavery returns from this database: https://www.modernslaveryregistry.org/", "These now reside in a Pandas data frame with \u2018meta data\u2019 on each item such as the company name and year of publication, alongside the text which has been scraped from the return:", "The python Missingno package is super-useful. It can be installed and run on a data frame in 4 lines of code and will quickly highlight if you have any missing information in a data frame. It is also able to sample rows in the data set so can easily handle very large data frames with ease.", "Running this over our data frame shows us that the data is complete except for one column. As we are not using this for our analysis no further work is needed but if there were gaps in other areas we would have to think around how best to handle these (for example removing these rows or trying to impute missing values).", "Scanning through the text in the data frame there are clearly issues. For example, something has gone wrong with reading the PDF file in this item:", "CMR644311ABP UKModern Slavery StatementSeptember 2017)ABP UKModern Slavery StatementSeptember 2017 ABP UKModern Slavery StatementSeptember 2017AABP UKModern Slavery StatementSeptember 2017bABP\u2026..", "These are clearly beyond repair \u2014 but how do we separate them from the text files which have been read correctly?", "We could spend a huge amount of time trying to split out this corrupted information from the real data but this is exactly where machine learning shines. Hopefully we can use it to find patterns in the data and cluster it automatically into clean and messy data saving a heap of work. Using Python it is super quick and easy to do this in three steps:", "Step 1. Create features for the algorithm:", "The below code exposes the word count, character count and number of unique words as new columns to our data frame:", "Using the truly excellent charting library from Spotify, Chartify, we can quickly make a plot of our data using the new features we have just created:", "The chart this creates tells us a huge amount about our dataset. There is a clear trend of increasing words, characters and unique words. This is to be expected, however there is also a large cluster of items sitting below this and a line of items at the bottom which have very few words but very high character counts:", "By clustering the data using machine learning, we should be able to automatically split out each of the areas that we see in the chart and investigate these further. The below code scales the data and then applies K-Means clustering to it:", "Running this through our visualisation again we get the following:", "This has done a great job of splitting out the problem areas. It looks like clusters 1, 4 and 5 need some further investigation. Before we do, lets zoom in on the bottom left of the chart to ensure that the clustering is still working here as it is hard to see in the current plot:", "Magic; even where there is overlap between points the algorithm is robust enough to distinguish between them based on character count alone.", "Why did we decide on 7 clusters? Trial and error. 7 was the smallest number which still segmented the data set in an effective way.", "This all looks great, but have we actually achieved what we set out to do? We can check this by inspecting what sits in each of the clusters, in particular clusters 1,4 and 5.", "This is very interesting, the text looks completely fine here. The above example is from 3M but the other returns area also clean. Cluster 1 is therefore part of the real data obtained from the Modern Slavery statements rather then poor data quality. We would want to investigate why this cluster exists when we come to analyse the data further", "Here is our messy data. What is so impressive is that the algorithm is smart enough to correctly cluster the example above even though the individual words make sense.", "All we need to do now is exclude these clusters from the dataset and get on with analysing a nice, clean set of data.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a specialist in producing insights through advanced analytics, machine learning and visualisation. https://www.linkedin.com/in/josh-taylor-24806975/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8491af733595&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8491af733595--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8491af733595--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thejoshtaylor?source=post_page-----8491af733595--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=post_page-----8491af733595--------------------------------", "anchor_text": "Josh Taylor"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb5b5ec923fa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&user=Josh+Taylor&userId=b5b5ec923fa3&source=post_page-b5b5ec923fa3----8491af733595---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8491af733595&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8491af733595&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.modernslaveryregistry.org/", "anchor_text": "https://www.modernslaveryregistry.org/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8491af733595---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8491af733595---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/visualization?source=post_page-----8491af733595---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----8491af733595---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/tag/data-cleaning?source=post_page-----8491af733595---------------data_cleaning-----------------", "anchor_text": "Data Cleaning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8491af733595&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&user=Josh+Taylor&userId=b5b5ec923fa3&source=-----8491af733595---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8491af733595&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&user=Josh+Taylor&userId=b5b5ec923fa3&source=-----8491af733595---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8491af733595&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8491af733595--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8491af733595&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8491af733595---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8491af733595--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8491af733595--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8491af733595--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8491af733595--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8491af733595--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8491af733595--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8491af733595--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8491af733595--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Josh Taylor"}, {"url": "https://medium.com/@thejoshtaylor/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "851 Followers"}, {"url": "https://www.linkedin.com/in/josh-taylor-24806975/", "anchor_text": "https://www.linkedin.com/in/josh-taylor-24806975/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb5b5ec923fa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&user=Josh+Taylor&userId=b5b5ec923fa3&source=post_page-b5b5ec923fa3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F826db04da2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-your-data-with-unsupervised-machine-learning-8491af733595&newsletterV3=b5b5ec923fa3&newsletterV3Id=826db04da2c9&user=Josh+Taylor&userId=b5b5ec923fa3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}