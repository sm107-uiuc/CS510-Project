{"url": "https://towardsdatascience.com/apache-pig-1dd61d2ead31", "time": 1683009449.9663842, "path": "towardsdatascience.com/apache-pig-1dd61d2ead31/", "webpage": {"metadata": {"title": "Apache Pig. The easiest way to MapReduce | by Prathamesh Nimkar | Towards Data Science", "h1": "Apache Pig", "description": "The easiest way to MapReduce!"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/apache-sqoop-1113ce453639", "anchor_text": "structured", "paragraph_index": 10}, {"url": "https://medium.com/@prathamesh.nimkar/hdfs-commands-79dccfd721d7", "anchor_text": "unstructured", "paragraph_index": 10}, {"url": "http://pig.apache.org/docs/r0.17.0/udf.html#piggybank", "anchor_text": "url", "paragraph_index": 13}, {"url": "http://pig.apache.org/docs/r0.17.0/", "anchor_text": "Apache Pig Overview", "paragraph_index": 18}, {"url": "http://pig.apache.org/docs/r0.17.0/start.html", "anchor_text": "Getting Started", "paragraph_index": 19}, {"url": "http://pig.apache.org/docs/r0.17.0/perf.html#optimization-rules", "anchor_text": "Performance and Efficiency", "paragraph_index": 20}, {"url": "https://github.com/pratnimk/sqoop-big-data-analysis/raw/master/915662529_T_ONTIME_REPORTING.zip", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://medium.com/@prathamesh.nimkar/bb6dc35c1a06?source=friends_link&sk=af5eab7956455ae93784c9a0ee8a9fb8", "anchor_text": "Here you go", "paragraph_index": 22}, {"url": "https://www.bts.gov/", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://www.transtats.bts.gov/Fields.asp?Table_ID=236", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/apache-sqoop-1113ce453639", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://www.linkedin.com/in/prathameshnimkar/", "anchor_text": "https://www.linkedin.com/in/prathameshnimkar/", "paragraph_index": 24}], "all_paragraphs": ["In 2006, the good folks at Yahoo! Research developed a simple and intuitive way to create and execute MapReduce jobs on very large data sets. The following year, the project was accepted by Apache Software Foundation and shortly thereafter, released as Apache Pig.", "The above image is a simple view of how Apache Pig is placed within the Hadoop ecosystem. Pig is compatible with not only MapReduce but also Tez and Spark processing engines which provides a significant performance improvement. For the uninitiated, Tez can be considered as a performance efficient version of the MapReduce framework. Lastly, the storage layer is by default HDFS, but Pig also supports HBase, Hive and many more.", "Fun Fact: Pig works in local mode, i.e. it runs on your local RAM and local file system via a simple configuration setting within your script. Pretty cool right?", "Do note, the above automatic optimizations are enabled by default.", "Let\u2019s understand Apache Pig\u2019s data model using the arbitrary pictures above, in clock-wise.", "The first image is of the Atom, which is the smallest unit of data available in Apache Pig. It can be of any data type, i.e. int, long, float, double, char array and byte array that carries a single value of information. For example, \u2018Prathamesh\u2019 or 30 or \u2018Medium22\u2019.", "Next, we have an ordered set of \u201cfields\u201d of any data type, separated by a comma as it\u2019s delimiter. Think of it as a single line in csv file. This data structure is known as a Tuple. For example, (\u2018Prathamesh\u2019, 30, \u2018Medium22\u2019).", "Put simply, a Bag is an unordered set or collection of tuples. Think of it as singular/multiple non-unique records in a csv. However, unlike a csv, this has no fixed structure, i.e. it has a flexible schema, such that the 1st row can be of 5 fields, the 2nd with 30 fields and so on. For example, {(\u2018Prathamesh\u2019, 30, \u2018Medium22\u2019), (\u2018Nimkar\u2019, 700)}.", "A Bag is of two types, outer and inner. An outer bag is a Relation, which is a bag of tuples. Think of it as a table in a relational database, except there is no fixed schema. An inner bag is a relation, inside another bag, a nested bag structure or bag-ception if you will.", "Pig also supports key-value pairs in the form of [char array to element] through a Map data structure. The element can be of any Pig data type. For example, [\u201cName\u201d#\u201cPrathamesh\u201d, \u201cYear\u201d#2020], wherein, the brackets delimit the map, comma to delimit pairs and hash to separate key from value.", "If you\u2019ve been following my posts, you\u2019d already have structured and unstructured data imported into HDFS. Let\u2019s get into Hue and open the Pig editor to explore some commonly used Pig Latin commands.", "You\u2019d have probably noticed by now that Pig Latin is lazy-evaluated. Meaning, it waits for certain specific keywords in order to actually execute the task at hand. DESCRIBE, ILLUSTRATE and DUMP are few examples.", "The job is divided into two types, the \u201coozie launcher\u201d works as the parent wrapper for this job and the \u201cpiglatin*.pig\u201d actually runs the MapReduce code. The job is initialized, resources are granted, job is monitored to completion and the output is displayed as part of the oozie launcher.", "The above represents the output of the respective statements passed to the Pig Server. If you notice, the DUMP output reflects correctly, but the ILLUSTRATE view is incorrect. This is because Pig is unable to exclude comma-separated values within quotes, as is the case with city names in our dataset. In order to correct that, we use Piggy Bank User Defined Functions. Piggy bank is a common storage for Java UDFs written for use with Apache Pig. We\u2019re going to ignore that error for now, so, for more information on piggy bank, it\u2019s best to visit this url.", "The above gist has just 3 lines of code to simply load & filter the dataset by multiple city names. You\u2019re thinking Apache Pig is super easy to use and is highly intuitive and you\u2019re right, it is. Some of these built-in functions are literally like the spoken word.", "Building on the same example, for each row, select only a few columns of interest. Then we group the dataset by unique carrier ids and finally, we store the dataset back in HDFS. There you have it, 3 more lines only to achieve this task.", "You may have noticed that we have not only performed extraction but also transformation and loading, thus completing Map & Reduce both.", "This ends my short introduction to Apache Pig, the easiest way to MapReduce, especially if you\u2019re not from a computing background. Hopefully, you\u2019ve found it useful and are aching to give it a try. Lastly, if you\u2019ve any questions, please feel free to ask.", "[1] Apache Pig Overview, Apache Hadoop, ASF", "[2] Getting Started, Apache Pig, ASF", "[3] Performance and Efficiency, Apache Pig, ASF", "Please note, I didn\u2019t download all of the columns to create the dataset. You can though.", "The structured cleansed dataset can be found here.Explanation with some data? Here you go.The Homepage of the original data set \u2014 here.The raw data \u2014 here.More details on the fields \u2014 here.Load the data? \u2014 here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech Enthusiast \u2014 Data Engineering | Data Analytics | LinkedIN: https://www.linkedin.com/in/prathameshnimkar/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1dd61d2ead31&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@prathamesh.nimkar?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prathamesh.nimkar?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": "Prathamesh Nimkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6f0e324a756e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=post_page-6f0e324a756e----1dd61d2ead31---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1dd61d2ead31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1dd61d2ead31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@blankerwahnsinn?utm_source=medium&utm_medium=referral", "anchor_text": "Fabian Blank"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Lazy_evaluation#:~:text=In%20programming%20language%20theory%2C%20lazy,avoids%20repeated%20evaluations%20(sharing).", "anchor_text": "lazy evaluation"}, {"url": "https://towardsdatascience.com/apache-sqoop-1113ce453639", "anchor_text": "structured"}, {"url": "https://medium.com/@prathamesh.nimkar/hdfs-commands-79dccfd721d7", "anchor_text": "unstructured"}, {"url": "http://pig.apache.org/docs/r0.17.0/udf.html#piggybank", "anchor_text": "url"}, {"url": "http://pig.apache.org/docs/r0.17.0/", "anchor_text": "Apache Pig Overview"}, {"url": "http://pig.apache.org/docs/r0.17.0/start.html", "anchor_text": "Getting Started"}, {"url": "http://pig.apache.org/docs/r0.17.0/perf.html#optimization-rules", "anchor_text": "Performance and Efficiency"}, {"url": "https://github.com/pratnimk/sqoop-big-data-analysis/raw/master/915662529_T_ONTIME_REPORTING.zip", "anchor_text": "here"}, {"url": "https://medium.com/@prathamesh.nimkar/bb6dc35c1a06?source=friends_link&sk=af5eab7956455ae93784c9a0ee8a9fb8", "anchor_text": "Here you go"}, {"url": "https://www.bts.gov/", "anchor_text": "here"}, {"url": "https://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time", "anchor_text": "here"}, {"url": "https://www.transtats.bts.gov/Fields.asp?Table_ID=236", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/apache-sqoop-1113ce453639", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/simplifying-the-mapreduce-framework-20915f13ebd3", "anchor_text": "MapReduceSimplifying the MapReduce Frameworktowardsdatascience.com"}, {"url": "https://towardsdatascience.com/apache-flume-71ed475eee6d", "anchor_text": "Apache FlumeTrickle-feed unstructured data into HDFS using Apache Flumetowardsdatascience.com"}, {"url": "https://medium.com/@prathamesh.nimkar/big-data-analytics-using-the-hadoop-ecosystem-411d629084d3", "anchor_text": "Big Data Analytics Pipeline using the Hadoop EcosystemLanding Pagemedium.com"}, {"url": "https://medium.com/tag/big-data?source=post_page-----1dd61d2ead31---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1dd61d2ead31---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/apache?source=post_page-----1dd61d2ead31---------------apache-----------------", "anchor_text": "Apache"}, {"url": "https://medium.com/tag/yahoo?source=post_page-----1dd61d2ead31---------------yahoo-----------------", "anchor_text": "Yahoo"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----1dd61d2ead31---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1dd61d2ead31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=-----1dd61d2ead31---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1dd61d2ead31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=-----1dd61d2ead31---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1dd61d2ead31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1dd61d2ead31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1dd61d2ead31---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1dd61d2ead31--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prathamesh.nimkar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prathamesh.nimkar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Prathamesh Nimkar"}, {"url": "https://medium.com/@prathamesh.nimkar/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "186 Followers"}, {"url": "https://www.linkedin.com/in/prathameshnimkar/", "anchor_text": "https://www.linkedin.com/in/prathameshnimkar/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6f0e324a756e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=post_page-6f0e324a756e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4018850c89c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-pig-1dd61d2ead31&newsletterV3=6f0e324a756e&newsletterV3Id=4018850c89c8&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}