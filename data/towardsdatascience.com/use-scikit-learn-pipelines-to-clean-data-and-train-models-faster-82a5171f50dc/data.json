{"url": "https://towardsdatascience.com/use-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc", "time": 1683000512.049296, "path": "towardsdatascience.com/use-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc/", "webpage": {"metadata": {"title": "Use Scikit-Learn Pipelines to clean data and train models faster | by Collin Ching | Towards Data Science", "h1": "Use Scikit-Learn Pipelines to clean data and train models faster", "description": "If you\u2019re looking for a way to organize your data processing workflow and decrease code redundancy, Scikit-Learn Pipelines will make a great addition to your data science toolkit. After explaining\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/tmdb-box-office-prediction/data", "anchor_text": "worldwide box office revenue predictions", "paragraph_index": 0}, {"url": "https://github.com/collindching/Mini-Projects/tree/master/Box%20Office%20Revenue%20Prediction", "anchor_text": "code", "paragraph_index": 7}, {"url": "https://www.csie.ntu.edu.tw/~b88052/tmp/vietri.pdf", "anchor_text": "variable selection procedure", "paragraph_index": 13}, {"url": "https://github.com/collindching/Mini-Projects/tree/master/Box%20Office%20Revenue%20Prediction", "anchor_text": "code", "paragraph_index": 14}, {"url": "https://github.com/collindching/Mini-Projects/tree/master/Box%20Office%20Revenue%20Prediction", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://medium.com/vickdata/a-simple-guide-to-scikit-learn-pipelines-4ac0d974bdcf", "anchor_text": "post", "paragraph_index": 19}, {"url": "https://scikit-learn.org/stable/modules/compose.html#pipeline", "anchor_text": "official guide to Pipelines", "paragraph_index": 19}], "all_paragraphs": ["If you\u2019re looking for a way to organize your data processing workflow and decrease code redundancy, Scikit-Learn Pipelines will make a great addition to your data science toolkit. After explaining what they are and why they\u2019re used, I\u2019ll show you how to use them to automate data processing by using them for worldwide box office revenue predictions.", "Pipeline can be a pretty vague term, but it\u2019s quite apt once you realize what it does in the context of building a machine learning model. A Scikit-Learn Pipeline chains together multiple data processing steps into a single, callable method.", "For example, say you want to transform continuous features from the movie data.", "To process continuous data for a regression model, a standard processing workflow involves imputing missing values, transforming skewed variables, and standardizing your data. You could process the data in separate steps, like so.", "But it would be cleaner, more efficient, and more succinct if you just used a Pipeline to apply all the data transformations at once.", "By using a Pipeline, you can see your processing steps clearly and quickly add or remove steps. You also only have to call the fit_transform() once, rather than 3 times.", "I used a Pipeline to process continuous data, but there are also discrete numeric columns, categorical columns, and JSON-type columns in the movie data. Each of these data types requires a different processing method, so you can build a unique Pipeline for each data type.", "TopCatEncoder() is a custom transformer that I wrote specifically for the movie data. Some data columns have information encoded in JSON format, so I defined TopCatEncoder() and some helper functions to parse JSON into categorical variables based on key, then retain top categories for each of those new categorical variables. That\u2019s all you need to know about the transformer, but if you want to learn more you can also check out the code in my GitHub.", "Now that I have all the pipelines I need to process my data \u2014 cont_pipeline, disc_pipeline, cat_pipeline and json_pipeline \u2014 I can assemble these into a single Pipeline using ColumnTransformer() to specify which pipelines transform which variables. Transformers are specified as a list of tuples that look like this: (name, transformer, columns).", "To transform all of my data using this Pipeline, I just call preprocessor.fit_transform(X_train).", "Here, I use a utility function called quick_eval() to train my model and make test predictions.", "By combining the processor pipeline with a regression model, pipe handles data processing, model training, and model evaluation all at once, so that we can quickly compare baseline model performance for 8 different models. The output looks like this.", "With the data processing and model prototyping steps completed, we can select a subset of models that to focus on. I used the Random Forest regressor because it performed comparatively pretty well and is pretty simple to interpret.", "From there, we can proceed with feature engineering, feature selection, and hyperparameter tuning to arrive at a final model. I used a cross-validated variable selection procedure based on Random Forests to whittle my data from 194 features down to 57 features and improve test RMSE.", "This variable selection implementation isn\u2019t the focus of this post, but you can find the implementation of it in my code in the function rf_variable_selection().", "Above, TopFeatureSelector() is another custom transformer that selects the top k features to keep using pre-computed feature importances.", "And there you have it, the final model! It performs a little bit better than the baseline with fewer features.", "Since I focused on Scikit-Learn Pipelines, I skipped a few steps like incorporating external data, feature engineering, and hyperparameter tuning. If I were to revisit this project to make my models stronger, I would focus on these three things. I also didn\u2019t use cross-validation in the quick_eval() function, but implementing cross-validation would make this workflow more robust.", "Thanks for reading! I\u2019m new to Scikit-Learn Pipelines and this blog post helped me solidify what I\u2019ve done so far. I\u2019ll update this document with new use cases I come across.", "You can check out the Jupyter Notebook for this project here. For more info about Pipelines, checkout Rebecca Vickery\u2019s post and Scikit-Learn\u2019s official guide to Pipelines.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist || Read, think, apply"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F82a5171f50dc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@collindching?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@collindching?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": "Collin Ching"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd0c8fae38c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&user=Collin+Ching&userId=cd0c8fae38c&source=post_page-cd0c8fae38c----82a5171f50dc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82a5171f50dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82a5171f50dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/tmdb-box-office-prediction/data", "anchor_text": "worldwide box office revenue predictions"}, {"url": "https://github.com/collindching/Mini-Projects/tree/master/Box%20Office%20Revenue%20Prediction", "anchor_text": "code"}, {"url": "https://www.csie.ntu.edu.tw/~b88052/tmp/vietri.pdf", "anchor_text": "variable selection procedure"}, {"url": "https://github.com/collindching/Mini-Projects/tree/master/Box%20Office%20Revenue%20Prediction", "anchor_text": "code"}, {"url": "https://github.com/collindching/Mini-Projects/tree/master/Box%20Office%20Revenue%20Prediction", "anchor_text": "here"}, {"url": "https://medium.com/vickdata/a-simple-guide-to-scikit-learn-pipelines-4ac0d974bdcf", "anchor_text": "post"}, {"url": "https://scikit-learn.org/stable/modules/compose.html#pipeline", "anchor_text": "official guide to Pipelines"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----82a5171f50dc---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----82a5171f50dc---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/regression?source=post_page-----82a5171f50dc---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/data-processing?source=post_page-----82a5171f50dc---------------data_processing-----------------", "anchor_text": "Data Processing"}, {"url": "https://medium.com/tag/python?source=post_page-----82a5171f50dc---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F82a5171f50dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&user=Collin+Ching&userId=cd0c8fae38c&source=-----82a5171f50dc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F82a5171f50dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&user=Collin+Ching&userId=cd0c8fae38c&source=-----82a5171f50dc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82a5171f50dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F82a5171f50dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----82a5171f50dc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----82a5171f50dc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----82a5171f50dc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----82a5171f50dc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----82a5171f50dc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@collindching?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@collindching?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Collin Ching"}, {"url": "https://medium.com/@collindching/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "243 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd0c8fae38c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&user=Collin+Ching&userId=cd0c8fae38c&source=post_page-cd0c8fae38c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F78c14637d659&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-scikit-learn-pipelines-to-clean-data-and-train-models-faster-82a5171f50dc&newsletterV3=cd0c8fae38c&newsletterV3Id=78c14637d659&user=Collin+Ching&userId=cd0c8fae38c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}