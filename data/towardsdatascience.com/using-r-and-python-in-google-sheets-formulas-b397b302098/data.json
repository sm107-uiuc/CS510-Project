{"url": "https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098", "time": 1683007792.787342, "path": "towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098/", "webpage": {"metadata": {"title": "Using R and Python in Google Sheets Formulas | by Sam Terfa | Towards Data Science", "h1": "Using R and Python in Google Sheets Formulas", "description": "Google\u2019s version of spreadsheets called Google Sheets has a hidden gem which significantly increases the power of your spreadsheets called Google Apps Script. Google Apps Script uses Javascript to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.google.com/sheets/about/", "anchor_text": "Google Sheets", "paragraph_index": 0}, {"url": "https://developers.google.com/apps-script", "anchor_text": "Google Apps Script", "paragraph_index": 0}, {"url": "https://code.markedmondson.me/googleCloudRunner/index.html", "anchor_text": "googleCloudRunner", "paragraph_index": 9}, {"url": "https://medium.com/google-cloud/google-cloud-run-or-how-to-run-your-static-website-in-5-minutes-and-much-more-dbe8f2804395", "anchor_text": "these project setup instructions", "paragraph_index": 9}, {"url": "https://medium.com/google-cloud/hosting-a-website-on-google-cloud-using-cloud-run-a65343a98fce", "anchor_text": "these deployment instructions", "paragraph_index": 9}, {"url": "https://github.com/samterfa/rpysheets", "anchor_text": "samterfa/rpysheets GitHub Repo", "paragraph_index": 10}, {"url": "https://cloud.google.com/run/docs/configuring/memory-limits#console", "anchor_text": "beef up your Google Cloud Run service", "paragraph_index": 10}], "all_paragraphs": ["Google\u2019s version of spreadsheets called Google Sheets has a hidden gem which significantly increases the power of your spreadsheets called Google Apps Script. Google Apps Script uses Javascript to call other Google services, create interactive pop-up dialogs, and even make API calls. With a bit of setup, you can create spreadsheet formulas for others to use that execute R, Python, or practically any programming language code! While Shiny and Dash are great ways to share your work, following the instructions in this article, you will be able to create R and Python dashboards directly inside Google Sheets. As a bonus, these same methods allow you to insert R and Python functionality into other Google services such as Docs, Forms and Slides!", "Under the hood, each custom function is a Google Apps script that makes an API call to an endpoint I have set up in Google Cloud Run. If you can set up API endpoints that run R, Python, or any other language scripts, you can import those powers into a Google spreadsheet. This is phenomenal!", "The following 6 steps are arranged from easiest to hardest and will simply get you up and running with your own custom spreadsheet function powered by R or Python APIs. There is a lot more to Google Apps script, creating your own APIs, and Google Cloud Run which can be covered in another post.", "3. Copy and paste the following code into the editor. Adapt to your needs.", "4. Create a plain text file with no extension named \u201cDockerfile\u201d.Put it in its own folder on your hard drive. Don\u2019t get nervous; you do not need Docker on your system to follow these steps (but you should absolutely be using Docker in your daily work!)", "Copy and paste one of the following into your Dockerfile.", "5. Create the scripts that will power your custom function. Add the following file to the same folder as your Dockerfile. Note that cell references from Google Sheets are passed in as single values for individual cells, or as nested lists for multiple cells.", "NOTE: To run an arbitrary R or Python script inside a Google Sheet, the script needs to determine whether passed arrays include column names or not. The code is a bit unwieldy but I\u2019ve included an R attempt at the end of this article.", "6. Deploy your API (to Google Cloud Run)If you already know how to deploy an R or Python API, you\u2019ve probably already stopped reading this article and are off to the races! For the rest of us, I will guide you through using Google Cloud Run to host your API.", "Mark Edmondson has created a phenomenal R package called googleCloudRunner. This package handles auth, creates builds, and deploys containers to Google Cloud Run. It\u2019s truly remarkable. If you don\u2019t have R installed, you can follow these project setup instructions, and these deployment instructions keeping in mind that we are trying to deploy our Dockerfile from above. From here on, I will assume you have R running and googleCloudRunner installed.", "2. samterfa/rpysheets GitHub RepoThis repo contains all the files listed above plus some bonus material. The bonus material includes the generalized rscript function, as well as the MNIST digit prediction function. If you want to use prediction with large models, you do face a 30 second time limit by Google Sheets. You may also need to beef up your Google Cloud Run service.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | R and Google Cloud Enthusiast"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb397b302098&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b397b302098--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b397b302098--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://samterfa.medium.com/?source=post_page-----b397b302098--------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=post_page-----b397b302098--------------------------------", "anchor_text": "Sam Terfa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff927a36747b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&user=Sam+Terfa&userId=f927a36747b7&source=post_page-f927a36747b7----b397b302098---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb397b302098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb397b302098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kmuza?utm_source=medium&utm_medium=referral", "anchor_text": "Carlos Muza"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.google.com/sheets/about/", "anchor_text": "Google Sheets"}, {"url": "https://developers.google.com/apps-script", "anchor_text": "Google Apps Script"}, {"url": "http://twitter.com/param", "anchor_text": "@param"}, {"url": "http://twitter.com/param", "anchor_text": "@param"}, {"url": "http://twitter.com/return", "anchor_text": "@return"}, {"url": "http://twitter.com/customfunction", "anchor_text": "@customfunction"}, {"url": "https://www.rplumber.io/", "anchor_text": "Plumber package"}, {"url": "https://hub.docker.com/r/rocker/ml", "anchor_text": "rocker/ml image"}, {"url": "https://pypi.org/project/fastapi/", "anchor_text": "Fast API"}, {"url": "http://twitter.com/apiTitle", "anchor_text": "@apiTitle"}, {"url": "http://twitter.com/apiDescription", "anchor_text": "@apiDescription"}, {"url": "http://twitter.com/param", "anchor_text": "@param"}, {"url": "http://twitter.com/param", "anchor_text": "@param"}, {"url": "http://twitter.com/post", "anchor_text": "@post"}, {"url": "http://twitter.com/get", "anchor_text": "@get"}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "https://code.markedmondson.me/googleCloudRunner/index.html", "anchor_text": "googleCloudRunner"}, {"url": "https://medium.com/google-cloud/google-cloud-run-or-how-to-run-your-static-website-in-5-minutes-and-much-more-dbe8f2804395", "anchor_text": "these project setup instructions"}, {"url": "https://medium.com/google-cloud/hosting-a-website-on-google-cloud-using-cloud-run-a65343a98fce", "anchor_text": "these deployment instructions"}, {"url": "https://console.cloud.google.com/", "anchor_text": "https://console.cloud.google.com/"}, {"url": "https://cloud.google.com/run/pricing", "anchor_text": "it\u2019s very cheap"}, {"url": "https://code.markedmondson.me/googleCloudRunner/articles/setup.html#gcp-settings", "anchor_text": "here"}, {"url": "https://swagger.io/docs/specification/2-0/what-is-swagger/", "anchor_text": "Swagger"}, {"url": "https://github.com/samterfa/rpysheets", "anchor_text": "samterfa/rpysheets GitHub Repo"}, {"url": "https://cloud.google.com/run/docs/configuring/memory-limits#console", "anchor_text": "beef up your Google Cloud Run service"}, {"url": "https://medium.com/tag/r?source=post_page-----b397b302098---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/python?source=post_page-----b397b302098---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/api?source=post_page-----b397b302098---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/google-sheets?source=post_page-----b397b302098---------------google_sheets-----------------", "anchor_text": "Google Sheets"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----b397b302098---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb397b302098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&user=Sam+Terfa&userId=f927a36747b7&source=-----b397b302098---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb397b302098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&user=Sam+Terfa&userId=f927a36747b7&source=-----b397b302098---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb397b302098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b397b302098--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb397b302098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b397b302098---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b397b302098--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b397b302098--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b397b302098--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b397b302098--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b397b302098--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b397b302098--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b397b302098--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b397b302098--------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sam Terfa"}, {"url": "https://samterfa.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff927a36747b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&user=Sam+Terfa&userId=f927a36747b7&source=post_page-f927a36747b7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5c5d191f9494&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-r-and-python-in-google-sheets-formulas-b397b302098&newsletterV3=f927a36747b7&newsletterV3Id=5c5d191f9494&user=Sam+Terfa&userId=f927a36747b7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}