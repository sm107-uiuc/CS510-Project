{"url": "https://towardsdatascience.com/machine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459", "time": 1683017828.179729, "path": "towardsdatascience.com/machine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459/", "webpage": {"metadata": {"title": "Machine Learning in production: Keras, Flask, Docker and Heroku | by Aissam Outchakoucht | Towards Data Science", "h1": "Machine Learning in production: Keras, Flask, Docker and Heroku", "description": "In this tutorial we will try to walk together through all the building blocks of a Machine/Deep Learning project in production, i.e. a model that people can actually interact with. Broadly speaking\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/aissam-out/ML-in-production", "anchor_text": "[here]", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1409.1556", "anchor_text": "VGG-19", "paragraph_index": 5}, {"url": "http://www.image-net.org/", "anchor_text": "ImageNet", "paragraph_index": 6}, {"url": "https://drive.google.com/file/d/1Sk0jIQonfxkeaybotFML1VYY-faP9lhD/view?usp=sharing", "anchor_text": "[link]", "paragraph_index": 9}, {"url": "https://github.com/aissam-out/ML-in-production", "anchor_text": "GitHub Repository", "paragraph_index": 22}, {"url": "https://docs.docker.com/engine/reference/builder/", "anchor_text": "the documentation", "paragraph_index": 29}, {"url": "http://localhost:5000/upload", "anchor_text": "http://localhost:5000/upload", "paragraph_index": 33}, {"url": "https://docs.docker.com/engine/reference/commandline/docker/", "anchor_text": "[in this link]", "paragraph_index": 37}, {"url": "https://www.heroku.com/", "anchor_text": "Heroku", "paragraph_index": 38}], "all_paragraphs": ["In this tutorial we will try to walk together through all the building blocks of a Machine/Deep Learning project in production, i.e. a model that people can actually interact with.", "Broadly speaking, we\u2019ll create a web interface in which a user could upload an image, then a bit of Deep Learning magic comes into play, and Bingo! \ud83c\udf89 we get a text revealing what does that image represent.", "I KNOW, it\u2019s not rocket science, it\u2019s just image recognition, I haven\u2019t reinvented the wheel. In fact I\u2019m going to be even lazier and .. guess what ! .. I will be using an already trained model \ud83d\ude1c", "Keep in mind that the idea behind this tutorial is not to teach you Deep Leaning but rather to explore the pipeline of DL in production. What really matters is when we\u2019ll be creating an API to interact with our model, \u201cDockerizing\u201d it and deploying it.", "The codes used in this tutorial are available on my GitHub [here].", "As I\u2019ve said before, we\u2019re going to use a pretrained (and effective) Convolutional Neural Network model for image classification : VGG-19.", "You can download a version of this model trained on more than a million images from the ImageNet database. The pretrained network can classify images into 1000 object categories, such as keyboard, car, orange, and many animals.", "If you have a specific task of -say- classifying images in healthcare or in a factory, you can use this model as a starting point of a bigger model. In this case, the weights of the pretrained can be frozen so that they are not updated during training. This technique is called Transfer Learning. For the sake of simplicity, we are just using VGG19 as it is.", "First, we have to import Tensorflow, Keras, as well as some functions to pre-process input images. Note that the default input size for this model is 224x224.", "You can download VGG19 model from this [link] and then use tf.keras.models.load_model() to load it.", "The following are two functions for preparing the input images and predicting the right class based on the pretrained model.", "Now, you can even test your model by adding these lines to the bottom of your file (\u26a0\ufe0f pay attention to the path)", "Now, let\u2019s create an API to interact with this model. To do so we will use Flask: a micro web framework written in Python, it provides functionalities for building web applications, managing HTTP requests, rendering templates and so on.", "We are also using Flask-Uploads which allows your application to flexibly and efficiently handle file uploading and serving the uploaded files.", "\u26a0\ufe0f Do not forget that before importing any library, first #pip install it !", "\u26a0\ufe0f If you encounter some dependency problems when using Flask-Uploads installation, try to #pip install Flask-Reuploaded instead.", "Note that we imported the two functions we created in the first step (they are located in another file named model.py)", "Now let\u2019s get down to business ..", "At this stage, we need a new /upload route; but before going any further we first need a web page where the user will upload his image for us to process it.", "Now that you are dazzled by my exceptional gift and expertise in web design \ud83d\ude05, let\u2019s go back to our upload.py file.", "So on the route /upload we expect to receive an HTTP POST request with an attached image, we\u2019ll save this image in the path we specified before and we\u2019ll use the two functions we\u2019ve defined earlier in order to recognize the content of the image. Finally we render our prediction back to the user.", "You can test your application by running the file using #python upload.py then go to the browser and type http://localhost:5000/upload .. and enjoy !", "\u26a0\ufe0f Make sure your files\u2019 locations correspond to the paths you use. You can check my project structure in my GitHub Repository", "Your application is now up and running on your machine, and you reached the stage where you want to be able to distribute it.", "However, just because the code works well on a specific machine doesn\u2019t mean it\u2019s going to work on other machines. So, it would be helpful if we could create an environment that contains our code as well as all the dependencies it requires for running, regardless of the host specs. In Docker\u2019s language, we call this container .. well .. \u201ca container\u201d \ud83d\ude0a", "Okay, let\u2019s be clear, this isn\u2019t an advanced docker tutorial, but it contains basic and crucial things that took me long time to understand when I just started working with Docker.", "In short, Docker allows us to create reproducible environments. So if you\u2019re moving your application to a Cloud resource -and generally you will- then you can easily and surely deploy it without worrying about the dependencies, versions or recipient system.", "Let\u2019s go back to work ..", "3. Create a Dockerfile (without extension) which contains the instructions for building your Docker image.", "For further information about the commands of Dockerfile, check the documentation", "4. In a terminal, run the following command to build the Docker image:", "#docker build -f Dockerfile -t recog_container:api .", "5. Run container in background and print container ID using:", "Once this is running, you should be able to view your app running in your browser at http://localhost:5000/upload", "In case you need to install more libraries in this container, just run #docker ps and get the CONTAINER ID of your container.", "Next, connect to this container using #docker exec -it <CONTAINER_ID> bash", "Once connected, you can install whatever you want, for instance #pip install pillow and exit through #exit command", "If you\u2019re interested, you can find lots of others Docker commands [in this link]", "Thanks to Heroku we will be able to deploy our application in the Cloud, thus everyone can be able to use it and recognize what\u2019s in their images \ud83d\ude0e", "In this tutorial, we discovered that there are a lot of steps that have to be taken before an ML/DL model can be used by the customers.", "The first step is to actually build your model \ud83d\ude05, and we have seen that there are lots of pretrained models that can be used as a starting point for your project. The second step was about building a Flask API in order to be able to interact with your ML-based backend. Then, we used Docker to package up this application with all of the requirements it depends on. Finally, we made the app available to everyone thanks to the Cloud Platform Heroku.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Artificial Intelligence \u2014 Conversational AI \u2014 Machine Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F933b5f885459&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----933b5f885459--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----933b5f885459--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aissam-outchakoucht.medium.com/?source=post_page-----933b5f885459--------------------------------", "anchor_text": ""}, {"url": "https://aissam-outchakoucht.medium.com/?source=post_page-----933b5f885459--------------------------------", "anchor_text": "Aissam Outchakoucht"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7ace8b3eef7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&user=Aissam+Outchakoucht&userId=7ace8b3eef7c&source=post_page-7ace8b3eef7c----933b5f885459---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F933b5f885459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F933b5f885459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@liacastelli?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Mar\u00edlia Castelli"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/aissam-out/ML-in-production", "anchor_text": "[here]"}, {"url": "https://giphy.com/gifs/running-muppets-7kn27lnYSAE9O", "anchor_text": "giphy.com"}, {"url": "https://arxiv.org/abs/1409.1556", "anchor_text": "VGG-19"}, {"url": "http://www.image-net.org/", "anchor_text": "ImageNet"}, {"url": "https://drive.google.com/file/d/1Sk0jIQonfxkeaybotFML1VYY-faP9lhD/view?usp=sharing", "anchor_text": "[link]"}, {"url": "https://github.com/aissam-out/ML-in-production", "anchor_text": "GitHub Repository"}, {"url": "https://www.docker.com/products/docker-desktop", "anchor_text": "download and install Docker"}, {"url": "https://docs.docker.com/engine/reference/builder/", "anchor_text": "the documentation"}, {"url": "http://localhost:5000/upload", "anchor_text": "http://localhost:5000/upload"}, {"url": "https://docs.docker.com/engine/reference/commandline/docker/", "anchor_text": "[in this link]"}, {"url": "https://www.heroku.com/", "anchor_text": "Heroku"}, {"url": "https://signup.heroku.com/", "anchor_text": "Heroku account"}, {"url": "https://devcenter.heroku.com/articles/heroku-cli#download-and-install", "anchor_text": "Command Line Interface (CLI)"}, {"url": "https://github.com/aissam-out/ML-in-production", "anchor_text": "[HERE]"}, {"url": "https://twitter.com/aissam_out", "anchor_text": "[HERE]"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----933b5f885459---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----933b5f885459---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/flask?source=post_page-----933b5f885459---------------flask-----------------", "anchor_text": "Flask"}, {"url": "https://medium.com/tag/docker?source=post_page-----933b5f885459---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/tag/herokuapp?source=post_page-----933b5f885459---------------herokuapp-----------------", "anchor_text": "Herokuapp"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F933b5f885459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&user=Aissam+Outchakoucht&userId=7ace8b3eef7c&source=-----933b5f885459---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F933b5f885459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&user=Aissam+Outchakoucht&userId=7ace8b3eef7c&source=-----933b5f885459---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F933b5f885459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----933b5f885459--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F933b5f885459&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----933b5f885459---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----933b5f885459--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----933b5f885459--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----933b5f885459--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----933b5f885459--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----933b5f885459--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----933b5f885459--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----933b5f885459--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----933b5f885459--------------------------------", "anchor_text": ""}, {"url": "https://aissam-outchakoucht.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aissam-outchakoucht.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aissam Outchakoucht"}, {"url": "https://aissam-outchakoucht.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "70 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7ace8b3eef7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&user=Aissam+Outchakoucht&userId=7ace8b3eef7c&source=post_page-7ace8b3eef7c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fef0bb06fd609&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-keras-flask-docker-and-heroku-933b5f885459&newsletterV3=7ace8b3eef7c&newsletterV3Id=ef0bb06fd609&user=Aissam+Outchakoucht&userId=7ace8b3eef7c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}