{"url": "https://towardsdatascience.com/apache-spark-mllib-tutorial-ec6f1cb336a9", "time": 1682996377.4650428, "path": "towardsdatascience.com/apache-spark-mllib-tutorial-ec6f1cb336a9/", "webpage": {"metadata": {"title": "Linear Regression. Introduce Spark ML and how to use it to\u2026 | by Ali Masri | Towards Data Science", "h1": "Linear Regression", "description": "The goal of this series is to help you get started with Apache Spark\u2019s ML library. Together we will explore how to solve various interesting machine learning use-cases in a well structured way."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@alimasri1991/apache-spark-mllib-tutorial-7aba8a1dce6e", "anchor_text": "Part 2: Feature Transformation", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/apache-spark-mllib-tutorial-part-3-complete-classification-workflow-a1eb430ad069", "anchor_text": "Part 3: Classification", "paragraph_index": 0}, {"url": "https://spark.apache.org", "anchor_text": "Apache Spark", "paragraph_index": 4}, {"url": "https://spark.apache.org/mllib/", "anchor_text": "Apache Spark", "paragraph_index": 5}, {"url": "https://spark.apache.org/downloads.html", "anchor_text": "official website", "paragraph_index": 8}, {"url": "https://github.com/minrk/findspark", "anchor_text": "findspark", "paragraph_index": 10}, {"url": "https://www.numpy.org", "anchor_text": "Numpy", "paragraph_index": 12}, {"url": "https://jupyter.org", "anchor_text": "The Jupyter Notebook", "paragraph_index": 14}, {"url": "https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "Boston Housing", "paragraph_index": 15}, {"url": "https://drive.google.com/open?id=1-zxrKH1T0fM1Oi1mZzCWNtzHzeM4OsKt", "anchor_text": "here", "paragraph_index": 15}, {"url": "http://lib.stat.cmu.edu/datasets/boston", "anchor_text": "StatLib archive", "paragraph_index": 16}, {"url": "https://twitter.com/alimasri1991", "anchor_text": "Twitter", "paragraph_index": 42}, {"url": "https://www.facebook.com/alimasri91", "anchor_text": "Facebook", "paragraph_index": 42}, {"url": "https://www.linkedin.com/in/alimasri/", "anchor_text": "LinkedIn", "paragraph_index": 42}, {"url": "https://alimasri.info", "anchor_text": "https://alimasri.info", "paragraph_index": 44}], "all_paragraphs": ["Note: This article is part of a series. Check out the full series: Part 1: Regression, Part 2: Feature Transformation, Part 3: Classification, Parts 4 and up are coming soon.", "The goal of this series is to help you get started with Apache Spark\u2019s ML library. Together we will explore how to solve various interesting machine learning use-cases in a well structured way. By the end, you will be able to use Spark ML with high confidence and learn to implement an organized and easy to maintain workflow for your future projects", "In the first part of the series we will focus on the very basics of Spark ML. We will cover the necessary steps to create a regression model to predict housing prices. More complicated Spark ML features and functions are to be published in future posts of the series.", "Before going further let us start with some definitions.", "Apache Spark is an open-source cluster-computing framework. Originally developed at the University of California, Berkeley\u2019s AMPLab, the Spark codebase was later donated to the Apache Software Foundation, which has maintained it since. Spark provides an interface for programming entire clusters with implicit data parallelism and fault tolerance.", "Apache Spark ML is the machine learning library consisting of common learning algorithms and utilities, including classification, regression, clustering, collaborative filtering, dimensionality reduction, and underlying optimization primitives.", "Moving to the Big Data Era requires heavy iterative computations on very big datasets. Standard implementations of machine learning algorithms require very powerful machines to be able to run. Depending on high-end machines is not advantageous due to their high price and improper costs of scaling up. The idea of using distributed computing engines is to distribute the calculations to multiple low-end machines (commodity hardware) instead of a single high-end one. This definitely speeds up the learning phase and allows us to create better models.", "In order to follow up with this tutorial you have to install the following:", "Installing Apache Spark is so simple. You just have to download the package from the official website.", "The output should look like the following:", "To make reaching Apache Spark easier, we will use findspark. It is a very simple library that automatically sets up the development environment to import Apache Spark library.", "To install findspark, run the following in your shell:", "Numpy is a famous numeric computation library in Python. Spark ML uses it internally for its computations.", "Install it with the following command:", "The Jupyter Notebook is an open-source web application that allows you to create and share documents that contain live code, equations, visualizations and narrative text. Uses include: data cleaning and transformation, numerical simulation, statistical modeling, data visualization, machine learning, and much more.", "The first problem in this series is Regression. We are going to train a model to predict the famous Boston Housing dataset (download from here).", "This dataset contains information collected by the U.S Census Service concerning housing in the area of Boston Mass. It was obtained from the StatLib archive, and has been used extensively throughout the literature to benchmark algorithms.", "The dataset is small in size with only 506 cases. It contains 14 features described as follows:", "The goal is to use the 13 features to predict the value of MEDV (which represents the housing price).", "It is time to get your hands dirty. Let us jump into Spark and Spark .", "To get your development environment ready lunch Jupyter and create a new notebook.", "We start by importing the findspark library and initializing it by passing in the path to Apache Spark folder.", "Every Spark application requires a SparkSession.", "To create a SparkSession we write:", "Now for the fun part\u2026 Spark ML\u2019s algorithms expect the data to be represented in two columns: Features and Labels. Features is an array of data points of all the features to be used for prediction. Labels contain the output label for each data point.", "In our example, the features are the columns from 1 \u2192 13, the labels is the MEDV column that contains the price.", "The goal is to predict the label from the features.", "Creating a features array is straight forward. You just have to import the VectorAssembler class and pass in a list of the feature column names.", "Now we use the assembler to create the features column:", "That is it! If you print the values of data_2 you will notice a new column named \u201cfeatures\u201d that contains all the values combined in one list:", "As in any machine learning work flow, we split the data into train and test set. Here we split it to 70% training examples and 30% testing examples.", "We move to another interesting part, let us train a simple LinearRegression model on our data. First, we import the necessary class.", "Next we define the algorithm variable. We need to specify the name of the features column and the labels column.", "Time for training\u2026 We call the fit method to start training our model on the train set.", "Voila! You have trained your first model using Spark ML!", "Completing the training phase is not enough. We have to calculate how good our model is. Luckily the model object has an evaluate method:", "Use the evaluation_summary object to access a vast amount of metrics:", "Well, not bad for a simple model.", "To predict outputs for unlabeled data you call model.transform function while passing your DataFrame.", "For example, let us predict values from the test set:", "predictions is a DataFrame that contains: the original columns, the features column and predictions column generated by the model.", "It was a long article I know, but I hope it was worth your time. We introduced Apache Spark and its amazing ML library. We used Spark ML on a regression problem to predict housing prices. Next I will cover more features with other use-cases. Stay tuned\u2026", "If you enjoyed this article, I would appreciate it if you hit the clap button \ud83d\udc4f so it could be spread to others. You can also follow me on Twitter, Facebook, email me directly or find me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Data Engineer @ Ford Motor Company. https://alimasri.info"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fec6f1cb336a9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alimasri1991?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alimasri1991?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": "Ali Masri"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F759a0c777b02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&user=Ali+Masri&userId=759a0c777b02&source=post_page-759a0c777b02----ec6f1cb336a9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec6f1cb336a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec6f1cb336a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@alimasri1991/apache-spark-mllib-tutorial-7aba8a1dce6e", "anchor_text": "Part 2: Feature Transformation"}, {"url": "https://towardsdatascience.com/apache-spark-mllib-tutorial-part-3-complete-classification-workflow-a1eb430ad069", "anchor_text": "Part 3: Classification"}, {"url": "https://spark.apache.org", "anchor_text": "Apache Spark"}, {"url": "https://spark.apache.org/mllib/", "anchor_text": "Apache Spark"}, {"url": "https://spark.apache.org/downloads.html", "anchor_text": "official website"}, {"url": "https://github.com/minrk/findspark", "anchor_text": "findspark"}, {"url": "https://www.numpy.org", "anchor_text": "Numpy"}, {"url": "https://jupyter.org", "anchor_text": "The Jupyter Notebook"}, {"url": "https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "Boston Housing"}, {"url": "https://drive.google.com/open?id=1-zxrKH1T0fM1Oi1mZzCWNtzHzeM4OsKt", "anchor_text": "here"}, {"url": "http://lib.stat.cmu.edu/datasets/boston", "anchor_text": "StatLib archive"}, {"url": "https://twitter.com/alimasri1991", "anchor_text": "Twitter"}, {"url": "https://www.facebook.com/alimasri91", "anchor_text": "Facebook"}, {"url": "https://www.linkedin.com/in/alimasri/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ec6f1cb336a9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/apache-spark?source=post_page-----ec6f1cb336a9---------------apache_spark-----------------", "anchor_text": "Apache Spark"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----ec6f1cb336a9---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/big-data?source=post_page-----ec6f1cb336a9---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/sparkml?source=post_page-----ec6f1cb336a9---------------sparkml-----------------", "anchor_text": "Sparkml"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fec6f1cb336a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&user=Ali+Masri&userId=759a0c777b02&source=-----ec6f1cb336a9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fec6f1cb336a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&user=Ali+Masri&userId=759a0c777b02&source=-----ec6f1cb336a9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec6f1cb336a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fec6f1cb336a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ec6f1cb336a9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ec6f1cb336a9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alimasri1991?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alimasri1991?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ali Masri"}, {"url": "https://medium.com/@alimasri1991/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "254 Followers"}, {"url": "https://alimasri.info", "anchor_text": "https://alimasri.info"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F759a0c777b02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&user=Ali+Masri&userId=759a0c777b02&source=post_page-759a0c777b02--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6074babbd9e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-spark-mllib-tutorial-ec6f1cb336a9&newsletterV3=759a0c777b02&newsletterV3Id=6074babbd9e9&user=Ali+Masri&userId=759a0c777b02&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}