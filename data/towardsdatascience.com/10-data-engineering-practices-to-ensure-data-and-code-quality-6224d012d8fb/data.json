{"url": "https://towardsdatascience.com/10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb", "time": 1683014713.1114519, "path": "towardsdatascience.com/10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb/", "webpage": {"metadata": {"title": "10 Data Engineering Practices to Ensure Data and Code Quality | by Anna Geller | Towards Data Science", "h1": "10 Data Engineering Practices to Ensure Data and Code Quality", "description": "Data engineering is one of the fastest-growing professions of the century. Since I started working in the field, I encountered various ways of ensuring data and code quality across organizations\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@anna.anisienia", "anchor_text": "follow me", "paragraph_index": 26}, {"url": "http://www.annageller.com", "anchor_text": "www.annageller.com", "paragraph_index": 28}, {"url": "https://annageller.medium.com/subscribe", "anchor_text": "https://annageller.medium.com/subscribe", "paragraph_index": 28}], "all_paragraphs": ["Data engineering is one of the fastest-growing professions of the century. Since I started working in the field, I encountered various ways of ensuring data and code quality across organizations. Even though each company may follow different processes and standards, there are some universal principles that can help us to enhance the development speed, improve code maintenance, and make work with data easier.", "The first programming language I\u2019ve learned during my studies was Java. Even though I understood the benefits of object-oriented programming related to creating reusable classes and modules, I found it hard to apply it when working with data. Two years later, I came across R \u2014 a functional programming language, and back then, I fell in love. Being able to use the dplyr package and simply pipe the functions to transform the data and quickly see the results, was life-changing.", "But these days, Python allows us to combine both worlds: the ability to write object-oriented modular scripts, while at the same time making use of functional programming that works so well when interacting with data in R.", "The reason why functional programming is so excellent for working with data is that nearly any data engineering task can be accomplished by taking input data, applying some function to it (i.e., your T in ETL: transforming, cleaning, or enriching the data), and loading its output to some centralized repository or serving it for reporting or data science use cases.", "The functional programming paradigm is so common in data engineering that many blog posts have been written about that. For example, the article linked below has been posted by the creator of Apache Airflow, Maxime Beauchemin, already in the beginning of 2018:", "Similarly, many data engineering tools have been created to facilitate the process. Functional programming let us create code that can be reused across many data engineering tasks and can be easily tested by feeding small chunks of data to the function before running ETL on large amounts of production data.", "To make functions reusable, it\u2019s a good practice to write them in such a way that they do one thing. You can always have your main function that can tie together different pieces. Overall, I found out that by making functions small (i.e., focusing on doing one thing well), I tend to develop code faster, as a failure of a single element can be easier identified and fixed.", "Smaller functions make it also easier to exchange single components and use them as lego bricks that can be combined together for different use cases.", "A good practice is to name the objects so that a new person who looks at your code can immediately understand your intentions. If some abbreviations may not be understandable for everybody, it may be better to avoid them and write the names in full. Additionally, most data engineers I\u2019ve seen tend to use the following conventions:", "Ideally, your naming can make your code self-documenting, which can also make you write code faster.", "In general, we read code much more frequently than we write it. Therefore, it makes sense to make our code readable and easy to follow. With proper naming and a good structure, we make it easier for our future self and for other people who work with our code.", "Being concise is also helpful: the less code we write, the less code we need to maintain. If we can accomplish something with fewer lines of code, it\u2019s a potential win.", "It may sound counter-intuitive, but we shouldn\u2019t document WHAT our code is doing. Instead, we should document WHY our code is doing what it\u2019s doing. I\u2019ve often seen code comments stating the obvious.", "For instance, our function get_dataframe_from_google_ads() doesn\u2019t have to say that we are downloading data from google ads but rather the reason for doing that, ex. \u201cdownloading ads spending data for later marketing cost attribution.\u201d", "On top of that, using docstrings or type annotations to document the expected input and output of the function is extremely helpful! It immediately makes you a better data engineer.", "I\u2019ve seen many ETL-related SQL queries that were using some threshold values without explaining the reason for them. For instance, imagine a script to extract data from some table, but only for events that happened after 30.09.2020. And there is absolutely no documentation why somebody picked this specific date! Without explaining why, how should anybody later find out why this value has been hard-coded. It could be because, on that day, the company transitioned to a new source system, data provider, or they may have changed some business strategy.", "I\u2019m not saying that it\u2019s wrong to specify such business logic within the code. But without documenting why somebody has chosen such an arbitrary threshold, this hard-coded value could remain a mystery for the next generations of data engineers in years to come.", "A common anti-pattern I\u2019ve encountered often is when somebody keeps code that has been abandoned but left commented out in the script. Maybe somebody wanted to test some new behavior and kept the old version just in case the new one doesn\u2019t work. Or perhaps this person wanted to keep the history. In both cases, I would argue that it\u2019s best to avoid that, as it may be confusing for later developers to distinguish between what is indeed the correct version.", "For instance, I experienced a situation when the commented out code snippet made much more sense than the version that was not commented out. It could be that at some point, somebody will switch those two just because he or she would assume that the act of commenting out this more logical version happened by mistake. Therefore, keeping a zombie code can be dangerous.", "Mixing the utility functions and business logic can make sense, but it\u2019s still beneficial to keep them separate. If appropriately used, the common functionality can be pushed to a different package and reused later across many projects. This separation requires more effort upfront (ex. by building a release process for such packages), but reusability and the benefit of defining a single functionality only once can pay off in the long run.", "According to the Zen of Python [2]:", "Many data engineers, especially those with a Computer Science background, can sometimes create sophisticated but too complex solutions. For instance, if something can be expressed as a simple function that takes some data as input and returns a transformed version as output, then writing a custom class object for such operation may be considered an over-engineered\u00a0solution.", "Sometimes we need to make trade-offs between doing things right and doing them fast. Creating solutions that are general enough to be reused across different use cases, and that will make our lives easier long-term, take longer to develop. For instance, establishing a release process and CI/CD pipelines for modules shared across projects can take a lot of time upfront, but this extra effort usually pays off later. The same is true for taking the time to create scripts that continuously validate and monitor data quality.", "In this article, we discussed best practices for data engineering to ensure a high quality of data and maintainability of code. We\u2019ve shown that most data engineering tasks can be expressed as functions that take some input data and transform it according to the specific business requirements.", "Those functions should ideally be designed to do one thing and documented so that anyone who reads the code knows what is needed as input and what is generated as the output of the function.", "We\u2019ve also looked at useful naming conventions and the best way of structuring, writing, and documenting code to make it useful in the long run.", "Thank you for reading! If this article was helpful, follow me to see my next articles.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "DevRel, Data Professional, Cloud & .py fan. www.annageller.com. Get my articles via email: https://annageller.medium.com/subscribe"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6224d012d8fb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://annageller.medium.com/?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": ""}, {"url": "https://annageller.medium.com/?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": "Anna Geller"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bdf5a3385cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&user=Anna+Geller&userId=5bdf5a3385cd&source=post_page-5bdf5a3385cd----6224d012d8fb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6224d012d8fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6224d012d8fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://www.pexels.com/@brotherkehn?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Kehn Hermano"}, {"url": "https://www.pexels.com/photo/time-lapse-photography-of-cars-on-road-during-night-time-3881034/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://medium.com/@maximebeauchemin/functional-data-engineering-a-modern-paradigm-for-batch-data-processing-2327ec32c42a", "anchor_text": "Functional Data Engineering \u2014 a modern paradigm for batch data processingBatch data processing \u2014 historically known as ETL \u2014 is extremely challenging. It\u2019s time-consuming, brittle, and often\u2026medium.com"}, {"url": "https://medium.com/@anna.anisienia", "anchor_text": "follow me"}, {"url": "https://www.reddit.com/r/ProgrammerHumor/comments/8w54mx/code_comments_be_like/", "anchor_text": "cat image"}, {"url": "https://www.python.org/dev/peps/pep-0020/", "anchor_text": "The Zen of Python"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----6224d012d8fb---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/tag/programming?source=post_page-----6224d012d8fb---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----6224d012d8fb---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----6224d012d8fb---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----6224d012d8fb---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6224d012d8fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&user=Anna+Geller&userId=5bdf5a3385cd&source=-----6224d012d8fb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6224d012d8fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&user=Anna+Geller&userId=5bdf5a3385cd&source=-----6224d012d8fb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6224d012d8fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6224d012d8fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6224d012d8fb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6224d012d8fb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6224d012d8fb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6224d012d8fb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6224d012d8fb--------------------------------", "anchor_text": ""}, {"url": "https://annageller.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://annageller.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anna Geller"}, {"url": "https://annageller.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.4K Followers"}, {"url": "http://www.annageller.com", "anchor_text": "www.annageller.com"}, {"url": "https://annageller.medium.com/subscribe", "anchor_text": "https://annageller.medium.com/subscribe"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bdf5a3385cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&user=Anna+Geller&userId=5bdf5a3385cd&source=post_page-5bdf5a3385cd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F908ff40c4340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-data-engineering-practices-to-ensure-data-and-code-quality-6224d012d8fb&newsletterV3=5bdf5a3385cd&newsletterV3Id=908ff40c4340&user=Anna+Geller&userId=5bdf5a3385cd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}