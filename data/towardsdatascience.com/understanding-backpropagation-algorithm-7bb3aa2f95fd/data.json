{"url": "https://towardsdatascience.com/understanding-backpropagation-algorithm-7bb3aa2f95fd", "time": 1682997585.443368, "path": "towardsdatascience.com/understanding-backpropagation-algorithm-7bb3aa2f95fd/", "webpage": {"metadata": {"title": "Understanding Backpropagation Algorithm | by Simeon Kostadinov | Towards Data Science", "h1": "Understanding Backpropagation Algorithm", "description": "Backpropagation algorithm is probably the most fundamental building block in a neural network. It was first introduced in 1960s and almost 30 years later (1989) popularized by Rumelhart, Hinton and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.nature.com/articles/323533a0", "anchor_text": "Learning representations by back-propagating errors", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Sigmoid_function", "anchor_text": "sigmoid", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Hyperbolic_function", "anchor_text": "tanh", "paragraph_index": 8}, {"url": "https://medium.com/the-theory-of-everything/understanding-activation-functions-in-neural-networks-9491262884e0", "anchor_text": "this great article", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Mean_squared_error", "anchor_text": "MSE", "paragraph_index": 21}, {"url": "http://neuralnetworksanddeeplearning.com/chap3.html", "anchor_text": "cross-entropy", "paragraph_index": 21}, {"url": "https://stats.stackexchange.com/questions/154879/a-list-of-cost-functions-used-in-neural-networks-alongside-applications", "anchor_text": "any other cost function", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Chain_rule", "anchor_text": "chain rule", "paragraph_index": 31}, {"url": "https://www.youtube.com/watch?v=isPiE-DBagM&list=PL3FW7Lu3i5Jsnh1rnUwq_TcylNr7EkRe6", "anchor_text": "Stanford\u2019s NLP series where Richard Socher gives 4 great explanations of backpropagation", "paragraph_index": 40}, {"url": "https://www.linkedin.com/in/simeonkostadinov/", "anchor_text": "https://www.linkedin.com/in/simeonkostadinov/", "paragraph_index": 43}], "all_paragraphs": ["Backpropagation algorithm is probably the most fundamental building block in a neural network. It was first introduced in 1960s and almost 30 years later (1989) popularized by Rumelhart, Hinton and Williams in a paper called \u201cLearning representations by back-propagating errors\u201d.", "The algorithm is used to effectively train a neural network through a method called chain rule. In simple terms, after each forward pass through a network, backpropagation performs a backward pass while adjusting the model\u2019s parameters (weights and biases).", "In this article, I would like to go over the mathematical process of training and optimizing a simple 4-layer neural network. I believe this would help the reader understand how backpropagation works as well as realize its importance.", "The 4-layer neural network consists of 4 neurons for the input layer, 4 neurons for the hidden layers and 1 neuron for the output layer.", "The neurons, colored in purple, represent the input data. These can be as simple as scalars or more complex like vectors or multidimensional matrices.", "The first set of activations (a) are equal to the input values. NB: \u201cactivation\u201d is the neuron\u2019s value after applying an activation function. See below.", "The final values at the hidden neurons, colored in green, are computed using z^l \u2014 weighted inputs in layer l, and a^l\u2014 activations in layer l. For layer 2 and 3 the equations are:", "W\u00b2 and W\u00b3 are the weights in layer 2 and 3 while b\u00b2 and b\u00b3 are the biases in those layers.", "Activations a\u00b2 and a\u00b3 are computed using an activation function f. Typically, this function f is non-linear (e.g. sigmoid, ReLU, tanh) and allows the network to learn complex patterns in data. We won\u2019t go over the details of how activation functions work, but, if interested, I strongly recommend reading this great article.", "Looking carefully, you can see that all of x, z\u00b2, a\u00b2, z\u00b3, a\u00b3, W\u00b9, W\u00b2, b\u00b9 and b\u00b2 are missing their subscripts presented in the 4-layer network illustration above. The reason is that we have combined all parameter values in matrices, grouped by layers. This is the standard way of working with neural networks and one should be comfortable with the calculations. However, I will go over the equations to clear out any confusion.", "Let\u2019s pick layer 2 and its parameters as an example. The same operations can be applied to any layer in the network.", "NB: The first number in any weight\u2019s subscript matches the index of the neuron in the next layer (in our case this is the Hidden_2 layer) and the second number matches the index of the neuron in previous layer (in our case this is the Input layer).", "Following the equation for z\u00b2, we can use the above definitions of W\u00b9, x and b\u00b9 to derive \u201cEquation for z\u00b2\u201d:", "Now carefully observe the neural network illustration from above.", "You will see that z\u00b2 can be expressed using (z_1)\u00b2 and (z_2)\u00b2 where (z_1)\u00b2 and (z_2)\u00b2 are the sums of the multiplication between every input x_i with the corresponding weight (W_ij)\u00b9.", "This leads to the same \u201cEquation for z\u00b2\u201d and proofs that the matrix representations for z\u00b2, a\u00b2, z\u00b3 and a\u00b3 are correct.", "The final part of a neural network is the output layer which produces the predicated value. In our simple example, it is presented as a single neuron, colored in blue and evaluated as follows:", "Again, we are using the matrix representation to simplify the equation. One can use the above techniques to understand the underlying logic. Please leave any comments below if you find yourself lost in the equations \u2014 I would love to help!", "The equations above form network\u2019s forward propagation. Here is a short overview:", "The final step in a forward pass is to evaluate the predicted output s against an expected output y.", "The output y is part of the training dataset (x, y) where x is the input (as we saw in the previous section).", "Evaluation between s and y happens through a cost function. This can be as simple as MSE (mean squared error) or more complex like cross-entropy.", "We name this cost function C and denote it as follows:", "were cost can be equal to MSE, cross-entropy or any other cost function.", "Based on C\u2019s value, the model \u201cknows\u201d how much to adjust its parameters in order to get closer to the expected output y. This happens using the backpropagation algorithm.", "According to the paper from 1989, backpropagation:", "repeatedly adjusts the weights of the connections in the network so as to minimize a measure of the difference between the actual output vector of the net and the desired output vector.", "the ability to create useful new features distinguishes back-propagation from earlier, simpler methods\u2026", "In other words, backpropagation aims to minimize the cost function by adjusting network\u2019s weights and biases. The level of adjustment is determined by the gradients of the cost function with respect to those parameters.", "One question may arise \u2014 why computing gradients?", "To answer this, we first need to revisit some calculus terminology:", "Compute those gradients happens using a technique called chain rule.", "For a single weight (w_jk)^l, the gradient is:", "Similar set of equations can be applied to (b_j)^l:", "The common part in both equations is often called \u201clocal gradient\u201d and is expressed as follows:", "The \u201clocal gradient\u201d can easily be determined using the chain rule. I won\u2019t go over the process now but if you have any questions, please comment below.", "The gradients allow us to optimize the model\u2019s parameters:", "I would like to dedicate the final part of this section to a simple example in which we will calculate the gradient of C with respect to a single weight (w_22)\u00b2.", "Let\u2019s zoom in on the bottom part of the above neural network:", "Calculating the final value of derivative of C in (a_2)\u00b3 requires knowledge of the function C. Since C is dependent on (a_2)\u00b3, calculating the derivative should be fairly straightforward.", "I hope this example manages to throw some light on the mathematics behind computing gradients. To further enhance your skills, I strongly recommend watching Stanford\u2019s NLP series where Richard Socher gives 4 great explanations of backpropagation.", "In this article, I went through a detailed explanation of how backpropagation works under the hood using mathematical techniques like computing gradients, chain rule etc. Knowing the nuts and bolts of this algorithm will fortify your neural networks knowledge and make you feel comfortable to take on more complex models. Enjoy your deep learning journey!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Obsessed with creating a positive impact. Love blogging about AI and reading books. For more content, follow me \ud83d\udc49 https://www.linkedin.com/in/simeonkostadinov/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7bb3aa2f95fd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@simonnoff?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@simonnoff?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": "Simeon Kostadinov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5cdfd010517e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&user=Simeon+Kostadinov&userId=5cdfd010517e&source=post_page-5cdfd010517e----7bb3aa2f95fd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7bb3aa2f95fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7bb3aa2f95fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@whatyouhide?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Andrea Leopardi"}, {"url": "https://unsplash.com/search/photos/running?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.nature.com/articles/323533a0", "anchor_text": "Learning representations by back-propagating errors"}, {"url": "https://en.wikipedia.org/wiki/Sigmoid_function", "anchor_text": "sigmoid"}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU"}, {"url": "https://en.wikipedia.org/wiki/Hyperbolic_function", "anchor_text": "tanh"}, {"url": "https://medium.com/the-theory-of-everything/understanding-activation-functions-in-neural-networks-9491262884e0", "anchor_text": "this great article"}, {"url": "https://en.wikipedia.org/wiki/Mean_squared_error", "anchor_text": "MSE"}, {"url": "http://neuralnetworksanddeeplearning.com/chap3.html", "anchor_text": "cross-entropy"}, {"url": "https://stats.stackexchange.com/questions/154879/a-list-of-cost-functions-used-in-neural-networks-alongside-applications", "anchor_text": "any other cost function"}, {"url": "https://en.wikipedia.org/wiki/Partial_derivative", "anchor_text": "partial derivatives"}, {"url": "https://en.wikipedia.org/wiki/Derivative", "anchor_text": "The derivative of a function C measures the sensitivity to change of the function value (output value) with respect to a change in its argument x (input value)"}, {"url": "https://en.wikipedia.org/wiki/Chain_rule", "anchor_text": "chain rule"}, {"url": "https://machinelearningmastery.com/understand-the-dynamics-of-learning-rate-on-deep-learning-neural-networks/", "anchor_text": "learning rate"}, {"url": "https://www.youtube.com/watch?v=isPiE-DBagM&list=PL3FW7Lu3i5Jsnh1rnUwq_TcylNr7EkRe6", "anchor_text": "Stanford\u2019s NLP series where Richard Socher gives 4 great explanations of backpropagation"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7bb3aa2f95fd---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----7bb3aa2f95fd---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----7bb3aa2f95fd---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----7bb3aa2f95fd---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7bb3aa2f95fd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7bb3aa2f95fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&user=Simeon+Kostadinov&userId=5cdfd010517e&source=-----7bb3aa2f95fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7bb3aa2f95fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&user=Simeon+Kostadinov&userId=5cdfd010517e&source=-----7bb3aa2f95fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7bb3aa2f95fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7bb3aa2f95fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7bb3aa2f95fd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7bb3aa2f95fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@simonnoff?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@simonnoff?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Simeon Kostadinov"}, {"url": "https://medium.com/@simonnoff/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "https://www.linkedin.com/in/simeonkostadinov/", "anchor_text": "https://www.linkedin.com/in/simeonkostadinov/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5cdfd010517e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&user=Simeon+Kostadinov&userId=5cdfd010517e&source=post_page-5cdfd010517e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdb933cd491bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-backpropagation-algorithm-7bb3aa2f95fd&newsletterV3=5cdfd010517e&newsletterV3Id=db933cd491bc&user=Simeon+Kostadinov&userId=5cdfd010517e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}