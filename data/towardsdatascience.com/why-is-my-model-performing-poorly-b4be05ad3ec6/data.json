{"url": "https://towardsdatascience.com/why-is-my-model-performing-poorly-b4be05ad3ec6", "time": 1683017727.3264298, "path": "towardsdatascience.com/why-is-my-model-performing-poorly-b4be05ad3ec6/", "webpage": {"metadata": {"title": "Why is my model performing poorly? | by Martin \u0160iklar | Towards Data Science", "h1": "Why is my model performing poorly?", "description": "If any of the statements above apply to your situation then your model might be either overfitting or underfitting the training data. If you continue reading, you will learn the necessary knowledge\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/", "anchor_text": "\u201cHands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2nd Edition\u201d", "paragraph_index": 1}], "all_paragraphs": ["Are you sometimes struggling with your model performance? Is your model performing well during training but when you apply it to new data, it fails? Or do you even struggle finding a good model in the first place because it just doesn\u2019t seem to learn enough from the data you provided?", "If any of the statements above apply to your situation then your model might be either overfitting or underfitting the training data. If you continue reading, you will learn the necessary knowledge on how to identify these phenomenons and be provided with tools and remedies on how to overcome them and finally increase your models performance \u2014 the true goal of every machine learning engineer. We will be looking into this topic from the Regression perspective with code examples provided in Python and scikit-learn. Please note that this article is highly inspired by the excellent book \u201cHands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2nd Edition\u201d which is a great ressource for boosting your machine learning knowledge.", "As an introduction we will start by briefly looking into examples of models which are underfitting, overfitting and performing well. To do this, let\u2019s start with the simplest possible regression model to visually illustrate what over-and underfitting means: linear regression.", "Imagine we have some non-linear data based on a quadratic function:", "It is clear that a simple linear model will never fit this quadratic data properly, but let\u2019s do the exercise for demonstration purposes:", "You can see that the linear function was able to detect the general trend of the data but the non-linearity is (as expected) not captured at all by the model. The model is clearly underfitting the data and doesn\u2019t depict the underlying relationship. The models performance is low.", "Let us therefore try out a polynomial regression which is able to capture more complex relationships in data. The easiest way of implementing a polynomial regression is to simply add powers (in our case square because we used a quadratic function) of each feature as a new feature and then apply the same Linear Regression function we used above.", "We can see that X_polynomial now contains the initial feature (-1.52521333) as well as its square (2.32627571). If we feed this in our Linear Regression function we end up having a Polynomial Regression. Let\u2019s see how it fits to the data.", "We can inspect the estimated coefficients of the model and compare them to the coefficients we used during the definition of our quadratic function.", "The models performance is very good! The polynomial regression estimated coefficients that are very close to the real coefficients, only the intercept was not well captured by the model due to the noise we added in the beginning.", "The general assumption is that a polynomial regression will fit the data much better than a simple linear regression. Let\u2019s look at another example and use a higher degree polynomial model to fit our data.", "As can be seen in the image below, a higher degree (100) polynomial model is highly overfitting the data. You can clearly see how the model wiggles around at the edges trying to fit the training data as good as possible.", "It is clear that from our three examples (linear, polynomial degree 2 and polynomial degree 100) our 2nd degree polynomial model performed the best because the underlying data was created using a quadratic function.", "However, normally we don\u2019t know what function represents our data in the best way possible or what model might be the best fit for us. So how do we find the best fitting model and what signs can we follow to judge a models performance?", "You might be familiar with this option since it is one of the most frequent you will find in literature: Cross Validation. Here the general idea is to split your training data set into k smaller subsets (folds). Subsequently you train your model on k-1 of these subsets and evaluate the models performance on the remaining subset. You repeat this procedure k times and end up with k evaluation scores. To get the overall cross-validation score you can simply take the mean value of the k scores.", "In scikit-learn this method is called K-fold cross validation and the underlying idea is to check how the model performs on the training set as compared to the cross validation scores. If a model performs well on the training set but the cross validation scores are low the model is overfitting. If the model performs poor on the training set and equally poor according to the cross validation scores, it is underfitting. The capability to correctly predict new data the model has never seen before is often referred to as generalization in literature. Let us go through some examples!", "Root mean square error of the simple linear regression", "Firstly, let\u2019 us compute the root mean square error (RMSE) of our linear regression model predictions on the training data.", "This means that our models prediction on average diverges from the real data by about 0.77 which is our training error. Let\u2019s compute the cross validation scores of our linear model. In this example we will be using the cross_val_score implementation in scikit-learn with 10 folds.", "What we get as an output are ten output scores measuring our models scores during cross validation. Each of these models was trained an a different subset of 90% of the data and evaluated with the remaining 10 % of the \u201cunseen\u201d data. In total this was done 10 times:", "To get the aggregated models cross validation error which we can compare to the root mean squared error during the training, we can simply take the square root and subsequently the mean of the scores:", "Finally we get to a mean cross-validation RMSE of 0.79. If we compare this error to the training set error we can see a difference of about 0.02. It is normal that the cross validation error is higher than the train error, but is 0.02 good or bad? Is it high or low? How can we tell? Hang on for another example and you will know!", "Root mean square error of the 2nd degree polynomial regression", "Let us do the same exercise for our 2nd degree polynomial regression and see how these errors compare to the errors of the linear model.", "Wow! 0.27 is much lower than the 0.77 RMSE we calculated from the linear model. We can clearly see that the linear model was clearly underfitting the data because its training error is much higher than the training error of the polynomial regression. Let us now compute the cross validation error of the polynomial regression:", "For the polynomial model we get a cross validation RMSE of 0.28 which is only off by 0.01 to the training data RMSE. We can therefore conclude:", "The linear regression RMSE is much higher than the RMSE of the polynomial regression in our example. Furthermore, we can see that the difference in RMSE between the training data and the cross validation is higher for the linear regression (0.02 > 0.01). This two signs yield the conclusion that the the linear regression is underfitting the data.", "Root mean square error of the higher degree polynomial regression", "Last but not least, let us look at the error of the higher degree (100) polynomial regression which gets an RMSE of stunning 0.24 on the training data which is even better than the second degree polynomial RMSE above!!", "But how does the cross-validation RMSE look like? Yep, its a jaw-dropping RMSE of 1020471.12. The model is heavily overfitting the training data (it has the lowest RMSE of all models) but performs horribly on unseen data as indicated by the unbelievably high cross validation RMSE. This is a text book example for strong overfitting. In machine learning terms the model therefore has a poor ability to generalize.", "Below you can find a summary on how you can interpret the errors and draw conclusions if your model is potentially over- or underfitting the training data:", "Another possibility, on how to detect over- and underfitting models is to look at their learning curves. Learning curves visualise the relationship of the models performance in regard to training data size. Let\u2019s look at two learning curves to explain the basic principle behind this analysis. For this part we will be using the same data from above ,which were generated using a quadratic function.", "Let\u2019s first divide our training data into a smaller training and validation set.", "Now let\u2019s loop through the observations in the new training set, starting with only one observation. Based on this, we will train our linear regression model and evaluate its performance using the entire validation set. We will do this iteratively and add another observation to the training set each round, followed by a retraining of the model and another evaluation with the validation set:", "Let us have a closer look at the produced graph and start with the RMSE on the training set (red line). Initially with only a few instances the training error is very low because the linear model can fit one or two instances very well, but once the training set starts to get bigger, the RMSE starts to rise very quickly until it reaches a constant level at about 30 instances. At this point the algorithm stopped learning what it could (remember that our data is quadratic and our model is linear) and increasing the training data size doesn\u2019t help anymore. The validation set error (blue line) is initially very high because the linear model is only trained on a handful of instances. However it rapidly gets smaller and smaller with every new instance that is added to the training set until it quickly reaches a plateau at a slightly higher level than the training set error. These types of curves are characteristic for models that are underfitting the data.", "Let us do the same exercise but by replacing the linear model with a higher degree polyonimal regression. When we look at the new curves it is hard to really tell a difference but we have to look for the subtle sings that tell us that our model is overfitting: The training error of this model is generally much lower than the training error of the previous linear model. Furthermore, for a very long time there is a larger gap between the red and blue line\u2014 as already discussed above, this is one of the main signs that your model is overfitting: A high validation error and a low training error.", "A very interesting detail however can be seen on the very end of the blue line: With more training instances the validation error starts dropping significantly and ends up being quite close to the training error \u2014 resulting in a much better model in the end.", "This might be maybe the most important questions and luckily I can leave you with a set of strategies that will hopefully help you building better performing models.", "Of course there is more strategies to overcome this, but data amount and model complexity can be seen as the smallest common denominator of the most of them. Before you however start switching models and changing their complexity, you should first check if your model is over- or underfitting so you can start heading into the right direction. By now you should have the necessary tools to do so in your backpack!", "If you want to learn more on this, please visit the links below where I have place some excellent literature and articles on this and related topics.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hello Medium, I am a data scientist, Ask Me Anything!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb4be05ad3ec6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://martinsiklar.medium.com/?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": ""}, {"url": "https://martinsiklar.medium.com/?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": "Martin \u0160iklar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57aeb942ddf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&user=Martin+%C5%A0iklar&userId=57aeb942ddf3&source=post_page-57aeb942ddf3----b4be05ad3ec6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb4be05ad3ec6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb4be05ad3ec6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@danavo?utm_source=medium&utm_medium=referral", "anchor_text": "Dana Vollenweider"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/", "anchor_text": "\u201cHands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2nd Edition\u201d"}, {"url": "https://unsplash.com/@austinchan?utm_source=medium&utm_medium=referral", "anchor_text": "Austin Chan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@hollymandarich?utm_source=medium&utm_medium=referral", "anchor_text": "Holly Mandarich"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/", "anchor_text": "https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/"}, {"url": "https://github.com/ageron/handson-ml2", "anchor_text": "https://github.com/ageron/handson-ml2"}, {"url": "https://towardsdatascience.com/overfitting-vs-underfitting-a-complete-example-d05dd7e19765", "anchor_text": "https://towardsdatascience.com/underfitting-and-overfitting-in-machine-learning-and-how-to-deal-with-it-6fe4a8a49dbf"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b4be05ad3ec6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b4be05ad3ec6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----b4be05ad3ec6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/regression?source=post_page-----b4be05ad3ec6---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb4be05ad3ec6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&user=Martin+%C5%A0iklar&userId=57aeb942ddf3&source=-----b4be05ad3ec6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb4be05ad3ec6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&user=Martin+%C5%A0iklar&userId=57aeb942ddf3&source=-----b4be05ad3ec6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb4be05ad3ec6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb4be05ad3ec6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b4be05ad3ec6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b4be05ad3ec6--------------------------------", "anchor_text": ""}, {"url": "https://martinsiklar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://martinsiklar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Martin \u0160iklar"}, {"url": "https://martinsiklar.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "148 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57aeb942ddf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&user=Martin+%C5%A0iklar&userId=57aeb942ddf3&source=post_page-57aeb942ddf3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6e9cdb00c47d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-is-my-model-performing-poorly-b4be05ad3ec6&newsletterV3=57aeb942ddf3&newsletterV3Id=6e9cdb00c47d&user=Martin+%C5%A0iklar&userId=57aeb942ddf3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}