{"url": "https://towardsdatascience.com/spatial-interpolation-with-kernels-cf3616487714", "time": 1683014621.666655, "path": "towardsdatascience.com/spatial-interpolation-with-kernels-cf3616487714/", "webpage": {"metadata": {"title": "Spatial Interpolation With Kernels | by Arun Jagota | Towards Data Science", "h1": "Spatial Interpolation With Kernels", "description": "A case study in air quality estimation from sensors in a geographical region. The sensors may have sparse coverage and occasionally fail or deliver inaccurate readings."}, "outgoing_paragraph_urls": [], "all_paragraphs": ["California has been on fire recently. Well, actually fires. Fire breeds smoke. That there\u2019s been plenty of.", "A heat map revealing the air quality in various regions is clearly useful. What are the modeling issues in building such a heat map? Seriously, entrepreneurs are pondering this question [1].", "Well, we do have air quality sensors. But not everywhere. We want to estimate air quality in sparsely covered areas from measurements on nearby sensors. We\u2019ll call this spatial interpolation.", "There are also measurement errors. Sensors have varying quality. The expensive sensors are more accurate, but also fewer. So their coverage is sparse. Inexpensive sensors are much more abundant. However, less accurate.", "Given these trade-offs, we should combine all data (within sufficient proximity) rather than choosing some over others. Taking into account sensor locations and their varying error rates.", "There can also be anomalous readings. Sensors sometimes return whacky results. Or get sick, even die. They can also produce biased results, i.e., those that are consistently off.", "Anomalies need detection so they can be discarded. Biases need estimation so they can be corrected. Frequent anomalies from the same sensor are symptoms of malfunction.", "All this is interesting, right? Useful as well. Spatial interpolation also applies to temperature, wind speed, amount of rainfall, humidity, to name a few.", "We have sensors located at n points (x1,y1), \u2026, (xn, yn). We will refer to anyone such a point as ij. The sensor at the location ij emits a reading Sij. We view this reading as a corrupted version of the unknown true value Tij at that location. We seek to estimate Txy at every point (x, y) in the region from these readings.", "Example: Say we have two sensors in the San Francisco bay area. One in San Francisco, the other in San Jose. We are interested in estimating air quality in between. (Of course, we only have two sensors, so our estimates may not be great.)", "Think of this as one-dimensional spatial interpolation. Estimate air qualities on the line connecting San Francisco to San Jose.", "Kernels: Let\u2019s now discuss kernels. To each location ij fitted with a sensor, we attach a kernel Kij. Kij weighs the influence of the reading Sij to locations near ij. The influence decays with distance. Formally, we express this weight as K(d(xy, ij)). Here d(xy, ij) denotes the distance between xy and ij. K(d) decreases with d, with K(0) being 1. A natural choice for K(d) is e^-ad, where a is a parameter that controls the rate of decay of the influence with distance.", "Example: In our SF-SJ example, say we set the Kernel K(d) to be 1/(a*d+1) where d is in units of miles. Consider a = 1. The influence of the reading in SF would be \u00bd =50% one mile away from SF, and \u00bc =25% two miles away from SF.", "Why this kernel function, and why a=1 over some other choice? As we\u2019ll see soon, the interpolation is not particularly sensitive to the decisions we make here.", "Consider any point xy. Consider the AQIs { Sij } measured at sensors located near xy. The weighted average of these measurements is a good estimate of the AQI at xy. Sensors closer to xy influence the estimate more.", "Here S^xy denotes the intensity estimate obtained at xy this way.", "Example: Consider our SF-SJ example, with the Kernel function we chose earlier. Say SF and SJ are 50 miles apart. Consider a point midway between the two, which we will call San Mateo (SM). We want to estimate the AQI at SM from SF and SJ readings, which we will take to be 160 and 180 AQI, respectively. (AQI is short for \u201cair quality index.\u201d)", "This example also reveals that the interpolation is not as sensitive to the Kernel function's choice and its parameters as we might have imagined. What\u2019s important are the probabilities pij derived from the Kernel function\u2019s values, not the values themselves. We are good so long as the Kernel function helps us estimate the relative influences the readings from the various nearby sensors should have towards the interpolation.", "Say we have some knowledge about the various sensors. We might know a sensor\u2019s price or brand. From this information, we might be able to estimate its error rate. Even better, perhaps the error rate has already been estimated from tests. Companies selling premium sensors are inclined to do so, to highlight their value propositions.", "Below is a simple heuristic extension of pij to leverage this knowledge.", "Here wij is a positive weight that captures the quality of the sensor at location ij. Higher value equates to higher quality.", "With this addition, a low-quality sensor influences S^xy less than a high-quality one. That said, the cumulative influence of multiple low-quality sensors in nearby locations giving similar readings is as if there were a single higher-quality sensor with a similar reading. This is as desired.", "Example: Say we set wSF = 2 and wSJ = 1. We trust the sensor at San Francisco twice as much as the one at San Jose. This modifies the probabilities to pSF(SM) = \u2154, pSJ(SM) = \u2153. Consequently, our AQI estimate at SM is about 166, closer to the reading in SF.", "Sensors may sometimes give anomalous readings. By definition, such readings can be \u201coff the chart.\u201d Left unchecked, they can significantly skew interpolations in their proximity. Clearly, we should detect anomalous readings and discount them.", "To do this, we\u2019ll add a new term to pij:", "Here aij is an anomaly discount weight. Its value is close to 1 if the sensor\u2019s reading is deemed normal and close to 0 if its deemed anomalous.", "How can we estimate aij? The basic idea is simple. If most neighboring sensors have similar readings and differ very much from ij\u2019s, ij\u2019s is probably anomalous.", "In more detail, obtain S^ij at that sensor based on the readings at neighboring sensors using the formula described earlier. Be sure to exclude ij itself from contributing to this formula. Compare S^ij with Sij. If the two are far apart, the reading at ij is likely anomalous.", "This can be enhanced further to take into account the variability in the readings at the neighboring sensors. The more similar the neighboring sensors' readings are, the higher the confidence that the sensor (whose reading differs significantly) is anomalous.", "Interestingly, the modeling here is similar to the modeling described in [3], specifically denoising images. The two-sheet architecture described there is interesting to look into in this connection.", "Example: Let\u2019s add a new sensor to our SF-SJ example, at SM, midway between the two. Also, let\u2019s revert to trusting the SF and SJ sensors equally.", "Say the SM's sensor reading is 5 AQI, whereas the SF and SJ readings were 180 and 160 AQI. The AQI estimate at SM from the SF and SJ readings is 170. 170 is very different from 5. This calls into question the SM reading.", "Given this, when estimating the AQI somewhere between SF and SJ (say in Palo Alto) from the three sensors, we might want to discard the SM sensor\u2019s reading.", "A sensor may have been reporting similar readings over a time period, then suddenly reports a very different reading. Something happened. If nearby sensors did not report an abrupt change simultaneously, whatever happened is likely local to this sensor.", "Using such temporal information and the spatial information, we can often increase the confidence in our inference that the reading is anomalous.", "Example: Consider our trio of sensors at SF, SM, and SJ. Say we measured their readings every hour over the past 5 hours and got the following:", "Clearly, by looking at the three sensors' readings over the entire duration (not just at hour=5), we can say with higher confidence that the reading in bold is anomalous.", "Using such temporal information can also help assess whether a sensor seems biased. Consider a variant of the above example.", "Either the SM sensor is biased, or there really is something else going on in SM to account for the consistently lower reading in SM than those in SF and SJ. Either way, this is good to know.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD, Computer Science, neural nets. 14+ years in industry: data science algos developer. 24+ patents issued. 50 academic pubs. Blogs on ML/data science topics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcf3616487714&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3616487714--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3616487714--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jagota-arun.medium.com/?source=post_page-----cf3616487714--------------------------------", "anchor_text": ""}, {"url": "https://jagota-arun.medium.com/?source=post_page-----cf3616487714--------------------------------", "anchor_text": "Arun Jagota"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fef9ed921edad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&user=Arun+Jagota&userId=ef9ed921edad&source=post_page-ef9ed921edad----cf3616487714---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3616487714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3616487714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@martinsanchez?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Martin Sanchez"}, {"url": "https://unsplash.com/s/photos/heat-map?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://support.iqair.com/en/articles/3405643-how-accurate-is-airvisual-s-air-quality-data", "anchor_text": "How accurate is AirVisual\u2019s air quality data? | AirVisual Support Center"}, {"url": "http://fatra.cnr.ncsu.edu/~hmitaso/gmslab/papers/mitas_mitasova_1999_2005.pdf", "anchor_text": "Spatial interpolation"}, {"url": "https://towardsdatascience.com/markov-random-fields-and-image-processing-20fb4cf7e10d", "anchor_text": "Markov Random Fields And Image Processing | by Arun Jagota | Aug 2020"}, {"url": "https://medium.com/tag/nearest-neighbors?source=post_page-----cf3616487714---------------nearest_neighbors-----------------", "anchor_text": "Nearest Neighbors"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----cf3616487714---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/measurement-error?source=post_page-----cf3616487714---------------measurement_error-----------------", "anchor_text": "Measurement Error"}, {"url": "https://medium.com/tag/measurement-bias?source=post_page-----cf3616487714---------------measurement_bias-----------------", "anchor_text": "Measurement Bias"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf3616487714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&user=Arun+Jagota&userId=ef9ed921edad&source=-----cf3616487714---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf3616487714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&user=Arun+Jagota&userId=ef9ed921edad&source=-----cf3616487714---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3616487714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3616487714--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcf3616487714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cf3616487714---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3616487714--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cf3616487714--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cf3616487714--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cf3616487714--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cf3616487714--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cf3616487714--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cf3616487714--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cf3616487714--------------------------------", "anchor_text": ""}, {"url": "https://jagota-arun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jagota-arun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arun Jagota"}, {"url": "https://jagota-arun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "685 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fef9ed921edad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&user=Arun+Jagota&userId=ef9ed921edad&source=post_page-ef9ed921edad--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1638f1de39a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspatial-interpolation-with-kernels-cf3616487714&newsletterV3=ef9ed921edad&newsletterV3Id=1638f1de39a6&user=Arun+Jagota&userId=ef9ed921edad&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}