{"url": "https://towardsdatascience.com/cnn-classification-a-cat-or-a-dog-568e6a135602", "time": 1683005464.611715, "path": "towardsdatascience.com/cnn-classification-a-cat-or-a-dog-568e6a135602/", "webpage": {"metadata": {"title": "CNN Image Classification | Towards Data Science", "h1": "CNN Image Classification: Cat or Dog", "description": "Technical Walk-through on Convolution Neural Network Creation using Keras for Binary Image Classification"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/dogs-vs-cats/overview", "anchor_text": "link", "paragraph_index": 2}, {"url": "https://keras.io/preprocessing/image/", "anchor_text": "Keras Official website", "paragraph_index": 22}, {"url": "https://github.com/luke4u/CNN-Image-Classification", "anchor_text": "Github", "paragraph_index": 33}], "all_paragraphs": ["In this article, I will walk through how to create an image classification model based on Convolution Neural Network (CNN) step by step. It is split into 7 parts.", "We are given a set of dog and cat images. The task is to build a model to predict the category of an animal: dog or cat?", "The data we collected is a subset of the Kaggle dog/cat dataset (link). In total, there are 10, 000 images, 80% for the training set, and 20% for the test set. In the training set, 4,000 images of dogs, while the test set has 1,000 images of dogs, and the rest are cats.", "All images are saved in a special folder structure, making it easy for Keras to understand and differentiate the animal category of each image, as shown in Figure 1.", "No need to encode the variables, as the independent variables are pixel values.", "In general, 4 steps are required to build a CNN: Convolution, Max pooling, Flattening, and Full connection. let\u2019s go through each in details.", "Conceptually, convolution is to apply feature detectors on the input image. To simplify the concept, take a smiling face as an input image, which is represented as an array of 0 and 1 in Figure 2.", "The feature detector is also an array of numbers. For each feature detector, we slide it over the image and produce a new array of numbers, representing a feature of the image. So, the operation between an input image and a feature detector that results in a feature map is Convolution as shown below Fig.3.", "If repeating the above convolution with different feature detectors, we produce as many feature maps as feature detectors, obtaining a convolution layer.", "Specifically, we use Conv2D() function from Keras to build the first convolution layer.", "Note, the number of feature detectors is set to be 32, and its dimension is (3, 3). In most CNN architectures, a common practice is to start with 32 feature detectors and increase to 64 or 128 if needed.", "input_shape is the shape of input images on which we apply feature detectors through convolution. The problem is that images may have different formats and image size. So, we need to convert images into the same format and fixed size. We will process the image later, and now let\u2019s set it to be (64, 64, 3). Here, 3 is the number of channels for a colored image, (64, 64) is the image dimension for each channel, which is enough for good accuracy. Feel free to try (128, 128) if you are working on a decent GPU.", "The final argument is the activation function. we use ReLU to remove any negative pixel values in feature maps. This is because depending on the parameters used in convolution, we may obtain negative pixels in feature maps. Removing negative pixels adds non-linearity for a non-linear classification problem.", "Max pooling is to reduce the size of a feature map by sliding a table, for example (2,2), and taking the maximum value in the table. If we slide a table with a stride of 2 over 1 feature map of (5,5), we get a feature map with reduced size of (3,3) as shown in Figure 5.", "Repeating max pooling on each feature map produces a pooling layer. Fundamentally, max pooling is to reduce the number of nodes in the fully connected layers without losing key features and spatial structure information in the images. Specifically, we use MaxPooling2D() function to add the pooling layer. In general, we use a 2x2 filter for pooling.", "Flattening is to take all pooled feature maps into a single vector as the input for the fully connected layers as shown in Figure 7.", "Now the question: why not directly flatten the input image into a single vector \ud83e\udd14? The answer is that doing that will only keep the pixel values of the image, but not the spatial structure. In another word, it will lose how each pixel is spatially connected to one around it. But with convolution, we get many feature maps, each of which represents a specific feature of the image. Thus, each node in the flattened vector will represent a specific detail of the input image.", "With the above, we converted an image into a one-dimensional vector. Now we will build a classifier using this vector as the input layer. First, create a hidden layer. output_dim is the number of nodes in the hidden layer. As a common practice, we choose 128 to start with and use ReLU as the activation function.", "Then add an output layer. For binary classification, output_dim is 1, and the activation function is Sigmoid.", "Our final model structure is shown below \ud83c\udf89\ud83c\udf89.", "With all layers added, let\u2019s compile the CNN by choosing an SGD algorithm, a loss function, and performance metrics. We use binary_crossentropy for binary classification, and use categorical_crossentropy for multiple classification problem.", "Here we have 8000 images for the training set, which is not enough to avoid over-fitting. So, we perform image augmentation, such as rotating, flipping, or shearing to increase the number of images. It splits training images into batches, and each batch will be applied random image transformation on a random selection of images, to create many more diverse images.", "Specifically, we will use flow_from_directory(directory) method from Keras Official website to load images and apply augmentation. This is why we structured the data folders in a specific way so that the class of each image can be identified from its folder name. The below code snippet allows us to augment images and fit and test CNN.", "Above, the target size is set to be (64, 64), the same shape as when we create the Convolution layer. Now, let\u2019s fit and test the model.", "In the end, we obtained a training accuracy of 86% and a test accuracy of 76% with a minor over-fitting \u2728\u2728.", "Obviously, there is room to improve accuracy and reduce over-fitting. Two options are either adding more convolution layers or adding more dense layers. Let\u2019s add one more convolution layer.", "With the above, run the model on training and test sets again. In the end, we obtained an improved test accuracy of 91% and a test accuracy of 82% \ud83e\udde8\ud83e\udde8!", "First, we create a folder \u2018single_prediction\u2019 for the images to be predicted as shown in Figure 9.", "Second, we use the image module from Keras to load test images. Note, set the target_size of the image to be (64, 64).", "Remember CNN requires an input image with 3 dimensions. So we need to add a dimension for the channel, from 2D array to 3D array.", "However, this is not enough, because CNN expects another dimension for the batch. Axis is to specify the position of the dimension we are adding. So batch dimension is added at index 0.", "We got a result of 1. To know the mapping between animals and their associated numerical values, we use:", "With that, we know 0 is cat, and 1 is a dog. Great. our CNN made a correct prediction!", "Great! If you found this post helpful, feel free to hit those \ud83d\udc4f \u2018s! If you need the source code, visit my Github page \ud83e\udd1e\ud83e\udd1e.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Enthusiast, Data Scientist, Python Developer. Love to share articles about technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F568e6a135602&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----568e6a135602--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----568e6a135602--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lukesun.medium.com/?source=post_page-----568e6a135602--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=post_page-----568e6a135602--------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508----568e6a135602---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F568e6a135602&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F568e6a135602&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/pets-cute-cat-dog-3715734/", "anchor_text": "link"}, {"url": "https://www.kaggle.com/c/dogs-vs-cats/overview", "anchor_text": "link"}, {"url": "https://keras.io/preprocessing/image/", "anchor_text": "Keras Official website"}, {"url": "https://github.com/luke4u/CNN-Image-Classification", "anchor_text": "Github"}, {"url": "https://medium.com/tag/cnn?source=post_page-----568e6a135602---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----568e6a135602---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/python?source=post_page-----568e6a135602---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/keras?source=post_page-----568e6a135602---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----568e6a135602---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F568e6a135602&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&user=Luke+Sun&userId=7b5b79d21508&source=-----568e6a135602---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F568e6a135602&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&user=Luke+Sun&userId=7b5b79d21508&source=-----568e6a135602---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F568e6a135602&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----568e6a135602--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F568e6a135602&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----568e6a135602---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----568e6a135602--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----568e6a135602--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----568e6a135602--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----568e6a135602--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----568e6a135602--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----568e6a135602--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----568e6a135602--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----568e6a135602--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://lukesun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F38f46069f6d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-classification-a-cat-or-a-dog-568e6a135602&newsletterV3=7b5b79d21508&newsletterV3Id=38f46069f6d3&user=Luke+Sun&userId=7b5b79d21508&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}