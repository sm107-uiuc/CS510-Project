{"url": "https://towardsdatascience.com/decoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc", "time": 1683010607.493867, "path": "towardsdatascience.com/decoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc/", "webpage": {"metadata": {"title": "Decoding Strategies that You Need to Know for Response Generation | by Vitou Phy | Towards Data Science", "h1": "Decoding Strategies that You Need to Know for Response Generation", "description": "Deep learning has been deployed in many tasks in NLP, such as translation, image captioning, and dialogue systems. In machine translation, it is used to read source language (input) and generate the\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Deep learning has been deployed in many tasks in NLP, such as translation, image captioning, and dialogue systems. In machine translation, it is used to read source language (input) and generate the desired language (output). Similarly in a dialogue system, it is used to generate a response given a context. This is also known as Natural Language Generation (NLG).", "The model splits into 2 parts: encoder and decoder. Encoder reads the input text and returns a vector representing that input. Then, the decoder takes that vector and generates a corresponding text.", "To generate a text, commonly it is done by generating one token at a time. Without proper techniques, the generated response may be very generic and boring. In this article, we will explore the following strategies:", "At each timestep during decoding, we take the vector (that holds the information from one step to another) and apply it with softmax function to convert it into an array of probability for each word.", "This approach is the simplest. At each time-step, it just chooses whichever token that is the most probable.", "However, this approach may generate a suboptimal response, as shown in the example above. The generated response may not be the best possible response. This is due to the training data that commonly have examples like \u201cThat is [\u2026]\u201d. Therefore, if we generate the most probable token at a time, it might output \u201cis\u201d instead of \u201ccake\u201d.", "Exhaustive search can solve the previous problem since it will search for the whole space. However, it would be computationally expensive. Suppose there are 10,000 vocabularies, to generate a sentence with the length of 10 tokens, it would be (10,000)\u00b9\u2070.", "Beam search can cope with this problem. At each timestep, it generates all possible tokens in the vocabulary list; then, it will choose top B candidates that have the most probability. Those B candidates will move to the next time step, and the process repeats. In the end, there will only be B candidates. The search space is only (10,000)*B.", "But sometimes, it chooses an even more optimal (Response B). In this case, it makes perfect sense. But imagine that the model likes to play safe and keeps on generating \u201cI don\u2019t know\u201d or \u201cThank you\u201d to most of the context, that is a pretty bad bot.", "Alternatively, we can look into stochastic approaches to avoid the response being generic. We can utilize the probability of each token from the softmax function to generate the next token.", "Suppose we are generating the first token of a context \u201cI love watching movies\u201d, Figure below shows the probability of what the first word should be.", "If we use a greedy approach, a token \u201ci\u201d will be chosen. With random sampling, however, token i has a probability of around 0.2 to occur. At the same time, any token that has a probability of 0.0001 can also occur. It\u2019s just very unlikely.", "Random sampling, by itself, could potentially generate a very random word by chance. Temperature is used to increase the probability of probable tokens while reducing the one that is not. Usually, the range is 0 < temp \u2264 1. Note that when temp=1, there is no effect.", "In Figure 4, with temp=0.5, the most probable words like i, yeah, me, have more chance of being generated. At the same time, this also lowers the probability of the less probable ones, although this does not stop them from occurring.", "Top-K sampling is used to ensure that the less probable words should not have any chance at all. Only top K probable tokens should be considered for a generation.", "The token index between 50 to 80 has some small probabilities if we use random sampling with temperature=0.5 or 1.0. With top-k sampling (K=10), those tokens have no chance of being generated. Note that we can also combine Top-K sampling with temperature, but you kinda get the idea already, so we choose not to discuss it here.", "This sampling technique has been adopted in many recent generation tasks. Its performance is quite good. One limitation with this approach is the number of top K words need to be defined in the beginning. Suppose we choose K=300; however, at a decoding timestep, the model is sure that there should be 10 highly probable words. If we use Top-K, that means we will also consider the other 290 less probable words.", "Nucleus sampling is similar to Top-K sampling. Instead of focusing on Top-K words, nucleus sampling focuses on the smallest possible sets of Top-V words such that the sum of their probability is \u2265 p. Then, the tokens that are not in V^(p) are set to 0; the rest are re-scaled to ensure that they sum to 1.", "The intuition is that when the model is very certain on some tokens, the set of potential candidate tokens is small otherwise, there will be more potential candidate tokens.", "Certain \u2192 those few tokens have high probability = sum of few tokens is enough to exceed p.Uncertain \u2192 Many tokens have small probability = sum of many tokens is needed to exceed p.", "Comparing nucleus sampling (p=0.5) with top-K sampling (K = 10), we can see the nucleus does not consider token \u201cyou\u201d to be a candidate. This shows that it can adapt to different cases and select different numbers of tokens, unlike Top-K sampling.", "Commonly, top choices by researchers are beam search, top-K sampling (with temperature), and nucleus sampling.", "We have gone through a list of different ways to decode a response. These techniques can be applied to different generation tasks, i.e., image captioning, translation, and story generation. Using a good model with bad decoding strategies or a bad model with good decoding strategies is not enough. A good balance between the two can make the generation a lot more interesting.", "Holtzman, A., Buys, J., Du, L., Forbes, M., & Choi, Y. (2020). The Curious Case of Neural Text Degeneration. In International Conference on Learning Representations.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fba95ee0faadc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@phyvitou?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@phyvitou?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": "Vitou Phy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F81157f79faae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&user=Vitou+Phy&userId=81157f79faae&source=post_page-81157f79faae----ba95ee0faadc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba95ee0faadc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba95ee0faadc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://d2l.ai/chapter_recurrent-modern/beam-search.html", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/word-sequence-decoding-in-seq2seq-architectures-d102000344ad", "anchor_text": "Word Sequence Decoding in Seq2Seq ArchitecturesNatural Language Generation (NLG) is a task of generating text. Natural Language Generation tasks like machine\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/an-intuitive-explanation-of-beam-search-9b1d744e7a0f", "anchor_text": "An intuitive explanation of Beam searchSimple to understand explanation of Beam searchtowardsdatascience.com"}, {"url": "https://medium.com/tag/nlp?source=post_page-----ba95ee0faadc---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/dialogue?source=post_page-----ba95ee0faadc---------------dialogue-----------------", "anchor_text": "Dialogue"}, {"url": "https://medium.com/tag/generation?source=post_page-----ba95ee0faadc---------------generation-----------------", "anchor_text": "Generation"}, {"url": "https://medium.com/tag/nlg?source=post_page-----ba95ee0faadc---------------nlg-----------------", "anchor_text": "Nlg"}, {"url": "https://medium.com/tag/decoding?source=post_page-----ba95ee0faadc---------------decoding-----------------", "anchor_text": "Decoding"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fba95ee0faadc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&user=Vitou+Phy&userId=81157f79faae&source=-----ba95ee0faadc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fba95ee0faadc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&user=Vitou+Phy&userId=81157f79faae&source=-----ba95ee0faadc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba95ee0faadc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fba95ee0faadc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ba95ee0faadc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ba95ee0faadc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@phyvitou?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@phyvitou?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vitou Phy"}, {"url": "https://medium.com/@phyvitou/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "82 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F81157f79faae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&user=Vitou+Phy&userId=81157f79faae&source=post_page-81157f79faae--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7c7adf70813c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecoding-strategies-that-you-need-to-know-for-response-generation-ba95ee0faadc&newsletterV3=81157f79faae&newsletterV3Id=7c7adf70813c&user=Vitou+Phy&userId=81157f79faae&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}