{"url": "https://towardsdatascience.com/multiple-ways-to-create-kubernetes-secrets-33f97feaa499", "time": 1683018125.85792, "path": "towardsdatascience.com/multiple-ways-to-create-kubernetes-secrets-33f97feaa499/", "webpage": {"metadata": {"title": "Multiple Ways to Create Kubernetes Secrets | by Tibor Fabian | Towards Data Science", "h1": "Multiple Ways to Create Kubernetes Secrets", "description": "This article describes how to create Kubernetes (K8s) secrets as part of an installation guide to the Machine Learning Operations (MLOps) pipeline detailed in my post \u201cMLOps on Kubernetes with Docker\u2026"}, "outgoing_paragraph_urls": [{"url": "https://tibor-fabian.medium.com/mlops-on-kubernetes-with-docker-desktop-db38c1b70adb", "anchor_text": "MLOps on Kubernetes with Docker Desktop", "paragraph_index": 0}, {"url": "https://docs.gitlab.com/ee/user/project/deploy_tokens/", "anchor_text": "deploy token", "paragraph_index": 8}, {"url": "https://de.linkedin.com/in/fabiantibor", "anchor_text": "https://de.linkedin.com/in/fabiantibor", "paragraph_index": 22}], "all_paragraphs": ["This article describes how to create Kubernetes (K8s) secrets as part of an installation guide to the Machine Learning Operations (MLOps) pipeline detailed in my post \u201cMLOps on Kubernetes with Docker Desktop\u201d.", "The installation in the above-mentioned article uses the following secrets on the K8s pod:", "In the following, I detail how to create each of them.", "1. github-repo-cred holds GitHub credentials and is used to clone a repository from inside the container.", "Before the secret actually can be created, base64-coded valid GitHub credentials need to be inserted into the data section for the keys GH_REPO_USER and GH_REPO_TOKEN.", "And this is how to generate the base64 code for the user tibfab (that\u2019s me) in the terminal on the Mac.", "The secret itself is then created with kubectl apply.", "2. gitlab-registry-cred stores GitLab credentials needed for read/write access to GitLab CR to commit and push a running Docker container\u2019s status whenever necessary.", "The secret is created similarly to github-repo-cred above, but this time with appropriate GitLab credentials. I used a so-called GitLab deploy token to restrict access to a specific project.", "3. gitlab-pull-cred is used by K8s to pull images from GitLab CR upon pod creation.", "The easiest way to create the image pull secret is from a Docker login. So if not logged in already, then login to GitLab CR first.", "And create the pull secret with kubectl as follows.", "After the pull secret was created, it needs to be referenced by K8s upon pod startup to pull the image from GitLab CR. This can be achieved in two ways.", "4. kubectl-config is a file mount used to manage K8s from inside the DSS container running on the pod and created as follows:", "If all secrets above were created successfully, the list given by kubectl looks like the following:", "There are different ways to make credentials available from secrets in the container.", "The easiest: Environments defined from a secret in the pod configuration make credentials as environment variables visible in the container. Check out the code snippet below. It sets GL_REG_USER and GL_REG_TOKEN from the secret gitlab-registry-cred.", "Another possibility is to volume mount a secret as a file whose name becomes the name of the configuration variable, and it\u2019s content the value of the variable. This has the advantage of being able to apply permission control directly to the pod configuration with the keyword defaultMode. The following code snippet demonstrates that.", "An example usage of the credentials is given in a pod configuration below as part of the start command of the container.", "Where the command $(cat /github-repo/credentials/GH_REPO_USER) in line 9 returns the content of the secret key GH_REPO_USER and $(cat /github-repo/credentials/GH_REPO_TOKEN) returns the content GH_REPO_TOKEN respectively.", "There are multiple ways to create and employ K8s secrets. This post shows how various types of secrets are applied creatively in different parts of an entire MLOps pipeline.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Data Scientist @ Telef\u00f3nica; Visit my LinkedIn profile: https://de.linkedin.com/in/fabiantibor"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F33f97feaa499&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----33f97feaa499--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----33f97feaa499--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tibor-fabian.medium.com/?source=post_page-----33f97feaa499--------------------------------", "anchor_text": ""}, {"url": "https://tibor-fabian.medium.com/?source=post_page-----33f97feaa499--------------------------------", "anchor_text": "Tibor Fabian"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41751d3c5caf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&user=Tibor+Fabian&userId=41751d3c5caf&source=post_page-41751d3c5caf----33f97feaa499---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F33f97feaa499&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F33f97feaa499&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://tibor-fabian.medium.com/mlops-on-kubernetes-with-docker-desktop-db38c1b70adb", "anchor_text": "MLOps on Kubernetes with Docker Desktop"}, {"url": "https://unsplash.com/@tinaflour?utm_source=medium&utm_medium=referral", "anchor_text": "Kristina Flour"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://docs.gitlab.com/ee/user/project/deploy_tokens/", "anchor_text": "deploy token"}, {"url": "https://gitlab.com/tibor_fabian/dku-dss-k8s", "anchor_text": "https://gitlab.com/<user>/<project>"}, {"url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#add-image-pull-secret-to-service-account", "anchor_text": "here"}, {"url": "https://medium.com/tag/mlops?source=post_page-----33f97feaa499---------------mlops-----------------", "anchor_text": "Mlops"}, {"url": "https://medium.com/tag/kubernetes?source=post_page-----33f97feaa499---------------kubernetes-----------------", "anchor_text": "Kubernetes"}, {"url": "https://medium.com/tag/docker?source=post_page-----33f97feaa499---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/tag/secret?source=post_page-----33f97feaa499---------------secret-----------------", "anchor_text": "Secret"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----33f97feaa499---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F33f97feaa499&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&user=Tibor+Fabian&userId=41751d3c5caf&source=-----33f97feaa499---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F33f97feaa499&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&user=Tibor+Fabian&userId=41751d3c5caf&source=-----33f97feaa499---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F33f97feaa499&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----33f97feaa499--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F33f97feaa499&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----33f97feaa499---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----33f97feaa499--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----33f97feaa499--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----33f97feaa499--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----33f97feaa499--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----33f97feaa499--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----33f97feaa499--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----33f97feaa499--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----33f97feaa499--------------------------------", "anchor_text": ""}, {"url": "https://tibor-fabian.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tibor-fabian.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tibor Fabian"}, {"url": "https://tibor-fabian.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "26 Followers"}, {"url": "https://de.linkedin.com/in/fabiantibor", "anchor_text": "https://de.linkedin.com/in/fabiantibor"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41751d3c5caf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&user=Tibor+Fabian&userId=41751d3c5caf&source=post_page-41751d3c5caf--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F819017a298e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-ways-to-create-kubernetes-secrets-33f97feaa499&newsletterV3=41751d3c5caf&newsletterV3Id=819017a298e1&user=Tibor+Fabian&userId=41751d3c5caf&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}