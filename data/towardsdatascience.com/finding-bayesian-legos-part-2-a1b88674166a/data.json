{"url": "https://towardsdatascience.com/finding-bayesian-legos-part-2-a1b88674166a", "time": 1682996306.405708, "path": "towardsdatascience.com/finding-bayesian-legos-part-2-a1b88674166a/", "webpage": {"metadata": {"title": "Finding Bayesian Legos \u2014 Part 2. Saving feet one model at a time | by Hank Roark | Towards Data Science", "h1": "Finding Bayesian Legos \u2014 Part 2", "description": "Using a Bayesian approach and PyMC3 to estimate population size based on removal sampling"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/https-medium-com-hankroark-finding-bayesian-legos-part1-b8aeb886afba", "anchor_text": "Last time on Finding Bayesian Legos", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Beta_distribution", "anchor_text": "Beta distribution", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Multinomial_distribution", "anchor_text": "Multinomial distributions", "paragraph_index": 24}, {"url": "https://docs.pymc.io/api/distributions/multivariate.html#pymc3.distributions.multivariate.Multinomial", "anchor_text": "PyMC3 has a multinomial distribution", "paragraph_index": 27}, {"url": "https://projecteuclid.org/download/pdf_1/euclid.aoms/1177692709", "anchor_text": "by Sanathanan", "paragraph_index": 27}, {"url": "https://github.com/hankroark/finding-bayesian-legos/blob/master/2-RemovalPassesApproach.ipynb", "anchor_text": "is available.", "paragraph_index": 35}], "all_paragraphs": ["Last time on Finding Bayesian Legos, my dear friend Joe and I were trying to find a way to help Joe gain confidence that he has indeed picked-up all of the Legos\u00ae his children left behind. My first proposal was that we determine how good Joe is at picking up Legos by performing experiments on Joe to determine the probability he would pick a single Lego in any given sweep of the room where the Legos have been left laying. Joe said, \u201cNo go on this plan! I really dislike picking up Legos. Can\u2019t you find a better way?\u201d", "\u201cTell me more about how you go about picking up after your kids.\u201d", "Joe explains to me that he usually picks up the Legos after his children are tucked away in bed. Joe likes to unwind with a little reading or television each night. In between chapters of the book, or during television commercials, he will make a quick sweep picking up the Legos. The first sweep seems to get most of the Legos, with each pass picking up part of what was missed from the prior sweep. He keeps doing this until he calls it a night and heads of to bed.", "\u201cJoe, I think we can work with this.\u201d", "I ask Joe to do a minor bit of work next time he picks up Legos. I ask him to count how many he picks up in each pass and record it. He reluctantly agrees, but anything to help him gain confidence that he will not step on Legos when he gets up the next morning and heads to the coffee maker.", "A few days later I get an email from Joe: he has done as asked. Joe reports that he made six sweeps with the following number of Legos being picked up in each sweep:", "I invite Joe over for dinner and some Bayesian analysis that evening.", "After finishing up our dinner of kale, avocado, and black bean burrito bowls, Joe and I cozy around the big screen for the analysis.", "I explain to Joe that each time he makes a sweep of the room, it\u2019s like every Lego has some probability of being picked up. We don\u2019t know how many Legos there really are and that is what we are trying to determine, with probabilities. Joe can then compare this to the total number he has picked up to see if he wants to make another pass. Because I\u2019ve had a few days to work this out, I sketch up the model and then go back and explain it:", "In this case, p indicates that probability that Joe will pick up a single Lego. The probability p is modeled as a Beta distribution (in part 1 we covered why we used a Beta distribution). The number of Legos remaining is N_i, after i sweeps by Joe to pick up Legos; Joe makes a total of n sweeps. For each sweep i Joe removed Ri Legos. What we are trying to determine is N\u2080, the number of Legos originally left behind by Joe\u2019s offspring. R\u2080 being set to zero handles the boundary condition where Joe picks up zero Legos on the zeroth sweep.", "To complete the model, we need some prior distributions for N\u2080, \u03b1, \u03b2. As in the first episode, we pick parameters such that the distributions prior to modeling are weakly informative:", "The parameters for the prior probability distribution is the same as in the first episode. I ask Joe for the absolute maximum Legos he things his kid might leave behind. Joe estimates around two-thousand, so I make the maximum, N_max three-thousand to be on the safe side, and use a uniform distribution of prior probabilities between 0 and N_max inclusive to model the initial number of Legos left behind.", "Now all that remains is to make the model in PyMC and review the results to see if they might help Joe.", "The transfer from the model into PyMC code is a really direct translation and fitting with the default No-U-Turn sampler. After some fidgeting around, the number of tuning samples was increased over the default and the target acceptance rate is set a bit higher than normal; this is done to deal with some of the problematic posteriors in this problem. Nicely, the PyMC library does a good job helping users tune these parameters by doing model fitting checks and highlighting likely problematic issues.", "I want Joe to have an approximation of how many Legos are remaining after each time he does a sweep. This will help Joe make a better decision of when he wants to stop because I know just how very much Joe wants to decrease the amount of energy he puts into Lego gathering. With that, we will start with the minimal information, just the number removed in the first sweep. Also, a deterministic calculation of the estimated number of remaining Legos is included, mostly to make it easy for Joe to decide how many Legos might be remaining. Even though n_remaining_est is deterministic, it is a random variable because the two input variables to n_remaining_est are random variables.", "After completing the model fitting, Joe and I take a quick look at the trace plots. We are focused on the initial number of Legos and the estimated number remaining after the first sweep.", "Unfortunately, after just one sweep there is not much narrowing down of the number of remaining Legos compared to before the sweep. This makes sense from mathematical intuition: there are two parameters to estimate, the probability of picking up a Lego and the initial number of Legos, but only one known variable, the number of Legos picked up in the first pass. It is, at best, difficult to solve for two unknown variables with only one known equation.", "At this point, Joe\u2019s not sure if the work has been worth the effort. I encourage Joe that we should continue, for his feet if nothing else. We soldier on and create a model based on the first and second observed sweep data Joe provided. The model creation code is starting to look a little repetitive, but for the sake of quick experimentation, I do some \u2018copy-paste\u2019 of code and run the model, thinking if it works I will refactor it later.", "In this model, we take the estimated number of Legos remaining after sweep one subtracted from the estimated initial number of Legos, and use that as the input for the number of Legos remaining for the second sweep. We are modeling repeated, sequential binomial trials.", "\u201cJoe, we are getting somewhere now.\u201d", "A quick look at the model results and we see that the range of estimated Lego\u2019s remaining has been narrowed to between 9 and 62 with 95% confidence. At this point, Joe is getting encouraged that counting all of those Legos might have been worth it. He wants to keep going, but I have some other plans.", "It\u2019s getting a bit late, and I decide it is time to refactor this code. Joe heads home for the night and we promise to get together tomorrow. With a bit cleaner code I hope to be able to move much faster.", "Joe comes by the following evening with takeaway in hand. I grab my laptop and share with Joe what has transpired overnight.", "\u201cThis is really a multinomial problem.\u201d", "Multinomial distributions model the count that some event out of k possible events happens some number of times n. It is a generalization of the binomial distribution. Think of throwing a 6-sided die repeatedly (6 possible events, 1 through 6, one for each side of the die) and counting how many times it lands with each side up. The multinomial model allows for each event to have different probabilities of happening. Continuing with the 6-side die analogy, that would like if the die somehow had different probabilities of each side landing upwards. That is the process the multinomial distribution models. Joe looks at me a little puzzled, so I go on.", "In our scenario, each Lego lands in one of the n sweeps or have yet to be picked up. Each sweep, plus the event of not being picked up, is like one side of the die. The probability of a Lego getting picked up in the first sweep is unknown and modeled as p. The probability of a Lego getting picked up in the second sweep is the probability of the Lego not being picked up in the first sweep and the probability of it getting picked up in the second sweep. The probability of a Lego remaining is just whatever probability remains after summing up all the probabilities of a Lego getting picked across all the sweeps.", "Here R is a vector of the count for each of the probabilities given (that is, it is the estimated number of Legos picked up in each sweep), N\u2080 is the number of trials (or in our case, the estimate of the number of Legos initially left laying), p_i is the probability of a Lego being picked up in sweep i, p_remains is the probability of a Lego not being picked up, and n_sweeps is the total number of sweeps performed.", "While PyMC3 has a multinomial distribution it does not have this kind of \u201cincomplete Multinomial distribution\u201d, where the size of the multinomial population is unknown and to be estimated. There have been several papers on this subject of estimating the multinomial population size from the observed draws; my favorite is by Sanathanan. I\u2019m committed to taking a Bayesian approach and using PyMC3. After a bit of experimenting, I determine the workable solution is to generalize the repeated binomial approach tried earlier. I wrote up a function which encapsulates the model of removal, calling the new model a RemovalMultinomial. While I'm sure there are better ways to do this, Joe and I are pretty ready to get this done.", "With this new function, the setup for the model is much shorter, parameterized just by the number of sweeps. We will do the model with 3 sweeps, one more than last time. This helps Joe and I know how much information we are getting sweep to sweep. Also, it might help Joe determine when he can stop \u2018early\u2019 in his passes based on his own model of risk of having a density of Legos remaining on the floor, poised to cause him pain if he were to step on them. Right now Joe keeps doing sweeps for Legos until he makes a pass and doesn\u2019t see any Legos to pick up.", "\u201cThis is looking pretty good!\u201d, says Joe", "Joe and I are getting pretty excited. With this last round, after three sweeps of picking up Legos, there is now a 95% confidence interval that there are between zero (!) and thirteen Legos remaining. Joe is pretty happy with these results and feels like it can help him determine if he wants to continue making passes or call it a night.", "In this last model, we want to test how good Joe\u2019s current heuristic is for stopping. Joe typically stops looking for Legos when he makes a pass and he finds no more Legos to pick up. Now that we have maths behind us we can quantify, at least in based on these results and the assumptions of the model, the quality of the stopping strategy employed by Joe. We create a model of all six passes Joes performed and use that to estimate the number of Legos remaining. The code is not shown here but is available in the notebook linked at the end of the article.", "At this point, Joe and I are pretty happy with the model results. It looks like, at least in this example, there is about a one-in-five (20%) chance that there is at least one Lego remaining. Joe says he can take this and use it if I\u2019ll clean it up and stick it in a mobile app. Joe is a very funny person! I agree to check this code into GitHub and show Joe how to use it.", "All is good, Joe goes home.", "And then a few days later the call comes, \u201cHank, I\u2019m still finding Legos the day after, and a lot more a lot more often than I think the model predicts.\u201d", "Full Jupyter notebook of this post is available.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Creating value from data using analytics and machine learning, father, husband, vegan, wannabe photog."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa1b88674166a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a1b88674166a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a1b88674166a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hankroark?source=post_page-----a1b88674166a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hankroark?source=post_page-----a1b88674166a--------------------------------", "anchor_text": "Hank Roark"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2d9d764a91b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&user=Hank+Roark&userId=e2d9d764a91b&source=post_page-e2d9d764a91b----a1b88674166a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1b88674166a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1b88674166a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/C0koz3G1I4I", "anchor_text": "Markus Spiske on Unsplash"}, {"url": "https://towardsdatascience.com/https-medium-com-hankroark-finding-bayesian-legos-part1-b8aeb886afba", "anchor_text": "Last time on Finding Bayesian Legos"}, {"url": "https://en.wikipedia.org/wiki/Beta_distribution", "anchor_text": "Beta distribution"}, {"url": "https://en.wikipedia.org/wiki/Multinomial_distribution", "anchor_text": "Multinomial distributions"}, {"url": "https://docs.pymc.io/api/distributions/multivariate.html#pymc3.distributions.multivariate.Multinomial", "anchor_text": "PyMC3 has a multinomial distribution"}, {"url": "https://projecteuclid.org/download/pdf_1/euclid.aoms/1177692709", "anchor_text": "by Sanathanan"}, {"url": "https://github.com/hankroark/finding-bayesian-legos/blob/master/2-RemovalPassesApproach.ipynb", "anchor_text": "is available."}, {"url": "https://medium.com/tag/data-science?source=post_page-----a1b88674166a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----a1b88674166a---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/python?source=post_page-----a1b88674166a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pymc3?source=post_page-----a1b88674166a---------------pymc3-----------------", "anchor_text": "Pymc3"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa1b88674166a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&user=Hank+Roark&userId=e2d9d764a91b&source=-----a1b88674166a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa1b88674166a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&user=Hank+Roark&userId=e2d9d764a91b&source=-----a1b88674166a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1b88674166a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a1b88674166a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa1b88674166a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a1b88674166a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a1b88674166a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a1b88674166a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a1b88674166a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a1b88674166a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a1b88674166a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a1b88674166a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a1b88674166a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a1b88674166a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hankroark?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hankroark?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hank Roark"}, {"url": "https://medium.com/@hankroark/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "146 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2d9d764a91b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&user=Hank+Roark&userId=e2d9d764a91b&source=post_page-e2d9d764a91b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F793d23b49604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-bayesian-legos-part-2-a1b88674166a&newsletterV3=e2d9d764a91b&newsletterV3Id=793d23b49604&user=Hank+Roark&userId=e2d9d764a91b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}