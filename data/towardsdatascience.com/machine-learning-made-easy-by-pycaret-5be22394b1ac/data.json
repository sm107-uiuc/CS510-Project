{"url": "https://towardsdatascience.com/machine-learning-made-easy-by-pycaret-5be22394b1ac", "time": 1683010845.443656, "path": "towardsdatascience.com/machine-learning-made-easy-by-pycaret-5be22394b1ac/", "webpage": {"metadata": {"title": "Machine Learning Made Easy by PyCaret | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Machine Learning Made Easy by PyCaret", "description": "PyCaret is a python open source low-code machine learning library created by Moez Ali and released in April 2020. It is literally a low-code library which allows to create an entire machine learning\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pycaret.org/", "anchor_text": "PyCaret", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/profile-moez/?originalSubdomain=ca", "anchor_text": "Moez Ali", "paragraph_index": 0}, {"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "Telco Customer Churn", "paragraph_index": 3}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 35}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 35}], "all_paragraphs": ["PyCaret is a python open source low-code machine learning library created by Moez Ali and released in April 2020. It is literally a low-code library which allows to create an entire machine learning pipeline with very few lines of code. PyCaret is essentially a wrapper built on common python machine learning libraries such as scikit-learn, XGBOOST and many more.", "What PyCaret achieves is a higly simple yet functional syntax. For instance, we can compare 18 classification models with 1 line of code. In this post, I will walk you through a classification task using PyCaret and explain the details of each step.", "If you use google colab as your IDE and plan to render interactive visualizations in the notebook, following code needs to be executed:", "The dataset we will use is \u201cTelco Customer Churn\u201d dataset which is available on kaggle. After importing numpy and pandas, we can read the dataset into a pandas dataframe:", "The dataset has 7043 observations (rows) and 21 columns. Here is the list of columns:", "\u201cCustomerID\u201d does not have any informative power since it is just a random rumber assigned to each customer. \u201cTotalCharges\u201d column is multiplication of \u201ctenure\u201d and \u201cMonthlyCharges\u201d columns so we don\u2019t need this column as well. We just drop these two columns:", "The task is predicting whether a customer churns (i.e. leaves the company) using the features provided. I will skip the EDA process because this post is focused on how PyCaret is used. Let\u2019s start with importing the classification module of PyCaret:", "PyCaret workflow always starts with setup function which prepares the environment for the entire machine learning pipeline. Thus, setup must be executed before any other function.", "One important point to mention is that setup function infers the datatypes and it prompts you to hit enter if inferred datatypes are correct. If there is a mistake on the inferred datatypes, you type \u201cquit\u201d. There are two options to determine the correct datatypes:", "The datatypes are correct in my case so I hit enter. The required parameters of setup function are:", "After setup function is executed, we get a long informative list about the environment and parameter settings.", "As you can see from the list, these parameters allow you to handle data preprocessing steps. It also splits the data into training and test sets.", "Once the setup is executed, we can use compare_models to briefly evaluate the performance of all the models in the model library of PyCaret. There are 18 classifiers available. Compare_models function train all models and evaluate their performance under 6 common classification metrics.", "With one line (actually two words) of code, we are able to compare 18 models under 6 different metrics.", "The best 15 are displayed. The sorting is based on \u201caccuracy\u201d metric but it can be changed using sort parameter. The scores are calculated with 10 fold stratified cross validation. Number of folds can be changed using fold parameter.", "We have just made a rough evaluation. The next step is to pick a few algorithms from this list for further improvements. What we pick depends on the task at hand. For the sake of simplicity, I will pick the best algorithm according to accuracy metric which is logistic regression.", "Please keep in mind that the optimum evaluation metric may change depending on the task and data. Accuracy may not be the optimum choice of metric for classification tasks especially when we have imbalanced dataset.", "The next step is to create a model with selected algorithm using create_model function. We just need to pass in the abbreviation of the model. You can check the docstring of the function to look for abbreviations.", "It is time to create a logistic regression model.", "It returns a dataframe with results of 10-fold cross validation and 6 different metrics. The mean is the value we get from compare_models function.", "One key factor in a models performance is tuning the hyperparameters. For some models, hyperparameters have a great impact on the accuracy of the model. Furthermore, they play a key role in preventing models from overfitting or underfitting. Create_model function uses default settings for hyperparameters. PyCaret provides tune_model function that tunes hyperparameters within a pre-defined search space. Two important points for tune_model function:", "A tuned logistic regression model can be created as follows:", "Plot_model function provides tools to further analyze the performance of a model. It takes a trained model as input and returns a specified plot. Let\u2019s go over some examples.", "This is a receiver operating characteristic (ROC) curve which summarizes the performance of the model at different threshold values by combining confusion matrices at all threshold values. X axis of ROC curve is the true positive rate (sensitivity) and y axis of the ROC curve is the false positive rate (1- specificity).", "We just provide an estimator (a trained model) and a type of plot to plot_model and it produces an informative visualization. There are 15 different plots available. Let\u2019s also create confusion matrix and feature importance plots:", "Note: Evaluate_model function produces a user interface with all available plots for a given model. It just takes an estimator (a trained model) as input.", "Predict_model function is used to make predictions on test set. Recall that setup function we run at the beginning splits the dataset into training and test sets.", "In addition to the evaluation metrics on test set, predict_model returns the dataframe with two new columns:", "By default, predictions are made on test set but we can provide new observations to be predicted using data parameter:", "Once we are satisfied with the performance on both training and test sets, we can re-train the model using entire dataset (train+set) with finalize_model function. The purpose is to make use of the entire dataset before the model is deployed. Please note that after finalize_model function is executed, there is no point in evaluating the performance on test set because the model has already seen all observations in both training and test sets. Make sure to use predict_model before finalizing the model.", "Save_model function, as the name suggests, saves the trained model with entire pipeline.", "We can load a saved model using load_model function.", "We have discussed an entire machine learning pipeline and experimented how PyCaret simplifies the coding. We are able to create and evaluate a decent model with approximately 10 lines of code. A typical pipeline with PyCaret can be created using the following functions in order:", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5be22394b1ac&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----5be22394b1ac---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5be22394b1ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5be22394b1ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pycaret.org/", "anchor_text": "PyCaret"}, {"url": "https://www.linkedin.com/in/profile-moez/?originalSubdomain=ca", "anchor_text": "Moez Ali"}, {"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "Telco Customer Churn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5be22394b1ac---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5be22394b1ac---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----5be22394b1ac---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----5be22394b1ac---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/pycaret?source=post_page-----5be22394b1ac---------------pycaret-----------------", "anchor_text": "Pycaret"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5be22394b1ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----5be22394b1ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5be22394b1ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----5be22394b1ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5be22394b1ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5be22394b1ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5be22394b1ac---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5be22394b1ac--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5be22394b1ac--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5be22394b1ac--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5be22394b1ac--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-made-easy-by-pycaret-5be22394b1ac&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}