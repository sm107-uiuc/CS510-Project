{"url": "https://towardsdatascience.com/dont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3", "time": 1682996560.0558798, "path": "towardsdatascience.com/dont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3/", "webpage": {"metadata": {"title": "Don\u2019t Sleep: Building your first Drowsiness Detection System | by Vincent Tatan | Towards Data Science", "h1": "Don\u2019t Sleep: Building your first Drowsiness Detection System", "description": "It was a very important day, the test and project deadline were due next week but you hadn\u2019t prepared much because of the new Halo release. Out of anxiety, you rushed to library and opened your\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.mathworks.com/matlabcentral/answers/155126-how-does-the-vision-cascadeobjectdetector-detect-left-and-right-eyes-separately-it-is-constantly-de", "anchor_text": "vision.CascadeObjectDetector", "paragraph_index": 54}, {"url": "https://bit.ly/2I8jkWV.", "anchor_text": ".", "paragraph_index": 60}, {"url": "http://www.linkedin.com/in/vincenttatan/", "anchor_text": "LinkedIn", "paragraph_index": 63}, {"url": "https://medium.com/@vincentkernn", "anchor_text": "Medium", "paragraph_index": 63}, {"url": "https://www.youtube.com/user/vincelance1/videos", "anchor_text": "Youtube Channel", "paragraph_index": 63}], "all_paragraphs": ["It was a very important day, the test and project deadline were due next week but you hadn\u2019t prepared much because of the new Halo release. Out of anxiety, you rushed to library and opened your laptop. However, as you lost your sleep leveling up your character, your mind quickly took you to dreamland. Coffee did no avail as you slept soundly in front of your laptop. Time was running short and You were desperate to stay awake.", "What if I tell you\u2026 Your laptop could help you stay awake.", "Imagine you were that pitiful guy, you could have activated DDS app installed in your laptop. This would trigger your laptop webcam. Every time you fell drowsy, your laptop would notice and ring an alarm to your headphone. After you woke up,your laptop would notice and turned off the alarm. You could then resume your work.", "Now, let us figure out how to develop the DDS model. Hope you are ready \u263a", "Imagine your friend\u2019s or loved one\u2019s sleepy face, how did you know they were sleepy? Well, the most obvious signs are:", "How do we teach our computer to notice these signs?", "Ratio of black pixels to white pixels (BW): to detect whether your eyes are open or closed. Because of your dark pupil, the larger your eyes open, the more black pixels would appear.", "However, the problem is, there might be other confound variables which would interrupt the BW ratio:", "To address these confound variables, we need to calibrate the BW ratio upon activation. This is our baseline to determine if users are opening or closing their eyes.", "Objects Detection and Labelling: to detect if the mouths are split or not. If the mouth is closing then there would be one connected lips. However, if the mouth is split, then your lips are not connected and will return multiple objects/lips detected.", "Face Detection with Accelerometer: to graph the movement of the face. The more your face moves vertically, the more likely you are sleepy.", "In this publication, we will focus on the eyes and mouths as our identifiers to classify sleepiness. Now, let us get started :).", "Please take a look at the following chart for better understanding.", "The job of the DDS Controller is to activate your laptop\u2019s webcam and use the classifiers to evaluate your features.", "First, let us create a face detector object with the point tracker to keep track of the face detector object", "Once we are done, you could start the webcam, then add on the loop to make sure that it captures in frames. The system will keep taking a picture until a person is detected.", "Once a face is detected, we will calibrate the features. This will produce the following initial ratio calculations.", "Then we will activate EyeDetection.m to detect the eye inside the image . The first image of successful detection will be used to initiate threshold ratio for the subsequent classifications.", "Once we detect the person\u2019s face and eye, we will move on to prepare the tiktok alarm to be sounded. We will run this sound only if the Scoring.m returns \u2018sleepy\u2019 as the verdict.", "If the face is not detected, the application will keep taking snapshots and playing the buzzer until a face is detected or the user force stop it.", "The outputs from both EyeDetection and MouthDetection will be passed into Scoring.m for scoring and coming out with the verdict.", "Once you stop the application, the webcam and video objects will be released.", "Given the image taken by the camera, we will initiate EyeDetector Object with CascadeObjectDetector.", "The cascade object detector uses the Viola-Jones algorithm to detect people\u2019s faces, noses, eyes, mouth, or upper body. You can also use the Image Labeler to train a custom classifier to use with this System object. \u2014 Mathworks", "Please refer to this amazing publication for your understanding regarding Viola-Jones Algorithm used to detect faces.", "We would use the CascadeObjectDetector to get the bounding box of your face and isolate your eyes.", "We will then process the image to black and white then create a strel (morphological element/shape).", "A strel object represents a flat morphological structuring element, which is an essential part of morphological dilation and erosion operations. We use the strel function (described below) to create a flat structuring element. \u2014 Mathworks", "We will then find the number of white pixels by summing all the image pixel with each value 1 to represent the white pixels. This will allow us to find the BW ratio.", "We will characterize sleepy mouth when your lips are half parted (separated). By reading the image derived from the camera, we will extract the mouth object with CascadeObjectDetector.", "Interestingly, There are some funny cases when the application classify 3 mouths with somebody who has unibrow and thick eyebrows. For some reasons, these objects were classified as mouths. Deep apologies to my participants for the harassment. But no worries, fixes are coming.", "We will then process to detect its objects so that they would connect the nearby blobs into one object. Then we store all of the labels and objects inside LabeledIm and ConnectedObj to see if the lips parted.", "From here we count the number of objects to see if the mouth is split or not.", "The idea of naive bayes is to construct relevant classifiers which represents the feature values. A naive Bayes classifier will consider each of the known features to independently contribute the probability of certain classes.", "In our case, given the facts that the users\u2019 mouth and eyes are sleepy (closed eyes, split mouth), what is the probability the user is sleepy? Obviously the probability would be higher than when we classify the users\u2019 mouth and eyes as awake (open eyes, closed mouth).", "The assumption is that the features (mouth and eyes) are independent. This is fair as both features are affected by your sleepiness and are not dependent towards each other.", "Please use this publication for your understanding of naive bayes", "Using the naive bayes theorem, we derive the probability percentage.", "Therefore, every time the camera sends image, the scoring.m will check the image and decide \u2014 probability wise whether a person is sleepy or not.", "First, We will extract the results from eye and mouth detection. Then, we will roll a random number to compare with the probability classification and declare whether you are awake or sleepy. This simulates the probability of your falling asleep or awake.", "With that, you have successfully made your first Drowsiness Detection System. Congratulations!!!", "The purpose of MeasureTracking.m is to hold samples data and evaluate the general threshold which differentiate awake or sleepiness classification from both eye and mouth detection.", "Supposedly, if my opened eyes generate 256.67 BW ratio and closed eyes generate 211.58 BW ratio, how does DDS know that I am closing my eyes?", "Statistical inference comes to the rescue. What this means is that we will start inferring the population thresholds by collecting and analyzing the sample thresholds.", "Simply put, we assume that there is the general percentage threshold of BW ratio to differentiate open and closed eyes. The population threshold could be generalized from a certain sample size.", "In this case, we retrieved 19 participants and collected pairs of opened and closed eyes pictures. Then, we measured the BW ratio for each which will be translated as the optimum threshold value. As a side note, we make sure that the samples are diverse with different races and nationalities.", "These ratios are taken from the pictures of open and closed eyes", "From here, we analysed that the optimum threshold is 8%. A very simple calculation, but it brings 86.67% of accuracy.", "From here we use the optimum threshold as 2 objects. This simple threshold has already produced 84.21% of accuracy.", "A video explains billions pictures \u2014 Vincent Tatan. :)", "The biggest challenge of this application is the bias. Unfortunately, for some different facial features, the system will go crazy in detecting the lips and the eyes. It was embarrassing, but I applaud some of my participants who have patiently accepted this bias and still would like to keep in touch with me. Thanks!", "To alleviate this issue, we calibrated the readings upon application initiation to take into accounts the person\u2019s eyes or lips size. This allowed us to greatly reduce the gap of facial features across races. However, this is far from perfect. Therefore, please feel free to solve and contribute.", "As for your further reference, I post this TED video which best described how my machine struggled.", "The purpose for this Proof Of Concepts (POC) was created as a part of a class project at Vrije Universiteit of Amsterdam. The goal of this application is to use computer vision and face detection algorithm to help students or professionals stay awake in front of their laptops during critical projects.", "In this POC, I used Matlab as the scripting language, vision.CascadeObjectDetector library to get the facial feature bounding boxes, and finally the supports from my fellow classmates as my helpful participants. Thank you guys :)", "The Github Python Notebook Code is located below.", "Feel free to clone the repository and contribute whenever you have time.", "I would like to thank you my fellow classmates from VU Universiteit Amsterdam who gave me the chance to use you in my bias experiments. I apologize if for some reasons my machine detected your eyebrows as lips, in which I cringed and muttered \u201cBad machine! Bad!\u201d. I really enjoyed learning Computer Vision and Matlab to create this useful product of mine.", "Whew\u2026 That\u2019s it, about my idea which I formulated into writings. I really hope this has been a great read for you guys. With that, I hope my idea could be a source of inspiration for you to develop and innovate.", "Please Comment out below to suggest and feedback.", "Vincent Tatan is a Data and Technology enthusiast with relevant working experiences from Visa Inc. and Lazada to implement microservice architectures, data engineering, and analytics pipeline projects.", "Vincent is a native Indonesian with a record of accomplishments in problem solving with strengths in Full Stack Development, Data Analytics, and Strategic Planning.", "He has been actively consulting SMU BI & Analytics Club, guiding aspiring data scientists and engineers from various backgrounds, and opening up his expertise for businesses to develop their products .", "Please reach out to Vincent via LinkedIn , Medium or Youtube Channel", "This disclaimer informs readers that the views, thoughts, and opinions expressed in the text belong solely to the author, and not necessarily to the author\u2019s employer, organization, committee or other group or individual. References are picked up from the list and any similarities with other works are purely coincidental", "This article was made purely as the author\u2019s side project and in no way driven by any other hidden agenda.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I fight phishing with ML @ Google. I use advanced ML algorithms and MLOps to protect Chrome, Gmail and Android users. Please reach out to me on Linkedin."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F28a9903015f3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----28a9903015f3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28a9903015f3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vincentkernn?source=post_page-----28a9903015f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=post_page-----28a9903015f3--------------------------------", "anchor_text": "Vincent Tatan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9848578f8495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&user=Vincent+Tatan&userId=9848578f8495&source=post_page-9848578f8495----28a9903015f3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28a9903015f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28a9903015f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://ieeexplore.ieee.org/abstract/document/8014636", "anchor_text": "Facial parts detection using Viola Jones algorithm - IEEE Conference PublicationThis paper presents to detect the faces in an image and locates the facial features in an image. The detection of the\u2026ieeexplore.ieee.org"}, {"url": "https://www.mathworks.com/help/images/ref/strel.html", "anchor_text": "Morphological structuring element - MATLABA strel object represents a flat morphological structuring element, which is an essential part of morphological\u2026www.mathworks.com"}, {"url": "https://towardsdatascience.com/naive-bayes-classifier-81d512f50a7c", "anchor_text": "Naive Bayes ClassifierWhat is a classifier?towardsdatascience.com"}, {"url": "https://medium.com/@yogita.kinha/statistical-inference-with-hypothesis-testing-43807b932d0a", "anchor_text": "Statistical Inference with Hypothesis TestingInferential statistics helps us to infer unknown properties or behaviour of a larger population by studying a\u2026medium.com"}, {"url": "https://www.mathworks.com/matlabcentral/answers/155126-how-does-the-vision-cascadeobjectdetector-detect-left-and-right-eyes-separately-it-is-constantly-de", "anchor_text": "vision.CascadeObjectDetector"}, {"url": "https://github.com/VincentTatan/DrowsinessDetectionSystem", "anchor_text": "VincentTatan/DrowsinessDetectionSystemCode to calculate the drowsiness level of students and professionals. Then it will play an alarm when it detects you\u2026github.com"}, {"url": "https://bit.ly/2I8jkWV.", "anchor_text": "."}, {"url": "http://www.linkedin.com/in/vincenttatan/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/@vincentkernn", "anchor_text": "Medium"}, {"url": "https://www.youtube.com/user/vincelance1/videos", "anchor_text": "Youtube Channel"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----28a9903015f3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----28a9903015f3---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/analytics?source=post_page-----28a9903015f3---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/classification?source=post_page-----28a9903015f3---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----28a9903015f3---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28a9903015f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&user=Vincent+Tatan&userId=9848578f8495&source=-----28a9903015f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28a9903015f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&user=Vincent+Tatan&userId=9848578f8495&source=-----28a9903015f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28a9903015f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28a9903015f3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F28a9903015f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----28a9903015f3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----28a9903015f3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----28a9903015f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----28a9903015f3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----28a9903015f3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----28a9903015f3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----28a9903015f3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----28a9903015f3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----28a9903015f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vincent Tatan"}, {"url": "https://medium.com/@vincentkernn/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9848578f8495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&user=Vincent+Tatan&userId=9848578f8495&source=post_page-9848578f8495--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba9496ed2fd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdont-sleep-building-your-first-drowsiness-detection-system-28a9903015f3&newsletterV3=9848578f8495&newsletterV3Id=ba9496ed2fd5&user=Vincent+Tatan&userId=9848578f8495&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}