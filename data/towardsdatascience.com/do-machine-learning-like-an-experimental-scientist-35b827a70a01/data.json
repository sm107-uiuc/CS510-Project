{"url": "https://towardsdatascience.com/do-machine-learning-like-an-experimental-scientist-35b827a70a01", "time": 1683014288.28201, "path": "towardsdatascience.com/do-machine-learning-like-an-experimental-scientist-35b827a70a01/", "webpage": {"metadata": {"title": "Do Machine Learning Like an Experimental Scientist | by Tivadar Danka | Towards Data Science", "h1": "Do Machine Learning Like an Experimental Scientist", "description": "Linus Pauling, the only scientist who won two unshared Nobel Prizes and one of the greatest chemists of all time, was a well-organized person. Among other things, he was known for meticulously\u2026"}, "outgoing_paragraph_urls": [{"url": "http://scarc.library.oregonstate.edu/coll/pauling/rnb/", "anchor_text": "During his life\u2019s work, he left 46 research notebooks", "paragraph_index": 2}, {"url": "http://darwin-online.org.uk/EditorialIntroductions/vanWyhe_notebooks.html", "anchor_text": "Charles Darwin", "paragraph_index": 3}, {"url": "https://www.loc.gov/search/?in=&q=Notebook+by+Alexander+Graham+Bell&new=true&st=", "anchor_text": "Alexander Graham Bell", "paragraph_index": 3}, {"url": "http://edison.rutgers.edu/index.htm", "anchor_text": "Thomas Edison", "paragraph_index": 3}, {"url": "https://mlflow.org/", "anchor_text": "MLFlow", "paragraph_index": 21}, {"url": "https://mlflow.org/docs/latest/tracking.html", "anchor_text": "Tracking", "paragraph_index": 21}, {"url": "https://mlflow.org/docs/latest/projects.html", "anchor_text": "Projects", "paragraph_index": 21}, {"url": "https://mlflow.org/docs/latest/models.html", "anchor_text": "Models", "paragraph_index": 21}, {"url": "https://databricks.com/product/managed-mlflow", "anchor_text": "MLFlow service on Databricks", "paragraph_index": 29}, {"url": "https://databricks.com/product/faq/community-edition", "anchor_text": "Databricks Community Edition", "paragraph_index": 29}, {"url": "https://www.wandb.com/", "anchor_text": "Weights and Biases", "paragraph_index": 32}, {"url": "https://wandb.ai/stacey/deep-drive/reports/Semantic-Segmentation-Masks--Vmlldzo4MDYyNA", "anchor_text": "See this one for example.", "paragraph_index": 44}, {"url": "https://www.tivadardanka.com/blog", "anchor_text": "If you love taking machine learning concepts apart and understanding what makes them tick, we have a lot in common. Check out my blog, where I frequently publish technical posts like this!", "paragraph_index": 55}], "all_paragraphs": ["Let\u2019s travel back in time a few decades.", "Linus Pauling, the only scientist who won two unshared Nobel Prizes and one of the greatest chemists of all time, was a well-organized person. Among other things, he was known for meticulously keeping notebooks, containing his experiments, conclusions, and ideas.", "During his life\u2019s work, he left 46 research notebooks, which is an impressive number.", "Pauling was not the only scientist who did this: Charles Darwin, Alexander Graham Bell, Thomas Edison, and practically every scientist before and after their time.", "Notebooks provide an excellent tool to help reproduce experiments, formulate hypotheses, and draw conclusions. When an experiment has several sensitive parameters (like humidity, temperature, and light conditions for a plant biologist), reproducing results are impossible without keeping track.", "Fast forward to the present day.", "Albeit the tools have evolved, experimental scientists are still doing this. The notebooks may be digital, but the point is the same.", "You may ask, what does this have to do with data science or machine learning? Let me explain. Does the following folder look familiar?", "A month later, it turns out that model_v1_final_l1_regularization was the best. Now you have to go back and reproduce it. What were the hyperparameters? The initial learning rate? Which dataset have you used? (Because guessing from the name of the last model, you have several.) What was the model architecture? These are all essential questions.", "If you did not keep track of this, you are in trouble. Thankfully, you are not the first one to face this problem, and because of this, there are already well-established solutions.", "Recording the parameters and the metrics have other benefits than reproducibility. Evaluating the results can give valuable insight into how can the model be even better and which hyperparameters are important. On top of this, since most projects are done by teams, communication can be simplified with beautiful charts and reports.", "Introducing experiment tracking in your workflow requires a time investment, which will pay off exponentially later. Getting rid of old habits require conscious effort, but this is worth the time.", "So, you have decided to move beyond using only Jupyter Notebooks in your machine learning development workflow. There are several tools, ranging from simple to complex full-stack solutions.", "To give a concrete example, suppose that you are building a ResNet-based model for classification.", "Even with disregarding the hyperparameters arising from the model architecture (like the number of filters learned by the convolutional layers), you still have a lot. For instance, the", "are all important and can influence the result.", "In this post, we are going to take a look into two tools that you can use to track your machine learning experiments: MLFlow and Weights and Biases.", "Before we move on, I would like to mention that if you want to implement a solution fast, you should just keep a record of your experiments in a table.", "I know, keeping track of things manually is far from optimal. Logging is tedious and if you are not clear enough in your notes, interpretation can be difficult later. Despite this, there are multiple arguments for using an Excel table (or Google Sheet or whatever you use) to record the hyperparameters and the experimental results.", "This method is extremely low effort and you can start it right now, without learning anything new or browsing tutorials for hours. You don\u2019t always need an advanced solution, sometimes you just have to whip something up quickly. Opening up an Excel and recording your experiments there instantly brings some order to your workflow.", "However, often you need much more. Let\u2019s see what can you use to be as organized as a Kaggle Grandmaster!", "One of the first and most established tools for experiment tracking is MLFlow, which consists of three main components: Tracking, Projects, and Models.", "MLFlow Tracking offers an interactive UI to record hyperparameters, metrics, and other data for experiment tracking. We are going to focus on this part, however, it goes in tandem with Projects, a tool for easily packaging your model into an API, and Models which lets you deploy the models to production. These are designed to be seamlessly integrated, summing up to a complete machine learning workflow. (Hence the name.) It can be used with the major machine learning frameworks, like TensorFlow, PyTorch, scikit-learn, and others.", "Once you have installed it with pip install mlflow, you can start adding it to your code without any extra steps.", "MLFlow tracks your experiment in runs. Each run is saved on your hard drive, which you can review in an interactive dashboard. To start a run, you should wrap the training code to the mlflow.start_run() context. To give an example, this is how it works.", "The logs are saved in the working directory. To check the result of the runs, the dashboard can be launched with", "from the same directory where the runs are saved. By default, the UI can be opened at localhost:5000 in your browser.", "Plots for the logged quantities are also available, where the different runs can be compared with each other.", "A tutorial example with linear regression can be found below.", "To use MLFlow, you don\u2019t have to record all experiments locally. You can use remote tracking servers, by using the managed MLFlow service on Databricks or even hosting your own. (However, the Databricks Community Edition is the free version of the managed platform, which comes with access to a remote tracking server.)", "One particular feature which MLFlow lacks is collaboration and team management. Machine learning projects are rarely done in isolation, and communicating the results can be difficult.", "In recent years, several tools were created to improve the user experience and make the machine learning development process even more seamless. These are similar in functionality, so we are going to single out just one: the Weights and Biases tool.", "One of the newest applications on the list is Weights and Biases, or wandb in short. It is also free to use, but certain functionalities are only available with a paid membership. Similarly to MLFlow, it provides an interactive dashboard that is accessible online and updated in real time. However, the tracking is done by a remote service.", "With Weights and Biases, it is also very easy to get started, and adding the experiment tracking to an existing codebase is as simple as possible.", "After registering, installing the package with pip install wandb, and getting your API key, you can log in by typing", "into the command line, which prompts you to authenticate yourself with the key.", "Now you are ready to add tracking to the code!", "For simplicity, let\u2019s assume that we only have two parameters: batch size and learning rate. First, you have to initialize the wandb object, which will track hyperparameters and communicate with the web app.", "Here, the config dictionary stores the hyperparameters, like", "These are recorded and when later reviewing the runs with different hyperparameters, you can filter and group for these variables in the dashboard.", "When this is set, you can use the wandb.log method to record metrics, like the training and validation losses after an epoch:", "Every call to this method logs the metrics to the interactive dashboard. Besides scalars, sample predictions like images or matplotlib plots can also be saved.", "If you use PyTorch, the wandb.watch method can be used to register your model and keep track of all its parameters.", "Weights and Biases collects much more data than you specify. First, it records all system data it can access, like GPU and CPU utilization, memory usage, and even GPU temperature.", "In addition to this, the plots and visualizations present in the logs can be used to create research paper quality reports and export them to pdfs. It even supports LaTeX for mathematical formulas. (I love this feature.) See this one for example.", "The free version gives a ton of value already, but if you want to access the collaborative and team management tools, you have to pay a monthly subscription fee.", "To get a more detailed look at the tool, check out the article below, written by the founder of Weights and Biases.", "Compared to MLFlow, some features stand out. For instance,", "Besides MLFlow and Weights and Biases, there are many tools with similar functionality. Some of them even go beyond and provide a full stack MLOps platform. Without any preference, here are some of them.", "Similarly to software development, creating a machine learning solution is not a linear process.", "In software development, as features are added, the product is constantly tested, improved. As user feedback, feature requests, and bug reports pours in, engineers often go back to the drawing board and rethink components.", "This is where things often go sideways.", "With every change, things may break. Bugs can be introduced and things can get very confusing. Manage a single shared codebase between multiple developers would be impossible without version control like git.", "In machine learning, complexity is taken to another level. Not only the code to train and serve the models change rapidly, but the model development itself is more of an experimental process. Without specialized tools to track the results, data scientists are lost.", "Two of the best tools out there (among many other excellent ones) are the MLFlow suite and the Weights and Biases tool. Depending on your needs, these can introduce you to a whole new world if you haven\u2019t spent the extra time to organize your work. These are easy to learn and bring so many positive things that you shouldn\u2019t miss out on them.", "If you love taking machine learning concepts apart and understanding what makes them tick, we have a lot in common. Check out my blog, where I frequently publish technical posts like this!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I want to democratize machine learning. Math PhD with an INTJ personality. Chaotic good."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F35b827a70a01&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----35b827a70a01--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----35b827a70a01--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tivadar.danka?source=post_page-----35b827a70a01--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tivadar.danka?source=post_page-----35b827a70a01--------------------------------", "anchor_text": "Tivadar Danka"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F26fd873de5f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&user=Tivadar+Danka&userId=26fd873de5f2&source=post_page-26fd873de5f2----35b827a70a01---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35b827a70a01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35b827a70a01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://scarc.library.oregonstate.edu/coll/pauling/rnb/", "anchor_text": "During his life\u2019s work, he left 46 research notebooks"}, {"url": "http://darwin-online.org.uk/EditorialIntroductions/vanWyhe_notebooks.html", "anchor_text": "Charles Darwin"}, {"url": "https://www.loc.gov/search/?in=&q=Notebook+by+Alexander+Graham+Bell&new=true&st=", "anchor_text": "Alexander Graham Bell"}, {"url": "http://edison.rutgers.edu/index.htm", "anchor_text": "Thomas Edison"}, {"url": "https://www.loc.gov/resource/magbell.25300201/?sp=8", "anchor_text": "Library of Congress"}, {"url": "https://mlflow.org/", "anchor_text": "MLFlow"}, {"url": "https://mlflow.org/docs/latest/tracking.html", "anchor_text": "Tracking"}, {"url": "https://mlflow.org/docs/latest/projects.html", "anchor_text": "Projects"}, {"url": "https://mlflow.org/docs/latest/models.html", "anchor_text": "Models"}, {"url": "https://mlflow.org/", "anchor_text": "MLFlow"}, {"url": "https://mlflow.org/", "anchor_text": "MLFlow"}, {"url": "https://mlflow.org/docs/latest/tutorials-and-examples/tutorial.html", "anchor_text": "TutorialThis tutorial showcases how can you use MLFlow end-to-end to train a linear regression model.mlflow.org"}, {"url": "https://databricks.com/product/managed-mlflow", "anchor_text": "MLFlow service on Databricks"}, {"url": "https://databricks.com/product/faq/community-edition", "anchor_text": "Databricks Community Edition"}, {"url": "https://github.com/mlflow", "anchor_text": "MLFlow is an entirely open source tool"}, {"url": "https://www.wandb.com/", "anchor_text": "Weights and Biases"}, {"url": "https://wandb.ai/stacey/deep-drive/runs/hhbqcnzn", "anchor_text": "This example is available to explore online."}, {"url": "https://wandb.ai/stacey/deep-drive", "anchor_text": "This example is available to explore online."}, {"url": "https://wandb.ai/stacey/deep-drive/reports/Semantic-Segmentation-Masks--Vmlldzo4MDYyNA", "anchor_text": "See this one for example."}, {"url": "https://towardsdatascience.com/machine-learning-experiment-tracking-93b796e501b0", "anchor_text": "Machine Learning Experiment TrackingWhy is experiment tracking so important for doing real world machine learning?towardsdatascience.com"}, {"url": "https://neptune.ai", "anchor_text": "Neptune"}, {"url": "https://www.comet.ml/", "anchor_text": "Comet"}, {"url": "https://guild.ai/", "anchor_text": "Guild AI"}, {"url": "https://polyaxon.com", "anchor_text": "Polyaxon"}, {"url": "https://valohai.com/", "anchor_text": "Valohai"}, {"url": "https://www.tivadardanka.com/blog", "anchor_text": "If you love taking machine learning concepts apart and understanding what makes them tick, we have a lot in common. Check out my blog, where I frequently publish technical posts like this!"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----35b827a70a01---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----35b827a70a01---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----35b827a70a01---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----35b827a70a01---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/education?source=post_page-----35b827a70a01---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F35b827a70a01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&user=Tivadar+Danka&userId=26fd873de5f2&source=-----35b827a70a01---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F35b827a70a01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&user=Tivadar+Danka&userId=26fd873de5f2&source=-----35b827a70a01---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35b827a70a01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----35b827a70a01--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F35b827a70a01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----35b827a70a01---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----35b827a70a01--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----35b827a70a01--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----35b827a70a01--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----35b827a70a01--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----35b827a70a01--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----35b827a70a01--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----35b827a70a01--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----35b827a70a01--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tivadar.danka?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tivadar.danka?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tivadar Danka"}, {"url": "https://medium.com/@tivadar.danka/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F26fd873de5f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&user=Tivadar+Danka&userId=26fd873de5f2&source=post_page-26fd873de5f2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F471a6c88bdce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-machine-learning-like-an-experimental-scientist-35b827a70a01&newsletterV3=26fd873de5f2&newsletterV3Id=471a6c88bdce&user=Tivadar+Danka&userId=26fd873de5f2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}