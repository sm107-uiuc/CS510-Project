{"url": "https://towardsdatascience.com/transfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0", "time": 1683018388.4157372, "path": "towardsdatascience.com/transfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0/", "webpage": {"metadata": {"title": "Transfer Learning and RNN \u2014 the CoreNLP Series | by Laura Bravo Priegue | Towards Data Science", "h1": "Transfer Learning and RNN \u2014 the CoreNLP Series", "description": "Hello and welcome to the third (and probably last? I haven\u2019t decided yet\u2026\ud83d\ude44) part of this coreNLP series! In previous posts of this series I had introduced the coreNLP library and gone into the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/intro-to-stanfords-corenlp-and-java-for-python-programmers-c2586215aab6", "anchor_text": "introduced the coreNLP library", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/sentence-embeddings-and-corenlps-recursive-sentiment-model-d88af7f7b4f5", "anchor_text": "gone into the theory behind their way of computing sentence embeddings for sentiment analysis", "paragraph_index": 0}, {"url": "https://nlp.stanford.edu/sentiment/treebank.html", "anchor_text": "Stanford Sentiment Treebank", "paragraph_index": 5}, {"url": "https://github.com/laurabravopriegue/coreNLP_tutorial", "anchor_text": "GitHub", "paragraph_index": 17}, {"url": "https://stanfordnlp.github.io/CoreNLP/", "anchor_text": "https://stanfordnlp.github.io/CoreNLP/", "paragraph_index": 32}], "all_paragraphs": ["Hello and welcome to the third (and probably last? I haven\u2019t decided yet\u2026\ud83d\ude44) part of this coreNLP series! In previous posts of this series I had introduced the coreNLP library and gone into the theory behind their way of computing sentence embeddings for sentiment analysis.", "This is going to be a more practical article, in which I am going to address one of the biggest limitations of the RNN: it is very difficult (almost impossible) to re-train the model. In this post, I am going to explain the concept of transfer learning as a solution to this training issue. I will also test the RNN on two datasets not seen during training on the task of binary sentiment classification.", "From my experience using coreNLP, the most annoying aspect of Socher\u2019s recursive model (apart from the time it takes to run) is that it is basically impossible to re-train.", "CoreNLP actually makes it very easy for you to re-train the model with a simple command. However the problem is that you need a very particular training dataset.", "As described in the previous post, in order to compositionally learn the sentiment of the sentence, a softmax classifier was built at every node of the RNN\u2019s parse tree. This means that for training this RNN one would basically need true labels (sentiment scores ranging from 0\u20134) at every node of the tree! Let\u2019s go a bit more in depth into what this implies\u2026", "In order to do this particular training, a corpus of labelled parsed trees was created: the Stanford Sentiment Treebank. This corpus consists of 11,855 individual sentences extracted from movie reviews, more specifically from the Rotten Tomatoes dataset introduced by Pang and Lee (2005). The raw textual data was parsed, obtaining 215,154 unique phrases. These phrases were manually labelled according to their sentiment by three human judges. Therefore, the Sentiment Treebank includes sentiment labels for every possible phrase in thousands of sentences, allowing RNTN to be trained on predicting sentiment at every node of a sentence.", "This corpus was highly effective for the task of training and testing the RNN, but its complexity makes it very hard to replicate. Imagine\u2026 one would need to to manually label every word, subphrase, phrase and sentence of the corpus!! This is a big limitation, since it makes it very difficult to re-train and test the model on some corpus other than movie reviews.", "We cannot retrain the RNN due to the limitations stated above. However, in this post we are interested in using the RNN to make predictions on other datasets, not necessarily movie reviews from Rotten Tomatoes. How do we face the issue that the training and testing data are different?", "There is a whole area of study in Machine Learning that tries to reuse classifiers trained in one dataset (or domain) on a different one. This is called transfer learning or domain adaptation. This is a field in which the aim is to generalise a classifier that is trained on a source domain to a target domain.", "There are many reasons why one would like to reuse a classifier trained on one domain (e.g. movie reviews) to make predictions on another domain (e.g. restaurant reviews). Arguably the main one is the issue that we are facing in this very article: sometimes gathering training data is a difficult and expensive task.", "This issue is recurrent in the real world, and therefore very sophisticated transfer learning techniques have been developed in order to address it. I\u2019m not going to go in depth into them. My main aim in this post to simply get an insight into the how well the RNN trained on the movie review domain is able to generalise to other domains.", "In this post we will test the pre-trained RNN on the task of binary sentiment classification at the sentence level. The RNN was trained on the source domain: movie reviews. The testing will be performed on two different target domains: restaurant reviews and electronic reviews.", "In terms of performance, Socher et al (2013) report that the RNN can achieve an accuracy of 85.4% on binary sentiment classification at the sentence level.", "The aim will be to compare the performance of the RNN on the source domain vs. target domains. That way we will be able to draw some conclusions regarding how well Socher\u2019s model is able to transfer its learning to make predictions to other datasets not seen during training.", "For testing the domain adaptation abilities of the RNN, I have chosen two datasets as target domains. Both of them are based on reviews, in order to ensure that the style of writing would remain sort of constant. The difference would be on the subject of the reviews: electronics and restaurants.", "Dataset 1 contains sentences from reviews categorised on the Amazon website under the category of \u2018cell phones and accessories\u2019, and are part of a larger dataset collected by McAuley and Leskovec. The instances of dataset 2 were obtained from the Yelp Challenge dataset, which is a larger dataset of restaurant reviews posted on the Yelp platform.", "Both datasets are equal in size: 1000 sentences each. The sentences are binary labelled as negative (class 0) or positive (class 1) according to their sentiment. Reviews with neutral rating were not considered in order to intensify the polarity of the datasets. Classes are balanced, 500 instances for each sentiment. Length of reviews and its distribution is very similar across both datasets.", "The process is divided into three steps. All the code can be found on my GitHub, but I will go through some of the main parts now!", "The first script, formatting_and_eda.py, get the statistics above and generates the histogram. It also generates the .txt files within the directory test_data. The files X_amazon.txt and X_yelp.txt are the reviews on which the RNN is going to make predictions. The files Y_amazon.txt and Y_yelp.txt are the true labels, that we will use for evaluation.", "The second script, coreNLP_pipeline4.py, runs the coreNLP pipeline. This coreNLP pipeline was built to predict the sentiment score of a single sentence. The predicted score is outputted as a distribution over the five different class labels (1\u20135).", "Our results are going to be printed out onto predictions_amazon.txt and predictions_yelp.txt.They will be structured in the form of dataframes with the following columns:", "Where very_neg, neg, neu, pos, very_pos are the probability that the sentence very negative, negative, neutral, positive and very positive as predicted by the RNN.", "The file must with two arguments: the input file and the name of the dataset. For example:", "I run it inside the stanford-corenlp-4.1.0 folder and twice: one time for the amazon data and another for the yelp data.", "Once we have the results of the predictor, the only thing left is to evaluate how good they are against the true values of Y. This is what evaluation.py does.", "However, the values of Y_true are binary: either 0 or 1 and the values of Y_pred are distributed probabilities over five values: very_positive, positive, neutral, negative and very negative. So, in order to do evaluate the results we must first binarise them.", "In order to convert them into 1s and 0s we drop the neutral column and sum the positive and negative probabilities into a total positive and negative score. If the total positive score is bigger than the total negative score for one sentence, then its target value will be 1 and vice-versa.", "For evaluation we will compute accuracy, precision, recall and a confusion matrix.", "Socher et al (2013) report that the RNTN can achieve an accuracy of 85.4% on binary sentiment classification at the sentence level. As can be seen on the table below, the classification accuracy for the target domains is lower: 79% accuracy for electronics domain and 80% accuracy for restaurants domain.", "However, despite this underperformance, we can still confidently say that Socher\u2019s recursive model is able to perform cross-domain classification on the target domains of electronics and restaurants to a good standard.", "It is also interesting the insight that the other metrics obtained when performing this evaluation can provide into the behaviour of the recursive classifier. It seems that the model performs better in classifying class 1 (positive sentences) than class 0 (negative sentences) for both target domains. There also seems to be no major difference in performance between the two target domains.", "And this is all for now! I hope you enjoyed it and that you be motivated for using this super cool model on different domains, being confident that the performance will be relatively good. See you next time! \u270c\ud83c\udffb", "Stanford CoreNLP. (n.d.). Stanford CoreNLP \u2014 Natural language software. Available at: https://stanfordnlp.github.io/CoreNLP/", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Engineer @ SpoonGuru | From Madrid | Always learning \u270c\ud83c\udffb"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2944f42a19a0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://laurabravopriegue.medium.com/?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": ""}, {"url": "https://laurabravopriegue.medium.com/?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": "Laura Bravo Priegue"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F50416f861dee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&user=Laura+Bravo+Priegue&userId=50416f861dee&source=post_page-50416f861dee----2944f42a19a0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2944f42a19a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2944f42a19a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/intro-to-stanfords-corenlp-and-java-for-python-programmers-c2586215aab6", "anchor_text": "introduced the coreNLP library"}, {"url": "https://towardsdatascience.com/sentence-embeddings-and-corenlps-recursive-sentiment-model-d88af7f7b4f5", "anchor_text": "gone into the theory behind their way of computing sentence embeddings for sentiment analysis"}, {"url": "https://unsplash.com/@ninjason?utm_source=medium&utm_medium=referral", "anchor_text": "Jason Leung"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://nlp.stanford.edu/sentiment/treebank.html", "anchor_text": "Stanford Sentiment Treebank"}, {"url": "https://github.com/laurabravopriegue/coreNLP_tutorial", "anchor_text": "GitHub"}, {"url": "https://www.aclweb.org/anthology/D13-1170", "anchor_text": "https://www.aclweb.org/anthology/D13-1170"}, {"url": "https://stanfordnlp.github.io/CoreNLP/", "anchor_text": "https://stanfordnlp.github.io/CoreNLP/"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----2944f42a19a0---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/corenlp?source=post_page-----2944f42a19a0---------------corenlp-----------------", "anchor_text": "Corenlp"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----2944f42a19a0---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----2944f42a19a0---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/java?source=post_page-----2944f42a19a0---------------java-----------------", "anchor_text": "Java"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2944f42a19a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&user=Laura+Bravo+Priegue&userId=50416f861dee&source=-----2944f42a19a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2944f42a19a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&user=Laura+Bravo+Priegue&userId=50416f861dee&source=-----2944f42a19a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2944f42a19a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2944f42a19a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2944f42a19a0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2944f42a19a0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2944f42a19a0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2944f42a19a0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2944f42a19a0--------------------------------", "anchor_text": ""}, {"url": "https://laurabravopriegue.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://laurabravopriegue.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Laura Bravo Priegue"}, {"url": "https://laurabravopriegue.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "31 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F50416f861dee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&user=Laura+Bravo+Priegue&userId=50416f861dee&source=post_page-50416f861dee--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F50416f861dee%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-and-rnn-the-corenlp-series-pt-iii-2944f42a19a0&user=Laura+Bravo+Priegue&userId=50416f861dee&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}