{"url": "https://towardsdatascience.com/class-imbalance-problem-in-classification-a2ddaba98f4a", "time": 1683005356.7144608, "path": "towardsdatascience.com/class-imbalance-problem-in-classification-a2ddaba98f4a/", "webpage": {"metadata": {"title": "Class imbalance problem in classification | by Anastasia Gorina | Towards Data Science", "h1": "Class imbalance problem in classification", "description": "When we are dealing with classification, there are many problems that we can face. One of them is class imbalance: having one overrepresented and one heavily underrepresented class. This problem\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.allure.com/story/best-of-beauty-2019-winners", "anchor_text": "Allure Beauty Award", "paragraph_index": 1}, {"url": "https://github.com/agorina91/Sephora_Classification", "anchor_text": "GitHub repo", "paragraph_index": 15}], "all_paragraphs": ["When we are dealing with classification, there are many problems that we can face. One of them is class imbalance: having one overrepresented and one heavily underrepresented class. This problem occurs in many areas of research, for example, when we are trying to diagnose a rare disease or detect a fraudulent transaction. In this post I would like to talk about how I handled the class imbalance problem in one of my classification projects.", "Typically, we can say that we are facing class imbalance when the proportion of our classes is lower than 10/90. In some cases, it can be even more severe. I was once working on a classification project, trying to predict which beauty product sold at Sephora wins the prestige Allure Beauty Award. After examining my data I have realized that I have 1920 products that were non-winners and only 81 winners. Note: there were more winning products, but only 81 of them were sold at Sephora, and I was dealing with only their data.", "In order to create a binary classification model I decided to take a naive approach first: run logistic regression without any manipulations. The result was expected: model performed with 96% accuracy but non-existent recall. This means that this approach treated all the underrepresented class as background noise, or simply saying, just assumed that all the products were non-winners and was correct 96% of the times.", "This is not the end of the world if we are talking about beauty products that win the award, but what if we\u2019re trying to diagnose a deadly disease? We need to eliminate the type II error.", "There are two famous traditional methods of dealing with the class imbalance problem: under-sampling with TOMEK links and over-sampling with SMOTE.", "In the first case, we detect links between instances of two different classes that stand close to each other and confuse the model. In my project, there could be two very similar products (same price, similar rating, etc.) but one of them won the award and another one did not. We create a link between these instances and remove them, separating the two classes as much as possible.", "With SMOTE (Synthetic Minority Oversampling Technique) we take a different approach. Instead of reducing the number of data points we create synthetic instances of the underrepresented class. Again, in my case, we just analyze the prices, ratings, and other predictors that are representative of the Allure winners, and create more instances with these features.", "When working on my project, I tried both of these methods, but none of the models that I built (Logistic regression, Naive Bayes, XGBoost) went higher than 78% in accuracy and failed to improve the recall.", "After careful consideration I have decided to take a step by step approach.", "First, I needed to create two separate data frames, winners and non-winners (let\u2019s call them losers for simplicity, even though it may sound inappropriate)", "Next, to make sure that my under-sampling is unbiased, we need to shuffle the rows of the non-winning data frame, df_lose:", "Next, we need to truncate this data frame to match the dimensions of the df_win (remember, we only had 81 winners):", "Finally, we concatenate them together and shuffle again, just in case:", "Now we can take a look at the numbers of our new data frame and intuitively examine, whether or not these classes are different in their predictor columns. Turns out, they are, especially in the \u2018Hearts\u2019 category (how many people \u2018liked\u2019 the product)", "Finally, we can run our classification model. My best model turned out to be XGBoost with 96.97% validation accuracy and 0.93 of recall. After getting these promising results I got a little suspicious, what if I just happened to pick the most distinct instances of both classes, by chance? I have repeated this process with shuffling the rows four more times and the model performance remained pretty much the same each time.", "Feel free to fork-clone my GitHub repo, hope my little research helps!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist, Math and Physics enthusiast. Enjoy working on ML projects about beauty products and fine cuisine."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa2ddaba98f4a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@a.i.gorina?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a.i.gorina?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": "Anastasia Gorina"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1293a63e9201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&user=Anastasia+Gorina&userId=1293a63e9201&source=post_page-1293a63e9201----a2ddaba98f4a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa2ddaba98f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa2ddaba98f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.allure.com/story/best-of-beauty-2019-winners", "anchor_text": "Allure Beauty Award"}, {"url": "https://github.com/agorina91/Sephora_Classification", "anchor_text": "GitHub repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a2ddaba98f4a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a2ddaba98f4a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/class-imbalance?source=post_page-----a2ddaba98f4a---------------class_imbalance-----------------", "anchor_text": "Class Imbalance"}, {"url": "https://medium.com/tag/classification?source=post_page-----a2ddaba98f4a---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/recall?source=post_page-----a2ddaba98f4a---------------recall-----------------", "anchor_text": "Recall"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa2ddaba98f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&user=Anastasia+Gorina&userId=1293a63e9201&source=-----a2ddaba98f4a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa2ddaba98f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&user=Anastasia+Gorina&userId=1293a63e9201&source=-----a2ddaba98f4a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa2ddaba98f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa2ddaba98f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a2ddaba98f4a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a2ddaba98f4a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a.i.gorina?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a.i.gorina?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anastasia Gorina"}, {"url": "https://medium.com/@a.i.gorina/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "270 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1293a63e9201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&user=Anastasia+Gorina&userId=1293a63e9201&source=post_page-1293a63e9201--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F1293a63e9201%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclass-imbalance-problem-in-classification-a2ddaba98f4a&user=Anastasia+Gorina&userId=1293a63e9201&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}