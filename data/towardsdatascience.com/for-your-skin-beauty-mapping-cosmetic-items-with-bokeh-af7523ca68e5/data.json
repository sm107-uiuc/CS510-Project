{"url": "https://towardsdatascience.com/for-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5", "time": 1682994028.807287, "path": "towardsdatascience.com/for-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5/", "webpage": {"metadata": {"title": "For Your Skin Beauty: Mapping Cosmetic Items with Bokeh | by Jiwon Jeong | Towards Data Science", "h1": "For Your Skin Beauty: Mapping Cosmetic Items with Bokeh", "description": "Whenever I want to try a new cosmetic item, it\u2019s so difficult to choose. It\u2019s actually more than difficult. It\u2019s sometimes scary because new items that I\u2019ve never tried end up giving me skin trouble\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.sephora.com/", "anchor_text": "Sephora", "paragraph_index": 1}, {"url": "https://github.com/jjone36/Cosmetic", "anchor_text": "Github", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/how-to-build-from-scratch-a-content-based-movie-recommender-with-natural-language-processing-25ad400eb243", "anchor_text": "this article", "paragraph_index": 2}, {"url": "https://medium.com/u/44deedb40f94?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "Emma Grimaldi", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "T-distributed Stochastic Neighbor Embedding (t-SNE)", "paragraph_index": 19}, {"url": "https://en.wikipedia.org/wiki/Cosine_similarity", "anchor_text": "Cosine similarity", "paragraph_index": 26}, {"url": "https://www.sephora.com/product/peat-miracle-revital-cream-P412440", "anchor_text": "Peat Miracle Revital Cream", "paragraph_index": 27}, {"url": "https://www.linkedin.com/in/jiwon-jeong/", "anchor_text": "LinkedIn", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/jiwon-jeong/", "anchor_text": "https://www.linkedin.com/in/jiwon-jeong/", "paragraph_index": 34}], "all_paragraphs": ["Whenever I want to try a new cosmetic item, it\u2019s so difficult to choose. It\u2019s actually more than difficult. It\u2019s sometimes scary because new items that I\u2019ve never tried end up giving me skin trouble. We know the information we need is on the back of each product, but it\u2019s really hard to interpret those ingredient lists unless you\u2019re a chemist. So Instead of just being worried about my new choice, I decided to build a simple cosmetic recommendation on my own.", "For the first step, I did web scraping from Sephora. To focus on the skin care items, I only took six different categories \u2014 moisturizing cream, facial treatments, cleanser, facial mask, eye treatment, and sun protection. The dataset has 1472 items in total. It also has the information about the brand, the price, the rank, skin types and the chemical components of each item. I\u2019ll skip the step for web scraping but the full code and the dataset are available on my Github.", "This article assumes that you already have a basic understanding of the recommendation system. If you aren\u2019t familiar with recommendation systems or cosine similarity, I\u2019d recommend you to read this article by Emma Grimaldi, which can give you the intuition on this. Among various methods for building a recommendation engine, the content-based recommendation is applied to this project. There are mainly two reasons for the choice.", "First, Predicting how much a new product would fit based on the past items I used is inappropriate. That\u2019s because the train set (the past products) is much smaller than the test set. Imagine how many products one person has tried compared to the number of cosmetics that exist in the world.", "Secondly, a cosmetic recommendation concerning skin trouble is a complex issue. There could be some people who share a very similar taste for cosmetics. And with user-user collaborative filtering, we can recommend new products based on the ranking values of this neighboring group. However, the skin type and feature of a person is a more sensitive and ticky problem than just recommending your tonight\u2019s movie show. To get the reliability and stability in the recommendation, we need to focus on the real content of each product, or the ingredients of products, and get the similarities based on them.", "Now let\u2019s start with checking the dataset. Several preprocessing step after scraping has been done already and we\u2019re going to start from here. There are 1472 items without duplication and 17 columns.", "The next step is cleaning the text data in the Ingredients column. The data is scraped from the Sephora page. As you can see below, there are two parts-descriptions for some particular compositions, the list of all ingredients, and additional info.", "Here, we only need the ingredients part (the second paragraph on the left side or the first paragraph on the right side). As the lines are separated by '\\r\\n\\r\\n' , we are going to split the text with this pattern.", "The result will be the lists in a list. In other words, the separated parts are put as a list, and the lists for each item are gathered inside a list. So how are we going to extract only the part for ingredients? My strategy here is using several patterns for detecting the unwanted part.", "Looping over every item, we can take only one that it doesn\u2019t contain the pattern words and put it into the corresponding line of Ingredients column. Now we are ready to jump into tokenizing.", "There are six categories of product in our data (moisturizers, cleansers, face masks, eye creams, and sun protection) and there are five different skin types (combination, dry, normal, oily and sensitive). The map we\u2019re making is the plot with an optional choice so that the users can get a more detailed result. There are going to be two kinds of options. One for the categories of cosmetics such as moisturizer and cleanser. The other for the skin types of users such as dry and oily. For make it clear, let\u2019s focus on an option for \u201cmoisturizers for dry skin type\u201d first and then apply the same process to other options later.", "The filtered data has 190 items. To get to our end goal of comparing ingredients in each product, we first need to do some preprocessing tasks and bookkeeping of the actual words in each product\u2019s ingredients list. The first step will be tokenizing the list of ingredients in Ingredients column. After splitting them into tokens, we'll make a binary bag of words. Then we will create a dictionary with the tokens ingredient_idx as follows.", "Passing through one by one, we first lower all the letters and split the text. All the tokenized words are put into the corpus. Then another loop is prepared. This one is for putting the words into the dictionary we made beforehand. It checks duplication first, and if a word hasn\u2019t been found yet, put it into the dictionary with indexing. The value of the index will increase one by one.", "The next step is making a document-term matrix (DTM). Here each cosmetic product will correspond to a document, and each chemical composition will correspond to a term. This means we can think of the matrix as a \u201ccosmetic-ingredient\u201d matrix. The size of the matrix should be as the picture shown below.", "To create this matrix, we\u2019ll first make an empty matrix filled with zeros. The length of the matrix is the total number of cosmetic products in the data. The width of the matrix is the total number of ingredients. After initializing this empty matrix, we\u2019ll fill it in the following tasks.", "Before we can fill the matrix, let\u2019s create a function to count the tokens (i.e., an ingredients list) for each row. Our end goal is to fill the matrix with 1 or 0: if an ingredient is in a cosmetic, the value is 1. If not, it remains 0. The name of this function, oh_encoder, will become clear next.", "Now we\u2019ll apply the oh_encoder() function to the tokens in corpus and set the values at each row of this matrix. So the result will tell us what ingredients each item is composed of. For example, if a cosmetic item contains water, niacin, decyl aleate and sh-polypeptide-1, the outcome of this item will be as follows.", "This is what we called one-hot encoding. By encoding each ingredient in the items, the Cosmetic-Ingredient matrix will be filled with binary values.", "The dimension of the existing matrix is (190, 2215), which means there are 2215 features in our data. For visualization, we should downsize this into two dimensions. We\u2019ll use t-SNE for reducing the dimension of the data here.", "T-distributed Stochastic Neighbor Embedding (t-SNE) is a nonlinear dimensionality reduction technique that is well-suited for embedding high-dimensional data for visualization in a low-dimensional space of two or three dimensions. Specifically, this technique can reduce the dimension of data while keeping the similarities between the instances. This enables us to make a plot on the coordinate plane, which can be said as vectorizing. All of these cosmetic items in our data will be vectorized into two-dimensional coordinates, and the distances between the points will indicate the similarities between the items.", "I combined the resulting values with other columns of price, brand name, and rank. So the resulting data frame is as shown below.", "We are now ready to start creating our plot. With the t-SNE values, we can plot all our items on the coordinate plane. And the coolest part here is that it will also show us the name, the brand, the price and the rank of each item. Let\u2019s make a scatter plot using Bokeh and add a hover tool to show that information. Note that we won\u2019t display the plot yet as we will make some more additions to it.", "The data df_all here is the data with all possible combination of choices. The same process we\u2019ve made so far is done. I just combined for all the possible options into one data frame. Therefore when we make a callback function and give it an optional choice, it will take the data for the given condition and update the plot.", "Finally, it\u2019s show time! Let\u2019s see how the map we\u2019ve made looks like. \ud83d\ude4c\ud83d\ude4c", "Each point on the plot corresponds to the cosmetic items. Then what do the axes mean here? The axes of a t-SNE plot aren\u2019t easily interpretable in terms of the original data. Like mentioned above, t-SNE is a visualizing technique to plot high-dimensional data in a low-dimensional space. Therefore, it\u2019s not desirable to interpret a t-SNE plot quantitatively.", "Instead, what we can get from this map is the distance between the points (which items are close and which are far apart). The closer the distance between the two items is, the more similar the composition they have. Therefore this enables us to compare the items without having any chemistry background.", "Lastly, let\u2019s compare the similarity between each point. Cosine similarity is one way of measuring the similarity between two non-zero vectors. What is the reason we use the cosine value instead of the distance between the two? It\u2019s also okay to use the distance but if we add the angle between the vectors to the distance concept, the value will represent more information than just the length. It can even contain the directional data with the \u00b1 sign. So it\u2019s basically more informative to take the cosine similarity.", "For example, there is a product named Peat Miracle Revital Cream. Let\u2019s compare its properties with other moisturizing items for dry skin-type.", "If we sort the result in ascending order, we can see the top 5 closest cosmetic items as shown below.", "These are the top 5 cosmetics that have similar properties with myItem. Maybe I should buy GUERLAIN for my next try. With this list, we can produce a recommendation for new products. If we sort them in a descending way, then the list could be used as \u2018the worst choice for you\u2019.", "Recommendation based on product properties can be applied to any kinds of domains. It could be also applied to a book or a wine recommendation. We can make various maps with the product features. Visualizing products on the coordinate plane helps us to understand the relations between the items in an intuitive way.", "With this analysis, we can go further toward more refined services. It could show the images and the reviews of the item or provide a direct link to the page for ordering. We can also make a different plot whose axes represent chemical attributes. For example, if we add some expert chemical knowledge, we can set the axes for hydration or toxicity. In that case, it will be able to see how much toxicity each item is. These kinds of application will offer a higher level of product analysis.", "Thank you for reading and hope you found this post interesting. If there is something need to be corrected, please share your insight! If you\u2019d like to encourage an aspiring data scientist, please hit \ud83d\udc4f \ud83d\udc4f \ud83d\udc4f! I\u2019m always open to talk so feel free to leave comments or contact me on LinkedIn. I\u2019ll come back with another exciting project. Until then, happy machine learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Researcher / Data geek \ud83e\udd13 Bookworm \ud83d\udcda Travel lover \ud83c\udf0f LinkedIn: https://www.linkedin.com/in/jiwon-jeong/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf7523ca68e5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jiwon.jeong?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jiwon.jeong?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "Jiwon Jeong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1df293b5ca56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&user=Jiwon+Jeong&userId=1df293b5ca56&source=post_page-1df293b5ca56----af7523ca68e5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf7523ca68e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf7523ca68e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.sephora.com/", "anchor_text": "Sephora"}, {"url": "https://github.com/jjone36/Cosmetic", "anchor_text": "Github"}, {"url": "https://towardsdatascience.com/how-to-build-from-scratch-a-content-based-movie-recommender-with-natural-language-processing-25ad400eb243", "anchor_text": "this article"}, {"url": "https://medium.com/u/44deedb40f94?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "Emma Grimaldi"}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "T-distributed Stochastic Neighbor Embedding (t-SNE)"}, {"url": "https://en.wikipedia.org/wiki/Cosine_similarity", "anchor_text": "Cosine similarity"}, {"url": "https://www.sephora.com/product/peat-miracle-revital-cream-P412440", "anchor_text": "Peat Miracle Revital Cream"}, {"url": "https://medium.com/u/52aa38cb8e25?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "James Le"}, {"url": "https://medium.com/@james_aka_yale/the-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223", "anchor_text": "https://medium.com/@james_aka_yale/the-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223"}, {"url": "https://www.datacamp.com/courses/interactive-data-visualization-with-bokeh", "anchor_text": "https://www.datacamp.com/courses/interactive-data-visualization-with-bokeh"}, {"url": "https://www.linkedin.com/in/jiwon-jeong/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/data-science?source=post_page-----af7523ca68e5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/cosmetics?source=post_page-----af7523ca68e5---------------cosmetics-----------------", "anchor_text": "Cosmetics"}, {"url": "https://medium.com/tag/recommendations?source=post_page-----af7523ca68e5---------------recommendations-----------------", "anchor_text": "Recommendations"}, {"url": "https://medium.com/tag/text-mining?source=post_page-----af7523ca68e5---------------text_mining-----------------", "anchor_text": "Text Mining"}, {"url": "https://medium.com/tag/nlp?source=post_page-----af7523ca68e5---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf7523ca68e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&user=Jiwon+Jeong&userId=1df293b5ca56&source=-----af7523ca68e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf7523ca68e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&user=Jiwon+Jeong&userId=1df293b5ca56&source=-----af7523ca68e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf7523ca68e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faf7523ca68e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----af7523ca68e5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----af7523ca68e5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----af7523ca68e5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----af7523ca68e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jiwon.jeong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jiwon.jeong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jiwon Jeong"}, {"url": "https://medium.com/@jiwon.jeong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.4K Followers"}, {"url": "https://www.linkedin.com/in/jiwon-jeong/", "anchor_text": "https://www.linkedin.com/in/jiwon-jeong/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1df293b5ca56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&user=Jiwon+Jeong&userId=1df293b5ca56&source=post_page-1df293b5ca56--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd0a222fc96e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffor-your-skin-beauty-mapping-cosmetic-items-with-bokeh-af7523ca68e5&newsletterV3=1df293b5ca56&newsletterV3Id=d0a222fc96e6&user=Jiwon+Jeong&userId=1df293b5ca56&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}