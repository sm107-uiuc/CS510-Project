{"url": "https://towardsdatascience.com/how-to-engineer-bayesian-ratio-features-548b9862446b", "time": 1683001306.3010519, "path": "towardsdatascience.com/how-to-engineer-bayesian-ratio-features-548b9862446b/", "webpage": {"metadata": {"title": "How to engineer Bayesian ratio features? | by Wanshun Wong | Towards Data Science", "h1": "How to engineer Bayesian ratio features?", "description": "Suppose we want to build a machine learning model that predicts the winner of a football penalty shoot-out. Among the data we have about different football players there are penalties_scored and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Beta_distribution", "anchor_text": "wikipedia", "paragraph_index": 19}], "all_paragraphs": ["Suppose we want to build a machine learning model that predicts the winner of a football penalty shoot-out. Among the data we have about different football players there are penalties_scored and penalties_attempted. Following conventional wisdom we engineer the feature", "However, since penalty kicks and penalty shoot-outs do not often very happen, we have the following problems about this new feature:", "Bayesian statistics solves all of the above problems. Naively speaking, within the Bayesian framework, first a player is given an initial feature value corresponding to our prior knowledge about the player. Then when we receive new data, we update the feature value gradually. The new value can deviate from the initial value substantially only if we receive sufficient amount of data.", "The formula of our Bayesian feature is", "where \u03b1 and \u03b2 are hyperparameters that we need to choose. Intuitively we can understand \u03b1 and \u03b2 as the amount of \u201chead start\u201d we give to the number of penalty scored and missed respectively.", "Since we are only concerned about whether a penalty is scored or missed (but not how), we can model the outcome with a binomial distribution. It is then natural and convenient to model a player\u2019s probability of scoring a penalty with a beta distribution, which is the conjugate prior of a binomial likelihood function.", "The formula above is the mean of the beta distribution", "where penalties_missed = penalties_attempted - penalties_scored.", "Let us choose \u03b1 = 7, \u03b2 = 3, and consider a player who has never taken a penalty before.", "We see that bayesian_penalty_success_rate is always well-defined. Its value changes gradually upon receiving new data, and it requires strong evidence for the value to move significantly away from the initial value.", "Among all pairs (\u03b1, \u03b2) that satisfy the above equality, we can choose a pair using the following methods:", "In general, small \u03b1 and \u03b2 means we have weak prior knowledge and new data will have a bigger impact on the beta distribution and hence our feature value.", "In addition, we want (5 + \u03b1) / (5 + \u03b1 + \u03b2) > 0.82 because of the exploratory data analysis about players scoring all their first 5 penalties.", "Remark: Usually there are many pairs of (\u03b1, \u03b2) that satisfy our conditions. Very often their associated features contribute in a similar way to our machine learning model, so we can simply pick one of them.", "Q: Do \u03b1 and \u03b2 have to be integers?", "A: No. The only requirement is that they are positive real numbers.", "Q: Can we choose different \u03b1 and \u03b2 for different players?", "A: Yes. Recall that \u03b1 and \u03b2 defines a beta distribution that describes our prior knowledge. It is very likely that we have different prior knowledge about different players, for example forwards are usually good at taking penalties, while defenders are not.", "Q: The bayesian feature formula above uses the mean of a beta distribution. Can we use other statistics like standard deviation to define new features?", "A: Yes. We can find those formulas easily on wikipedia.", "Q: Is it beneficial to create this bayesian feature if we are already using penalty_success_rate, penalties_scored, and penalties_attempted in our machine learning model? For instance, to distinguish between 1 out of 2 and 50 out of 100 our model can simply use the penalties_scored feature.", "A: Yes it is still beneficial to do so. Imagine that we start with only 2 features penalties_scored and penalties_attempted. Even though a model with sufficient complexity can do division, we would still engineer the penalty_success_rate feature to make our model learn better. Engineering our bayesian feature is just the same.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F548b9862446b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----548b9862446b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----548b9862446b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wanshunwong?source=post_page-----548b9862446b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=post_page-----548b9862446b--------------------------------", "anchor_text": "Wanshun Wong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb145fb04b8bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&user=Wanshun+Wong&userId=b145fb04b8bd&source=post_page-b145fb04b8bd----548b9862446b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F548b9862446b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F548b9862446b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jeffreyflin?utm_source=medium&utm_medium=referral", "anchor_text": "Jeffrey F Lin"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.bbc.co.uk/sport/football/44641247", "anchor_text": "70%"}, {"url": "https://en.wikipedia.org/wiki/Beta_distribution", "anchor_text": "wikipedia"}, {"url": "http://varianceexplained.org/statistics/beta_distribution_and_baseball/", "anchor_text": "This"}, {"url": "https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval#Wilson_score_interval", "anchor_text": "Wilson score interval"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----548b9862446b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----548b9862446b---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----548b9862446b---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/beta-distribution?source=post_page-----548b9862446b---------------beta_distribution-----------------", "anchor_text": "Beta Distribution"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F548b9862446b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&user=Wanshun+Wong&userId=b145fb04b8bd&source=-----548b9862446b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F548b9862446b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&user=Wanshun+Wong&userId=b145fb04b8bd&source=-----548b9862446b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F548b9862446b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----548b9862446b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F548b9862446b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----548b9862446b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----548b9862446b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----548b9862446b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----548b9862446b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----548b9862446b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----548b9862446b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----548b9862446b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----548b9862446b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----548b9862446b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wanshun Wong"}, {"url": "https://medium.com/@wanshunwong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "263 Followers"}, {"url": "https://www.linkedin.com/in/wanshunwong/", "anchor_text": "https://www.linkedin.com/in/wanshunwong/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb145fb04b8bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&user=Wanshun+Wong&userId=b145fb04b8bd&source=post_page-b145fb04b8bd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa149bfd5dd79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-engineer-bayesian-ratio-features-548b9862446b&newsletterV3=b145fb04b8bd&newsletterV3Id=a149bfd5dd79&user=Wanshun+Wong&userId=b145fb04b8bd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}