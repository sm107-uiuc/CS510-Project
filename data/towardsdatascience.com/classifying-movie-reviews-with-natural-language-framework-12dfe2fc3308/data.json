{"url": "https://towardsdatascience.com/classifying-movie-reviews-with-natural-language-framework-12dfe2fc3308", "time": 1683001302.5902982, "path": "towardsdatascience.com/classifying-movie-reviews-with-natural-language-framework-12dfe2fc3308/", "webpage": {"metadata": {"title": "Classify Movie Reviews With Natural Language Framework, Core ML, and SwiftUI | by Anupam Chugh | Better Programming", "h1": "Classify Movie Reviews With Natural Language Framework, Core ML, and SwiftUI", "description": "Classify texts using Text Classifiers in Create ML with the new Transfer learning techniques and deploy the Core ML model in a swiftui based application. The dataset used is rotten tomatoes."}, "outgoing_paragraph_urls": [{"url": "https://developer.apple.com/videos/play/wwdc2019/232/", "anchor_text": "WWDC 2019", "paragraph_index": 0}, {"url": "https://datapane.com/datasets/mA2pj74/", "anchor_text": "Rotten Tomatoes dataset", "paragraph_index": 7}, {"url": "https://github.com/anupamchugh/iowncode/tree/master/iOSNLPRottenTomatoes", "anchor_text": "Github Repository", "paragraph_index": 28}, {"url": "http://linktr.ee/anupamchugh", "anchor_text": "linktr.ee/anupamchugh", "paragraph_index": 30}], "all_paragraphs": ["Apple showed some good progress in the field of Natural Language Processing during WWDC 2019. They\u2019ve brought enhancements in both Text Classification And Word Tagging, the two pillars of NLP.", "In this article, we\u2019ll be discussing the advancements in Text Classification only, which deals with classifying input text to a set of predefined class labels.", "This year, Apple brings in the transfer learning technique for text classifiers model training. Transfer learning pays heed to the semantics of the overall context of the text and is able to figure out cases where the same word has different meanings in different parts of the text.", "Though state of the art transfer learning is better equipped for semantic analysis, it does take a bit longer time to train than a say, maximum entropy algorithm.", "Apple also introduces built-in sentiment analysis this year. Using the NLP framework, now you get a score in the range -1 to 1 signifying the degree of sentiment.", "Here\u2019s a sample code showing how NLP\u2019s built-in sentiment analysis predicts the sentiment score in a string:", "The built-in sentiment analysis is pretty accurate as we can see below:", "In the next sections, we\u2019ll be using Rotten Tomatoes dataset to create a Text Classifier Core ML Model using Create ML and deploy it in our Natural Language Framework.", "Our dataset is a CSV file as shown below:", "The following python script is used to split the CSV into training and test data folders:", "For the sake of simplicity and time, we\u2019ll parse the first 50000 rows out of the 4,80,000 Rotten Tomato review and split the dataset into the standard 80\u201320 ratio for the train and test folder.", "Once the CSV is split into the respective folders, we can launch our Create ML application which has now got an independent entity this year.", "Create a new Text Classifier Model Project in Create ML and add the training folder. You can choose any of the techniques to train your model and go have a cup of coffee while the training and validation happens. It took me 4 hours to get a Transfer learning model trained.", "Here\u2019s an illustration that compares the model metrics across the two techniques in Text Classification:", "The transfer learning based model extrapolates better. Though you can try achieving better accuracy by increasing the dataset size(TL model training took four hours on a dataset of 15000 texts for me).", "Alternatively, you can create your model programmatically using Create ML. Just pass the desired algorithm in the argument ModelParameters .", "Once the model is trained and tested, hop onto the Output tab in Create ML and enter texts to run predictions. The following illustration shows some of the predictions I ran.", "Now our model is ready to be deployed for natural language processing.", "Create a new Xcode SwiftUI based project and drag and drop the Core ML model we\u2019d created earlier.", "We\u2019ll be developing an application that shows a list of texts(typically Rotten Tomato reviews) on which we\u2019ll run our Core ML Model using NLP to determine whether it was a rot or not(good or bad review).", "Also, we\u2019ll be running NLP\u2019s built-in sentiment analysis to know how it predicts the Rotten Tomato reviews and see how accurate the degree of sentiment and the CoreML predictions are.", "The following code shows how to feed a Core ML model into the Natural Language Framework:", "Let\u2019s start off by creating a SwiftUI List that\u2019s populated using a Reviews structure that conforms to the Identifiable protocol.", "In the above code, we\u2019ve added navigation links to the List items that takes them to the ReviewDetail view which we shall see next:", "The above code is straightforward. We\u2019ve added two SwiftUI buttons that evaluate the text for sentiment analysis and how good or bad the review is, respectively.", "In return, we get the following outcome in our SwiftUI preview:", "NLP\u2019s built-in sentiment analysis did a pretty fine job with a dataset it\u2019s largely not familiar with. At the same time, our Core ML model performed decently with the Natural Language Framework in determining whether the reviewer loved the film or panned it.", "So that sums up Core ML and Natural Language Framework. We saw how the built-in sentiment analysis is such a powerful tool in language processing.", "The full source code along with the python script for parsing the CSV is available in this Github Repository. Also, it contains models built using max entropy and transfer learning. You can try playing around with them and see which fits the bill better.", "That\u2019s it for this one. I hope you enjoyed reading and model training!", "Human bot and a Debugger at Better Programming. Satirist for controversial opinions. Freelance iOS dev. Mr. Chatterbox (per school teacher)linktr.ee/anupamchugh"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F12dfe2fc3308&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@anupamchugh", "anchor_text": "Mastodon"}, {"url": "https://betterprogramming.pub/?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": ""}, {"url": "https://betterprogramming.pub/?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": "Better Programming"}, {"url": "https://anupamchugh.medium.com/?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": ""}, {"url": "https://anupamchugh.medium.com/?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": "Anupam Chugh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9833cc01f515&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&user=Anupam+Chugh&userId=9833cc01f515&source=post_page-9833cc01f515----12dfe2fc3308---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12dfe2fc3308&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12dfe2fc3308&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@felixmooneeram?utm_source=medium&utm_medium=referral", "anchor_text": "Felix Mooneeram"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://developer.apple.com/videos/play/wwdc2019/232/", "anchor_text": "WWDC 2019"}, {"url": "https://datapane.com/datasets/mA2pj74/", "anchor_text": "Rotten Tomatoes dataset"}, {"url": "https://developer.apple.com/documentation/createml/mltextclassifier/3006741-init", "anchor_text": "init(trainingData: MLTextClassifier.DataSource, parameters: MLTextClassifier.ModelParameters)"}, {"url": "https://github.com/anupamchugh/iowncode/tree/master/iOSNLPRottenTomatoes", "anchor_text": "Github Repository"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----12dfe2fc3308---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ios?source=post_page-----12dfe2fc3308---------------ios-----------------", "anchor_text": "IOS"}, {"url": "https://medium.com/tag/programming?source=post_page-----12dfe2fc3308---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----12dfe2fc3308---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/swiftui?source=post_page-----12dfe2fc3308---------------swiftui-----------------", "anchor_text": "Swiftui"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fbetter-programming%2F12dfe2fc3308&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&user=Anupam+Chugh&userId=9833cc01f515&source=-----12dfe2fc3308---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fbetter-programming%2F12dfe2fc3308&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&user=Anupam+Chugh&userId=9833cc01f515&source=-----12dfe2fc3308---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12dfe2fc3308&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://betterprogramming.pub/?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": "More from Better Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fbetter-programming%2F12dfe2fc3308&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&collection=Better+Programming&collectionId=d0b105d10f0a&source=post_page-----12dfe2fc3308---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://betterprogramming.pub/?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": "Read more from Better Programming"}, {"url": "https://medium.com/?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----12dfe2fc3308--------------------------------", "anchor_text": ""}, {"url": "https://anupamchugh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anupamchugh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anupam Chugh"}, {"url": "https://anupamchugh.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28K Followers"}, {"url": "http://linktr.ee/anupamchugh", "anchor_text": "linktr.ee/anupamchugh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9833cc01f515&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&user=Anupam+Chugh&userId=9833cc01f515&source=post_page-9833cc01f515--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faef2b78e9b90&operation=register&redirect=https%3A%2F%2Fbetterprogramming.pub%2Fclassifying-movie-reviews-with-natural-language-framework-12dfe2fc3308&newsletterV3=9833cc01f515&newsletterV3Id=aef2b78e9b90&user=Anupam+Chugh&userId=9833cc01f515&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}