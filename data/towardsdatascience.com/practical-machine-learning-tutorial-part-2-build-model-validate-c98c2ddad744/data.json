{"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744", "time": 1683015458.6912918, "path": "towardsdatascience.com/practical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744/", "webpage": {"metadata": {"title": "Practical Machine Learning Tutorial: Part.2 (Build Model & Validate) | by Ryan A. Mardani | Towards Data Science", "h1": "Practical Machine Learning Tutorial: Part.2 (Build Model & Validate)", "description": "In this part, we will build different models, validate them, and use the grid search approach to find out the optimum hyperparameters. This post is the second part of part1. You can find the jupyter\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-1-data-exploratory-analysis-c13d39b8f33b", "anchor_text": "part1", "paragraph_index": 0}, {"url": "https://github.com/mardani72/Practical_ML_Tutorial_Facies_examp/blob/main/part2_practical_Tut_ML_facies.ipynb", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/supervised_learning.html#supervised-learning", "anchor_text": "website", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)#:~:text=Cross%2Dvalidation%2C%20sometimes%20called%20rotation,to%20an%20independent%20data%20set.", "anchor_text": "Cross-validation", "paragraph_index": 6}, {"url": "https://towardsdatascience.com/bayesian-hyper-parameter-optimization-neural-networks-tensorflow-facies-prediction-example-f9c48d21f795", "anchor_text": "here", "paragraph_index": 13}], "all_paragraphs": ["In this part, we will build different models, validate them, and use the grid search approach to find out the optimum hyperparameters. This post is the second part of part1. You can find the jupyter notebook file of this part here.", "The concept of model building in ML projects of scikit-learn libraries is simple. First, you select what type of model you are comfortable with, second, fit the model to the data using target and predictors(features), and finally, predict the unknown labels using available feature data.", "In this project, we will use these classifiers to fit the feature data and then predict the facies classes. Here, we will not go into these algorithms' basic concepts. You may study on the scikit-learn website.", "1 \u2014 Logistic Regression Classifier 2 \u2014 K Neighbors Classifier3 \u2014 Decision Tree Classifier4 \u2014 Random Forest Classifier5 \u2014 Support Vector Classifier6 \u2014 Gaussian Naive Bayes Classifier7 \u2014 Gradient Boosting Classifier8 \u2014 Extra Tree Classifier", "The philosophy of constructing a baseline model is simple: we need a basic and simple model to see how the adjustments on both data and model parameters can cause improvement in model performance. In fact, this is like a scale for comparison.", "In this code script, we first defined our favorite model classifiers. Then, established baseline_model function. In this function, we employed the Pipeline function to implement step wised operation of data standard scaling(facilitate model running more efficient) and model object calling for cross-validation. I like Pipeline because it makes the codes more tidy and readable.", "Cross-validation sometimes called rotation estimation or out-of-sample testing is any of the various similar model validation techniques for assessing how the results of a statistical analysis will generalize to an independent data set. Models usually are overfitting when the accuracy score on training data is much higher than testing data. One way to examine model performance is to keep randomly some part of the dataset hold-out. This can be a weakness for small datasets. Another way is to divide the dataset into splits and run it while each split has a different set of test folds like the picture below. In this approach, cross-validation, models can examine all data without overfitting. However, for this project, we will keep a single well as a hold-out to examine model performances after all optimizations.", "We repeated 3 times each operation over a dataset that already divided into 10 equal parts(folds) in cross-validation. In fact, we intended to expose the model to all data with a different combination of train and test sets without overlap.", "Here, we used an average of accuracy as metrics for comparison of various model performances(accuracy and other evaluation metrics will be elaborated in the next post). It is used for simplicity, while for multi-class classification problems, accuracy is the weakest model evaluation approach. We will cover model evaluation metrics for multi-class classification problems in the next posts.", "The Extra tree and Random forest classifier showed the best accuracy score for the facies label prediction while the Gaussian Naive Bayes classifier performed poorly.", "In machine learning, model parameters can be divided into two main categories:A- Trainable parameters: such as weights in neural networks learned by training algorithms and the user does not interfere in the process,B- Hyper-parameters: users can set them before training operations such as learning rate or the number of dense layers in the model.", "Selecting the best hyper-parameters can be a tedious task if you try it by hand and it is almost impossible to find the best ones if you are dealing with more than two parameters.", "One way is a random search approach. In fact, instead of using organized parameter searching, it will go through a random combination of parameters and look for the optimized ones. You may estimate that chance of success decreases to zero for larger hyper-parameter tuning.", "Another way is to use skopt which is a scikit-learn library and uses Bayesian optimization that constructs another model of search-space for parameters. Gaussian Process is one kind of these models. This generates an estimate of how model performance varies with hyper-parameter changes. If you are interested in this approach, I have done an example for this data set, here. I will not repeat this process here because it is almost a big project.", "This approach is to divide each parameter into a valid evenly range and then simply ask the computer to loop for the combination of parameters and calculate the results. The method is called Grid Search. Although it is done by machine, it will be a time-consuming process. Suppose you have 3 hyper-parameters with 10 possible values in each. In this approach, you will run 1\u2070\u00b3 models (even with a reasonable training datasets size, this task is big).", "You may see in the block code below that Gaussian Naive Bays is not involved because this classifier does not have a hyper-parameter that can strongly affect the model performance.", "The run time for the code above is almost an hour(depending on your computer configuration). I did not expand the grid search size for operation time-saving. You may extend for more than 2 by 2 parameters to search but expect that running time will be exponentially increased.", "From line 69 in the code, you can see the best hyper-parameters that have been chosen for each classifier. Using these parameters, we can build these models with optimum hyper-parameters and run for the accuracy test.", "Comparing with baseline model performances(results of first block codes in this post), hyper-parameters adjustment could help model performance to improve. It seems that for ensemble models hyper-parameters are not as efficient as the rests. Some drawbacks in the hyper-parameterized models comparing to baseline mean that we did not properly design the search range.", "In this part, we constructed eight models with default parameters, ran cross-validation. Then, we looked for hyper-parameters using the grid search approach. The best hyper-parameters are employed to build the model again and comparing the basic model we can see improvement in model performances.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc98c2ddad744&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mardani.a?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": "Ryan A. Mardani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb36223c810e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&user=Ryan+A.+Mardani&userId=b36223c810e6&source=post_page-b36223c810e6----c98c2ddad744---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc98c2ddad744&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc98c2ddad744&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-1-data-exploratory-analysis-c13d39b8f33b", "anchor_text": "part1"}, {"url": "https://github.com/mardani72/Practical_ML_Tutorial_Facies_examp/blob/main/part2_practical_Tut_ML_facies.ipynb", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/supervised_learning.html#supervised-learning", "anchor_text": "website"}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)#:~:text=Cross%2Dvalidation%2C%20sometimes%20called%20rotation,to%20an%20independent%20data%20set.", "anchor_text": "Cross-validation"}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html", "anchor_text": "scikit-learn"}, {"url": "https://towardsdatascience.com/bayesian-hyper-parameter-optimization-neural-networks-tensorflow-facies-prediction-example-f9c48d21f795", "anchor_text": "here"}, {"url": "https://medium.com/tag/multiclass-classification?source=post_page-----c98c2ddad744---------------multiclass_classification-----------------", "anchor_text": "Multiclass Classification"}, {"url": "https://medium.com/tag/model-validation?source=post_page-----c98c2ddad744---------------model_validation-----------------", "anchor_text": "Model Validation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c98c2ddad744---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----c98c2ddad744---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/facies?source=post_page-----c98c2ddad744---------------facies-----------------", "anchor_text": "Facies"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc98c2ddad744&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&user=Ryan+A.+Mardani&userId=b36223c810e6&source=-----c98c2ddad744---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc98c2ddad744&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&user=Ryan+A.+Mardani&userId=b36223c810e6&source=-----c98c2ddad744---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc98c2ddad744&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc98c2ddad744&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c98c2ddad744---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c98c2ddad744--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c98c2ddad744--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c98c2ddad744--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c98c2ddad744--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ryan A. Mardani"}, {"url": "https://medium.com/@mardani.a/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "388 Followers"}, {"url": "http://www.dataenergy.ca", "anchor_text": "www.dataenergy.ca"}, {"url": "http://linkedin.com/in/amardani", "anchor_text": "linkedin.com/in/amardani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb36223c810e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&user=Ryan+A.+Mardani&userId=b36223c810e6&source=post_page-b36223c810e6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7a39952b3ca1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744&newsletterV3=b36223c810e6&newsletterV3Id=7a39952b3ca1&user=Ryan+A.+Mardani&userId=b36223c810e6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}