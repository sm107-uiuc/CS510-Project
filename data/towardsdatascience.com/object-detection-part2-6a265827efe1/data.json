{"url": "https://towardsdatascience.com/object-detection-part2-6a265827efe1", "time": 1682994585.503969, "path": "towardsdatascience.com/object-detection-part2-6a265827efe1/", "webpage": {"metadata": {"title": "A Comprehensive Guide To Object Detection Using YOLO Framework \u2014 Part II | by Pratheesh Shivaprasad | Towards Data Science", "h1": "A Comprehensive Guide To Object Detection Using YOLO Framework \u2014 Part II", "description": "In the last part, we understood what YOLO is and how it works. In this section, let us understand how to apply it using pre-trained weights and obtaining the results. This article is greatly inspired\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.coursera.org/specializations/deep-learning", "anchor_text": "Andrew Ng\u2019s Deep Learning Specialization", "paragraph_index": 0}, {"url": "https://github.com/enggen/Deep-Learning-Coursera", "anchor_text": "Andrew Ng\u2019s Github Repository", "paragraph_index": 1}, {"url": "https://drive.google.com/open?id=1j3N1Tp112CfDzRchwa3d-D2zksChMVtY", "anchor_text": "zip file", "paragraph_index": 1}, {"url": "https://github.com/iampratheesh/Object-Detection-YOLO", "anchor_text": "link", "paragraph_index": 1}, {"url": "http://linkedin.com/in/pratheesh-s", "anchor_text": "linkedin.com/in/pratheesh-s", "paragraph_index": 30}], "all_paragraphs": ["In the last part, we understood what YOLO is and how it works. In this section, let us understand how to apply it using pre-trained weights and obtaining the results. This article is greatly inspired by Andrew Ng\u2019s Deep Learning Specialization course. I\u2019ve also tried to gather information from various other articles/resources to make the concept easier to understand.", "Now it\u2019s time to implement what we\u2019ve understood using Python. You can do this with the help of a Jupyter Notebook (or any other IDE of your choice). The implementation of YOLO has been taken from Andrew Ng\u2019s Github Repository. You\u2019ll also have to download this zip file which contains the pre-trained weights and packages to implement YOLO. Here\u2019s a link to my GitHub repository where you can find the Jupyter Notebook.", "I\u2019ve tried to comment on as many lines of code as possible for better understanding.", "Let us first import all the required libraries.", "First, we are going to apply a filter by thresholding. We can do this by getting rid of those boxes which have a score less than the chosen threshold.", "The model contains 80 different classes for detection. It gives a total of 19x19x5x85 numbers where:", "Now we are going to implement IoU. This will be used to evaluate the bounding boxes.", "We will be defining a box using its two corners (upper left and lower right). The coordinates can be named as (x1,y1,x2,y2).", "We will also have to find out the coordinates of the intersection of two boxes.", "xi1: maximum of the x1 coordinates of the two boxes.", "yi1: maximum of the y1 coordinates of the two boxes.", "xi2: minimum of the x2 coordinates of the two boxes.", "yi2: minimum of the y2 coordinates of the two boxes.", "The area of the rectangle formed after intersection can be calculated using the formula: (xi2 \u2014 xi1)*(yi2 \u2014 yi1)", "The formula for finding IoU is:", "Now let us define a function to calculate IoU.", "Next, we will be implementing non-max suppression to remove all the duplicate bounding boxes for the same object. The steps involved are:", "Now it\u2019s time to implement a function that takes the output of deep CNN and then filters the boxes using the above functions.", "Note that there are a few ways by which a bounding box can be represented i.e via their corners or their midpoints and height/width. YOLO converts between a few such formats for which there is a function named \u201cyolo_boxes_to_corners\u201d.", "Also, YOLO was trained on images of 608 x 608 dimensions. If the images we provide have a dimension greater than or less than the original dimension (on which YOLO was trained) then we will have to rescale the bounding boxes accordingly to fit on the image. We will be using a function called \u201cscale_boxes\u201d for this purpose.", "Now we\u2019re going to test the YOLO pre-trained models on images. For this, we have to create a session. Also, remember that we\u2019re trying to detect 80 classes and using 5 anchor boxes. We have all the class information in \u201ccoco_classes.txt\u201d and \u201cyolo_anchors.txt\u201d which must be present in the zip file you downloaded before inside the folder \u201cmodel_data\u201d.", "The training of the YOLO model takes a long time especially if you don\u2019t have a high spec system. So we are going to load an existing pre-trained Keras YOLO model stored in \u201cyolo.h5\u201d. These are the pre-trained weights from the YOLOv2 model.", "Let's create a session and load these files.", "Note: In some cases, a warning pops up while loading the weights. If that\u2019s the case then just ignore the warning.", "So far we have created a session graph that is given to yolo_model to compute output, processed by yolo_head, and goes through a filtering function yolo_eval.", "Now we have to implement a function that runs the graph to test YOLO on an image.", "Run the following cell on your test image to see the results.", "Thanks a lot if you\u2019ve made this far. Please do note that the results may or may not be the same if you use the same image for detection. You can further customize the maximum number of bounding boxes per image, threshold values, etc. to obtain better results.", "If you have any suggestions to make this blog better, please do mention in the comments. I will try to make the changes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Python Developer. Machine Learning and Deep Learning Enthusiast. LinkedIn: linkedin.com/in/pratheesh-s"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6a265827efe1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a265827efe1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a265827efe1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Pratheesh_S?source=post_page-----6a265827efe1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=post_page-----6a265827efe1--------------------------------", "anchor_text": "Pratheesh Shivaprasad"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd04fc11ce21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=post_page-d04fc11ce21----6a265827efe1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a265827efe1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a265827efe1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.coursera.org/specializations/deep-learning", "anchor_text": "Andrew Ng\u2019s Deep Learning Specialization"}, {"url": "https://github.com/enggen/Deep-Learning-Coursera", "anchor_text": "Andrew Ng\u2019s Github Repository"}, {"url": "https://drive.google.com/open?id=1j3N1Tp112CfDzRchwa3d-D2zksChMVtY", "anchor_text": "zip file"}, {"url": "https://github.com/iampratheesh/Object-Detection-YOLO", "anchor_text": "link"}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Redmon_You_Only_Look_CVPR_2016_paper.pdf", "anchor_text": "You Only Look Once: Unified, Real-Time Object Detection"}, {"url": "https://www.coursera.org/learn/convolutional-neural-networks?specialization=deep-learning", "anchor_text": "Coursera-Convolutional Neural Network"}, {"url": "https://www.analyticsvidhya.com/blog/2018/06/understanding-building-object-detection-model-python/", "anchor_text": "Understanding and Building an Object Detection Model from scratch in Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6a265827efe1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6a265827efe1---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----6a265827efe1---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/yolo?source=post_page-----6a265827efe1---------------yolo-----------------", "anchor_text": "Yolo"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----6a265827efe1---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a265827efe1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=-----6a265827efe1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a265827efe1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=-----6a265827efe1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a265827efe1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a265827efe1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6a265827efe1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6a265827efe1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a265827efe1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6a265827efe1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6a265827efe1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6a265827efe1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6a265827efe1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6a265827efe1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6a265827efe1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6a265827efe1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pratheesh Shivaprasad"}, {"url": "https://medium.com/@Pratheesh_S/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "87 Followers"}, {"url": "http://linkedin.com/in/pratheesh-s", "anchor_text": "linkedin.com/in/pratheesh-s"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd04fc11ce21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=post_page-d04fc11ce21--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6d65ea666fc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-part2-6a265827efe1&newsletterV3=d04fc11ce21&newsletterV3Id=6d65ea666fc8&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}