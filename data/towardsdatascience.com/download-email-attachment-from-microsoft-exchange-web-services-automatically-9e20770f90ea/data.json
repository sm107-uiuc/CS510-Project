{"url": "https://towardsdatascience.com/download-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea", "time": 1683002881.205826, "path": "towardsdatascience.com/download-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea/", "webpage": {"metadata": {"title": "Download Email Attachment from Microsoft Exchange Web Services Automatically | by Joshua Yeung | Towards Data Science", "h1": "Download Email Attachment from Microsoft Exchange Web Services Automatically", "description": "Did you need to download email attachments regularly? Do you want to automate this boring process? I know that feel bro. When I first come to my job, I was assigned a daily task: download the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@joshua.chyeung/membership", "anchor_text": "https://medium.com/@joshua.chyeung/membership", "paragraph_index": 17}], "all_paragraphs": ["Did you need to download email attachments regularly? Do you want to automate this boring process? I know that feel bro. When I first come to my job, I was assigned a daily task: download the attached report from the email sent to our team every day. It\u2019s not a difficult task, but it\u2019s extremely boring and I often forget to do so.", "How can I get rid of this dummy task: Downloading email attachments regularly.", "After researching the internet I discovered that a little Python script could take over my work. Let\u2019s explore what Python can help us.", "Exchangelib, a Python library that provides a simple interface that allows Python scripts to interact with Microsoft Exchange or Exchange Web Services (EWS)", "You can install this package from PyPI:", "And then you import package following the instruction of the official site. You may not use all of them,", "The next step is to specify your credentials, that is the login username and the password", "You have to config the mail server of course. Exchangelib should be able to identify the authentication type used by your email server, but in my case, it failed and I specified the authentication type to NTLM.", "Now you have an Account object and you can navigator through it. It just follows your email account folder structure. For example, if you want to operate on the inbox folder, just use this simple syntax: account.inbox. To operate a folder inside the inbox, just put a backslash and single quote like this: account.inbox / 'some_folder'.", "If you just want to download all the attachments in a folder, this shortcode would help. You may require os package to process local directory.", "If I just want to download the files that I haven\u2019t downloaded before, what can I do further? I need a mechanism to check if the attachment exists locally.", "Our team uses an FTP server to store all the attached reports. Thus in my Python script, first of all, I log in to the FTP server and list all files with the specified prefix. A checking is added to the script to determine whether this file exists in the current file list or not.", "To do so, I used ftplib, a library of FTP protocol client.", "The following code logins to the FTP server (ftp.login()), navigate the target folder (ftp.cwd()) and list all files (ftp.nlst()) that matched the specified prefix (file.startswith())", "After downloading the attachments locally, I upload the files to the FTP server. I use storbinary to send STOR command to upload the attachments.", "I automated this daily routine using a simple Python script that can be scheduled to run regularly. The script automates the workflow that downloads missing attachments from the mail server and uploads them to the FTP server.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer building highly available and scalable applications | Become a Medium Member by Clicking here: https://medium.com/@joshua.chyeung/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9e20770f90ea&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@joshua.chyeung?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joshua.chyeung?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": "Joshua Yeung"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3162e66330d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&user=Joshua+Yeung&userId=3162e66330d1&source=post_page-3162e66330d1----9e20770f90ea---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e20770f90ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e20770f90ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@webaroo?utm_source=medium&utm_medium=referral", "anchor_text": "Webaroo.com.au"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/nylas/exchangelib", "anchor_text": "nylas/exchangelibThis module provides an well-performing, well-behaving, platform-independent and simple interface for communicating\u2026github.com"}, {"url": "https://docs.python.org/3/library/ftplib.html", "anchor_text": "ftplib \u2014 FTP protocol client \u2014 Python 3.8.1 documentationSource code: Lib/ftplib.py This module defines the class and a few related items. The class implements the client side\u2026docs.python.org"}, {"url": "https://medium.com/tag/productivity?source=post_page-----9e20770f90ea---------------productivity-----------------", "anchor_text": "Productivity"}, {"url": "https://medium.com/tag/technology?source=post_page-----9e20770f90ea---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/python?source=post_page-----9e20770f90ea---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/automation?source=post_page-----9e20770f90ea---------------automation-----------------", "anchor_text": "Automation"}, {"url": "https://medium.com/tag/email?source=post_page-----9e20770f90ea---------------email-----------------", "anchor_text": "Email"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e20770f90ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&user=Joshua+Yeung&userId=3162e66330d1&source=-----9e20770f90ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e20770f90ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&user=Joshua+Yeung&userId=3162e66330d1&source=-----9e20770f90ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e20770f90ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9e20770f90ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9e20770f90ea---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9e20770f90ea--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9e20770f90ea--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9e20770f90ea--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9e20770f90ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joshua.chyeung?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joshua.chyeung?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Joshua Yeung"}, {"url": "https://medium.com/@joshua.chyeung/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "325 Followers"}, {"url": "https://medium.com/@joshua.chyeung/membership", "anchor_text": "https://medium.com/@joshua.chyeung/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3162e66330d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&user=Joshua+Yeung&userId=3162e66330d1&source=post_page-3162e66330d1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6a9abcf4141e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdownload-email-attachment-from-microsoft-exchange-web-services-automatically-9e20770f90ea&newsletterV3=3162e66330d1&newsletterV3Id=6a9abcf4141e&user=Joshua+Yeung&userId=3162e66330d1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}