{"url": "https://towardsdatascience.com/create-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718", "time": 1683007150.9228742, "path": "towardsdatascience.com/create-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718/", "webpage": {"metadata": {"title": "Create A Synthetic Image Dataset \u2014 The \u201cWhat\u201d, The \u201cWhy\u201d and The \u201cHow\u201d | by Viraf | Towards Data Science", "h1": "Create A Synthetic Image Dataset \u2014 The \u201cWhat\u201d, The \u201cWhy\u201d and The \u201cHow\u201d", "description": "Create synthetic image datasets with data augmentations to increase your dataset size using image composition techniques in python."}, "outgoing_paragraph_urls": [{"url": "http://news.mit.edu/2017/artificial-data-give-same-results-as-real-data-0303", "anchor_text": "papers", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/master-the-coco-dataset-for-semantic-image-segmentation-part-1-of-2-732712631047", "anchor_text": "COCO", "paragraph_index": 7}, {"url": "https://www.pexels.com/", "anchor_text": "pexels", "paragraph_index": 10}, {"url": "http://flickr.com", "anchor_text": "flickr", "paragraph_index": 10}, {"url": "http://unsplash.com", "anchor_text": "unsplash", "paragraph_index": 10}, {"url": "https://www.adobe.com/in/products/photoshop.html?promoid=PC1PQQ5T&mv=other", "anchor_text": "Photoshop", "paragraph_index": 12}, {"url": "https://www.gimp.org/", "anchor_text": "GIMP", "paragraph_index": 12}, {"url": "http://cocodataset.org", "anchor_text": "COCO", "paragraph_index": 15}, {"url": "https://github.com/virafpatrawala/Synthetic-Image-Datasets", "anchor_text": "GitHub repository", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/master-the-coco-dataset-for-semantic-image-segmentation-part-1-of-2-732712631047", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://github.com/virafpatrawala/Synthetic-Image-Datasets", "anchor_text": "GitHub repository", "paragraph_index": 29}, {"url": "https://blog.stratospark.com/generating-synthetic-data-image-segmentation-unity-pytorch-fastai.html", "anchor_text": "tutorial", "paragraph_index": 30}], "all_paragraphs": ["It is quite a known fact that the quality and quantity of dataset used to train your model will have a direct effect on the model\u2019s performance. Availability of an extensive, versatile dataset could seal the deal, and you could jump to the next step of your Machine Learning / Deep Learning pipeline. But often you might end up in a situation where the dataset you need is just not readily available. Or the data you have is not enough to train a heavy duty model. Now what do you do?", "There are so many resources out there that can help you create a new custom dataset of any object class you need. But if I had to describe the process of building a dataset in one word, I\u2019d call it \u201ccumbersome\u201d and \u201ctime-consuming\u201d and \u201cfrustrating\u201d and \u2014 I know I used more than one word, but you get the point!", "Especially when it comes to drawing segmentation masks, I just can\u2019t be bothered to annotate any more than a few images! Don\u2019t get me wrong, I know dataset creation is a very very very important step, but isn\u2019t there a way out?", "Data augmentation is a great way to increase the variety of the dataset that your model sees, but again, there is a limit to how much it can help. How about we take it a step further?", "Creating any kind of data (image, audio, text, etc.) \u2018artificially\u2019 or \u2018programatically\u2019 results in what we call a synthetic dataset. This data is not collected naturally or normally and labelled manually, so is it safe to use it to train your model? Will it give good results?", "While there are many papers claiming that carefully created synthetic data can give a performance at par with natural data, I recommend having a healthy mixture of the two. A well designed synthetic dataset can take the concept of data augmentations to the next level, and gives the model an even larger variety of training data. The more the better right?", "There are several ways out there to create synthetic image datasets, and in this tutorial, let\u2019s look at one of the most basic method \u2014 Image Composition. We will generate new images by composing the object image as a foreground on multiple background images.", "In this tutorial, I am going to create synthetic images for the output class \u201cdog\u201d. In reality, there are many existing datasets online that include the dog class (for example, COCO), but what\u2019s the harm in creating more pictures of these cute gifts of nature. :P", "Have a look at the import statements below. Install any module you might not already have.", "There are 2 ways to go about this \u2014", "First, let\u2019s take an image of a dog available on the internet. There are several websites out there which allow you to use the images for free like \u2014 pexels, flickr, unsplash \u2014 take your pick. I\u2019m going to use the one below.", "Next, you will have to put in a little manual effort to separate the dog from the background. Yeah, I\u2019m sorry \u2014 there are no free meals. But eventually this is definitely lesser effort than creating an entire dataset, I promise.", "A few tools that I know of to get this job done are Photoshop (paid) or GIMP (free). Or you could even use the ever-dependable Microsoft Paint! The final output looks like the one below.", "Read the image. Next, cut out the foreground layer from this image and set the remaining pixels to zero. An alternative to coding this step is to add a black background with the tool you used (GIMP/Paint/Photoshop) while segmenting the image itself. But nonetheless, here\u2019s how to extract the foreground object in python \u2014 simple thresholding of pixels.", "If you don\u2019t want to start from scratch, another option is to make use of the images from an already available dataset.", "I am going to use the COCO dataset here to demonstrate. Since COCO already has the object category \u201cdog\u201d, it will be easy to retrieve the image and its mask. The COCO dataset has 4385 (train) and 177 (val) images for the \u201cdog\u201d category.", "You can refer to the entire code for this process in my GitHub repository for this tutorial. I will not be going over the code for this step in this post.", "If you are interested in manipulating the COCO image dataset and creating a data generator to train your model for Image Segmentation, I have an extensive tutorial here.", "Let\u2019s play a bit with the dog (pun intended). I have used random rotations, random zoom, random translations and random horizontal flips in my code, but you can use something else too.", "The output of the code is shown below. See how different it looks from the original image!", "After applying all these changes to the foreground, let\u2019s extract the segmentation mask from the image.", "Now you need a new background image. Use the free websites I mentioned earlier to get a wide variety of backgrounds. You can choose any image in the world (see how I sent my dog to the moon in the display picture of this article), but I recommend keeping it as realistic as possible.", "I am going to use these 4 images as my backgrounds for this tutorial.", "Let\u2019s select a background at random.", "It\u2019s time to add your dog image to the background!", "This function gives the following output. Now, I know it\u2019s not perfect, but it\u2019s quite good!", "For object localization tasks, you can also get the box coordinates easily from the new segmentation mask we developed.", "And on performing these functions in a loop with all the backgrounds, we get a nice set of images!", "In this tutorial, I used 1 foreground with 4 backgrounds. If you use multiple foregrounds in random with multiple backgrounds, you can create many, many images! Maybe you could merge two or more foregrounds on a background as well. Get creative \u2014 play with sizes, angles, foregrounds, and backgrounds to build an awesome synthetic dataset according to your needs. There are a lot of design considerations here as well, but with a little effort you can do much more and create more accurate datasets.", "Finally, you can find the entire code for this tutorial in my GitHub repository.", "As a next step on this topic, check out this nice tutorial on creating synthetic image datasets with Unity 3D.", "Well, that\u2019s it for now \u2014 thank you for reading this far into the article. I hope something good came out of it. Any thoughts, questions, comments? Let me know in the responses below!", "If you are interested in image datasets for semantic segmentation, check out my post below:", "Or do you want to be rich overnight using ML in stocks? This article is (NOT) for you!", "Can an ML model literally read the stock price charts?", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff820e6b6f718&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@virafpatrawala?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@virafpatrawala?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": "Viraf"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31356c339457&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&user=Viraf&userId=31356c339457&source=post_page-31356c339457----f820e6b6f718---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff820e6b6f718&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff820e6b6f718&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@wildlittlethingsphoto?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Helena Lopes"}, {"url": "https://www.pexels.com/@pixabay?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pixabay"}, {"url": "https://www.pexels.com/photo/astronaut-standing-beside-american-flag-on-the-moon-39896/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "http://news.mit.edu/2017/artificial-data-give-same-results-as-real-data-0303", "anchor_text": "papers"}, {"url": "https://towardsdatascience.com/master-the-coco-dataset-for-semantic-image-segmentation-part-1-of-2-732712631047", "anchor_text": "COCO"}, {"url": "https://www.pexels.com/", "anchor_text": "pexels"}, {"url": "http://flickr.com", "anchor_text": "flickr"}, {"url": "http://unsplash.com", "anchor_text": "unsplash"}, {"url": "https://www.pexels.com/@bertellifotografia?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Matheus Bertelli"}, {"url": "https://www.pexels.com/photo/brown-dog-running-on-grassy-field-1906153/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://www.adobe.com/in/products/photoshop.html?promoid=PC1PQQ5T&mv=other", "anchor_text": "Photoshop"}, {"url": "https://www.gimp.org/", "anchor_text": "GIMP"}, {"url": "http://cocodataset.org", "anchor_text": "COCO"}, {"url": "https://github.com/virafpatrawala/Synthetic-Image-Datasets", "anchor_text": "GitHub repository"}, {"url": "https://towardsdatascience.com/master-the-coco-dataset-for-semantic-image-segmentation-part-1-of-2-732712631047", "anchor_text": "here"}, {"url": "https://www.pexels.com/@creative-vix?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Creative Vix"}, {"url": "https://www.pexels.com/@pixabay?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pixabay"}, {"url": "https://www.pexels.com/@mastercowley?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Nathan Cowley"}, {"url": "https://www.pexels.com/photo/garden-7283/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://github.com/virafpatrawala/Synthetic-Image-Datasets", "anchor_text": "GitHub repository"}, {"url": "https://blog.stratospark.com/generating-synthetic-data-image-segmentation-unity-pytorch-fastai.html", "anchor_text": "tutorial"}, {"url": "https://towardsdatascience.com/master-the-coco-dataset-for-semantic-image-segmentation-part-1-of-2-732712631047", "anchor_text": "Master the COCO Dataset for Semantic Image SegmentationExplore and manipulate the COCO image dataset for Semantic Image Segmentation with PyCoco, Tensorflow Keras Python\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-not-to-predict-stock-prices-with-lstms-a51f564ccbca", "anchor_text": "How (NOT) To Predict Stock Prices With LSTMsStocks and Machine Learning \u2014 a combination made in heaven. But are things as easy as they appear to be?towardsdatascience.com"}, {"url": "https://towardsdatascience.com/can-an-ml-model-read-stock-charts-and-predict-prices-fb73c551c7a4", "anchor_text": "Can a Machine Learning Model Read Stock Charts and Predict Prices?Stocks and Machine Learning \u2014 a match made in heaven. What if your ML model could literally read the price chart\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/synthetic-datasets?source=post_page-----f820e6b6f718---------------synthetic_datasets-----------------", "anchor_text": "Synthetic Datasets"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f820e6b6f718---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/image-dataset?source=post_page-----f820e6b6f718---------------image_dataset-----------------", "anchor_text": "Image Dataset"}, {"url": "https://medium.com/tag/python?source=post_page-----f820e6b6f718---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-creation?source=post_page-----f820e6b6f718---------------data_creation-----------------", "anchor_text": "Data Creation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff820e6b6f718&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&user=Viraf&userId=31356c339457&source=-----f820e6b6f718---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff820e6b6f718&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&user=Viraf&userId=31356c339457&source=-----f820e6b6f718---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff820e6b6f718&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff820e6b6f718&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f820e6b6f718---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f820e6b6f718--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f820e6b6f718--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f820e6b6f718--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f820e6b6f718--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@virafpatrawala?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@virafpatrawala?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Viraf"}, {"url": "https://medium.com/@virafpatrawala/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "179 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31356c339457&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&user=Viraf&userId=31356c339457&source=post_page-31356c339457--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4d42ab23ec8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-synthetic-image-dataset-the-what-the-why-and-the-how-f820e6b6f718&newsletterV3=31356c339457&newsletterV3Id=4d42ab23ec8e&user=Viraf&userId=31356c339457&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}