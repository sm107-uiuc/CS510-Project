{"url": "https://towardsdatascience.com/gaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833", "time": 1683015919.7350788, "path": "towardsdatascience.com/gaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833/", "webpage": {"metadata": {"title": "Gaussian Processes: Smarter Tuning for Your ML Models | by Paul May | Towards Data Science", "h1": "Gaussian Processes: Smarter Tuning for Your ML Models", "description": "I think we have all been there. We have a baseline machine learning model, but its performance is just not quite there. Luckily lots of machine learning algorithms have lots of knobs and switches you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.model_selection", "anchor_text": "SciKit learn has several", "paragraph_index": 1}, {"url": "https://scikit-optimize.github.io/stable/", "anchor_text": "Scikit-Optimize", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian distribution", "paragraph_index": 17}, {"url": "https://ora.ox.ac.uk/objects/uuid:1418c926-6636-4d96-8bf6-5d94240f3d1f", "anchor_text": "Bayesian Gaussian processes for sequential prediction, optimisation and quadrature", "paragraph_index": 36}, {"url": "https://www.cs.cornell.edu/courses/cs4787/2019sp/notes/lecture16.pdf", "anchor_text": "Cornell University: Lecture 16: Gaussian Processes and Bayesian Optimization", "paragraph_index": 37}, {"url": "https://towardsdatascience.com/the-intuitions-behind-bayesian-optimization-with-gaussian-processes-7e00fcc898a0", "anchor_text": "The intuitions behind Bayesian Optimization with Gaussian Processes", "paragraph_index": 38}, {"url": "https://scikit-optimize.github.io/stable/modules/generated/skopt.BayesSearchCV.html?highlight=bayessearchcv#skopt.BayesSearchCV", "anchor_text": "BayesSearchCV", "paragraph_index": 39}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html", "anchor_text": "gbrtclassifier", "paragraph_index": 40}], "all_paragraphs": ["I think we have all been there. We have a baseline machine learning model, but its performance is just not quite there. Luckily lots of machine learning algorithms have lots of knobs and switches you can use to tune it to perform better (such as the depth of trees you build in your random forests, or the learning rate of your gradient boosted algorithm).", "There exist multiple existing functions to help you perform this tuning and SciKit learn has several (only high level explanations, but links given):", "If you\u2019re anything like me you have probably been using your own experience to constrain the parameter spaces to the areas you think are likely to give good results and then use GridSearchCV if the combinations are small, otherwise maybe use RandomizedSearchCV to get the best combinations you can find for the time you have left.", "Often, I find that a lot of projects I do are completely new and blue skies, so the datasets are incomplete, fragmented and very dirty. This means that the adage that data science is \u201c80% data cleaning and 20% everything else\u201d is often true in my case. When models are computationally expensive to train a large parameter search of 10,000\u2019s of combinations (or even 100\u2019s) is just not practical to meet delivery deadlines.", "I am glad you asked. You may or may not have seen information about using Scikit-Optimize, but if you haven\u2019t or you aren\u2019t sure how to use it to tune your models then read on.", "At its heart it is a set of functions that enable you to model problems that are expensive to evaluate. This expense can be either because it takes so long to get a result for a combination of parameters, or the problem is computationally expensive to exhaustively solve.", "Within my working life I have used it for both problems.", "For the problem of \u201cexcessive wait time to evaluate each combination\u201d it was used to collect data to build a machine learning model for a manufacturing line. Each time the algorithm suggested a new set of parameters to try it would take such a long time to return the result (line needs to reach steady state, then someone needs to remove a sample, take it to the testing laboratory and run the test to analyse the product output further increasing the wait) that only so many datapoints can be taken due to the cost of taking the measurement. We used this solution to take the most valuable datapoints we could due to this limitation.", "The second usage (cannot test every combination possible) I will talk about which is that to try ever combination of parameters for tuning a model is just too computationally expensive and I would die of old age.", "SciKit Optimise provides lots of tools for you, but I will concentrate on the one I use the most which is gp_minimize. Its main description is given as \u201cBayesian optimization using Gaussian Processes\u201d, which does the marvellous task of only explaining what it is to someone who already knows what it is.", "At a high level, if you know the underlying distribution you are getting from the data you can predict the probability of certain events occurring. If you have a uniform distribution then you know any value in the range specified is equally likely, but in life this is not always the case. If I were throwing darts at a bullseye you would expect that most of my hits might be nearer to the bullseye than far away. But maybe I am not the best shot and I always tend to hit a certain spot more than the bullseye. So how can we tell?", "If I took 100 shots and we just measured the distance horizontally from the bullseye and made a histogram we might get a picture like this.", "From this is might be somewhat hard to determine where we think I am likely to hit again. But if we fit a distribution to it the graph changes to this:", "Visually it becomes a lot clearer to the user. Also, because we know the maths of the distribution is defined, we can interrogate it not only about where my average is, but also the spread of my shots.", "It is useful to say that if maybe I had taken 1000 shots the graph would look like this:", "The fitted distribution is a lot more accurate, but you could also say that you do not need it to visually interrogate what shape you are getting.", "So what shape are you using?", "I\u2019m using a Gaussian distribution. This is a commonly used distribution as not only is it much easier to use than others but a lot of processes in nature can be modelled as such.", "What has this got to do with anything?", "Okay, okay. So the key point here is that for the graph of 100 points compared to 1000 points, fitting a distribution made it much easier for you to see what was going on and arguably with it you could do a pretty good job at estimating the real values with 900 less datapoints than the 1000 point graph. We are fitting a distribution to our data to indicate to us where we think the most likely points are.", "Gaussian Process enables you to extract as much information you can for the minimum amount of data you can stand to take", "1. Take an initial set of datapoints", "2. Fit a distribution to it (in this case Gaussian)", "3. Read off the resulting area that you think will be at the maximum of your distribution", "4. Test it and return the result", "5. Refit the distribution to your data again including this new point", "6. Go back to step 3", "In machine learning we could take the number of trees used to build a random forest. We test several different parameters, calculate the accuracy of the trained model, and return these. The Gaussian Process will fit to these points and try to work out which value of trees give you the largest accuracy and ask you to try it. This results in 2 outcomes:", "\u00b7 If the accuracy increases, then the Gaussian fit will get sharper", "\u00b7 If it is wrong, then the fit will flatten, and it will start looking further away", "As we add in hyper parameters, we start adding more dimensions and we can imagine for two parameters we end up with a plot showing the accuracy of the model that looks like this:", "In this example we might have more than one area that shows improvement in the model performance. The great strength of this process is it has the capability of mapping this out in an intelligent way.", "We can look at some examples (taken from here) to show this fitting process.", "Here we can see that is exploring the space and as it reached the first minima it took several samples to establish it and then continued exploring where it thought it might get a better result. At the end of the process it will give you the best point it found in the process.", "In model tuning this would be the best set of parameters for the model given the search restrictions you gave it.", "If you want to read more about the mathematics of this I would suggest:", "\u00b7 Bayesian Gaussian processes for sequential prediction, optimisation and quadrature", "\u00b7 Cornell University: Lecture 16: Gaussian Processes and Bayesian Optimization", "\u00b7 The intuitions behind Bayesian Optimization with Gaussian Processes", "After that exceedingly long primer, we can have a look at some code. We are very lucky in that an easy to implementation of this for tuning machine learning models already exists (BayesSearchCV).", "Firstly we need to import the required modules and the ML algorithm we want to fit (I\u2019m using a gbrtclassifier).", "BayesSearchCV does the heavy lifting here. It functions like a pipeline taking all the parameter values you want to search (and how you\u2019ve set them), the machine learning algorithm you want to tune and has a wealth of other settings you can change.", "Here we pass the algorithm and for each hyper parameter space we can define the range (one example is dynamic, as \u2018n_data\u2019 is the number of rows of training data) and what sort of range it is such as discrete, float and even categorical. This tells the gaussian process how it can explore this space. \u201cn_iter\u201d tells it how many points it can sample. I usually find I start getting good results after 30+ points. Part of this is determined by the complexity of the problem, but also on how many random samples you take at the start (by default it does 10 random ones to provide an initial fit).", "You have now fitted and tuned a machine learning algorithm with only a few lines of code. If you have defined the problem, well (which parameters and ranges etc.) you should get superior results much quicker (and few samplings) than if you tried every single combination from scratch.", "This pre-built function is not the only thing you can do. It is possible to define your own objectives to minimise over. This is very interesting as you can then use it to perform optimisation on very complicated problems.", "For example, if you were not interested in the pure score of the machine learning algorithm, but in how it affects another function, you could write an objective function that returns this. The basic rule is that if you can condense it down to one value to return to the gaussian process you can probably write a function to minimise for it.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, Astrophysics PhD, reliability engineer and part time writer. I love exploring the world of science and how it shapes the world we live in."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc72c7d4f5833&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Carnivalius?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Carnivalius?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": "Paul May"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F554601a151c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&user=Paul+May&userId=554601a151c6&source=post_page-554601a151c6----c72c7d4f5833---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc72c7d4f5833&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc72c7d4f5833&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://en.wikipedia.org/wiki/Gaussian_process", "anchor_text": "Gaussian Processes"}, {"url": "https://unsplash.com/@olav_ahrens?utm_source=medium&utm_medium=referral", "anchor_text": "Olav Ahrens R\u00f8tne"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.model_selection", "anchor_text": "SciKit learn has several"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "GridSearchCV"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.ParameterGrid.html#sklearn.model_selection.ParameterGrid", "anchor_text": "ParameterGrid"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.ParameterSampler.html#sklearn.model_selection.ParameterSampler", "anchor_text": "ParameterSampler"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html#sklearn.model_selection.RandomizedSearchCV", "anchor_text": "RandomizedSearchCV"}, {"url": "https://unsplash.com/@punttim?utm_source=medium&utm_medium=referral", "anchor_text": "Tim Gouw"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scikit-optimize.github.io/stable/", "anchor_text": "Scikit-Optimize"}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian distribution"}, {"url": "https://ora.ox.ac.uk/objects/uuid:1418c926-6636-4d96-8bf6-5d94240f3d1f", "anchor_text": "Source"}, {"url": "https://ora.ox.ac.uk/objects/uuid:1418c926-6636-4d96-8bf6-5d94240f3d1f", "anchor_text": "Bayesian Gaussian processes for sequential prediction, optimisation and quadrature"}, {"url": "https://www.cs.cornell.edu/courses/cs4787/2019sp/notes/lecture16.pdf", "anchor_text": "Cornell University: Lecture 16: Gaussian Processes and Bayesian Optimization"}, {"url": "https://towardsdatascience.com/the-intuitions-behind-bayesian-optimization-with-gaussian-processes-7e00fcc898a0", "anchor_text": "The intuitions behind Bayesian Optimization with Gaussian Processes"}, {"url": "https://scikit-optimize.github.io/stable/modules/generated/skopt.BayesSearchCV.html?highlight=bayessearchcv#skopt.BayesSearchCV", "anchor_text": "BayesSearchCV"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html", "anchor_text": "gbrtclassifier"}, {"url": "https://unsplash.com/@ambreenhasan?utm_source=medium&utm_medium=referral", "anchor_text": "Ambreen Hasan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@camylla93?utm_source=medium&utm_medium=referral", "anchor_text": "Camylla Battani"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/gaussian-process?source=post_page-----c72c7d4f5833---------------gaussian_process-----------------", "anchor_text": "Gaussian Process"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c72c7d4f5833---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/hyperparameter-tuning?source=post_page-----c72c7d4f5833---------------hyperparameter_tuning-----------------", "anchor_text": "Hyperparameter Tuning"}, {"url": "https://medium.com/tag/bayesian-machine-learning?source=post_page-----c72c7d4f5833---------------bayesian_machine_learning-----------------", "anchor_text": "Bayesian Machine Learning"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----c72c7d4f5833---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc72c7d4f5833&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&user=Paul+May&userId=554601a151c6&source=-----c72c7d4f5833---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc72c7d4f5833&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&user=Paul+May&userId=554601a151c6&source=-----c72c7d4f5833---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc72c7d4f5833&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc72c7d4f5833&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c72c7d4f5833---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c72c7d4f5833--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Carnivalius?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Carnivalius?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Paul May"}, {"url": "https://medium.com/@Carnivalius/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "252 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F554601a151c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&user=Paul+May&userId=554601a151c6&source=post_page-554601a151c6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F95eb90286fc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaussian-processes-smarter-tuning-for-your-ml-models-c72c7d4f5833&newsletterV3=554601a151c6&newsletterV3Id=95eb90286fc0&user=Paul+May&userId=554601a151c6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}