{"url": "https://towardsdatascience.com/using-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599", "time": 1683015981.926152, "path": "towardsdatascience.com/using-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599/", "webpage": {"metadata": {"title": "Using Cosine Similarity to Build a Movie Recommendation System | by Mahnoor Javed | Towards Data Science", "h1": "Using Cosine Similarity to Build a Movie Recommendation System", "description": "Have you ever imagined that a simple formula that you have studied in high school would play a part in recommending you a movie on the basis of the one you already like? Well, here we are, using the\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Have you ever imagined that a simple formula that you have studied in high school would play a part in recommending you a movie on the basis of the one you already like?", "Well, here we are, using the Cosine Similarity (the dot product for normalized vectors) to build a Movie Recommender System!", "Recommender systems are an important class of machine learning algorithms that offer \u201crelevant\u201d suggestions to users. Youtube, Amazon, Netflix, all function on recommendation systems where the system recommends you the next video or product based on your past activity (Content-based Filtering) or based on activities and preferences of other users similar to you (Collaborative Filtering). Likewise, Facebook also uses a recommendation system to suggest Facebook users you may know offline.", "Recommendation Systems work based on the similarity between either the content or the users who access the content.", "There are several ways to measure the similarity between two items. The recommendation systems use this similarity matrix to recommend the next most similar product to the user.", "In this article, we will build a machine learning algorithm that would recommend movies based on a movie the user likes. This Machine Learning model would be based on Cosine Similarity.", "The first step to build a movie recommendation system is getting the appropriate data. You may download the movies dataset from the web, or from the link below which contains a 22MB CSV file titled \u201cmovie_dataset.csv\u201d:", "Our CSV file contains a total of 4802 movies and 24 columns: index, budget, genres, homepage, id, keywords, original_language, original_title, overview, popularity, production_companies, production_countries, release_date, revenue, runtime, spoken_languages, status, tagline, title, vote_average, vote_count, cast, crew and director (sigh!).", "Among all these different features, the ones we are interested in to find the similarity for making the next recommendation are the following:", "A user who likes a horror movie will most probably like another horror movie. Some users may like seeing their favorite actors in the cast of the movie. Others may love movies directed by a particular person. Combining all of these aspects, our shortlisted 4 features are sufficient to train our recommendation algorithm.", "Now, let us start with the coding. First things first, let\u2019s import the libraries we need, as well as the CSV file of the movies\u2019 dataset.", "We will import the two important libraries for data analysis and manipulation; pandas and numpy. We will also import Scikit-learn\u2019s CountVectorizer, used to convert a collection of text documents to a vector of term/token counts.", "Lastly, we will import the cosine_similarity from sklearn, as the metric of our similarity matrix (which will be discussed in details later).", "We will read our CSV file into a dataframe df, which can then be accessed in the variable explorer of our Python IDE.", "We will make a list of the features that we will be using. As discussed above, we will only use the features most relevant to us, considering our problem at hand. Hence, our chosen features will be keywords, cast, genres & director.", "Moreover, we will do a little bit of data preprocessing and replace any rows having NaN values with a space/empty string, so it does not generate an error while running the code. This pre-processing has been done in the for loop.", "Next, we will define a function called combined_features. The function will combine all our useful features (keywords, cast, genres & director) from their respective rows, and return a row with all the combined features in a single string.", "We will add a new column, combined_features to our existing dataframe (df) and apply the above function to each row (axis = 1). The dataframe will now have an extra column at the end, which will comprise of rows of the combined features.", "Next, we will extract features from our data.", "The sklearn.feature_extraction module can be used to extract features in a format supported by machine learning algorithms from datasets consisting of formats such as text and image. We will use CountVectorizer\u2019s fit.tranform to count the number of texts and we will print the transformed matrix count_matrix into an array for better understanding.", "We will use the Cosine Similarity from Sklearn, as the metric to compute the similarity between two movies.", "Cosine similarity is a metric used to measure how similar two items are. Mathematically, it measures the cosine of the angle between two vectors projected in a multi-dimensional space. The output value ranges from 0\u20131.", "0 means no similarity, where as 1 means that both the items are 100% similar.", "The python Cosine Similarity or cosine kernel, computes similarity as the normalized dot product of input samples X and Y. We will use the sklearn cosine_similarity to find the cos \u03b8 for the two vectors in the count matrix.", "The cosine_sim matrix is a numpy array with calculated cosine similarity between each movies. As you can see in the image below, the cosine similarity of movie 0 with movie 0 is 1; they are 100% similar (as should be).", "Similarly the cosine similarity between movie 0 and movie 1 is 0.105409 (the same score between movie 1 and movie 0 \u2014 order does not matter).", "The diagonal with 1s suggests what the case is, each movie \u2018x\u2019 is 100% similar to itself!", "The next step is to take as input a movie that the user likes in the movie_user_likes variable.", "Since we are building a content based filtering system, we need to know the users\u2019 likes in order to predict a similar item.", "Suppose I like the movie \u201cDead Poets Society\u201d. Next, I will build a function to get the index from the name of this movie. The index will be saved in the movie_index variable.", "Next we will generate a list of similar movies. We will use the movie_index of the movie we have given as input movie_user_likes. The enumerate() method will add a counter to the iterable list cosine_sim and return it in a form of a list similar_movies with the similarity score of each index.", "Next step is to sort the movies in the list similar_movies. We have used the parameter reverse=True since we want the list in the descending order, with the most similar item at the top.", "The sorted_similar_movies will be a list of all the movies sorted in descending order with respect to their similarity score with the input movie movie_user_likes.", "As can be seen in the image below, the most similar one with a similarity score of 0.9999999999999993 is at the top most, with its index number 2453 (the movie is \u2018Dead Poets Society\u2019 which we gave as input, makes sense, right?).", "Now, here comes the last part of the project, which is to print the names of the movies similar to the one we have given as input to the system through the movie_user_likes variable.", "As seen in the sorted_similar_movies list, the movies are sorted by their index number. Printing the index number will be of no use to us, so we will define a simple function that takes the index number and covert it into the movie title as in the dataframe.", "Next we will call this function inside the for loop to print the first \u2018x\u2019 number of movies from the sorted_similar_movies.", "In our case, we will print the 15 most similar movies from a pool of 4802 movies.", "Now comes the application. Use the steps above to code your own recommender systems and run the code by giving a movie you like to the movie_user_likes.", "I have given \u201cDead Poets Society\u201d, and it prints me the following similar movies:", "As can be seen, the most similar one is obviously the movie itself. The algorithm defines \u201cMuch Ado About Nothing\u201d as the next most similar movie! (will add it to my \u201cTo-watch list\u201d \ud83d\ude04 )", "That\u2019s it for this article! The article provided a hands-on approach to build a recommendation system, from scratch, by coding it on any python IDE.", "Now, once the algorithm is built, its time to grab some popcorn, and watch the movie your system recommends!! \ud83d\ude01", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An engineer by profession, a bibliophile by heart!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae7f20842599&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae7f20842599--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae7f20842599--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mahnoorjaved.medium.com/?source=post_page-----ae7f20842599--------------------------------", "anchor_text": ""}, {"url": "https://mahnoorjaved.medium.com/?source=post_page-----ae7f20842599--------------------------------", "anchor_text": "Mahnoor Javed"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc005fe8944b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&user=Mahnoor+Javed&userId=c005fe8944b4&source=post_page-c005fe8944b4----ae7f20842599---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae7f20842599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae7f20842599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/jade87-3234870/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=4011346", "anchor_text": "Jade87"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=4011346", "anchor_text": "Pixabay"}, {"url": "https://unsplash.com/@glencarrie?utm_source=medium&utm_medium=referral", "anchor_text": "Glen Carrie"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/MahnoorJaved98/Movie-Recommendation-System/blob/main/movie_dataset.csv", "anchor_text": "MahnoorJaved98/Movie-Recommendation-SystemYou can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or\u2026github.com"}, {"url": "https://unsplash.com/@georgiavagim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Georgia Vagim"}, {"url": "https://unsplash.com/s/photos/cast-movie?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ae7f20842599---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----ae7f20842599---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ae7f20842599---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----ae7f20842599---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/movie-recommendation?source=post_page-----ae7f20842599---------------movie_recommendation-----------------", "anchor_text": "Movie Recommendation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae7f20842599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&user=Mahnoor+Javed&userId=c005fe8944b4&source=-----ae7f20842599---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae7f20842599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&user=Mahnoor+Javed&userId=c005fe8944b4&source=-----ae7f20842599---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae7f20842599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae7f20842599--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae7f20842599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae7f20842599---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae7f20842599--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae7f20842599--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae7f20842599--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae7f20842599--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae7f20842599--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae7f20842599--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae7f20842599--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae7f20842599--------------------------------", "anchor_text": ""}, {"url": "https://mahnoorjaved.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mahnoorjaved.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mahnoor Javed"}, {"url": "https://mahnoorjaved.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "268 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc005fe8944b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&user=Mahnoor+Javed&userId=c005fe8944b4&source=post_page-c005fe8944b4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3ad1ddb9d9ce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599&newsletterV3=c005fe8944b4&newsletterV3Id=3ad1ddb9d9ce&user=Mahnoor+Javed&userId=c005fe8944b4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}