{"url": "https://towardsdatascience.com/understanding-gans-mnist-case-study-e3c9ad4ae3a7", "time": 1683005960.109431, "path": "towardsdatascience.com/understanding-gans-mnist-case-study-e3c9ad4ae3a7/", "webpage": {"metadata": {"title": "Understanding GANs: MNIST case study. | by Victor Salvia Punsoda | Towards Data Science", "h1": "Understanding GANs: MNIST case study.", "description": "In this article, we will go through the whole process of generating hand-written digits (MNIST) using GANs. If your goal is to understand the theory and gain intuition, keep reading. If you just want\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/VictorSP17/Simple_GAN_MNIST", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://github.com/VictorSP17/Simple_GAN_MNIST", "anchor_text": "https://github.com/VictorSP17/Simple_GAN_MNIST", "paragraph_index": 18}, {"url": "https://victorsp17.github.io/website/", "anchor_text": "https://victorsp17.github.io/website/", "paragraph_index": 20}], "all_paragraphs": ["In this article, we will go through the whole process of generating hand-written digits (MNIST) using GANs. If your goal is to understand the theory and gain intuition, keep reading. If you just want to learn how to code it you can find it in a Jupyter notebook here (PyTorch). Furthermore, we are assuming a minimum background in deep learning and machine learning concepts. If you are interested in learning about deep generative models in general, I will soon be posting my bachelor thesis (check my webpage in the bio, this is part of the thesis) which investigates the 4 most utilized ones and compares them. Now let\u2019s start!", "We will define an agent (G, generator) that generates new images, and another (D, discriminator) that discriminates whether an image is real or fake. These two agents will play against each other the following game several rounds. Each round will consist of the following steps.", "Following this process, G and D will become stronger and stronger. Notice that if they end up being perfect, the generated images will be indistinguishable from the real ones and D will be unable to discern real from fake. Once this happens, G will be the sampler we are looking for.", "We will define these agents using simple neural networks. It is important to note that CNN's would probably give better results in images, but we wanted to keep it simple and focus more on the core components of GANs.", "The discriminator will learn a mapping from the image space to the [0,1] space. This output will be interpreted as the probability that the image is real. On the other hand, the generator will learn a mapping from the latent space to the image space. The network architectures are the following ones:", "How do we sample new images with this structure? We will define a prior distribution in the latent space (multivariate normal q(z)) where we will sample noise from. Then, we will transform it with the generator obtaining the desired image.", "In the following image, one can see which is the structure of the networks. We will see how they interact in the next section.", "The game described before can be formally written as a minimax game:", "Now, let us see why this is the same as the game. The first term of the V function is 0 if the discriminator identifies that x is real (D(x) = 1) and -\u221e if it identifies it as fake (D(x) = 0). Hence, since the images come from the real distribution, the goal of D is to maximize it (classify real images as real). The second term is 0 if the discriminator finds out it is a fake sample and -\u221e if the generator fools the discriminator. Now again, D wants to maximize and G to minimize. Therefore, the goal of the generator in this game is to minimize V(D,G) and the goal of the discriminator is to maximize it, as written in the formula.", "The algorithm used in training has been the following:", "As seen in the algorithm, the training will be done alternating one agent and the other. Notice a few things: firstly, we can use any optimization algorithm we want just by changing the step function. In this case, we have used the Adam algorithm [2], widely accepted in the deep learning community. Secondly, we are not optimizing the generator as done in the minimax game. Here, instead of minimizing the expectation of log(1-D(G(z))) we are maximizing log D(G(z)). This is because it is more stable in training according to the authors of [1].", "We ran the algorithm for 300 epochs and with a batch size of N = 32.", "One can see in the figures below that up until the 100th epoch the generator is fooling more and more the discriminator. However, at that point, it starts to decrease slowly and the discriminator is more and more able to distinguish real from fake. It is important to understand that this does not mean that the generator is not learning. It just means the discriminator is learning \u201cmore\u201d than the generator. However, it is clear that the agent G has some limitations (very simple network), which might be the reason why it does not converge towards the perfect sampler.", "Notice as well that we are talking about 70\\% vs 30\\% accuracy, meaning the generator will fool the discriminator 3 times out of 10 on average \u2014 perfect would be 5 out of 10, which means the discriminator has no clue. Now, the discriminator is able to identify patterns in the generated images which make them different from real ones, but are we humans able to? In the next figure, you can see samples in different stages of training. The interesting result we found is that humans do not perceive any difference between generated and real [3]. This might not be surprising for handwritten digits, but these algorithms are also used in face generation for instance, where this result is much more powerful.", "Although we see that the results are astonishing, we must keep in mind that a histogram would look perfect to human eyes as well, but it would not be accomplishing our goal of generalization \u2014 it would just be memorizing. In order to test whether we are overfitting or not, we will search for the nearest neighbor of each one of the generated images. This can be seen below, where there are clear differences between the generated image (on the left) and its nearest neighbor in the dataset (on the right). We cannot conclude we are not overfitting, but at least we see we are learning something meaningful.", "The reality is that the mapping from the latent space to the image space is continuous, which means that close images in one space will also be close in the other space. Now, since we are using a multivariate normal as the prior distribution (uni-modal), if we sample 2 vectors in the latent space and interpolate them, the resulting line will also be very likely, which suggests that the images should be handwritten digits as well. All this means that the image of this interpolation should be a continuous smooth transformation between different hand-written digits, as can be seen in the following image (interpolation: 9 \u2192 7 \u2192 1). This is further explored in this drawing:", "Please, for more details go to the code in GitHub. My bachelor thesis will be available soon on my website, you can check that out as well.", "[3] Salvia, V., Sanfeliu, A. (2020). Analysis of state-of-the-art deep generative models for image generation. (this is my bachelor thesis, soon available on my webpage.)", "[4] https://github.com/VictorSP17/Simple_GAN_MNIST (here you can find the code for this document.)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Mathematician studying data science. I will be posting some of my work here as well as on my website: https://victorsp17.github.io/website/."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3c9ad4ae3a7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@pusavi17?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pusavi17?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": "Victor Salvia Punsoda"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F99a46f60bbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&user=Victor+Salvia+Punsoda&userId=99a46f60bbe7&source=post_page-99a46f60bbe7----e3c9ad4ae3a7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c9ad4ae3a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c9ad4ae3a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/VictorSP17/Simple_GAN_MNIST", "anchor_text": "here"}, {"url": "https://github.com/VictorSP17/Simple_GAN_MNIST", "anchor_text": "https://github.com/VictorSP17/Simple_GAN_MNIST"}, {"url": "https://github.com/jsuarez5341/GAN-MNIST-Pytorch", "anchor_text": "https://github.com/jsuarez5341/GAN-MNIST-Pytorch"}, {"url": "https://medium.com/tag/gans?source=post_page-----e3c9ad4ae3a7---------------gans-----------------", "anchor_text": "Gans"}, {"url": "https://medium.com/tag/generative-model?source=post_page-----e3c9ad4ae3a7---------------generative_model-----------------", "anchor_text": "Generative Model"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e3c9ad4ae3a7---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/generative-adversarial?source=post_page-----e3c9ad4ae3a7---------------generative_adversarial-----------------", "anchor_text": "Generative Adversarial"}, {"url": "https://medium.com/tag/intuition?source=post_page-----e3c9ad4ae3a7---------------intuition-----------------", "anchor_text": "Intuition"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3c9ad4ae3a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&user=Victor+Salvia+Punsoda&userId=99a46f60bbe7&source=-----e3c9ad4ae3a7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3c9ad4ae3a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&user=Victor+Salvia+Punsoda&userId=99a46f60bbe7&source=-----e3c9ad4ae3a7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c9ad4ae3a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe3c9ad4ae3a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e3c9ad4ae3a7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e3c9ad4ae3a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pusavi17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pusavi17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Victor Salvia Punsoda"}, {"url": "https://medium.com/@pusavi17/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5 Followers"}, {"url": "https://victorsp17.github.io/website/", "anchor_text": "https://victorsp17.github.io/website/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F99a46f60bbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&user=Victor+Salvia+Punsoda&userId=99a46f60bbe7&source=post_page-99a46f60bbe7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F99a46f60bbe7%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-gans-mnist-case-study-e3c9ad4ae3a7&user=Victor+Salvia+Punsoda&userId=99a46f60bbe7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}