{"url": "https://towardsdatascience.com/using-a-keras-cnn-in-ios-9e82836b0ee3", "time": 1683012751.8342552, "path": "towardsdatascience.com/using-a-keras-cnn-in-ios-9e82836b0ee3/", "webpage": {"metadata": {"title": "Implementing A Keras CNN in iOS Apps | by Derek Austin | Towards Data Science", "h1": "Implementing A Keras CNN in iOS Apps", "description": "I first thought about image classification in an app through watching the TV show Silicon Valley. For any non-Silicon Valley enthusiasts, the show is a comedy with the characters in a tech incubator\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["I first thought about image classification in an app through watching the TV show Silicon Valley. For any non-Silicon Valley enthusiasts, the show is a comedy with the characters in a tech incubator. One member of the incubator unveils an app in which the only functionality tells you if the picture you are seeing is a \u2018hotdog\u2019 or \u2018not hotdog.\u2019\u00b9 It was likely that a convolutional neural network (CNN) would be best suited to accomplish this task and while I had taken courses on them in the past, I was interested in how a machine learning algorithm could be implemented and deployed on a mobile device.", "My first action was to decide on a topic matter for an image classification app, and I decided upon dogs. Who doesn\u2019t love taking a picture of their dog anyways? In order to do so though I would need a relatively large and wide dataset necessary to train CNN\u2019s. Luckily, Stanford has an open source database that has a 120 different dog breeds with at least 150 images per breed.\u00b2", "My next thought was that while an app that classifies dogs would be fun, it might be relatively mundane. So, what if instead the model took a human photo as input and output what dog breed the person most closely resembled? The classifier would only be trained on dogs but given any image, including one of a human, it would provide a probabilistic outcome of the various breeds, so it would output the most likely breed as a prediction.", "Apple iOS uses a tool called Core ML in order to perform all of their machine learning tasks such as image recognition. At first I thought it was likely I was going to have to build and train a model in Swift, which was a language I was relatively unfamiliar with. However, after a few Google searches I found that Apple provides a Core ML converter that can take a Keras model and transforms it into a Core ML model that can be deployed in an iOS app.\u00b3", "Next I had to build the CNN and train it on the roughly 20,000 images. In order to get sufficient depth in the model without an extremely large amount of training iterations, transfer learning was likely the best path to take. I decided to use the popular VGG16 network that has won the ImageNet competition in the past. An overview of the network is seen below.", "I set the layers to be untrainable in order to keep the original VGG weights and added 2 fully connected layers on the end while utilizing dropout in order to control for overfitting. I also \u2018popped\u2019 the last layer of the VGG and added two more fully connected layers in order to make it conform to the proper number of outputs.", "Before commencing training however, I needed to preprocess the images. Using Keras\u2019 ImageDataGenerator was quite helpful as it shaped images to a given input size as well as allowing for a training and validation split.", "I trained the model until the validation error started to increase and saved it in a Keras checkpoint .h5 format. Then I converted my model into the .mlmodel format that could be used on iOS devices.", "Before I started app development I had to learn some basics of Swift and to be quite honest I had to learn about app development as well! I found a great YouTube tutorial called Coding with Chris that went through all of the basics of Swift and app development in Xcode.\u2074 With the tutorial under my belt, I was able to put together a single view app that accepted as input either an image from the users camera roll or taken through the app and output the most likely classification of a dog breed, along with the dogs picture. While most aspects of the process were quite easy as Apple utilizes a lot of drag and drop features in Xcode, I had to manually preprocess the user image size in order to make sure it fit the input dimensions in the CNN.", "And there you have it, a project that utilizes both data science and app development, and one that can hopefully even make you laugh along the way!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Recent grad extremely interested in machine learning, looking to specialize in reinforcement learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9e82836b0ee3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dcaustin33?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dcaustin33?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": "Derek Austin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8480f4c123c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&user=Derek+Austin&userId=8480f4c123c4&source=post_page-8480f4c123c4----9e82836b0ee3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e82836b0ee3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e82836b0ee3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://apps.apple.com/us/app/puplab/id1513829576", "anchor_text": "PupLab"}, {"url": "https://apps.apple.com/us/app/puplab/id1513829576", "anchor_text": "PupLab"}, {"url": "https://www.youtube.com/watch?v=vIci3C4JkL0", "anchor_text": "https://www.youtube.com/watch?v=vIci3C4JkL0"}, {"url": "http://vision.stanford.edu/aditya86/ImageNetDogs/", "anchor_text": "http://vision.stanford.edu/aditya86/ImageNetDogs/"}, {"url": "https://developer.apple.com/documentation/coreml", "anchor_text": "https://developer.apple.com/documentation/coreml"}, {"url": "https://www.youtube.com/channel/UC2D6eRvCeMtcF5OGHf1-trw", "anchor_text": "https://www.youtube.com/channel/UC2D6eRvCeMtcF5OGHf1-trw"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----9e82836b0ee3---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/tag/ios?source=post_page-----9e82836b0ee3---------------ios-----------------", "anchor_text": "IOS"}, {"url": "https://medium.com/tag/keras?source=post_page-----9e82836b0ee3---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----9e82836b0ee3---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e82836b0ee3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&user=Derek+Austin&userId=8480f4c123c4&source=-----9e82836b0ee3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e82836b0ee3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&user=Derek+Austin&userId=8480f4c123c4&source=-----9e82836b0ee3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e82836b0ee3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9e82836b0ee3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9e82836b0ee3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9e82836b0ee3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dcaustin33?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dcaustin33?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Derek Austin"}, {"url": "https://medium.com/@dcaustin33/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "20 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8480f4c123c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&user=Derek+Austin&userId=8480f4c123c4&source=post_page-8480f4c123c4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F24015b6f5edd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-a-keras-cnn-in-ios-9e82836b0ee3&newsletterV3=8480f4c123c4&newsletterV3Id=24015b6f5edd&user=Derek+Austin&userId=8480f4c123c4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}