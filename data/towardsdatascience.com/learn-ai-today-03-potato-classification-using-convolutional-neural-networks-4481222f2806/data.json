{"url": "https://towardsdatascience.com/learn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806", "time": 1683012080.679777, "path": "towardsdatascience.com/learn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806/", "webpage": {"metadata": {"title": "Learn AI Today 03: Potato Classification using Convolutional Neural Networks | by Miguel Pinto | Towards Data Science", "h1": "Learn AI Today 03: Potato Classification using Convolutional Neural Networks", "description": "This is the 3rd story in the Learn AI Today series! These stories, or at least the first few, are based on a series of Jupyter notebooks I\u2019ve created while studying/learning PyTorch and Deep\u2026"}, "outgoing_paragraph_urls": [{"url": "http://learn-ai-today.com/", "anchor_text": "Learn AI Today", "paragraph_index": 0}, {"url": "https://www.kaggle.com/datasets", "anchor_text": "Kaggle Datasets page", "paragraph_index": 2}, {"url": "https://www.kaggle.com/moltean/fruits", "anchor_text": "this", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/intuitively-understanding-convolutions-for-deep-learning-1f6f42faee1", "anchor_text": "this story", "paragraph_index": 6}, {"url": "https://medium.com/u/cb2327c63f48?source=post_page-----4481222f2806--------------------------------", "anchor_text": "Irhum Shafkat", "paragraph_index": 6}, {"url": "http://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf", "anchor_text": "paper", "paragraph_index": 7}, {"url": "https://arxiv.org/pdf/2003.08237v4.pdf", "anchor_text": "current top result", "paragraph_index": 9}, {"url": "https://docs.python.org/3/library/pdb.html", "anchor_text": "Python debugger", "paragraph_index": 11}, {"url": "https://github.com/fastai/fastai2", "anchor_text": "fastai2 library", "paragraph_index": 12}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-03-potato-classifier", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-03-potato-classifier", "anchor_text": "code", "paragraph_index": 15}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-03-potato-classifier", "anchor_text": "this notebook", "paragraph_index": 16}], "all_paragraphs": ["This is the 3rd story in the Learn AI Today series! These stories, or at least the first few, are based on a series of Jupyter notebooks I\u2019ve created while studying/learning PyTorch and Deep Learning. I hope you find them as useful as I did!", "If you have not already, make sure to check the previous story!", "Kaggle Datasets page is a good place to start if you want to find a public dataset. There are almost 50 thousand datasets on Kaggle, a number growing every day as users create and upload new datasets to share with the world.", "After having this idea of creating a Potato Classifier for this lesson, I quickly found this dataset that contains 4 classes of potatoes and also a lot of other fruits and vegetables.", "The building blocks for computer vision are the Convolutional Neural Networks. These networks usually combine several layers of kernel convolution operations and downscaling.", "The animation below is a great visualization of the kernel convolution operations. The kernel, which is a small matrix, usually 3x3, moves over the entire image. Instead of calling it an image let\u2019s refer to it as the input feature map to be more general.", "At each step, the values of the kernel 3x3 matrix are multiplied elementwise to the corresponding values of the input feature map (blue matrix in the animation above) and the sum of those 9 products is the value for the output, resulting on the green matrix in the animation. The numbers in the kernel are parameters of the model to be learned. That way the model can learn to identify spatial patterns that are the basis of computer vision. By having multiple layers and gradually downscaling the images, the patterns learned by each convolutional layer are more and more complex. To get a deeper intuition of CNNs I recommend this story by Irhum Shafkat.", "The idea of CNNs has been around since the 80s but it started to gain momentum in 2012 when the winners of ImageNet competition used such approach and \u2018crushed\u2019 the competition. Their paper describing the solution has the following abstract:", "\u201cWe trained a large, deep convolutional neural network to classify the 1.2 million high-resolution images in the ImageNet LSVRC-2010 contest into the 1000 different classes. On the test data, we achieved top-1 and top-5 error rates of 37.5% and 17.0% which is considerably better than the previous state-of-the-art. The neural network, which has 60 million parameters and 650,000 neurons, consists of five convolutional layers, some of which are followed by max-pooling layers, and three fully-connected layers with a final 1000-way softmax. To make training faster, we used non-saturating neurons and a very efficient GPU implementation of the convolution operation. To reduce overfitting in the fully-connected layers we employed a recently-developed regularization method called \u201cdropout\u201d that proved to be very effective. We also entered a variant of this model in the ILSVRC-2012 competition and achieved a winning top-5 test error rate of 15.3%, compared to 26.2% achieved by the second-best entry.\u201d", "A top 5 error rate of 15.3% compared to 26.2% for the second-best entry is a huge breakthrough. Fast forward to today and the current top result for top 5 accuracy is 98.7% (error rate 1.3%).", "Let\u2019s now code a very simple CNN with just two convolutional layers and use it to create a potato classifier!", "Note: A good way to understand how everything work is to use the Python debugger. You can import pdb and include pdb.set_trace() right in the forward method. Then you can move step by step and check the shapes of each layer to give you a better intuition or help to debug problems.", "It doesn\u2019t worth wasting your time coding every step of the deep learning pipeline when there are tools that can make your life easier. That\u2019s why in this story I\u2019ll use fastai2 library to do most of the work. Nevertheless, I will use the basic CNN model defined in the previous section. Note that fastai2 uses PyTorch and makes customization of every step easy, making it useful for both beginner and advanced deep learning practitioners and researchers.", "The following 12 lines of code are the entire Deep Learning pipeline in fastai2, using the BasicCNN defined in the previous section! You can find here the notebook with all the code for this lesson.", "After training for 30 epochs I got a validation accuracy of 100% with this simple CNN model! This is what the training and validation loss looks like a train progresses:", "And that\u2019s it! If you followed along with the code you can now identify among 4 types of potatoes very accurately. And most importantly, nothing in this example is specific about potatoes! You can apply a similar approach to virtually anything you want to classify!", "I can show you a thousand examples but you will learn the most if you can make one or two experiments by yourself! The complete code for this story is available on this notebook.", "And as always, if you create interesting notebooks with nice animations as a result of your experiments, go ahead and share them on GitHub, Kaggle or write a Medium story!", "This ends the third story in the Learn AI Today series!", "Feel free to give me some feedback in the comments. What did you find most useful or what could be explained better? Let me know!", "You can read more about my Deep Learning journey on the following stories!", "Thanks for reading! Have a great day!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student (Remote sensing, Meteorology), ML/DL enthusiast, fastai student, competition master at Kaggle, pianist/composer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4481222f2806&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4481222f2806--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4481222f2806--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mnpinto?source=post_page-----4481222f2806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=post_page-----4481222f2806--------------------------------", "anchor_text": "Miguel Pinto"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbfc658aeefbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&user=Miguel+Pinto&userId=bfc658aeefbc&source=post_page-bfc658aeefbc----4481222f2806---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4481222f2806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4481222f2806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/learn-ai-today", "anchor_text": "LEARN AI TODAY"}, {"url": "https://unsplash.com/@jeshoots?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "JESHOOTS.COM"}, {"url": "https://unsplash.com/s/photos/potato?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://learn-ai-today.com/", "anchor_text": "Learn AI Today"}, {"url": "https://towardsdatascience.com/learn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63", "anchor_text": "Learn AI Today: 02 \u2014 Introduction to Classification Problems using PyTorchClassifying flowers with Neural Networks, visualizing decision boundaries and understanding overfitting.towardsdatascience.com"}, {"url": "https://www.kaggle.com/datasets", "anchor_text": "Kaggle Datasets page"}, {"url": "https://www.kaggle.com/moltean/fruits", "anchor_text": "this"}, {"url": "https://www.kaggle.com/moltean/fruits", "anchor_text": "fruits 360"}, {"url": "http://deeplearning.net/software/theano/tutorial/conv_arithmetic.html", "anchor_text": "Theano documentation"}, {"url": "https://towardsdatascience.com/intuitively-understanding-convolutions-for-deep-learning-1f6f42faee1", "anchor_text": "this story"}, {"url": "https://medium.com/u/cb2327c63f48?source=post_page-----4481222f2806--------------------------------", "anchor_text": "Irhum Shafkat"}, {"url": "http://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf", "anchor_text": "paper"}, {"url": "https://arxiv.org/pdf/2003.08237v4.pdf", "anchor_text": "current top result"}, {"url": "https://towardsdatascience.com/learn-ai-today-01-getting-started-with-pytorch-2e3ba25a518", "anchor_text": "lesson 1 of this series"}, {"url": "https://docs.python.org/3/library/pdb.html", "anchor_text": "Python debugger"}, {"url": "https://github.com/fastai/fastai2", "anchor_text": "fastai2 library"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-03-potato-classifier", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/advanced-dataloaders-with-fastai2-ecea62a7d97e", "anchor_text": "this"}, {"url": "https://towardsdatascience.com/working-with-3d-data-fastai2-5e2baa09037e", "anchor_text": "this"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-03-potato-classifier", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/learn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63", "anchor_text": "previous lesson"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-03-potato-classifier", "anchor_text": "code"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-03-potato-classifier", "anchor_text": "this notebook"}, {"url": "https://docs.google.com/forms/d/e/1FAIpQLSc0IBzdCn7osIjvGno1GjBakI-DfXHE8gDLZ--jNzWsXtRW0g/viewform", "anchor_text": "joining my mailing list in this link"}, {"url": "http://learn-ai-today.com/", "anchor_text": "learn-ai-today.com"}, {"url": "https://github.com/mnpinto/learn_ai_today", "anchor_text": "this GitHub repository"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-03-potato-classifier", "anchor_text": "this is the link for the Kaggle notebook with the code for this story!"}, {"url": "https://towardsdatascience.com/my-3-year-journey-from-zero-python-to-deep-learning-competition-master-6605c188eec7", "anchor_text": "My 3-year journey: From zero Python to Deep Learning competition masterThe path I followed since starting to learn Python back in 2017 up to became a Kaggle competition master with a solo\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/my-2-year-journey-on-kaggle-how-i-became-a-competition-master-ef0f0955c35d", "anchor_text": "My 2-Year Journey on Kaggle: How I Became a Competition MasterDescribing my journey and the strategy that I followed to become a Competition Master with a solo gold medaltowardsdatascience.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4481222f2806---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4481222f2806---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4481222f2806---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/learn-ai-today?source=post_page-----4481222f2806---------------learn_ai_today-----------------", "anchor_text": "Learn Ai Today"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----4481222f2806---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4481222f2806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&user=Miguel+Pinto&userId=bfc658aeefbc&source=-----4481222f2806---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4481222f2806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&user=Miguel+Pinto&userId=bfc658aeefbc&source=-----4481222f2806---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4481222f2806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4481222f2806--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4481222f2806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4481222f2806---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4481222f2806--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4481222f2806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4481222f2806--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4481222f2806--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4481222f2806--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4481222f2806--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4481222f2806--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4481222f2806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Miguel Pinto"}, {"url": "https://medium.com/@mnpinto/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "648 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbfc658aeefbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&user=Miguel+Pinto&userId=bfc658aeefbc&source=post_page-bfc658aeefbc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3388b854b03d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806&newsletterV3=bfc658aeefbc&newsletterV3Id=3388b854b03d&user=Miguel+Pinto&userId=bfc658aeefbc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}