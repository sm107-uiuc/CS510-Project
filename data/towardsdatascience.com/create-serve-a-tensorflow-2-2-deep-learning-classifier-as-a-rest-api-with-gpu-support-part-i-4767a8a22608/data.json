{"url": "https://towardsdatascience.com/create-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608", "time": 1683007643.159234, "path": "towardsdatascience.com/create-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608/", "webpage": {"metadata": {"title": "Serve a TensorFlow 2 Deep Learning Classifier as a REST API (with GPU support), Part I | by Hamed ZITOUN | Towards Data Science", "h1": "Serve a TensorFlow 2 Deep Learning Classifier as a REST API (with GPU support), Part I", "description": "In this series, I\u2019ll explain step-by-step how to create and serve a Deep Learning Image Classifier ConvNet as a REST API using Flask! Later we\u2019ll dockerize it!"}, "outgoing_paragraph_urls": [{"url": "https://cs231n.github.io/convolutional-networks/", "anchor_text": "CNN-Convolutional Neural Networks", "paragraph_index": 1}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR-10", "paragraph_index": 2}, {"url": "https://github.com/drivendata/cookiecutter-data-science", "anchor_text": "cookiecutter-data-science", "paragraph_index": 4}, {"url": "https://developer.nvidia.com/cudnn", "anchor_text": "cuDNN", "paragraph_index": 14}, {"url": "https://github.com/deep-diver/CIFAR10-img-classification-tensorflow", "anchor_text": "CNN architecture", "paragraph_index": 18}, {"url": "https://keras.io/api/optimizers/rmsprop/", "anchor_text": "RMSprop", "paragraph_index": 31}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/losses/SparseCategoricalCrossentropy", "anchor_text": "SparseCategoricalCrossentropy", "paragraph_index": 31}, {"url": "https://stackoverflow.com/questions/59787897/how-does-tensorflow-sparsecategoricalcrossentropy-work/59788222#59788222", "anchor_text": "why", "paragraph_index": 31}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html", "anchor_text": "classification_report", "paragraph_index": 39}, {"url": "http://atelierdeeplearning.com", "anchor_text": "http://atelierdeeplearning.com", "paragraph_index": 53}, {"url": "https://www.linkedin.com/in/hamed-zitoun/", "anchor_text": "https://www.linkedin.com/in/hamed-zitoun/", "paragraph_index": 53}], "all_paragraphs": ["This series of articles will help you to move from notebooks to real-world use cases of Data Science techniques! We\u2019ll take a Deep Learning classifier from zero to production \ud83d\ude80!", "Disclaimer: You should have prior knowledge and experience with CNN-Convolutional Neural Networks.", "The dataset we will use to train our Convolutional Neural Networks classifier is CIFAR-10 (don\u2019t download it yet). The CIFAR-10 dataset comprises 60000 32x32 color images in 10 classes, with 6000 images per class. There are 50000 training images and 10000 test images.", "Here are the classes in the dataset, and 10 random images from each:", "Too much inspired by the cookiecutter-data-science open-source template, here is my favorite Data Science project structure:", "For simplification reason, let us ease off a bit our project structure by only creating (keep everything empty for the moment):", "Just like me, you end up with these folders", "Great! You got a clean project structure ready! Let us set up our working environment!", "Follow these steps to create a virtual Python 3 work environment defined in environment.yml file and configure your GPU:", "You should now have your virtual environment activated!", "Bonus (FYI only not needed now):", "To update the environment packages to the latest compatible version", "Great! Now your environment and your dataset are ready for our image classifier training and predicting!", "Start by running jupyter notebook command in the project\u2019s root:", "For the first time, it would take a few minutes to load the required cuDNN libs (help TensorFlow discover your GPU device). If everything is ok, you\u2019ll get similar results to mine (except that I have a GTX 960M/CUDA v10.2).", "But before we need to define two methods; read_image & load_dataset", "If everything is OK, you\u2019ll get results similar to mine.", "Great! Now we have loaded our libs, and our datasets are ready! Let\u2019s create our CNN architecture!", "We do not need to re-invent the wheel, we will use this CNN architecture but in TensorFlow 2.2!", "The entire model comprises 16 layers in total:", "4. Convolution with 128 different filters in size of (3x3)", "6. Convolution with 256 different filters in size of (3x3)", "8. Convolution with 512 different filters in size of (3x3)", "10. Flattening the 3-D output of the last convolutional operations.", "11. Fully Connected Layer with 128 units", "12. Fully Connected Layer with 256 units", "13. Fully Connected Layer with 512 units", "15. Fully Connected Layer with 10 units (number of image classes)", "Cool! Now we have our helper functions ready to create our CNN!", "Now we can define our training hyper-parameters:", "Everything is OK now to instantiate our model. Also, let\u2019s check its summary.", "To train our model, we will use RMSprop as an optimizer & SparseCategoricalCrossentropy as a loss function. Why SparseCategoricalCrossentropy not just CategoricalCrossentropy? Good question! Here is why!", "Now we are good to compile our model!", "Everything is ready to train our model. Let us, however, define three callbacks:", "If everything is OK, your model should start training! You should get results similar to mine.", "Great! Your GPU is burning now \ud83d\udd25! Leave it training your model and we\u2019ll get back when training finishes! (Here a screenshot of my GPU working hard)", "Take snap if you want like Tom!", "Cool! Our classifier has finished training! Time to evaluate it, right? How is it working on the test images? We can check that by launching the tensorboard interface in our notebook using the following command.", "This command should start tensorboard with accuracy & loss graphs for training and validation:", "But wait, accuracy is not a good evaluation metric for a classifier! Let us check precision, recall, and f1 score on each class! We can do that thanks to scikit-learn\u2019s classification_report method:", "Nice as a first try, right? 0.82 precision & 0.82 recall! We can tune our hyper-parameters and retrain the model to get better results!", "Respond to the story with your results! I would be happy to check them! \ud83d\ude0a", "Let us make an inference test. Giving an image from the test set, let us discover what our model sees!", "Nice! Our model is performing pretty well on test data, we can now export it to disk. Our saved model is for making inferences and will get exposed as a REST API!", "Finally, let us check if the saved model works fine by loading it!", "Wonderful! Wonderful! Wonderful! You have successfully created, trained (on GPU), tested, and saved a TensorFlow 2 Deep Learning Image classifier!", "Now we are ready to expose it as a REST API with Flask and Waitress and later Dockerize everything!", "But wait, this is already too much for one Medium story \ud83d\ude14! Stay tuned for PART II! \ud83d\ude80", "All the source code is on my GitHub \ud83d\udc47 I\u2019ll keep pushing everything!", "Great! Thank you for reading! I\u2019m eager to see you in Part II (coming soon)!", "I hope I\u2019ve helped you create a Deep Learning Image Classifier using TensorFlow 2.2. In Part II, we will expose our saved model as a REST API and later we\u2019ll dockerize everything!", "Please consider sharing the story if you enjoyed it. That would help a lot.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer | Data Scientist | ML & DL Trainer @ http://atelierdeeplearning.com | \ud83d\ude80 Daily Share on https://www.linkedin.com/in/hamed-zitoun/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4767a8a22608&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4767a8a22608--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4767a8a22608--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hzitoun?source=post_page-----4767a8a22608--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hzitoun?source=post_page-----4767a8a22608--------------------------------", "anchor_text": "Hamed ZITOUN"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5323298224b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&user=Hamed+ZITOUN&userId=5323298224b9&source=post_page-5323298224b9----4767a8a22608---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4767a8a22608&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4767a8a22608&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/TensorFlow-REST-API", "anchor_text": "End to End TensorFlow REST API"}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "Flask"}, {"url": "https://www.docker.com/why-docker", "anchor_text": "dockerize"}, {"url": "https://unsplash.com/@billjelen?utm_source=medium&utm_medium=referral", "anchor_text": "Bill Jelen"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://jupyter.org/", "anchor_text": "Jupyter Notebook"}, {"url": "https://cs231n.github.io/convolutional-networks/", "anchor_text": "CNN-Convolutional Neural Networks"}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR-10"}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR-10"}, {"url": "https://github.com/drivendata/cookiecutter-data-science", "anchor_text": "cookiecutter-data-science"}, {"url": "https://airflow.apache.org/docs/stable/concepts.html", "anchor_text": "Airflow DAG"}, {"url": "http://conda.pydata.org/miniconda.html", "anchor_text": "Miniconda 3"}, {"url": "https://www.anaconda.com/products/individual", "anchor_text": "Anaconda 3"}, {"url": "https://www.tensorflow.org/install/gpu#software_requirements", "anchor_text": "https://www.tensorflow.org/install/gpu#software_requirements"}, {"url": "https://github.com/tqdm/tqdm", "anchor_text": "tqdm"}, {"url": "https://pjreddie.com/projects/cifar-10-dataset-mirror/", "anchor_text": "from here"}, {"url": "http://localhost:8888/tree/notebooks", "anchor_text": "http://localhost:8888/tree/notebooks"}, {"url": "https://developer.nvidia.com/cudnn", "anchor_text": "cuDNN"}, {"url": "https://github.com/deep-diver/CIFAR10-img-classification-tensorflow", "anchor_text": "CNN architecture"}, {"url": "https://github.com/deep-diver/CIFAR10-img-classification-tensorflow", "anchor_text": "Image credit"}, {"url": "https://keras.io/api/optimizers/rmsprop/", "anchor_text": "RMSprop"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/losses/SparseCategoricalCrossentropy", "anchor_text": "SparseCategoricalCrossentropy"}, {"url": "https://stackoverflow.com/questions/59787897/how-does-tensorflow-sparsecategoricalcrossentropy-work/59788222#59788222", "anchor_text": "why"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping", "anchor_text": "EarlyStopping"}, {"url": "https://www.tensorflow.org/tensorboard/tensorboard_in_notebooks", "anchor_text": "TensorBoard callback"}, {"url": "https://tqdm.github.io/docs/keras/", "anchor_text": "TqdmCallback"}, {"url": "https://pics.me.me/thumb_data-scientists-while-their-model-is-training-still-waiting-60708854.png", "anchor_text": "Image credit"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html", "anchor_text": "classification_report"}, {"url": "https://github.com/hzitoun/tensorFlow-2-Deep-Learning-Image-Classifier-REST-API-Docker-GPU", "anchor_text": "hzitoun/tensorFlow-2-Deep-Learning-Image-Classifier-REST-API-Docker-GPUSource code for medium story \ud83d\ude80Create & Serve a TensorFlow 2 Deep Learning Image Classifier as a REST API and\u2026github.com"}, {"url": "https://www.linkedin.com/in/hamed-zitoun/", "anchor_text": "https://www.linkedin.com/in/hamed-zitoun/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4767a8a22608---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4767a8a22608---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/web-development?source=post_page-----4767a8a22608---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4767a8a22608---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/tensorflow-rest-api?source=post_page-----4767a8a22608---------------tensorflow_rest_api-----------------", "anchor_text": "Tensorflow Rest Api"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4767a8a22608&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&user=Hamed+ZITOUN&userId=5323298224b9&source=-----4767a8a22608---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4767a8a22608&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&user=Hamed+ZITOUN&userId=5323298224b9&source=-----4767a8a22608---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4767a8a22608&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4767a8a22608--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4767a8a22608&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4767a8a22608---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4767a8a22608--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4767a8a22608--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4767a8a22608--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4767a8a22608--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4767a8a22608--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4767a8a22608--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4767a8a22608--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4767a8a22608--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hzitoun?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hzitoun?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hamed ZITOUN"}, {"url": "https://medium.com/@hzitoun/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "108 Followers"}, {"url": "http://atelierdeeplearning.com", "anchor_text": "http://atelierdeeplearning.com"}, {"url": "https://www.linkedin.com/in/hamed-zitoun/", "anchor_text": "https://www.linkedin.com/in/hamed-zitoun/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5323298224b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&user=Hamed+ZITOUN&userId=5323298224b9&source=post_page-5323298224b9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd841bbbc9876&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-serve-a-tensorflow-2-2-deep-learning-classifier-as-a-rest-api-with-gpu-support-part-i-4767a8a22608&newsletterV3=5323298224b9&newsletterV3Id=d841bbbc9876&user=Hamed+ZITOUN&userId=5323298224b9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}