{"url": "https://towardsdatascience.com/automating-running-routes-in-r-1e97eb4ed716", "time": 1683014784.701389, "path": "towardsdatascience.com/automating-running-routes-in-r-1e97eb4ed716/", "webpage": {"metadata": {"title": "Automating Running Routes in R. Using the Graphhopper API (with help\u2026 | by Freddie Tasker | Towards Data Science", "h1": "Automating Running Routes in R", "description": "Winter has arrived in the UK and as everyone else gets their boilers hurriedly repaired, my primary concern is keeping weekly running mileage up while temperatures go the other way. Exploring new\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/fredwise/run_the_mews", "anchor_text": "fredwise/run_the_mews", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Mews", "anchor_text": "mews", "paragraph_index": 3}, {"url": "https://everchangingmews.com/", "anchor_text": "Everchanging Mews", "paragraph_index": 4}, {"url": "https://developers.google.com/web/tools/chrome-devtools", "anchor_text": "Chrome Dev Tools", "paragraph_index": 5}, {"url": "https://github.com/tidyverse/rvest", "anchor_text": "rvest", "paragraph_index": 5}, {"url": "https://docs.ropensci.org/PostcodesioR/", "anchor_text": "PostcodesioR", "paragraph_index": 6}, {"url": "http://postcodes.io", "anchor_text": "postcodes.io", "paragraph_index": 6}, {"url": "http://postcodes.io", "anchor_text": "postcodes.io", "paragraph_index": 6}, {"url": "https://www.rdocumentation.org/packages/PostcodesioR/versions/0.1.1/topics/postcode_lookup", "anchor_text": "postcode_lookup", "paragraph_index": 6}, {"url": "https://www.graphhopper.com/", "anchor_text": "GraphHopper", "paragraph_index": 10}, {"url": "https://docs.graphhopper.com/", "anchor_text": "documentation", "paragraph_index": 12}, {"url": "https://rdrr.io/cran/jsonlite/", "anchor_text": "jsonlite", "paragraph_index": 12}, {"url": "https://github.com/fredwise/run_the_mews", "anchor_text": "Github", "paragraph_index": 12}, {"url": "https://r-spatial.github.io/sf/", "anchor_text": "sf package", "paragraph_index": 14}, {"url": "https://rstudio.github.io/leaflet/", "anchor_text": "leaflet", "paragraph_index": 14}], "all_paragraphs": ["Winter has arrived in the UK and as everyone else gets their boilers hurriedly repaired, my primary concern is keeping weekly running mileage up while temperatures go the other way.", "Exploring new bits of London seemed a good idea, and not having to think about what route to take seemed even better. So the plan is to run down every Mews in London and let R decide how to do it.", "There\u2019s snippets of code in this article, the rest is at fredwise/run_the_mews.", "Hidden behind some of London\u2019s grand terraced houses are 386 original and surviving mews. These little streets are a remnant of bona fide horse power, and while the stables and carriage houses are now mostly garages and ground floor kitchens, they still make good sight-seeing.", "Everchanging Mews has done the leg work here and over the last 10 years they have visited over 1,200 mews, cataloguing them on their encyclopaedic website.", "The list of original / surviving mews is split over 8 pages and each listing has a web page with further details. Chrome Dev Tools finds the element that holds this web address and a bit of work with the R package rvest lists them.", "Each of these web pages has a postcode and PostcodesioR will query postcodes.io for the location data. A little bit of manual cleaning up is involved here where the postcode is dodgy or doesn\u2019t exist in the postcodes.io database (7 of the 386). After that, just run them through postcode_lookup.", "R at its finest here, we just need to pass the longitudes and latitudes to the leaflet as a shape file.", "Hopefully the real value in all this comes from automating the route generation. The original problem statement was:", "Find the shortest total route, in routes of 20km or less, that covers all 386 properties. With each route starting at the same place.", "GraphHopper is a brilliant free resource for this kind of route optimisation. It allows routing of all sorts of vehicles (in this case feet), but its free API only allows up to 5 locations per request.", "A simple solution is to randomly select 5 locations at a time. This does come at the cost of not optimising over the total distance, however all that means in this case is that more running gets done and no mews gets visited twice (as long as the random sampling is done without replacement) so it should do!", "GraphHopper\u2019s documentation is great and all that\u2019s required is passing the latitude and longitude of the 5 locations in the right format. The snippet below shows a function that builds this request as an R list and converts it to JSON using jsonlite. A reminder that full scripts can be found on Github.", "The 78 queries for our 5 location running routes get posted to the GraphHopper API using httr::POST", "Convert the response paths co-ordinates into simple features using the sf package and they can be plotted as PolyLines in leaflet.", "Last but not least it would be useful to have these routes on a device to follow the route. Just pass the simple feature created from each GraphHopper response path to sf::st_write", "Ouila, 78 GPX files and 78 days of running without having to think where to go!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An analyst, I work mainly in Azure creating data products for logistics and aviation companies. I also like building stuff in R."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1e97eb4ed716&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://fredtasker.medium.com/?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": ""}, {"url": "https://fredtasker.medium.com/?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": "Freddie Tasker"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe171f5380924&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&user=Freddie+Tasker&userId=e171f5380924&source=post_page-e171f5380924----1e97eb4ed716---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1e97eb4ed716&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1e97eb4ed716&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://github.com/fredwise/run_the_mews", "anchor_text": "fredwise/run_the_mews"}, {"url": "https://unsplash.com/@brunus?utm_source=medium&utm_medium=referral", "anchor_text": "Bruno Martins"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Mews", "anchor_text": "mews"}, {"url": "https://everchangingmews.com/", "anchor_text": "Everchanging Mews"}, {"url": "https://developers.google.com/web/tools/chrome-devtools", "anchor_text": "Chrome Dev Tools"}, {"url": "https://github.com/tidyverse/rvest", "anchor_text": "rvest"}, {"url": "https://docs.ropensci.org/PostcodesioR/", "anchor_text": "PostcodesioR"}, {"url": "http://postcodes.io", "anchor_text": "postcodes.io"}, {"url": "http://postcodes.io", "anchor_text": "postcodes.io"}, {"url": "https://www.rdocumentation.org/packages/PostcodesioR/versions/0.1.1/topics/postcode_lookup", "anchor_text": "postcode_lookup"}, {"url": "https://www.graphhopper.com/", "anchor_text": "GraphHopper"}, {"url": "https://docs.graphhopper.com/", "anchor_text": "documentation"}, {"url": "https://rdrr.io/cran/jsonlite/", "anchor_text": "jsonlite"}, {"url": "https://github.com/fredwise/run_the_mews", "anchor_text": "Github"}, {"url": "https://r-spatial.github.io/sf/", "anchor_text": "sf package"}, {"url": "https://rstudio.github.io/leaflet/", "anchor_text": "leaflet"}, {"url": "https://medium.com/tag/api?source=post_page-----1e97eb4ed716---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----1e97eb4ed716---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/r?source=post_page-----1e97eb4ed716---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1e97eb4ed716---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----1e97eb4ed716---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1e97eb4ed716&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&user=Freddie+Tasker&userId=e171f5380924&source=-----1e97eb4ed716---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1e97eb4ed716&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&user=Freddie+Tasker&userId=e171f5380924&source=-----1e97eb4ed716---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1e97eb4ed716&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1e97eb4ed716&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1e97eb4ed716---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1e97eb4ed716--------------------------------", "anchor_text": ""}, {"url": "https://fredtasker.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://fredtasker.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Freddie Tasker"}, {"url": "https://fredtasker.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe171f5380924&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&user=Freddie+Tasker&userId=e171f5380924&source=post_page-e171f5380924--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe171f5380924%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-running-routes-in-r-1e97eb4ed716&user=Freddie+Tasker&userId=e171f5380924&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}