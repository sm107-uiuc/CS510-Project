{"url": "https://towardsdatascience.com/deep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65", "time": 1683011039.6133811, "path": "towardsdatascience.com/deep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65/", "webpage": {"metadata": {"title": "Deep Reinforcement Learning for Video Games Made Easy | by Andreas Holm Nielsen | Towards Data Science", "h1": "Deep Reinforcement Learning for Video Games Made Easy", "description": "In this post, we will investigate how easily we can train a Deep Q-Network (DQN) agent (Mnih et al., 2015) for Atari 2600 games using the Google reinforcement learning library Dopamine. While many RL\u2026"}, "outgoing_paragraph_urls": [{"url": "https://storage.googleapis.com/deepmind-media/dqn/DQNNaturePaper.pdf", "anchor_text": "Deep Q-Network (DQN) agent", "paragraph_index": 0}, {"url": "https://github.com/google/dopamine", "anchor_text": "Dopamine", "paragraph_index": 0}, {"url": "https://github.com/holmdk/dopamine_ALE_agent", "anchor_text": "Github repo", "paragraph_index": 3}, {"url": "https://storage.googleapis.com/deepmind-media/dqn/DQNNaturePaper.pdf", "anchor_text": "original paper", "paragraph_index": 8}, {"url": "https://www.tensorflow.org/", "anchor_text": "Tensorflow", "paragraph_index": 10}, {"url": "https://github.com/google/dopamine/blob/master/dopamine/agents/dqn/configs/dqn_icml.gin", "anchor_text": "file", "paragraph_index": 12}, {"url": "https://github.com/google/gin-config", "anchor_text": "gin configuration framework", "paragraph_index": 12}, {"url": "https://github.com/google/dopamine/blob/master/dopamine/agents/rainbow/configs/rainbow_aaai.gin", "anchor_text": "Rainbow model", "paragraph_index": 29}, {"url": "https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/17204/16680", "anchor_text": "Hessel et al., 2018", "paragraph_index": 29}], "all_paragraphs": ["In this post, we will investigate how easily we can train a Deep Q-Network (DQN) agent (Mnih et al., 2015) for Atari 2600 games using the Google reinforcement learning library Dopamine. While many RL libraries exist, this library is specifically designed with four essential features in mind:", "We believe these principles makes Dopamine one of the best RL learning environment available today. Additionally, we even got the library to work on Windows, which we think is quite a feat!", "In my view, the visualization of any trained RL agent is an absolute must in reinforcement learning! Therefore, we will (of course) include this for our own trained agent at the very end!", "We will go through all the pieces of code required (which is minimal compared to other libraries), but you can also find all scripts needed in the following Github repo.", "The general premise of deep reinforcement learning is to", "\u201cderive efficient representations of the environment from high-dimensional sensory inputs, and use these to generalize past experience to new situations.\u201d", "As stated earlier, we will implement the DQN model by Deepmind, which only uses raw pixels and game score as input. The raw pixels are processed using convolutional neural networks similar to image classification. The primary difference lies in the objective function, which for the DQN agent is called the optimal action-value function", "where r\u209c is the maximum sum of rewards at time t discounted by \u03b3, obtained using a behavior policy \u03c0 = P(a\u2223s) for each observation-action pair.", "There are relatively many details to Deep Q-Learning, such as Experience Replay (Lin, 1993) and an iterative update rule. Thus, we refer the reader to the original paper for an excellent walk-through of the mathematical details.", "One key benefit of DQN compared to previous approaches at the time (2015) was the ability to outperform existing methods for Atari 2600 games using the same set of hyperparameters and only pixel values and game score as input, clearly a tremendous achievement.", "This post does not include instructions for installing Tensorflow, but we do want to stress that you can use both the CPU and GPU versions.", "Nevertheless, assuming you are using Python 3.7.x, these are the libraries you need to install (which can all be installed via pip):", "Hyperparameter tuning for Deep Reinforcement Learning requires a significant amount of compute resources and therefore considered out of scope for this guide. Luckily, the authors of Dopamine have provided the specific hyperparameters used in Bellemare et al. (2017), which can be found in the following file. We use the contents of this \u201cconfig file\u201d as a string that we parse using the gin configuration framework. It contains all relevant training, environment, and hyperparameters needed, meaning we only need to update which game we want to run (although the hyperparameters might not work out equally well for all games).", "We start by importing the required libraries", "Next, we define the root path to save our experiments", "Then, we define the game we want to run (in this instance we run the game \u201cPong\u201d),", "And finally, we define the DQN config string:", "Now, we just write the final code for training our agent,", "Run the above (which will take a long time!), and you should see the DQN model crushing the Pong game!", "We ran the experiment for roughly 22 hours on a GTX 1070 GPU. We include a visualization of the optimization results and the \u201clive\u201d performance of our Pong agent. We divide this into two sections:", "Navigate to the tensorboard logs folder, which can be found inside the DQN_PATH that you defined earlier, and run the following:", "This should give you a visualization similar to this", "You can see performance only gradually increases after 12 runs.", "We will use the example_vis_lib script located in the utils folder of the Dopamine library. Hence, our script for running the live demonstration looks as follows:", "Run the above, and you should see the script starting to generate images for 1000 steps and then save the images into a video.mp4 file.", "Here is a gif of our model:", "Clearly, the agent is not perfect and does lose quite a few games. Still, it does a relatively good job!", "We could probably get a close-to-perfect agent if we trained it for a few more days (or use a bigger GPU).", "That is essentially how little code we actually need to implement a state-of-the-art DQN model for running Atari 2600 games with a live demonstration!", "Feel free to experiment with the significantly better Rainbow model (Hessel et al., 2018), which is also included in the Dopamine library, as well as other non-Atari games!", "As a final demonstration, we include a small gif of an agent trained for two days for Atari Breakout using the Rainbow model:", "You can see the Rainbow model is performing extremely well!", "[2] M. Hessel, et al., Rainbow: Combining improvements in deep reinforcement learning (2018), Thirty-Second AAAI Conference on Artificial Intelligence.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6f7d06b75a65&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@andreashn?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreashn?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": "Andreas Holm Nielsen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F20c7980a1b4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&user=Andreas+Holm+Nielsen&userId=20c7980a1b4f&source=post_page-20c7980a1b4f----6f7d06b75a65---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f7d06b75a65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f7d06b75a65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://storage.googleapis.com/deepmind-media/dqn/DQNNaturePaper.pdf", "anchor_text": "Deep Q-Network (DQN) agent"}, {"url": "https://github.com/google/dopamine", "anchor_text": "Dopamine"}, {"url": "https://github.com/holmdk/dopamine_ALE_agent", "anchor_text": "Github repo"}, {"url": "https://storage.googleapis.com/deepmind-media/dqn/DQNNaturePaper.pdf", "anchor_text": "original paper"}, {"url": "https://www.tensorflow.org/", "anchor_text": "Tensorflow"}, {"url": "https://github.com/google/dopamine/blob/master/dopamine/agents/dqn/configs/dqn_icml.gin", "anchor_text": "file"}, {"url": "https://github.com/google/gin-config", "anchor_text": "gin configuration framework"}, {"url": "https://github.com/google/dopamine/blob/master/dopamine/agents/rainbow/configs/rainbow_aaai.gin", "anchor_text": "Rainbow model"}, {"url": "https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/download/17204/16680", "anchor_text": "Hessel et al., 2018"}, {"url": "https://arxiv.org/abs/1812.06110", "anchor_text": "Dopamine: A research framework for deep reinforcement learning"}, {"url": "https://holmdk.github.io/2020/07/16/DQN_agent_ALE_dopamine.html", "anchor_text": "https://holmdk.github.io"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----6f7d06b75a65---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6f7d06b75a65---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/q-learning?source=post_page-----6f7d06b75a65---------------q_learning-----------------", "anchor_text": "Q Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6f7d06b75a65---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/games?source=post_page-----6f7d06b75a65---------------games-----------------", "anchor_text": "Games"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6f7d06b75a65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&user=Andreas+Holm+Nielsen&userId=20c7980a1b4f&source=-----6f7d06b75a65---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6f7d06b75a65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&user=Andreas+Holm+Nielsen&userId=20c7980a1b4f&source=-----6f7d06b75a65---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f7d06b75a65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6f7d06b75a65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6f7d06b75a65---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6f7d06b75a65--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreashn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreashn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andreas Holm Nielsen"}, {"url": "https://medium.com/@andreashn/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "58 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F20c7980a1b4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&user=Andreas+Holm+Nielsen&userId=20c7980a1b4f&source=post_page-20c7980a1b4f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff125c24ec397&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-reinforcement-learning-for-video-games-made-easy-6f7d06b75a65&newsletterV3=20c7980a1b4f&newsletterV3Id=f125c24ec397&user=Andreas+Holm+Nielsen&userId=20c7980a1b4f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}