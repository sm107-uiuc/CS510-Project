{"url": "https://towardsdatascience.com/the-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2", "time": 1683007526.738676, "path": "towardsdatascience.com/the-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2/", "webpage": {"metadata": {"title": "The beginning of a deep learning trading bot \u2014 Part1: 95% accuracy is not enough | by Jan Schmitz | Towards Data Science", "h1": "The beginning of a deep learning trading bot \u2014 Part1: 95% accuracy is not enough", "description": "Ok, my friends, the objective is to develop an elaborate trading system that is capable of outperforming the market consistently. In the end, we will have a production-ready application and I\u2019ll\u2026"}, "outgoing_paragraph_urls": [{"url": "https://finance.yahoo.com/quote/IBM/history?p=IBM", "anchor_text": "IBM page", "paragraph_index": 7}, {"url": "https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/IBM_PriceFeatures.ipynb", "anchor_text": "Github", "paragraph_index": 17}, {"url": "https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/IBM_PriceFeatures.ipynb", "anchor_text": "Github", "paragraph_index": 31}, {"url": "http://www.pinklion.xyz", "anchor_text": "www.pinklion.xyz", "paragraph_index": 40}, {"url": "http://www.pinklion.xyz", "anchor_text": "www.pinklion.xyz", "paragraph_index": 43}, {"url": "http://www.pinklion.xyz", "anchor_text": "www.pinklion.xyz", "paragraph_index": 46}], "all_paragraphs": ["Ok, my friends, the objective is to develop an elaborate trading system that is capable of outperforming the market consistently. In the end, we will have a production-ready application and I\u2019ll invest around $20,000 of my own savings and share the results with you. Hence, in this series of articles, I\u2019ll be not just sharing proof of concepts but what it actually takes to develop AI systems that can handle the uncertainty of the real market.", "Most AI and Deep Learning sources have a tendency to only present final research results, which can be frustrating when trying to comprehend and reproduce the provided solutions. Instead, I want to make this series as educational as possible and thus will be sharing my train of thought and all the experiments that go into the final solutions.", "Before we can start, we have to remind ourselves that forecasting price movements of a particular stock within a market is a highly complex task. Stock movements are caused by millions of impressions and pre-conditions that each market participant is exposed to. Thus, we need to be able to capture as many of these impressions and pre-conditions as possible. In addition, we have to make a couple of assumption of how the market operates.", "And, please, do read the disclaimer at the bottom.", "As we cannot cover the development of an entire trading bot within one article, I envision the structure of this series as follows:", "Before training the production-grade level models we first have to find out how explanatory stock prices and financial news are when forecasting for stock returns.", "In order to get a first impression of how well stock prices and news indicate future stock price changes we initially train multiple models on a smaller dataset. The dataset that we will use to start proving our assumptions are the historical price and volume data of the IBM stock.", "IBM has a fairly long price history on Yahoo, prices reach back as far as 1962. The easiest way to get the historical IBM prices is to simply download the dataset from yahoo\u2019s IBM page. For each trading day, Yahoo provides Open, High, Low, Close prices and the Volume (OHLCV). Once downloaded and having it loaded into a notebook the IBM OHLCV data looks as follows.", "To get an idea of how the prices have changed over time, we plot the daily closing prices. The IBM price graph start date is January 2nd, 1962, ends on February 3rd, 2020, and has a price range between $7.5 \u2013 $225.", "Let\u2019s also have a look at the volume data which we will use as an additional feature to our price data points. The volume for each day is calculated by multiplying for each trade the number of shares times the trade share price. Then the products of all trades during a day are summed and form the volume data point for this particular day.", "Feeding raw price and volume data into a deep learning model is usually a bad idea. When looking at IBM\u2019s price graph you can see the prices from 1962 to 1991 ($7- $48) are on a totally different level than the prices around the years 2000 and 2020 ($140-$220). In essence, these two price ranges have little to do with each other. Meaning that the range from 1962\u20131991 (average price $25) has little explanatory value for the price range of 2000\u20132020 (average price $130). In order to bring past price points on the same level as price points of recent times, and thus more useful for training our neural networks, we have to do a couple of preprocessing steps. Let\u2019s start the preprocessing, I promise it\u2018s going to be quick.", "Firstly, we are going to convert prices and volumes into price returns/percentage changes. The easiest way to do this is by using the pandas function pct_change().", "The advantage of having price returns is that they are more stationary than raw price data. A simple explanation of stationarity: Stationarity = Good, because past data is more similar to future data, making forecasts easier.", "The next graph illustrates nicely that converting stock prices to stock returns removes the trend of increasing stock prices.", "Secondly, a min-max normalization is applied to all price and volume data, making our data range from 0\u20131. Instead of using the raw price returns and volume changes, normalized data has the advantage that it allows a deep learning model to train more quickly and stably.", "Thirdly, we will split the time series into training, validation and test datasets. In most cases a training and validation dataset split is sufficient. However, for time series data it is crucial that the final evaluation is performed on a test set. The test dataset has not been seen by the model at all and thus we avoid any look ahead or other temporal biases within the evaluation.", "Having calculated stock returns, normalized and split the data into 3 sections, the datasets have now the illustrated shape below.", "After having prepared the dataset, we now can start doing the fun stuff \u2014 training different deep learning models. I\u2019ve experimented with Bidirectional LSTMs, Transformers, and CNN + Bi-LSTM the code for all models can be found on Github.", "A Bidirectional LSTM is an extension of a traditional LSTM (Long Short Term Memory Cell) that can improve model performance when processing sequential datasets. Bidirectional LSTMs combine two individual LSTM layers whereas the first LSTM layer receives the sequential data (e.g. IBM prices) in the correct chronological order and the second LSTM layer receives the same data only in a reversed order. After the input data has been processed by the bidirectional LSTM layer (2 LSTM layers) both outputs are being concatenated to produce the final prediction. Making it a bit simpler to grasp I\u2019ve added an illustration and code below.", "Now let\u2019s have a look at how the bidirectional LSTM model looks when coded. Instead of just having a single Bi-LSTM layer this model has been constructed with three Bi-LSTM layers to improve the model\u2019s capacity.", "Now let\u2019s start the training process.", "After having trained for 200 epochs we obtained the following results. For the validation set, we have a Mean Average Percentage Error (MAPE) of 3.5828 which can be interpreted, for the sake of simplicity, as an accuracy of 96.42%. The test dataset has a MAPE value of 4.2656, equating to an accuracy of 95.73%. An accuracy of greater than 95% seems amazing at first, but the next graph indicates a different story.", "The blue line represents the daily price changes of the IBM stock (daily stock returns) and the yellow line corresponds with our model\u2019s predictions. Despite having an average accuracy of >95% the model merely managed to find the centre of the stock return distribution. The yellow prediction line does not divert at all from the centre of the stock returns around 0.6.", "The interpretation of the stable prediction line is that our models are able to identify the general trend of the IBM stock. For now, our experiments show that only a trend and not outliers are derivable by price data of a single stock alone.", "Now we will perform the exact same steps as with the vanilla Bi-LSTM model, but instead of using a vanilla Bi-LSTM we\u2019ll combine the Bi-LSTM with a convolutional network (CNN).", "Usually, CNNs are used for image classification whereas each convolutional layer within the CNN is extracting different features from the image. However, in recent years it has been shown that CNNs provide value when analyzing time series and sequential data (e.g. sound and text). Convolutional layers are good in detecting patterns that occur between data points which are spatially close to each other. In case of your day by day price and volume data that should be the case.", "The architecture of the conventional layers has been inspired by Google's Inception blocks. I changed the 2D-convolutions of the inception model to 1D-convolution making the layers compatible with our time series.", "Ok, let\u2019s construct the CNN + Bi-LSTM model.", "And finally the training initiation of the CNN + Bi-LSTM model.", "After having also trained this model for 200 epochs, the training results look as follows. The MAPE value of the validation set is 3.8454 only slightly higher than the 3.5828 of the previous model. The test dataset has a MAPE value of 4.5289 instead of the 4.2656 for the Bi-LSTM model. For both, validation and test set the CNN+Bi-LSTM network performs worse than the vanilla Bi-LSTM model. Although we have worse results, I\u2019m satisfied to see that this time we don\u2019t just have a straight prediction line and thus can exclude any severe model or data structure flaws. \ud83e\udd13", "This time our model has learned to only predict the trend of price movements again. Still a forecast for outliers is not possible with the IBM price data alone.", "If you feel interested in seeing the results of all the different model architectures and the full code of my experiments have a look here. Github", "In conclusion, our models are able to identify the general trend of price changes, but outliers cannot be predicted. The Mean Average Percentage Error(MAPE) is always lower than 5, equating to an accuracy interpretation of >95%. For the first experiments, the results are already very promising. Nevertheless, in order to improve our model\u2019s shortcomings and master the outlier forecast, we have a couple of options.", "First, we can add additional data sources that help with the prediction of outliers, such as financial and market news.", "Second, we can train larger models with more price data from different stocks. For this, I\u2019ve curated a list of 7200 publicly traded stocks which we\u2019ll use in a future article to increase model performance.", "There are many more details to explore. And I\u2019m sure there are many questions and unanswered parts. So, any comments and suggestion s\u2014 please do share. I\u2019d be happy to include suggestions in the future process.", "In the next post, I\u2019m going to show how financial news can be used in combination with price data to improve the price return predictions of our networks.", "Thank you very much for reading to the end.", "In the past I\u2019ve received a tone of feedback and requests to make my financial asset prediction models available and easily usable. It would help people to answer questions such as:", "What are good assets to invest in? What do I put into my financial portfolio?", "Let me introduce you to PinkLion www.pinklion.xyz", "PinkLion is a product that lives on top of my code base to makes daily asset data available for thousands of stocks, funds/ETFs, and crypto currencies. In addition, it allows asset analytics and portfolio optimisation on the fly by providing access to underlying prediction models.", "At the moment the number of signups is still limited due to the massive amount of server resources needed for the individual calculations.", "Feel free to give it a try and provide feedback. (It is still in a rough state) www.pinklion.xyz", "None of the content presented in this article constitutes a recommendation that any particular security, portfolio of securities, transaction or investment strategy is suitable for any specific person. Futures, stocks, and options trading involves substantial risk of loss and is not suitable for every investor. The valuation of futures, stocks and options may fluctuate, and, as a result, clients may lose more than their original investment.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist \u2014 Who is leveraging the sweet compounding interest rate effect \ud83d\ude42 \u2014 www.pinklion.xyz"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc338abc98fc2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@janschmitz_80340?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@janschmitz_80340?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": "Jan Schmitz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7214fdeacabf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&user=Jan+Schmitz&userId=7214fdeacabf&source=post_page-7214fdeacabf----c338abc98fc2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc338abc98fc2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc338abc98fc2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://finance.yahoo.com/quote/IBM/history?p=IBM", "anchor_text": "IBM page"}, {"url": "https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/IBM_PriceFeatures.ipynb", "anchor_text": "Github"}, {"url": "https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/IBM_PriceFeatures.ipynb", "anchor_text": "Github"}, {"url": "http://www.pinklion.xyz", "anchor_text": "www.pinklion.xyz"}, {"url": "https://www.pinklion.xyz/", "anchor_text": "PinkLionWe relieve you from the tedious and frustrating parts of your job. No more cleaning data and model trials and\u2026www.pinklion.xyz"}, {"url": "http://www.pinklion.xyz", "anchor_text": "www.pinklion.xyz"}, {"url": "https://medium.com/tag/finance?source=post_page-----c338abc98fc2---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c338abc98fc2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----c338abc98fc2---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/trading?source=post_page-----c338abc98fc2---------------trading-----------------", "anchor_text": "Trading"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c338abc98fc2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc338abc98fc2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&user=Jan+Schmitz&userId=7214fdeacabf&source=-----c338abc98fc2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc338abc98fc2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&user=Jan+Schmitz&userId=7214fdeacabf&source=-----c338abc98fc2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc338abc98fc2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc338abc98fc2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c338abc98fc2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c338abc98fc2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c338abc98fc2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c338abc98fc2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c338abc98fc2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@janschmitz_80340?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@janschmitz_80340?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jan Schmitz"}, {"url": "https://medium.com/@janschmitz_80340/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "http://www.pinklion.xyz", "anchor_text": "www.pinklion.xyz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7214fdeacabf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&user=Jan+Schmitz&userId=7214fdeacabf&source=post_page-7214fdeacabf--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd50f621b7ec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-beginning-of-a-deep-learning-trading-bot-part1-95-accuracy-is-not-enough-c338abc98fc2&newsletterV3=7214fdeacabf&newsletterV3Id=d50f621b7ec5&user=Jan+Schmitz&userId=7214fdeacabf&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}