{"url": "https://towardsdatascience.com/learn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724", "time": 1683012918.3857028, "path": "towardsdatascience.com/learn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724/", "webpage": {"metadata": {"title": "Learn AI Today 04: Time Series Multi-Step Forecasting | by Miguel Pinto | Towards Data Science", "h1": "Learn AI Today 04: Time Series Multi-Step Forecasting", "description": "This is the 4th story in the Learn AI Today series! If you have not already, make sure to check the previous story. A chaotic system is one in which a very small change in the initial conditions can\u2026"}, "outgoing_paragraph_urls": [{"url": "http://learn-ai-today.com/", "anchor_text": "Learn AI Today", "paragraph_index": 0}, {"url": "http://www.scholarpedia.org/article/Mackey-Glass_equation", "anchor_text": "Mackey-Glass equation", "paragraph_index": 2}, {"url": "http://lab.fs.uni-lj.si/lasin/wp/IMIT_files/neural/nn05_narnet/", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://www.youtube.com/watch?v=nUUqwaxLnWs", "anchor_text": "this 10-min video where Andrew Ng explains Why Does Batch Norm Works", "paragraph_index": 8}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-04-time-series", "anchor_text": "this notebook", "paragraph_index": 18}], "all_paragraphs": ["This is the 4th story in the Learn AI Today series! If you have not already, make sure to check the previous story.", "A chaotic system is one in which a very small change in the initial conditions can result in a completely different outcome. In such systems, you cannot predict the future exactly even if you know the deterministic equations that describe the future. Why? Because you would need an infinitely precise computer and infinitely precise initial conditions. In reality that\u2019s fundamentally impossible. This is why the weather forecasts are only accurate in a short-range. They have been improving over time as dynamical and statistical models improve and the computation power increases. However, it is not possible to predict the daily weather accurately in the long term since it is a chaotic system.", "To generate a chaotic time series I will use the Mackey-Glass equation, with the parameters described here. The Python code looks like this:", "The result for the first 500 samples is the following:", "Notice there\u2019s a pattern in the time series but with a lot of variations that cannot be reliably predicted over a long period of time.", "The data generated with the code above is a very long sequence. To train a model I will slice the data in smaller sequences of 500 elements. The input data will be the first 100 elements and the target data (the future forecast) the 400 remaining elements. Furthermore, the first 2/3 of the data will be used as training data whereas the last 1/3 as validation data.", "Note: When working with time-series is often a good idea to select the last portion of the series for validation, particularly if you want to predict the future. Otherwise, the model may learn auto-correlations and produce a misleadingly good result that will \u201cbreak\u201d in practice when applying for the future.", "The code above simply runs over the long series and creates sequences of inputs and targets as described above, reshaped in the format needed for the model. For image data and the usual 2D convolutional neural networks, the tensors are organized with the shape [batch-size, channels, rows, columns]. Here for 1D convolutional neural networks, it\u2019s the same but dropping the last dimension. And indeed it possible to have an input of multiple time series (represented as several channels).", "The model I defined for this experiment is a 1D convolutional neural network with 3 convolutional layers followed by ReLU activation and Batch Normalization and finally average pooling and two linear layers. The rationale is similar to the 2D convolution layers. Each successive layer can capture patterns in the data that are more and more complex. The Batch Normalization is useful to make the training faster and more stable even in very deep neural networks. You can see this 10-min video where Andrew Ng explains Why Does Batch Norm Works.", "Also notice that before the last linear layer I used a dropout (line 26). The dropout (defined in line 10 with a probability of 0.5) is a usually successful method of regularization. It simply drops some of the elements in the feature map randomly making the data slightly different each time. Think about an image for example. Dropout is like removing some pixels of the image. Most likely you can still identify the object in the image and so does the model has to learn it, resulting in a more robust model.", "Note: During inference time the dropout is not active. This is one of the reasons you need to call model.eval() before running the inference, otherwise, dropout will be applied.", "Using the fastai Datasets class is easy to create the dataloaders and then the fastai Learner to combine the dataloaders with the model. The Learner class handles training and predictions.", "During the training, the following table is printed with the results, where you can see that the train and validation losses gradually drop as the train progresses.", "There are several reasons to have a train loss higher than the validation loss as seen in the table above. One possible reason, in this case, is the use of Dropout itself that is only applied for the training. You can try to run the code without the dropout and check if that\u2019s the case!", "Now that the model is trained, let\u2019s compute the prediction for the validation. The get_preds method of the Learner can be used as follows: ye_valid, y_valid = learn.get_preds().Notice that I don\u2019t need to call model.eval() as fastai get_preds already takes care of such details. Nevertheless is something to keep in mind.", "With the results in hand, it\u2019s time to visualize the predictions! This is the most fun part. The following code creates an image with the visualization of 12 validation sequences.", "As you can see in the image above, the model predictions (red) start by closely following the targets (green) but the performance starts degrading over time. In fact, if I plot the Mean Square Error (MSE) along the time axis, this is the result:", "This is expected due to the chaotic nature of the data. Can this result be further improved? Probably yes, I tried just a few different options when preparing this story, the real learning is in looking to the code and make your own observations and experiments.", "I can show you a thousand examples but you will learn the most if you can make one or two experiments by yourself! The complete code for this story is available on this notebook.", "And as always, if you create interesting notebooks with nice animations as a result of your experiments, go ahead and share them on GitHub, Kaggle or write a Medium story!", "This ends the fourth story in the Learn AI Today series!", "Feel free to give me some feedback in the comments. What did you find most useful or what could be explained better? Let me know!", "You can read more about my Deep Learning journey on the following stories!", "Thanks for reading! Have a great day!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student (Remote sensing, Meteorology), ML/DL enthusiast, fastai student, competition master at Kaggle, pianist/composer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6eb48bbcc724&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mnpinto?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": "Miguel Pinto"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbfc658aeefbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&user=Miguel+Pinto&userId=bfc658aeefbc&source=post_page-bfc658aeefbc----6eb48bbcc724---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6eb48bbcc724&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6eb48bbcc724&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/learn-ai-today", "anchor_text": "LEARN AI TODAY"}, {"url": "https://unsplash.com/@drew_beamer?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Drew Beamer"}, {"url": "https://unsplash.com/s/photos/future?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://learn-ai-today.com/", "anchor_text": "Learn AI Today"}, {"url": "https://towardsdatascience.com/learn-ai-today-03-potato-classification-using-convolutional-neural-networks-4481222f2806", "anchor_text": "Learn AI Today: 03 \u2014 Potato Classification using Convolutional Neural NetworksCreating a CNN model in PyTorch and training it to identify types of potatos using fastai2 to make the code simpletowardsdatascience.com"}, {"url": "http://www.scholarpedia.org/article/Mackey-Glass_equation", "anchor_text": "Mackey-Glass equation"}, {"url": "http://lab.fs.uni-lj.si/lasin/wp/IMIT_files/neural/nn05_narnet/", "anchor_text": "here"}, {"url": "https://www.youtube.com/watch?v=nUUqwaxLnWs", "anchor_text": "this 10-min video where Andrew Ng explains Why Does Batch Norm Works"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-04-time-series", "anchor_text": "full code here"}, {"url": "https://docs.fast.ai/data.core.html#Datasets", "anchor_text": "here"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-04-time-series", "anchor_text": "this notebook"}, {"url": "https://docs.google.com/forms/d/e/1FAIpQLSc0IBzdCn7osIjvGno1GjBakI-DfXHE8gDLZ--jNzWsXtRW0g/viewform", "anchor_text": "joining my mailing list in this link"}, {"url": "http://learn-ai-today.com/", "anchor_text": "learn-ai-today.com"}, {"url": "https://github.com/mnpinto/learn_ai_today", "anchor_text": "this GitHub repository"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-04-time-series", "anchor_text": "this is the link for the Kaggle notebook with the code for this story"}, {"url": "https://towardsdatascience.com/my-3-year-journey-from-zero-python-to-deep-learning-competition-master-6605c188eec7", "anchor_text": "My 3-year journey: From zero Python to Deep Learning competition masterThe path I followed since starting to learn Python back in 2017 up to became a Kaggle competition master with a solo\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/my-2-year-journey-on-kaggle-how-i-became-a-competition-master-ef0f0955c35d", "anchor_text": "My 2-Year Journey on Kaggle: How I Became a Competition MasterDescribing my journey and the strategy that I followed to become a Competition Master with a solo gold medaltowardsdatascience.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6eb48bbcc724---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6eb48bbcc724---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6eb48bbcc724---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/learn-ai-today?source=post_page-----6eb48bbcc724---------------learn_ai_today-----------------", "anchor_text": "Learn Ai Today"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6eb48bbcc724---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6eb48bbcc724&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&user=Miguel+Pinto&userId=bfc658aeefbc&source=-----6eb48bbcc724---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6eb48bbcc724&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&user=Miguel+Pinto&userId=bfc658aeefbc&source=-----6eb48bbcc724---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6eb48bbcc724&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6eb48bbcc724&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6eb48bbcc724---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6eb48bbcc724--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Miguel Pinto"}, {"url": "https://medium.com/@mnpinto/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "648 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbfc658aeefbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&user=Miguel+Pinto&userId=bfc658aeefbc&source=post_page-bfc658aeefbc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3388b854b03d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-04-time-series-multi-step-forecasting-6eb48bbcc724&newsletterV3=bfc658aeefbc&newsletterV3Id=3388b854b03d&user=Miguel+Pinto&userId=bfc658aeefbc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}