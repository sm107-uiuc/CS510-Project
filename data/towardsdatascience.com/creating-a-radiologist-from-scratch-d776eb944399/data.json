{"url": "https://towardsdatascience.com/creating-a-radiologist-from-scratch-d776eb944399", "time": 1682997453.864747, "path": "towardsdatascience.com/creating-a-radiologist-from-scratch-d776eb944399/", "webpage": {"metadata": {"title": "Creating a Radiologist from Scratch | by Ayrton San Joaquin | Towards Data Science", "h1": "Creating a Radiologist from Scratch", "description": "I had never looked at an x-ray other than my own, more so at an x-ray that showed some physical defect. I did not know what to look at to determine a defect. How could a person with zero experience\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/ajsanjoaquin/funstuff/blob/master/Jesus_classifier.ipynb", "anchor_text": "first image classifier", "paragraph_index": 9}, {"url": "https://arxiv.org/abs/1610.02391", "anchor_text": "how I can see what the model \u2018sees\u2019 through a heat map", "paragraph_index": 21}, {"url": "https://github.com/ajsanjoaquin/Pneumothorax/blob/master/Test_Ayrton.ipynb", "anchor_text": "repository", "paragraph_index": 29}, {"url": "https://www.linkedin.com/in/ajsanjoaquin", "anchor_text": "https://www.linkedin.com/in/ajsanjoaquin", "paragraph_index": 31}], "all_paragraphs": ["I had no idea how to do it.", "I had never looked at an x-ray other than my own, more so at an x-ray that showed some physical defect. I did not know what to look at to determine a defect. How could a person with zero experience in Radiology tell a machine how to look at x-ray images?", "Six hours later, I still didn\u2019t know how to determine if there\u2019s a defect. But somehow, I was able to create a machine almost as good as a Radiologist at detecting a defect.", "I was skimming through my laptop screen trying to get a sense of the web page in front of me. There were two folders: both contained the x-ray images. Some images were labelled positive and some were negative. I took one out from both labels and I honestly couldn\u2019t tell the difference. Beside me were my nine teammates, two of which were working on the same problem. As the only undergraduate student (and the only one without any formal instruction in college mathematics save for that one calculus course), I was surrounded by either graduate students or professionals working as data scientists, data engineers, and public health researchers.", "We were working on creating a machine that can classify if an x-ray scan contains Pneumothorax (basically, a collapsed lung) and then identify where in the image is the collapsed area. Aside from not being able to tell the difference, we had to find a way to show which area in the image had the difference. While the images may have labels, it doesn\u2019t have labels on which area is the Pneumothorax present. While we had two people who have experience in Radiology on our team, surely we couldn\u2019t rely on them to tell us where precisely the affected area was in more than the 3,000 Pneumothorax- positive images. As the final personal obstacle at my first datathon, everyone was using Keras while I was using Pytorch, both frameworks for Deep Learning. For the most part, we could not understand each other.", "Again, aside from not being able to tell the difference, we had to find a way to show which area in the image had the difference. You\u2019re asking a blind man to teach a machine how to \u2018see\u2019 and look at an image to determine if it\u2019s positive for Pneumothorax or not. On top of this, the closest help you can get were working in two different coding frameworks which made it feel like we were talking in two different dialects. And then we somehow had to miraculously overcome this situation and combine whatever we built with a system that will potentially be used to save a human life. This is crazy.", "You\u2019re asking a blind man to teach a machine how to \u2018see\u2019 and look at an image to determine if it\u2019s positive for Pneumothorax or not.", "The problem was split into two parts, classifying and segmentation. A classifier task is classifying images according to their labels (e.g. whether an x-ray image shows a case of Pneumothorax (positive) or not (negative)), while a segmentation task is identifying which part of the image has the object in question by segmenting the image into \u2018parts\u2019 (e.g. if positive, the positive area would be given a boundary that separates it from other objects within the image). I volunteered for classification because it seemed easier.", "Since we were coding in different frameworks, I had to make my own classifier. In our team of three, we were to compare our classifiers and select the one with the best accuracy. One of my teammates was working with pre-processing x-ray images as a job. As a final caveat, I had only begun learning Deep Learning two weeks before, and I had never made a real model just using Pytorch either. At the time of this writing, I still haven\u2019t used Pytorch exclusively (but I\u2019m getting there!).", "Instead, I\u2019ve only used fastai which is built on Pytorch. It\u2019s a beginner-friendly library that simplifies the entire process of loading an image dataset, training it on a deep learning model, and then using it to predict the label of new images. They also have a full course online, and I used the first lesson as a guide to make my first image classifier. But that was my first and only classifier that I built before joining this datathon.", "So with nobody else to ask how to implement this in Pytorch, I simply copied the steps of my first project. I took the provided image dataset from the Society for Imaging Informatics in Medicine (SIIM) and remotely connected to a GPU from the National Supercomputing Centre Singapore (NSCC). I used my knowledge of Excel manipulation with Python to clean the labels file (and it still took me more than two hours to find a the simple formula to change all non-zero values in a column to 1).", "I used this dataset to train the model on a Resnet-50. The Resnet-50 is a model/ neural network that was shown millions of images previously to produce a series of \u2018weights\u2019. You can think of weights as a set of numbers that represent the strength between neurons in a model that help the model \u2018look\u2019 at an image. The intuition is that using the Resnet-50\u2019s weights is better than using randomly picked weights because the model is already better at \u2018looking\u2019 at images. This process is called transfer learning. For another analogy, it\u2019s like a teacher (pre-trained model) transferring knowledge to a student (new model for the specific problem).", "There were 4 different sizes for the same image. I started with the highest resolution of 1024 x 1024 pixels because a higher quality image can help the computer \u2018look\u2019 at it because it\u2019s clearer, right? This process took one and a half hours while almost burning the GPU given to me.", "I literally fed a total of around 44, 000 HD images to the computer. But surprisingly, the accuracy was 86% with the default settings. In the end, I had to abandon this approach because my GPU frequently ran out of memory.", "It\u2019s amazing that it reached 86% accuracy in the first place. It\u2019s better than a guess, and probably better than my ability to look at x-rays. But how did it get there? I did not give any instructions or hints on how to look at the images other than saying which image is positive or not for the training test, but it was able to predict on the validation set without labels. How did the machine learn how to learn?", "To abstract ideas out of experience and observation is the fundamental characteristic of learning, and machines are getting better at it.", "Look at how this model got here. The source of a machine \u2018learning\u2019 is feeding it examples. From examples, like a human recalling experiences, it is able to find patterns. It\u2019s not rote-learning because it\u2019s able to generalize and be applied to new and unseen data. I did not code anything explicitly telling it how. It developed a rule by itself. To abstract ideas out of experience and observation is the fundamental characteristic of learning, and machines are getting better at it. So how could I, with zero experience in Radiology, tell a machine how to look at it? I didn\u2019t, and that\u2019s precisely why it learned.", "Going back, I was forced to use smaller images, so I opted for the 512 X 512 image size. I was surprised how faster it was compared to the previous run:", "My model achieved almost the same accuracy ten times faster. Wow.", "I was wrong. It can classify better at the same epochs compared to the previous version and almost half the resolution. My intuition was broken. Perhaps the model didn\u2019t had to have looked at unnecessary details that made the higher resolution present. If only I did it for another epoch, I could have gotten a higher initial accuracy. I spent the final hours tweaking the model to improve it.", "In the end, my classifier performed the best (the next one had ~71% accuracy), and it was combined with the segmentation model to complete the Pneumothorax detector. I had managed to use my scarce knowledge in deep learning to make a model that outperformed the other models made by professionals. This model wasn\u2019t built on sophisticated pre-processing techniques nor on elegant algorithms. Merely following some simple techniques showed and surprised me that I was able to build a model that can perform competitively and accurately.", "But along the way, I owe support from my teammates. I had asked the doctoral CS student to help me with Python callbacks and trying to override some pre-built functions in the fastai library. I got tips on how to pre-process the images (which unfortunately, I wasn\u2019t able to implement because I did not know how to code them) from the medical imaging analyst. I got help from our radiologist on how to identify where the Pneumothorax is manually. I also got help from a data engineer on how I can see what the model \u2018sees\u2019 through a heat map. There\u2019s still a lot of areas where I could improve the model, but I wouldn\u2019t have been able to build one in the first place without them.", "Most importantly, they shared their stories on how they got into Machine Learning. While most had the appropriate analytical backgrounds, such as degrees in biomedical engineering, computer science and pure mathematics, nobody learned it in the classroom. Whether it was a way to automate their tasks or augment their research insights, they were able to teach themselves by taking online courses, getting online certificates, and competing in Kaggle competitions.", "We\u2019re in this period where there are many unexplored areas for AI systems to be developed, and we\u2019re in the process of realizing the potential to improve our quality of life.", "This lack of availability of formal training and the existence of the Pneumothorax problem reflects the overall state of applying Artificial Intelligence as it currently transforms how we work. We\u2019re in this period where there are many unexplored areas for AI systems to be developed, and we\u2019re in the process of realizing the potential to improve our quality of life. Looking at the Pneumothorax problem alone, someone will develop a solution that won\u2019t require a radiologist in the process in the same way an autonomous car doesn\u2019t need a driver. Again, this has enormous applications in places that lack radiologists. Extend this to specialized jobs with scarce manpower.", "However, again, this extends to the harms such as reduction in labor and the lack of retraining for displaced workers, the use of AI to make unethical judgments, and the use of AI systems to target disenfranchised groups that perpetuate social and capital inequality. These will eventually become part of the main issues ordinary people will have to tackle in a similar way as poverty and politics, as it\u2019s only a matter of when such systems will dominate our lives in the same way the internet shapes most people\u2019s interactions with reality.", "The last thing this situation showed me is that the classroom is just isn\u2019t enough to learn about the world. It is never enough to have just the theory, and as long as real-world change with unique and unseen problems happens faster than the change in classroom instruction, the classroom curriculum won\u2019t catch up.", "You can have a background just as many people in my team did, but it can only give you an edge on certain areas. From gathering information, to training the model, and to visualization, these require specializations that usually cannot be done just by a single person. You\u2019ll need expertise within an area along with the flexibility to collaborate and understand other disciplines. These people took the time to learn Machine Learning because they realized it\u2019s a tool that can help them.", "Like them, I\u2019ll continue to learn and keep on practicing. Hopefully this isn\u2019t the only thing I train from scratch.", "The code I used is available as a jupyter notebook on my repository. Check it out!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Explorer looking for some adventures \ud83d\udeb4\ud83c\udffb\u200d\u2640\ufe0f. I try to speak in plain English. Connect with me at https://www.linkedin.com/in/ajsanjoaquin"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd776eb944399&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d776eb944399--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d776eb944399--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ajsanjoaquin?source=post_page-----d776eb944399--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajsanjoaquin?source=post_page-----d776eb944399--------------------------------", "anchor_text": "Ayrton San Joaquin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8ab1b9fa7122&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&user=Ayrton+San+Joaquin&userId=8ab1b9fa7122&source=post_page-8ab1b9fa7122----d776eb944399---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd776eb944399&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd776eb944399&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/ajsanjoaquin/funstuff/blob/master/Jesus_classifier.ipynb", "anchor_text": "first image classifier"}, {"url": "https://arxiv.org/abs/1803.09820", "anchor_text": "Fit one cycle policy"}, {"url": "https://arxiv.org/abs/1610.02391", "anchor_text": "how I can see what the model \u2018sees\u2019 through a heat map"}, {"url": "https://github.com/ajsanjoaquin/Pneumothorax/blob/master/Test_Ayrton.ipynb", "anchor_text": "repository"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----d776eb944399---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d776eb944399---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----d776eb944399---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/tag/learning-to-code?source=post_page-----d776eb944399---------------learning_to_code-----------------", "anchor_text": "Learning To Code"}, {"url": "https://medium.com/tag/beginner?source=post_page-----d776eb944399---------------beginner-----------------", "anchor_text": "Beginner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd776eb944399&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&user=Ayrton+San+Joaquin&userId=8ab1b9fa7122&source=-----d776eb944399---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd776eb944399&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&user=Ayrton+San+Joaquin&userId=8ab1b9fa7122&source=-----d776eb944399---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd776eb944399&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d776eb944399--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd776eb944399&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d776eb944399---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d776eb944399--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d776eb944399--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d776eb944399--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d776eb944399--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d776eb944399--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d776eb944399--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d776eb944399--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d776eb944399--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajsanjoaquin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajsanjoaquin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ayrton San Joaquin"}, {"url": "https://medium.com/@ajsanjoaquin/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "90 Followers"}, {"url": "https://www.linkedin.com/in/ajsanjoaquin", "anchor_text": "https://www.linkedin.com/in/ajsanjoaquin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8ab1b9fa7122&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&user=Ayrton+San+Joaquin&userId=8ab1b9fa7122&source=post_page-8ab1b9fa7122--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F8ab1b9fa7122%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-radiologist-from-scratch-d776eb944399&user=Ayrton+San+Joaquin&userId=8ab1b9fa7122&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}