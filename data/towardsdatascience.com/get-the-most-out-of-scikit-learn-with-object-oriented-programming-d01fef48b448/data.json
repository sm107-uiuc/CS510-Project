{"url": "https://towardsdatascience.com/get-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448", "time": 1683009975.35649, "path": "towardsdatascience.com/get-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448/", "webpage": {"metadata": {"title": "Get the Most out of scikit-learn with Object-Oriented Programming | by Andrew Alberts | Towards Data Science", "h1": "Get the Most out of scikit-learn with Object-Oriented Programming", "description": "As data scientists, we are all familiar with scikit-learn, one of the most used machine learning and data analysis libraries available in Python. I\u2019ve personally used it, along with pandas, for the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/", "anchor_text": "scikit-learn", "paragraph_index": 0}, {"url": "https://github.com/andrew-alberts/transformer-example/blob/master/sample_rfm_data.csv", "anchor_text": "data set", "paragraph_index": 3}, {"url": "https://www.investopedia.com/terms/r/rfm-recency-frequency-monetary-value.asp", "anchor_text": "recency, frequency, and monetary value", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "GridSearchCV", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Pipeline", "paragraph_index": 6}, {"url": "https://github.com/andrew-alberts/transformer-example/blob/master/custom_impute_transformer.py", "anchor_text": "CustomImputeTransformer", "paragraph_index": 7}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html", "anchor_text": "SimpleImputer", "paragraph_index": 12}, {"url": "https://github.com/andrew-alberts/transformer-example/blob/master/custom_impute_output_transformer.py", "anchor_text": "CustomImputeOutputTransformer", "paragraph_index": 19}, {"url": "https://docs.python.org/3/library/functions.html#super", "anchor_text": "super", "paragraph_index": 20}, {"url": "https://github.com/andrew-alberts/transformer-example/blob/master/verbose_output.txt", "anchor_text": "Github", "paragraph_index": 22}, {"url": "https://github.com/andrew-alberts/transformer-example", "anchor_text": "Github repo", "paragraph_index": 25}], "all_paragraphs": ["As data scientists, we are all familiar with scikit-learn, one of the most used machine learning and data analysis libraries available in Python. I\u2019ve personally used it, along with pandas, for the majority of my professional projects.", "It is only recently, however, that I have gotten the most out of scikit-learn when I needed to build a custom regression estimator. I was pleasantly surprised at how easy it was to create a new and compatible class of estimator, and this is all due to the object-oriented design of the scikit-learn components.", "In this article, I will walk you through a common data science workflow and demonstrate a use case for object-oriented programming (OOP). In particular, you will learn how to make a custom transformer object using the concept of inheritance, which allows us to extend the functionality of an existing class. Thanks to inheritance, this transformer will then easily fit into a scikit-learn pipeline to build a simple machine learning model.", "To illustrate things more clearly, let\u2019s work through a practical example inspired by marketing for a retailer. Suppose I have a data set where each record represents a customer and there are measurements (i.e. features) relating to purchase recency, frequency, and monetary value. Using these features, we would like to predict whether or not the customer will join the retailer\u2019s rewards card program. This emulates a real-world scenario where we want to predict which clients are the best targets for marketing. See a sample of the customer record data below:", "One noticeable quality of the data is missingness, the presence of missing values in the observations. These values will be rendered as NaN\u2019s once read by pandas and will not work in our machine learning model. To build our model, we will need to impute values (i.e. substitute missing values with inferred quantities) for the missing features. While there are a number of techniques for data imputation, for the sake of simplicity let\u2019s say we want to try either imputing the column mean or median for any missing value.", "So, which statistic should we use, the mean or the median? One easy way of finding out is by trying both options and assessing which yields the best performance in a grid search, maybe by using scikit-learn\u2019s GridSearchCV.", "One mistake would be to compute the mean and median on the entire training set and then impute with those values. To be more rigorous, we need to compute these statistics on the data excluding the holdout fold. This seems complicated, but thanks to OOP, we can easily implement our own transformer via inheritance which will be compatible with scikit-learn. From there, we can plug the transformer into a scikit-learn Pipeline, an object which sequences together with a list of transformer objects along with an estimator object, to build our model.", "To start building the class for our transformer, we will write the class definition and the constructor. Take special notice of the (TransformerMixin, BaseEstimator), this indicates we are inheriting from those two classes. This will make objects of the CustomImputeTransformer class we create compatible with other components of scikit-learn by providing an implementation for methods that will be expected by GridSearchCV (such as get_params) and indicating the objects we create are of the right type (e.g. transformers).", "Next, we will implement the fit method. Given a data set X, fit computes either the mean or median of each column that can be used for later imputation.", "Finally, we write the transform method. This method takes as an argument a data set we wish to transform and applies the already computed \u201cimpute values\u201d and fills the NaN values with them.", "Below is an example of using our custom transformer object on a small sample.", "Here are the results printed to the console:", "Note that the functionality we created is already available in scikit-learn in the SimpleImputer class. I\u2019ve decided to implement it from scratch here as it is easy to build and nicely demonstrates what you need to create a more complex transformer.", "We will create a pipeline to cascade the results of the custom transformer into a logistic regression model.", "Create the pipeline by passing a list of tuples. Each tuple has the name of the pipeline stage (Impute and Model in this example) and the object for either the transformer of the estimator.", "For the grid search, we will search to determine what type of imputation is best, hence the entry \u201cImpute__impute_type\u201d:[\u201cmean\u201d,\u201dmedian\u201d] in the param_grid.", "We will get the best pipeline and the training predictions from it. Notice that we can call the predict function on the best_pipe object. This effectively will first run transform from the CustomImputeTransformer then predict from the logistic regression.", "The output of the best pipeline and training accuracy is as follows.", "In the example, we made it clear that we need the transformer to compute statistics on all except the held out folds. To demonstrate that our code in fact does that, we will further harness inheritance to build an impute transformer object that does exactly what our initial transformer does, along with the added functionality of outputting the different statistics on each iteration of cross validation.", "We will again use inheritance to create CustomImputeOutputTransformer, a subclass of CustomImputeTransformer:", "The only function we need to implement is fit. In fact we will use the result from calling standard fit function using super, and simply augment it with console output as shown below.", "Now all we need to do is change the object we are using in the pipeline and monitor what the output is when we run it.", "For the sake of brevity, I\u2019ve visualized the output for one feature. You can see the actual printed output on Github.", "It behaves as expected. Every iteration of GridSearchCV is yielding the statistic on the four training folds rather than computing one global value.", "In this article, we learned about how to use inheritance, a foundational aspect of OOP, to solve a real-world data science problem. The example I showed is simple, however, you can use the same framework to build more complex classes for your projects.", "All the code, data, and results can be pulled from this Github repo. The example showed in this article is fully reproducible so feel free to pull the code and play with it yourself.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Intact Financial | Toronto ON | Views expressed are my own"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd01fef48b448&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d01fef48b448--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d01fef48b448--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aalberts_intact?source=post_page-----d01fef48b448--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aalberts_intact?source=post_page-----d01fef48b448--------------------------------", "anchor_text": "Andrew Alberts"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4a9b4e52a926&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&user=Andrew+Alberts&userId=4a9b4e52a926&source=post_page-4a9b4e52a926----d01fef48b448---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd01fef48b448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd01fef48b448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/", "anchor_text": "scikit-learn"}, {"url": "https://github.com/andrew-alberts/transformer-example/blob/master/sample_rfm_data.csv", "anchor_text": "data set"}, {"url": "https://www.investopedia.com/terms/r/rfm-recency-frequency-monetary-value.asp", "anchor_text": "recency, frequency, and monetary value"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "GridSearchCV"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Pipeline"}, {"url": "https://github.com/andrew-alberts/transformer-example/blob/master/custom_impute_transformer.py", "anchor_text": "CustomImputeTransformer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html", "anchor_text": "SimpleImputer"}, {"url": "https://github.com/andrew-alberts/transformer-example/blob/master/custom_impute_output_transformer.py", "anchor_text": "CustomImputeOutputTransformer"}, {"url": "https://docs.python.org/3/library/functions.html#super", "anchor_text": "super"}, {"url": "https://github.com/andrew-alberts/transformer-example/blob/master/verbose_output.txt", "anchor_text": "Github"}, {"url": "https://github.com/andrew-alberts/transformer-example", "anchor_text": "Github repo"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d01fef48b448---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----d01fef48b448---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd01fef48b448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&user=Andrew+Alberts&userId=4a9b4e52a926&source=-----d01fef48b448---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd01fef48b448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&user=Andrew+Alberts&userId=4a9b4e52a926&source=-----d01fef48b448---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd01fef48b448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d01fef48b448--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd01fef48b448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d01fef48b448---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d01fef48b448--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d01fef48b448--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d01fef48b448--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d01fef48b448--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d01fef48b448--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d01fef48b448--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d01fef48b448--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d01fef48b448--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aalberts_intact?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aalberts_intact?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrew Alberts"}, {"url": "https://medium.com/@aalberts_intact/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "34 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4a9b4e52a926&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&user=Andrew+Alberts&userId=4a9b4e52a926&source=post_page-4a9b4e52a926--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F4a9b4e52a926%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-the-most-out-of-scikit-learn-with-object-oriented-programming-d01fef48b448&user=Andrew+Alberts&userId=4a9b4e52a926&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}