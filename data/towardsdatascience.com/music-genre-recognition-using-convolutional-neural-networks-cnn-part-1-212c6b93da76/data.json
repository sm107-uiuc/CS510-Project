{"url": "https://towardsdatascience.com/music-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76", "time": 1683017404.82323, "path": "towardsdatascience.com/music-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76/", "webpage": {"metadata": {"title": "Music Genre Recognition using Convolutional Neural Networks (CNN) \u2014 Part 1 | by Kunal Vaidya | Towards Data Science", "h1": "Music Genre Recognition using Convolutional Neural Networks (CNN) \u2014 Part 1", "description": "Learn how to develop a deep learning model for recognising genre of music."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/analytics-vidhya/understanding-the-mel-spectrogram-fca2afa2ce53#:~:text=A%20mel%20spectrogram%20is%20a,converted%20to%20the%20mel%20scale.", "anchor_text": "Understanding the Mel Spectrogram | by Leland Roberts | Analytics Vidhya | Medium.", "paragraph_index": 10}, {"url": "https://www.linkedin.com/in/kunal-vaidya-0bab51198/", "anchor_text": "https://www.linkedin.com/in/kunal-vaidya-0bab51198/", "paragraph_index": 38}], "all_paragraphs": ["Music is so important to everyone\u2019 s life, it brings out so many emotions in us like nostalgia, excitement. Music can change someone\u2019s mood, get them productive, the possibilities are endless.", "I had just started out in this fascinating field of deep learning, and I was considering doing some project. I came across this problem of Music Genre Recognition and loved the thought of using Neural Networks to predict the genre of music and also I am also an avid listener of music; it was a perfect project for me; so I thought Let\u2019s Do It!", "This Article will feature two parts. In the first part, we will see the preprocessing of data and training of our deep learning model. In the second part, we will build an app and deploy it on Amazon EC2 Instance.", "Music Genre Recognition is an important field of research in Music Information Retrieval (MIR). A music genre is a conventional category that identifies some pieces of music as belonging to a shared tradition or set of conventions, i.e. it depicts the style of music.", "Music Genre Recognition involves making use of features such as spectrograms, MFCC\u2019s for predicting the genre of music.", "I am going to make use of GTZAN Dataset which is really famous in Music Information Retrieval (MIR). The Dataset comprises 10 genres namely Blues, Classical, Country, Disco, Hip Hop, Jazz, Metal, Pop, Reggae, Rock.", "Each genre comprises 100 audio files (.wav) of 30 seconds each that means we have 1000 training examples and if we keep 20% of them for validation then just 800 training examples.", "We can learn the genre of a song or music by listening to it for just 4\u20135 seconds so 30 seconds are little too much information for the model to take at once, that is why I decided to split a single audio file into 10 audio files each of 3 seconds.", "Now our training examples have become tenfold i.e. each genre has 1000 training examples and total training examples are 10,000. So we increased our dataset and this will be helpful for a deep learning model because it always requires more data.", "As we are going to use a Convolutional Neural Network, we need an image as an input, for this we will use the mel spectrograms of audio files and save the spectrograms as an image file (.jpg or .png).", "I will not dive into mel spectrograms as it will make this article a little long. You can read this article which talks about it Understanding the Mel Spectrogram | by Leland Roberts | Analytics Vidhya | Medium.", "Before we split the audio files make empty directories for each genre", "Above code block is pretty self-explanatory, it is just making empty directories to store audio files (after we split them) and their corresponding spectrograms.", "Note: I have not used Jazz genre because there was some error in generating mel spectrograms", "Now we will make use of AudioSegment from pydub package to split our audio files.", "So, there are three for loops here. First, we loop over the genres we have, then for that genre second for loop goes through every audio file of it, and third for loop splits the audio file into 10 parts and saves it into empty directories we created for audio files previously.", "Now we will use librosa to generate mel spectrograms for the audio files.", "The above code block will generate a mel spectrogram for each audio file in every genre and save them according to their genre in empty directories we created in step 1.", "Note: This step might take a long time to complete because there are almost 10000 mel spectrograms to be generated corresponding to 10000 audio files so, be patient :).", "Now we have our complete data so, we need to split the data into training set and validation set. Our complete data is in spectrograms3sec/train directory so, we need to take part of the complete data and move it to our test directory.", "For each genre, we randomly shuffle filenames, select top 100 filenames and move them to test/validation directory.", "Above image shows our train directory structure (same for test directory as well). We have prepared our data in such a way to make use of the amazing ImageDataGenerator in keras, it is very helpful for training model on large datasets.", "We will create data generators for both training and testing set", "flow_from_directory() method automatically infers the labels using our directory structure and encodes them accordingly.", "ImageDataGenerator makes training on large datasets simple by using the fact that during training model gets trained on only one batch per step so, while training, data generator just loads one batch into memory at a time so, there is no exhaustion of memory resources.", "We will build our CNN model using keras", "Model comprises 5 Convolutional layers, then a Dropout layer to avoid over-fitting and finally Dense layer with Softmax activation to output class probabilities.", "Now, we will finally train our model on the dataset we prepared", "get_f1() is used to compute the f1_score, and for using data generators while training we use fit_generator() method.", "After training for 70 epochs, I got training accuracy of 99.57%, and on validation 89.03%.So, we got really good accuracy on validation, this is due to splitting of audio files into 10 equal parts.", "I also trained the model on original GTZAN dataset which comprised 1000 audio files of 30s each and got accuracy of around 50%, so splitting audio files into parts increased our accuracy drastically.", "Now, I will pick some songs and try to recommend genre of that song using our model.", "2. She will be loved \u2014 Maroon 5", "3. Viva la Vida \u2014 Coldplay (My favourite song :P )", "So, we can see model is producing very good predictions, it correctly predicted all song\u2019 genres.", "We saw how to develop a Convolutional neural network for music genre recognition. This was part 1, in the next part we will build an app for music genre recognition and deploy it on Amazon EC2 instance.", "I am new to writing on medium, please let me know if you like it, Thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Enjoying in this fascinating world of Data Science. Let\u2019s connect on LinkedIn https://www.linkedin.com/in/kunal-vaidya-0bab51198/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F212c6b93da76&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----212c6b93da76--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----212c6b93da76--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kunalvaidya-58402.medium.com/?source=post_page-----212c6b93da76--------------------------------", "anchor_text": ""}, {"url": "https://kunalvaidya-58402.medium.com/?source=post_page-----212c6b93da76--------------------------------", "anchor_text": "Kunal Vaidya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe919dc869e73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&user=Kunal+Vaidya&userId=e919dc869e73&source=post_page-e919dc869e73----212c6b93da76---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F212c6b93da76&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F212c6b93da76&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mitch_peanuts?utm_source=medium&utm_medium=referral", "anchor_text": "Mike Giles"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/analytics-vidhya/understanding-the-mel-spectrogram-fca2afa2ce53#:~:text=A%20mel%20spectrogram%20is%20a,converted%20to%20the%20mel%20scale.", "anchor_text": "Understanding the Mel Spectrogram | by Leland Roberts | Analytics Vidhya | Medium."}, {"url": "https://github.com/KunalVaidya99/Music-Genre-Classification", "anchor_text": "KunalVaidya99/Music-Genre-ClassificationMusic Genre Classification using GTZAN Dataset.Here is the Link to Dataset GTZAN Dataset I Made a Web App using\u2026github.com"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----212c6b93da76---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/audio-processing?source=post_page-----212c6b93da76---------------audio_processing-----------------", "anchor_text": "Audio Processing"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----212c6b93da76---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/data-science?source=post_page-----212c6b93da76---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F212c6b93da76&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&user=Kunal+Vaidya&userId=e919dc869e73&source=-----212c6b93da76---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F212c6b93da76&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&user=Kunal+Vaidya&userId=e919dc869e73&source=-----212c6b93da76---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F212c6b93da76&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----212c6b93da76--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F212c6b93da76&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----212c6b93da76---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----212c6b93da76--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----212c6b93da76--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----212c6b93da76--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----212c6b93da76--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----212c6b93da76--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----212c6b93da76--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----212c6b93da76--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----212c6b93da76--------------------------------", "anchor_text": ""}, {"url": "https://kunalvaidya-58402.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kunalvaidya-58402.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kunal Vaidya"}, {"url": "https://kunalvaidya-58402.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "16 Followers"}, {"url": "https://www.linkedin.com/in/kunal-vaidya-0bab51198/", "anchor_text": "https://www.linkedin.com/in/kunal-vaidya-0bab51198/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe919dc869e73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&user=Kunal+Vaidya&userId=e919dc869e73&source=post_page-e919dc869e73--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faacd8ce91131&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-recognition-using-convolutional-neural-networks-cnn-part-1-212c6b93da76&newsletterV3=e919dc869e73&newsletterV3Id=aacd8ce91131&user=Kunal+Vaidya&userId=e919dc869e73&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}