{"url": "https://towardsdatascience.com/how-to-quantify-the-prediction-error-made-by-my-model-db4705910173", "time": 1683015301.6082969, "path": "towardsdatascience.com/how-to-quantify-the-prediction-error-made-by-my-model-db4705910173/", "webpage": {"metadata": {"title": "Using Monte Carlo to quantify the model prediction error | by Shuai Guo | Towards Data Science", "h1": "Using Monte Carlo to quantify the model prediction error", "description": "As a data scientist working in the engineering field, I frequently collaborate with other research engineers on the physics side, with the task of developing quantitative models to predict physical\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/managing-uncertainty-in-computational-science-and-engineering-5e532085512b", "anchor_text": "Managing uncertainty in computational science and engineering.", "paragraph_index": 8}, {"url": "https://sciencenotes.org/projectile-motion-example-problem-physics-homework-help/", "anchor_text": "link", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "normal distribution", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Continuous_uniform_distribution", "anchor_text": "uniform distribution", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Latin_hypercube_sampling", "anchor_text": "Latin hypercube sampling", "paragraph_index": 24}, {"url": "https://en.wikipedia.org/wiki/Low-discrepancy_sequence", "anchor_text": "low-discrepancy sequences", "paragraph_index": 24}, {"url": "https://shuaiguo.medium.com/", "anchor_text": "Medium", "paragraph_index": 28}, {"url": "https://www.linkedin.com/in/shuaiguo16/", "anchor_text": "Linkedin", "paragraph_index": 28}], "all_paragraphs": ["Prediction is very difficult, especially if it\u2019s about the future. \u2014 Niels Bohr", "As a data scientist working in the engineering field, I frequently collaborate with other research engineers on the physics side, with the task of developing quantitative models to predict physical phenomena of interest. However, getting a reliable prediction is never easy, mostly it\u2019s because I can rarely be sure about the correct values of the model hyperparameters. Those hyperparameters, which convey specific physical interpretations, are usually calibrated via noisy experiments. As a result, there is no way to be sure of their exact values due to the randomness inherent in the calibration process. Simply put, those hyperparameters are uncertain.", "I am usually left with two options: one, I can just pick the nominal values (or most probable values) of the hyperparameters and make predictions based on them, hoping that the obtained results are accurate or at least close to the truth; second, I can accept the fact that those hyperparameters are uncertain, and use proper uncertainty propagation techniques to propagate the uncertainties from model hyperparameters to the prediction error/uncertainty of the model.", "In practice, the second option is usually preferred. In that scenario, the prediction output will not just be a single value. Instead, we will get a full probability distribution of it. This is advantageous since the outcome of this option is more informative, as it offers us a measure of confidence associated with our prediction, thus achieving our goal of quantifying the prediction error.", "In this article, we will introduce a useful technique to realize uncertainty propagation and quantification of prediction error. The remaining of the article is structured as follows:", "As described previously, a modeler often needs to battle the issue of uncertain hyperparameters, which can easily compromise the reliability of the model prediction. Under this background, forward uncertainty propagation strategies are proposed to fully consider the input parameter uncertainties and quantify the induced prediction uncertainty.", "Formally, the primary goal of the forward uncertainty quantification is to assess the variation of the output under the influence of various input uncertainties.", "Forward here means that uncertainty information is flowing from the inputs, through the physical model under investigation, towards the output. Depending on the analyst\u2019s goal, the focus of forward uncertainty propagation could be on simply estimating the basic statistics (e.g., mean, variance, etc.) of the output, or the probability of the output value exceeding a certain threshold (i.e. risk analysis), or the entire probability density function (PDF) of the output.", "Forward uncertainty propagation belongs to a larger study field of uncertainty management in computational science and engineering, where propagation constitutes a major step towards the management goal. Readers can find more details of uncertainty management in my previously published blog: Managing uncertainty in computational science and engineering.", "In practice, several methods are designed to deliver the desired forward uncertainty propagation. Those methods include the probabilistic analytical approach, perturbation approach, spectral approach, etc. Generally, those approaches involve heavy mathematical derivations and their implementations are far from straightforward. In addition to that, they may only be valid for specific problems and may only be accurate when the uncertainty levels of the hyperparameters are small. Consequently, those approaches are not yet widely adopted in industrial practices and will not be discussed in this article. Instead, we will be focusing on a much more popular approach: Monte Carlo simulation.", "Intuitively understandable, easy to implement, no extra modification to the model (or non-intrusive, if you prefer the technical jargon), highly parallelizable, make minimal assumptions about the model and its associated hyperparameters. Sounds like the approach that every practitioner would love, right? Indeed, it is exactly those features that make Monte Carlo simulation the most popular approach in realizing uncertainty propagation.", "Technically speaking, Monte Carlo simulation involves drawing random samples from input probability distributions and calculating the corresponding response of each sample using one\u2019s model. The statistics of the output can then be inferred based on the obtained ensemble of results.", "The workflow of the Monte Carlo simulation can be summarized as the following:", "As you may have noticed, to kick off a Monte Carlo simulation, we need to know the probability distribution of the uncertain model hyperparameters. This is important as how the inputs are statistically modeled will directly affect the output uncertainty. In practice, Bayesian statistics are usually employed to derive the target probability distribution from existing data (e.g., experimental and computational). In other situations, those probability distributions may be simply assigned by domain experts based on their experience and judgment. In that case, epistemic uncertainty may be introduced in the statistical modeling of the uncertain hyperparameters.", "Now, let\u2019s see how Monte Carlo simulation is employed in practice. Here we consider a projectile motion problem and we are interested in calculating the shooting range of a cannon. In real life, this analysis could be used to derive the probability of successfully destroying an enemy target.", "Our physical model is a simple one, where the shooting range R is determined by the initial velocity v\u2080, shooting angle \u03b8, as well we the gravity acceleration g, as shown in Fig. 2 (if you are interested in how to derive this equation, here is the link). It\u2019s a simple model since the effect of air resistance is not considered. Nevertheless, it is good enough for our demonstration purpose.", "Now, suppose that we are not so sure about the values of v\u2080 and \u03b8, but we do know that g=9.8m/s\u00b2. Therefore, in our current case study, v\u2080 and \u03b8 are treated as the uncertain model hyperparameters. To describe their uncertainty, we choose a normal distribution for v\u2080 and a uniform distribution for \u03b8:", "For the initial velocity v\u2080, its mean value is 150m/s, with a standard deviation value of 5m/s. For the shooting angle \u03b8, its uncertainty range is from 40\u1d52 to 50\u1d52. Due to the uncertainty embedded in the model hyperparameters (v\u2080 and \u03b8), our prediction of shooting range R will also be uncertain. Now our goal is to quantify exactly how uncertain our R prediction will be and derive its full probability distribution.", "Time to apply the Monte Carlo procedure. Following the steps outlined in the previous section, we firstly draw 10000 random samples of v\u2080 and \u03b8 from their respective distributions (Fig. 3). For that, the random number generator from Numpy can be utilized. Subsequently, for each combination of v\u2080 and \u03b8, we calculate the corresponding R value.", "Figure 4(a) depicts several calculated trajectories based on some selected samples of v\u2080 and \u03b8. We can see that those trajectories are quite different when initial shooting conditions (i.e., v\u2080 and \u03b8) are varying. This indicates that the impact of the uncertainties in v\u2080 and \u03b8 is non-negligible.", "The corresponding histogram of R is shown in Fig. 4(a). Here, we can see that the distribution of the shooting range R exhibits a bell shape, which centers around 2270m. This is also called the most probable value of R. On the other hand, the red dashed line, which has an R value of 2296m, is calculated by using the nominal values of v\u2080 and \u03b8, i.e., 150m/s and 45\u1d52. Notice that those two R values are not the same. This is common when the underlying model is nonlinear (as in our current case). This observation also informs us that simply plugging in the most probable values of the inputs would in general not yield the most probable value of the output. This signifies the importance of performing a rigorous uncertainty propagation analysis.", "As every coin has two sides, the Monte Carlo approach also has its own shortcoming. In the section, we will discuss the major challenge and possible remedies when implementing the Monte Carlo technique in practice.", "The main criticism of the Monte Carlo method lies in its slow convergence rate. This means that we need a large number of samples (\u223c o(10\u2074)) to ensure the reliability of the Monte Carlo results. Consequently, we need to repeatedly calculate the model prediction for each sample, thus potentially inducing prohibitive computational cost. In the following, we introduce two popular ways to combat this convergence issue.", "The first thing we could do is to improve the sampling scheme when using the Monte Carlo method. Naive Monte Carlo approach utilizes random sampling to do the job. That sampling scheme is not particularly good as it creates obvious \u201cclusters\u201d and \u201choles\u201d in the parameter space (we will illustrate this later). As a result, we would need a lot of samples to cover the whole parameter space.", "Instead, researchers have proposed more advanced sampling schemes with better \u201cspace-filling\u201d properties, meaning that those schemes can generate samples more evenly across the parameter space. Examples in this category include Latin hypercube sampling, as well as Sobol sequences and Halton sequences, which are all low-discrepancy sequences.", "Figure 5 compares various sampling schemes applied to a 2D parameter space, with the same number of samples. Here we can see that a random sampling scheme tends to form clumps and leave voids, while other advanced sampling schemes are capable of generating more \u201cspace-filling\u201d samples.", "Another way to circumvent the issue of high computational cost is by adopting the surrogate modeling techniques. The core idea behind this is to train a cheap statistical model to approximate (or \u201csurrogate\u201d) the original physical model, e.g., the projectile motion model in Fig. 2. Afterward, the Monte Carlo approach can be directly applied to the trained statistical model. Since one evaluation of the statistical model involves negligible computational cost, the overall expense of the Monte Carlo procedure becomes affordable.", "At the core of surrogate modeling is the supervised machine learning, as the goal is to train a surrogate model based on input data and the corresponding labeled output data. Many machine learning techniques, such as support vector machine, Gaussian process, neural network, etc., have already been employed in accelerating Monte Carlo simulations. As more and more powerful machine learning techniques are constantly being developed, we can expect that the accuracy and efficiency of Monte Carlo simulations will be further improved.", "I\u2019m a Ph.D. researcher working on uncertainty quantification and reliability analysis for aerospace applications. Statistics and data science form the core of my daily work. I love sharing what I\u2019ve learned in the fascinating world of statistics. Check my previous posts to find out more and connect with me on Medium and Linkedin.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist, aerospace engineer, specialized in statistical modeling and uncertainty analysis for reliable system design."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdb4705910173&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----db4705910173--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db4705910173--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://shuaiguo.medium.com/?source=post_page-----db4705910173--------------------------------", "anchor_text": ""}, {"url": "https://shuaiguo.medium.com/?source=post_page-----db4705910173--------------------------------", "anchor_text": "Shuai Guo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b08bf52bf9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&user=Shuai+Guo&userId=7b08bf52bf9c&source=post_page-7b08bf52bf9c----db4705910173---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb4705910173&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb4705910173&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/managing-uncertainty-in-computational-science-and-engineering-5e532085512b", "anchor_text": "Managing uncertainty in computational science and engineering."}, {"url": "https://sciencenotes.org/projectile-motion-example-problem-physics-homework-help/", "anchor_text": "link"}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "normal distribution"}, {"url": "https://en.wikipedia.org/wiki/Continuous_uniform_distribution", "anchor_text": "uniform distribution"}, {"url": "https://en.wikipedia.org/wiki/Latin_hypercube_sampling", "anchor_text": "Latin hypercube sampling"}, {"url": "https://en.wikipedia.org/wiki/Low-discrepancy_sequence", "anchor_text": "low-discrepancy sequences"}, {"url": "https://shuaiguo.medium.com/", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/shuaiguo16/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/data-science?source=post_page-----db4705910173---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/uncertainty?source=post_page-----db4705910173---------------uncertainty-----------------", "anchor_text": "Uncertainty"}, {"url": "https://medium.com/tag/monte-carlo?source=post_page-----db4705910173---------------monte_carlo-----------------", "anchor_text": "Monte Carlo"}, {"url": "https://medium.com/tag/engineering?source=post_page-----db4705910173---------------engineering-----------------", "anchor_text": "Engineering"}, {"url": "https://medium.com/tag/statistics?source=post_page-----db4705910173---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb4705910173&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&user=Shuai+Guo&userId=7b08bf52bf9c&source=-----db4705910173---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb4705910173&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&user=Shuai+Guo&userId=7b08bf52bf9c&source=-----db4705910173---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb4705910173&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db4705910173--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdb4705910173&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----db4705910173---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----db4705910173--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----db4705910173--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----db4705910173--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----db4705910173--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----db4705910173--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----db4705910173--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----db4705910173--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----db4705910173--------------------------------", "anchor_text": ""}, {"url": "https://shuaiguo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://shuaiguo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shuai Guo"}, {"url": "https://shuaiguo.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "404 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b08bf52bf9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&user=Shuai+Guo&userId=7b08bf52bf9c&source=post_page-7b08bf52bf9c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F853a13978270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-quantify-the-prediction-error-made-by-my-model-db4705910173&newsletterV3=7b08bf52bf9c&newsletterV3Id=853a13978270&user=Shuai+Guo&userId=7b08bf52bf9c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}