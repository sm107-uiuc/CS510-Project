{"url": "https://towardsdatascience.com/predicting-product-quality-using-customer-reviews-ac1a215226d1", "time": 1683006971.724267, "path": "towardsdatascience.com/predicting-product-quality-using-customer-reviews-ac1a215226d1/", "webpage": {"metadata": {"title": "Predicting Product Quality using Customer Reviews | by Michel Kana, Ph.D | Towards Data Science", "h1": "Predicting Product Quality using Customer Reviews", "description": "A deep dive into Bayesian concepts: maximum likelihood, maximum a posteriori, posterior mean estimate, posterior predictive estimate and credible interval."}, "outgoing_paragraph_urls": [{"url": "https://docs.pymc.io", "anchor_text": "PyMC3", "paragraph_index": 25}], "all_paragraphs": ["In a competitive market, the success of a company is built on satisfying the exacting standards of a consumer base with refined and discriminating taste. In particular, customer product reviews are all important. But how should we judge the quality of a product based on customer reviews?", "In this article, we build statistical models to compare two virtual products (Lotus World versus Toysmith) using the observed rating from customer reviews. In particular, we are looking at the number of times a product is rated a given rating (between 1 and 5 stars).", "Customer ratings are analyzed using Bayesian concepts such as maximum likelihood, maximum a posteriori, posterior mean estimate, posterior predictive estimate and credible interval.", "If you need a refresher about probabilities and distributions, the article below could be the right fit.", "We are interested in estimating \u03b8i the probability that customers rate with i number of stars. Since each new rating has a value between 1 and 5, it follows a categorical distribution Cat(\u03b8).", "For a given product, we are given a vector of ratings R=[r1,r2,r3,r4,r5]. Each rating r_i is the total number of i-star reviews. Each i-star review is made with probability \u03b8i. We see that each review r is independent of the others and is modeled by a categorical distribution:", "The likelihood of observing a vector of occurrences R out of N independent reviews is given by the multinomial distribution parametrized by \u03b8:", "The log-likelihood will be given by:", "Now we can calculate the Maximum Likelihood Estimator (MLE) of \u03b8 for each of both products. We need to find the \u03b8 that maximizes the likelihood L. We are going to need to differentiate the likelihood function with respect to \u03b8. However, we can\u2019t just go ahead and do it. We have to take the constraint into accounts, we have to use the Lagrange multipliers.", "By posing all the derivatives to be 0, we get the most natural estimate:", "Therefore the maximum likelihood estimators are given below:", "Based on this MLE of \u03b8 for both models, do you feel confident deciding if one product is superior to another? This is not straightforward. However, we can compute the Maximum Likelihood (ML) and the Akaike Information Criterion (AIC) to answer the question. The preferred model is the one with the minimum AIC value and maximum ML as shown below.", "The Lotus World product seems to be superior to Toysmith. How uncertain are we about this?", "The maximum likelihood approach finds parameter values \u03b8 such that they maximize the likelihood that the review process described by the model produced the data that was actually observed.", "As we explained in our previous article below, one drawback of MLE is the impossibility to include our prior belief about those parameters we are estimating.", "Suppose we are told that customer opinions are very polarized in the market.", "Most reviews will be 5 stars or 1 star, with very few of them in the middle ground. A Dirichlet prior on \u03b8 would greatly capture this fact. The Dirichlet distribution is sampling over a probability simplex, a bunch of numbers that add up to 1.", "Dirichlet models the probabilities of multiple, mutually exclusive choices, parameterized by \u03b1 which is referred to as the concentration parameter and represents the weights for each choice.", "If we would like to produce consistently fair reviews, then \u03b1\u2192\u221e. For a symmetric Dirichlet distribution with \u03b1>1, we will produce a fair review, on average. If the goal is to produce biased reviews, with a higher probability of 1 and 5 stars, we would want an asymmetric Dirichlet distribution with a higher value for \u03b11 and \u03b15. Below we suggest an example of asymmetric alphas.", "The Bayesian approach can be seen as an extension of maximum likelihood estimation. When we have data, priors, and a generative model, we can apply Bayes theorem to compute the posterior probability distribution of the model parameters conditionally upon the data as follows.", "It is common to summarize the posterior distribution to find some central tendency. The Maximum A Posteriori (MAP) or posterior mode is the point with the highest posterior probability, given by:", "Below we implement the formula to compute MAP for Lotus World versus Toysmith. This gives us an idea of a more realistic probability of ratings we could expect in the future. For example, the likelihood for a customer to provide a 5-star rating to Lotus World is rather 65%, after considering the prior belief of asymmetric reviews. The MLE model provided a bit more optimistic value for that probability (67%). By including prior belief from domain experts, the Bayesian approach only allows estimates which are more close to the business reality.", "If we set \u03b1 to 1, then we obtain the maximum likelihood estimate for \u03b8i.", "The Posterior Mean Estimate or expected value is the mean or mode of the posterior distribution. For our problem, it is given by the formula below.", "So far we have computed the posterior distribution analytically by hand. Although it is conceptually simple, this approach can be incredibly slow and scale horribly with a large dataset.", "There are faster methods, mostly within the so-called Markov chain Monte Carlo (MCMC) family of algorithms. Below we implement MCMC to find the posterior distribution of the model parameters using the Python library PyMC3. This allows us to sample 1000s rating vectors from the posterior predictive for each product and to summarize the Posterior Predictive Estimates for theta.", "While Posterior Mean Estimates and Maximum A Posterior Estimates are very similar, both are quite different from Maximum Likelihood Estimates.", "The credible interval tells us the possible range of values of an unobserved parameter value with a particular probability. This is not to be confused with the confidence interval, which does not capture our current uncertainty in the location of the parameter values.", "Below we use the posterior distribution (samples from it) to compute the 95% credible interval of \u03b8 for each product.", "The credible intervals for posterior mean estimates above are on average narrower for Toysmith. We might tend to add more trust to the reviews made on the Toysmith product.", "Which point estimate (MAP, MLE, posterior mean PME, or posterior predictive estimate) of \u03b8 would you choose to rank the two products?", "The average rating does not take prior belief into consideration, such as skewed ratings towards 1 and 5 stars. As we demonstrated above the probability that a customer would give a specific review is more credible when including priors.", "In our example, we would choose for the posterior mean estimate (PME). MLE and MAP are similar, as they compute a single estimate, instead of a full distribution. MLE is a special case of MAP, where the prior is uniform! PME or posterior predictive estimate is drawn from the posterior predictive distribution, which is the distribution of possible parameters. Therefore PME will provide a more credible prediction that will become even more accurate with increasing data volume.", "We have applied the Bayesian approach to detect the perceived quality of two products based on customer ratings. Python code was provided for a practical demonstration.", "Feel free to learn more about the Bayesian approach in my next article below.", "I further recommend the following resources:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Husband & Dad. Mental health advocate. Top Medium Writer. 20 years in IT. AI Expert @Harvard. Empowering human-centered organizations with high-tech."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac1a215226d1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://michel-kana.medium.com/?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": "Michel Kana, Ph.D"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb0b01fe20d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=post_page-cb0b01fe20d2----ac1a215226d1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac1a215226d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac1a215226d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/banner-easter-egg-colored-colorful-1255730/", "anchor_text": "Pixabay"}, {"url": "https://www.amazon.com/Toysmith-1322-Squawkin-Chicken/dp/B0009Z3MQU", "anchor_text": "amazon.com"}, {"url": "https://towardsdatascience.com/understanding-probability-finally-576d54dccdb5", "anchor_text": "Understanding probability. Finally!Practical guide to probability concepts for data scientiststowardsdatascience.com"}, {"url": "https://towardsdatascience.com/bayesian-nightmare-how-to-start-loving-bayes-1622741fa960", "anchor_text": "Bayesian nightmare. Solved!Gentle introduction to Bayesian data analysis by examples and code in Python PyMC3.towardsdatascience.com"}, {"url": "https://docs.pymc.io", "anchor_text": "PyMC3"}, {"url": "https://towardsdatascience.com/introduction-to-bayesian-logistic-regression-7e39a0bae691", "anchor_text": "Introduction to Bayesian Logistic RegressionA practical demonstration of the Bayesian approach to classification using Python and PyJAGS.towardsdatascience.com"}, {"url": "http://www.stat.cmu.edu/~larry/=sml/Bayes.pdf", "anchor_text": "Bayesian Inference"}, {"url": "http://users.cecs.anu.edu.au/~ssanner/MLSS2010/Johnson1.pdf", "anchor_text": "Bayesian Inference for Dirichlet-Multinomials"}, {"url": "https://towardsdatascience.com/calogica-com-dice-polls-dirichlet-multinomials-eca987e6ec3f", "anchor_text": "Dice, Polls & Dirichlet Multinomials"}, {"url": "https://medium.com/tag/statistics?source=post_page-----ac1a215226d1---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ac1a215226d1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac1a215226d1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----ac1a215226d1---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ac1a215226d1---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac1a215226d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=-----ac1a215226d1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac1a215226d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=-----ac1a215226d1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac1a215226d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac1a215226d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac1a215226d1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac1a215226d1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac1a215226d1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac1a215226d1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac1a215226d1--------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michel Kana, Ph.D"}, {"url": "https://michel-kana.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb0b01fe20d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=post_page-cb0b01fe20d2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F69e95067d2a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-product-quality-using-customer-reviews-ac1a215226d1&newsletterV3=cb0b01fe20d2&newsletterV3Id=69e95067d2a1&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}