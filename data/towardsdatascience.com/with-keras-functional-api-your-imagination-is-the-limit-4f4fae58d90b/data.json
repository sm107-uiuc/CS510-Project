{"url": "https://towardsdatascience.com/with-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b", "time": 1683013565.2725172, "path": "towardsdatascience.com/with-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b/", "webpage": {"metadata": {"title": "With Keras\u2019 Functional API, Your Imagination is the Limit | by Andre Ye | Towards Data Science", "h1": "With Keras\u2019 Functional API, Your Imagination is the Limit", "description": "Most people are familiar with building sequential models, in which layers follow each other one by one. For instance, in a convolutional neural network, we may decide to pass images through a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/the-clever-trick-behind-googles-inception-the-1-1-convolution-58815b20113", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://medium.com/@andre_ye/a-short-practical-programmers-guide-to-graph-theory-bfc87bc52581?source=---------20------------------", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://keras.io/guides/functional_api/", "anchor_text": "here", "paragraph_index": 31}, {"url": "https://andre-ye.medium.com/membership", "anchor_text": "https://andre-ye.medium.com/membership", "paragraph_index": 36}], "all_paragraphs": ["Most people are familiar with building sequential models, in which layers follow each other one by one. For instance, in a convolutional neural network, we may decide to pass images through a convolutional layer, a max pooling layer, a flattening layer, then a dense layer. These standard constructions of networks are known as \u2018linear topologies\u2019.", "However, many high-performing networks are not linear topologies, for example the Inception module, core to the top Inception model. In the module, an input from one layer is passed into four separate layers, which are concatenated back into one output layer. (You can read more about the Inception module and the purpose of a 1x1 convolution here.)", "Nonlinear topologies allow for an input to be passed through different mediums of interpretation, which can later be concatenated to produce global insights. This is similar to how the President may give several copies of a potential law to their cabinet (advisors), which will each give their own take from the perspective of the environment, national security, small businesses, etc. It\u2019s an efficient way to extract the maximum information possible.", "Alternatively, you can use them to create skip connections \u2014 core to the successful ResNet (Residual Network) \u2014 and other complex relationships unimaginable in a sequential setting.", "Keras\u2019 functional API allows for you to create all sorts of topologies, not only to optimize the internal structure of a network, but to handle problems that require multiple inputs or outputs.", "For instance, consider a network that evaluates a house\u2019s value and classifies it into one of 3 classes based on images (lawn, kitchen, exterior, etc.), numerical data (square feet, bedrooms), and text data (testimonials from previous owners/neighbors). We\u2019ll create a network that can do this.", "The Functional API treats a network as a directed acyclic graph, so dynamic architectures are not supported. From here, it will be better to think of layers as nodes in a computational graph and inputs as traversing through the graph\u2019s edges and nodes. (Read more about the foundations of graph theory for coders here.) We\u2019ll explore the functional API in three progressive steps:", "Let\u2019s begin by creating a sequential graph using the functional API. Our target graph will have three layers in one-by-one format:", "First, let\u2019s begin by creating an input node so that Keras knows what to expect in terms of the shape of the data.", "Next, let\u2019s begin adding the first dense layer. Adding layers is the same as with sequential models, but there\u2019s one difference \u2014 we are defining nodes instead of using .add() or as a list of sequential layers. Every time we add a new layer, we are actually defining a new node in relation to a previous node, instead of to an entire model structure. That part comes last.", "For instance, this Dense layer is a node whose previous node was defined as the variable inputs (the Input node).", "We can define the next nodes in a sequence accordingly:", "At this point, we have several variables (nodes) that are interconnected with each other. In order to turn this graph into a Keras neural network, use the keras.Model constructor, which requires the input and output nodes, as well as a name identifier.", "At this point, call model.summary() to view the model structure.", "Let\u2019s call keras.utils.plot_model(model, \u201cm1.png\u201d) to view a visualization of the model\u2019s structure.", "Great! Time to create nonlinear topologies.", "Let\u2019s begin constructing some nonlinear topologies. In our neural network, the inputs will lead to two branches, which will eventually concatenate and lead to an output.", "Let\u2019s begin by creating an input node and the two nodes it branches to. Note that it\u2019s highly encouraged to assign meaningful names to nodes for a clear and organized understanding of the graph, instead of commonly used but easily misunderstood notation x = layer()(x).", "Next, let\u2019s define the two nodes that follow the two previously defined nodes.", "When two or more nodes are concatenated, they are put end-to-end into one large vector, which is passed into the next node. The concatenate layer simply takes in a list of nodes to concatenate, and the results of this layer are then passed into another outputs node. Finally, the entire graph is compiled into a model.", "Our model is exactly as we imagined it! By envisioning a graph-based model of a neural network, we can make any network we can imagine.", "Let\u2019s explore how we can use different inputs of different sizes and different outputs. Say we have three inputs \u2014 64x64 images, 16 columns of numerical data, and variable-length text. We will want to output two values: one continuous value (e.g. house price) and another discrete value (3 classes).", "Let\u2019s first construct the three inputs with corresponding sizes and names.", "Next, let\u2019s start by processing the images. We\u2019ll use a standard convolutional neural network simple structure, or alternative convolutional and max pooling layers, followed by a flattening so it can be concatenated.", "Let\u2019s process the numerical inputs with standard dense layers.", "Lastly, the text data can be processed with embeddings and recurrent layers.", "Now that each of the specific data types have been reduced to vectors, we can begin concatenating them. Let\u2019s first concatenate and reduce the text and image vectors, since they are especially long. We can use Dropout to further improve generalization and reduce overfitting on specific data.", "Finally, let\u2019s concatenate the image_text combination and the numerical data together and form two outputs.", "When we form our model, we will need to pass in a list of inputs and outputs.", "The result is a behemoth of a network created in a few minutes:", "To train the network, data must be in dictionaries according to the names of inputs and outputs. For instance, the x training data would be in the form", "For more information on training complex models with multiple inputs and outputs, refer to the Keras documentation here.", "There are many reasons to use the functional API, even if you\u2019re not using it for multiple inputs or outputs, which is one primary reason for usage.", "The possibilities are endless when you use the Functional API!", "Check out AutoKeras, a neural architecture search library that automatically builds architectures (often nonlinear) for you:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML enthusiast. Join Medium through my referral link: https://andre-ye.medium.com/membership."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4f4fae58d90b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andre-ye.medium.com/?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": "Andre Ye"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe743a65b006&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&user=Andre+Ye&userId=be743a65b006&source=post_page-be743a65b006----4f4fae58d90b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f4fae58d90b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f4fae58d90b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/ApfyUz5c5Q0", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/the-clever-trick-behind-googles-inception-the-1-1-convolution-58815b20113", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1409.4842.pdf", "anchor_text": "Inception paper"}, {"url": "https://medium.com/@andre_ye/a-short-practical-programmers-guide-to-graph-theory-bfc87bc52581?source=---------20------------------", "anchor_text": "here"}, {"url": "https://keras.io/guides/functional_api/", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/gans-for-everyone-an-intuitive-explanation-of-the-revolutionary-concept-2f962c858b95", "anchor_text": "encoder-decoders"}, {"url": "https://medium.com/analytics-vidhya/11-essential-neural-network-architectures-visualized-explained-7fc7da3486d8", "anchor_text": "generative adversarial networks"}, {"url": "https://towardsdatascience.com/10-invaluable-tips-tricks-for-building-successful-neural-networks-566aca17a0f1?source=your_stories_page---------------------------", "anchor_text": "existing pretrained networks"}, {"url": "https://towardsdatascience.com/automl-creating-top-performing-neural-networks-without-defining-architectures-c7d3b08cddc", "anchor_text": "AutoML: Creating Top-Performing Neural Networks Without Defining ArchitecturesProgramming AutoML In Python with AutoKerastowardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4f4fae58d90b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4f4fae58d90b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4f4fae58d90b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----4f4fae58d90b---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4f4fae58d90b---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4f4fae58d90b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&user=Andre+Ye&userId=be743a65b006&source=-----4f4fae58d90b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4f4fae58d90b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&user=Andre+Ye&userId=be743a65b006&source=-----4f4fae58d90b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f4fae58d90b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4f4fae58d90b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4f4fae58d90b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4f4fae58d90b--------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andre Ye"}, {"url": "https://andre-ye.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.8K Followers"}, {"url": "https://andre-ye.medium.com/membership", "anchor_text": "https://andre-ye.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe743a65b006&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&user=Andre+Ye&userId=be743a65b006&source=post_page-be743a65b006--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff44a966e4ff1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwith-keras-functional-api-your-imagination-is-the-limit-4f4fae58d90b&newsletterV3=be743a65b006&newsletterV3Id=f44a966e4ff1&user=Andre+Ye&userId=be743a65b006&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}