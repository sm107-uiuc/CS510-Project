{"url": "https://towardsdatascience.com/develop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776", "time": 1682994236.568573, "path": "towardsdatascience.com/develop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776/", "webpage": {"metadata": {"title": "Develop a NLP Model in Python & Deploy It with Flask, Step by Step | by Susan Li | Towards Data Science", "h1": "Develop a NLP Model in Python & Deploy It with Flask, Step by Step", "description": "By far, we have developed many machine learning models, generated numeric predictions on the testing data, and tested the results. And we did everything offline. In reality, generating predictions is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/", "anchor_text": "Kaggle", "paragraph_index": 3}, {"url": "https://www.cio.com/article/3051124/careers-staffing/10-boot-camps-to-kick-start-your-data-science-career.html", "anchor_text": "Data science bootcamps", "paragraph_index": 3}, {"url": "http://flask.pocoo.org/", "anchor_text": "Flask", "paragraph_index": 4}, {"url": "https://www.kaggle.com/uciml/sms-spam-collection-dataset", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Naive_Bayes_spam_filtering", "anchor_text": "Naive Bayes classifiers are a popular statistical technique of e-mail filtering. They typically use bag of words features to identify spam e-mail", "paragraph_index": 6}, {"url": "http://jinja.pocoo.org/docs/2.10/templates/", "anchor_text": "jinja", "paragraph_index": 19}, {"url": "http://127.0.0.1:5000/", "anchor_text": "http://127.0.0.1:5000/", "paragraph_index": 22}, {"url": "https://github.com/susanli2016/SMS-Message-Spam-Detector", "anchor_text": "repository", "paragraph_index": 25}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/", "paragraph_index": 27}], "all_paragraphs": ["By far, we have developed many machine learning models, generated numeric predictions on the testing data, and tested the results. And we did everything offline. In reality, generating predictions is only part of a machine learning project, although it is the most important part in my opinion.", "Considering a system using machine learning to detect spam SMS text messages. Our ML systems workflow is like this: Train offline -> Make model available as a service -> Predict online.", "When we develop a machine learning model, we need to think about how to deploy it, that is, how to make this model available to other users.", "Kaggle and Data science bootcamps are great for learning how to build and optimize models, but they don\u2019t teach engineers how to take them to the next step, where there\u2019s a major difference between building a model, and actually getting it ready for people to use in their products and services.", "In this article, we will focus on both: building a machine learning model for spam SMS message classification, then create an API for the model, using Flask, the Python micro framework for building web applications.This API allows us to utilize the predictive capabilities through HTTP requests. Let\u2019s get started!", "The data is a collection of SMS messages tagged as spam or ham that can be found here. First, we will use this dataset to build a prediction model that will accurately classify which texts are spam.", "Naive Bayes classifiers are a popular statistical technique of e-mail filtering. They typically use bag of words features to identify spam e-mail. Therefore, We\u2019ll build a simple message classifier using Naive Bayes theorem.", "Not only Naive Bayes classifier is easy to implement but also provides very good result.", "After training the model, it is desirable to have a way to persist the model for future use without having to retrain. To achieve this, we add the following lines to save our model as a .pkl file for the later use.", "And we can load and use saved model later like so:", "The above process called \u201cpersist model in a standard format\u201d, that is, models are persisted in a certain format specific to the language in development.", "And the model will be served in a micro-service that expose endpoints to receive requests from client. This is the next step.", "Having prepared the code for classifying SMS messages in the previous section, we will develop a web application that consists of a simple web page with a form field that lets us enter a message. After submitting the message to the web application, it will render it on a new page which gives us a result of spam or not spam.", "First, we create a folder for this project called SMS-Message-Spam-Detector , this is the directory tree inside the folder. We will explain each file.", "The sub-directory templates is the directory in which Flask will look for static HTML files for rendering in the web browser, in our case, we have two html files: home.html and result.html .", "The app.py file contains the main code that will be executed by the Python interpreter to run the Flask web application, it included the ML code for classifying SMS messages:", "The following are the contents of the home.html file that will render a text form where a user can enter a message:", "In the header section of home.html, we loaded styles.cssfile. CSS is to determine how the look and feel of HTML documents. styles.css has to be saved in a sub-directory calledstatic, which is the default directory where Flask looks for static files such as CSS.", "we create a result.html file that will be rendered via the render_template('result.html', prediction=my_prediction) line return inside the predictfunction, which we defined in the app.py script to display the text that a user submitted via the text field. The result.htmlfile contains the following content:", "From result.htm we can see that some code using syntax not normally found in HTML files: {% if prediction ==1%},{% elif prediction == 0%},{% endif %}This is jinja syntax, and it is used to access the prediction returned from our HTTP request within the HTML file.", "Once you have done all of the above, you can start running the API by either double click appy.py , or executing the command from the Terminal:", "You should get the following output:", "Now you could open a web browser and navigate to http://127.0.0.1:5000/, we should see a simple website with the content like so:", "Congratulations! We have now created an end-to-end machine learning (NLP) application at zero cost. If you look it back, the overall process is not complicated at all. With a little bit patience and desire to learn, anyone can do it. All the open-source tools make every thing possible.", "More importantly, we are able to extend our knowledge of machine learning theory to a useful and practical web application and lets us make our SMS spam message classifier available to the outside world!", "The complete working source code is available at this repository. Have a great week!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Changing the world, one post at a time. Sr Data Scientist, Toronto Canada. https://www.linkedin.com/in/susanli/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F744f3bdd7776&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://actsusanli.medium.com/?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": "Susan Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a----744f3bdd7776---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F744f3bdd7776&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F744f3bdd7776&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle"}, {"url": "https://www.cio.com/article/3051124/careers-staffing/10-boot-camps-to-kick-start-your-data-science-career.html", "anchor_text": "Data science bootcamps"}, {"url": "http://flask.pocoo.org/", "anchor_text": "Flask"}, {"url": "https://www.kaggle.com/uciml/sms-spam-collection-dataset", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Naive_Bayes_spam_filtering", "anchor_text": "Naive Bayes classifiers are a popular statistical technique of e-mail filtering. They typically use bag of words features to identify spam e-mail"}, {"url": "http://jinja.pocoo.org/docs/2.10/templates/", "anchor_text": "jinja"}, {"url": "http://127.0.0.1:5000/", "anchor_text": "http://127.0.0.1:5000/"}, {"url": "https://github.com/susanli2016/SMS-Message-Spam-Detector", "anchor_text": "repository"}, {"url": "https://www.amazon.ca/Python-Machine-Learning-Sebastian-Raschka/dp/1787125939/ref=dp_ob_title_bk", "anchor_text": "Python Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----744f3bdd7776---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----744f3bdd7776---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----744f3bdd7776---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/flask?source=post_page-----744f3bdd7776---------------flask-----------------", "anchor_text": "Flask"}, {"url": "https://medium.com/tag/web-applications?source=post_page-----744f3bdd7776---------------web_applications-----------------", "anchor_text": "Web Applications"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F744f3bdd7776&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&user=Susan+Li&userId=731d8566944a&source=-----744f3bdd7776---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F744f3bdd7776&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&user=Susan+Li&userId=731d8566944a&source=-----744f3bdd7776---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F744f3bdd7776&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F744f3bdd7776&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----744f3bdd7776---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----744f3bdd7776--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----744f3bdd7776--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----744f3bdd7776--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----744f3bdd7776--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Susan Li"}, {"url": "https://actsusanli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27K Followers"}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f2b19329694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776&newsletterV3=731d8566944a&newsletterV3Id=1f2b19329694&user=Susan+Li&userId=731d8566944a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}