{"url": "https://towardsdatascience.com/a-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e", "time": 1682994540.937338, "path": "towardsdatascience.com/a-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e/", "webpage": {"metadata": {"title": "A Quick Exploration of NLP for text Classification on Echo Reviews | by Alec Cunningham | Towards Data Science", "h1": "A Quick Exploration of NLP for text Classification on Echo Reviews", "description": "Natural Language Processing (NLP) is the field/science of processing linguistic data in such a manner that it may be \u201cinterpreted\u201d by a computer. Tools and services such as Siri, Alexa, Google, etc\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/sid321axn/amazon-alexa-reviews", "anchor_text": "https://www.kaggle.com/sid321axn/amazon-alexa-reviews", "paragraph_index": 3}], "all_paragraphs": ["Natural Language Processing (NLP) is the field/science of processing linguistic data in such a manner that it may be \u201cinterpreted\u201d by a computer. Tools and services such as Siri, Alexa, Google, etc. use these techniques to interact with humans via verbal inputs as well as to interpret textual data. Machines use numeric information which inherently different than linguistics; thus, the task is not easy and has required creative and complex solutions.", "In this article we will be using NLP to predict the user-given rating of a product, in this case Amazon Echo Dot, based on the review text. This example will require some low level understanding of concepts such as sentiment and polarity as well as numeric categorical output. Let\u2019s get into it!", "The first step is to open a Google Colab python notebook, we will be using this environment to process and visualize the data, build the model, and make the final predictions.", "The data for this article is provided by Kaggle at the following location: https://www.kaggle.com/sid321axn/amazon-alexa-reviews", "The data consists of the following fields: rating, date, variation, and review text.", "The first step is to import this data into our Python Notebook. To do this you will need an account with Kaggle, it\u2019s free and you can sign up with Google credentials.", "First we need to install the package that will allow us to interact with the Kaggle API.", "Now, we need to upload our Kaggle credentials. This is a .json file that can be downloaded from Kaggle, there are many tutorials on this. Simply execute the following lines of code and upload the kaggle.json file.", "We need to place the file that was just uploaded into the proper directory to conform to the API protocol.", "Now we are ready to download the data. Simply go to the Kaggle page and copy the link to the data, or copy the line below.", "Now we will import the data into a pandas dataframe; but first, we need to import pandas.", "One of the columns in the dataframe contains a categorical value that represent the variation of the Echo which the user is reviewing. Given a limited number of categories, it will be most effective to use one-hot encoding for the model to understand this variable. One-hot encoding creates a column for each of the possible categories and will give a 1 or a 0 depending on whether or not he respective row contains that respective categorical value. Feel free to exclude the \u2018variation\u2019 column from your input variables if you just want to focus on text analysis!", "The next column that needs to be addressed is the date; in this case it is presented in the form of dd-MMM-yy (ex. 31-Jul-18). The model, which will accept only numeric inputs, will not be able to interpret this information.", "The solution is to break the string up into numeric representations of day, month, and year independently and then place them in respective columns. The original date column will also be dropped.", "You may notice hat I have \u201cYear\u201d commented out. The year (2018) is the same for all of the reviews; thus, having this column unnecessarily increases the computational burden without providing any benefit. If you ever have a version of this dataset with newer older dates, feel free to use \u201cYear\u201d.", "The next step will be to gather some information relating to the review text itself. For the purposes of this example we will use a tool, TextBlob, that will analyze text strings and provide numeric outputs relating to sentiment. TextBlob will output both the polarity (range -1 to 1) as well as subjectivity (range 0 to 1) in the form of a tuple. The results of this process can be mapped into columns containing polarity and subjectivity respectively.", "First, lets begin be importing TextBlob and defining a function which will output sentiment given a string input and that will return a neutral output if the input cannot be handled.", "Now, lets use a lambda function to apply this newly-created function to the columns which contains the review data and set the output to be a new column which we will call \u201csentiment.\u201d We will then map the sentiment tuple to individual columns for the respective variables and drop the \u201csentiment\u201d column.", "Next, we can gather some additional meta-data about the nature of the text itself regarding number of characters, number of words, average word length, and number of stop words. This will allow the model to identify any relation between these features and the rating output.", "First let\u2019s define a function which will return the average word length:", "Now let\u2019s create new columns for the aforementioned meta-data elements based on the review text column.", "Now we will create a column that contains the number of stopwords in the review text. Stopwords are generally thought of as the more common, less meaningful, words such as \u201ca\u201d, \u201cthe\u201d, and \u201cI\u201d. We do not yet know if there will be a correlation between this variable and the output for this particular application; however, we have a small dataset and plenty of memory, it won\u2019t hurt to include it!", "We will import the \u201cstopwords\u201d tool form NLTK (I encourage those who do not know what this toolkit is to look it up). Import the toolkit and then use a lambda function to apply it to the reviews via execution of the following lines.", "Let\u2019s apply a scaler (Scikit-Learn MinMaxScaler) to these inputs for easier interpretation by the model:", "At this point we could begin building the model! Feel free to do so if you like as there is more than enough information to make some solid predictions. However, I am going to walk through some additional steps to help squeeze out a bit more information from the reviews!", "This process will involve text summarization. What I am going to do is summarize each review and then apply previous steps. This should, in theory, isolate the most import sentences from the review and then gather the most important sentiment. Let\u2019s give it a go!", "Import the summarization tool from Gensim and then define a function which can be applied to a column. Note: this function will return a copy of the original text if there is an error int he summarization process.", "Now, lets apply this function, and gather the sentiment associated with it. There is no need to scale the outputs because the sentiment scores will always be given in ranges easily understood by the model.", "Now, let\u2019s create a new dataframe which can be fed into the model. We can do this by creating a copy of the dataframe which excludes columns with strings.", "In order to get a better understanding of the data, let\u2019s use Seaborn for visualization!", "Notice that the last two lines are commented out, feel free to uncomment them if you would like to save the file!", "What about the data from the summarized text?", "As you can see, there is some level of clustering going on, let\u2019s hope our model will be able to pick up on the nuances!", "We have finished the data-preprocessing, the hard part is over!", "For this next step we are going to use Scikit-Learn to implement a random forest classifier. If you do not understand how this form of classifier works, this is a great opportunity to look it up!", "Lets begin by creating test and train data. We need to convert the dataframe to a numpy array for the labels and a numpy matrix for the inputa. We will use the built-in Scikit-Learn test-train function to split the data.", "Now lets initialize the model and fit it to the train data. This should converge rather quickly as the data set is small. The score will be displayed upon completion.", "To view to the numeric values of the results, simply uncomment the last line to print out the confusion matrix as a numpy matrix.", "The output should look similar to the following:", "The results are pretty good! We achieved an accuracy of approximately 84%, with most of the incorrect predictions being in an adjacent square (a 5 classified as a 4 or vice vera).", "In this article we have downloaded Alexa reviews, preprocessed the text to create a dataframe which our model can interpret, visualized the data, built a model, and made some predictions!", "For a more comprehensive analysis, consider building a regression model which coerces the predictions to the nearest integer that is within the range of 0 to 5. Since the classes are on a linear numeric scale, the regressive model approach may have an advantage.", "NLP is a powerful tool and we have only scratched the surface of the possibilities I challenge you to learn more on the topic and to build your own applications and implementations!", "As always, please reach out with any questions, I would be happy to help.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sometimes I have something to share. I should probably invest in a Grammarly subscription."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6b65a9e2cc9e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@acunnin528?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@acunnin528?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": "Alec Cunningham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87134d365c65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&user=Alec+Cunningham&userId=87134d365c65&source=post_page-87134d365c65----6b65a9e2cc9e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b65a9e2cc9e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b65a9e2cc9e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/sid321axn/amazon-alexa-reviews", "anchor_text": "https://www.kaggle.com/sid321axn/amazon-alexa-reviews"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6b65a9e2cc9e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6b65a9e2cc9e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----6b65a9e2cc9e---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/amazon-echo?source=post_page-----6b65a9e2cc9e---------------amazon_echo-----------------", "anchor_text": "Amazon Echo"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6b65a9e2cc9e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b65a9e2cc9e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&user=Alec+Cunningham&userId=87134d365c65&source=-----6b65a9e2cc9e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b65a9e2cc9e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&user=Alec+Cunningham&userId=87134d365c65&source=-----6b65a9e2cc9e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b65a9e2cc9e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6b65a9e2cc9e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6b65a9e2cc9e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6b65a9e2cc9e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@acunnin528?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@acunnin528?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alec Cunningham"}, {"url": "https://medium.com/@acunnin528/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "86 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87134d365c65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&user=Alec+Cunningham&userId=87134d365c65&source=post_page-87134d365c65--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe055f86930b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-exploration-of-nlp-for-text-classification-on-echo-reviews-6b65a9e2cc9e&newsletterV3=87134d365c65&newsletterV3Id=e055f86930b3&user=Alec+Cunningham&userId=87134d365c65&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}