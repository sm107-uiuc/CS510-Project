{"url": "https://towardsdatascience.com/data-augmentation-in-yolov4-c16bd22b2617", "time": 1683007410.348541, "path": "towardsdatascience.com/data-augmentation-in-yolov4-c16bd22b2617/", "webpage": {"metadata": {"title": "Data Augmentation in YOLOv4. State of the art modeling with image\u2026 | by Jacob Solawetz | Towards Data Science", "h1": "Data Augmentation in YOLOv4", "description": "The object detection space continues to move quickly. No more than two months ago, the Google Brain team released EfficientDet for object detection, challenging YOLOv3 as the premier model for (near)\u2026"}, "outgoing_paragraph_urls": [{"url": "https://blog.roboflow.com/object-detection/", "anchor_text": "object detection space", "paragraph_index": 0}, {"url": "https://blog.roboflow.com/the-ultimate-guide-to-object-detection/", "anchor_text": "object detection", "paragraph_index": 0}, {"url": "https://blog.roboflow.com/the-ultimate-guide-to-object-detection/", "anchor_text": "realtime object detection", "paragraph_index": 0}, {"url": "https://blog.roboflow.ai/yolov3-versus-efficientdet-for-state-of-the-art-object-detection/", "anchor_text": "comparing YOLOv3 and EfficientDet", "paragraph_index": 0}, {"url": "https://blog.roboflow.ai/releasing-a-new-yolov3-implementation/", "anchor_text": "training YOLOv3 on custom data", "paragraph_index": 0}, {"url": "https://blog.roboflow.ai/training-efficientdet-object-detection-model-with-a-custom-dataset/", "anchor_text": "and training EfficientDet on custom data", "paragraph_index": 0}, {"url": "https://blog.roboflow.ai/training-yolov4-on-a-custom-dataset/", "anchor_text": "how to train YOLOv4 on your custom dataset", "paragraph_index": 1}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "data augmentation techniques", "paragraph_index": 2}, {"url": "https://blog.roboflow.ai/why-preprocess-augment/", "anchor_text": "how important image preprocessing and augmentation is for computer vision", "paragraph_index": 3}, {"url": "https://blog.roboflow.com/label-management-for-computer-vision/", "anchor_text": "data management", "paragraph_index": 4}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "data augmentation", "paragraph_index": 4}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "Data augmentation in computer vision", "paragraph_index": 4}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "Image augmentation", "paragraph_index": 5}, {"url": "https://blog.roboflow.ai/using-blur-in-computer-vision-preprocessing/", "anchor_text": "on blur data augmentation in computer vision", "paragraph_index": 7}, {"url": "https://blog.roboflow.ai/why-and-how-to-implement-random-crop-data-augmentation/", "anchor_text": "random cropping data augmentation in computer vision", "paragraph_index": 8}, {"url": "https://arxiv.org/pdf/1710.09412.pdf", "anchor_text": "Paper here", "paragraph_index": 14}, {"url": "https://blog.roboflow.com/train-test-split/", "anchor_text": "train/test sets", "paragraph_index": 15}, {"url": "https://blog.roboflow.ai/training-yolov4-on-a-custom-dataset/", "anchor_text": "how to train YOLOv4", "paragraph_index": 22}, {"url": "https://blog.roboflow.ai/yolov5-improvements-and-evaluation/", "anchor_text": "YOLOv5", "paragraph_index": 23}], "all_paragraphs": ["The object detection space continues to move quickly. No more than two months ago, the Google Brain team released EfficientDet for object detection, challenging YOLOv3 as the premier model for (near) realtime object detection, and pushing the boundaries of what is possible in object detection. We wrote a series of posts comparing YOLOv3 and EfficientDet, training YOLOv3 on custom data, and training EfficientDet on custom data, and we\u2019ve found impressive results.", "**See here for our tutorial on how to train YOLOv4 on your custom dataset.", "And now YOLOv4 has been released showing an increase in COCO Average Precision (AP) and Frames Per Second (FPS) by 10 percent and 12 percent, respectively. In this post, we will see how the authors made this breakthrough by diving into the specifics of the data augmentation techniques used in YOLOv4.", "The importance of data augmentation for computer vision is not new! See our post from January explaining how important image preprocessing and augmentation is for computer vision.", "The authors of YOLOv4 include a series of contributions in their paper titled a \u201cbag of freebies.\u201d These are a series of steps that can be taken to improve the model\u2019s performance without increasing latency at inference time. Because they cannot affect the model\u2019s inference time, most of these make improvements in the data management and data augmentation of the training pipeline. These techniques improve and scale up the training set to expose the model to scenarios that would have otherwise been unseen. Data augmentation in computer vision is key to getting the most out of your dataset, and state of the art research continues to validate this assumption.", "Image augmentation creates new training examples out of existing training data. It\u2019s impossible to truly capture an image for every real-world scenario our model may be tasked to see in inference. Thus, adjusting existing training data to generalize to other situations allows the model to learn from a wider array of situations.", "The authors of YOLOv4 cite a number of techniques that ultimately inspired the inclusion of their bag of freebies. We provide an overview below.", "Photometric Distortion \u2014 This includes changing the brightness, contrast, saturation, and noise in an image. (For example, written on blur data augmentation in computer vision.)", "Geometric Distortion \u2014 This includes random scaling, cropping, flipping, and rotating. These types of augmentation can be particularly tricky as the bounding boxes are also affected and must be updated. (As an example, we\u2019ve written on how to use random cropping data augmentation in computer vision.)", "Those two methods were both pixel adjustments, meaning that the original image could easily be recovered with a series of transformations.", "Random Erase \u2014 This is a data augmentation technique that replaces regions of the image with random values, or the mean pixel value of training set. Typically, it is implemented with varying proportion of image erased and aspect ratio of erased area. Functionally, this becomes a regularization technique, which prevents our model from memorizing the training data and overfitting.", "Cutout \u2014 square regions are masked during training. Cutout regions are only hidden from the first layer of the CNN. This is very similar to random erase, but with a constant value in the overlaid occlusion. The purpose is similar: we reduce overfitting.", "Hide and Seek \u2014 Divide the image into a grid of SxS patches. Hide each patch with some probability (p_hide). This allows the model to learn what an object looks like without learning only what a single portion of the object looks like.", "Grid Mask \u2014 Regions of the image are hidden in a grid like fashion. Similar to hide and seek, this forces our model to learn component parts of what makes up an individual object.", "MixUp \u2014 convex overlaying of image pairs and their labels. (Paper here)", "Now we will visit the data augmentation strategies that YOLOv4 deployed during training. The research process is characterized by a series of experiments, so we can imagine that the authors experimented with many more strategies that did not make it into the final paper. This is further evidence that it is important to explore various data augmentation strategies on your own train/test sets in custom vision tasks.", "CutMix \u2014 Combine images by cutting parts from one image and pasting them onto the augmented image. Cutouts of the image force the model to learn to make predictions based on a robust amount of features. See \u201cHide and Seek\u201d above where, without cutouts, the model relies specifically on a dog\u2019s head to make a prediction. That is problematic if we want to accurately recognize a dog whose head is hidden (perhaps behind a bush). In CutMix, the cutout is replaced with a part of another image along with the second image\u2019s ground truth labeling. The ratio of each image is set in the image generation process (for example, 0.4/0.6). In the picture below, you can see how the authors of CutMix demonstrate that this technique can work better than simple MixUp and Cutout.", "Mosaic data augmentation \u2014 Mosaic data augmentation combines 4 training images into one in certain ratios. Mosaic is the first new data augmentation technique introduced in YOLOv4. This allows for the model to learn how to identify objects at a smaller scale than normal. It also encourages the model to localize different types of images in different portions of the frame.", "Class label smoothing \u2014 Class label smoothing is not an image manipulation technique, but rather an intuitive change to class labeling. Generally, the correct classification for a bounding box is represented as a one hot vector of classes [0,0,0,1,0,0, \u2026] and the loss function is calculated based on this representation. However, when a model becomes overly sure with a prediction close to 1.0, it is often wrong, overfit, and over looking the complexities of other predictions in some way. Following this intuition, it is more reasonable to encode the class label representation to value that uncertainty to some degree. Naturally, the authors choose 0.9, so [0,0,0,0.9, 0\u2026.] to represent the correct class.", "Self-Adversarial Training (SAT) \u2014 This technique uses the state of the model to inform vulnerabilities by transforming the input image. First, the image is passed through a normal training step. Then, rather than back-propping through the weights, the loss signal is used to alter the image in a way that would be most detrimental to the model. Later on in training, the model is forced to confront this particularly hard example and learn around it. Of the techniques we have covered here, this one is probably the least intuitive and closest to the modeling side of things.", "\ud83c\udf89 Now we have a comprehensive view of all the data augmentation techniques utilized in YOLOv4!", "We\u2019re excited to see that the advances in model performance focus on data augmentation just as much as model architecture. In seeing the difference between YOLOv4 versus YOLOv3 focus on data augmentation, we suspect these \u201cbag of freebie\u201d techniques can be useful for any architecture.", "Want to put the theory into practice? Try out our tutorial on how to train YOLOv4.", "Want to see how augmentation continues to evolve in the state of the art? Check out this article on YOLOv5.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning @ Roboflow \u2014 building tools and artifacts like this one to help practitioners solve computer vision."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc16bd22b2617&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jacobsolawetz.medium.com/?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": "Jacob Solawetz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f06d25ec2e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=post_page-5f06d25ec2e8----c16bd22b2617---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc16bd22b2617&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc16bd22b2617&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/data-augmentation-in-yolov4-c16bd22b2617", "anchor_text": "Data Augmentation in YOLOv4"}, {"url": "https://blog.roboflow.com/object-detection/", "anchor_text": "object detection space"}, {"url": "https://blog.roboflow.com/the-ultimate-guide-to-object-detection/", "anchor_text": "object detection"}, {"url": "https://blog.roboflow.com/the-ultimate-guide-to-object-detection/", "anchor_text": "realtime object detection"}, {"url": "https://blog.roboflow.ai/yolov3-versus-efficientdet-for-state-of-the-art-object-detection/", "anchor_text": "comparing YOLOv3 and EfficientDet"}, {"url": "https://blog.roboflow.ai/releasing-a-new-yolov3-implementation/", "anchor_text": "training YOLOv3 on custom data"}, {"url": "https://blog.roboflow.ai/training-efficientdet-object-detection-model-with-a-custom-dataset/", "anchor_text": "and training EfficientDet on custom data"}, {"url": "https://blog.roboflow.ai/training-yolov4-on-a-custom-dataset/", "anchor_text": "how to train YOLOv4 on your custom dataset"}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "data augmentation techniques"}, {"url": "https://blog.roboflow.ai/yolov5-improvements-and-evaluation/", "anchor_text": "YOLOv5 vs YOLOv4"}, {"url": "https://blog.roboflow.ai/yolov5-improvements-and-evaluation/", "anchor_text": "YOLOv5 framework"}, {"url": "https://blog.roboflow.ai/yolov5-improvements-and-evaluation/", "anchor_text": "YOLOv5 Breakdown"}, {"url": "https://arxiv.org/pdf/2004.10934.pdf", "anchor_text": "Citation"}, {"url": "https://blog.roboflow.ai/why-preprocess-augment/", "anchor_text": "how important image preprocessing and augmentation is for computer vision"}, {"url": "https://blog.roboflow.com/label-management-for-computer-vision/", "anchor_text": "data management"}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "data augmentation"}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "Data augmentation in computer vision"}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "Image augmentation"}, {"url": "https://blog.roboflow.ai/using-blur-in-computer-vision-preprocessing/", "anchor_text": "on blur data augmentation in computer vision"}, {"url": "https://blog.roboflow.ai/why-and-how-to-implement-random-crop-data-augmentation/", "anchor_text": "random cropping data augmentation in computer vision"}, {"url": "https://arxiv.org/pdf/1708.04896.pdf", "anchor_text": "Citation"}, {"url": "https://arxiv.org/pdf/1708.04552.pdf", "anchor_text": "Citation"}, {"url": "https://arxiv.org/pdf/1704.04232.pdf", "anchor_text": "Citation"}, {"url": "https://arxiv.org/pdf/2001.04086.pdf", "anchor_text": "Citation"}, {"url": "https://arxiv.org/pdf/1710.09412.pdf", "anchor_text": "Paper here"}, {"url": "https://arxiv.org/pdf/1905.04899.pdf", "anchor_text": "Citation"}, {"url": "https://blog.roboflow.com/train-test-split/", "anchor_text": "train/test sets"}, {"url": "https://arxiv.org/pdf/1905.04899.pdf", "anchor_text": "Citation"}, {"url": "https://arxiv.org/pdf/2004.10934.pdf", "anchor_text": "Citation"}, {"url": "https://arxiv.org/pdf/2004.10934.pdf", "anchor_text": "Citation"}, {"url": "https://blog.roboflow.ai/training-yolov4-on-a-custom-dataset/", "anchor_text": "how to train YOLOv4"}, {"url": "https://blog.roboflow.ai/yolov5-improvements-and-evaluation/", "anchor_text": "YOLOv5"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----c16bd22b2617---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----c16bd22b2617---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/data-augmentation?source=post_page-----c16bd22b2617---------------data_augmentation-----------------", "anchor_text": "Data Augmentation"}, {"url": "https://medium.com/tag/data-preparation?source=post_page-----c16bd22b2617---------------data_preparation-----------------", "anchor_text": "Data Preparation"}, {"url": "https://medium.com/tag/data-preprocessing?source=post_page-----c16bd22b2617---------------data_preprocessing-----------------", "anchor_text": "Data Preprocessing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc16bd22b2617&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=-----c16bd22b2617---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc16bd22b2617&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=-----c16bd22b2617---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc16bd22b2617&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc16bd22b2617&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c16bd22b2617---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c16bd22b2617--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c16bd22b2617--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c16bd22b2617--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c16bd22b2617--------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jacob Solawetz"}, {"url": "https://jacobsolawetz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "513 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f06d25ec2e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=post_page-5f06d25ec2e8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbdaf42b583ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-yolov4-c16bd22b2617&newsletterV3=5f06d25ec2e8&newsletterV3Id=bdaf42b583ae&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}