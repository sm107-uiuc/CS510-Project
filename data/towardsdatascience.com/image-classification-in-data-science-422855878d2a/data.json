{"url": "https://towardsdatascience.com/image-classification-in-data-science-422855878d2a", "time": 1683006172.439512, "path": "towardsdatascience.com/image-classification-in-data-science-422855878d2a/", "webpage": {"metadata": {"title": "Image Classification in Data Science | by Jason Dsouza | Towards Data Science", "h1": "Image Classification in Data Science", "description": "Welcome to part 2 of the \u201cData Science with Python\u201d mini-series! In this lesson, we\u2019ll talk about what image classification is and train an image classifier which can recognize cats from dogs (and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/jasmcaus/image-classifier-python", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://www.kaggle.com/c/dogs-vs-cats/data", "anchor_text": "Dogs vs Cats", "paragraph_index": 19}, {"url": "https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip", "anchor_text": "here", "paragraph_index": 19}], "all_paragraphs": ["Welcome to part 2 of the \u201cData Science with Python\u201d mini-series! In this lesson, we\u2019ll talk about what image classification is and train an image classifier which can recognize cats from dogs (and vice-versa) with sizable accuracy.", "Consider the image above. I\u2019m sure we\u2019d all agree that this is a car. But take a step back and analyze how you came to this conclusion \u2014 you were shown an image and you classified the class to which it belonged (a car, in this instance). That, in a nutshell, is what image classification is all about.", "There are potentially a countless number of categories in which a given image can be classified (for example, a car can be classified into a sedan, hatchback, SUV etc. and they, in turn, can be classified into an Audi, a Maserati or even a Toyota). Manually checking and classifying images is a very tedious process and it becomes nearly impossible when you\u2019re faced with a massive number of images, say 10,000 or even 100,000.", "Image classification is the process of taking an input (like a picture) and outputting a class (like \u201ccat\u201d) or a probability that the input is a particular class (\u201cthere\u2019s a 90% probability that this input is a cat\u201d).", "You can look at a picture and know that you\u2019re looking at a cat, but how can a computer learn to do that?", "I\u2019ve already written a post on CNNs \u2014 it\u2019s worth a read especially if you\u2019re new to Data Science.", "Computers don\u2019t see images as humans do. They see a matrix of pixels, each of which has three components: red, green and blue (ever heard of RGB?)", "Therefore, a 1,000-pixel image for us will have 3,000 pixels for a computer. Each of those 3,000 pixels will have a value, or intensity, assigned to it. The result is a matrix of 3,000 precise pixel intensities, which the computer must somehow interpret as one or more objects.", "For a black and white image, pixels are interpreted as a 2D array (for example, 2x2 pixels). Every pixel has a value between 0 and 255. (Zero is completely black and 255 is completely white. The greyscale exists between those numbers.) Based on that information, the computer can begin to work on the data.", "For a colour image (a combination of red, green and blue), this is a 3D array. Each colour has its value between 0 and 255. The colour can be found by combining the values in each of the three layers.", "In data science, the image classifiers we build have to be trained to recognize objects/patterns \u2014 this shows our classifier what exactly (or approximately) what to recognize.", "Imagine I show you the following image:", "There is a boathouse, a little boat, hills, a river and other objects. You\u2019ll notice them, but you won\u2019t know exactly what object I\u2019m referring to. Now, if I show you another photo:", "You\u2019ll recognize that I want you to recognize a \u201cMountain\u201d. By showing you the first two images, I essentially trained your brain to recognize a mountain in the third image.", "The process is (almost) the same for computers \u2014 our data needs to be in a specific format. We\u2019ll see this in action later in the article, but just keep these pointers in mind.", "Our model will be trained on the images present in a \u201ctraining \u201dset and the label predictions will happen on the testing set images.", "For this article, I\u2019ll be using Google Colab \u2014 a free cloud service based on Jupyter Notebooks that supports free GPU.", "Colab provides a GPU and it\u2019s totally free. Seriously!", "The entire code in this article can be found here.", "In this article, we\u2019ll utilize a filtered version of Dogs vs Cats dataset from Kaggle. You can download the archive version of the dataset from here.", "The dataset has the following directory structure:", "Next, we\u2019ll assign variables with the proper file path for the training and validation set.", "If you\u2019d like to know cat and dog images are in the training and validation directory, use the following code:", "Our images have to be formatted into appropriately pre-processed floating-point tensors before we can feed it to the network.", "We will now extract a batch of images from the training generator and then plot five of them with matplotlib.", "In this article, we\u2019ll use the ADAM optimizer and binary cross-entropy loss function.", "We\u2019ll use the fit_generator method of the ImageDataGenerator class to train our network.", "Allow this to run \u2014 it will take some time. Have patience!", "As you can see from the graphs, the training accuracy and validation accuracy are off by a large margin and the model has achieved only around 70% accuracy on the validation set.", "In the plots above, the training accuracy increases linearly over time, whereas the validation accuracy stalls around 70% in the training process. Also, there is a difference between the training and validation accuracy is noticeable \u2014 a sign of overfitting.", "When there are a small number of training examples, the model sometimes learns from noises (unwanted details) from the training examples. This negatively impacts the performance of the model on new examples. This phenomenon is known as overfitting.", "This means that the model will have a difficult time generalizing on a new dataset.", "There are multiple ways to fight overfitting in the training process. In this article, we\u2019ll use data augmentation and add dropout to our model.", "Overfitting generally occurs when there are a small number of training examples. One way to fix this problem is to augment the dataset so that it has a sufficient number of training examples.", "The goal is that our model should never see the same picture twice during the training phase. This helps expose it to more aspects of the data which will ultimately increase its recognition accuracy.", "In this article, we\u2019ll apply random horizontal flip, rotate and zoom augmentation to the dataset and see how individual images look like after the transformation.", "In general, we only apply data augmentation to the training examples. In this case, we\u2019ll rescale the validation images and convert them into batches.", "Another technique to reduce overfitting is to introduce dropout to the network.", "Dropout is a form of regularization that randomly knocks out units (i.e neurons) from your neural network so on every iteration you end up working with a smaller neural network.", "The intuition here is: You can\u2019t rely on any one feature, so you have to spread out the weights.", "When you apply dropout to a layer, it randomly drops out (set to zero) the number of output units during the training process. It takes a fractional number as its input, in the form such as 0.1, 0.3, etc. (this means dropping out 10% or 30% of the output units randomly from the layer it's applied to).", "You will notice that there is significantly less overfitting than before. The accuracy should go up after training the model for more epochs.", "That\u2019s it! We\u2019ve successfully built an Image Classifier to recognize cats from dogs in an image. As with all neural networks, we couldn\u2019t reach 100% accuracy, but we were able to improve the accuracy level of our model by a considerable bit by exposing it to the same number of images, but with augmentations like rotation, flip and zoom.", "As always, thanks so much for reading! Please tell me what you think or would like me to write about next in the comments. I\u2019m open to criticism as well!", "See you in the next post! \ud83d\ude04", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write libraries and sometimes blog about them | Top Writer | Creator of Caer, the Vision library for Python"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F422855878d2a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----422855878d2a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----422855878d2a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jasmcaus.medium.com/?source=post_page-----422855878d2a--------------------------------", "anchor_text": ""}, {"url": "https://jasmcaus.medium.com/?source=post_page-----422855878d2a--------------------------------", "anchor_text": "Jason Dsouza"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F135dac1d8e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&user=Jason+Dsouza&userId=135dac1d8e6&source=post_page-135dac1d8e6----422855878d2a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F422855878d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F422855878d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@cosiman?utm_source=medium&utm_medium=referral", "anchor_text": "Ren\u00e9 Peters"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@joeyabanks?utm_source=medium&utm_medium=referral", "anchor_text": "Joey Banks"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@lucabravo?utm_source=medium&utm_medium=referral", "anchor_text": "Luca Bravo"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@vorosbenisop?utm_source=medium&utm_medium=referral", "anchor_text": "Benjamin Voros"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@kydroon?utm_source=medium&utm_medium=referral", "anchor_text": "Kurt Cotoaga"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/jasmcaus/image-classifier-python", "anchor_text": "here"}, {"url": "https://www.kaggle.com/c/dogs-vs-cats/data", "anchor_text": "Dogs vs Cats"}, {"url": "https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip", "anchor_text": "here"}, {"url": "https://xkcd.com/1122/", "anchor_text": "XKCD"}, {"url": "https://github.com/jasmcaus/image-classifier-python", "anchor_text": "jasmcaus/image-classifier-pythonTraining a neural network to recognize cats from dogs with sizable accuracy The entire details are mentioned in this\u2026github.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----422855878d2a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----422855878d2a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----422855878d2a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----422855878d2a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----422855878d2a---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F422855878d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&user=Jason+Dsouza&userId=135dac1d8e6&source=-----422855878d2a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F422855878d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&user=Jason+Dsouza&userId=135dac1d8e6&source=-----422855878d2a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F422855878d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----422855878d2a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F422855878d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----422855878d2a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----422855878d2a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----422855878d2a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----422855878d2a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----422855878d2a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----422855878d2a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----422855878d2a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----422855878d2a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----422855878d2a--------------------------------", "anchor_text": ""}, {"url": "https://jasmcaus.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jasmcaus.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jason Dsouza"}, {"url": "https://jasmcaus.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "831 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F135dac1d8e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&user=Jason+Dsouza&userId=135dac1d8e6&source=post_page-135dac1d8e6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff0f7dfd71a24&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-in-data-science-422855878d2a&newsletterV3=135dac1d8e6&newsletterV3Id=f0f7dfd71a24&user=Jason+Dsouza&userId=135dac1d8e6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}