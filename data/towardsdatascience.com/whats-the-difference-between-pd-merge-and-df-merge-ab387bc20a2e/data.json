{"url": "https://towardsdatascience.com/whats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e", "time": 1683000264.358817, "path": "towardsdatascience.com/whats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e/", "webpage": {"metadata": {"title": "What\u2019s the difference between pd.merge and df.merge? | by Han Qi | Towards Data Science", "h1": "What\u2019s the difference between pd.merge and df.merge?", "description": "In my voluntary role providing online technical support for www.dataquest.io, I come across numerous questions that allow me to dive deeper into interesting questions I usually skim through. Today\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.dataquest.io", "anchor_text": "www.dataquest.io", "paragraph_index": 0}, {"url": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/__init__.py#L129-L143", "anchor_text": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/__init__.py#L129-L143", "paragraph_index": 7}, {"url": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/reshape/api.py#L5", "anchor_text": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/reshape/api.py", "paragraph_index": 8}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "paragraph_index": 10}, {"url": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/frame.py#L7304-L7335", "anchor_text": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/frame.py#L7304-L7335", "paragraph_index": 10}, {"url": "https://hanqi01.medium.com/membership", "anchor_text": "https://hanqi01.medium.com/membership", "paragraph_index": 15}], "all_paragraphs": ["In my voluntary role providing online technical support for www.dataquest.io, I come across numerous questions that allow me to dive deeper into interesting questions I usually skim through.", "Today, the question is: What\u2019s the difference between left_df.merge(right_df) vs pd.merge(left_df, right_df)?", "The short answer is left_df.merge() calls pd.merge() .", "The former is used because it allows method chaining, analogous to the %>% pipe operator in R which allows you to write and read data processing code from left to right, such as left_df.merge(right_df).merge(right_df2). If you had to do pd.merge(), this is not the chaining style but wrapping style which ends up with an ugly pd.merge(pd.merge(left_df,right_df),right_df2) if you see where this is going.", "Now let\u2019s go down the rabbit hole to see what\u2019s going on.", "First, when you see pd.merge, it actually, means pandas.merge, which means you have done import pandas. When youimport something, the __init__.py file of that module name (pandas in this question) is run.", "The main purpose of all these __init__.py files is to organize the API, and to allow the user to type a shorter import code by importing the middle packages for you, so you can write pandas.merge() once you import pandas rather than requiring from pandas.core.reshape.merge import merge first before you use the merge() function.", "Now let's see what I mean by \u201cimport the middle packages for you\u201d If you open https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/__init__.py#L129-L143, you will see how it imports many things, one line of which is from pandas.core.reshape.api (Figure 1), in that block merge is imported.", "This is what allows you to callpd.merge directly, but let's get to the bottom of this.Going into pandas.core.reshape.api https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/reshape/api.py you see from pandas.core.reshape.merge import merge.(Figure 2)", "Now you see where the previous merge of from pandas.core.reshape.api came from.", "Now let's see what the chaining style of coding, left_df.merge is doing, from https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html, click source to go https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/frame.py#L7304-L7335 to see def merge(self (Figure 5), the self which tells you this is a class (DataFrame in this case) method, which later imports from pandas.core.reshape.merge import merge, and passes all your parameters back into the merge from pandas.core.reshape.merge, with the only difference being it now automatically passes self as the left parameter for you.", "You can compare the 2 function signatures of def merge from left_df.merge here and the earlier pd.merge discussion to see they are exactly the same merge.", "How did I even know to start searching from the keyword merge? Actually, I began the search from the source code of left_df.merge first, but I felt it\u2019s better to explain the lowest level code first, then introduce the idea of self substituting left parameter so more complex ideas build on simpler ones.", "I hope this article has inspired others to not fear the source, but encourage curiosity in how things really work beneath the hood, how the API is designed, and in so doing possibly contribute to Pandas in future.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Shares ideas that I can\u2019t find online. You can support my writing by joining Medium through https://hanqi01.medium.com/membership (affiliate link)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fab387bc20a2e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hanqi01.medium.com/?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": ""}, {"url": "https://hanqi01.medium.com/?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": "Han Qi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ffa63536714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&user=Han+Qi&userId=5ffa63536714&source=post_page-5ffa63536714----ab387bc20a2e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab387bc20a2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab387bc20a2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@millerthachiller?utm_source=medium&utm_medium=referral", "anchor_text": "Pascal M\u00fcller"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://www.dataquest.io", "anchor_text": "www.dataquest.io"}, {"url": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/__init__.py#L129-L143", "anchor_text": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/__init__.py#L129-L143"}, {"url": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/reshape/api.py#L5", "anchor_text": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/reshape/api.py"}, {"url": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/reshape/merge.py#L53", "anchor_text": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/reshape/merge.py#L53"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html"}, {"url": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/frame.py#L7304-L7335", "anchor_text": "https://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/frame.py#L7304-L7335"}, {"url": "https://medium.com/tag/pandas?source=post_page-----ab387bc20a2e---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/open-source?source=post_page-----ab387bc20a2e---------------open_source-----------------", "anchor_text": "Open Source"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fab387bc20a2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&user=Han+Qi&userId=5ffa63536714&source=-----ab387bc20a2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fab387bc20a2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&user=Han+Qi&userId=5ffa63536714&source=-----ab387bc20a2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab387bc20a2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fab387bc20a2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ab387bc20a2e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ab387bc20a2e--------------------------------", "anchor_text": ""}, {"url": "https://hanqi01.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hanqi01.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Han Qi"}, {"url": "https://hanqi01.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "134 Followers"}, {"url": "https://hanqi01.medium.com/membership", "anchor_text": "https://hanqi01.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ffa63536714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&user=Han+Qi&userId=5ffa63536714&source=post_page-5ffa63536714--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F94c3fdd45e96&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-pd-merge-and-df-merge-ab387bc20a2e&newsletterV3=5ffa63536714&newsletterV3Id=94c3fdd45e96&user=Han+Qi&userId=5ffa63536714&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}