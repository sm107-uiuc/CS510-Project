{"url": "https://towardsdatascience.com/seeing-the-forest-through-the-trees-45deafe1a6f0", "time": 1683012556.662223, "path": "towardsdatascience.com/seeing-the-forest-through-the-trees-45deafe1a6f0/", "webpage": {"metadata": {"title": "Seeing the Forest Through the Trees | by Prince O. Onyenike | Towards Data Science", "h1": "Seeing the Forest Through the Trees", "description": "Pictorially, a decision tree is like a flow-chart where the parent nodes represent an attribute\u2019s test and the leaf nodes represent the final category assigned to the datapoints which made it to that\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/aljarah/xAPI-Edu-Data", "anchor_text": "dataset", "paragraph_index": 30}], "all_paragraphs": ["Pictorially, a decision tree is like a flow-chart where the parent nodes represent an attribute\u2019s test and the leaf nodes represent the final category assigned to the datapoints which made it to that leaf.", "In the illustration above, a total of 13 students were randomly sampled from a students performance dataset. The scatter plot shows a distribution of the sample based on two attributes:", "Our intent is to manually construct a decision tree that can best separate the sample data points into the distinct classes \u2014 L, M, H where:", "An option is to split the data along the attribute \u2014 visitedResources, at point mark 70.", "This \u201cperfectly\u201d separates the H class from the rest.", "One other option is to split along the same attribute \u2014 visitedResources, at point mark 41.", "No \u201cperfect\u201d separation is achieved for any class.", "Another option is to split along the attribute \u2014 raisedhands, at point mark 38.", "This \u201cperfectly\u201d separates the L class from the rest.", "Options A and C did a better job at separating at least one of the classes. Suppose we pick option A, the resultant decision three will be:", "The left branch has only H class students, hence, cannot be separated any further. On the right branch, the resultant node has four students each in the M and L classes.", "Remember that this is the current state of our separation exercise.", "How best can the remaining students(data points) be separated into their appropriate classes? Yes, you guessed right \u2014 draw more lines!", "One option is to split along the attribute \u2014 raisedhands, at point mark 38.", "Again, any number of split lines can be drawn, however, this option seems to yield a good result, so, we shall go with it.", "The resultant decision tree after the split is shown below:", "Clearly, the data points are perfectly separated into the appropriate classes, hence no further logical separation is needed.", "In manually constructing the decision tree, we learnt that the separation lines can be drawn at any point along any of the attributes available in a dataset. The question is, at any given decision node, which of the possible attributes and separation points will do a better job of separating the dataset into the desired or near-desired classes or categories? An instrument to determining the answer to this question is the Gini Impurity.", "Suppose we have a new student and we randomly classify this new student into any of the three classes based on the probability distribution of the classes. The gini impurity is a measure of the likelihood of incorrectly classifying that new random student(variable). It is a probabilistic measure, hence it\u2019s bounded between 0 and 1.", "We have a total of 13 students in our sample dataset and the probability distribution of H, M and L class are 5/13, 4/13 and 4/13 respectively.", "The formular below is applied in calculating gini impurity:", "The above formular when applied in our example case becomes:", "Therefore gini impurity at the root node of the decision tree before any split, will be computed as::", "Recall the earlier discussed split options A and C at the root node, let us compare the gini impurities of the two options and see why A was picked as a better split choice.", "Obviously, gini gain 0.36>0.29, hence, option A is a better split choice, informing the earlier decision to pick A over C.", "The gini impurity at a node where all the students are of only one class, say H, is always equal to zero \u2014 meaning no impurity. This implies a perfect classification, hence, no further split is needed.", "We have seen that many decision trees can be generated from the same dataset, and that the performance of the trees at correctly predicting unseen examples can vary. Also, using a single tree model (decision tree) can easily lead to over-fitting.", "The question becomes: how do we make sure to construct the best possible performant tree? An answer to this is to smartly construct as many trees as possible and use averaging to improve the predictive accuracy and control over-fitting. This method is called the Random Forest. It is random because each tree is constructed using not all the training dataset but a random sample of the dataset and attributes.", "We shall use the random forest algorithm implementation in Scikit-learn python package to demonstrate how a random forest model can be trained, tested as well as visualize one of the trees that constitute the forest.", "For this exercise, we shall train a random forest model to predict(classify) the academic performance category (Class) which students belong to, based on their participation in class/learning processes.", "In the dataset for this exercise, students\u2019 participation is defined as a measure of four variables, which are:", "In the sample extract below, the first four(4) numeric columns correspond to the students\u2019 participation measures defined earlier, and the last column \u2014 Class which is categorical, represents the students performance. A student can be in either of three(3) classes \u2014 Low, Medium or High performance.", "An implementation of all the above steps is shown in the snippet below:", "Next, we shall create a RandomForest instance and fit (build the tree) the model to the train set.", "Note that the optimal n_estimators and max_depth combination can only be determined by experimenting with several combinations. One way to achieve this is by using the grid search method.", "While there exist several metrics for evaluating models, we shall use one if not the most basic one \u2014 accuracy.", "The most optimal tree in a random forest model can be visualized easily, enabling both the engineer, scientist and business specialists to have some understanding of the decision-flow of the model.", "The snippet below extracts and visualizes the most optimal tree from the above-trained model:", "In this article, we succeeded in looking at how a decision tree works, understanding how the attributes split-choices are made using the gini impurity, how several decision trees are ensembled to make a random forest, and finally, demonstrated the usage of the random forest algorithm by training a random forest model to classify students into academic performance categories based on their participation in class/learning processes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F45deafe1a6f0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@codeyans?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@codeyans?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": "Prince O. Onyenike"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcaba89e45d55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&user=Prince+O.+Onyenike&userId=caba89e45d55&source=post_page-caba89e45d55----45deafe1a6f0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F45deafe1a6f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F45deafe1a6f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@veeterzy?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "veeterzy"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/aljarah/xAPI-Edu-Data", "anchor_text": "dataset"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----45deafe1a6f0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----45deafe1a6f0---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/random-forest-classifiers?source=post_page-----45deafe1a6f0---------------random_forest_classifiers-----------------", "anchor_text": "Random Forest Classifiers"}, {"url": "https://medium.com/tag/gini-impurity?source=post_page-----45deafe1a6f0---------------gini_impurity-----------------", "anchor_text": "Gini Impurity"}, {"url": "https://medium.com/tag/data-science?source=post_page-----45deafe1a6f0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F45deafe1a6f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&user=Prince+O.+Onyenike&userId=caba89e45d55&source=-----45deafe1a6f0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F45deafe1a6f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&user=Prince+O.+Onyenike&userId=caba89e45d55&source=-----45deafe1a6f0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F45deafe1a6f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F45deafe1a6f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----45deafe1a6f0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----45deafe1a6f0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@codeyans?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@codeyans?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Prince O. Onyenike"}, {"url": "https://medium.com/@codeyans/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcaba89e45d55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&user=Prince+O.+Onyenike&userId=caba89e45d55&source=post_page-caba89e45d55--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fcaba89e45d55%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fseeing-the-forest-through-the-trees-45deafe1a6f0&user=Prince+O.+Onyenike&userId=caba89e45d55&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}