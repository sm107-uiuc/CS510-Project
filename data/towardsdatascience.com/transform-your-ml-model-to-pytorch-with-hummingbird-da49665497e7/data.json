{"url": "https://towardsdatascience.com/transform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7", "time": 1683009764.257963, "path": "towardsdatascience.com/transform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7/", "webpage": {"metadata": {"title": "Transform your ML-model to Pytorch with Hummingbird | by Maarten Grootendorst | Towards Data Science", "h1": "Transform your ML-model to Pytorch with Hummingbird", "description": "Over the last few years, the capabilities of Deep Learning have increased tremendously. With that, many standards of serving your Neural Network have found their way to the masses such as ONNX and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://onnx.ai/", "anchor_text": "ONNX", "paragraph_index": 0}, {"url": "https://tvm.apache.org/", "anchor_text": "TVM", "paragraph_index": 0}, {"url": "https://github.com/microsoft/hummingbird", "anchor_text": "Hummingbird", "paragraph_index": 5}, {"url": "http://learningsys.org/neurips19/assets/papers/27_CameraReadySubmission_Hummingbird%20(5).pdf", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://scnakandala.github.io/papers/TR_2020_Hummingbird.pdf", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://github.com/microsoft/hummingbird/wiki/Roadmap-for-Upcoming-Features-and-Support", "anchor_text": "here", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/mgrootendorst/", "anchor_text": "LinkedIn", "paragraph_index": 33}, {"url": "https://twitter.com/MaartenGr", "anchor_text": "Twitter", "paragraph_index": 33}, {"url": "http://www.linkedin.com/in/mgrootendorst/", "anchor_text": "www.linkedin.com/in/mgrootendorst/", "paragraph_index": 36}], "all_paragraphs": ["Over the last few years, the capabilities of Deep Learning have increased tremendously. With that, many standards of serving your Neural Network have found their way to the masses such as ONNX and TVM.", "That popularity has led to a focus on optimizing Deep Learning pipelines, training, inference, and deployment by leveraging tensor computations.", "In contrast, traditional Machine Learning models such as Random Forests are typically CPU-based on inference tasks and could benefit from GPU-based hardware accelerators.", "Transform your trained Machine Learning model to Pytorch with Hummingbird", "Now, what if we could use the many advantages of Neural Networks in our traditional Random Forest? Even better, what if we could transform the Random Forest and leverage GPU-accelerated inference?", "This is where Microsoft\u2019s Hummingbird comes in! It transforms your Machine Learning model to tensor computations such that it can use GPU-acceleration to speed up inference.", "In this article, I will not only describe how to use the package, but also the underlying theory from the corresponding papers and the roadmap.", "NOTE: Hummingbird is only used to speed up the time to make a prediction, not to speed up the training!", "Before delving into the package, it is important to understand why this transformation is desirable and this could be done.", "In part, a tensor is an N-dimensional array of data (see figure below). In the context of TensorFlow, it can be seen as a generalization of a Matrix that allows you to have multidimensional arrays. You can perform optimized mathematical operations on them without knowing what each dimension represent semantically. For example, like how matrix multiplication is used to manipulated several vectors simultaneously.", "There are several reasons for transforming your model into tensors:", "Transformation to tensors is not a trivial task as there are two branches of models: Algebraic (e.g., linear models) and algorithm models (e.g., decision trees). This increases complexity when mapping a model to tensors.", "Here, the mapping of algorithmic models is especially difficult. Tensor computation is known for performing bulk or symmetric operations. This is difficult to do for algorithmic models as they are inherently asymmetric.", "Let\u2019s use the decision tree below as an example:", "The decision tree is split into three parts:", "The resulting neural network\u2019s first layer is that of the input feature vector which is connected to the four decision nodes (orange). Here, all conditions are evaluated together. Next, all leaf nodes are evaluated together by using matrix multiplication.", "The resulting decision tree, as a neural network, can be seen below:", "The resulting Neural Network introduces a degree of redundancy seeing as all conditions are evaluated. Whereas, normally one path is evaluated. This redundancy is, in part, offset by the Neural Network\u2019s ability to vectorize computations.", "NOTE: There are many more strategies for the transformation of models into tensors, which are described in their papers, here and here.", "According to their papers, the usage of GPU-acceleration creates a massive speed-up in inference compared to traditional models.", "The results above clearly indicate that it might be worthwhile to transform your Forest to a Neural Network.", "I wanted to see for myself how the results would look like on a Google Colaboratory server with a GPU enabled. Thus, I performed a quick, and by no means, scientific, experiment on Google Colaboratory which yielded the following results:", "We can clearly see a large speedup in the inference on new data when using a single dataset.", "Using the package is, fortunately, exceedingly simple. It is clear that the authors have spent significant time making sure the package can be used intuitively and across many models.", "For now, we start by installing the package through pip:", "If you would like to also install the LightGBM and XGboost dependencies:", "Then, we simply start by creating our Sklearn model and training it on the data:", "After doing so, the only thing we actually have to do to transform it to Pytorch is to import Hummingbird and use the convert function:", "The resulting model is simply a torch.nn.Module and can then be exactly used as you would normally work with Pytorch.", "It was the ease of transforming to Pytorch that first grabbed my attention to this package. Just a few lines and you have transformed your model!", "Currently, the following models are implemented:", "Although some models are still missing, their roadmap indicates that they are on their way:", "You can find the full roadmap of Hummingbird here.", "If you are, like me, passionate about AI, Data Science, or Psychology, please feel free to add me on LinkedIn or follow me on Twitter.", "Click one of the posts below for more information about other interesting packages:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Psychologist. Passionate about anything AI-related! Get in touch: www.linkedin.com/in/mgrootendorst/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fda49665497e7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----da49665497e7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da49665497e7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maartengrootendorst?source=post_page-----da49665497e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maartengrootendorst?source=post_page-----da49665497e7--------------------------------", "anchor_text": "Maarten Grootendorst"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22405c3b2875&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&user=Maarten+Grootendorst&userId=22405c3b2875&source=post_page-22405c3b2875----da49665497e7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda49665497e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda49665497e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://onnx.ai/", "anchor_text": "ONNX"}, {"url": "https://tvm.apache.org/", "anchor_text": "TVM"}, {"url": "https://github.com/microsoft/hummingbird", "anchor_text": "Hummingbird"}, {"url": "https://azuredata.microsoft.com/articles/ebd95ec0-1eae-44a3-90f5-c11f5c916d15", "anchor_text": "here"}, {"url": "https://azuredata.microsoft.com/articles/ebd95ec0-1eae-44a3-90f5-c11f5c916d15", "anchor_text": "here"}, {"url": "http://learningsys.org/neurips19/assets/papers/27_CameraReadySubmission_Hummingbird%20(5).pdf", "anchor_text": "here"}, {"url": "https://scnakandala.github.io/papers/TR_2020_Hummingbird.pdf", "anchor_text": "here"}, {"url": "https://azuredata.microsoft.com/articles/ebd95ec0-1eae-44a3-90f5-c11f5c916d15", "anchor_text": "here"}, {"url": "https://gist.github.com/MaartenGr/e07906cea23e137ef1e1d8d3dce2455c", "anchor_text": "here"}, {"url": "https://github.com/microsoft/hummingbird/wiki/Roadmap-for-Upcoming-Features-and-Support", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/mgrootendorst/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/MaartenGr", "anchor_text": "Twitter"}, {"url": "https://towardsdatascience.com/reinforcement-learning-in-a-few-lines-of-code-d6c8af1e0fd2", "anchor_text": "Reinforcement Learning in a few lines of codeTrain SOTA RL-algorithms using Stable Baselines and Gymtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/quickly-build-and-deploy-an-application-with-streamlit-988ca08c7e83", "anchor_text": "Quickly Build and Deploy an Application with StreamlitDeploying your Streamlit application to Heroku to showcase your Data Solutiontowardsdatascience.com"}, {"url": "https://towardsdatascience.com/opening-black-boxes-how-to-leverage-explainable-machine-learning-dd4ab439998e", "anchor_text": "Opening Black Boxes: How to leverage Explainable Machine LearningUsing PDP, LIME, and SHAP to create interpretable decisions that create value for your stakeholderstowardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----da49665497e7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----da49665497e7---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----da49665497e7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----da49665497e7---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----da49665497e7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda49665497e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&user=Maarten+Grootendorst&userId=22405c3b2875&source=-----da49665497e7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda49665497e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&user=Maarten+Grootendorst&userId=22405c3b2875&source=-----da49665497e7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda49665497e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da49665497e7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fda49665497e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----da49665497e7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----da49665497e7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----da49665497e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----da49665497e7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----da49665497e7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----da49665497e7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----da49665497e7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----da49665497e7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----da49665497e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maartengrootendorst?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maartengrootendorst?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maarten Grootendorst"}, {"url": "https://medium.com/@maartengrootendorst/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.5K Followers"}, {"url": "http://www.linkedin.com/in/mgrootendorst/", "anchor_text": "www.linkedin.com/in/mgrootendorst/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22405c3b2875&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&user=Maarten+Grootendorst&userId=22405c3b2875&source=post_page-22405c3b2875--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb052d90faf55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-your-ml-model-to-pytorch-with-hummingbird-da49665497e7&newsletterV3=22405c3b2875&newsletterV3Id=b052d90faf55&user=Maarten+Grootendorst&userId=22405c3b2875&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}