{"url": "https://towardsdatascience.com/building-kriging-models-in-r-b94d7c9750d8", "time": 1683014902.8528671, "path": "towardsdatascience.com/building-kriging-models-in-r-b94d7c9750d8/", "webpage": {"metadata": {"title": "Building Kriging Models in R. Utilizing Spatial Statistics Algorithms\u2026 | by Aisha Sikder, PhD | Towards Data Science", "h1": "Building Kriging Models in R", "description": "With geo tagged data we can make spatial predictions using kriging in R. We build the variogram to plot the autocorrelation between points to find at what distance data is no longer relevant."}, "outgoing_paragraph_urls": [{"url": "https://data.cityofchicago.org/Public-Safety/Police-Stations/z8bn-74gv", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://data.cityofchicago.org/Public-Safety/Police-Stations/z8bn-74gv", "anchor_text": "here", "paragraph_index": 3}], "all_paragraphs": ["In our world today, we have access to enormous amounts of geo-tagged data. Instead of letting it sit in a database or text file, we have the ability to utilize that information in various ways enabling us to create new information for better decision making.", "One of the benefits to spatial statistics models is being able to analyze any point is space by calculating the correlation between nearby points and the point of interest. There are a number of spatial models that can be used, but my favorite is Kriging. While other methods such as Geographically Weighted Regression (GWR) or Inverse Distance Weighting (IDW) can be useful exploratory tools, in my experience, Kriging tends to scale better as the data increases and, in many cases, makes more accurate predictions.", "In this article, I show how Kriging in R can be utilized to make predictions and provide Tip & Tricks using the police station data from the City of Chicago (data found here). The goal is to make interpolations of the frequency of crime in the city of Chicago at any given point. This spatial statistics technique allows us to harness the data we have, build a model to explain the spatial structure of the area, and make predictions at any other latitudinal/longitudinal point in space based on that spatial structure.", "Before we begin, I\u2019d like to discuss the data set so that we understand what is being predicted. The data can be found here and I downloaded the csv onto my local drive. The file has 22 variables and over 7 million rows, but for this tutorial we will only be utilizing the coordinate points (Latitude and Longitude), the Primary Type of crime, and the Description of the crime.", "[Tips & Tricks] It\u2019s important to Krige only the value of a specific category type. This means that we can interpolate points for only one type of crime at a time, otherwise the interpolated points won\u2019t make any sense. Thus, the specific crime that will be focused on is Criminal Damage To Vehicle and we will use Kriging to interpolate the frequency of this type of crime in the city of Chicago.", "Once we filter the data, count the frequency of that crime (with variable name n) at every unique location (Latitude and Longitude), and add an index for each unique location (location_id), the data will look similar to Figure 1.", "The idea behind kriging is to use a limited set of data points to predict other nearby points in a given area. This method allows scientists in the field to only sample of small number of data points and interpolate the rest which saves time and money. Therefore, to simulate this approach, we can randomly take 10,000 points as the training set to build the model (shown in Figure 2(a)) .", "We then can use the model on a grid of points around the area of interest as shown in Figure 2(b). The grid of points were autogenerated by building a polygon and creating over 76,000 latitudinal/longitudinal points within the polygon (the code has been excluded from this article for brevity).", "Once the data is prepped, the first step is to build a variogram and fit a curve function to it which can then be used to interpolate values for the grid of points. Thankfully, with the gstat package in R, this can be done easily using the variogram function.", "[Tips & Tricks] The log function was used to ensure that all interpolated values remain positive. The exp function will be used to normalize the results in the \u2018Let\u2019s Krige\u2019 section of this article.", "The variogram and the curve function can be plotted to understand the spatial structure of our area and can be shown in Figure 3. Visually speaking, we can see that the curve function (Matern) can describe the autocorrelation between points relatively well. We can see that around 1.1 km, the point pairs are no longer spatially correlated.", "We can now use this information to krige the grid of points using the krige function from the gstat package. As mentioned previously, the grid of points have already been generated and have been omitted from this article for brevity. However, any of the other points in the data that have not been included in the training set can be used to interpolate points and test the accuracy.", "Figure 4(a) shows the points that were used to build the model and is zoomed into uptown Chicago to see the data points better. Once the code has been applied and the grid points have been kriged, we can see the predictions shown in Figure 4(b). Displayed are the hot spots of where the model calculates the highest frequencies for Criminal Damage To Vehicle as well as the areas that may have lower frequencies of that crime. Kriging fills in the blanks of the data we don\u2019t have. While we may have many data points to choose from in Figure 4(a), not every point in this area is covered. For all those points that we don\u2019t have, Kriging comes into play and fills in the holes adding coverage to the area as shown in Figure 4(b).", "Spatial analysis allows you to solve complex location-oriented problems and better understand where and what is occurring in your world. It goes beyond mere mapping to let you study the characteristics of places and the relationships between them. Spatial analysis lends new perspectives to your decision-making.", "Understanding our data spatially is an important step in making predictions. This is one of the reasons I like kriging. When we build our variogram (shown in Figure 3), it is clear when the autocorrelation between points stops which tells us at what distance, the data is no longer relevant. The variogram is then utilized to make interpolations on new data.", "While the visuals are always exciting, testing the accuracy of the model is vital before implementing it in the real world. Although it was not discussed in this article, tests were conducted to measure the accuracy of the model using the train/test split method on the data (14% training and 86% testing) with an RMSE of 1.81 and MAE of 0.80.", "With spatial statistics, we can turn our intuition of how spatially correlated the data might be and mathematically calculate exactly at what point that correlation ends. I hope this article helps you to brainstorm what other data sets might be spatially correlated and how Kriging can help you understand it better!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb94d7c9750d8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aisha.sikder?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aisha.sikder?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": "Aisha Sikder, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F963af01f388c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&user=Aisha+Sikder%2C+PhD&userId=963af01f388c&source=post_page-963af01f388c----b94d7c9750d8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb94d7c9750d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb94d7c9750d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@simonmigaj?utm_source=medium&utm_medium=referral", "anchor_text": "Simon Migaj"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://data.cityofchicago.org/Public-Safety/Police-Stations/z8bn-74gv", "anchor_text": "here"}, {"url": "https://data.cityofchicago.org/Public-Safety/Police-Stations/z8bn-74gv", "anchor_text": "here"}, {"url": "https://unsplash.com/@thejohnnyme?utm_source=medium&utm_medium=referral", "anchor_text": "Nikola Johnny Mirkovic"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.esri.com/arcgis-blog/products/product/analytics/the-power-of-where-how-spatial-analysis-leads-to-insight/", "anchor_text": "Esri"}, {"url": "https://medium.com/tag/kriging?source=post_page-----b94d7c9750d8---------------kriging-----------------", "anchor_text": "Kriging"}, {"url": "https://medium.com/tag/r?source=post_page-----b94d7c9750d8---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b94d7c9750d8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/spatial-analysis?source=post_page-----b94d7c9750d8---------------spatial_analysis-----------------", "anchor_text": "Spatial Analysis"}, {"url": "https://medium.com/tag/statistics?source=post_page-----b94d7c9750d8---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb94d7c9750d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&user=Aisha+Sikder%2C+PhD&userId=963af01f388c&source=-----b94d7c9750d8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb94d7c9750d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&user=Aisha+Sikder%2C+PhD&userId=963af01f388c&source=-----b94d7c9750d8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb94d7c9750d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb94d7c9750d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b94d7c9750d8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b94d7c9750d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aisha.sikder?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aisha.sikder?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aisha Sikder, PhD"}, {"url": "https://medium.com/@aisha.sikder/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "58 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F963af01f388c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&user=Aisha+Sikder%2C+PhD&userId=963af01f388c&source=post_page-963af01f388c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb6b46fc07bdd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-kriging-models-in-r-b94d7c9750d8&newsletterV3=963af01f388c&newsletterV3Id=b6b46fc07bdd&user=Aisha+Sikder%2C+PhD&userId=963af01f388c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}