{"url": "https://towardsdatascience.com/building-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1", "time": 1683010598.396935, "path": "towardsdatascience.com/building-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1/", "webpage": {"metadata": {"title": "Building My First Machine Learning Model | NBA Prediction Algorithm | by Alexander Fayad | Towards Data Science", "h1": "Building My First Machine Learning Model | NBA Prediction Algorithm", "description": "EDIT: Since writing this article, we have launched a subscription service at https://infinitysports.ai which gives access to the API and outputs of our new NBA prediction model. We are now able to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://infinitysports.ai", "anchor_text": "https://infinitysports.ai", "paragraph_index": 0}, {"url": "https://watchstadium.com/which-nba-statistics-actually-translate-to-wins-07-13-2019/", "anchor_text": "Which NBA Statistics Actually Translate to Wins", "paragraph_index": 3}, {"url": "https://selenium-python.readthedocs.io/", "anchor_text": "Selenium", "paragraph_index": 6}, {"url": "https://www.basketball-reference.com/", "anchor_text": "Basketball-Reference.com", "paragraph_index": 7}, {"url": "https://stats.nba.com/", "anchor_text": "official NBA Stats", "paragraph_index": 9}, {"url": "https://speedml.com/", "anchor_text": "Speedml", "paragraph_index": 19}, {"url": "https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html", "anchor_text": "this flowchart provided by Scikit-learn", "paragraph_index": 26}, {"url": "https://www.oddsshark.com/sports-betting/which-sport-do-betting-underdogs-win-most-often", "anchor_text": "an upset rate of 32.1%", "paragraph_index": 29}, {"url": "https://www.linkedin.com/in/alexanderfayad/", "anchor_text": "Linkedin", "paragraph_index": 34}, {"url": "https://twitter.com/alexanderfayad", "anchor_text": "Twitter", "paragraph_index": 34}], "all_paragraphs": ["EDIT: Since writing this article, we have launched a subscription service at https://infinitysports.ai which gives access to the API and outputs of our new NBA prediction model. We are now able to predict the winner, spreads, and point totals. I have thoroughly loved working on this project, please feel free to reach out with any questions!", "When I started programming a few years back, I never had a purpose for what I would use my newfound skills for. I toyed around with building video games, making basic websites, iOS applications, but in a way, I was spreading myself thin by not specializing in a certain craft. Around this time, the Toronto Raptors were on a historic playoff run, and I had just started playing around with bet365 and happened to make a good profit betting exclusively on them during the entire playoffs.", "Given my background in both Commerce and Computer Science, I wanted to learn more about the role of a Quantitative Analyst and Data Scientist. I began to explore the world of data science and started by learning the basics of the Scikit-learn package given my background in python. The rest of this article is going to outline how I went from knowing next to nothing about Data Science and Machine Learning to building my first NBA prediction model with a ~72% accuracy (more on this later but the results aren\u2019t as great as they seem).", "The NBA, as well as many other sports, has seen the use of statistics exponentially grow over the last 10\u201320 years. I began my search on the most relevant NBA stats by reading Which NBA Statistics Actually Translate to Wins by Chinmay Vayda. His research discovered that the best predictors of wins in the NBA were a team\u2019s Offensive Rating, Defensive Rating, Rebound Differential, 3-Point %, among other stats, which you can read more about by following the link above.", "I planned to use more recent data, by leveraging the NBA\u2019s monthly statistics and using those as the predictors for the matches that were played during that month. Since this was my first attempt at building a model, I wanted to keep the data simple and keep the mathematical complexity at a minimum.", "The next step was figuring out how to acquire this data. I needed a data source for match results of the last ~10 years, as well as a source for a team\u2019s statistics in any given month.", "For the data acquisition portion of this project, I used Selenium, a python package that facilitates web scraping, to get the data I needed off various websites. I also decided to limit my search to data beginning from the 2008\u20132009 season to the present.", "My data source for the past results was Basketball-Reference.com, which had match results going back to 1946.", "Using Selenium, I scraped these tables one-by-one and converted them to CSV files for later use.", "I also needed to know what every team\u2019s stats were for any given month, and my data source for this was the official NBA Stats page. After tweaking with a few filters, I ended up with the following table.", "Once again, I used Selenium and scraped these monthly stats tables, and saved them as CSV files. My next step was to merge these files into one dataset.", "We now had to process our 2 sets of CSV files in a format where they can be compared and analyzed. I have embedded below examples of the first 5 lines of each CSV file, exactly as they were scrapped.", "The first thing we notice is that neither table has a header, which will need to be added manually by referencing the original table. Second of all, we have multiple empty columns littered in our datasets, which need to be dropped. Lastly, in our results dataset, we need to drop the time column, the box score text, and the attendance numbers, since they won\u2019t be useful to us.", "Following these steps, our datasets now look like this:", "The code below outlines how I went about merging the two CSV files, as well as adding a new column for whether Team 1 won or lost, which would become our predictor variable. I posted the code since the specifics of the merging aren\u2019t easy to explain, but if you are interested you can take a look below.", "After executing the code outlined above, our dataset now looks like this:", "We now have our dataset, which compares each team\u2019s stats and states which team won the encounter. At the end of this process, our dataset contains over 13,000 unique matchups! This dataset is now very close to being ready for machine learning analysis.", "Since I only needed the team names and scores to merge the datasets and figure out which team won, I will also get rid of those columns, and be left with a dataset that is now able to be explored and modeled for machine learning.", "Our current dataset looks like this:", "I was now interested in knowing how the various statistics in our dataset correlate with one another. A friend of mine introduced me to a great python package called Speedml which simplifies the process of exploratory analysis and produces great looking plots to share your data.", "When you have numerical features, it is always interesting to see how each feature in our dataset correlates to the other. The plot below illustrates our feature correlations, and it has some interesting insights that we can derive.", "Firstly, we can tell that since both the top left and bottom right quadrants have the most correlated features, a team\u2019s stats correlate strongly to itself. If a team has a high PACE, it will probably also have a high OFFRTG.", "We also see that the \u2018Team1Win\u2019 feature, is not heavily correlated to any specific feature, although a few may stand out as stronger correlations than others. This leads me to create a feature importance plot, another easy to use implementation included in Speedml.", "Although we do see some features with greater importance, we don\u2019t have a clear reason to eliminate any features at this point, but it allows for some interesting observations to be made.", "The reason for the high importance for Team2NETRTG can be seen in the strip plot above; when Team 2 has a higher Net Rating, Team 1 tends to win less, and on the flip side, when Team 2 has a lower Net Rating, Team 1 tends to have a higher chance of winning.", "Finally, the last plot I found interesting was the distribution of Team 1\u2019s wins. The way our data was acquired, Team 1 is always the away team. This distribution shows that the away team loses about ~59% of the time, which illustrates what we know as the home-court advantage.", "I chose to use Scikit-learn, given the ease of implementation for a variety of algorithms and my experience with python. Using this flowchart provided by Scikit-learn, I identified a few models I would want to try out, and see which one performed the most accurately on my dataset. My attempts began as follows:", "Out of all the models attempted, the one with the highest accuracy was the support vector machine SVC classifier, with an accuracy of 72.52% on historical data! It was now time to test this model in the real world, where I attempted predicting the outcome of 67 games, before the NBA shutting down as a result of COVID-19.", "For my first 28 game predictions, I was simply going off who was going to win, not taking into account the spread I was offered. For the remainder of my prediction, I implemented a scoring method that gave me a spread that my algorithm created, based on which team was more likely to win. My results for the algorithm accuracy were as follows:", "A major weakness of my algorithm is the ability to predict upsets. On the first day of running my model, in 5 out of 7 games the underdog won the match. My algorithm was typically in line with what online sports betting websites published which was a good sign. Reading online, we can see that the NBA typically has an upset rate of 32.1%, while my sample size had an upset rate of 40.2%.", "I also wanted to attempt a financial strategy and began by simply betting on the predicted winner. But after updating my model, I implemented a money-line which I compared with the lines offered by bet365. I compared my odds to bet365\u2019s and chose the more favorable of the two. Below we can see the results of the blind and selective strategies.", "Immediately we can tell that selectiveness is a better strategy, which involves choosing the more favorable odds.", "I have been waiting till the end of the article to address this, but one major flaw in this model, which took me a few months to realize, is that the data it uses is biased. Put simply, a team\u2019s monthly stats are influenced directly by their performance in that month\u2019s games, so given that I was using a given month\u2019s stats to predict the team\u2019s performance, the stats already included their performance in those games. This realization led me to start building my new NBA prediction model.", "The reason I chose to write and release this article now is that I built this model back in January/February of 2020, and I have been working on an updated, more comprehensive model that will use an Artificial Neural Network for predicting not wins or losses, but the actual scores of each encounter. This new model will be based on the players within a team as opposed to the team as a whole. I will be writing about this journey in the coming weeks and hope to share some good news!", "If you enjoyed this article or would like to discuss any of the information mentioned, you can reach out to me on Linkedin, Twitter, or by Email.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist @ Moneris | Queen\u2019s University, Bachelor of Commerce and Bachelor of Computer Science Grad"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdee5c5bc4cc1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alexfayad?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexfayad?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": "Alexander Fayad"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5a8bdf36e05&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&user=Alexander+Fayad&userId=c5a8bdf36e05&source=post_page-c5a8bdf36e05----dee5c5bc4cc1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdee5c5bc4cc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdee5c5bc4cc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markusspiske?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Spiske"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://infinitysports.ai", "anchor_text": "https://infinitysports.ai"}, {"url": "https://watchstadium.com/which-nba-statistics-actually-translate-to-wins-07-13-2019/", "anchor_text": "Which NBA Statistics Actually Translate to Wins"}, {"url": "https://unsplash.com/@neonbrand?utm_source=medium&utm_medium=referral", "anchor_text": "NeONBRAND"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://selenium-python.readthedocs.io/", "anchor_text": "Selenium"}, {"url": "https://www.basketball-reference.com/", "anchor_text": "Basketball-Reference.com"}, {"url": "https://basketball-reference.com", "anchor_text": "Basketball-Reference.com"}, {"url": "https://stats.nba.com/", "anchor_text": "official NBA Stats"}, {"url": "https://stats.nba.com/", "anchor_text": "NBA Advanced Stats"}, {"url": "https://speedml.com/", "anchor_text": "Speedml"}, {"url": "https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html", "anchor_text": "this flowchart provided by Scikit-learn"}, {"url": "https://www.oddsshark.com/sports-betting/which-sport-do-betting-underdogs-win-most-often", "anchor_text": "an upset rate of 32.1%"}, {"url": "https://www.linkedin.com/in/alexanderfayad/", "anchor_text": "Linkedin"}, {"url": "https://twitter.com/alexanderfayad", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dee5c5bc4cc1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----dee5c5bc4cc1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----dee5c5bc4cc1---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/nba?source=post_page-----dee5c5bc4cc1---------------nba-----------------", "anchor_text": "NBA"}, {"url": "https://medium.com/tag/sports-betting?source=post_page-----dee5c5bc4cc1---------------sports_betting-----------------", "anchor_text": "Sports Betting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdee5c5bc4cc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&user=Alexander+Fayad&userId=c5a8bdf36e05&source=-----dee5c5bc4cc1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdee5c5bc4cc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&user=Alexander+Fayad&userId=c5a8bdf36e05&source=-----dee5c5bc4cc1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdee5c5bc4cc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdee5c5bc4cc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dee5c5bc4cc1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dee5c5bc4cc1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexfayad?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexfayad?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexander Fayad"}, {"url": "https://medium.com/@alexfayad/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "49 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5a8bdf36e05&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&user=Alexander+Fayad&userId=c5a8bdf36e05&source=post_page-c5a8bdf36e05--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb992f25ac0c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-my-first-machine-learning-model-nba-prediction-algorithm-dee5c5bc4cc1&newsletterV3=c5a8bdf36e05&newsletterV3Id=b992f25ac0c7&user=Alexander+Fayad&userId=c5a8bdf36e05&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}