{"url": "https://towardsdatascience.com/from-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6", "time": 1683017062.4951198, "path": "towardsdatascience.com/from-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6/", "webpage": {"metadata": {"title": "From Logistic Regression to Basis Expansions and Splines | by Robby Sneiderman | Towards Data Science", "h1": "From Logistic Regression to Basis Expansions and Splines", "description": "Logistic Regression is a common method used for fitting a binary or categorical response variable. But did you know that if you are not careful, logistic regression can miss out on important\u2026"}, "outgoing_paragraph_urls": [{"url": "https://web.stanford.edu/~hastie/ElemStatLearn/datasets/SAheart.info.txt", "anchor_text": "South African Heart Disease data", "paragraph_index": 1}, {"url": "https://github.com/Robby955/SAHeartDisease", "anchor_text": "github", "paragraph_index": 2}, {"url": "https://www.linkedin.com/in/robert-sneiderman-359710188/?originalSubdomain=ca", "anchor_text": "add me on LinkedIn.", "paragraph_index": 49}, {"url": "https://web.stanford.edu/~hastie/ElemStatLearn/", "anchor_text": "Please see The Elements of Statistical Learning II for more.", "paragraph_index": 50}, {"url": "https://web.stanford.edu/~hastie/", "anchor_text": "Trevor Hastie.", "paragraph_index": 50}], "all_paragraphs": ["Logistic Regression is a common method used for fitting a binary or categorical response variable. But did you know that if you are not careful, logistic regression can miss out on important features?", "In this in depth article, we will use the South African Heart Disease data, in combination with Chapters 4 and 5 of The Elements of Statistical Learning II to demonstrate why you need to be careful when applying logistic regression. We will also use this example as a starting point to introduce basis functions and splines.", "In particular, we will learn about non-linearity, and how non-linear features can be incorporated into models. It will be fun, so, if you want to learn more intermediate statistical techniques, or are just looking for a review, please read along. The code used can be found on my github.", "The South African Heart Disease dataset comes from a real 1983 retrospective study and consists of 462 observations, with the response of interest being Myocardial Infarction, or coronary heart disease (chd) (0/1 or no/yes). The dataset includes several numeric predictors such as Systolic Blood Pressure (sbp), Total Kilograms of Tobacco smoked (tobacco), obesity, alcohol, ldl, and age. There is also a binary factor variable (famhist (Present or Absent)).", "Which predictors do you think will be most significant when modelling? Try to choose some before continuing.", "We will now demonstrate the general approach that one might take for creating a model for chd. We will start with the usual first steps, examining the data and checking out the predictors.", "Firstly, you should always examine structured data if possible. R comes with the \u2018View\u2019 function which allows us to conveniently see what our data looks like. (Note, we remove predictors adiposity and typea as these were not used in the reviews/books).", "After looking at the data in a basic form, we want to get an idea about how our predictors are correlated with one another, and how they are correlated with the response. We can do this using a pairs plot, which is also built into R with the \u2018pairs\u2019 function. We colour our points according to whether the patient was healthy (black points) or had a heart attack (red points).", "To classify the response, chd, we are simply trying to classify a binary response. We thus attempt to model the probability that our response belongs to one group, given the predictors X.", "We model the so called logit, this ensures that our estimates remain in the interval [0,1] as we are modelling a probability.", "Logistic Regression is the usual go to method for problems involving classification. R allows for the fitting of general linear models with the \u2018glm\u2019 function, and using family=\u2019binomial\u2019 allows us to fit a response. Logistic Regression models are often fit using maximum likelihood using iterated reweighed least squares.", "Logistic Regression can be fit using iterated reweighed least squares or minimisation of a cost function. In R, we can fit logistic regression for a binary response using the \u2018glm\u2019 function and specifying the family as \u2018binomial\u2019.", "Here is the result of naively applying logistic regression to the heart data:", "Think back to the question I asked about choosing some important variables. It is very likely you chose famhist (that would be correct), but you also probably choose one of obesity or blood pressure (sbp). We know that those definitely have an impact on heart disease, so why is logistic regression indicating these are not significant predictors?", "This example helps illustrate the problem of colinearity. According to Figure 6, obesity has a negative estimate and is not significant, which seems to go against all that we know from medical science. Also, according to the Figure 6, systolic blood pressure is not significant, which seems odd. The issue is, we have correlation. Modelled independently, sbp and obesity have negative signs and are significant.", "Let us apply backward step selection, which is recommended when you believe there is correlated predictors. R has the built in \u2018step\u2019 function.", "Our final model apparently does not include obesity or sbp!", "Before we move on, it is worth it to review how to interpret the summary table (Figure 7). The estimate for tobacco is 0.0807 with a standard error of 0.0255. Since tobacco was measured in total lifetime usage in kilograms, a 1 unit increase in tobacco represents an exp(0.0807)=1.084 increase in logit odds for chd. That is an 8.4% increase in heart attack! We can also calculate exp(0.0807+/ 2*0.255)=(1,03,1.14) to get the 95% confidence interval, so it ranges from a 3% to a 14% increase.", "But are we done? Does obesity and sbp really not have an impact on heart attack? If we stopped there, our model still might be okay. But it seems something is going wrong. The reason is that above we fit linear logistic regression. But there are NON linear features. To understand this, we need to understand basis expansions. Come along.", "Above we saw that simply using linear functions to model our response didn\u2019t seem to fully address our concern. Moreover, \u2018 reality\u2019 or the \u2018true function\u2019 is almost never linear, so what are the chances that fitting a model using only linear methods will be sufficient? True, linear models are still wildly popular and useful. They are certainly necessary, but are they sufficient?", "When we fit linear models such as linear regression or linear logistic regression we modelled our function in the form:", "To model non-linearity, we don\u2019t mean our weights \u03b2. We instead refer to the terms, or the basis functions, multiplying the weights;", "That is, we form models like this instead;", "We will see why this is useful and how it can be implemented.", "Suppose X is a one-dimensional set of observations. By separating the domain of X into adjoining regions, and fitting a polynomial to each region separately, we can start to get at the idea of fitting more complicated functions.", "For example, see the Figure below which shows the division of the domain of X into three regions, separated at points \u01901 and \u01902. These are often referred to as \u2018knots\u2019.", "The function in blue represents some real function. The points around it were generated from the function and then adding noise. In practice, we receive noise and want to find the true underlying structure, the blue curve.", "The green line indicate the model fit using the following three basis functions and least squares;", "The green lines indicate the least squares solution in each interval which is;", "That is a very simple case, and clearly the fit is not great. Moving on, we could perform simple linear regression in each interval. This requires an additional three basis functions that allow us to model the slope term;", "And each solution is found using the simple linear regression formula for the weights as usual.", "But we are still missing something. We want to enforce continuity. So we should make the constraints that we touch on the intervals;", "Which results in the following fit:", "Above we considered fitting linear functions locally in each interval, but the major benefit of basis functions is we can also model non linear functions.", "The bottom right image is continuous and has continuous first derivative and a continuous second derivatives. This thus known as a CUBIC SPLINE. The following six basis functions define a cubic spline.", "The top left shows polynomial regression fit to each interval. The top right shows polynomial regression with enforced continuity. The bottom left shows polynomial regression with enforced continuity and enforced continuity of the first derivative. The bottom right, the cubic spline has enforced continuity of the second derivative as well.", "We have discussed the constraints, there is another constraint that forms what is known as the natural cubic spline, this constraint is that the function is linear past the boundary knots, two constraints each in both boundary regions, a natural cubic spline with K knots is represented by K basis functions. We will fit our SA heart data with predictors with natural cubic splines.", "Now that we have reviewed basis functions and non-linearity, we can return to the South African Heart disease data! While before we modelled the logit just using the X terms in isolation, we now repeat but allow for the X terms themselves to be modelled by a natural spline. Thus our estimate for chd will have the form;", "We fit each of our numeric predictors using a natural spline with four basis functions. Notice that sbp and obesity are non-linear.", "We then created a logistic regression using the expanded predictors, which included the non-linear terms.Instead of simply multiplying the coefficient by itself by a weight, we multiply a weight by the BASIS function of the parameter, with the basis function being a non-linear fit using splines of that variable! We then used the drop function to remove terms that were not significant. You can fit spline terms in R with the \u2018ns\u2019 function. Input the df to tell R how many basis functions you want the spline to fit.", "Our final model includes higher order terms, including obesity and sbp! It turns out, indeed they were important, but they were lost by not considering that they had a non-linear impact.", "We can confirm they are important in the model by seeing what happens if we remove them from the model.", "Figure 25 summaries the Likelihood ratio test when a spline term is deleted from the model. Notice, removing \u2018no\u2019 terms keeps the AIC the lowest. Removing any other spline terms raises the AIC. Hence keeping obesity and sbp is indeed useful.", "Be careful using simple linear logistic regression! It may miss out on non-linear features, and it has issues with correlation among predictors. Splines are a way to fit non-linear features and the LRT (Likelihood Ratio Test) can tell you the impact of removing higher order splines from model.", "So why did we see an increase in heart attack at low values of sbp and obesity? It turns out this was due to the method of the original study, it was a retrospective study, and measurements were made after a heart attack had occurred. Hence, patients had already begun to fix their lifestyle (weight and blood pressure). For example, they had a heart attack and so were extra diligent to lower obesity, this likely explains it!", "Above we studied one-dimensional splines. But indeed, they can be expanded to multiple dimensions. The details are a bit much for an article, but involves forming the tensor product basis. Below is an example of fitting a thin plate spline to three of the heart disease risk factors and representing the contour plot, the green and red points are the knots.", "In this article, we reviewed a common real dataset and saw how logistic regression can be fit to model a response variable. We also saw how logistic regression can fail to pick up on important features, especially when there is non-linearity or correlation in the predictors.", "We also reviewed splines and basis functions, and saw how local polynomial regression can be used to fit better models. In our original model for heart disease, logistic regression missed out on obesity and sbp as important features. We had to consider non-linearity for our model to pickup the significance of these features.", "Also, if you liked this article, please check out my other Medium articles and consider leaving a clap or a comment, or sharing if you learnt something new.", "If you want to connect, add me on LinkedIn.", "Please see The Elements of Statistical Learning II for more. Images from the textbook are reprinted with permission from Trevor Hastie.", "[1] Hastie, Tibshirani, Friedman (2009). The Elements of Statistical Learning, II edition.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F74d6bb3b8dc6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rob-sneiderman.medium.com/?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": ""}, {"url": "https://rob-sneiderman.medium.com/?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": "Robby Sneiderman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd494db13357&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&user=Robby+Sneiderman&userId=cd494db13357&source=post_page-cd494db13357----74d6bb3b8dc6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F74d6bb3b8dc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F74d6bb3b8dc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jannerboy62", "anchor_text": "Nick Fewings"}, {"url": "https://web.stanford.edu/~hastie/ElemStatLearn/datasets/SAheart.info.txt", "anchor_text": "South African Heart Disease data"}, {"url": "https://github.com/Robby955/SAHeartDisease", "anchor_text": "github"}, {"url": "https://www.linkedin.com/in/robert-sneiderman-359710188/?originalSubdomain=ca", "anchor_text": "add me on LinkedIn."}, {"url": "https://web.stanford.edu/~hastie/ElemStatLearn/", "anchor_text": "Please see The Elements of Statistical Learning II for more."}, {"url": "https://web.stanford.edu/~hastie/", "anchor_text": "Trevor Hastie."}, {"url": "https://github.com/Robby955/SAHeartDisease", "anchor_text": "https://github.com/Robby955/SAHeartDisease"}, {"url": "https://people.cs.clemson.edu/~dhouse/courses/405/notes/splines.pdf", "anchor_text": "https://people.cs.clemson.edu/~dhouse/courses/405/notes/splines.pdf"}, {"url": "https://medium.com/tag/data-science?source=post_page-----74d6bb3b8dc6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----74d6bb3b8dc6---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----74d6bb3b8dc6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----74d6bb3b8dc6---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----74d6bb3b8dc6---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F74d6bb3b8dc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&user=Robby+Sneiderman&userId=cd494db13357&source=-----74d6bb3b8dc6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F74d6bb3b8dc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&user=Robby+Sneiderman&userId=cd494db13357&source=-----74d6bb3b8dc6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F74d6bb3b8dc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F74d6bb3b8dc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----74d6bb3b8dc6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----74d6bb3b8dc6--------------------------------", "anchor_text": ""}, {"url": "https://rob-sneiderman.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rob-sneiderman.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Robby Sneiderman"}, {"url": "https://rob-sneiderman.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "98 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd494db13357&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&user=Robby+Sneiderman&userId=cd494db13357&source=post_page-cd494db13357--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2e6ea218c897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-logistic-regression-to-basis-expansions-and-splines-74d6bb3b8dc6&newsletterV3=cd494db13357&newsletterV3Id=2e6ea218c897&user=Robby+Sneiderman&userId=cd494db13357&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}