{"url": "https://towardsdatascience.com/illustrated-guide-to-siamese-network-3939da1b0c9d", "time": 1683008062.0281239, "path": "towardsdatascience.com/illustrated-guide-to-siamese-network-3939da1b0c9d/", "webpage": {"metadata": {"title": "Illustrated Guide to Siamese Network | by Pranjal Gupta | Towards Data Science", "h1": "Illustrated Guide to Siamese Network", "description": "Building an accurate Machine learning model often requires for a lot of training data, which still might end up over-fitting on training data or work for a limited number of classes in data it was\u2026"}, "outgoing_paragraph_urls": [{"url": "https://jalammar.github.io/illustrated-word2vec/", "anchor_text": "article", "paragraph_index": 3}, {"url": "https://twitter.com/JayAlammar", "anchor_text": "Jay Alammar", "paragraph_index": 3}, {"url": "https://github.com/brendenlake/omniglot", "anchor_text": "Omniglot data set", "paragraph_index": 5}, {"url": "https://stats.stackexchange.com/a/331967/283107", "anchor_text": "L2 normalization", "paragraph_index": 6}, {"url": "https://youtu.be/d2XB5-tuCWU?t=138", "anchor_text": "trivial solution", "paragraph_index": 12}, {"url": "https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf", "anchor_text": "paper", "paragraph_index": 14}, {"url": "https://github.com/pranjalg2308/siamese_triplet_loss", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/one-shot-learning-with-siamese-networks-using-keras-17f34e75bb3d", "anchor_text": "article", "paragraph_index": 19}, {"url": "https://www.alliance.edu.in/aicaam-conference-proceedings/Papers/Siamese-Triple-Ranking-Convolution-Network.pdf", "anchor_text": "detect signature forgery", "paragraph_index": 20}, {"url": "https://www.cs.toronto.edu/~ranzato/publications/taigman_cvpr14.pdf", "anchor_text": "face recognition", "paragraph_index": 20}], "all_paragraphs": ["Building an accurate Machine learning model often requires for a lot of training data, which still might end up over-fitting on training data or work for a limited number of classes in data it was trained for. But what if a machine can \u201clearn-to-learn\u201d, for example, if we ever show our machine a single image of a parrot, it can accurately identify another image of parrot by understanding how it is similar to the image of parrot shown as a reference. This problem of designing a machine that can \u201clearn-to-learn\u201d is called meta-learning.", "In this article, we will focus on a famous meta-learning model \u2014 Siamese Network. How it works and how to implement it?", "Siamese, as the name suggests, comes from \u2018Siamese Twins\u2019, where we use two or more network(here, CNN in the case of images) which uses shared weights with intention to learn similarity and dissimilarity between images. The network outputs an n-dimensional embedding where each direction represents some visual pattern of the image.", "Suppose, we use n-dimensional space to map our image, where each dimension corresponds to value of a particular trait/or pattern. Each dimension narrates a unique visual feature of the input image. Check out this amazing article by Jay Alammar for better intuition of embedding. For example in the case of different animal images, an output embedding might look like this(intensity of colour denotes its value between 0 to 1) \u2014", "First two images of dog, outputs similar embedding, whereas third and fourth output embedding of cat and llama is very different from a dog because they have a very different bag of visual features.", "In this article, we will be working on Omniglot data set. This data set has character images of various alphabets used all across the world in different languages.", "Our CNN outputs a 1-D array of the desired size of embedding. We can see that last layer performs L2 normalization, this will normalize the output vector and map it to the surface of n-dimensional hyper-sphere of radius 1. This is done to make sure that the value of similarity between images can be compared by calculating distance between two embeddings, as all the embedding will reside on the surface that will give a better result. Our model has three of these CNN and all shares the same weight. This will help our model to learn one similarity and one dissimilarity in each sample. Each sample will contain triplet constituting anchor, positive and negative sample image. More on this in a while.", "Now comes the most important part of building this net. Here, we will write the definition of how it compares output embedding and understand similarity/dissimilarity between them, and thus fulfil the task of meta-learning.", "Since we have our output embedding mapped onto the surface using earlier discussed L2 Normalization, we can either use L2 distance or Cosine Similarity. Using triplet loss will allow our model to map two similar images close to one another, and far from dissimilar sample image. This approach is implemented by feeding triplet constituting :", "1. Anchor Image \u2014 This is a sample image.", "2. Positive Image \u2014 This is just another variation of the anchor image. This helps model learns the similarities between the two images.", "3. Negative Image \u2014 This is a different image from above two similar images. This helps our model learn dissimilarities with anchor image.", "To increase the distance between similar and dissimilar output vector, and further map similar images close to one another, we introduce one more term called margin. This increases the separation between out similar and dissimilar vector, and also eliminate output of any trivial solution. Since it is difficult for humans to imagine an embedding mapped onto N-dimensional sphere and thus understanding how this loss is working, I made the following render to build intuition of how this thing works for N=3(our much familiar 3D).", "This illustration describes our model output after training. Similar images marked as green points are mapped closed to one another and dissimilar images marked as red mapping are far apart with the least distance of the size of margin show as yellow. In an ideal case after training, no point should be mapped in the yellow region of the anchor image. Nevertheless, points often tend to have an overlapping region, since there is much-limited space on the surface. More on this is discussed later.", "Our model uses a margin size of 0.2 as used in the paper.", "This similarity/dissimilarity is defined by the distance between two vectors using L2 distance and cosine distance.", "So our loss is defined as follows \u2014", "The tricky part of implementing this network was defining loss function. We make input data by sampling triplets of desired batch size, and define the network and our loss function, and TRAIN!!! Complete implementation can be found here.", "After training the network with different hyper-parameters and loss function, and testing network accuracy on n-way one-shot classification(i.e. \u201cn\u201d number of single images each of different class that network has never seen before). It can be observed \u2014", "A follow-up article can be read that uses contrastive loss to make a Siamese network learn similarities only, using two different images of a character. No doubt, it does perform poorly and tends to over-fit on training, whereas triplet loss does not over-fit at all. Accuracy of contrastive loss based Siamese network falls drastically with increasing nway one-shot classification.", "This network is used to compare fingerprint, detect signature forgery, face recognition. This can be applied anywhere where similarities and dissimilarity score is helpful.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Deep Learning enthusiast, Thinker, Designer, Developer loving aesthetics"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3939da1b0c9d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@pranjalg2308?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pranjalg2308?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": "Pranjal Gupta"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf62521c487b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&user=Pranjal+Gupta&userId=df62521c487b&source=post_page-df62521c487b----3939da1b0c9d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3939da1b0c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3939da1b0c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@stocktrader?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Marco Zuppone"}, {"url": "https://unsplash.com/s/photos/signature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://jalammar.github.io/illustrated-word2vec/", "anchor_text": "article"}, {"url": "https://twitter.com/JayAlammar", "anchor_text": "Jay Alammar"}, {"url": "https://github.com/brendenlake/omniglot", "anchor_text": "Omniglot data set"}, {"url": "https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf", "anchor_text": "this paper"}, {"url": "https://stats.stackexchange.com/a/331967/283107", "anchor_text": "L2 normalization"}, {"url": "https://youtu.be/d2XB5-tuCWU?t=138", "anchor_text": "trivial solution"}, {"url": "https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf", "anchor_text": "paper"}, {"url": "https://github.com/pranjalg2308/siamese_triplet_loss", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/one-shot-learning-with-siamese-networks-using-keras-17f34e75bb3d", "anchor_text": "article"}, {"url": "https://www.alliance.edu.in/aicaam-conference-proceedings/Papers/Siamese-Triple-Ranking-Convolution-Network.pdf", "anchor_text": "detect signature forgery"}, {"url": "https://www.cs.toronto.edu/~ranzato/publications/taigman_cvpr14.pdf", "anchor_text": "face recognition"}, {"url": "https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf", "anchor_text": "https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf"}, {"url": "https://en.wikipedia.org/wiki/Siamese_neural_network", "anchor_text": "https://en.wikipedia.org/wiki/Siamese_neural_network"}, {"url": "https://jalammar.github.io/illustrated-word2vec/", "anchor_text": "https://jalammar.github.io/illustrated-word2vec/"}, {"url": "https://towardsdatascience.com/one-shot-learning-with-siamese-networks-using-keras-17f34e75bb3d", "anchor_text": "https://towardsdatascience.com/one-shot-learning-with-siamese-networks-using-keras-17f34e75bb3d"}, {"url": "https://neptune.ai/blog/content-based-image-retrieval-with-siamese-networks", "anchor_text": "https://neptune.ai/blog/content-based-image-retrieval-with-siamese-networks"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3939da1b0c9d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3939da1b0c9d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----3939da1b0c9d---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----3939da1b0c9d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----3939da1b0c9d---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3939da1b0c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&user=Pranjal+Gupta&userId=df62521c487b&source=-----3939da1b0c9d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3939da1b0c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&user=Pranjal+Gupta&userId=df62521c487b&source=-----3939da1b0c9d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3939da1b0c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3939da1b0c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3939da1b0c9d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3939da1b0c9d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pranjalg2308?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pranjalg2308?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pranjal Gupta"}, {"url": "https://medium.com/@pranjalg2308/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf62521c487b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&user=Pranjal+Gupta&userId=df62521c487b&source=post_page-df62521c487b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fdf62521c487b%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fillustrated-guide-to-siamese-network-3939da1b0c9d&user=Pranjal+Gupta&userId=df62521c487b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}