{"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b", "time": 1683016924.497548, "path": "towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b/", "webpage": {"metadata": {"title": "Understanding Full-Stack Data Science: How the NLP model in your Jupyter Notebooks Could Actually Help Stop Disasters, Part 2 | by Bowen Chen | Towards Data Science", "h1": "Understanding Full-Stack Data Science: How the NLP model in your Jupyter Notebooks Could Actually Help Stop Disasters, Part 2", "description": "The excitement has begun. I hope you enjoyed part 1 of the series on how to turn your NLP model in jupyter notebooks into production-ready models, where we have successfully automated a series of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1", "paragraph_index": 6}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1", "paragraph_index": 21}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1", "paragraph_index": 32}, {"url": "https://disaster-response-app184.herokuapp.com/", "anchor_text": "this URL", "paragraph_index": 37}, {"url": "https://medium.com/u/97dedb58f477?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Soledad Galli, PhD", "paragraph_index": 38}, {"url": "https://medium.com/u/7a06fa9e4774?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Christopher Samiullah", "paragraph_index": 38}, {"url": "https://www.udemy.com/course/deployment-of-machine-learning-models/", "anchor_text": "deploying machine learning models", "paragraph_index": 38}, {"url": "http://Archera.ai", "anchor_text": "Archera.ai", "paragraph_index": 40}], "all_paragraphs": ["The excitement has begun. I hope you enjoyed part 1 of the series on how to turn your NLP model in jupyter notebooks into production-ready models, where we have successfully automated a series of steps including data acquisition, data processing, model training, model evaluation, and model packaging. That\u2019s all fantastic progress \u2014 except we are still far from putting the model in use and actually drive some value. In part 2, we will continue the process of further automating our model development process that will involve building a functional backend and frontend in a docker container, which will be hosted on the platform-as-a-service provider Heroku. At the end of the day, the whole end-to-end project will be fully automated and continuously integrated \u2014 any version bumps will simply require merging in a pull request.", "In part 1, we have already successfully built a packaged model that is hosted on the PyPI server, and all of the files are in the disaster_messaging_classification_model directory. Remember we had a project structure like the following,", "We have already looked at the .circleci, disaster_messaging_classification_model, and notebooks directories, now we will start building out the frontend and backend of the disaster response flask app with a docker file, which will be hosted in the disaster_messaging_app directory. We will have a look at the content of this folder in the following section.", "Just as the disaster_messaging_classification_model, we will have another dependency definition file pyproject.toml in the disaster_messaging_app directory. In addition, we will have the following directories.", "With the disaster_messaging_app directory sorted out, we are now ready to start building out our flask app. In the next section, we will start by building out the appropriate environment.", "Remember we have packaged our machine learning model into a package that\u2019s hosted in the PyPI server? Now it\u2019s time to it put to use. Building a model package as we did in part 1 allows us to install our model as a package dependency when we are trying to productionize the model (just as pandas, numpy, and more). We will again use poetry as the dependency management tool that ensures the versions of all dependencies are locked in place. We will create a new virtual environment completely separate from the environment we built when we were creating the model. This environment will be dedicated to creating our app. We will define the following pyproject.toml in the disaster_messaging_app folder.", "Notice that we are installingdisaster-message-classification-model as a dependency here. This installation will enable us to use all the modules of our machine learning model defined in part 1. With the environment properly defined, we are now ready to define the main backbones for our web app using flask.", "To make use of the model\u2019s predictive power, we will need to create an interface that allows the downstream user to interact. Common practices involve either constructing an API or create a presentable web application. Fortunately, either of the goals could be accomplished by using the powerful, lightweight framework flask. More resources about flask could be found here. In our case, we will attempt to create a fully functional web app which will be hosted on Heroku.", "Web applications on flask follow the app-controller framework, which involves the creation of an app module that registers and runs the app, and a controller module that controls the routing and internal functionalities of the app. We will have those two modules in the app.py and controller.py files respectively. We will also create a config file that handles the miscellaneous tasks such as creating the logger and sets the routing ports.", "The app.py module is really simple, as it only creates the flask object and calls the controller defined in controller.py, which is shown in the following.", "The controller.py module defines the routing and internal functionalities of the app. In general, it involves the following 2 steps,", "For example, suppose we have already defined the blueprint as the following", "if we want to route to the /index URL, we could define the decorator as the following", "For our controller, we will define the following 5 routes", "The main page when the app is first fired up. On the front page, we will show the word cloud of all the frequently mentioned words in our message dataset. The module that generates the Plotly visuals are defined in part 1. The function that defines this route is shown below.", "Once the page is loaded up, we will see the app\u2019s front page that looks like the following.", "This route serves as a quick check for the health status of the web application. The method on our routing API will be the GET method.", "This route serves as a quick check for the version of the web application. The method on our routing API will be the GET method.", "The API definition route without a frontend. By calling this route, the prediction of the input texts will be returned a JSON formated response (very similar to python dicts). Using the POST method, we will able to obtain the input texts from the response object. Then we can generate predictions from the make_prediction method from our machine learning model package (installed in the current environment). Finally, we can assemble the payload into a dictionary and return our desired JSON response.", "The frontend definition route. By calling this route we will create a nice looking frontend that highlights the class if our model predicts it to be 1. Same as the API route, we can obtain the input texts from the response object. Then we can generate predictions from the make_prediction method from our machine learning model package. Then we can return a rendered template go.html and uses the prediction result to produce a nice webpage like the following. The input message is \u201cHelp fire is near my house\u201d.", "The specific route definition is shown below", "Fantastic! We have now built the backbone of our disaster messaging app, we can simply call sh run.sh in the terminal and see our app fire up at https://0.0.0.0:5000 . As we have done previously in part 1, we will attempt to build some workflow automation for building this app using a Makefile.", "In addition to automating the installation of dependency packages and tests in the Makefile (as detailed in part 1), we will also do the following,", "The Makefile will look like the following.", "You might be wondering what exactly is a docker image? We will have a look in the next section.", "If you look at the formal definition of the docker from the official website, it states the following,", "\u201cA container is a standard unit of software that packages up code and all its dependencies so the application runs quickly and reliably from one computing environment to another.\u201d", "Docker is a lightweight implementation of a container, which will our flask app to run as a standalone software \u2014 and our model will be installed as one of the dependencies.", "Docker containers are defined using dockerfiles, which similar to Makefiles \u2014 defines a series of steps to build and run the app. Then we can simply just call the command docker build to run the self-contained software in Docker. In our project, the series of command is the following,", "The complete dockerfile is shown below", "Note: the run.sh script looks like the following,", "Once the docker definitions are defined, we are ready to build the docker image with the command docker build . to build locally. Since we would like to build the Docker container on Heroku, we will use the docker build -t registry.heroku.com/$(NAME)/web . command instead, just as it is stated in the Makefile from the last section.", "Remember in part 1 we have used CircleCI to automate the model training and packaging processes. Here we will attempt to automate the web app building and containerization process using CircleCI again. In addition to the content that exists on the config.yaml , we will add the following 2 more jobs,", "With the above 2 tasks added, CircleCI will continue the execution of building the app sequentially once the model is trained and pushed. The complete config.yaml file now looks like the following.", "To make Heroku function properly, we will add 3 more environment variables to CircleCI.", "Note: The heroku API key can be obtained from account settings section (shown in the screenshot below)", "As title suggests once again. We can now see the full workflow in action by a simple commit and push. The workflows test_and_publish_model, test_and_build_app and build_and_push_to_heroku_docker will run sequentially. If everything is done correctly, we will see the workflow successfully completed like the screenshot shown below.", "Great, now we can directly go to this URL and see this app work in action.", "Great, that officially concludes our two-part series on how to make a full-stack data science project. We have successfully completed the entire workflow from obtaining the data from Kaggle to deploying the trained model to Heroku as a fully functional web application. Thank you for staying this far \u2014 I hope you learned as much as I do from this experience. In the end, I highly recommend the Udemy course by Soledad Galli, PhD and Christopher Samiullah on deploying machine learning models . I have gotten much of my inspirations from that course, and I believe you will learn a lot from them. Thank you again, and see you next time!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer@ Archera.ai, Basketball Player Training How to Dunk, Life-long Knicks Fan, Living the Dream"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F460f17baf30b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----460f17baf30b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bowenchen.medium.com/?source=post_page-----460f17baf30b--------------------------------", "anchor_text": ""}, {"url": "https://bowenchen.medium.com/?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Bowen Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe4eab6908bf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&user=Bowen+Chen&userId=e4eab6908bf4&source=post_page-e4eab6908bf4----460f17baf30b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F460f17baf30b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F460f17baf30b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chrumo?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Piotr Chrobot"}, {"url": "https://unsplash.com/collections/4822345/emergency-response?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1"}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1"}, {"url": "https://python-poetry.org/", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1"}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1"}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1"}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1"}, {"url": "https://towardsdatascience.com/understanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-d813adf62321", "anchor_text": "part 1"}, {"url": "https://disaster-response-app184.herokuapp.com/", "anchor_text": "this URL"}, {"url": "https://medium.com/u/97dedb58f477?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Soledad Galli, PhD"}, {"url": "https://medium.com/u/7a06fa9e4774?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Christopher Samiullah"}, {"url": "https://www.udemy.com/course/deployment-of-machine-learning-models/", "anchor_text": "deploying machine learning models"}, {"url": "https://medium.com/tag/nlp?source=post_page-----460f17baf30b---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/full-stack?source=post_page-----460f17baf30b---------------full_stack-----------------", "anchor_text": "Full Stack"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----460f17baf30b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/continuous-integration?source=post_page-----460f17baf30b---------------continuous_integration-----------------", "anchor_text": "Continuous Integration"}, {"url": "https://medium.com/tag/web-development?source=post_page-----460f17baf30b---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F460f17baf30b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&user=Bowen+Chen&userId=e4eab6908bf4&source=-----460f17baf30b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F460f17baf30b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&user=Bowen+Chen&userId=e4eab6908bf4&source=-----460f17baf30b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F460f17baf30b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F460f17baf30b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----460f17baf30b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----460f17baf30b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----460f17baf30b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----460f17baf30b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----460f17baf30b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----460f17baf30b--------------------------------", "anchor_text": ""}, {"url": "https://bowenchen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bowenchen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bowen Chen"}, {"url": "https://bowenchen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "http://Archera.ai", "anchor_text": "Archera.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe4eab6908bf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&user=Bowen+Chen&userId=e4eab6908bf4&source=post_page-e4eab6908bf4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7b1d5930fa0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-full-stack-data-science-how-the-nlp-model-in-your-jupyter-notebooks-could-actually-460f17baf30b&newsletterV3=e4eab6908bf4&newsletterV3Id=7b1d5930fa0e&user=Bowen+Chen&userId=e4eab6908bf4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}