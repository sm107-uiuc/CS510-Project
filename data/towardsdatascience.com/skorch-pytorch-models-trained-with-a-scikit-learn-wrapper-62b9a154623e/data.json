{"url": "https://towardsdatascience.com/skorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e", "time": 1683016248.2443771, "path": "towardsdatascience.com/skorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e/", "webpage": {"metadata": {"title": "SKORCH: PyTorch Models Trained with a Scikit-Learn Wrapper | by Fernando L\u00f3pez | Towards Data Science", "h1": "SKORCH: PyTorch Models Trained with a Scikit-Learn Wrapper", "description": "Have you ever wondered if there is a tool to train and evaluate a PyTorch model in a simple and easy way? Well, that tool exists and it is SKORCH, a scikit-learn wrapper for training PyTorch models\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/wine", "anchor_text": "wines dataset", "paragraph_index": 8}, {"url": "https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper", "anchor_text": "https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper", "paragraph_index": 9}, {"url": "https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper", "anchor_text": "https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper", "paragraph_index": 27}], "all_paragraphs": ["Have you ever wondered if there is a tool to train and evaluate a PyTorch model in a simple and easy way? Well, that tool exists and it is SKORCH, a scikit-learn wrapper for training PyTorch models.", "In this blog, we are going to talk about what SKORCH is, its components and how easy it is to wrap a PyTorch model to train and evaluate it. The blog will be divided into the following sections:", "SKORCH is the union of scikit-learn and PyTorch, in other words, SKORCH is a wrapper for training, tuning and optimizing PyTorch models. SKORCH is an open-source library launched in 2017 [1], SKORCH arises to combine and enhance the great virtues of the PyTorch and SciKit-learn frameworks together.", "PyTorch is one of the most used frameworks for the development of neural network models, however, some phases take development time and sometimes it becomes a somewhat impractical part. SKORCH tries to simplify and streamline various processes in the training phase of a PyTorch model. It is common for the training module of a PyTorch model to be developed in one or more functions, however, when it is necessary to evaluate the model or optimize to find the optimal parameters, additional functions need to be developed. All this process is simplified by SKORCH, since it is a wrap based on scikit-learn, hence extends the functions that already carry out these processes.", "SKORCH professes the philosophy [2] : \u201cBe a scikit-learn API, hackable, do not hide PyTorch, do not reinvent the wheel\u201d", "In figure 2 we can see the capabilities of PyTorch and scikit-learn that compound SKORCH. As we can see, from the PyTorch side, the capabilities to prototype a model and handle datasets are used. On the other hand, we observe that scikit-learn already known functions are extended to be able to train, evaluate, tune and optimize machine learning models, this combination makes SKORCH a powerful tool.", "On the other hand, we can see SKORCH as the \u201cequivalent\u201d to the Keras API, which extends from Tensorflow to accelerate, simplify and speed up the prototyping of neural network models. In this case, SKORCH would serve as the prototype tool for the training, tuning and optimization phase of PyTorch models.", "Great, so far we already know what SKORCH is, what are its components and the advantages of using it, it is time to see an example to better understand how it works, let\u2019s go for it!", "In order to know how SKORCH works when training a PyTorch model, we are going to create a neural network to predict the well-known wines dataset. So, first we are going to create a simple model for the classification of wines with respect to the aforementioned dataset, then we have:", "If you want to access the full implementation, take a look at: https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper", "As we can see, some values are fixed. For practical terms, I would like to highlight only lines 9 and 12. In line 9 we define 13 input features, this because the wine dataset contains 13 features. On the other hand, in line 12 we define an output of size 3, this because the classes that we are going to classify are 3 (that is, 3 types of wines).", "Perfect, the PyTorch model is ready, it\u2019s time to see how we train this model with SKORCH, let\u2019s go to the next section!", "Training through SKORCH can be as simple or as elaborate as we need, for practical examples we will go gradually. So, a basic and simple way to train the model defined in the previous section would be as simple as the following lines of code:", "We will analyze line by line. In line 2 we are importing the PyTorch model (which was defined in the previous section). In line 4 we are importing the class that will serve as a wrapper for our PyTorch model. This class receives a series of important parameters (line 7) which are: the PyTorch model, the number of epochs, learning rate, batch size and optimizer. Obviously, they are not the only parameters we can define in this class, however for practicality, we will only show those already mentioned in this example. Finally, on line 9 we execute the \u201cfit\u201d method, which will be in charge of performing the entire training phase.", "You may be wondering, \u201cwhat about the split into train and validation?\u201d, well the NeuralNetClassifier class takes care of this as well. By default, this class implements StratifiedKFold split in the data with a ratio of 80% for training and 20% for validation. Well, once the above mentioned, this would be the output:", "The structure of the output is as shown in the previous snippet. As we can see, by default it shows us information regarding loss in training and validation sets, as well as accuracy in validation and execution time. Since we have not tuned the model, the results are extremely poor, however, we will fix this in the next examples.", "In the previous point, we saw how to train the model with SKORCH in a basic way. However, data processing is a very important phase which is always carried out prior to the training phase. In this case, we are going to carry out a very simple preprocessing, we are only going to scale the data and then we will carry out the training, for this, we are going to make use of the scikit-learn Pipeline module, so we would have the following:", "In lines 5 and 6 we import the Pipeline and StandardScaler modules from scikit-learn. In line 12 we can see that we initialize the wrapper exactly the same as in the previous point (with fixed values), the interesting thing comes in lines 14 and 15 where the Pipeline is initialized, which contains the StandarScaler() module as well as the wrap of the PyTorch model. Running this we get:", "It is important to highlight that the results improved notably, this due to the scaling of the data prior to the training phase.", "So far we have seen how to train a PyTorch model (with fixed parameters) within an execution Pipeline as a scikit-learn module, however, how we could add other evaluation metrics such as accuracy or balanced accuracy to the SKORCH module, well this is where we make use of of the callbacks.", "Callbacks are an extension of SKORCH that allows us to add other functions to the NeuralNetClassifier wrapper, for example, if we want the optimization metric to be balanced_accuracy or ROC or any another classification metric, this can be done through callbacks. So, introducing a callback to calculate the accuracy and balanced accuracy of the model within the pipeline would be as follows:", "So, as we can see in line 9 we import the EpochScoring callback. To make use of the callback, we only have to initialize it by passing the name of the metric we want to use as arguments, in this case, we initialize \u201cbalanced_accuracy\u201d and \u201caccuracy\u201d for the metrics. Also, we have to set the parameter \u201clower_is_better\u201d as \u201cFalse\u201d because our problem seeks the maximization of the metrics, not the minimization.", "So the result of executing the previous snippet would something like:", "Finally what remains to be seen is how to perform a Grid Search using the scikit-learn modules, let\u2019s go for it!", "To perform a Grid Search we only need to import the scikit-learn module. Performing the Grid Search is exactly the same as with the classic models of machine learning from scikit-learn, the only different point is in the definition of the parameters for the grid.", "As we can see, the parameters have a particular aspect. We are adding the prefix \u201cnn__\u201d and \u201cnn__module__\u201d. These prefixes will help the wrapper to know if the parameter belongs to the definition of the PyTorch model or to the training phase. As we can see, we only use the prefix \u201cnn__\u201d when we refer to parameters of the training phase and \u201cnn__module__\u201d when we refer to parameters of the PyTorch model. It is important that the name \u201cnn\u201d refers to the instantiation of the wrapper (line 19).", "So if we want to know what the best parameters were, we can do it easily:", "If you want to access the full implementation, take a look at: https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper", "In this blog we have seen what SKORCH is and what its components are. We have also seen how to implement the NeuralNetClassifier wrapper to train a PyTorch model in a very simple way.", "In my opinion, SKORCH is here to stay. Sometimes it is required to quickly and flexibly prototype PyTorch models, SKORCH does this wonderfully.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer | Data Scientist | Software Engineer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F62b9a154623e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----62b9a154623e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62b9a154623e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ferneutron.medium.com/?source=post_page-----62b9a154623e--------------------------------", "anchor_text": ""}, {"url": "https://ferneutron.medium.com/?source=post_page-----62b9a154623e--------------------------------", "anchor_text": "Fernando L\u00f3pez"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd606f5d846f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&user=Fernando+L%C3%B3pez&userId=d606f5d846f2&source=post_page-d606f5d846f2----62b9a154623e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62b9a154623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62b9a154623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chezzus38?utm_source=medium&utm_medium=referral", "anchor_text": "Kenneth Berrios Alvarez"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/wine", "anchor_text": "wines dataset"}, {"url": "https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper", "anchor_text": "https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper"}, {"url": "https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper", "anchor_text": "https://github.com/FernandoLpz/SKORCH-PyTorch-Wrapper"}, {"url": "https://skorch.readthedocs.io/en/latest/index.html", "anchor_text": "https://skorch.readthedocs.io/en/latest/index.html"}, {"url": "https://www.youtube.com/watch?v=Qbu_DCBjVEk", "anchor_text": "https://www.youtube.com/watch?v=Qbu_DCBjVEk"}, {"url": "https://medium.com/tag/skorch?source=post_page-----62b9a154623e---------------skorch-----------------", "anchor_text": "Skorch"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----62b9a154623e---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/wrapper?source=post_page-----62b9a154623e---------------wrapper-----------------", "anchor_text": "Wrapper"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----62b9a154623e---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----62b9a154623e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62b9a154623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&user=Fernando+L%C3%B3pez&userId=d606f5d846f2&source=-----62b9a154623e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62b9a154623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&user=Fernando+L%C3%B3pez&userId=d606f5d846f2&source=-----62b9a154623e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62b9a154623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62b9a154623e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F62b9a154623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----62b9a154623e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----62b9a154623e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----62b9a154623e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----62b9a154623e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----62b9a154623e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----62b9a154623e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----62b9a154623e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----62b9a154623e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----62b9a154623e--------------------------------", "anchor_text": ""}, {"url": "https://ferneutron.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ferneutron.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Fernando L\u00f3pez"}, {"url": "https://ferneutron.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "537 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd606f5d846f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&user=Fernando+L%C3%B3pez&userId=d606f5d846f2&source=post_page-d606f5d846f2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F14c367392dfa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fskorch-pytorch-models-trained-with-a-scikit-learn-wrapper-62b9a154623e&newsletterV3=d606f5d846f2&newsletterV3Id=14c367392dfa&user=Fernando+L%C3%B3pez&userId=d606f5d846f2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}