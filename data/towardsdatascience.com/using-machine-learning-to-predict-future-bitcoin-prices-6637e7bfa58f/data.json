{"url": "https://towardsdatascience.com/using-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f", "time": 1683009397.0947368, "path": "towardsdatascience.com/using-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f/", "webpage": {"metadata": {"title": "Using machine learning to predict future bitcoin prices | by Derk Zomer | Towards Data Science", "h1": "Using machine learning to predict future bitcoin prices", "description": "How to use the LSTM RNN machine learning model to predict the Bitcoin price 20 minutes from now, relying solely on simple historical financial data."}, "outgoing_paragraph_urls": [{"url": "https://www.bioinf.jku.at/publications/older/2604.pdf", "anchor_text": "Long Short-Term Memory", "paragraph_index": 1}, {"url": "http://test.derkzomer.com/fama1970.pdf", "anchor_text": "Fama\u2019esque", "paragraph_index": 3}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "this", "paragraph_index": 6}, {"url": "https://numpy.org/install/", "anchor_text": "Numpy", "paragraph_index": 7}, {"url": "https://pandas.pydata.org/getting_started.html", "anchor_text": "Pandas", "paragraph_index": 7}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 7}, {"url": "https://www.tensorflow.org/", "anchor_text": "Tensorflow", "paragraph_index": 7}, {"url": "https://jupyter.org/install.html", "anchor_text": "Jupyter Notebooks", "paragraph_index": 7}, {"url": "https://www.kraken.com/features/api", "anchor_text": "Kraken API", "paragraph_index": 9}, {"url": "https://github.com/derkzomer/predicting-future-bitcoin-prices", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://machinelearningmastery.com/tune-lstm-hyperparameters-keras-time-series-forecasting/", "anchor_text": "great resources", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 33}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 33}, {"url": "http://Shotstack.io", "anchor_text": "Shotstack.io", "paragraph_index": 35}], "all_paragraphs": ["Is it possible to predict tomorrow\u2019s Bitcoin price? Or if that\u2019s too far a leap, what about the price 20 minutes from now?", "I\u2019ll be using the Long Short-Term Memory (LSTM) RNN machine learning model to predict the Bitcoin price 20 minutes from now, relying solely on simple historical financial data.", "I\u2019ve written this article partly as a guide, and partly as an exercise exploring the potential use of the LSTM model for the purpose of Bitcoin price prediction. Hence I may skip over some of the fundamentals, as these are easily found elsewhere.", "A disclaimer that my experience comes primarily from curiosity, practical applications at a personal and professional capacity, and a Fama\u2019esque intrigue into efficient markets. This may mean some of the terminology and methodology used could differ from others.", "What is the LSTM model exactly? In short, it\u2019s a form of recurrent neural network capable of learning long-term dependencies. In a similar fashion that we use prior experience to inform (preferably better) future outcomes, LSTM models use update gates and forget gates to randomly remember and forget pieces of historical information to inform their prediction.", "The ability to use historical \u201ccontext\u201d like this allows these models to be particularly suited for prediction purposes, among a host of other applications.", "To build a deeper understanding please take a look at this great resource which delves deeper into the exact machinations of this type of neural network.", "For this exercise, I\u2019m using Numpy and Pandas to deal with the data and Keras/Tensorflow for the machine learning functions. For debugging and its ability to present code nicely I use Jupyter Notebooks.", "To train our model we need training data. Any financial pricing data would suffice here as long as it\u2019s available in minute intervals and is of a reasonable size. I\u2019m using financial data spanning ~23 days with one-minute intervals.", "I collected this data myself using the Kraken API, so it\u2019s likely it contains gaps. But it\u2019ll do for illustration purposes. You can find my data and the complete source code here.", "First, we start by importing all of the required packages, loading the dataset and removing the rows we are not interested in using.", "We split the dataset up into a training and test set, and standardise its features. Standardisation is good practice as it reduces overfitting in cases where variance for some features may be higher than others.", "The LSTM model requires us to organise the data in blocks. Our data is grouped at one-minute intervals and we\u2019ll use blocks of 50 minutes to predict the next block.", "Now it\u2019s time to train our model. We choose what type of model we want to use; sequential in this case, and we decide our hyper-parameters.", "The model I\u2019m using is relatively straightforward, containing 5 hidden layers with 50 neurons each, and a dropout in between every one of those hidden layers. We use the mean-squared-error loss function, the Adam optimiser, set the batch size at 32, and go through this network for 10 epochs.", "Deciding on hyper-parameters is more art than science, and it\u2019s worth testing out multiple options to understand what works best on your test data and in production. Optimising your hyper-parameters is outside of the scope of this article but some great resources exist online.", "Now that we have a model that we can use to build predictions we can take a look at how it performs against our test data. The graph below plots the test data (y_test) prediction (y_hat) of both the ask price and bid price. As we can see the predictive values match the training data quite well.", "Cool! So this means I can predict Bitcoin prices now?", "The predictive power of these models is definitely impressive, but if you take a closer look at the prediction you\u2019ll see it quite narrowly follows the test data. The prediction appears to closely follow changes in price, but doesn\u2019t often correctly forecast the price\u00a0at\u00a0the\u00a0point\u00a0at\u00a0which\u00a0these\u00a0movements\u00a0occur. This isn\u2019t incredibly useful for any trading strategy you may want to use this for.", "If we wanted to forecast the price 20 minutes from now one option would be to run the model over an immediately recent interval of historical data, concatenating the prediction to the end of our array of historical data, and then feeding that array back into the model \u2014 continuing this until we have 20 forecasted blocks of price predictions.", "The below code does exactly that, and plots both the bid and ask price against the test data. Unsurprisingly it doesn\u2019t really tell you much, with this particular prediction incorrectly forecasting a price increase.", "But will this be the case for the remainder of the test data? As the test data consists out of 6,661 rows we have 133 windows over which we can predict a trade.", "Let us forecast the remaining 20 minute blocks, and sum the cumulative difference of the ask_price at n=4 and n=0.", "The below plot shows you the cumulative gain of predicted profitable trades and actual trades, where one bought at the ask price of n=0 and sold at the ask price of n=4.", "Interestingly it appears that the trades that provide you with an actual net benefit outweigh the ones that would have led to a loss. With a principal of $100 you\u2019d come out ahead ~$31. Over just 4.5 days. That\u2019s an astronomical return!", "Likely too good to be true.", "Anyone that has ever bought BTC or any financial instrument on an exchange would now tell me you can\u2019t actually sell at market at the ask price. The bid/ask spread would stop us from taking advantage of any increase in price, and only if the appreciation of the asset was higher than the spread would we be able to profit from this trade.", "Once we model this into our prediction our golden goose starts to lose a few feathers. Our same $100 would still appreciate by ~$3.40! Still an impressive 1,318% annual return.", "Now let\u2019s add in transaction costs. We\u2019ll take the liberal assumption that we can trade at market for the low fee of just 0.1% \u2014 reserved for traders trading at extremely large volumes.", "It quickly becomes apparent our golden goose is not gold at all. Our model is only able to identify 3 potential profitable trades, of our same $100 would now turn a $2.26 loss.", "The exercise above shows that simple financial data has some predictive power in forecasting short-term changes in price, but as there are no practical opportunities to profit from this information this particular model is relatively useless from a trading perspective.", "Tools such as the LSTM model and others are becoming more accessible every day, with large groups and institutions pushing the boundaries of what these models can do through better data and superior processing capacity. This leads to markets integrating ever increasing amounts of information into asset prices \u2014 making arbitrage opportunities rare.", "It isn\u2019t a straightforward exercise to build a model with the predictive power to beat the market, and if one was able to easily use these tools to make a buck I certainly wouldn\u2019t be sharing it with you here.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-founder at Shotstack.io. Previously Marketplace @ Uber. Twitter: @derk_zomer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6637e7bfa58f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://derk-zomer.medium.com/?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": ""}, {"url": "https://derk-zomer.medium.com/?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": "Derk Zomer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F33095eaedc3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&user=Derk+Zomer&userId=33095eaedc3d&source=post_page-33095eaedc3d----6637e7bfa58f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6637e7bfa58f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6637e7bfa58f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chrisliverani?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Chris Liverani"}, {"url": "https://towardsdatascience.com/s/photos/data?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.bioinf.jku.at/publications/older/2604.pdf", "anchor_text": "Long Short-Term Memory"}, {"url": "http://test.derkzomer.com/fama1970.pdf", "anchor_text": "Fama\u2019esque"}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "this"}, {"url": "https://numpy.org/install/", "anchor_text": "Numpy"}, {"url": "https://pandas.pydata.org/getting_started.html", "anchor_text": "Pandas"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://www.tensorflow.org/", "anchor_text": "Tensorflow"}, {"url": "https://jupyter.org/install.html", "anchor_text": "Jupyter Notebooks"}, {"url": "https://www.kraken.com/features/api", "anchor_text": "Kraken API"}, {"url": "https://github.com/derkzomer/predicting-future-bitcoin-prices", "anchor_text": "here"}, {"url": "https://machinelearningmastery.com/tune-lstm-hyperparameters-keras-time-series-forecasting/", "anchor_text": "great resources"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----6637e7bfa58f---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/bitcoin?source=post_page-----6637e7bfa58f---------------bitcoin-----------------", "anchor_text": "Bitcoin"}, {"url": "https://medium.com/tag/trading-bot?source=post_page-----6637e7bfa58f---------------trading_bot-----------------", "anchor_text": "Trading Bot"}, {"url": "https://medium.com/tag/algorithmic-trading?source=post_page-----6637e7bfa58f---------------algorithmic_trading-----------------", "anchor_text": "Algorithmic Trading"}, {"url": "https://medium.com/tag/machine-learning-ai?source=post_page-----6637e7bfa58f---------------machine_learning_ai-----------------", "anchor_text": "Machine Learning Ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6637e7bfa58f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&user=Derk+Zomer&userId=33095eaedc3d&source=-----6637e7bfa58f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6637e7bfa58f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&user=Derk+Zomer&userId=33095eaedc3d&source=-----6637e7bfa58f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6637e7bfa58f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6637e7bfa58f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6637e7bfa58f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6637e7bfa58f--------------------------------", "anchor_text": ""}, {"url": "https://derk-zomer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://derk-zomer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Derk Zomer"}, {"url": "https://derk-zomer.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "63 Followers"}, {"url": "http://Shotstack.io", "anchor_text": "Shotstack.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F33095eaedc3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&user=Derk+Zomer&userId=33095eaedc3d&source=post_page-33095eaedc3d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffccc7edf4394&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f&newsletterV3=33095eaedc3d&newsletterV3Id=fccc7edf4394&user=Derk+Zomer&userId=33095eaedc3d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}