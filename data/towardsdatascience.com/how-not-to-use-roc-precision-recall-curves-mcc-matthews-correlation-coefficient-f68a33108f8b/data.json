{"url": "https://towardsdatascience.com/how-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b", "time": 1683010717.5174332, "path": "towardsdatascience.com/how-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b/", "webpage": {"metadata": {"title": "How NOT to use ROC, Precision-Recall curves & MCC (Matthews Correlation Coefficient) | by Himanshu Chandra | Towards Data Science", "h1": "How NOT to use ROC, Precision-Recall curves & MCC (Matthews Correlation Coefficient)", "description": "There are quite a few things about being a data scientist that I love. Developing a holistic sense of the business you are creating a solution for, is one of them. Having that real-world context to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/the-two-variations-of-confusion-matrix-get-confused-never-again-8d4fb00df308", "anchor_text": "confusion matrix", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/the-two-variations-of-confusion-matrix-get-confused-never-again-8d4fb00df308", "anchor_text": "The Two Variations of Confusion Matrix - Get Confused, Never Again", "paragraph_index": 6}, {"url": "https://www.youtube.com/watch?v=4jRBRDbJemM", "anchor_text": "video", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html", "anchor_text": "Precision-Recall", "paragraph_index": 10}, {"url": "https://lettier.github.io/posts/2016-08-05-matthews-correlation-coefficient.html", "anchor_text": "great blog", "paragraph_index": 17}, {"url": "http://iamjustastudent.com/about", "anchor_text": "I am Just a Student", "paragraph_index": 21}, {"url": "https://www.linkedin.com/in/himanshu-chandra-33512811/", "anchor_text": "LinkedIn", "paragraph_index": 21}, {"url": "https://www.youtube.com/channel/UChNybQwpqrX9SOc1D4K_x5Q", "anchor_text": "YouTube", "paragraph_index": 21}, {"url": "https://github.com/HCGrit/MachineLearning-iamJustAStudent", "anchor_text": "GitHub", "paragraph_index": 21}, {"url": "https://iamjustastudent.com/about", "anchor_text": "https://iamjustastudent.com/about", "paragraph_index": 24}], "all_paragraphs": ["There are quite a few things about being a data scientist that I love. Developing a holistic sense of the business you are creating a solution for, is one of them. Having that real-world context to the formulae we use makes it all the more fun. That\u2019s why when a junior colleague in my team showed me the comparison of various models via the Precision-Recall curve, and I enquired if it was the best metric for our case, his reaction was, \u201cI can display this via ROC curves; maybe that would be better?\u201d", "As every experienced data scientist will tell you, there\u2019s no one right or wrong. The business dictates the best approach. So, let me pose the same problem to you, and let\u2019s walk through what could be a good approach.", "All images are owned by the author unless otherwise stated.", "We are in the process of implementing an automatic quality control system for a manufacturing plant which produces gear parts. It\u2019s a computer vision problem. As an initial step, we have picked up one gear part and trying to classify it into \u2018good\u2019 or \u2018bad\u2019 based on factors like presence of scratches, rust, incorrect dimensions etc. The type of defect found is unimportant right now, just classifying it as good or bad is required.", "Also, the penalty for shipping a bad part to end customer is huge, so we should be very particular in rightly classifying the bad parts.", "Let\u2019s assume the actual and predicted (from our model) results give us the following confusion matrix, where we consider a good part as Positive and a bad part as Negative:", "If you want to brush up on the various metrics associated with the confusion matrix like Precision, Recall, Specificity or prefer the \u2018other\u2019 representation where predictions serve as columns, I would recommend reading The Two Variations of Confusion Matrix - Get Confused, Never Again for a greater sense of clarity.", "Of course, the above matrix is based on a particular probability threshold (0.5 in this case) and the ROC curve will be constructed by considering various thresholds, but you get a decent idea of the general class distribution.", "Which metric should you use? -", "First of all, let\u2019s eliminate ROC curve as it is not best suited for imbalanced class problems. Here\u2019s a great video to get one\u2019s foundation right for this.", "On to Precision-Recall curve now - this is what my colleague had chosen. It has Precision as y-axis and Recall as x-axis. If I use the above confusion matrix at various thresholds to plot this curve, do you see any problem in the approach?", "The Precision-Recall curve is supposed to draw our attention to the Positive class.", "The positive and negative class ought to be swapped if we want to concentrate on the \u2018bad\u2019 class. This is akin to a medical use-case where detection of cancer is equivalent to the test coming back \u2018Positive\u2019. If only few people/parts are going to have cancer/defects then we make it the positive class and then use the PR curve.", "Another non-traditional way to do this, if you do not want to swap class labels, is to map the curve with y-axis as TN/(TN+FN) and x-axis as Specificity or TN/(TN+FP). I could go into the maths to explain these new axes, but a very intuitive way to remember this is:", "Case 1 (Traditional PR curve): With TP as the \u2018pivot\u2019, pivot divided by row sum is the y-axis (Precision), while pivot divided by column sum is the x-axis (Recall).", "Case 2 (Non-traditional curve): Since you wish not to swap labels, we make TN as the pivot. Once again, exactly as above, pivot divided by row sum is the y-axis, while pivot divided by column sum is the x-axis (Specificity).", "This article would be incomplete without a mention of Matthews Correlation Coefficient or MCC.", "MCC is suitable for cases where you want to gauge performance of your model in predicting all the classes, with no particular focus on any specific one. Here\u2019s a great blog to read on the topic.", "Imagine this \u2014 pretty soon, our problem statement will expand and the client will ask that all the different defects be classified separately, instead of just \u2018good\u2019 or \u2018bad\u2019. So it could be \u2018scratches\u2019, \u2018wrong dimension\u2019, \u2018rusted\u2019, \u2018good\u2019 \u2014 so on and so forth.", "Once we shortlist a few models, it would be great to have a single metric to compare their overall performance over different classes. MCC just does that.", "Hope this gave you a glimpse into the different scenarios where different metrics are valuable. It\u2019s always a good idea to understand the mathematics behind them all, as only then one is able to tweak them as per one\u2019s particular needs \u2014 like we tweaked the PR curve into a non-traditional one.", "Interested in sharing ideas, asking questions or simply discussing thoughts? Connect with me through my website, I am Just a Student or on LinkedIn, YouTube or GitHub.", "See you around & happy learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech enthusiast. I love absorbing new concepts and sharing them with others in the simplest of ways. Reach out on: https://iamjustastudent.com/about"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff68a33108f8b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@himanshuhc?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshuhc?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": "Himanshu Chandra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88960b2eb891&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&user=Himanshu+Chandra&userId=88960b2eb891&source=post_page-88960b2eb891----f68a33108f8b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff68a33108f8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff68a33108f8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@spacex?utm_source=medium&utm_medium=referral", "anchor_text": "SpaceX"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/the-two-variations-of-confusion-matrix-get-confused-never-again-8d4fb00df308", "anchor_text": "confusion matrix"}, {"url": "https://towardsdatascience.com/the-two-variations-of-confusion-matrix-get-confused-never-again-8d4fb00df308", "anchor_text": "The Two Variations of Confusion Matrix - Get Confused, Never Again"}, {"url": "https://www.youtube.com/watch?v=4jRBRDbJemM", "anchor_text": "video"}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html", "anchor_text": "Precision-Recall"}, {"url": "https://lettier.github.io/posts/2016-08-05-matthews-correlation-coefficient.html", "anchor_text": "great blog"}, {"url": "http://iamjustastudent.com/about", "anchor_text": "I am Just a Student"}, {"url": "https://www.linkedin.com/in/himanshu-chandra-33512811/", "anchor_text": "LinkedIn"}, {"url": "https://www.youtube.com/channel/UChNybQwpqrX9SOc1D4K_x5Q", "anchor_text": "YouTube"}, {"url": "https://github.com/HCGrit/MachineLearning-iamJustAStudent", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/himanshu-chandra-33512811/", "anchor_text": "Himanshu Chandra - Business Head - AI, ML.www.linkedin.com"}, {"url": "https://medium.com/tag/roc?source=post_page-----f68a33108f8b---------------roc-----------------", "anchor_text": "Roc"}, {"url": "https://medium.com/tag/precision?source=post_page-----f68a33108f8b---------------precision-----------------", "anchor_text": "Precision"}, {"url": "https://medium.com/tag/recall?source=post_page-----f68a33108f8b---------------recall-----------------", "anchor_text": "Recall"}, {"url": "https://medium.com/tag/sensitivity?source=post_page-----f68a33108f8b---------------sensitivity-----------------", "anchor_text": "Sensitivity"}, {"url": "https://medium.com/tag/specificity?source=post_page-----f68a33108f8b---------------specificity-----------------", "anchor_text": "Specificity"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff68a33108f8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&user=Himanshu+Chandra&userId=88960b2eb891&source=-----f68a33108f8b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff68a33108f8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&user=Himanshu+Chandra&userId=88960b2eb891&source=-----f68a33108f8b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff68a33108f8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff68a33108f8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f68a33108f8b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f68a33108f8b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f68a33108f8b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f68a33108f8b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f68a33108f8b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshuhc?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshuhc?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Himanshu Chandra"}, {"url": "https://medium.com/@himanshuhc/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "99 Followers"}, {"url": "https://iamjustastudent.com/about", "anchor_text": "https://iamjustastudent.com/about"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88960b2eb891&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&user=Himanshu+Chandra&userId=88960b2eb891&source=post_page-88960b2eb891--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc3cc93643227&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b&newsletterV3=88960b2eb891&newsletterV3Id=c3cc93643227&user=Himanshu+Chandra&userId=88960b2eb891&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}