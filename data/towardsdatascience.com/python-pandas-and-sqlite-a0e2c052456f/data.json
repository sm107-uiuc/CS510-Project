{"url": "https://towardsdatascience.com/python-pandas-and-sqlite-a0e2c052456f", "time": 1683013955.998189, "path": "towardsdatascience.com/python-pandas-and-sqlite-a0e2c052456f/", "webpage": {"metadata": {"title": "Python Pandas and SQLite. Using SQLite to store your Pandas\u2026 | by Alan Jones | Towards Data Science", "h1": "Python Pandas and SQLite", "description": "The SQLite database is a built-in feature of Python and a very useful one, at that. It is not a complete implementation of SQL but it has all the features that you need for a personal database or\u2026"}, "outgoing_paragraph_urls": [{"url": "https://alan-jones.medium.com/subscribe", "anchor_text": "here", "paragraph_index": 39}, {"url": "https://alan-jones.medium.com/membership", "anchor_text": "here", "paragraph_index": 40}, {"url": "https://alanjones2.github.io/Alan-Jones-article-code/", "anchor_text": "Github page", "paragraph_index": 41}], "all_paragraphs": ["The SQLite database is a built-in feature of Python and a very useful one, at that. It is not a complete implementation of SQL but it has all the features that you need for a personal database or even a backend for a data-driven web site.", "Using it with Pandas is simple and really useful. You can permanently store your dataframes in a table and read them directly into a new dataframe as you need them.", "But it isn\u2019t just the storage aspect that is so useful. You can select and filter the data using simple SQL commands: this saves you having to process the dataframe itself.", "I\u2019m going to demonstrate a few simple techniques using SQLite and Pandas using my favourite London weather data set. It\u2019s derived from public domain data from the UK Met Office and you can download it from my Github account.", "All the code here was written in a Jupyter notebook but should run perfectly well as a standalone Python program, too.", "Let\u2019s start by importing the libraries:", "Obviously, we need the SQLite and Pandas libraries and we\u2019ll get matplotlib as well because we are going to plot some graphs.", "Now let\u2019s get the data. There\u2019s about 70 years worth of temperature, rainfall and sunshine data in a csv file. We download it like this:", "And this is what it looks like. The data is recorded for each month of the year. The temperatures are in degrees Celsius, the rainfall is in millimetres and \u2018Sun\u2019 is the total number of hours sunshine for the month.", "Now we are going to save the dataframe in an SQLite database.", "First we open a connection to a new database (this will create the database if it doesn\u2019t already exist) and then create a new table in that database called weather.", "We don\u2019t need to run this code ever again unless the original data changes and, indeed, we shouldn\u2019t, because SQLIte will not allow us to create a new table in the database if one of the same name already exists.", "Let\u2019s assume that we have run the code above once and we have our database, weather, with the table, also called weather, in it. We could now start a new notebook or Python program to do the rest of this tutorial or simply comment out the code to download and create the database.", "So, we have a database with our weather data in it and now and we want to read it into a dataframe. Here is how we load the database table into a dataframe.", "First, we make a connection to the database in the same way as before. Then we use the sql_read method from Pandas to read in the data. But to do this we have to send", "This is just about the simplest SQL query you can make. It means select all columns from the table called weather and return that data. Here\u2019s the code (the query is passed as a string).", "That, of course, is just reproducing the original dataframe, so let\u2019s use the power of SQL to load just a subset of the data.", "We\u2019ll get the data for a couple of years, 50 years apart, and compare them to see if there was any clear difference.", "Let\u2019s start by getting the data for the year 2010.", "We are going to create a new dataframe called y2010 using read_sql, as before, but with a slightly different query. We add a WHERE clause. This only selects the data where the condition following the keyword WHERE is true. So, in this case, we only get the rows of data where the value in the year column is \u20182010\u2019.", "You can see that the only data that has been returned is for the year 2010.", "Here\u2019s a line plot for Tmax.", "Now let\u2019s do that again but for 1960, 50 years earlier", "And now let\u2019s plot the Tmax for the two individual years.", "Interesting, 2010 was both hotter and colder than 1960 it seems. Is the weather getting more extreme? We need to do a bit more analysis to come to that conclusion.", "Maybe we could start by finding the hottest years, say the ones where the temperature was over 25 degrees.", "We do this by using a WHERE clause with a condition, Tmax > 25, that is, select the rows where Tmax was more than 25 degrees", "But also since we are only interested in the max temperature, we will only select the columns that we are interested in. We do this by modifying the SELECT clause in the SQL query.", "Instead of selecting * (i.e. all columns), we list the columns that we want returned: Year, Month and Tmax.", "That\u2019s in year order. Maybe it would be more interesting to have it in order of temperature.", "We can do that with SQL, too. We add the clause ORDER BY and give the column which should dictate the order. DESC means in descending order (omit that and you\u2019ll get the default, ascending order).", "So, topping the chart is 2018 with 2006 not far behind. But 1983 and 1995 are in third and fourth place so there is no obvious pattern here that shows that temperatures are getting hotter over time.", "One thing we can see is that the hottest months are in the summer! (Who\u2019d have thought it.) But to be sure let\u2019s plot a histogram.", "Yes, the hottest month tends to be July. So, if we are looking for a trend why don\u2019t we take a look at the months of July throughout the decades and see how the temperature changes.", "This gives us a table of temperature for all years but only where the month is equal to 6, i.e. July.", "Now we\u2019ll make a bar plot of the Tmax values over time.", "We could do a regression plot to see if there is any trend but frankly looking at this bar chart there is no obvious trend.", "So, with this extremely limited analysis of temperature data in London, we can\u2019t come to any conclusion as to whether climate change is affecting Londoners (but from personal experience, I can tell that it\u2019s feeling pretty warm there lately).", "But I hope that I\u2019ve demonstrated that SQLite is a useful tool when used alongside Pandas and, if you haven\u2019t done any SQL before, you can see how, even the tiny part of it that I\u2019ve used here, might benefit your data analysis.", "As always, thanks for reading. If you would like to know when I publish new articles, please consider signing up for an email alert here.", "If you are not a Medium subscriber, how about signing up so you can read as many articles as you like for $5 a month. Sign up here and I\u2019ll earn a small commision.", "You can find sample code for this and other articles on my Github page.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa0e2c052456f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@alanjones", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alan-jones?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alan-jones?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": "Alan Jones"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7d3f5fb94faa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&user=Alan+Jones&userId=7d3f5fb94faa&source=post_page-7d3f5fb94faa----a0e2c052456f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0e2c052456f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0e2c052456f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Winkler"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://alan-jones.medium.com/subscribe", "anchor_text": "here"}, {"url": "https://alan-jones.medium.com/membership", "anchor_text": "here"}, {"url": "https://alanjones2.github.io/Alan-Jones-article-code/", "anchor_text": "Github page"}, {"url": "https://medium.com/tag/sqlite?source=post_page-----a0e2c052456f---------------sqlite-----------------", "anchor_text": "Sqlite"}, {"url": "https://medium.com/tag/python?source=post_page-----a0e2c052456f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----a0e2c052456f---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/programming?source=post_page-----a0e2c052456f---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a0e2c052456f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa0e2c052456f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&user=Alan+Jones&userId=7d3f5fb94faa&source=-----a0e2c052456f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa0e2c052456f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&user=Alan+Jones&userId=7d3f5fb94faa&source=-----a0e2c052456f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0e2c052456f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa0e2c052456f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a0e2c052456f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a0e2c052456f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a0e2c052456f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a0e2c052456f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a0e2c052456f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alan-jones?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alan-jones?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alan Jones"}, {"url": "https://medium.com/@alan-jones/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7d3f5fb94faa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&user=Alan+Jones&userId=7d3f5fb94faa&source=post_page-7d3f5fb94faa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffc3a6cdb7554&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-pandas-and-sqlite-a0e2c052456f&newsletterV3=7d3f5fb94faa&newsletterV3Id=fc3a6cdb7554&user=Alan+Jones&userId=7d3f5fb94faa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}