{"url": "https://towardsdatascience.com/lightgbm-for-quantile-regression-4288d0bb23fd", "time": 1683014645.829727, "path": "towardsdatascience.com/lightgbm-for-quantile-regression-4288d0bb23fd/", "webpage": {"metadata": {"title": "LightGBM for Quantile Regression. Understand Quantile Regression | by Jeremy Zhang | Towards Data Science", "h1": "LightGBM for Quantile Regression", "description": "For regression prediction tasks, not all time that we pursue only an absolute accurate prediction, and in fact, our prediction is always inaccurate, so instead of looking for an absolute precision\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.lokad.com/pinball-loss-function-definition#:~:text=The%20pinball%20loss%20function%20is,forecast%20is%20a%20subtle%20problem.", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://github.com/MJeremy2017/Machine-Learning-Models/blob/master/quantile-regression/lgb-quantile-regression.ipynb", "anchor_text": "Git Repo", "paragraph_index": 3}, {"url": "https://github.com/MJeremy2017/Machine-Learning-Models/blob/master/quantile-regression/lgb-quantile-regression.ipynb", "anchor_text": "Repo", "paragraph_index": 6}, {"url": "http://ethen8181.github.io/machine-learning/ab_tests/quantile_regression/quantile_regression.html", "anchor_text": "this", "paragraph_index": 9}], "all_paragraphs": ["For regression prediction tasks, not all time that we pursue only an absolute accurate prediction, and in fact, our prediction is always inaccurate, so instead of looking for an absolute precision, some times a prediction interval is required, in which cases we need quantile regression \u2014 that we predict an interval estimation of our target.", "Fortunately, the powerful lightGBM has made quantile prediction possible and the major difference of quantile regression against general regression lies in the loss function, which is called pinball loss or quantile loss. There is a good explanation of pinball loss here, it has the formula:", "Where y is the actual value, z is the prediction and \ud835\uded5 is the targeted quantile. So the first sight of the loss function, we can see that besides when quantile equals to 0.5, the loss function is unsymmetrical. Let\u2019s have a visual on it:", "The implementation can be found on my Git Repo. In the graph, three different quantiles were plotted, take quantile 0.8 as an example, when the error is positive ( z > y \u2014 predicted value is higher than the actual value), the loss is less than that when error is negative. In another world, higher error is less punished, this makes sense in that for high quantile prediction, the loss function encourages higher prediction value, and vice versa for low quantile prediction.", "Now let\u2019s generate some data for lightGBM prediction.", "Here we use a sin(x) function with some additional noise as training set.", "Notice that different from general regression, the objective and metric are both quantile , and alpha is the quantile we need to predict ( details can check my Repo ).", "Now let\u2019s check out quantile prediction result:", "We can see that most noisy dots are located in the prediction range, where the green line is the upper bound of 0.9 quantile and blue is the 0.1 quantile.", "This post is originally inspired by this, which is a great entry point quantile regression starter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hmm\u2026I am a data scientist looking to catch up the tide\u2026"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4288d0bb23fd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://meatba11.medium.com/?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": "Jeremy Zhang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37783fc8c26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&user=Jeremy+Zhang&userId=f37783fc8c26&source=post_page-f37783fc8c26----4288d0bb23fd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4288d0bb23fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4288d0bb23fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.lokad.com/pinball-loss-function-definition#:~:text=The%20pinball%20loss%20function%20is,forecast%20is%20a%20subtle%20problem.", "anchor_text": "here"}, {"url": "https://github.com/MJeremy2017/Machine-Learning-Models/blob/master/quantile-regression/lgb-quantile-regression.ipynb", "anchor_text": "Git Repo"}, {"url": "https://github.com/MJeremy2017/Machine-Learning-Models/blob/master/quantile-regression/lgb-quantile-regression.ipynb", "anchor_text": "Repo"}, {"url": "http://ethen8181.github.io/machine-learning/ab_tests/quantile_regression/quantile_regression.html", "anchor_text": "this"}, {"url": "https://medium.com/tag/lightgbm?source=post_page-----4288d0bb23fd---------------lightgbm-----------------", "anchor_text": "Lightgbm"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4288d0bb23fd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/regression?source=post_page-----4288d0bb23fd---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4288d0bb23fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&user=Jeremy+Zhang&userId=f37783fc8c26&source=-----4288d0bb23fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4288d0bb23fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&user=Jeremy+Zhang&userId=f37783fc8c26&source=-----4288d0bb23fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4288d0bb23fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4288d0bb23fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4288d0bb23fd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4288d0bb23fd--------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeremy Zhang"}, {"url": "https://meatba11.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37783fc8c26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&user=Jeremy+Zhang&userId=f37783fc8c26&source=post_page-f37783fc8c26--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcdbd8b83c584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flightgbm-for-quantile-regression-4288d0bb23fd&newsletterV3=f37783fc8c26&newsletterV3Id=cdbd8b83c584&user=Jeremy+Zhang&userId=f37783fc8c26&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}