{"url": "https://towardsdatascience.com/conceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f", "time": 1683002558.424545, "path": "towardsdatascience.com/conceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f/", "webpage": {"metadata": {"title": "15-Minute Conceptual and Painless Introduction to Monte Carlo Methods and Applied Bayesian Inference | by Sergio E. Betancourt | Towards Data Science", "h1": "15-Minute Conceptual and Painless Introduction to Monte Carlo Methods and Applied Bayesian Inference", "description": "In this article I shall provide a very brief, self-contained, introduction to Bayesian Inference and Monte Carlo methods, that should hopefully inspire you to dig deeper through some of the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.jstatsoft.org/article/view/v076i01", "anchor_text": "Stan: A Probabilistic Programming Language", "paragraph_index": 33}, {"url": "https://www.amazon.ca/Monte-Statistical-Methods-Christian-Robert/dp/0387212396/ref=sr_1_1?ie=UTF8&s=books&qid=1226423218&sr=1-1", "anchor_text": "Monte Carlo Statistical Methods", "paragraph_index": 34}, {"url": "https://www.cengage.com/c/mathematical-statistics-with-applications-7e-wackerly/9780495110811/", "anchor_text": "Mathematical Statistics with Applications", "paragraph_index": 35}], "all_paragraphs": ["In this article I shall provide a very brief, self-contained, introduction to Bayesian Inference and Monte Carlo methods, that should hopefully inspire you to dig deeper through some of the references I have included.", "You may or may not have heard about Bayesian inference/regression/modelling/analysis... Chances are you may have only encountered it before in passing, without ever really wondering about its uses or without any good resources to get started.", "The reality is that Bayesian inference [1] is a little more involved than its Frequentist counterpart and most people ever really make use of it in academia or very specialized industrial applications. However, it offers an incredibly rich framework to appreciate and ultimately harness more information at the inference process. Moreover, it elevates the ties between probability and applied statistics in a savory manner \u2014 a true Bayesian model is a generative model.", "For this series of articles, I will employ a (traditional) likelihood-based modelling approach.", "Bayesian inference allows us to include some preconceived, i.e., prior, beliefs into our modelling. Rather than finding the value of the parameter that allows us to maximize our likelihood (Maximum Likelihood Estimation), we can sample from the posterior probability distribution to get a good idea of the behavior of our parameter(s) of interest after carrying out our experiment.", "In simple terms, I declare a prior distribution for my model parameter (\ud835\udf03), and multiply it times the likelihood of my observed data (D). For this quantity to serve as a probability density function, I must divide it by a normalizing constant. Then I obtain my posterior distribution function.", "Note that the normalizing constant P(D) above (often denoted C) is intractable and, except in the cases when you have conjugate priors, we often rely on Monte Carlo methods to sample from the posterior distribution for this kind of inference. In doing so with a large variety of elementary models, we can obviate this quantity C without losing our sleep.", "You may ask: Why do this?", "Better science, more rigurous inference, regularization, numerical stability, expensive data acquisition which does not quite allow for MLE, and many, many more reasons.", "You may ask: What are good priors?", "Ideally, priors should come without ever looking at data.", "You may ask: What kind of priors are there out there?", "As an example, imagine I find a coin on the floor and would like to gain a sense for whether it is fair or not. I declare p=\ud835\udf03 to be the probability that in a given toss the coin will yield \u201cheads\u201d (y=1). Then q=1-\ud835\udf03 is the probability that the coin yields \u201ctails\u201d (y=0). Note that this behavior of the coin can be modeled as a bernoulli random variable with the below functional form:", "Suppose I toss the coin 4 times and observe it always gives me \u201ctails.\u201d If I adopt a Maximum Likelihood framework then I have the following ML estimate (sample proportion):", "The above yields 0 in our case. But this is a little too extreme\u2026 Having two sides of equal surface area means that the coin should have a non-zero probability (albeit very small) of landing \u201cHeads\u201d. We would immediately notice if one side was disproportionately smaller to the other.", "Now, as Bayesians, say we come across this same coin. Before tossing the coin ourselves we would formulate a prior belief about the coin. In my experience coins are usually fair, so I posit the belief that this coin is very likely to be fair, with some probability that it is not. Then I\u2019ll carry out my experiment and gain a sense for whether this coin adheres to my belief or not. Oh, I obtain the same result {0, 0, 0, 0}.", "For a valid (weakly informative) prior I\u2019ll use a beta(a,b) distribution, with a, b non-negative integers. This prior makes sense because the support of the beta distribution is [0,1], and \ud835\udf03 here corresponds to a probability and cannot be less than 0 or greater than 1. Setting a=b=u where u is a positive integer yields a distribution symmetric around 0.5. Moreover, the beta distribution is conjugate to the bernoulli distribution (also conjugate to the binomial distribution, as a binomial random variable consists of the sum of bernoulli random variables).", "Then I consider the following model:", "Here C \u22650 denotes the normalizing constant, which, for the purposes of this application, is not necessary to estimate.", "If we set a=b=5 in our prior above, Stan [2] \u2014 see the tutorial for how to do this \u2014 yields and approximate posterior mean of \ud835\udf03 of 0.36 < .5. Thus our estimate suggests a biased coin, without going immediately to 0.", "For the purposes of this tutorial, Monte Carlo methods [3] will allow us to sample from the posterior distribution of our model parameters.", "The simplest Monte Carlo method for estimating the integral (I) of a real-valued, integrable function f(x) (say on 0 \u2264x\u22641), indicates that we sample K>0 independent samples of x on [0,1], evaluate f(x}) for each of these x_{i}\u2019s, and then sum and average them. Let\u2019s require I<\u221e. We then invoke the Law of Large Numbers [4] and we can appreciate the following:", "The above is nice and easy, but we can actually use even more knowledge of statistics by observing the below:", "Our estimator is just an approximation, so it would behoove us to quantify its accuracy:", "So, what can we do now that we have an unbiased estimate for the mean and an estimate of the standard error? Let\u2019s invoke the Central Limit Theorem, which is reasonable for K large enough.", "Using the above we can build a 95% confidence interval for our estimator of the integral:", "The method above is quite naive and inaccurate, especially as the objective (probability) grows in dimension, multimodality, etc. However, this gives you the gist of MC methods:", "Sample from a distribution to approximate another distribution or a quantity of interest.", "Note that Monte Carlo methods are a very active field of research with very rich theory and applications and I encourage you to read more about them. There are also several wrappers on Monte Carlo computation engines (PyMC3, Stan, BUGS, etc) which can be easily integrated into Python, R, and other modern statistical/machine learning software.", "Below are some very fundamental methods to get you started:", "One very last thing. If you\u2019re serious about developing the ability to communicate mathematical/statistical ideas succinctly and precisely, then I encourage you to start playing around with LaTeX [5]. LaTeX is a powerful typesetting system that allows you to write beautiful equations and have them rendered seamlessly in your documents. I use LaTeX in all of the mathematical expressions in this document and all of my work.", "Bayesian inference and computation have recently enjoyed a splendid renaissance with better computing hardware and software. Moreover, Bayesian methods span massively active research areas involving statistics, mathematics, computer science, demography, economics, and many other fields.", "Below are some of the hottest themes in modern ML and statistics research which either rely or make heavy use of the Bayesian framework for inference:", "[2] B. Carpenter et al, Stan: A Probabilistic Programming Language (2017), Journal of Statistical Software.", "[3] C. Robert and G. Casella, Monte Carlo Statistical Methods (2005), Springer Texts in Statistics.", "[4] D. Wackerley et al, Mathematical Statistics with Applications (2014), Cengage Learning", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science at Moz. MSc Statistical Sciences, University of Toronto (Canada)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc8f744e3823f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sergiosonline?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sergiosonline?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": "Sergio E. Betancourt"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F951ed7d07b1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&user=Sergio+E.+Betancourt&userId=951ed7d07b1c&source=post_page-951ed7d07b1c----c8f744e3823f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8f744e3823f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8f744e3823f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/painless-introduction-to-applied-bayesian-inference-using-py-stan-36b503a4cd80", "anchor_text": "Painless Introduction to Applied Bayesian Inference using (Py)Stan"}, {"url": "https://pixabay.com/users/imarksm-701058/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=602944", "anchor_text": "imarksm"}, {"url": "https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=602944", "anchor_text": "Pixabay"}, {"url": "https://www.cs.toronto.edu/~radford/ftp/bayes-tut.pdf", "anchor_text": "Tutorial on Bayesian Inference for ML"}, {"url": "https://www.jstatsoft.org/article/view/v076i01", "anchor_text": "Stan: A Probabilistic Programming Language"}, {"url": "https://www.amazon.ca/Monte-Statistical-Methods-Christian-Robert/dp/0387212396/ref=sr_1_1?ie=UTF8&s=books&qid=1226423218&sr=1-1", "anchor_text": "Monte Carlo Statistical Methods"}, {"url": "https://www.cengage.com/c/mathematical-statistics-with-applications-7e-wackerly/9780495110811/", "anchor_text": "Mathematical Statistics with Applications"}, {"url": "https://www.latex-project.org/", "anchor_text": "LaTeX \u2014 A document preparation system"}, {"url": "https://www.latex-project.org/lppl/", "anchor_text": "(https://www.latex-project.org/lppl/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c8f744e3823f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----c8f744e3823f---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c8f744e3823f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/monte-carlo?source=post_page-----c8f744e3823f---------------monte_carlo-----------------", "anchor_text": "Monte Carlo"}, {"url": "https://medium.com/tag/ba-ba-bayesian?source=post_page-----c8f744e3823f---------------ba_ba_bayesian-----------------", "anchor_text": "Ba Ba Bayesian"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc8f744e3823f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&user=Sergio+E.+Betancourt&userId=951ed7d07b1c&source=-----c8f744e3823f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc8f744e3823f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&user=Sergio+E.+Betancourt&userId=951ed7d07b1c&source=-----c8f744e3823f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8f744e3823f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc8f744e3823f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c8f744e3823f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c8f744e3823f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c8f744e3823f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c8f744e3823f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c8f744e3823f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sergiosonline?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sergiosonline?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sergio E. Betancourt"}, {"url": "https://medium.com/@sergiosonline/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F951ed7d07b1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&user=Sergio+E.+Betancourt&userId=951ed7d07b1c&source=post_page-951ed7d07b1c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F951ed7d07b1c%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconceptual-background-for-painless-introduction-to-applied-bayesian-regression-using-pystan-c8f744e3823f&user=Sergio+E.+Betancourt&userId=951ed7d07b1c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}