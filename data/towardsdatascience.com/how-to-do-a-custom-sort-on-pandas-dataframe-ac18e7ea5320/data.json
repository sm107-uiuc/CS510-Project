{"url": "https://towardsdatascience.com/how-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320", "time": 1683015436.709994, "path": "towardsdatascience.com/how-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320/", "webpage": {"metadata": {"title": "How to do a Custom Sort on Pandas DataFrame | by B. Chen | Towards Data Science", "h1": "How to do a Custom Sort on Pandas DataFrame", "description": "Pandas DataFrame has a built-in method sort_values() to sort values by the given variable(s). The method itself is fairly straightforward to use, however it doesn\u2019t work for custom sorting, for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/017-pandas-custom-sort/pandas-custom-sort.ipynb", "anchor_text": "Github repo", "paragraph_index": 2}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.cat.html", "anchor_text": "Series.cat", "paragraph_index": 18}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Categorical.codes.html", "anchor_text": "category codes", "paragraph_index": 18}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/017-pandas-custom-sort/pandas-custom-sort.ipynb", "anchor_text": "notebook on my Github", "paragraph_index": 25}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github", "paragraph_index": 27}], "all_paragraphs": ["Pandas DataFrame has a built-in method sort_values() to sort values by the given variable(s). The method itself is fairly straightforward to use, however it doesn\u2019t work for custom sorting, for example,", "In this article, we are going to take a look at how to do a custom sort on Pandas DataFrame.", "Please check out my Github repo for the source code", "Suppose we have a dataset about a clothing store:", "We can see that each cloth has a size value and the data should be sorted by the following order:", "However, you will get the following output when calling sort_values('size') .", "The output is not we want, but it is technically correct. Under the hood, sort_values() is sorting values by numerical order for number data or character alphabetically for object data.", "In this solution, a mapping DataFrame is needed to represent a custom sort, then a new column will be created according to the mapping, and finally we can sort the data by the new column. Let\u2019s see how this works with the help of an example.", "Firstly, let\u2019s create a mapping DataFrame to represent a custom sort.", "After that, create a new column size_num with mapped value from sort_mapping.", "Finally, sort values by the new column size_num.", "This certainly does our work. But it has created a spare column and can be less efficient when dealing with a large dataset.", "We can solve this more efficiently using CategoricalDtype.", "CategoricalDtype is a type for categorical data with the categories and orderedness [1]. It is very useful for creating a custom sort [2]. Let\u2019s see how this works with the help of an example.", "Then, create a custom category type cat_size_order with", "After that, call astype(cat_size_order) to cast the size data to the custom category type. By running df['size'], we can see that the size column has been casted to a category type with the order [XS < S < M < L < XL].", "And finally, we can call the same method to sort values.", "This works much better. Let\u2019s go ahead and see what is actually happening under the hood.", "Now the size column has been casted to a category type, and we could use Series.cat accessor to view categorical properties. Under the hood, it is using the category codes to represent the position in an ordered categorical.", "Let\u2019s create a new column codes, so we could compare size and codes values side by side.", "We can see that XS, S, M, L, and XL has got a code 0, 1, 2, 3, 4, and 5 respectively. Codes are the positions of the actual values in the category type. By running df.info() , we can see that codes are int8.", "Next, let\u2019s make things a little more complicated. Here, we\u2019re going to sort our DataFrame by multiple variables.", "Similarly, let\u2019s create 2 custom category types cat_day_of_week and cat_month, and pass them to astype().", "To sort by multiple variables, we just need to pass a list to sort_values() in stead. For example, sort by month and day_of_week.", "And sort by customer_id, month and day_of_week.", "Please checkout the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "More can be found from my Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac18e7ea5320&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----ac18e7ea5320---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac18e7ea5320&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac18e7ea5320&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@uxindo?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "UX Indonesia"}, {"url": "https://unsplash.com/s/photos/sorting?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/017-pandas-custom-sort/pandas-custom-sort.ipynb", "anchor_text": "Github repo"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.cat.html", "anchor_text": "Series.cat"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Categorical.codes.html", "anchor_text": "category codes"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/017-pandas-custom-sort/pandas-custom-sort.ipynb", "anchor_text": "notebook on my Github"}, {"url": "https://towardsdatascience.com/creating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5", "anchor_text": "Creating conditional columns on Pandas with Numpy select() and where() methods"}, {"url": "https://towardsdatascience.com/when-to-use-pandas-transform-function-df8861aa0dcf", "anchor_text": "When to use Pandas transform() function"}, {"url": "https://medium.com/@bindiatwork/difference-between-apply-and-transform-in-pandas-242e5cf32705", "anchor_text": "Difference between apply() and transform() in Pandas"}, {"url": "https://medium.com/@bindiatwork/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac", "anchor_text": "Using Pandas method chaining to improve code readability"}, {"url": "https://towardsdatascience.com/working-with-datetime-in-pandas-dataframe-663f7af6c587", "anchor_text": "Working with datetime in Pandas DataFrame"}, {"url": "https://medium.com/@bindiatwork/all-the-pandas-read-csv-you-should-know-to-speed-up-your-data-analysis-1e16fe1039f3", "anchor_text": "Pandas read_csv() tricks you should know"}, {"url": "https://towardsdatascience.com/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e", "anchor_text": "4 tricks you should know to parse date columns with Pandas read_csv()"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.CategoricalDtype.html", "anchor_text": "Pandas.CategoricalDtype API"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html#categorical-categoricaldtype", "anchor_text": "Pandas Categorical CategoricalDtype"}, {"url": "https://medium.com/tag/pandas?source=post_page-----ac18e7ea5320---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ac18e7ea5320---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac18e7ea5320---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----ac18e7ea5320---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/sorting?source=post_page-----ac18e7ea5320---------------sorting-----------------", "anchor_text": "Sorting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac18e7ea5320&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&user=B.+Chen&userId=563d09da62a&source=-----ac18e7ea5320---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac18e7ea5320&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&user=B.+Chen&userId=563d09da62a&source=-----ac18e7ea5320---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac18e7ea5320&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac18e7ea5320&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac18e7ea5320---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac18e7ea5320--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}