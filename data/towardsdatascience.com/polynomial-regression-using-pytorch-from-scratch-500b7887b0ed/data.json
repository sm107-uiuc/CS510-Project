{"url": "https://towardsdatascience.com/polynomial-regression-using-pytorch-from-scratch-500b7887b0ed", "time": 1683008494.3632588, "path": "towardsdatascience.com/polynomial-regression-using-pytorch-from-scratch-500b7887b0ed/", "webpage": {"metadata": {"title": "ML from Scratch- Polynomial Regression Using PyTorch | by Aman Sharma | Towards Data Science", "h1": "ML from Scratch- Polynomial Regression Using PyTorch", "description": "When it comes to predictive analysis, regression models prove to be one of the most cost-efficient methods. While a linear regression model can provide some good predictions, in several cases the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/goyalshalini93/car-data", "anchor_text": "link to the data set", "paragraph_index": 4}, {"url": "https://medium.com/bayshore-intelligence-solutions/why-is-stochastic-gradient-descent-2c17baf016de", "anchor_text": "this", "paragraph_index": 38}, {"url": "https://medium.com/@amansharma2910", "anchor_text": "my profile", "paragraph_index": 47}], "all_paragraphs": ["When it comes to predictive analysis, regression models prove to be one of the most cost-efficient methods. While a linear regression model can provide some good predictions, in several cases the polynomial regression models can vastly outperform simple linear models. In the following project, we\u2019ll have a look at how to create a polynomial regression model in PyTorch from scratch.", "We will create the model entirely from scratch, using basic PyTorch tensor operations.", "Before we begin working on the project, let us import all the necessary libraries and functions.", "Now, let us import the dataset.", "Here\u2019s the link to the data set if you plan to work on it yourself.", "I\u2019ll also link the GitHub repo with the project notebook and the data set at the end of this article.", "Since a polynomial regression model can already be a bit too overwhelming for beginners, therefore, for the sake of simplicity, we will be working only with continuous variables in our project.", "Now, let us analyze the data and see if it needs any cleaning or modifications. First, let us check the data type of each column of the data frame.", "*One thing to be noted is that the dataset has no null values.", "As we can see, some of the data is of the type \u2018int64\u2019, while some of the type \u2018float64\u2019. Since we\u2019ll be working with tensors, we might want a uniform data-type throughout our feature set. As a result, we will cast the entire data frame to \u2018float64\u2019 at a later step.", "Now, we will have a look at the descriptive analysis of the data frame.", "As we can see, the data in different columns vary significantly in scale. We have elements in our data set of the order of 1e+0 on the lower range and elements of the order of 1e+3 on the upper range. We might want to normalize the data. We will deal with this at a later step in our project.", "Let us first plot the graph of each independent variable against the target variable (quality).", "Now, let us have a look at the correlation values for our dataset.", "From the above visual analysis, we can clearly see that enginesize (++0.87), curbweight (+0.84) and horsepower (+0.81) show a very strong correlation with the dependent variable, price.", "Now, we will work on our model. But before we do that, first let us observe the plot of the features against the target once again.", "If we observe the graphs carefully, we will notice that the features enginesize, curbweight, horsepower, carlength and carwidth have a graph of the type y = x2.", "On the other hand, citympg and highwaympg have a graph of the type y = 1 / x2.", "So we will deal with these features accordingly.", "Given below are the formulae that our polynomial regression model will work on.", "As we can see, a polynomial regression function can be substituted as a linear regression function", "Let us now convert the feature (Pandas Dataframe object) and target (Pandas Series object) into tensor objects so we can use them to train our model with PyTorch.", "Now, for features with activation function of the type y = x2, we first create the x2 features then concatenate it to our tensor object.", "Now, for features with activation function of the type y = 1/x2, we first create the 1/x2 features then concatenate it to our tensor object.", "With this, we have polynomially transformed our features.", "Now finally, we will concatenate all the transformed feature tensors into a single tensor object.", "Since we will be using Stochastic Gradient Descent (SGD) algorithm as the optimization algorithm for our model, scaling can significantly improve the optimization process and the performance of our model.", "In this project, we will be performing Min-Max Scaling. Min-max normalization converts the data such that all the values are between [0,1].", "The mathematical formula for min-max normalization is as follows:", "Now, let us perform min-max normalization on our feature set.", "Now, we will create a tensor object that holds the weights associated with the polynomially-transformed, normalized features. These weights are randomly generated and are very small.", "Now, let us initialize a random bias for our model.", "Finally, convert the target array into a tensor.", "Now, let us define the regression function.", "Now, we will define our mean-squared error (MSE) function. MSE is one of the most commonly used methods to calculate the total model loss. Given below is the formula for the calculation of MSE.", "Upon running the MSE function for our model-", "As we can see, our model currently gives a very large MSE. Therefore, we need to optimize our model weights and biases to improve its performance.", "For optimizing our model, we will be using the Stochastic Gradient Descent (SGD) algorithm. Given below is the mathematics associated with the SGD optimizer algorithm.", "For more information regarding SGD, kindly visit this link.", "In our model, we will be using PyTorch\u2019s built-in gradient calculation functions for calculating and upgrading the weights and biases.", "With all this done, we will finally run the optimizer function for our model.", "Now, to check the accuracy of our model, we will calculate its r-squared score. The following is the formula for r2 score-", "Now, let us check the performance of our model. We will use the updated models and weights obtained by our optimizer function.", "As we can see, our polynomial regression model can explain around 83\u201384% of the variance for the dependent variable. This is a considerably efficient model.", "One thing to be noted here is that we performed training and testing on the same dataset, which is a bad practice. Instead, you should split the dataset into test set and training set. However, in this example, while creating the model from scratch, I skipped the step to keep things simple and understandable.", "In the end of our project, let us plot the regression plot for all polynomially transformed features of our model.", "From the above graphs, we can see our model is performing pretty well.", "With this, we come to the end of our project. For more fun projects like this one, check out my profile.", "I am just a novice in the field of Machine Learning and Data Science so any suggestions and criticism will really help me improve.", "Hit that follow and stay tuned for more ML stuff!", "Link to GitHub repo for the dataset and Jupyter notebook-", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Programming computers to do the work for me and using data to solve problems are my passion. My machine and I are learning. Connect on Twitter @amansharma2910"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F500b7887b0ed&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://amansharma2910.medium.com/?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": "Aman Sharma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84e03a4d7261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&user=Aman+Sharma&userId=84e03a4d7261&source=post_page-84e03a4d7261----500b7887b0ed---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F500b7887b0ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F500b7887b0ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@lukas-rodriguez-1845331?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Lukas Rodriguez"}, {"url": "https://www.pexels.com/photo/aerial-photography-of-island-3427774/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://www.kaggle.com/goyalshalini93/car-data", "anchor_text": "link to the data set"}, {"url": "https://medium.com/bayshore-intelligence-solutions/why-is-stochastic-gradient-descent-2c17baf016de", "anchor_text": "this"}, {"url": "https://medium.com/@amansharma2910", "anchor_text": "my profile"}, {"url": "https://github.com/amansharma2910/PolynomialRegression_from_scratch_using_PyTorch", "anchor_text": "amansharma2910/PolynomialRegression_from_scratch_using_PyTorchThe repo contains the Jupyter notebook for my project where I created a polynomial regression model from scratch using\u2026github.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----500b7887b0ed---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----500b7887b0ed---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----500b7887b0ed---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/regression?source=post_page-----500b7887b0ed---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----500b7887b0ed---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F500b7887b0ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&user=Aman+Sharma&userId=84e03a4d7261&source=-----500b7887b0ed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F500b7887b0ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&user=Aman+Sharma&userId=84e03a4d7261&source=-----500b7887b0ed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F500b7887b0ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F500b7887b0ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----500b7887b0ed---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----500b7887b0ed--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----500b7887b0ed--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----500b7887b0ed--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----500b7887b0ed--------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aman Sharma"}, {"url": "https://amansharma2910.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "94 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84e03a4d7261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&user=Aman+Sharma&userId=84e03a4d7261&source=post_page-84e03a4d7261--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F186d48c6a7d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-using-pytorch-from-scratch-500b7887b0ed&newsletterV3=84e03a4d7261&newsletterV3Id=186d48c6a7d2&user=Aman+Sharma&userId=84e03a4d7261&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}