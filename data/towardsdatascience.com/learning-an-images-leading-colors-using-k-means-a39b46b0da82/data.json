{"url": "https://towardsdatascience.com/learning-an-images-leading-colors-using-k-means-a39b46b0da82", "time": 1682997368.065645, "path": "towardsdatascience.com/learning-an-images-leading-colors-using-k-means-a39b46b0da82/", "webpage": {"metadata": {"title": "Learning an image\u2019s leading colors using k-means | by Juan De Dios Santos | Towards Data Science", "h1": "Learning an image\u2019s leading colors using k-means", "description": "Intersecting data and photography to find my preferred colors"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "k-means", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "t-distributed stochastic neighbor embedding", "paragraph_index": 2}, {"url": "https://scikit-learn.org/", "anchor_text": "scikit-learn", "paragraph_index": 4}, {"url": "https://opencv.org/", "anchor_text": "OpenCV", "paragraph_index": 4}, {"url": "https://hypertools.readthedocs.io/en/latest/", "anchor_text": "HyperTools", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "\u201cdissimilar objects are represented by distant points\u201d", "paragraph_index": 6}, {"url": "https://wanderdata.com/?source=post_page---------------------------", "anchor_text": "wanderdata.com", "paragraph_index": 22}, {"url": "https://juandes.com", "anchor_text": "https://juandes.com", "paragraph_index": 24}], "all_paragraphs": ["Color preferences, like many things in life, is a very intrinsic, and unique quality of a person. You have a favorite color, but more than that, I\u2019m willing to say that you have a preferred tone for many of the things that you own. For example, you favor a particular color for your shoes, another one for your phone case, and in my case, I lean towards some colors while working a photograph.", "Besides being a data practitioner, I\u2019m also an amateur photographer, and a few days ago, while editing an image, I realized I have a favored list of colors that I typically use on different objects or parts of the photograph. For example, I like my skies either gray, or strongly blue, my greens, a bit yellowish, and my darks, more \u201cshadow-ish.\u201d", "To corroborate my beliefs, and also to find a way to intersect my passion for data and photography, I decided to use machine learning, especially, a classic unsupervised learning algorithm, k-means to cluster the pixels of some of my images and learn what the leading or dominant colors are. Moreover, to further understand the photos and to complement the main part of the analysis, I\u2019ll be projecting the images to another representation using the dimensionality reduction algorithm t-distributed stochastic neighbor embedding or t-SNE.", "In this experiment, I\u2019ll be finding the leading colors of nine photographs I took in my recent visit to Austria and Singapore.", "This experiment is done in Python, and it uses the library scikit-learn to fit the k-means model, OpenCV for manipulating the images, and HyperTools for projecting the space using t-SNE.", "Let\u2019s take a look at this image I took in Singapore. What colors do you see? Which are the most common ones? For us, humans, this is pretty easy. At first instance, we might say several tones of gray, blue, and a bit of orange. What does the algorithm say? Can we automate this? Sure, but before getting there, I want to project the red, green, blue channels using t-SNE to understand a bit better what is truly going on here.", "t-SNE is commonly used for embedding high-dimensional data into two or three dimensions by grouping similar objects and modeling them with nearby points, while \u201cdissimilar objects are represented by distant points\u201d. This characteristic of the algorithm makes it suitable for \u201cclustering\u201d data, even if it is already low-dimensional, such as in this case.", "The following three images are the t-SNE representation of the different color channels of the previous picture.", "On each of these images, we can see different groups of pixels. My interpretation of these snakes-like groups is that each one describes similar tones within that color channel. For example, the red channel plot has five different groups, and they might represent different tones of red, such as light tones and saturated tones. However, are these groups the leading colors? Let\u2019s find out.", "Before fitting the model, I had to reshape the image data. By default, a colored image is a 3D matrix consisting of the picture\u2019s width, length, and three color channels. For this application, we are going to transform this vector space into a 2D dataframe made of width*lenght rows and 3 columns (one for each color). Then, we can cluster.", "The experiment\u2019s clustering algorithm is k-means, an unsupervised learning algorithm that clusters data observations in such a way that each point is grouped with others that are similar to it. For this project, I went with k=10, meaning that we\u2019ll obtain 10 dominant colors.", "The following piece of code shows the process.", "Once we have clustered the data, we need to find a way to extract this information and visualize it. So, I built a histogram using as input the result of the clustering, and k as my number of bins. The result is a frequency count list that indicates how many pixels fell under each label. Then, we normalize the list to obtain a list of the percentage of pixels under each label. In short, in this part, we are summarizing how many pixels belong to each cluster.", "Lastly, we\u2019ll draw a rectangle made of the leading colors, in which the length of each color chunk is proportional to the percentages calculated above.", "Now, let\u2019s see the result. These are the leading colors of the Singapore image.", "The bars on the right side of the image are the leading colors found by the algorithm. The first two colors, which are tones of gray, mostly appear in the clouds, water, and within the shadows of the image. Next, we have the blues, which are present in the sky and water. Lastly, there\u2019s the green from the trees.", "Do you agree with the algorithm\u2019s findings?", "Let\u2019s see other examples of images and their leading colors. The first four photographs are from Singapore and the rest from Austria. Can you find any peculiarity in my choice of colors depending on the region?", "In this article, I showed a technique to find an image\u2019s leading colors using k-means and Python. Personally, I\u2019m happy and satisfied with the results. Even though the outcome was not perfect \u2014 some obvious leading colors weren\u2019t detected \u2014 I\u2019d say that it was able to capture the essence the colors I typically use in my images \u2014 grays, dark blues, and browns.", "When working with unsupervised learning, there\u2019s no right or wrong answer, as there are many variables involved in the process, with the most critical one being the initial location of the centroids. This problem results in the algorithm learning something we don\u2019t want, and in this particular use case, this means producing a leading color, which in reality isn\u2019t one of the most common ones. An alternative to the method described in this article (and honestly, one that might produce more accurate results), would be a more programmatic and direct approach in which we\u2019d have to iterate over the picture to build a frequency count.", "Thanks for reading. If you have any questions, doubts, or just want to chat, leave me a comment, and I\u2019ll be happy to answer.", "This experiment\u2019s source code is available at my GitHub, here", "This article is part of my Wander Data series, in which I\u2019m telling and reliving my travel stories with data. To see more of the project, visit wanderdata.com.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data storyteller, Trust and Safety Software Engineer, and fan of quantifying my life. Also, I like Pokemon. https://juandes.com, @jdiossantos."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa39b46b0da82&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@juandes?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": "Juan De Dios Santos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9998a144da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=post_page-9b9998a144da----a39b46b0da82---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/tagged/wander-data", "anchor_text": "Wander Data"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "k-means"}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "t-distributed stochastic neighbor embedding"}, {"url": "https://scikit-learn.org/", "anchor_text": "scikit-learn"}, {"url": "https://opencv.org/", "anchor_text": "OpenCV"}, {"url": "https://hypertools.readthedocs.io/en/latest/", "anchor_text": "HyperTools"}, {"url": "https://www.instagram.com/juandesr", "anchor_text": "me."}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "\u201cdissimilar objects are represented by distant points\u201d"}, {"url": "https://github.com/juandes/wanderdata-scripts/tree/master/images", "anchor_text": "juandes/wanderdata-scriptsScripts used to generate the plots and analysis used on my experiment named Wander Data - juandes/wanderdata-scriptsgithub.com"}, {"url": "https://wanderdata.com/?source=post_page---------------------------", "anchor_text": "wanderdata.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a39b46b0da82---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a39b46b0da82---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a39b46b0da82---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/wander-data?source=post_page-----a39b46b0da82---------------wander_data-----------------", "anchor_text": "Wander Data"}, {"url": "https://medium.com/tag/programming?source=post_page-----a39b46b0da82---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa39b46b0da82&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=-----a39b46b0da82---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa39b46b0da82&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=-----a39b46b0da82---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa39b46b0da82&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a39b46b0da82---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a39b46b0da82--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a39b46b0da82--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a39b46b0da82--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a39b46b0da82--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Juan De Dios Santos"}, {"url": "https://medium.com/@juandes/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "882 Followers"}, {"url": "https://juandes.com", "anchor_text": "https://juandes.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9998a144da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=post_page-9b9998a144da--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8e4ad12e7160&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-an-images-leading-colors-using-k-means-a39b46b0da82&newsletterV3=9b9998a144da&newsletterV3Id=8e4ad12e7160&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}