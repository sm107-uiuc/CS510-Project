{"url": "https://towardsdatascience.com/bulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83", "time": 1683002769.011861, "path": "towardsdatascience.com/bulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83/", "webpage": {"metadata": {"title": "Bulk Mapping Attributes to Dataframes using Python Pandas | by Vajiha Sipra | Towards Data Science", "h1": "Bulk Mapping Attributes to Dataframes using Python Pandas", "description": "When it comes to iterating through large volumes of rows in Pandas dataframes, many of us have impatiently waited for our program to finish looping, sometimes row by row for painstakingly long\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/vajiha-sipra-83842224/", "anchor_text": "https://www.linkedin.com/in/vajiha-sipra-83842224/", "paragraph_index": 14}], "all_paragraphs": ["When it comes to iterating through large volumes of rows in Pandas dataframes, many of us have impatiently waited for our program to finish looping, sometimes row by row for painstakingly long periods of time. This was one of my main struggles when loading high-volume transactional data as a Pandas dataframe, and then enriching the records based on Client ID matches in a separate dictionary (loaded from a JSON file).", "Enrich transaction Pandas Dataframe with client data from the Dictionary", "As you can see, the initial approach (shown below) was looking up the ID in the source dataframe and then looping through another few thousand records in the reference dictionary to find a match. This was done repeatedly for every single row \u2014 think about it. One second was the average time to complete this lookup, not to mention updating the dataframe based on reference data values adds up to several hours of data processing!", "The source data was collected, cleaned and loaded as separate dataframes from distinct source systems, so my program was iterating through each row of these dataframes for a match based on different attributes in the reference dictionary. Firstly, it\u2019s important to know which attribute you want to map these two data sources on. In my case, the dataframes had 2\u20133 different attributes (basically different mapping attributes across datasets), which is why it wasn\u2019t possible to consolidate them all into one larger dataframe in the beginning \u2014 that would have been much simpler from the get-go. In most cases, you don\u2019t have control over how systems and teams collect data, so a large chunk of time may be spent just making sure your formats are aligned before you start the heavy lifting.", "On that note, if implementing a strategic solution, it would be worth it to work with the source teams and let them know how you would like them to send the data \u2014 this will save you time in the future and also help ensure consistency. Plus, you don\u2019t want to run into a situation down the line where you end up receiving source data with unexpected columns, missing attributes or different data types.", "Once the dataframes were cleaned and relabeled in a way that would allow for quickly combining them using the same attribute and data types, I quickly realized that looping should only be reserved for smaller datasets. Mapping or merging is much more suitable for dataframes with several thousand records. This process is very similar to a SQL join where you combine multiple tables (in our case dataframes) into one consolidated table.", "As you can imagine, using loops to find matches was not performance-friendly. Originally my program took several hours to run as it was going row by row (for thousands of records) and then finding a match in the reference data dictionary. I knew this program had to be sufficiently improved if the report I was generating had any chance of being efficient in the long run. That\u2019s where strategic problem solving comes into play!", "While I did use loops in my program, it was only to identify the unique client IDs to then create a subset dictionary from the much larger reference dataset. This saved me from looping over several thousand records in my source dataframe and thousands of other values in the reference dictionary.", "Step 1: Identify unique IDs in the source dataframe and save them to a list", "Step 2: Find matches between the source dataframe and reference dictionary", "Step 3: Create a sub-dictionary for all matches in the larger reference dictionary & convert it to a dataframe", "Step 4: Merge your subset reference dataframe with your source dataframe", "Hope this discovery of merging rather than looping helps you on your data science journey!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Always learning / Making sense of the world through analytics / Technology, AI, journalism, data science / https://www.linkedin.com/in/vajiha-sipra-83842224/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffe192dca9e83&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vajihasipra.medium.com/?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": ""}, {"url": "https://vajihasipra.medium.com/?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": "Vajiha Sipra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F716c0abb7cc3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&user=Vajiha+Sipra&userId=716c0abb7cc3&source=post_page-716c0abb7cc3----fe192dca9e83---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe192dca9e83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe192dca9e83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/search/programming/", "anchor_text": "https://www.pexels.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fe192dca9e83---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----fe192dca9e83---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/technology?source=post_page-----fe192dca9e83---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/pandas?source=post_page-----fe192dca9e83---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/analytics?source=post_page-----fe192dca9e83---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe192dca9e83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&user=Vajiha+Sipra&userId=716c0abb7cc3&source=-----fe192dca9e83---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe192dca9e83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&user=Vajiha+Sipra&userId=716c0abb7cc3&source=-----fe192dca9e83---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe192dca9e83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffe192dca9e83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fe192dca9e83---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fe192dca9e83--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fe192dca9e83--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fe192dca9e83--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fe192dca9e83--------------------------------", "anchor_text": ""}, {"url": "https://vajihasipra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vajihasipra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vajiha Sipra"}, {"url": "https://vajihasipra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "99 Followers"}, {"url": "https://www.linkedin.com/in/vajiha-sipra-83842224/", "anchor_text": "https://www.linkedin.com/in/vajiha-sipra-83842224/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F716c0abb7cc3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&user=Vajiha+Sipra&userId=716c0abb7cc3&source=post_page-716c0abb7cc3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd9989498b0c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbulk-mapping-attributes-to-dataframes-using-python-pandas-fe192dca9e83&newsletterV3=716c0abb7cc3&newsletterV3Id=d9989498b0c0&user=Vajiha+Sipra&userId=716c0abb7cc3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}