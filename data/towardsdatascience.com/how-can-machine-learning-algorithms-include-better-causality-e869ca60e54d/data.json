{"url": "https://towardsdatascience.com/how-can-machine-learning-algorithms-include-better-causality-e869ca60e54d", "time": 1683006244.250062, "path": "towardsdatascience.com/how-can-machine-learning-algorithms-include-better-causality-e869ca60e54d/", "webpage": {"metadata": {"title": "How can Machine Learning algorithms include better Causality? | by Lina Faik | Towards Data Science", "h1": "How can Machine Learning algorithms include better Causality?", "description": "In recent years, machine learning algorithms have known a great success. Thanks to the availability of an important amount of data and the increase of computation speed, they have outperformed usual\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.biostat.jhsph.edu/courses/bio621/misc/Chocolate%20consumption%20cognitive%20function%20and%20nobel%20laurates%20(NEJM).pdf", "anchor_text": "full paper here", "paragraph_index": 10}, {"url": "https://cran.r-project.org/web/packages/pcalg/vignettes/pcalgDoc.pdf", "anchor_text": "R package pcalg", "paragraph_index": 46}, {"url": "https://cran.r-project.org/web/packages/pcalg/vignettes/pcalgDoc.pdf", "anchor_text": "R package pcalg", "paragraph_index": 51}, {"url": "http://project.org/web/packages/pcalg/vignettes/pcalgDoc.pdf", "anchor_text": "Causal Inference Using Graphical Models with the R Package pcalg", "paragraph_index": 61}], "all_paragraphs": ["In recent years, machine learning algorithms have known a great success. Thanks to the availability of an important amount of data and the increase of computation speed, they have outperformed usual statistical methods.", "Nevertheless, as I was learning more about how they work and how to apply them, I came to a surprising fact: most of these algorithms were focusing on making the most accurate predictions or classifications rather than proving cause-and-effect relationships.", "And yet, this kind of relationships can be crucial in decision making, especially in the sectors of health, social, or behavior sciences.", "You can see that these questions are causal questions rather than associative questions. They require not only to prove the cause-effect relationship but to quantify it.", "Most of the time, experimental interventions are used: analysts carry out surveys, gather data, and analyze it with sophisticated statistical methods. However, these experiments can be costly both in terms of time and money and even raise ethical questions in some cases.", "Moreover, when it comes to Machine learning algorithms, they are generally limited for 3 main reasons:", "So, is there any other alternative?", "In this article, I will share with you my key findings of some important causal modeling tools such as structural models, causal diagrams, and their associated logic.", "After reading this article, you will learn:", "Before getting started, it is essential to revisit the well-known adage: correlation is not causation. It means that you cannot legitimately deduce a cause-and-effect relationship between two variables only because you have observed a correlation between them.", "To illustrate this point, let consider the following graph published by Messerli in 2012 in his paper Chocolate Consumption, Cognitive Function, and Nobel Laureates (full paper here).", "As pointed out by the author, there is a correlation between a country\u2019s level of chocolate consumption and its population\u2019s cognitive function (r=0.791, p<0.0001). Does it mean that eating more chocolate would make smatter? Unfortunately, probably not!", "To put it more precisely, if two random variables X and Y are statistically dependent (X \u22a5 Y), then either:", "This is known as the Common Cause Principle, introduced by Hans Reichenbach in 1956.", "Therefore, in order to truly investigate the impact of chocolate consumption, it is necessary to carry out an experiment. This would require, for instance, forcing a country to eat more chocolate and observe whether it leads to a higher number of Nobel laureates.", "As you can see, experimentation can simply be impossible. It can even raise ethical questions when it comes to health issues. Consequently, other tools are required to prove causality.", "As developed by Pearls in his work on causal reasoning, causal information can be classified into a three-level hierarchy.", "This hierarchy brings a useful insight into what kind of questions each class of information can answer.", "It is the first level and thus to most basic one. It relies on purely statistical relationships using the available data.", "For instance, customers who buys flour are most likely to also buy butter. This kind of associations can be directly established using conditional probabilities and expectation from the observed data. If x is the quantity of flour bought and y the quantity of butter, then we are able to compute P(y|X=x) based on the data.", "Current machine learning methods are perfectly suited to answer this kind of task. One can think of the effectiveness of recommendation engines used by Amazon and similar companies. However, their results tell us little about the actual statistical dependency between variables.", "This level ranks higher than Association because it consists not only in observing data but change it.", "For instance, in our previous case, intervention would have been necessary to answer the following question: what would happen if we triple the price of flour?", "As such an increase of price would have probably led to a change in customer\u2019s behaviour, it is impossible to answer this question simply from the observed data. If x is the quantity to of flour bought and y the quantity of butter, then we want to compute P(y|X=do(x)) , where do denotes that we have intervened to set the value of X to x.", "It is important to keep in mind that when there is a cofounder, i.e. a variable that influences both the dependent variable and independent variable:", "To illustrate this point, consider that customers buy flour and butter only to bake a cake. The increase in the price of flour would have discouraged them from baking at all!", "The last level is represented by Counterfactuals. They answer the typical question: What if I had acted differently? They rely thus on retrospective reasoning.", "For instance, was the quantity of flour I bought the only reason why I bought some much butter or was it due the current promotion?", "If x is the quantity to of flour bought and y the quantity of butter, then we want to compute P(y|x\u2019y\u2019) , i.e. the probability that event Y = y would be observed had X been x\u2019, given that we actually observed X to be x and Y to be y\u2019.", "Note that a model that can answer counterfactual questions can also answer questions about interventions and observations. This possibility does not work in the opposite direction. This is why counterfactuals are placed at the top of the hierarchy.", "Now that we have identified and classified the different causal inferences, let\u2019s focus on the main methods to establish them.", "To do so, we will first discuss the graphical models used to model causal structures and the algorithms used to learn them. Then, we will describe methods that quantify such causal relationships.", "A summary diagram will be provided a the end of this section to synthesize key points.", "A graphical model can be considered as a map of a dependence structure for a given probability distribution.", "Before getting into the technical details, a distinction has to be made between 2 cases:", "Case 1: No Omitted Variables nor Selection Bias", "A causal structure can be visualized through Directed Acyclic Graphs (DAG). It is a mathematical tool consisting of a graph, i.e. composed of nodes and edges directed, that does not contain any cycle.", "However, the same dataset and the conditional (in)dependences between its variables can lead to multiple DAG.", "Let\u2019s consider the following example: we want to identify the main factors that influence students\u2019 grades and measure their effects. For the sake of simplicity, we will only take 3 variables: X the number of class hours in mathematics (including individual lessons at home), Y the distance between students\u2019 home and the school, Z the students\u2019 grade in mathematics. We can assume that X \u22a5 Y | Z.", "This assumption leads to 3 possible DAGs:", "This is why it is necessary to introduce an additional notion: Equivalent class. It\u2019s a set of graphs with the same skeleton but with different edge marks. DAG\u2019s equivalent class is called Completed Partially Directed Acyclic Graph (CPDAG).", "It is easy to conclude the conditional (in)dependence of nodes in the case of 3 variables. But when the graph contains many variables, it is necessary to introduce an additional tool: d-separation.", "Let\u2019s define d-separation: Two nodes X and Y are d-separable by L, a set of nodes, if conditioning on all members in L blocks all paths between the two nodes.", "To illustrate this point, here are 2 examples:", "Thus, the notion of d-separation provides us with (in)dependence relations defined on graphs that reflect conditional (in)dependencies between variables.", "How to learn DAG graphs based on a given dataset?", "A well-known algorithm, the PC algorithm, is available in R package pcalg. Basically, it starts with a complete undirected graph, G0, and carries out a series of conditional independence tests where edges are deleted. This leads to the skeleton. The skeleton is then directed based on the information saved in the conditioning sets.", "Case 2: With Omitted Variables and Selection Bias", "In this case, we need to find a structure that represents all conditional independence relationships among the observed variables given the selected variables. This means that we need marginalize all latent variables and be able to visualize the conditional independencies only among observed variables.", "Since DAGs are not closed under margination we need to use another class of graph: Maximal Ancestry Graph (MAG). This class allows for the missing edge which corresponds to conditional independence. Similarly, Partial Ancestral Graph (PAG) is the equivalence class of a MAG and m-separation, a generalization of d-separation.", "How to learn MAG graphs based on a given dataset?", "Learning a MAG can be done via the FCI algorithm (\u201cFast causal inference\u201d), which uses a similar approach to PC but with more conditional independence tests and more orientation rules. It is also possible to use the RFCI algorithm (\u201cReally fast causal inference\u201d), which is faster but the output is in general slightly less informative. Both algorithms are available in R package pcalg.", "Observing data only does not enable us to quantify the causal effect of a variable on another. To do so, we need to measure the state of Y if X is forced to take a value of x and compare this to the value of Y if X is forced to take the value of x + \u03b4. We rely on this on the distribution of P(y|X=do(x)).", "When there is no hidden variable and selection bias and when the causal structure is a known DAG, information on the interventional distribution can be obtained by using a set of inference rules known as \u201cdo-calculus\u201d developed by Pearl.", "In practice, the causal structure is rarely known. Nevertheless, it is possible to still have an estimation by considering the equivalence class of the true causal DAG and apply the do-calculus on each DAG within the equivalence. This gives us an approximation that can be useful.", "These ideas are incorporated in the IDA method (Intervention calculus when the DAG is absent).", "Idea: Machine learning algorithms have to go beyond predictions to truly assess cause-effect relationships and answer causal questions.", "This is essential for 3 main reasons:", "In this context, causal reasoning goes beyond prediction by modeling the outcome of interventions and formalizing counterfactual reasoning.", "The following graph provides a summary of the main tools and algorithms discussed in the article.", "[1] J. Pearl, The Seven Tools of Causal Inference, with Reflections on Machine Learning, Communications of the ACM, March 2019", "[4] M. Kalisch & al., Causal Inference Using Graphical Models with the R Package pcalg, Journal of Statistical Software, April 2012", "Note: This article aims to cover theoretical concepts as well as demonstrate practical hands-on examples given the information available online.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | AI Practitioner | Technical Writer | Speaker"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe869ca60e54d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://linafaik.medium.com/?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": ""}, {"url": "https://linafaik.medium.com/?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": "Lina Faik"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6c0e8e98c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&user=Lina+Faik&userId=b6c0e8e98c84&source=post_page-b6c0e8e98c84----e869ca60e54d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe869ca60e54d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe869ca60e54d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.biostat.jhsph.edu/courses/bio621/misc/Chocolate%20consumption%20cognitive%20function%20and%20nobel%20laurates%20(NEJM).pdf", "anchor_text": "full paper here"}, {"url": "https://cran.r-project.org/web/packages/pcalg/vignettes/pcalgDoc.pdf", "anchor_text": "R package pcalg"}, {"url": "https://cran.r-project.org/web/packages/pcalg/vignettes/pcalgDoc.pdf", "anchor_text": "R package pcalg"}, {"url": "https://www.r-bloggers.com/an-introduction-to-causal-inference/", "anchor_text": "An introduction to Causal inference"}, {"url": "https://kevinbinz.com/2014/04/09/causal-inference-with-pcalg/", "anchor_text": "Causal Inference with pcalg,"}, {"url": "http://project.org/web/packages/pcalg/vignettes/pcalgDoc.pdf", "anchor_text": "Causal Inference Using Graphical Models with the R Package pcalg"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e869ca60e54d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/causality?source=post_page-----e869ca60e54d---------------causality-----------------", "anchor_text": "Causality"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e869ca60e54d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/causal-inference?source=post_page-----e869ca60e54d---------------causal_inference-----------------", "anchor_text": "Causal Inference"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e869ca60e54d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe869ca60e54d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&user=Lina+Faik&userId=b6c0e8e98c84&source=-----e869ca60e54d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe869ca60e54d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&user=Lina+Faik&userId=b6c0e8e98c84&source=-----e869ca60e54d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe869ca60e54d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe869ca60e54d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e869ca60e54d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e869ca60e54d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e869ca60e54d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e869ca60e54d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e869ca60e54d--------------------------------", "anchor_text": ""}, {"url": "https://linafaik.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://linafaik.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lina Faik"}, {"url": "https://linafaik.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "822 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6c0e8e98c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&user=Lina+Faik&userId=b6c0e8e98c84&source=post_page-b6c0e8e98c84--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3f1d39620ab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-machine-learning-algorithms-include-better-causality-e869ca60e54d&newsletterV3=b6c0e8e98c84&newsletterV3Id=3f1d39620ab9&user=Lina+Faik&userId=b6c0e8e98c84&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}