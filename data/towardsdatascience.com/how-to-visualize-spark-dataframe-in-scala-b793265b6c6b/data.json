{"url": "https://towardsdatascience.com/how-to-visualize-spark-dataframe-in-scala-b793265b6c6b", "time": 1683007550.407255, "path": "towardsdatascience.com/how-to-visualize-spark-dataframe-in-scala-b793265b6c6b/", "webpage": {"metadata": {"title": "How To Visualize Spark DataFrames In Scala | by Chengzhi Zhao | Towards Data Science", "h1": "How To Visualize Spark DataFrames In Scala", "description": "Exploring open-source options for data visualization for Spark DataFrame in Scala, show how to use the frameworks include Almond, Vegas, and Plotly"}, "outgoing_paragraph_urls": [{"url": "https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset", "anchor_text": "show function", "paragraph_index": 2}, {"url": "https://almond.sh/docs/quick-start-install", "anchor_text": "Almond", "paragraph_index": 6}, {"url": "https://almond.sh/docs/quick-start-install", "anchor_text": "instruction", "paragraph_index": 6}, {"url": "https://github.com/Aivean", "anchor_text": "Aivean", "paragraph_index": 7}, {"url": "https://github.com/almond-sh/almond/issues/180", "anchor_text": "function", "paragraph_index": 7}, {"url": "https://www.vegas-viz.org", "anchor_text": "Vegas", "paragraph_index": 8}, {"url": "https://www.vegas-viz.org", "anchor_text": "Vegas", "paragraph_index": 11}, {"url": "https://github.com/alexarchambault/plotly-scala", "anchor_text": "Plotly", "paragraph_index": 11}, {"url": "https://github.com/alexarchambault/plotly-scala", "anchor_text": "plotly-scala", "paragraph_index": 12}, {"url": "https://chengzhizhao.medium.com/subscribe", "anchor_text": "subscribe to my new articles", "paragraph_index": 17}, {"url": "https://chengzhizhao.medium.com/membership", "anchor_text": "referred Medium member", "paragraph_index": 17}, {"url": "https://www.linkedin.com/in/chengzhizhao/", "anchor_text": "Linkedin", "paragraph_index": 18}, {"url": "https://twitter.com/ChengzhiZhao", "anchor_text": "Twitter", "paragraph_index": 18}, {"url": "http://chengzhizhao.com", "anchor_text": "chengzhizhao.com", "paragraph_index": 20}], "all_paragraphs": ["Visualization of a dataset is a compelling way to explore data and delivers meaningful information to the end-users. With Spark DataFrame, data processing on a large scale has never been more natural than current stacks. For people who write code in Python, there are many visualization options to choose; data visualization may not be a concern with PySpark engineers. However, for people writing Spark in Scala, there are not numerous open-source options available.", "For Spark In Scala DataFrame visualization, if you search \u201cSpark In Scala DataFrame Visualization\u201d on Google, a list of options ties strictly to vendors or commercial solutions. If you are using Databricks, the functiondisplay is handy. If you are using HDInsight Spark, a build-in visualization is available. If you are using Zeppelin (open-source), the visualization button is possible to make it easy. However, if you don\u2019t have any of the environment mentioned above, and you still want to use open-source like Jupyter Notebook, data visualization is not a mission impossible here. Fortunately, there are customized functions, and libraries can make this process simple. In this article, we are going to explore a better visualization experience for ONLY Scala.", "In Spark, a simple visualization in the console is the show function. The show function displays a few records (default is 20 rows) from DataFrame into a tabular form. The default behavior of the show function is truncate enabled, which won\u2019t display a value if it\u2019s longer than 20 characters. In this way, you might have everything display about right. Sometimes you may want to disable the truncate to view more content in a cell. Then your data showed probably would be messy as it won\u2019t line up, and it becomes tough to read.", "The following example we have a column called extremely_long_str , which we set it on purpose to observe the behavior of the extended content within a cell. In this case, the show function won\u2019t format nicely.", "Once you executed the following code, it displays the following lines. We could recognize that one extra-long record which doesn\u2019t fit into one row. If you have several hundreds of lines, it becomes difficult to read since the context within a cell breaks into multiple lines. As the turncate is off, the long context breaks the well-formatted show function. You may notice it becomes disturbing to read, and it is even more troublesome if you have multiple columns layout like this.", "In Jupyter notebook, to fix the alignment issue. We can apply HTML to display the content instead of using the show function. HTML would be much flexible here, and it can manage the cells merging so it would display more beautiful in multiple lines, and the output here is more comfortable to read.", "To get this work, all you need is to install a Jupyter Notebook kernel, which is call Almond (A Scala kernel for Jupyter), and implement a customized function. To install the Almond kernel in Jupyter Notebook, you can follow the instruction.", "Aivean posted a useful function on Github for this, and once you add the helper function, you can calldf.showHTML(10, 300) function, which generated an HTML code block wrap with the DataFrame result, and displays ten rows with 300 characters per cell. It looks much better now in Jupyter Notebook as the image shown above. The function to add looks like the following:", "Vegas is a Scala API for declarative, statistical data visualizations. It integrated well with Scala as well as the modern data framework such as Apache Spark and Apache Flink. Since Vegas is declarative, all we need to do is define data sources and pass arguments on how to display the plots without explicitly write down more extra codes.", "First, you\u2019d need to add the following two dependencies", "Since we have a Spark DataFrame we have defined earlier, we can reuse it. Once you have the DataFrame defined, the rest is to point withDataFrame to the Spark DataFrame, so Vegas knows how to parse the Spark DataFrame as your data source. To present a chart beautifully, you may want to sort the x-axis, otherwise the plot sorts and displays by language name, which is the default behavior.", "Vegas is an extraordinary library to use, and it works seamlessly with Scala and Spark. Although the plot in Vegas looks cool, you might not only limit yourself to only one visualization option. Also, you may want to have a more interactive mode with the chart. Plotly might be the right choice here. Plotly is another remarkable data visualization framework, and it gains popularity in Python and JavaScript already. To get Plotly work with Scala and Spark, we\u2019d need to reshape our data more due to Plotly currently doesn\u2019t support Spark DataFrame directly.", "First, you\u2019d need to install plotly-scala for Jupyter lab", "Then you\u2019d need to change DataFrame to RDD and collect to force data collection to the driver node. To avoid receiving too much data to the driver, before collecting data on Spark driver, you\u2019d need to filter or aggregated your dataset close to the final result and don\u2019t rely on visualization framework to perform data transformations.", "A more refined feature in Plotly is its charts are more interactive than the ones created by Vegas. You can hover on the bar chart and see the value of the data, or choose options on the top right like zoom in/out to fit your requirements.", "Although there are a few data visualization options in Scala, it is still possible to build impressive and creative charts to communicate information via data. For people who write code in Scala for Spark, with additional transformations, we can still leverage some open-source libraries to visualize data in Scala. I hope this article can introduce some ideas on how to visualize Spark DataFrame in Scala to help you get a better visualization experience for Scala.", "I hope this story is helpful to you. This article is part of a series of my engineering & data science stories that currently consist of the following:", "You can also subscribe to my new articles or become a referred Medium member who gets unlimited access to all the stories on Medium.", "In case of questions/comments, do not hesitate to write in the comments of this story or reach me directly through Linkedin or Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer | Data Content Creator | Contributor of Airflow, Flink | Blog chengzhizhao.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb793265b6c6b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://chengzhizhao.medium.com/?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": ""}, {"url": "https://chengzhizhao.medium.com/?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "Chengzhi Zhao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff956c63a9571&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&user=Chengzhi+Zhao&userId=f956c63a9571&source=post_page-f956c63a9571----b793265b6c6b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb793265b6c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb793265b6c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.Dataset", "anchor_text": "show function"}, {"url": "https://almond.sh/docs/quick-start-install", "anchor_text": "Almond"}, {"url": "https://almond.sh/docs/quick-start-install", "anchor_text": "instruction"}, {"url": "https://github.com/Aivean", "anchor_text": "Aivean"}, {"url": "https://github.com/almond-sh/almond/issues/180", "anchor_text": "function"}, {"url": "https://www.vegas-viz.org", "anchor_text": "Vegas"}, {"url": "https://www.vegas-viz.org", "anchor_text": "Vegas"}, {"url": "https://github.com/alexarchambault/plotly-scala", "anchor_text": "Plotly"}, {"url": "https://github.com/alexarchambault/plotly-scala", "anchor_text": "plotly-scala"}, {"url": "https://chengzhizhao.medium.com/?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "Chengzhi Zhao"}, {"url": "https://chengzhizhao.medium.com/list/data-engineering-data-science-stories-ddab37f718e7?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "View list"}, {"url": "https://chengzhizhao.medium.com/subscribe", "anchor_text": "subscribe to my new articles"}, {"url": "https://chengzhizhao.medium.com/membership", "anchor_text": "referred Medium member"}, {"url": "https://www.linkedin.com/in/chengzhizhao/", "anchor_text": "Linkedin"}, {"url": "https://twitter.com/ChengzhiZhao", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b793265b6c6b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----b793265b6c6b---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/scala?source=post_page-----b793265b6c6b---------------scala-----------------", "anchor_text": "Scala"}, {"url": "https://medium.com/tag/programming?source=post_page-----b793265b6c6b---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/spark?source=post_page-----b793265b6c6b---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb793265b6c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&user=Chengzhi+Zhao&userId=f956c63a9571&source=-----b793265b6c6b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb793265b6c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&user=Chengzhi+Zhao&userId=f956c63a9571&source=-----b793265b6c6b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb793265b6c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb793265b6c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b793265b6c6b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b793265b6c6b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b793265b6c6b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b793265b6c6b--------------------------------", "anchor_text": ""}, {"url": "https://chengzhizhao.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://chengzhizhao.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chengzhi Zhao"}, {"url": "https://chengzhizhao.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "598 Followers"}, {"url": "http://chengzhizhao.com", "anchor_text": "chengzhizhao.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff956c63a9571&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&user=Chengzhi+Zhao&userId=f956c63a9571&source=post_page-f956c63a9571--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fad43d9b589c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-visualize-spark-dataframe-in-scala-b793265b6c6b&newsletterV3=f956c63a9571&newsletterV3Id=ad43d9b589c&user=Chengzhi+Zhao&userId=f956c63a9571&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}