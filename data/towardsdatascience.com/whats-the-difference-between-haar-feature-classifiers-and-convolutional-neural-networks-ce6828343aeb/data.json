{"url": "https://towardsdatascience.com/whats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb", "time": 1682993559.118428, "path": "towardsdatascience.com/whats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb/", "webpage": {"metadata": {"title": "What\u2019s the Difference Between Haar-Feature Classifiers and Convolutional Neural Networks? | by Chi-Feng Wang | Towards Data Science", "h1": "What\u2019s the Difference Between Haar-Feature Classifiers and Convolutional Neural Networks?", "description": "I see it all the time: \u201cHaar-feature based cascade classifiers\u201d, \u201cHaar-like features first proposed by Viola and Jones\u201d\u2026but what exactly is a Haar-like feature? And how is it related to Convolutional\u2026"}, "outgoing_paragraph_urls": [{"url": "http://setosa.io/ev/image-kernels/", "anchor_text": "kernel in CNN", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/what-is-a-neural-network-6010edabde2b", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/oarriaga/face_classification", "anchor_text": "this model", "paragraph_index": 8}, {"url": "https://github.com/ipazc/mtcnn", "anchor_text": "MTCNN face recognition system", "paragraph_index": 10}], "all_paragraphs": ["I see it all the time: \u201cHaar-feature based cascade classifiers\u201d, \u201cHaar-like features first proposed by Viola and Jones\u201d\u2026but what exactly is a Haar-like feature? And how is it related to Convolutional Neural Networks?", "A Haar-Feature is just like a kernel in CNN, except that in a CNN, the values of the kernel are determined by training, while a Haar-Feature is manually determined.", "Here are some Haar-Features. The first two are \u201cedge features\u201d, used to detect edges. The third is a \u201cline feature\u201d, while the fourth is a \u201cfour rectangle feature\u201d, most likely used to detected a slanted line.", "Numerically, they might look something like this:", "As explained here, each the 3x3 kernel moves across the image and does matrix multiplication with every 3x3 part of the image, emphasizing some features and smoothing others.", "Haar-Features are good at detecting edges and lines. This makes it especial effective in face detection. For example, in a small image of Beyonce, this Haar-feature would be able to detect her eye (an area that is dark on top and brighter underneath).", "However, because Haar Features have to be determined manually, there is a certain limit to the types of things it can detect. If you give classifier (a network, or any algorithm that detects faces) edge and line features, then it will only be able to detect objects with clear edges and lines. Even as a face detector, if we manipulate the face a bit (say, cover up the eyes with sunglasses, or tilt the head to a side), a Haar-based classifier may not be able to recognize the face. A convolutional kernel, on the other hand, has a higher degree of freedom (since it\u2019s determined by training), and could be able to recognize partially covered faces (depending on the quality of the training data).", "On the plus side, because we don\u2019t need to train Haar-Features, we can create a classifier with a relatively small dataset. All we have to do is train the weightings for each feature (i.e. which Haar-feature should be used more?) which allows us to train the classifier well without a lot of training images. In addition, it also has a higher execution speed, as Haar-based classifiers typically involve less computations.", "What triggered this small investigation into Haar-based classifiers is this model that recognizes emotions. Last year, at a fair, I came across a emotion recognition system. However, it didn\u2019t use neural networks. I was curious if I could find a emotion recognition algorithm based completely on CNNs.", "Taking a brief look into this model, I saw that it used OpenCV\u2019s Haar-based cascade classifier to detect faces. After finding faces, the team then trained their own CNN to recognize the emotion on the face.", "Because it used a Haar-based classifier, I couldn\u2019t really call it an algorithm based completely on convolutional neural networks. What if I switched out the Haar-based classifier for the MTCNN face recognition system?", "Originally, it loaded a Haar-based classifier. I switched it out for an MTCNN detector:", "Then, I did a little data processing, since their Haar-based classifier output returns a square bounding box as a 2-dimensional array while the MTCNN model output returns a rectangular bounding box in a dictionary.", "As I was altering the output and debugging I kept both the Haar-based classifier and the MTCNN detector running (to compare their outputs). Funnily enough, it seemed as if my computer couldn\u2019t sustain such a larger computational amount: the program kept on crashing.", "Finally, I ran the program, now running with MTCNN and not the Haar-based classifier. Here are a few observations:", "All these observations were in accordance to what I had found: while well-trained CNNs could learn more parameters (and thus detect a larger variety of faces), Haar-based classifiers run faster. Depending on your task, one may be a better fit than the other.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Student at UC Berkeley; Machine Learning Enthusiast"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fce6828343aeb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@reina.wang?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@reina.wang?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": "Chi-Feng Wang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ddaaec52a09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&user=Chi-Feng+Wang&userId=9ddaaec52a09&source=post_page-9ddaaec52a09----ce6828343aeb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fce6828343aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fce6828343aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://setosa.io/ev/image-kernels/", "anchor_text": "kernel in CNN"}, {"url": "https://commons.wikimedia.org/wiki/File:VJ_featureTypes.svg", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/what-is-a-neural-network-6010edabde2b", "anchor_text": "here"}, {"url": "https://commons.wikimedia.org/wiki/File:Ms._magazine_Cover_-_Spring_2013_(cropped).jpg", "anchor_text": "Source"}, {"url": "https://github.com/oarriaga/face_classification", "anchor_text": "this model"}, {"url": "https://github.com/ipazc/mtcnn", "anchor_text": "MTCNN face recognition system"}, {"url": "https://github.com/ipazc/mtcnn", "anchor_text": "https://github.com/ipazc/mtcnn"}, {"url": "https://github.com/oarriaga/face_classification", "anchor_text": "https://github.com/oarriaga/face_classification"}, {"url": "https://drive.google.com/file/d/1dqyLeqV8uftIeal687X3sx5ChT1_TCTG/view?usp=sharing", "anchor_text": "https://drive.google.com/file/d/1dqyLeqV8uftIeal687X3sx5ChT1_TCTG/view?usp=sharing"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ce6828343aeb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----ce6828343aeb---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/opencv?source=post_page-----ce6828343aeb---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/emotion-recognition?source=post_page-----ce6828343aeb---------------emotion_recognition-----------------", "anchor_text": "Emotion Recognition"}, {"url": "https://medium.com/tag/haar-features?source=post_page-----ce6828343aeb---------------haar_features-----------------", "anchor_text": "Haar Features"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fce6828343aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&user=Chi-Feng+Wang&userId=9ddaaec52a09&source=-----ce6828343aeb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fce6828343aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&user=Chi-Feng+Wang&userId=9ddaaec52a09&source=-----ce6828343aeb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fce6828343aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fce6828343aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ce6828343aeb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ce6828343aeb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ce6828343aeb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ce6828343aeb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ce6828343aeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@reina.wang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@reina.wang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chi-Feng Wang"}, {"url": "https://medium.com/@reina.wang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ddaaec52a09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&user=Chi-Feng+Wang&userId=9ddaaec52a09&source=post_page-9ddaaec52a09--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F827df2c647b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-the-difference-between-haar-feature-classifiers-and-convolutional-neural-networks-ce6828343aeb&newsletterV3=9ddaaec52a09&newsletterV3Id=827df2c647b&user=Chi-Feng+Wang&userId=9ddaaec52a09&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}