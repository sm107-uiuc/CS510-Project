{"url": "https://towardsdatascience.com/diagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd", "time": 1683002789.2647948, "path": "towardsdatascience.com/diagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd/", "webpage": {"metadata": {"title": "Diagnostic for Heart Disease with Machine Learning | by Steven Smiley | Towards Data Science", "h1": "Diagnostic for Heart Disease with Machine Learning", "description": "According to the Centers for Disease Control and Prevention (CDC),\u00b9 Heart disease is the number one cause of death for men, women, and people of most racial and ethnic groups in the United States.\u00b2\u2026"}, "outgoing_paragraph_urls": [{"url": "https://nbviewer.jupyter.org/github/stevensmiley1989/Cleveland_Dataset/blob/master/Cleveland.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 1}, {"url": "http://www.randalolson.com/", "anchor_text": "Randal S. Olson", "paragraph_index": 3}, {"url": "https://arxiv.org/abs/1708.05070", "anchor_text": "\u201cData-driven Advice for Applying Machine Learning to Bioinformatics Problems\u201d", "paragraph_index": 3}, {"url": "https://arxiv.org/abs/1708.05070", "anchor_text": "Table 2", "paragraph_index": 4}, {"url": "https://nbviewer.jupyter.org/github/stevensmiley1989/Cleveland_Dataset/blob/master/Cleveland.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 19}, {"url": "https://www.linkedin.com/in/stevensmiley1989/", "anchor_text": "https://www.linkedin.com/in/stevensmiley1989/", "paragraph_index": 32}], "all_paragraphs": ["According to the Centers for Disease Control and Prevention (CDC),\u00b9 Heart disease is the number one cause of death for men, women, and people of most racial and ethnic groups in the United States.\u00b2 More than one person dies every minute and nearly half a million die each year in the United States from it, costing billions of dollars annually.\u00b3 \u2074 Therefore, the purpose of this story is to investigate different potential supervised Machine Learning (ML) algorithms for creating diagnostic heart disease models.", "In order to conduct this analysis, a Jupyter notebook was constructed in Python using the publicly available Cleveland dataset for heart disease, which has over 300 unique instances with 76 total attributes.\u2075 \u2076 \u2077 \u2078 \u2079 From these 76 total attributes, only 14 of them are commonly used for research to this date. In addition, the hyperparameters used in this analysis come from the recommendations by Dr. Olson, \u201cData-driven advice for applying machine learning to bioinformatics problems.\u201d\u00b9\u2070 The libraries and coding packages used in this analysis are: SciPy\u00b9\u00b9, Python\u00b9\u00b2, NumPy\u00b9\u00b3, IPython\u00b9\u2074, Matplotlib\u00b9\u2075, Pandas\u00b9\u2076, Scikit-Learn\u00b9\u2077, and Scikit-Image.\u00b9\u2078", "Experiments with the Cleveland database have concentrated on simply attempting to distinguish the presence of Heart Disease from absence. The 14 attributes used:", "A recent publication by Randal S. Olson, et al. in 2017 provides insightful best practice advice for solving bioinformatic problems with machine learning, \u201cData-driven Advice for Applying Machine Learning to Bioinformatics Problems\u201d.", "Looking at the abstract briefly, they analyzed \u201c13 state-of-the-art, commonly used machine learning algorithms on a set of 165 publicly available classification problems in order to provide data-driven algorithm recommendations to current researchers.\u201d Interesting enough, this dataset was not included in their analysis from Table 2 of their paper. This makes it a good candidate for experimentation because it is a binary classification problem in bioinformatics using ML.", "From their research, they were able to provide a \u201crecommendation of five algorithms with hyperparameters that maximize classifier performance across the tested problems, as well as general guidelines for applying machine learning to supervised classification problems.\u201d These recommendations are summarized below as follows:", "Changed the diagnosis column values to between 0 or 1 for binary classification.", "Inspected the information about the data to understand its type.", "There were two features that contained object values:", "Out of these two features, there was a unique value of ? indicating a missing value. This was found from the following:", "There were only 4 and 2 counts respectively for each. This is assumed not to be a significant number of instances and thus these instances are removed as follows:", "In addition, missing values were also checked by using the following:", "At this point, there are no missing values.", "Some of the categorical values as described above have ONLY A FEW unique values. It is good practice to use Categorical Encoding for these so that the ML algorithms do not overfit to unique values. Making these into binary allows the ML algorithms to process the data in a less biased manner without losing any of the information.", "Next, a histogram of the Cleveland dataset, after cleaning and feature engineering, is made in Figure 0. There are some obvious relationships from this figure and the outcome of Heart Disease.", "For example, looking at the subplot of Age in the top left, after around age 60, the number of people with Heart Disease nearly doubled relative to No Disease at that age. In addition, looking at the subplot of Sex, it is obvious that men (value = 1) have a higher number of Heart Disease than women (value=0). There are many more relationships, but the point is that the relationships are present and strong. Thus, the ML algorithms should pick up on these for making a diagnostic.", "It is important to scale the data so the ML algorithms do not overfit to the wrong features. Using the MinMaxScaler() , the values are scaled per feature based on the minimum and maximum between 0 and 1. This keeps the information from being lost but allows the ML algorithms to correctly train with the data.", "A strong correlation is indicated by a Pearson Correlation Coefficient value near 1. Therefore, when looking at the Heatmap, Figure 1, values that correlate most with the first column, \u201cdiagnosis,\u201d will be important for training the ML algorithms. Values near 1 between other features are not ideal because the information is already present for the ML algorithms to train with. This is called multicollinearity in statistics. It appears that the features of Major Vessels F. Colored: 0 and Thalassemia:normal have the strongest correlation with diagnosis at a Pearson Correlation Coefficient of 0.24. This is not a great correlation, so it is unlikely the ML models will have the accuracy desired for a Heart Disease diagnostic, but that doesn\u2019t inhibit a valid model for a diagnostic since that is based on the Area Under the Curve (AUC) from the Receiver Operating Characteristic (ROC) curves.", "The Data was split into 80% training (237 people) and 20% testing (60 people) after dropping 6 instances with missing values. This is a general rule of thumb for splitting data to train ML algorithms with.", "In order to find a good model, several algorithms are tested on the training dataset. A sensitivity study using different hyperparameters of the algorithms are iterated on with GridSearchCV in order optimize each model. The best model is the one that has the highest accuracy without overfitting by looking at both the training data and the validation data results. Computer time does not appear to be an issue for these models, so it has little weight on deciding between models. Please see the Jupyter notebook for the code and details.", "The models were evaluated through k-fold Cross-Validation with k-fold = 10 using GridSearchCV, which iterates on different algorithm\u2019s hyperparameters. A few new hyperparameters were tested as well as an additional algorithm not included in Dr. Olson\u2019s analysis. The new algorithm is a neural network, Multilayer Perceptron (MLPClassifier).", "Looking at the Confusion Matrix Plots", "When it comes to diagnosing heart disease, we want to make sure we don\u2019t have too many false-positives (you don\u2019t have heart disease, but told you do and get treatment) or false-negatives (you have heart disease, but told you don\u2019t and don\u2019t get treatment). Therefore, the highest overall accuracy model is chosen (the accuracy is the sum of the diagonals on the confusion matrix divided by the total). You can see that all of the models had less than a couple of handfuls of false-positives and false-negatives, meaning they were all fairly accurate since there were 60 observations for the test set.", "Looking at the Variable Importance Plots", "Most of the ensemble models have a parameter called predict_proba, which allows the output of the most significant features of the model based on their probability through majority vote via either the gini index or entropy. These top 5 variables showed up in all of these Variable Importance Plots:", "It is not a surprise that these same variables also show a high correlation with diagnosis in the Heatmap from Figure 1. Thus, it makes sense why these variables turned out so important.", "Looking at Receiver Operating Characteristic (ROC) Curves", "All of the model\u2019s Receiver Operating Characteristic (ROC) curves had Excellent Area Under the Curves (AUC) because their values were greater than 90% (really close to 95% for all), meaning they all would serve as excellent diagnostics. This is also shown by their high Specificity and Sensitivity values.", "All of the models performed well after fine tuning their hyperparameters, but the best model is the one with the highest overall accuracy.", "In this analysis, Support Vector Machine (SVM) and Multilayer Perceptron Classifier (MLP) tied for the highest overall accuracy, 91.7% (see Table 7 below). However, the SVM had a higher AUC, 96.8%, over MLP,which had an AUC, 93.6%. This means SVM is the better diagnostic model in this case, but does not mean SVM is the best model in all cases. All this means is that for the given test set, this model performed the best. Out of the 20% of data witheld in this test (60 random individuals), only a couple handfuls were misdiagnosed from all models. No model is perfect, but these results are promising. If on average less than a couple handful of people out of the test set are misdiagnosed with such accuracy and precision, this is a good start. Obviously the future aim is to find better metrics for training and testing an ML algorithm or just more data.", "The key here is that a diagnostic for Heart Disease is possible due to such high Area Under the Curves (AUC) for the Receiver Operating Characteristic (ROC) curves. All values were greater than 90%, making excellent diagnostics.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Machine Learning Engineer who also enjoys writing about Data Science, CV, DL, ML, AI, Python https://www.linkedin.com/in/stevensmiley1989/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F81b064a3c1dd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://stevensmiley1989.medium.com/?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": ""}, {"url": "https://stevensmiley1989.medium.com/?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": "Steven Smiley"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb3b698e2f8f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&user=Steven+Smiley&userId=b3b698e2f8f1&source=post_page-b3b698e2f8f1----81b064a3c1dd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81b064a3c1dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81b064a3c1dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://nbviewer.jupyter.org/github/stevensmiley1989/Cleveland_Dataset/blob/master/Cleveland.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "http://www.randalolson.com/", "anchor_text": "Randal S. Olson"}, {"url": "https://arxiv.org/abs/1708.05070", "anchor_text": "\u201cData-driven Advice for Applying Machine Learning to Bioinformatics Problems\u201d"}, {"url": "https://arxiv.org/abs/1708.05070", "anchor_text": "Table 2"}, {"url": "https://nbviewer.jupyter.org/github/stevensmiley1989/Cleveland_Dataset/blob/master/Cleveland.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://www.cdc.gov/nchs/data/nvsr/nvsr68/nvsr68_06-508.pdf", "anchor_text": "Deaths: Leading causes for 2017"}, {"url": "https://www.cdc.gov/nchs/data/databriefs/db103.pdf", "anchor_text": "Prevalence of uncontrolled risk factors for cardiovascular disease: United States, 1999\u20132010"}, {"url": "http://archive.ics.uci.edu/ml", "anchor_text": "http://archive.ics.uci.edu/ml"}, {"url": "https://archive.ics.uci.edu/ml/datasets/heart+Disease", "anchor_text": "Andras Janosi, M.D."}, {"url": "https://archive.ics.uci.edu/ml/datasets/heart+Disease", "anchor_text": "William Steinbrunn, M.D."}, {"url": "https://archive.ics.uci.edu/ml/datasets/heart+Disease", "anchor_text": "Matthias Pfisterer, M.D."}, {"url": "https://archive.ics.uci.edu/ml/datasets/heart+Disease", "anchor_text": "Robert Detrano, M.D., Ph.D."}, {"url": "https://arxiv.org/abs/1708.05070", "anchor_text": "\u201cData-driven advice for applying machine learning to bioinformatics problems."}, {"url": "https://scipy.org", "anchor_text": "SciPy."}, {"url": "https://www.python.org", "anchor_text": "Python."}, {"url": "https://numpy.org", "anchor_text": "NumPy."}, {"url": "https://ipython.org", "anchor_text": "IPython."}, {"url": "https://matplotlib.org", "anchor_text": "Matplotlib."}, {"url": "https://pandas.pydata.org", "anchor_text": "Pandas."}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Scikit-Learn."}, {"url": "https://scikit-image.org", "anchor_text": "Scikit-Image."}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----81b064a3c1dd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----81b064a3c1dd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----81b064a3c1dd---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/visualization?source=post_page-----81b064a3c1dd---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/ai?source=post_page-----81b064a3c1dd---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F81b064a3c1dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&user=Steven+Smiley&userId=b3b698e2f8f1&source=-----81b064a3c1dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F81b064a3c1dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&user=Steven+Smiley&userId=b3b698e2f8f1&source=-----81b064a3c1dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81b064a3c1dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F81b064a3c1dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----81b064a3c1dd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----81b064a3c1dd--------------------------------", "anchor_text": ""}, {"url": "https://stevensmiley1989.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://stevensmiley1989.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Steven Smiley"}, {"url": "https://stevensmiley1989.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "https://www.linkedin.com/in/stevensmiley1989/", "anchor_text": "https://www.linkedin.com/in/stevensmiley1989/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb3b698e2f8f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&user=Steven+Smiley&userId=b3b698e2f8f1&source=post_page-b3b698e2f8f1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3f1b6dda42f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdiagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd&newsletterV3=b3b698e2f8f1&newsletterV3Id=3f1b6dda42f9&user=Steven+Smiley&userId=b3b698e2f8f1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}