{"url": "https://towardsdatascience.com/how-to-build-a-neural-network-for-voice-classification-5e2810fe1efa", "time": 1683008054.4459531, "path": "towardsdatascience.com/how-to-build-a-neural-network-for-voice-classification-5e2810fe1efa/", "webpage": {"metadata": {"title": "How to build a Neural Network for Voice Classification | by Jurgen Arias | Towards Data Science", "h1": "How to build a Neural Network for Voice Classification", "description": "Wouldn\u2019t it be great to be able to have transcriptions of our Zoom meetings telling us in plain text who said what during the meeting? This project was born from the idea of transcribing meetings\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.openslr.org/12/", "anchor_text": "OpenSLR", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/.DS_Store", "anchor_text": "\u2018.DS_Store\u2019", "paragraph_index": 7}, {"url": "https://librosa.github.io/librosa/0.6.0/feature.html", "anchor_text": "ibrosa feature extraction", "paragraph_index": 12}, {"url": "https://github.com/jurgenarias/Portfolio/blob/master/Blogs/Code/Voice_Classification_full_code_for_blogpost.ipynb", "anchor_text": "jupyter notebook", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/voice-classification-with-neural-networks-ff90f94358ec", "anchor_text": "here", "paragraph_index": 28}, {"url": "https://medium.com/@patrickbfuller/librosa-a-python-audio-libary-60014eeaccfb", "anchor_text": "Librosa: A Python Audio Library (2019)", "paragraph_index": 29}, {"url": "https://www.hindawi.com/journals/sp/2019/7213717/", "anchor_text": "DGR: Gender Recognition of Human Speech Using One-Dimensional Conventional Neural Network", "paragraph_index": 30}, {"url": "http://www.primaryobjects.com/2016/06/22/identifying-the-gender-of-a-voice-using-machine-learning/", "anchor_text": "Identifying the Gender of a Voice using Machine Learning", "paragraph_index": 31}, {"url": "https://medium.com/@CVxTz?source=post_page-----b0a4fce8f6c----------------------", "anchor_text": "Youness Mansar", "paragraph_index": 32}, {"url": "https://medium.com/@CVxTz/audio-classification-a-convolutional-neural-network-approach-b0a4fce8f6c", "anchor_text": "Audio Classification : A Convolutional Neural Network Approach", "paragraph_index": 32}, {"url": "https://www.analyticsvidhya.com/blog/author/jalfaizy/", "anchor_text": "Faizan Shaik", "paragraph_index": 33}, {"url": "https://www.analyticsvidhya.com/blog/2017/08/audio-voice-processing-deep-learning/", "anchor_text": "Getting Started with Audio Data Analysis using Deep Learning (with case study)", "paragraph_index": 33}, {"url": "https://upcommons.upc.edu/bitstream/handle/2117/86673/113166.pdf", "anchor_text": "Voice gender identification using deep neural networks running on FPGA", "paragraph_index": 34}, {"url": "https://www.endpoint.com/team/kamil_ciemniewski", "anchor_text": "Kamil Ciemniewski", "paragraph_index": 35}, {"url": "https://www.endpoint.com/blog/2019/01/08/speech-recognition-with-tensorflow", "anchor_text": "Speech Recognition from scratch using Dilated Convolutions and CTC in TensorFlow", "paragraph_index": 35}, {"url": "https://towardsdatascience.com/@admond1994?source=post_page-----81d0fe3cea9a----------------------", "anchor_text": "Admond Lee", "paragraph_index": 36}, {"url": "https://towardsdatascience.com/how-to-build-a-speech-recognition-bot-with-python-81d0fe3cea9a", "anchor_text": "How To Build A Speech Recognition Bot With Python", "paragraph_index": 36}, {"url": "https://medium.com/@adrianitsaxu?source=post_page-----486e92785df4----------------------", "anchor_text": "Adrian Yijie Xu", "paragraph_index": 37}, {"url": "https://medium.com/gradientcrescent/urban-sound-classification-using-convolutional-neural-networks-with-keras-theory-and-486e92785df4", "anchor_text": "Urban Sound Classification using Convolutional Neural Networks with Keras: Theory and Implementation", "paragraph_index": 37}], "all_paragraphs": ["Wouldn\u2019t it be great to be able to have transcriptions of our Zoom meetings telling us in plain text who said what during the meeting? This project was born from the idea of transcribing meetings telling you what each person said. We have many transcribing tools for speech to text but not many for identifying each speaker. For this, we will build a python voice classifier from scratch with all the code included here.", "First, as always, we need data. This data comes from OpenSLR. We will use 30 different speakers and 4 samples per speaker for our training data, giving us 120 samples. The samples average 15 seconds each thus about one minute per speaker for training. 30 speakers is a good amount of people for our problem statement; and as I have conducted this project already, I can assert that one minute is good enough to give us good results.", "In addition to the 120 samples for training, we also need validation and testing data. We will validate on 3 samples and test on 3 samples. Since we have 30 speakers, we will need 90 samples for validation and 90 samples for testing. Therefore, we will need 10 voice clips from each speaker.", "To summarize the samples, we will use 120 voice clips for the training data, 90 voice clips for validation data, and 90 voice clips for testing data for a total of 300 voice clips.", "Once we have our voice clips in three different folders for training, validation and testing, we can create our pandas dataframes. We need to import os so that we can create a dataframe from the files in our folders (I am working on a mac, for other operating systems, the process might be a little different). My folder for training is called 30_speakers_train.", "This will create a dataframe for my training data. It is very important to check the size of our dataframe, in order to make sure that it matches the number of files in our folder.", "Let us name the file column as \u2018file\u2019.", "Sometimes a \u2018.DS_Store\u2019 file is created and we have to find and drop that specific file in order to continue. After that we would need to reset the index of our dataframe. Here is an example of that:", "Now, we need to identify each speaker. In my file names, the first set of numbers is the speaker ID thus I wrote a little code to create a column with that ID.", "Our dataframe should look like this:", "We do the same for the validation and testing files and get three different dataframes.", "Now that we have the dataframes, we need to write a function to extract the audio properties of each audio file. For this we use librosa which is a great python library for audio manipulation. We need to pip install librosa and import librosa. The following is the function that parses through every file in our folder and extracts 5 numerical features from each file, namely the mfccs, chroma, mel, contrast and tonnetz.", "Each mfcc is an array of length 40, chroma is 12, mel is 128, contrast is 7 and tonnetz is 6. Overall we have 193 numerical features for each voice clip from the audio features we have chosen. Feel free to try different ones if you would like from: librosa feature extraction. We apply the function to each single audio file and store that information. Note that this does take some minutes and it might even take hours depending on how much data you are using and your computing power.", "Now we concatenate all those numerical features for each file so that we have a single array of 193 numbers for each file to feed into our neural network.", "Now we can set our X_train to be the numpy array of our features:", "Similarly, we do the same steps from above from the very beginning for our validation and test data. We should get an X_val and X_test.", "Now, we are done with our X data. For Y, we need the speakers\u2019 IDs. Remember we are doing supervised learning so we need the target data. We have that from our original dataframes, therefore we just get those values.", "We need to hot encode y in order to be able to use it for our neural network. You will need to import LabelEncoder from sklearn and to_categorical from keras which uses Tensorflow.", "Now we need to scale our X:", "And finally, we are ready for the fun part: building the neural network! We will use a simple feed forward neural network. The input will be our 193 features. I played around with the dropout rates but you can change those values if you would like. Using relu is pretty standard. The output is softmax since we have 30 different classes and we use categorical crossentropy because of the different classes.", "Now we fit the model with the training and validation data:", "This is some code to see a graph of the training and validation accuracy:", "It should look something like this:", "It looks like we got some good accuracy! Let\u2019s check the values with our test data. We can generate predictions with the results of our neural network and compare them to the actual values.", "Now our test data dataframe should look like this:", "You should get something like this:", "98.9% correct predictions! I had to run the neural network four times to finally get one of the predictions wrong. In the previous three runs, the neural network got all predictions right but I wanted to show how to find a wrong prediction. Thus with one minute of training audio, the neural network is near perfect for 30 speakers!", "This proves how powerful a simple neural network is! I hope it was helpful!", "Here is a link to my jupyter notebook with all the code. I also did this and similar projects using Convolutional Neural Networks (CNN), you can see my other post explaining that process here in case you are interested.", "[1] David Kaspar, Alexander Bailey, Patrick Fuller, Librosa: A Python Audio Library (2019)", "[2] Rami S. Alkhawaldeh, DGR: Gender Recognition of Human Speech Using One-Dimensional Conventional Neural Network (2019)", "[3] Kory Becker, Identifying the Gender of a Voice using Machine Learning (2016)", "[5] Youness Mansar, Audio Classification : A Convolutional Neural Network Approach (2018)", "[6] Faizan Shaikh, Getting Started with Audio Data Analysis using Deep Learning (with case study) (2017)", "[9] Marc Palet Gual, Voice gender identification using deep neural networks running on FPGA, (2016)", "[10] Kamil Ciemniewski, Speech Recognition from scratch using Dilated Convolutions and CTC in TensorFlow, (2019)", "[11] Admond Lee, How To Build A Speech Recognition Bot With Python (2019)", "[12] Adrian Yijie Xu, Urban Sound Classification using Convolutional Neural Networks with Keras: Theory and Implementation, (2019)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5e2810fe1efa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jurgenarias?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jurgenarias?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": "Jurgen Arias"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f9078a89846&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&user=Jurgen+Arias&userId=5f9078a89846&source=post_page-5f9078a89846----5e2810fe1efa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e2810fe1efa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e2810fe1efa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://stock.adobe.com/search?k=neural&search_type=default-asset-click&asset_id=281653938", "anchor_text": "Image from Adobe Stock; 281653938 by korkeng"}, {"url": "http://www.openslr.org/12/", "anchor_text": "OpenSLR"}, {"url": "https://en.wikipedia.org/wiki/.DS_Store", "anchor_text": "\u2018.DS_Store\u2019"}, {"url": "https://librosa.github.io/librosa/0.6.0/feature.html", "anchor_text": "ibrosa feature extraction"}, {"url": "https://github.com/jurgenarias/Portfolio/blob/master/Blogs/Code/Voice_Classification_full_code_for_blogpost.ipynb", "anchor_text": "jupyter notebook"}, {"url": "https://towardsdatascience.com/voice-classification-with-neural-networks-ff90f94358ec", "anchor_text": "here"}, {"url": "http://www.openslr.org/12/", "anchor_text": "http://www.openslr.org/12/"}, {"url": "https://medium.com/@patrickbfuller/librosa-a-python-audio-libary-60014eeaccfb", "anchor_text": "Librosa: A Python Audio Library (2019)"}, {"url": "https://www.hindawi.com/journals/sp/2019/7213717/", "anchor_text": "DGR: Gender Recognition of Human Speech Using One-Dimensional Conventional Neural Network"}, {"url": "http://www.primaryobjects.com/2016/06/22/identifying-the-gender-of-a-voice-using-machine-learning/", "anchor_text": "Identifying the Gender of a Voice using Machine Learning"}, {"url": "https://towardsdatascience.com/@ultimatist?source=post_page-----1ef708ec5f53----------------------", "anchor_text": "Jonathan Balaban"}, {"url": "https://towardsdatascience.com/deep-learning-tips-and-tricks-1ef708ec5f53", "anchor_text": "Deep Learning Tips and Tricks"}, {"url": "https://medium.com/@CVxTz?source=post_page-----b0a4fce8f6c----------------------", "anchor_text": "Youness Mansar"}, {"url": "https://medium.com/@CVxTz/audio-classification-a-convolutional-neural-network-approach-b0a4fce8f6c", "anchor_text": "Audio Classification : A Convolutional Neural Network Approach"}, {"url": "https://www.analyticsvidhya.com/blog/author/jalfaizy/", "anchor_text": "Faizan Shaik"}, {"url": "https://www.analyticsvidhya.com/blog/2017/08/audio-voice-processing-deep-learning/", "anchor_text": "Getting Started with Audio Data Analysis using Deep Learning (with case study)"}, {"url": "https://medium.com/@mikesmales?source=post_page-----8bc2aa1990b7----------------------", "anchor_text": "Mike Smales"}, {"url": "https://medium.com/@mikesmales/sound-classification-using-deep-learning-8bc2aa1990b7", "anchor_text": "Sound Classification using Deep Learning"}, {"url": "http://aqibsaeed.github.io/", "anchor_text": "Aaqib Saeed"}, {"url": "http://aqibsaeed.github.io/2016-09-03-urban-sound-classification-part-1/", "anchor_text": "Urban Sound Classification, Part 1"}, {"url": "https://upcommons.upc.edu/bitstream/handle/2117/86673/113166.pdf", "anchor_text": "Voice gender identification using deep neural networks running on FPGA"}, {"url": "https://www.endpoint.com/team/kamil_ciemniewski", "anchor_text": "Kamil Ciemniewski"}, {"url": "https://www.endpoint.com/blog/2019/01/08/speech-recognition-with-tensorflow", "anchor_text": "Speech Recognition from scratch using Dilated Convolutions and CTC in TensorFlow"}, {"url": "https://towardsdatascience.com/@admond1994?source=post_page-----81d0fe3cea9a----------------------", "anchor_text": "Admond Lee"}, {"url": "https://towardsdatascience.com/how-to-build-a-speech-recognition-bot-with-python-81d0fe3cea9a", "anchor_text": "How To Build A Speech Recognition Bot With Python"}, {"url": "https://medium.com/@adrianitsaxu?source=post_page-----486e92785df4----------------------", "anchor_text": "Adrian Yijie Xu"}, {"url": "https://medium.com/gradientcrescent/urban-sound-classification-using-convolutional-neural-networks-with-keras-theory-and-486e92785df4", "anchor_text": "Urban Sound Classification using Convolutional Neural Networks with Keras: Theory and Implementation"}, {"url": "https://github.com/sainathadapa/kaggle-freesound-audio-tagging", "anchor_text": "aggle freesound audio tagging"}, {"url": "https://librosa.github.io/librosa/0.6.0/feature.html", "anchor_text": "Librosa Feature Extraction"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5e2810fe1efa---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----5e2810fe1efa---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/python?source=post_page-----5e2810fe1efa---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5e2810fe1efa---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/ai?source=post_page-----5e2810fe1efa---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5e2810fe1efa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&user=Jurgen+Arias&userId=5f9078a89846&source=-----5e2810fe1efa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5e2810fe1efa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&user=Jurgen+Arias&userId=5f9078a89846&source=-----5e2810fe1efa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e2810fe1efa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5e2810fe1efa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5e2810fe1efa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5e2810fe1efa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jurgenarias?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jurgenarias?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jurgen Arias"}, {"url": "https://medium.com/@jurgenarias/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "89 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f9078a89846&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&user=Jurgen+Arias&userId=5f9078a89846&source=post_page-5f9078a89846--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6f3f53dcac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-neural-network-for-voice-classification-5e2810fe1efa&newsletterV3=5f9078a89846&newsletterV3Id=6f3f53dcac&user=Jurgen+Arias&userId=5f9078a89846&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}