{"url": "https://towardsdatascience.com/how-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780", "time": 1682993721.145656, "path": "towardsdatascience.com/how-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780/", "webpage": {"metadata": {"title": "How to do Deep Learning on Graphs with Graph Convolutional Networks | by Tobias Skovgaard Jepsen | Towards Data Science", "h1": "How to do Deep Learning on Graphs with Graph Convolutional Networks", "description": "Machine learning on graphs is a difficult task due to the highly complex, but also informative graph structure. This post is the first in a series on how to do deep learning on graphs with Graph\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU function", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "convolutional neural networks", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU", "paragraph_index": 26}, {"url": "http://Zachary's karate club", "anchor_text": "Zachary\u2019s karate club", "paragraph_index": 29}, {"url": "https://towardsdatascience.com/how-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-62acf5b143d0", "anchor_text": "here", "paragraph_index": 35}, {"url": "https://twitter.com/TobiasSJepsen", "anchor_text": "Twitter", "paragraph_index": 36}, {"url": "https://www.linkedin.com/in/tobias-skovgaard-jepsen/", "anchor_text": "LinkedIn", "paragraph_index": 37}, {"url": "https://twitter.com/TobiasSJepsen", "anchor_text": "Twitter", "paragraph_index": 37}, {"url": "https://tkipf.github.io/graph-convolutional-networks/", "anchor_text": "Blog post", "paragraph_index": 38}, {"url": "https://arxiv.org/abs/1609.02907", "anchor_text": "Paper", "paragraph_index": 39}], "all_paragraphs": ["Machine learning on graphs is a difficult task due to the highly complex, but also informative graph structure. This post is the first in a series on how to do deep learning on graphs with Graph Convolutional Networks (GCNs), a powerful type of neural network designed to work directly on graphs and leverage their structural information. The posts in the series are:", "In this post, I will give an introduction to GCNs and illustrate how information is propagated through the hidden layers of a GCN using coding examples. We\u2019ll see how the GCN aggregates information from the previous layers and how this mechanism produces useful feature representations of nodes in graphs.", "GCNs are a very powerful neural network architecture for machine learning on graphs. In fact, they are so powerful that even a randomly initiated 2-layer GCN can produce useful feature representations of nodes in networks. The figure below illustrates a 2-dimensional representation of each node in a network produced by such a GCN. Notice that the relative nearness of nodes in the network is preserved in the 2-dimensional representation even without any training.", "More formally, a graph convolutional network (GCN) is a neural network that operates on graphs. Given a graph G = (V, E), a GCN takes as input", "A hidden layer in the GCN can thus be written as H\u2071 = f(H\u2071\u207b\u00b9, A)) where H\u2070 = X and f is a propagation [1]. Each layer H\u2071 corresponds to an N \u00d7 F\u2071 feature matrix where each row is a feature representation of a node. At each layer, these features are aggregated to form the next layer\u2019s features using the propagation rule f. In this way, features become increasingly more abstract at each consecutive layer. In this framework, variants of GCN differ only in the choice of propagation rule f [1].", "One of the simplest possible propagation rule is [1]:", "where W\u2071 is the weight matrix for layer i and \u03c3 is a non-linear activation function such as the ReLU function. The weight matrix has dimensions F\u2071 \u00d7 F\u2071\u207a\u00b9; in other words the size of the second dimension of the weight matrix determines the number of features at the next layer. If you are familiar with convolutional neural networks, this operation is similar to a filtering operation since these weights are shared across nodes in the graph.", "Let\u2019s examine the propagation rule at its most simple level. Let", "In other words, f(X, A) = AX. This propagation rule is perhaps a bit too simple, but we will add in the missing parts later. As a side note, AX is now equivalent to the input layer of a multi-layer perceptron.", "As a simple example, we\u2019ll use the the following graph:", "And below is its numpy adjacency matrix representation.", "Next, we need features! We generate 2 integer features for every node based on its index. This makes it easy to confirm the matrix calculations manually later.", "Alright! We now have a graph, its adjacency matrix A and a set of input features X. Let\u2019s see what happens when we apply the propagation rule:", "What happened? The representation of each node (each row) is now a sum of its neighbors features! In other words, the graph convolutional layer represents each node as an aggregate of its neighborhood. I encourage you to check the calculation for yourself. Note that in this case a node n is a neighbor of node v if there exists an edge from v to n.", "You may have already spotted the problems:", "In the following, I discuss each of these problems separately.", "To address the first problem, one can simply add a self-loop to each node [1, 2]. In practice this is done by adding the identity matrix I to the adjacency matrix A before applying the propagation rule.", "Since the node is now a neighbor of itself, the node\u2019s own features is included when summing up the features of its neighbors!", "The feature representations can be normalized by node degree by transforming the adjacency matrix A by multiplying it with the inverse degree matrix D [1]. Thus our simplified propagation rule looks like this [1]:", "Let\u2019s see what happens. We first compute the degree matrix.", "Before applying the rule, let\u2019s see what happens to the adjacency matrix after we transform it.", "Observe that the weights (the values) in each row of the adjacency matrix have been divided by the degree of the node corresponding to the row. We apply the propagation rule with the transformed adjacency matrix", "and get node representations corresponding to the mean of the features of neighboring nodes. This is because the weights in the (transformed) adjacency matrix correspond to weights in a weighted sum of the neighboring nodes\u2019 features. Again, I encourage you to verify this observation for yourself.", "We now combine the self-loop and normalization tips. In addition, we\u2019ll reintroduce the weights and activation function that we previously discarded to simplify the discussion.", "First order of business is applying the weights. Note that here D_hat is the degree matrix of A_hat = A + I, i.e., the degree matrix of A with forced self-loops.", "And if we want to reduce the dimensionality of the output feature representations we can reduce the size of the weight matrix W:", "We choose to preserve the dimensionality of the feature representations and apply the ReLU activation function.", "Voila! A complete hidden layer with adjacency matrix, input features, weights and activation function!", "Now, finally, we can apply a graph convolutional network on a real graph. I will show you how to produce the feature representations we saw early in the post.", "Zachary\u2019s karate club is a commonly used social network where nodes represent members of a karate club and the edges their mutual relations. While Zachary was studying the karate club, a conflict arose between the administrator and the instructor which resulted in the club splitting in two. The figure below shows the graph representation of the network and nodes are labeled according to which part of the club. The administrator and instructor are marked with \u2018A\u2019 and \u2018I\u2019, respectively.", "Now let us build the graph convolutional network. We won\u2019t actually train the network, but simply initialize it at random to produce the feature representations we saw at the start of this post. We will use networkx which has a graph representation of the club easily available, and compute the A_hat and D_hat matrices.", "Stack the GCN layers. We here use just the identity matrix as feature representation, that is, each node is represented as a one-hot encoded categorical variable.", "And voila! Feature representations that separate the communities in Zachary\u2019s karate club quite well. And we haven\u2019t even begun training yet!", "I should note that for this example the randomly initialized weights were very likely to give 0 values on either the x- or the y-axis as result of the ReLU function, so it took a few random initializations to produce the figure above.", "In this post I have given a high-level introduction to graph convolutional networks and illustrated how the feature representation of a node at each layer in the GCN is based on an aggregate of the its neighborhood. We saw how we can build these networks using numpy and how powerful they are: even randomly initialized GCNs can separate communities in Zachary\u2019s Karate Club.", "In the next post, I will go a bit more into technical detail and show how to implement and train a recently published GCN using semi-supervised learning. You find the next post in the series here.", "Liked what you read? Consider following me on Twitter where I share papers, videos, and articles related to the practice, theory, and ethics of data science and machine learning that I find interesting in addition to my own posts.", "For professional inquiries, please contact me on LinkedIn or by direct message on Twitter.", "[1] Blog post on graph convolutional networks by Thomas Kipf.", "[2] Paper called Semi-Supervised Classification with Graph Convolutional Networks by Thomas Kipf and Max Welling.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Doing data science and machine learning both professionally and as a hobby."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7d2250723780&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d2250723780--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d2250723780--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tobiasskovgaardjepsen?source=post_page-----7d2250723780--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobiasskovgaardjepsen?source=post_page-----7d2250723780--------------------------------", "anchor_text": "Tobias Skovgaard Jepsen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F565f7254b058&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&user=Tobias+Skovgaard+Jepsen&userId=565f7254b058&source=post_page-565f7254b058----7d2250723780---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d2250723780&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d2250723780&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/how-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-62acf5b143d0", "anchor_text": "Semi-Supervised Learning with Spectral Graph Convolutions"}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU function"}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "convolutional neural networks"}, {"url": "https://en.wikipedia.org/wiki/Identity_function", "anchor_text": "identity function"}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU"}, {"url": "http://Zachary's karate club", "anchor_text": "Zachary\u2019s karate club"}, {"url": "https://towardsdatascience.com/how-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-62acf5b143d0", "anchor_text": "here"}, {"url": "https://twitter.com/TobiasSJepsen", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/tobias-skovgaard-jepsen/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/TobiasSJepsen", "anchor_text": "Twitter"}, {"url": "https://tkipf.github.io/graph-convolutional-networks/", "anchor_text": "Blog post"}, {"url": "https://arxiv.org/abs/1609.02907", "anchor_text": "Paper"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7d2250723780---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7d2250723780---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----7d2250723780---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----7d2250723780---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d2250723780&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&user=Tobias+Skovgaard+Jepsen&userId=565f7254b058&source=-----7d2250723780---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d2250723780&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&user=Tobias+Skovgaard+Jepsen&userId=565f7254b058&source=-----7d2250723780---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d2250723780&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d2250723780--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7d2250723780&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7d2250723780---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d2250723780--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7d2250723780--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7d2250723780--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7d2250723780--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7d2250723780--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7d2250723780--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7d2250723780--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7d2250723780--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobiasskovgaardjepsen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobiasskovgaardjepsen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tobias Skovgaard Jepsen"}, {"url": "https://medium.com/@tobiasskovgaardjepsen/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F565f7254b058&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&user=Tobias+Skovgaard+Jepsen&userId=565f7254b058&source=post_page-565f7254b058--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9f2ca467b832&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780&newsletterV3=565f7254b058&newsletterV3Id=9f2ca467b832&user=Tobias+Skovgaard+Jepsen&userId=565f7254b058&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}