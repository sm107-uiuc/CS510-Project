{"url": "https://towardsdatascience.com/explainable-machine-learning-for-healthcare-7e408f8e5130", "time": 1683002402.609091, "path": "towardsdatascience.com/explainable-machine-learning-for-healthcare-7e408f8e5130/", "webpage": {"metadata": {"title": "Explainable Machine Learning for Healthcare | by Yu Huang, M.D., M.S. in CS | Towards Data Science", "h1": "Explainable Machine Learning for Healthcare", "description": "Machine learning has widespread applications in healthcare such as medical diagnosis [1]. One of the frequently used datasets for cancer research is the Wisconsin Breast Cancer Diagnosis (WBCD)\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Post_hoc_analysis", "anchor_text": "post hoc", "paragraph_index": 2}, {"url": "https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+(Diagnostic)", "anchor_text": "Wisconsin Breast Cancer Diagnostic Data Set", "paragraph_index": 36}, {"url": "https://arxiv.org/pdf/1602.04938.pdf", "anchor_text": "\u201cWhy Should I Trust You?\u201dExplaining the Predictions of Any Classifier", "paragraph_index": 37}, {"url": "https://www.oreilly.com/learning/introduction-to-local-interpretable-model-agnostic-explanations-lime", "anchor_text": "Local Interpretable Model-Agnostic Explanations (LIME): An Introduction", "paragraph_index": 39}, {"url": "https://github.com/yuhuang3/machine-learning/tree/master/lime/tabular_explainer", "anchor_text": "Github", "paragraph_index": 40}], "all_paragraphs": ["Machine learning has widespread applications in healthcare such as medical diagnosis [1]. One of the frequently used datasets for cancer research is the Wisconsin Breast Cancer Diagnosis (WBCD) dataset [2]. Like in other domains, machine learning models used in healthcare still largely remain black boxes. As described in [3], understanding the reasons behind machine learning model predictions is very important in determining trust if a doctor plans to take cancer treatment action based on a prediction of diagnosis. Such understanding can also help doctors with domain expertise to find errors with machine learning model predictions. This can be achieved in different methods. One of the methods is called \u201cexplainable machine learning\u201d [4].", "In this article, I use the WBCD dataset [2] to demonstrate how to implement explainable machine learning to make an untrustworthy prediction trustworthy.", "As described in [4], explainable machine learning in this article refers to post hoc analysis and methods that are used to understand the predictions of a pre-trained model. There are different post hoc methods such as reason code generation, local and global visualizations of model predictions, etc. [4]. I use the reason code generation as the post hoc method in this article. In particular, the Local Interpretable Model-agnostic Explanations (LIME) [3] is used to explain which features are used by a machine learning model to make a prediction decision.", "As described before, the dataset used in this article is the public WBCD dataset [2]. In this dataset, the following 9 features were provided for each sample and will be used as inputs to the machine learning model:", "Assuming that the WBCD dataset has already been downloaded onto a local computer as a csv file breast-cancer-wisconsin.csv, the dataset file can then be loaded into a Pandas DataFrame as follows:", "The WBCD dataset shares many common issues and thus needs preprocessing to resolve those issues before it can be consumed by a machine learning model.", "The following command is to check which features have missing data:", "As shown in the table above, there are 16 Bare Nuclei missing data entries. These missing data entries are simply replaced with 0 in this article since the total number of missing entries is relatively small.", "The WBCD dataset [2] includes only 699 samples, which is too small for machine learning. This small data size issue can be alleviated by data augmentation (see Unbalanced Dataset for details).", "The value ranges of different features are different. The class Scale below is to transform the feature values into the same range of [0, 1]. This class is designed in a way that it can be used with other classes to form a pipeline later on.", "The following code is to check whether or not the dataset is balanced in terms of the labeled values of diagnosis:", "The numbers of data samples with different labels are not balanced. There are 458 data samples labeled as 2 (i.e., B (Benign)), but there are only 241 data samples labeled as 4 (i.e., M (Malignant)).", "In order to balance the dataset, for simplicity a copy of the 241 data samples labeled as M is added into the original dataset.", "The following code can be used to visualize the distribution of feature values:", "It can be seen that the values of most features are significantly skewed to the right. The class Sqrt below is to alleviate the data skewness issue by taking squared root of the feature values. Like the Scale class, this class is designed as a pipeline component.", "The labels (i.e., diagnosis) are separated from features since labels and features are required for model training and testing.", "The features and labels are randomly separated into two parts, 75% for model training and 25% for model testing:", "The Random Forest Classifier with default settings is used for demonstration purpose. The model training and testing can be performed as follows:", "The trained model achieved 98.23% in accuracy.", "As described in [3], determining trust in individual predictions is important in decision making by machine learning models. For example, when machine learning is used for medical diagnosis such as the Wisconsin Breast Cancer Diagnosis [1], predictions cannot simply be used for actions as the consequences may be catastrophic. This section shows how to use LIME [3] to provide explanations for individual predictions as a solution to determining trust.", "The key point behind reason code generation in LIME is to associate a model prediction result with the original non-transformed feature values. To this end, the LIME method takes a machine learning pipeline (including a data preprocessing pipeline at the beginning and a machine learning model at the end of the pipeline) as input in explaining model prediction results. The following pipeline is to serve this purpose:", "The LIME method supports different types of machine learning model explainers for different types of datasets such as image, text, tabular data, etc. The tabular explainer is selected in this article since the format of the WBCD dataset is tabular:", "Once a machine learning model has been trained, given any vector of original feature values (i.e., feature vector), the following explain function can be used to explain the model prediction:", "The method show_in_notebook() of LIME explainer shows the associations between the prediction and corresponding original feature values in notebook format.", "The plot function below is to create a bar chart to show the LIME model explanation results:", "Example 1: Explaining prediction of malignant", "The following is a sample (feature vector) of M (Malignant):", "The prediction result of this feature vector can be explained using LIME as follows:", "The prediction result of Malignant is shown at the top-left corner of the figure above. The top-right corner and bottom show which features are positively correlated to the prediction of malignant and which features are negatively correlated to the prediction of malignant. In particular the features in orange/red indicate positive correlation, while the features in blue/green represent negative correlation.", "Example 2: Explaining prediction of benign", "The following is a sample of B (Benign) feature vector:", "The prediction result of this feature vector can be explained by LIME as follows:", "The prediction result of Benign is shown at the top-left corner of the figure above. The top-right corner and bottom show which features are positively correlated to the prediction of malignant and which features are negatively correlated to the prediction of malignant. In particular the features in orange/red indicate positive correlation, while the features in blue/green represent negative correlation.", "In this article I used the LIME method [3] and the WBCD dataset [2] to demonstrate how to explain the prediction results of machine learning model in breast cancer diagnosis.", "As described at the beginning of this article, understanding the reasons behind the machine learning model predictions is very important in assessing trust if a doctor plans to take cancer treatment action based on a prediction of diagnosis. Such understanding can also help doctors with domain expertise to detect errors with machine learning model predictions so that the machine learning model in use can be further improved.", "A Jupyter notebook with all of the source code in this article is available in Github [6].", "[1] Wisconsin Breast Cancer Diagnostic Data Set", "[3] M. T. Ribeiro, S. Singh, and C. Guestrin, \u201cWhy Should I Trust You?\u201dExplaining the Predictions of Any Classifier", "[4] P. Hall and N. Gill, An Introduction to Machine Learning Interpretability, An Applied Perspective on Fairness, Accountability, Transparency, and Explainable AI, Second Edition, O\u2019Reilly Media, Inc., 2019", "[5] M. T. Ribeiro, S. Singh, and C. Guestrin, Local Interpretable Model-Agnostic Explanations (LIME): An Introduction", "[6] Yu Huang, Jupyter notebook in Github", "DISCLOSURE STATEMENT: \u00a9 2020. Opinions expressed in this article are those of the author and do not necessarily represent those of Argonne National Laboratory.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Was Principal Software Engineer at Argonne with a demonstrated history of working in research, the biomedical field, and industry, with special interests in AI"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7e408f8e5130&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jadezhang244?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jadezhang244?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": "Yu Huang, M.D., M.S. in CS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F759013c23ad5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=post_page-759013c23ad5----7e408f8e5130---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e408f8e5130&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e408f8e5130&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Post_hoc_analysis", "anchor_text": "post hoc"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+(Diagnostic)", "anchor_text": "Wisconsin Breast Cancer Diagnostic Data Set"}, {"url": "https://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/", "anchor_text": "WBCD dataset and description"}, {"url": "https://arxiv.org/pdf/1602.04938.pdf", "anchor_text": "\u201cWhy Should I Trust You?\u201dExplaining the Predictions of Any Classifier"}, {"url": "https://www.oreilly.com/learning/introduction-to-local-interpretable-model-agnostic-explanations-lime", "anchor_text": "Local Interpretable Model-Agnostic Explanations (LIME): An Introduction"}, {"url": "https://github.com/yuhuang3/machine-learning/tree/master/lime/tabular_explainer", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7e408f8e5130---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/lime?source=post_page-----7e408f8e5130---------------lime-----------------", "anchor_text": "Lime"}, {"url": "https://medium.com/tag/explainable-model?source=post_page-----7e408f8e5130---------------explainable_model-----------------", "anchor_text": "Explainable Model"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----7e408f8e5130---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7e408f8e5130&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=-----7e408f8e5130---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7e408f8e5130&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=-----7e408f8e5130---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e408f8e5130&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7e408f8e5130&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7e408f8e5130---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7e408f8e5130--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7e408f8e5130--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7e408f8e5130--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7e408f8e5130--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jadezhang244?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jadezhang244?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yu Huang, M.D., M.S. in CS"}, {"url": "https://medium.com/@jadezhang244/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "165 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F759013c23ad5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=post_page-759013c23ad5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F509d77902f1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-machine-learning-for-healthcare-7e408f8e5130&newsletterV3=759013c23ad5&newsletterV3Id=509d77902f1f&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}