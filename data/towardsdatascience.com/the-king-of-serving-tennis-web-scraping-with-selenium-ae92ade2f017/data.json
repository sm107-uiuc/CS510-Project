{"url": "https://towardsdatascience.com/the-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017", "time": 1682997575.2449589, "path": "towardsdatascience.com/the-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017/", "webpage": {"metadata": {"title": "The King of Serving: Tennis Web Scraping with Selenium | by Stephen Fordham | Towards Data Science", "h1": "The King of Serving: Tennis Web Scraping with Selenium", "description": "Serving in Tennis often determines the outcome of the match. A break of serve or a hold of serve at a key moment in a set can ultimately decide whether silverware beckons. Through the combination of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://seleniumhq.github.io/selenium/docs/api/py/api.html", "anchor_text": "link", "paragraph_index": 9}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham", "paragraph_index": 36}], "all_paragraphs": ["Serving in Tennis often determines the outcome of the match. A break of serve or a hold of serve at a key moment in a set can ultimately decide whether silverware beckons.", "Through the combination of measured web scraping with appropriately placed explicit waits, tennis service data can be extracted, exported to Excel, and filtered accordingly using the Pandas library.", "This tutorial piece will demonstrate how, through the deployment of some ingenuity, the scraping script runs smoothly and returns data in a convenient, easy-to-analyse format.", "Since the service games of Tennis players can decide the difference between glory on the court or an early tournament exit, I will scrape data on the current Top 20 Men\u2019s Tennis players who compete on the ATP circuit. Specifically, I want to gather data which will enable discrimination between the tennis players based on their serving alone.", "To extract the data, I first need to find a source, which is up-to-data. The ATP tour website has comprehensive information on over 1000 tennis players and seems a reputable source.", "Most importantly, when the link text for each player is clicked on, serving-specific data can be seen as shown in the bottom half of the image below. It is this information, that can be extracted and used to compare the Top 20 Tennis players.", "Before extraction, it is useful to decide on a code workflow. Specifically, I would like to:", "Iterate through the Top 20 Men\u2019s Tennis players on the ATP circuit, and extract their name, the year they turned pro, and the tabular data inside the \u2018Singles Service Record\u2019 shown above.", "To begin, I will include various import statements for selenium classes. I need to import the webdriver to navigate to the webpage, the By class for help finding web element locators, the options class to instantiate an options object so I can have a headless browser.", "Further to this, I will need to import the WebDriverWait class and the expected_conditions class, which work in tandem. Information pertaining to all of these selenium classes can be found by following this link. Examples of their use will be shown below.", "Finally, although not strictly necessary, I will import tqdm so I can tract the progress of my script in real-time in the console of my Integrated Development Environment (IDE).", "On each iteration, data is transferred to a comma separated values (CSV) file. To begin, I first created a File called \u2018Tennis_player_details_scrape.csv\u2019 and opened this newly created file in write, \u2018w\u2019 mode.", "Before I fetch the data and serving-specific information is added to the CSV file, I create some sensibly named headers(column titles) for the CSV file, and include a new-line character.", "The first objective is to find the first Tennis player. By right-clicking, followed by inspecting, the tennis player can be found within the HTML. This Xpath can be checked that it corresponds to Novak Djokovic using the console tool in the developers tab in Chrome. The Xpath returns a list of one a link. Indexing this element (the zeroth element), and extracting the Text, using the innerText function returns the Tennis player Novak Djokovic.", "The Xpath specific to Novak Djokovic, as shown corresponds to row number 1. By simply changing this number to 3, (tr[3]) for arguments sack, should return Roger Federer. The results in the console confirm this. To further validate; if the table row is 5, tr[5], the Tennis player should be Stefanos Tsitsipas. This relationship can be exploited to gather the names of the Top 20 tennis players.", "This can be achieved by creating a for loop with a range of 1 to 21 and replacing the number with i.", "To further strengthen the code and prevent any timeout exceptions, in case the web pages load slowly, I will set an explicit wait of 20 seconds by using the WebDriverWait class. Here the browser and time are required arguments for this class. Furthermore I will wait until the web element is visible, before the text is extracted using the expected conditions class with the visibility_of_element_located method set.", "This method takes a locator as a required argument. This is specified using \u2018By.XPATH, followed by the xpath in quotations.", "I write the player name to the CSV file and click on the link of each player. I then extract when the player turned pro, and take 2019 from this number to determine the length of their career to date. Again, I write this information to the CSV file.", "In all cases, where I want to extract information, I wait until the particular element I am interested in finding is visibility on the web page. This prevents the occurrence of timeout exceptions being raised.", "In order to scrape the player statistics, I click on the Player Stats tab, and data relating to that player\u2019s \u2018Single Service Record\u2019 is returned. Scraping this data is simple. Once more, the only portion that changes is the number inside the table row[], for example tr[1] tells me how many Aces Djokovic has served, whereas tr[10] informs me of Djokovic\u2019s total service points won.", "I simply iterate through this organised tabular data and extract all the player statistics, and write them to excel using a nested for loop. To make things easier later on I replace any comma characters or % sign characters, so numeric data manipulation is easier later on.", "After this data has been scraped and written to Excel, I navigate back to the singles page to start another iteration.", "To give me an idea of the progress of the script I import tqdm, which prints a dynamically updating progress bar, and wrap this function around my range. In the example below, I can see the progress is 40% and 8 out of 20 iterations are complete with 1:17 minutes remaining.", "Opening the Tennis_player_details_scrape.csv file in Excel, reveals that all the data has been obtained. Now the data can be filtered using the Pandas Library.", "The singles service data is now amendable for analysis. To get started, I first read in the Dataframe, check its shape, and columns and print the first 10 rows using the head() method.", "To confirm that all the data is correctly aligned I perform some validation. As an example, lets pick on Alexander Zverev and check his first serve percentage really is 63% and that he has faced 1815 break points so far in his Tennis career. Indeed, this information marries up, as shown in the highlighted sections\u00a0above\u00a0and\u00a0below.", "A key determining factor when deciding who the best server may be, is sorting the Tennis players by Service games won.", "To do this, I will take two columns from the scraped Dataframe, named df, create a new column called rankings, and then sort the Tennis players on the value in the column \u2018Service_Games_won\u2019 using the sort_values method.", "The Dataframe returned, called Tennis_Serving reveals John Isner has the highest percentage of Service games won despite having a current World ranking of 15. Milos Roanic has the second highest service games won percentage, but sits at position 19 in the World rankings.", "World number 1, Novak Djokovic takes 5th position, whilst Roger Federer and David Goffin\u2019s respective world rankings match their positions in the Service Games Won percentage table.", "While the Tennis player with the highest percentage of Service game wins is probably the best determinant of the Men\u2019s best server on the ATP circuit, lets use some of the other scraped data and create a simple Serving index", "This index will combine and average; the First serve, 1st serve points won, 2nd serve points won, and the Break points saved percentages. I create a new column for this in the original Dataframe, df, then take the player column and the newly created Serving Index column, add a ranking column and then finally sort the Top 20 Tennis players based on this Serving index.", "John Isner again sits top of the pile, with World number 1, Novak Djokovic down in 6th position. Clearly, other aspects of Djokovic\u2019s game must make him the current ATP World Number 1.", "This scraping tutorial has demonstrated how scraped data can be tabulated into a Dataframe amenable to querying using the Pandas Library. Here, insight into the best Tennis servers in the Men\u2019s game can be identified.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Articles on Data Science and Programming https://github.com/StephenFordham"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae92ade2f017&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@stephenfordham?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e----ae92ade2f017---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae92ade2f017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae92ade2f017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@joshcala", "anchor_text": "Josh Calabrese"}, {"url": "https://seleniumhq.github.io/selenium/docs/api/py/api.html", "anchor_text": "link"}, {"url": "https://medium.com/tag/programming?source=post_page-----ae92ade2f017---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ae92ade2f017---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ae92ade2f017---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----ae92ade2f017---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----ae92ade2f017---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae92ade2f017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----ae92ade2f017---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae92ade2f017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----ae92ade2f017---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae92ade2f017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae92ade2f017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae92ade2f017---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae92ade2f017--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae92ade2f017--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae92ade2f017--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae92ade2f017--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/@stephenfordham/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "977 Followers"}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbd4ed43cae00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-king-of-serving-tennis-web-scraping-with-selenium-ae92ade2f017&newsletterV3=5d3f46276e7e&newsletterV3Id=bd4ed43cae00&user=Stephen+Fordham&userId=5d3f46276e7e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}