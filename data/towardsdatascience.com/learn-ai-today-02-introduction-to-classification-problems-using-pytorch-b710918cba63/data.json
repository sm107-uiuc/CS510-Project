{"url": "https://towardsdatascience.com/learn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63", "time": 1683011705.4158459, "path": "towardsdatascience.com/learn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63/", "webpage": {"metadata": {"title": "Learn AI Today 02: Introduction to Classification Problems using PyTorch | by Miguel Pinto | Towards Data Science", "h1": "Learn AI Today 02: Introduction to Classification Problems using PyTorch", "description": "This is the second story in the Learn AI Today series I\u2019m creating! These stories, or at least the first few, are based on a series of Jupyter notebooks I\u2019ve created while studying/learning PyTorch\u2026"}, "outgoing_paragraph_urls": [{"url": "http://learn-ai-today.com/", "anchor_text": "Learn AI Today", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Iris flower dataset", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/learn-ai-today-01-getting-started-with-pytorch-2e3ba25a518", "anchor_text": "previous lesson", "paragraph_index": 10}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-02-classification-with-pytorch", "anchor_text": "this notebook", "paragraph_index": 28}], "all_paragraphs": ["This is the second story in the Learn AI Today series I\u2019m creating! These stories, or at least the first few, are based on a series of Jupyter notebooks I\u2019ve created while studying/learning PyTorch and Deep Learning. I hope you find them as useful as I did!", "If you have not already, make sure to check the previous story!", "Let\u2019s get started by introducing the dataset. I will be using the very famous Iris flower dataset that contains 4 different measurements (sepal length, sepal width, petal length, petal width) of the following 3 species of flowers.", "The goal is to accurately identify the species using the 4 measurements for each flower. Note that nowadays it\u2019s relatively easy to use a model (Convolutional Neural Networks) that learns directly from the images but I will leave that topic for the next lesson. The Iris flower dataset can be easily downloaded from sklearn datasets as shown in the code below.", "To get a quick visualization of the data let\u2019s plot the scatter plots of each pair of features and the histograms for each feature. To achieve this representation I used the pandas.plotting.scatter_matrix function (as always you can find the link to the full code at the end).", "As you can see on the scatter plots above, for most of the samples it should be easy to discriminate the specie. For example, the Iris setosa dots are, in most plots, very well separated from the other two species. For such an easy example you can easily create a rule-based algorithm by drawing a few lines. However, for its simplicity, is also a good example to introduce classification with Neural Networks!", "Before jumping straight to the models and training it\u2019s very important to create a validation set. I skipped this step in the first lesson to avoid introducing too many concepts all at once.", "The idea of a validation set is simple. Instead of training a model with all your data you put apart a fraction of the data (usually 20% \u2014 30%) that you will use to evaluate if the trained model generalizes well to unseen data. This is very important to make sure your model can be safely put into production to evaluate new data accurately.", "In the code above I make use of train_test_split function to randomly split the data and I choose a test_size=0.5 . It\u2019s always a good idea to set the random_state to make sure that when you re-run the code the same split will be used.", "Notice that it is common and a good practice two have not 2 but 3 data splits: train, validation and test. In that case, you use the validation set to check the progress when you try several models, ideas and hyper-parameters (e.g. the learning rate) and you only use the test set at the end when you are happy with the results. This is what happens in Kaggle competitions where usually there is a hidden test set.", "The model I\u2019m going to use for this example is exactly the same I used in the previous lesson for the regression problems!", "So what\u2019s the difference? The difference is in the loss function. For multi-class classification problems, the usual choice is Cross Entropy Loss (nn.CrossEntropyLoss in PyTorch). For binary classification problems, you usually use Binary Cross Entropy Loss (nn.BCEWithLogitsLoss). As a result, the code for defining the model, criterion and optimizer is very similar to what I used in the previous lesson for regression!", "An additional difference to consider is the last activation function. For regression problems, the output of the model is a number that can be any real value. For binary classification, you need to use a Sigmoid activation function that maps the output to the 0\u20131 range. For multi-class classification you need Softmax activation function (unless you want to allow for multiple choices, in that case use Sigmoid activation). The Softmax output can be interpreted as the probability assigned to each class.", "Don\u2019t worry too much for now about the activation functions. I\u2019m just mentioning it here so that you are aware of their existence. For now, the good thing to know is that nn.CrossEntropyLoss includes the Softmax activation for you and the nn.BCEWithLogitsLoss includes the Sigmoid for you. That way you don\u2019t need to add any activation function at the end of the model. PyTorch takes care of that for you!", "Before training the model I also changed the fit function from the previous lesson (you can check it in the Kaggle notebook with the complete code at the end) to allow for train and test/validation data. (When working with only two datasets the terms validation and test are often used interchangeably.)", "Plotting the losses for train and test during the 1000 epochs of training you can see something weird is going on.", "While the train loss keeps improving over time, the test loss initially improves steadily but then starts to increase. And perhaps most importantly, you can see the same effect by plotting the accuracy of the model over the 1000 epochs.", "What you are seeing is what we call overfitting \u2014 at some point the model starts \u2018remembering\u2019 the train data and the generalization performance (evaluated with the test set) decreases. And that\u2019s why you need a validation/test set. In this case you can see that possibly the results are better if you stop the training at 200 epochs. This method is called early stopping and is an easy way to reduce overfitting. However there are other ways such as using weight decay that I will talk about in a minute. Let\u2019s first do some fun visualizations to understand better what is going.", "To visualize the training boundaries and better understand overfitting, I retrained the model using only 2 (instead of 4) features in order to easily plot the result in a 2D graphic. In the animation below you can see the decision boundaries for train (left) and test (right) evolving during the 1000 training epochs.", "Look how initially the model quickly learns 2 straight line boundaries dividing the regions. Then, the red-yellow boundary starts to curve upwards, adjusting better to the train set. However, looking at the test set this leads to a slight decrease in performance as more yellow dots move to the middle region and green-bluish dots to the top region. And this is exactly what overfitting looks like. For more complex problems you can imagine this in multiple dimensions \u2014 it\u2019s easier to overfit when you have a lot of dimensions.", "If you have trouble imagining anything in more than 3 dimensions just follow this advice from Geoffrey Hinton: \u201cTo deal with hyper-planes in a 14-dimensional space, visualize a 3-D space and say \u2018fourteen\u2019 to yourself very loudly. Everyone does it.\u201d", "To reduce overfitting in this example you can use two simple \u2018tricks\u2019:", "The idea of Early Stopping is very simple, as I mentioned before if the model has the best validation accuracy at around epoch 200 then if you train for only 200 epochs you will get a model that generalizes better \u2014 according to the validation accuracy. The problem is that you may then be visually overfitting to the validation set \u2014 particularly if you tune a lot of hyperparameters based on the validation score. This is why it\u2019s often important to have an additional set of data to evaluate the model after finishing all the experiments.", "The idea of Weight Decay is also simple. When fitting a Neural Network, in general, there isn\u2019t an optimum solution but multiple possible similar solutions. Weight Decay, by forcing the weights to stay small, will force the optimization process to reach a simpler solution.", "Let\u2019s add a weight_decay=0.01 to our model and visualize the results after training for 1000 epochs as before. In PyTorch, you just need to add this parameter to the optimizer as optimizer = optim.Adam(model.parameters, lr=0.001, weight_decay=0.01) . The resulting animation is the following.", "As you can see, now the red-yellow boundary does not curve upwards as before since it would require a strong increase in the magnitude of the weights and the accuracy wouldn\u2019t change much.", "Training the model with the 4 input features with weight decay results in the following plot for the train and test losses. Look that now the test loss does not start increasing as before!", "It is also important to mention that when you are starting a new project, overfitting is something you should aim for. Start with a model that can overfit the data so that you know that your model has enough \u2018flexibility\u2019 to learn the patterns in your data. Then increase regularization, like weight decay, to avoid overfitting!", "I can show you a thousand examples but you will learn more if you can make one or two experiments by yourself! The complete code for these experiments is available on this notebook.", "And as always, if you create interesting notebooks with nice animations as a result of your experiments, go ahead and share them on GitHub, Kaggle or write a Medium story!", "This ends the second story in the Learn AI Today series!", "Feel free to give me some feedback in the comments. What did you find most useful or what could be explained better? Let me know!", "You can read more about my journey on the following stories!", "Thanks for reading! Have a great day!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student (Remote sensing, Meteorology), ML/DL enthusiast, fastai student, competition master at Kaggle, pianist/composer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb710918cba63&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b710918cba63--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b710918cba63--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mnpinto?source=post_page-----b710918cba63--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=post_page-----b710918cba63--------------------------------", "anchor_text": "Miguel Pinto"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbfc658aeefbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&user=Miguel+Pinto&userId=bfc658aeefbc&source=post_page-bfc658aeefbc----b710918cba63---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb710918cba63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb710918cba63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://towardsdatascience.com/tagged/learn-ai-today", "anchor_text": "Learn AI Today"}, {"url": "https://unsplash.com/@kellysikkema?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Kelly Sikkema"}, {"url": "https://unsplash.com/s/photos/organize?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://learn-ai-today.com/", "anchor_text": "Learn AI Today"}, {"url": "https://towardsdatascience.com/learn-ai-today-01-getting-started-with-pytorch-2e3ba25a518", "anchor_text": "Learn AI Today: 01 \u2014 Getting started with PytorchDefining and training a Pytorch model and visualizing the results dynamicallytowardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Iris flower dataset"}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Wikipedia"}, {"url": "https://towardsdatascience.com/learn-ai-today-01-getting-started-with-pytorch-2e3ba25a518", "anchor_text": "previous lesson"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-02-classification-with-pytorch", "anchor_text": "this notebook"}, {"url": "https://docs.google.com/forms/d/e/1FAIpQLSc0IBzdCn7osIjvGno1GjBakI-DfXHE8gDLZ--jNzWsXtRW0g/viewform", "anchor_text": "joining my mailing list in this link"}, {"url": "http://learn-ai-today.com/", "anchor_text": "learn-ai-today.com"}, {"url": "https://www.kaggle.com/mnpinto/learn-ai-today-02-classification-with-pytorch", "anchor_text": "this is the link for the Kaggle notebook with the code for this story!"}, {"url": "https://towardsdatascience.com/my-3-year-journey-from-zero-python-to-deep-learning-competition-master-6605c188eec7", "anchor_text": "My 3-year journey: From zero Python to Deep Learning competition masterThe path I followed since starting to learn Python back in 2017 up to became a Kaggle competition master with a solo\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/my-2-year-journey-on-kaggle-how-i-became-a-competition-master-ef0f0955c35d", "anchor_text": "My 2-Year Journey on Kaggle: How I Became a Competition MasterDescribing my journey and the strategy that I followed to become a Competition Master with a solo gold medaltowardsdatascience.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b710918cba63---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b710918cba63---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b710918cba63---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/learn-ai-today?source=post_page-----b710918cba63---------------learn_ai_today-----------------", "anchor_text": "Learn Ai Today"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b710918cba63---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb710918cba63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&user=Miguel+Pinto&userId=bfc658aeefbc&source=-----b710918cba63---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb710918cba63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&user=Miguel+Pinto&userId=bfc658aeefbc&source=-----b710918cba63---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb710918cba63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b710918cba63--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb710918cba63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b710918cba63---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b710918cba63--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b710918cba63--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b710918cba63--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b710918cba63--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b710918cba63--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b710918cba63--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b710918cba63--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b710918cba63--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Miguel Pinto"}, {"url": "https://medium.com/@mnpinto/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "648 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbfc658aeefbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&user=Miguel+Pinto&userId=bfc658aeefbc&source=post_page-bfc658aeefbc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3388b854b03d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-ai-today-02-introduction-to-classification-problems-using-pytorch-b710918cba63&newsletterV3=bfc658aeefbc&newsletterV3Id=3388b854b03d&user=Miguel+Pinto&userId=bfc658aeefbc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}