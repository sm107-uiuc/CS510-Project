{"url": "https://towardsdatascience.com/hands-on-guide-to-feature-engineering-de793efc785", "time": 1683011967.8491578, "path": "towardsdatascience.com/hands-on-guide-to-feature-engineering-de793efc785/", "webpage": {"metadata": {"title": "Hands-On Guide to Feature Engineering in Python | by Salma El Shahawy | Towards Data Science", "h1": "Hands-On Guide to Feature Engineering in Python", "description": "Manual feature engineering could be exhausting and needs plenty of time, experience, and domain knowledge experience to develop the right features. There are many automatic feature engineering tools\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In this guide, I will walk through how to utilize data manipulating to extract features manually.", "Manual feature engineering could be exhausting and needs plenty of time, experience, and domain knowledge experience to develop the right features. There are many automatic feature engineering tools available, like the FeatureTools and the AutoFeat. However, manual feature engineering is essential to understand those advanced tools. Furthermore, it would help build a robust and generic model. I will use the home-credit-default-risk dataset available on the Kaggle platform. I will use only two tables bureauand bureau_balancefrom the main folder. According to the dataset description on the competition page, the tables are the following:", "I will start by importing some important libraries that would help in understanding the data.", "I will start analyzing the bureau.csv first:", "We need to get how many previous loans per client id which is SK_ID_CURR. We can get that using pandas aggregation functions groupby and count(). Then store the new results in a new dataframe after renaming the SK_ID_BUREAU into previous_loan_count for readability.", "The new prev_loan_count has only 305811 observations. Now, I will merge the prev_loan_count dataframe into the train dataset through the client id SK_ID_CURR then fill the missing values with 0. Finally, check if the new column has been added using the dtypes function.", "The next step is to explore the Pearson correlation value or (r-value) between attributes through feature importance. It is not a measure of importance for new variables; however, it provides a reference of whether a variable will be helpful to the model or not.", "Higher correlation with respect to the dependent variable means any change in that variable would lead to a significant change in the dependent variable. So, in the next step, I would look into the highest absolute value of r-value relative to the dependent variable.", "The Kernel Density Estimator (KDE) is the best to describe relation between dependent and independent variable.", "Then check the distribution of the previous_loan_count against Target", "It is hard to see any significant correlation between the TARGETand the previous_loan_count . There is no significant correlation can be detected from the diagram. So, more variables need to be investigated using aggregation functions.", "I will pick the numeric columns grouped by client id then apply the statistics functions min, max, sum, mean, and count to get a summary statistics for per numeric feature.", "Creating a new name for each columns for readability sake. Then merge with the train dataset.", "Getting the correlation with the TARGET variable then sort the correlations by the absolute value using the sort_values()Python function.", "Now check the KDE plot for the newly created variables", "As illustrated, again the correlation is very weak and could be just noise. Furthermore, a larger negative number indicates the loan was further before the current loan application.", "The following function iterate over the dataframe and pick the categorical column and create a dummy variable to it.", "This function will return a stats of sum and mean for each categorical column.", "Now, we have the calculations on each loan. We need to aggregate for each client. I will merging all the previous dataframes together then aggregate the statistics again grouped by the SK_ID_CURR.", "The output : Original Number of Features: 122", "Output is: Number of features using previous loans from other institutions data: 333", "It is very important to check missing data in the training set after merging the new features.", "There are a quite number of columns that have a plenty of missing data. I am going to drop any column that have missing data than 90%.", "I will do the same for the test data", "Then, will align the train and test dataset together and check their shape and same columns.", "Let\u2019s check the missing percent on the test set.", "I will check the correlation with the TARGET variable and the newly created features.", "As observed from the sample above, the most correlated variables are the variables that were engineered earlier. However, correlation doesn\u2019t mean causation that\u2019s why we need to assess those correlations and pick the variables that have deeper influence on the TARGET . To do so, I will stick with the KDE plot.", "The plot says that the applicants with a greater number of monthly record per loan tends to repay the new loan. Let\u2019s look more into the bureau_CREDIT_ACTIVE_Active_count_norm variable to see if this is true.", "The correlation here is very weak, we can\u2019t notice any significance.", "I will set a threshold of 80% to remove any highly correlated variables with the TARGET", "The output is: Number of columns to remove: 134", "Then, we can remove those column from the dataset as a preparation step to use for the model building", "The purpose of this tutorial was to introduce you to many concepts that may seem confusing at the beginning:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fde793efc785&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----de793efc785--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----de793efc785--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://salmaeng71.medium.com/?source=post_page-----de793efc785--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=post_page-----de793efc785--------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0----de793efc785---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde793efc785&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde793efc785&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sortino?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Joshua Sortino"}, {"url": "https://unsplash.com/s/photos/innovation?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/willkoehrsen/start-here-a-gentle-introduction/", "anchor_text": "Gentle introduction to feature engineering"}, {"url": "https://github.com/salma71/home_credit_risk/blob/master/notebooks/KBF_engineering/credit_risk_part%232.ipynb", "anchor_text": "Full notebook for this tutorial on GitHub"}, {"url": "https://www.kaggle.com/salmaeng/credit-risk-part-1/", "anchor_text": "Full notebook for this tutorial on Kaggle"}, {"url": "https://www.kaggle.com/c/home-credit-default-risk", "anchor_text": "Home credit default risk competition on Kaggle"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----de793efc785---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----de793efc785---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pandas?source=post_page-----de793efc785---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/python?source=post_page-----de793efc785---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----de793efc785---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fde793efc785&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----de793efc785---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fde793efc785&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----de793efc785---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde793efc785&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----de793efc785--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fde793efc785&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----de793efc785---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----de793efc785--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----de793efc785--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----de793efc785--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----de793efc785--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----de793efc785--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----de793efc785--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----de793efc785--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----de793efc785--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://salmaeng71.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "414 Followers"}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "https://www.linkedin.com/in/salma-elshahawy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F428e575094be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-feature-engineering-de793efc785&newsletterV3=992085c0dce0&newsletterV3Id=428e575094be&user=Salma+El+Shahawy&userId=992085c0dce0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}