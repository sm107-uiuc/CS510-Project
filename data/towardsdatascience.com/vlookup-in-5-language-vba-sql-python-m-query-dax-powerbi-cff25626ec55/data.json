{"url": "https://towardsdatascience.com/vlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55", "time": 1683017515.940922, "path": "towardsdatascience.com/vlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55/", "webpage": {"metadata": {"title": "VLOOKUP in 5 languages (VBA/SQL/PYTHON/M query/DAX powerBI) | Towards Data Science", "h1": "VLOOKUP in 5 languages", "description": "Excel is a powerful spreadsheet used by most people working in data analysis. The increase of volume of data and development user-friendly tools is an opportunity of improvement of Excel reports by\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/analytics-vidhya/spice-up-your-excel-with-python-621c9693c027", "anchor_text": "https://medium.com/analytics-vidhya/spice-up-your-excel-with-python-621c9693c027", "paragraph_index": 17}], "all_paragraphs": ["Excel is a powerful spreadsheet used by most people working in data analysis. The increase of volume of data and development user-friendly tools is an opportunity of improvement of Excel reports by mixing them with another tool or language.", "As working for a financial reporting department I faced the need to boost our reporting tools. A simple way to start working with a new language is to translate what we use to do in excel, in another language. \u201cHow can I pivot this?\u201d, \u201cHow can I vlookup that ?\u201d.", "In this article I will share with you how you can make VLOOKUP in 5 different languages: VBA, python, SQL, DAX (Power BI), M (Power query). it will simple tips but if you want to get more detailed article don\u2019t forget to follow me!", "VLOOKUP is a function used in Excel to look up data in a table or range organised vertically.", "We will use a simple example with a tab with items and their relative prices. In cell E2 we can put an item and with the VLOOKUP formula in F2 we get its relative price.", "Visual Basic for Application (VBA) is an implementation of Microsoft Visual Basic integrated into Microsoft Office applications.", "On your code, you can set up a variable to store the result of the VLOOKUP result using the statement \u201cWorksheetFunction.vlookup\u201d. It works exactly as the function itself. Then you can set the value of the cell F2 as the variable.", "Additional tip: This case is really simple as we want to get the result of the VLOOKUP into a single cell. But what if we want to loop through all the lines of a table? For example, if we want to put in cells E3 and E4 other items and get in cells F3 and F4 the price using VLOOKUP?", "If we loop the same formula we will get the as result the same price as the VLOOKUP will always be done on the same item (always the cell \u201cE2\u201d). In this case, I suggest using the statement \u201cFormulaR1C1\u201d, where R and C stand for Row and Column. In this statement instead of putting the exact cell where is the value we are looking for, we will say \u201cThe cell where is the value we look for is situated at X rows and Y columns from here\u201d.", "Then we can loop like this:", "SQL ( Structured Query Language) or sequel, is a standard language for storing, manipulating and retrieving data in databases. It is one of the common upgrade done by companies that face limits with Excel. Usually the first reaction is to negotiate some budget in order to store the data into a database and use SQL to \u201cspeak\u201d with this database and organise, manipulate the data. The language is also highly appreciable. Close to a natural language, you don\u2019t feel coding when typing simple SQL request.", "Let\u2019s build a table1 that will match with the RANGE(\u201cA1:B4) of our Excel. In table2 we will mention just the item for which we are looking for the price.", "Then we will use a \u201cRight.Join\u201d request to show the item of table 2 with its relative price of table 1.", "This request means that we select the item and its price in table1 if the item is present in table 2.", "Additional tip: Right join return all rows from the right table and the matched rows from the left table. based on your database you can switch with Left join (in the opposite way), inner join if the match is done in both table, full join if we want all rows that match in one table.", "Python is an interpreted, high level language with a generic purpose. It is used in a large range of application, including data analysis. We can present python by saying \u201cFor all application its libraries\u201d. And for data, without surprise, we will use the famous Pandas.", "The logic used by pandas to do a VLOOKUP is close to the one of SQL. We will create two data frames, one (df1) for the items and their relative prices (cells A1 to B4), one (df2) for the items we want to look up the price. And then we will create a third data frame (Resultdf) that will join the item of df1 with prices of df2.", "Additional tip: There are tones of way to interact directly with Excel in python. If you are interested into that; you can check another article specially for this topic that you can check here: https://medium.com/analytics-vidhya/spice-up-your-excel-with-python-621c9693c027", "M is the powerful language behind the tool power query. Even if you are working on the query editor, every single step will be written in M. M stands for Data Mashup or Data Modeling. I highly recommend to have a look at this language, we can do so much more than just using the graphical interface.", "The request behind VLOOKUP in M is a join method between the table where we have the items and the prices, and the table where we have the item we look for the price.", "To create both tables you just have to select the range of cells and use short cut ctrl+T (or command T in mac).", "In our sample \u201cTable 1\u201d is my table with items and prices, \u201cTable2\u201d is the one with the lookup.", "The method Table.NestedJoin will join the rows of table 1 (with the prices) with the row of table 2; based on the equality of the key element of each table. The final result will be on the new Table 2 with additional column. We add an optional argument to specify that we do a right join.", "Additional tip: This join method can be done directly in the query editor. Even if I recommend to learn M as a all features available these last month in the query editor were already possible with M since years, I will share here how do to it using the query editor:", "Then in \u201cData\u201d we select from Table/Range after selecting Table 1.", "Automatically the query editor will appear with Table1 and the M query of the creation of this table.", "Then we can load the result and do the same with Table2. Once done, in Excel we have a query panel with both table. Just select one of them with a click right and click on Merge.", "A merge editor will appear, where you will put Table 1vas the first table, table 2 as second table and select both column with items. Then click on OK.", "DAX stands for Data Analysis Expressions. More than a language, it is a library of functions and operators that can be used to build formulas in Power BI and Power Pivot.", "Some functions are already built by default, and thankfully LOOKUP is one of them!", "The logical is close the VLOOKUP excel formula but with argument set in a different order.", "result_columnName: is the name of the column where is the result we are looking for;search_columnName: is the name of the column where is the value on with we do the lookup;search_value: value on which we do the lookup.", "In our case the function would be:", "Additional tip: Power BI two tables can have a relationship. If there is already a relationship between both table you can use functions \u201cRELATED\u201d and \u201cFILTERED\u201d.", "I hope that you found here something that might help you on your report. This article is a part of a full set of articles where I want to share some Excel features in different famous language used in data analysis. If you enjoyed it, follow me on my different social network if you want to get notified for the next one.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate about Data, about automation, but above all about sharing and learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcff25626ec55&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@aymenbaraket", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----cff25626ec55--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cff25626ec55--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aymenbaraket.medium.com/?source=post_page-----cff25626ec55--------------------------------", "anchor_text": ""}, {"url": "https://aymenbaraket.medium.com/?source=post_page-----cff25626ec55--------------------------------", "anchor_text": "Aymen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F23a1f9798649&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&user=Aymen&userId=23a1f9798649&source=post_page-23a1f9798649----cff25626ec55---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcff25626ec55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcff25626ec55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Markus Winkler"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/analytics-vidhya/spice-up-your-excel-with-python-621c9693c027", "anchor_text": "https://medium.com/analytics-vidhya/spice-up-your-excel-with-python-621c9693c027"}, {"url": "https://medium.com/tag/excel?source=post_page-----cff25626ec55---------------excel-----------------", "anchor_text": "Excel"}, {"url": "https://medium.com/tag/python?source=post_page-----cff25626ec55---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/sql?source=post_page-----cff25626ec55---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cff25626ec55---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/power-bi?source=post_page-----cff25626ec55---------------power_bi-----------------", "anchor_text": "Power Bi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcff25626ec55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&user=Aymen&userId=23a1f9798649&source=-----cff25626ec55---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcff25626ec55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&user=Aymen&userId=23a1f9798649&source=-----cff25626ec55---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcff25626ec55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cff25626ec55--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcff25626ec55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cff25626ec55---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cff25626ec55--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cff25626ec55--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cff25626ec55--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cff25626ec55--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cff25626ec55--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cff25626ec55--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cff25626ec55--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cff25626ec55--------------------------------", "anchor_text": ""}, {"url": "https://aymenbaraket.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aymenbaraket.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aymen"}, {"url": "https://aymenbaraket.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "40 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F23a1f9798649&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&user=Aymen&userId=23a1f9798649&source=post_page-23a1f9798649--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1cc129e4d17f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvlookup-in-5-language-vba-sql-python-m-query-dax-powerbi-cff25626ec55&newsletterV3=23a1f9798649&newsletterV3Id=1cc129e4d17f&user=Aymen&userId=23a1f9798649&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}