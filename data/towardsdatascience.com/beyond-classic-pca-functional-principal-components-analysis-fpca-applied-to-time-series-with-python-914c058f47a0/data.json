{"url": "https://towardsdatascience.com/beyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0", "time": 1683012946.806893, "path": "towardsdatascience.com/beyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0/", "webpage": {"metadata": {"title": "Beyond \u201cclassic\u201d PCA: Functional Principal Components Analysis (FPCA) applied to Time-Series Python | by Pierre-Louis Bescond | Medium | Towards Data Science", "h1": "Beyond \u201cclassic\u201d PCA: Functional Principal Components Analysis (FPCA) applied to Time-Series with Python", "description": "FPCA is traditionally implemented with R but the \u201cFDASRSF\u201d package from J. Derek Tucker will achieve similar (and even greater) results in Python. Principal Components Analysis is part of the Data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/glemaitre/fdasrsf", "anchor_text": "FDASRSF", "paragraph_index": 0}, {"url": "https://ani.stat.fsu.edu/~wwu/papers/TuckerCSDA13.pdf", "anchor_text": "Generative models for functional data using phase and amplitude separation", "paragraph_index": 15}, {"url": "https://gist.github.com/pierrelouisbescond/9c0b8b925741e4376baf4883306a9022", "anchor_text": "here", "paragraph_index": 24}], "all_paragraphs": ["FPCA is traditionally implemented with R but the \u201cFDASRSF\u201d package from J. Derek Tucker will achieve similar (and even greater) results in Python.", "If you have reached this page, you are probably familiar with PCA.", "Principal Components Analysis is part of the Data Science exploration toolkit as it provides many benefits: reducing dimensions of a large dataset, preventing multi-collinearity, etc.", "There are many articles out there that explain the benefits of PCA and, if needed, I suggest you to have a look at this one which summarizes my understanding of this methodology:", "In a standard PCA process, we define Eigenvectors to convert the original dataset into a smaller one with fewer dimensions and for which most of the initial dataset variance is preserved (usually 90 or 95%).", "Now let\u2019s imagine that the patterns of the time-series have more importance than their absolute variance. For example, you would like to compare physical phenomena such as signals, temperatures\u2019 variation, production batches, etc.. Functional Principal Components Analysis will act this way by determining the corresponding underlying functions!", "Let\u2019s take the example of the temperatures\u2019 variation over a year across different locations in a four-seasons country: we can assume that there is a global trend from cold in winter to hot during summertime.", "We can also assume that the regions close to the ocean will follow a different pattern than the ones close to mountains (i.e.: smoother temperature variations on the sea-side Vs extremely low temperatures during winter in the mountains).", "We will now use this methodology to identify such differences between French regions in 2019. This example is directly inspired by the traditional \u201cCanadian weather\u201d FPCA example developed in R.", "We start by getting daily temperature records since 2018 in France by regions* and prepare the corresponding dataset.", "(*the temperatures are recorded at the \u201cdepartment\u201d level, which is a smaller scale than regions in France (96 departments Vs 13 regions). However, we rename \u201cDepartment\u201d into \u201cRegion\u201d for an easier understanding of readers.)", "To install the FDASRSF package in your current environment, you simply need to run:", "(note: based on my experience, you might need to install manually one or two additional packages to complete the installation properly. You just need to check the anaconda logs in case of failure to identify them.)", "The FDASRSF package from J. Derek Tucker provides a number of interesting functions and we will use two of them: Functional Alignment and Functional Principal Components Analysis (see corresponding documentation below):", "Functional Alignment will synchronize time-series in case they are not perfectly aligned. The illustration below provides a relatively simple example to understand this mechanism. The time-series are processed from both phase and amplitude\u2019s perspectives (aka x and y axis).", "To understand more precisely the algorithms involved, I highly recommend you to have a look at \u201cGenerative models for functional data using phase and amplitude separation\u201d from J. Derek Tucker, Wei Wu, and Anuj Srivastava.", "Even though this is quite hard to notice by simply looking at the Original and Warped Data, we can observe that the Warping functions do have some small inflections (see the yellow curve slightly lagging below the x=y axis), which means than these functions have synchronized the time series when needed. (As you might have guessed, temperature records are \u2014 by design \u2014 well aligned since they are captured simultaneously.)", "Now that our dataset is \u201cwarped\u201d, we can run a Functional Principal Components Analysis. The FDASRSF package allows horizontal, vertical, or joint analysis. We will use the vertical one and plot the corresponding functions and coefficients for PC1 & PC2.", "Now we can add the different weather patterns on the plot, according to the weathers observed in France:", "It is also important to mention that I have chosen the departments arbitrarily according to the places where I live, work and travel frequently but they have not been selected because they were providing good results for this demo. I would expect the same quality of results with other regions.", "Maybe you are wondering if a standard PCA would also provide an interesting result?", "The plot here-below of standard PC1 and PC2 extracted from the original dataset shows that it is not performing as well as FPCA:", "I hope this article has provided a better understanding of the Functional Principal Components Analysis to you.", "I would also like to warmly thank J. Derek Tucker who has been kind enough to patiently guide me through the use of the FDASRSF package.", "The complete notebook is stored here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Head of Data & Advanced Analytics @ Roquette | Winner of the 1st WorldWide Data Centric Deep Learning Contest | Data Science & Machine Learning Passionate!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F914c058f47a0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----914c058f47a0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----914c058f47a0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://pl-bescond.medium.com/?source=post_page-----914c058f47a0--------------------------------", "anchor_text": ""}, {"url": "https://pl-bescond.medium.com/?source=post_page-----914c058f47a0--------------------------------", "anchor_text": "Pierre-Louis Bescond"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ef7c1e10597&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&user=Pierre-Louis+Bescond&userId=4ef7c1e10597&source=post_page-4ef7c1e10597----914c058f47a0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F914c058f47a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F914c058f47a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/glemaitre/fdasrsf", "anchor_text": "FDASRSF"}, {"url": "https://www.danorst.com/time-slice-stills", "anchor_text": "Dan Marker-Moore"}, {"url": "https://towardsdatascience.com/principal-components-analysis-pca-fundamentals-benefits-insights-for-industry-2f03ad18c4d7", "anchor_text": "Principal Components Analysis (PCA), Fundamentals, Benefits & Insights for IndustryDiscover why PCA is not only about dimensions\u2019 reduction and saving computation time but also a way to avoid\u2026towardsdatascience.com"}, {"url": "https://www.data.gouv.fr/fr/datasets/temperature-quotidienne-departementale-depuis-janvier-2018/", "anchor_text": "Temp\u00e9rature quotidienne d\u00e9partementale (depuis janvier 2018) - data.gouv.frCe jeu de donn\u00e9es pr\u00e9sente les temp\u00e9ratures minimales,...www.data.gouv.fr"}, {"url": "https://fdasrsf-python.readthedocs.io/en/latest/time_warping.html#", "anchor_text": "Functional Alignment - fdasrsf 2.0.1 documentationGroup-wise function alignment using SRSF framework and Dynamic Programming aligns a collection of functions while\u2026fdasrsf-python.readthedocs.io"}, {"url": "https://ani.stat.fsu.edu/~wwu/papers/TuckerCSDA13.pdf", "anchor_text": "J.D. Tucker et al. / Computational Statistics and Data Analysis 61 (2013) 50\u201366"}, {"url": "https://ani.stat.fsu.edu/~wwu/papers/TuckerCSDA13.pdf", "anchor_text": "Generative models for functional data using phase and amplitude separation"}, {"url": "https://gist.github.com/pierrelouisbescond/9c0b8b925741e4376baf4883306a9022", "anchor_text": "here"}, {"url": "https://pl-bescond.medium.com/pierre-louis-besconds-articles-on-medium-f6632a6895ad", "anchor_text": "Pierre-Louis Bescond\u2019s articles on MediumData Science, Machine Learning and Innovationpl-bescond.medium.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----914c058f47a0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----914c058f47a0---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----914c058f47a0---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/tag/principal-component?source=post_page-----914c058f47a0---------------principal_component-----------------", "anchor_text": "Principal Component"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F914c058f47a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&user=Pierre-Louis+Bescond&userId=4ef7c1e10597&source=-----914c058f47a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F914c058f47a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&user=Pierre-Louis+Bescond&userId=4ef7c1e10597&source=-----914c058f47a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F914c058f47a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----914c058f47a0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F914c058f47a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----914c058f47a0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----914c058f47a0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----914c058f47a0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----914c058f47a0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----914c058f47a0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----914c058f47a0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----914c058f47a0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----914c058f47a0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----914c058f47a0--------------------------------", "anchor_text": ""}, {"url": "https://pl-bescond.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://pl-bescond.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pierre-Louis Bescond"}, {"url": "https://pl-bescond.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "531 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ef7c1e10597&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&user=Pierre-Louis+Bescond&userId=4ef7c1e10597&source=post_page-4ef7c1e10597--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F990f45c39e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0&newsletterV3=4ef7c1e10597&newsletterV3Id=990f45c39e7a&user=Pierre-Louis+Bescond&userId=4ef7c1e10597&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}