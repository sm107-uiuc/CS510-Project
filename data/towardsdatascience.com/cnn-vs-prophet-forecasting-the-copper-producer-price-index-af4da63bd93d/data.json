{"url": "https://towardsdatascience.com/cnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d", "time": 1683013944.203001, "path": "towardsdatascience.com/cnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d/", "webpage": {"metadata": {"title": "CNN vs. Prophet: Forecasting the Copper Producer Price Index | by Michael Grogan | Towards Data Science", "h1": "CNN vs. Prophet: Forecasting the Copper Producer Price Index", "description": "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/forecasting-the-copper-producer-price-index-with-prophet-d570e3baac78", "anchor_text": "article", "paragraph_index": 1}, {"url": "https://fred.stlouisfed.org/series/WPUSI019011", "anchor_text": "FRED Economic Data", "paragraph_index": 1}, {"url": "https://www.udacity.com/course/intro-to-tensorflow-for-deep-learning--ud187", "anchor_text": "Intro to TensorFlow for Deep Learning course from Udacity", "paragraph_index": 10}, {"url": "https://colab.research.google.com/github/tensorflow/examples/blob/master/courses/udacity_intro_to_tensorflow_for_deep_learning/l08c09_forecasting_with_cnn.ipynb#scrollTo=PgYwn9VM8OJi", "anchor_text": "here", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/cnn-lstm-predicting-daily-hotel-cancellations-e1c75697f124", "anchor_text": "\u201cCNN-LSTM: Predicting Daily Hotel Cancellations\u201d", "paragraph_index": 12}, {"url": "https://www.analyticsvidhya.com/blog/2019/08/detailed-guide-7-loss-functions-machine-learning-python-code/", "anchor_text": "Huber loss", "paragraph_index": 15}, {"url": "https://facebook.github.io/prophet/docs/trend_changepoints.html", "anchor_text": "Prophet time series model", "paragraph_index": 18}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 29}], "all_paragraphs": ["Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as investment advice, or any other sort of professional advice.", "In a previous article on Towards Data Science, I attempted to use the Prophet model to forecast the copper producer price index. The data was sourced from FRED Economic Data using Quandl.", "Here is a plot of the data (note that all prices are expressed in logarithmic terms for the purpose of this exercise):", "The time series in question ranged from September 1985 to July 2020 \u2014 and the mean absolute error came in at 0.257 (compared to a mean of 5.917 across the test set).", "Here is a plot of the forecasted vs. actual values:", "While the Prophet model is effective at detecting seasonality and trend components \u2014 and also offers the ability to improve on forecasts by modifying change points appropriately \u2014 such a model does not necessarily do particularly well when it comes to capturing volatility from one time period to the next.", "In this regard, I decided to model this data using a Convolutional Neural Network (hereby referred to as CNN) model, in order to investigate whether this model would prove more effective at forecasting this time series.", "As a caveat, the below example is more of an academic exercise rather than a real-life attempt to predict asset prices. Given that we are working with monthly data \u2014 it is easier for a neural network to pick up the fluctuations from one time period to another.", "In the context of a real-life scenario whereby a time series is being predicted over much shorter intervals (hours, minutes, even seconds), there would be much more stochasticity (or randomness) present in the dataset. This would likely affect the forecast accuracy significantly. Furthermore, a multivariate time series would likely prove more effective at forecasting an economic time series more generally \u2014 given that such time series are subject to many interventions.", "However, using the CNN to model monthly data will be used as a starting point for this purpose.", "Note that the below example uses the model template from the Intro to TensorFlow for Deep Learning course from Udacity \u2014 this particular topic is found in Lesson 8: Time Series Forecasting by Aur\u00e9lien G\u00e9ron.", "Additionally, the original Jupyter Notebook (Copyright 2018, The TensorFlow Authors) can also be found here.", "I previously elaborated on the building blocks of a CNN model in my last article titled, \u201cCNN-LSTM: Predicting Daily Hotel Cancellations\u201d. As a result, I will not go through this in much more detail again here, but suffice to say that a CNN works by using previous time steps (based on a specific window size) to produce an output of data points as follows:", "CNNs have an inherent ability to learn both short and long-term dependencies in a time series through the WaveNet architecture, whereby several Conv1D (one-dimensional convolutional) layers are stacked together. This allows the lower layers to learn short-term dependencies, while the higher layers learn long-term dependencies. In the context of the time series we are trying to predict, this model seems to be suitable for this purpose.", "An 80/20 split is performed on the data, with the first 334 data points in the time series used for training the CNN model, with the rest of the points used for validation purposes.", "A window size of 64 is chosen, with a batch size of 128, trained over 500 epochs. A Huber loss is used as the loss function, in order to ensure that the model accuracy reading is robust to the effects of outliers.", "Note in the above example that a doubling dilation rate is being used when training the model. The reason for this, as mentioned, is to allow the network to learn both short and long-term patterns in the time series.", "The mean absolute error is calculated as below:", "A useful feature of the Prophet time series model by Facebook is the ability to identify changepoints, or periods of significant structural change in a time series. Accurate identification of such points can in turn improve a time series forecast.", "As above, the MAE for the Prophet model came in at 0.257 which is significantly higher in comparison to that yielded by the CNN.", "12 changepoints (or significant deviations in trend) were defined in the Prophet model.", "That said, let\u2019s have a look at a plot of the predicted versus actual values once again:", "Clearly, the CNN performed better at predicting the monthly fluctuations of copper prices \u2014 while the MAE for the Prophet model remains low relative to the mean value \u2014 we see that there is significantly more volatility in the actual time series which the predicted time series is not picking up.", "As mentioned, forecasting a time series such as this does come with inherent limitations in that it is not known whether a CNN would perform as well across shorter time periods with greater stochasticity. Additionally, such time series are subject to a wide range of interventions which are not accounted for by past values.", "However, in this instance the CNN has done quite well in capturing monthly fluctuations for copper prices.", "In this article, we have covered:", "Many thanks for your time, and any questions or feedback are greatly appreciated.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as investment advice, or any other sort of professional advice.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf4da63bd93d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----af4da63bd93d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf4da63bd93d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf4da63bd93d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/3844328-3844328/", "anchor_text": "3844328"}, {"url": "https://pixabay.com/photos/stock-trading-monitor-business-1863880/", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/forecasting-the-copper-producer-price-index-with-prophet-d570e3baac78", "anchor_text": "article"}, {"url": "https://fred.stlouisfed.org/series/WPUSI019011", "anchor_text": "FRED Economic Data"}, {"url": "https://www.udacity.com/course/intro-to-tensorflow-for-deep-learning--ud187", "anchor_text": "Intro to TensorFlow for Deep Learning course from Udacity"}, {"url": "https://colab.research.google.com/github/tensorflow/examples/blob/master/courses/udacity_intro_to_tensorflow_for_deep_learning/l08c09_forecasting_with_cnn.ipynb#scrollTo=PgYwn9VM8OJi", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/cnn-lstm-predicting-daily-hotel-cancellations-e1c75697f124", "anchor_text": "\u201cCNN-LSTM: Predicting Daily Hotel Cancellations\u201d"}, {"url": "https://www.analyticsvidhya.com/blog/2019/08/detailed-guide-7-loss-functions-machine-learning-python-code/", "anchor_text": "Huber loss"}, {"url": "https://facebook.github.io/prophet/docs/trend_changepoints.html", "anchor_text": "Prophet time series model"}, {"url": "https://medium.com/tag/data-science?source=post_page-----af4da63bd93d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----af4da63bd93d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----af4da63bd93d---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/cnn?source=post_page-----af4da63bd93d---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/tag/finance?source=post_page-----af4da63bd93d---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf4da63bd93d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&user=Michael+Grogan&userId=eec017a8b178&source=-----af4da63bd93d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf4da63bd93d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&user=Michael+Grogan&userId=eec017a8b178&source=-----af4da63bd93d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf4da63bd93d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faf4da63bd93d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----af4da63bd93d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----af4da63bd93d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----af4da63bd93d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----af4da63bd93d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----af4da63bd93d--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-vs-prophet-forecasting-the-copper-producer-price-index-af4da63bd93d&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}