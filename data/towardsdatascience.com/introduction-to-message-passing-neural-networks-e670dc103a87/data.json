{"url": "https://towardsdatascience.com/introduction-to-message-passing-neural-networks-e670dc103a87", "time": 1683014712.33654, "path": "towardsdatascience.com/introduction-to-message-passing-neural-networks-e670dc103a87/", "webpage": {"metadata": {"title": "Introduction to Message Passing Neural Networks | Towards Data Science", "h1": "Introduction to Message Passing Neural Networks", "description": "An introduction to one of the most popular graph neural network models, Message Passing Neural Network. Learn how it works and where it can be used."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/feature-extraction-for-graphs-625f4c5fb8cd", "anchor_text": "extract numerical data from graphs", "paragraph_index": 1}, {"url": "https://arxiv.org/pdf/1509.09292.pdf", "anchor_text": "Convolutional Networks on Graphs for Learning Molecular Fingerprints", "paragraph_index": 21}, {"url": "https://arxiv.org/abs/1511.05493", "anchor_text": "Gated Graph Sequence Neural Networks", "paragraph_index": 22}, {"url": "https://arxiv.org/pdf/1704.01212.pdf", "anchor_text": "Neural Message Passing for Quantum Chemistry", "paragraph_index": 23}, {"url": "http://www.linkedin.com/in/kacperkubara", "anchor_text": "www.linkedin.com/in/kacperkubara", "paragraph_index": 25}], "all_paragraphs": ["Welcome to the world of graph neural networks where we construct deep learning models on graphs. You could think that is quite simple. After all, can\u2019t we just reuse models that work with normal data?", "Well, not really. In the graph, all datapoints (nodes) are interconnected with each other. This means that data is not independent anymore which makes most of standard machine learning models useless as their derivations strongly base on this assumption. To overcome this problem, it is possible to extract numerical data from graphs or use models that directly operate on this type of data.", "Creating models that directly work on graphs is more desirable because we obtain more information about their structure and properties. In this article, we will look at one of the architectures specifically designed for this type of data, Message Passing Neural Networks (MPNNs).", "Before the model was standardized into a single MPNN framework, different variants had been published by several independent researchers. This type of architecture was especially popular in chemistry to help predict the properties of molecules.", "One of the first work on this topic was published by Duvenaud et al. (2015) in [1]. He used the message passing architecture to extract valuable information from graph molecules and then transform it into a single feature vector. At that time, his work was ground-breaking because he made the architecture differentiable. It was de-facto one of the first convolutional neural network architectures that could operate on graphs.", "Another attempt on this architecture was done by Li et al. (2016) in [2]. Here, they focus on the sequential output from graphs, for example finding an optimal path in graph [2]. To achieve that, they embedded GRU (Gated Recurring Unit) into their algorithm.", "Although these algorithms seem to be quite different, they have the same underlying concept in common which is a message passing between nodes in the graph. We shall soon see how those models can be combined into a single framework.", "After all, the idea behind the MPNN is conceptually simple.", "Each node in the graph has a hidden state (i.e. feature vector). For each node Vt, we aggregate a function of hidden states and possibly edges of all neighbouring nodes with the node Vt itself. Then, we update the hidden state of the node Vt using the the obtained message and the previous hidden state of that node.", "There are 3 main equations that define the MPNN framework on graphs [3]. The message obtained from neighbouring nodes is given by the following equation:", "It is a sum of all messages Mt obtained from the neighbours. Mt is an arbitrary function that depends on hidden states and edges of the neighbouring nodes. We can simplify this function by leaving some of the input arguments. In the example above, we only sum different hidden states hw.", "Then, we update the hidden state of the node Vt using a simple equation:", "Simply speaking, the hidden state of the node Vt is obtained by updating the old hidden state with the newly obtained message mv. In the case of the example above, the update function Ut is an average between the previous hidden state and the message.", "We repeat this message passing algorithm for a specified number of times. After that, we reach the final readout phase.", "In this step, we extract all newly update hidden states and create a final feature vector describing the whole graph. This feature vector can be then used as input to a standard machine learning model.", "And that\u2019s it! Those are the foundations of the MPNN. This framework is quite robust as we can define different messages and update functions depending on what we want to achieve. I would suggest looking at [3] for more information different variants of MPNN model.", "The MPNN was implemented as a part of few deep learning libraries. Here is the list of few different implementations that I\u2019ve been able to find:", "MPNN framework standardizes different message passing models that were independently created by several researchers. The main idea of this framework consists of message, update, and readout functions which operate on different nodes in the graph. There are variants of the MPNN models that share this functions but they defined them differently.", "Thanks for reading, I hope it was useful for you!", "I am an MSc Artificial Intelligence student at the University of Amsterdam. In my spare time, you can find me fiddling with data or debugging my deep learning model (I swear it worked!). I also like hiking :)", "Here are my other social media profiles, if you want to stay in touch with my latest articles and other useful content:", "[1] Convolutional Networks on Graphs for Learning Molecular Fingerprints", "[2] Gated Graph Sequence Neural Networks", "[3] Neural Message Passing for Quantum Chemistry", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MSc in Artificial Intelligence at the University of Amsterdam | www.linkedin.com/in/kacperkubara"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe670dc103a87&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e670dc103a87--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e670dc103a87--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kacperkubara?source=post_page-----e670dc103a87--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=post_page-----e670dc103a87--------------------------------", "anchor_text": "Kacper Kubara"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fada6808c0b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&user=Kacper+Kubara&userId=ada6808c0b73&source=post_page-ada6808c0b73----e670dc103a87---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe670dc103a87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe670dc103a87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ryuldavidson?utm_source=medium&utm_medium=referral", "anchor_text": "Ryul Davidson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/feature-extraction-for-graphs-625f4c5fb8cd", "anchor_text": "Feature Extraction for Graphs"}, {"url": "https://towardsdatascience.com/machine-learning-tasks-on-graphs-7bc8f175119a", "anchor_text": "Machine Learning Tasks on Graphs"}, {"url": "https://towardsdatascience.com/towards-explainable-graph-neural-networks-45f5e3912dd0", "anchor_text": "Towards Explainable Graph Neural Networks"}, {"url": "https://towardsdatascience.com/top-10-learning-resources-for-graph-neural-networks-f24d4eb2cc2b", "anchor_text": "Top 10 Learning Resource for Graph Neural Networks"}, {"url": "https://towardsdatascience.com/feature-extraction-for-graphs-625f4c5fb8cd", "anchor_text": "extract numerical data from graphs"}, {"url": "https://unsplash.com/@amseaman?utm_source=medium&utm_medium=referral", "anchor_text": "Andrew Seaman"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@jannerboy62?utm_source=medium&utm_medium=referral", "anchor_text": "Nick Fewings"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/brain-research/mpnn", "anchor_text": "Original model\u2019s implementation"}, {"url": "https://github.com/deepchem/deepchem/tree/master/contrib/mpnn", "anchor_text": "Deepchem implementation"}, {"url": "https://github.com/rusty1s/pytorch_geometric", "anchor_text": "PyTorch Geometric implementation"}, {"url": "https://www.linkedin.com/in/kacperkubara/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/KacperKubara", "anchor_text": "GitHub"}, {"url": "https://arxiv.org/pdf/1509.09292.pdf", "anchor_text": "Convolutional Networks on Graphs for Learning Molecular Fingerprints"}, {"url": "https://arxiv.org/abs/1511.05493", "anchor_text": "Gated Graph Sequence Neural Networks"}, {"url": "https://arxiv.org/pdf/1704.01212.pdf", "anchor_text": "Neural Message Passing for Quantum Chemistry"}, {"url": "https://medium.com/tag/mpnn?source=post_page-----e670dc103a87---------------mpnn-----------------", "anchor_text": "Mpnn"}, {"url": "https://medium.com/tag/graph-neural-networks?source=post_page-----e670dc103a87---------------graph_neural_networks-----------------", "anchor_text": "Graph Neural Networks"}, {"url": "https://medium.com/tag/cheminformatics?source=post_page-----e670dc103a87---------------cheminformatics-----------------", "anchor_text": "Cheminformatics"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e670dc103a87---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe670dc103a87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&user=Kacper+Kubara&userId=ada6808c0b73&source=-----e670dc103a87---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe670dc103a87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&user=Kacper+Kubara&userId=ada6808c0b73&source=-----e670dc103a87---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe670dc103a87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e670dc103a87--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe670dc103a87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e670dc103a87---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e670dc103a87--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e670dc103a87--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e670dc103a87--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e670dc103a87--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e670dc103a87--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e670dc103a87--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e670dc103a87--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e670dc103a87--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kacper Kubara"}, {"url": "https://medium.com/@kacperkubara/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "622 Followers"}, {"url": "http://www.linkedin.com/in/kacperkubara", "anchor_text": "www.linkedin.com/in/kacperkubara"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fada6808c0b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&user=Kacper+Kubara&userId=ada6808c0b73&source=post_page-ada6808c0b73--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F378c2694fea3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-message-passing-neural-networks-e670dc103a87&newsletterV3=ada6808c0b73&newsletterV3Id=378c2694fea3&user=Kacper+Kubara&userId=ada6808c0b73&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}