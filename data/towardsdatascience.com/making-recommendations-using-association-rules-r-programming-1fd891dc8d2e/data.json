{"url": "https://towardsdatascience.com/making-recommendations-using-association-rules-r-programming-1fd891dc8d2e", "time": 1683012201.742362, "path": "towardsdatascience.com/making-recommendations-using-association-rules-r-programming-1fd891dc8d2e/", "webpage": {"metadata": {"title": "Making recommendations using association rules (R Programming) | by Sheenal Srivastava | Towards Data Science", "h1": "Making recommendations using association rules (R Programming)", "description": "Retailers typically have a wealth of customer transaction data which consists of the type of items purchased by a customer, their value and the date they were purchased. Unless the retailer has a\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Retailers typically have a wealth of customer transaction data which consists of the type of items purchased by a customer, their value and the date they were purchased. Unless the retailer has a loyalty rewards system, they may not have demographic information on their customers such as height, age, gender and address. Thus, in order to make suggestions on what this customer might want to buy in the future, i.e which products to recommend to a customer, this has to be based on their purchase history and information on the purchase history of other customers.", "In collaborative filtering, recommendations are made to customers based on finding similarities between the purchase history of customers. So, if Customers A and B both purchase Product A, but customer B also purchases Product B, then it is likely that customer A may also be interested in Product B. This is a very simple example and there are various algorithms that can be used to find out how similar customers are in order to make recommendations.", "One such algorithm is k-nearest neighbour where the objective is to find k customers that are most similar to the target customer. It involves choosing a k and a similarity metric (with Euclidean distance being most common). The basis of this algorithm is that points that are closest in space to each other are also likely to be most similar to each other.", "Another techinque is to use basket analysis or association rules. In this method, the aim is to find out which items are bought together (put in the same basket) and the frequency of this purchase. The output of this algorithm is a series of if-then rules i.e. if a customer buys a candle, then they are also likely to buy matches. Association rules can assist retailers with the following:", "Let\u2019s now apply association rules to a dummy dataset", "The first thing I did with this dataset was quickly check for any missing values or NAs as per follows. As shown below, no missing values were found.", "Now the variables were all either read in as numeric or string variables. In order to meaningfully interpret categorical variables, they need to be changed to factors. As such, the following changes were made.", "Then, all the numeric variables were summarised into their five-point summary (min, median, max, std dev., and mean) to identify any outliers within the data. By running this summary, it was found that the features MerchCategoryCode, CategoryCode, and SubCategoryCode contained a large number of NAs. Upon further inspection, it was found that the majority of these code values contained digits; however, the ones that had been converted to NAs contained characters such as \u201cFreight\u201d or the letter \u201cC\u201d. As these codes are not related to customer purchases, these observations were removed.", "Negative gross sales and negative quantity indicate either erroneous values or customer returns. This may be interesting information; however, it is not related to our objective of analysis and as such these observations were omitted.", "It is always a good idea to explore the data to see if you can see any trends or patterns within the dataset. Later on, you can use an algorithm/machine learning model to validate these trends.", "The graph below shows me that the highest number of transactions come from Victoria followed by Queensland. If a retailer wants to know where to increase sales then this plot may be useful as the number of sales are proportionately low in all other states.", "We can also see this plot by state as below. However, the transactions from Victoria and Queensland seem to cover up information for other states. Boxplots may be better for visualisation.", "The below boxplots (though hard to see due to the scale being extended by the outliers) show that most sales across all states are close to the overall median. There in an abnormally high outlier for NT and a couple for VIC. For our purpose, since we are only interested in understanding which products do customers buy together in order to make recommendations, we do not need to deal with these outliers.", "Now that we have had a look at sales by state. Let\u2019s try and get a better understanding of the products purchased by customers.", "The plot below is coloured based on the frequency of purchases per item. Lighter shades of blue indicate higher frequencies.", "Due to the distribution of sales by product and state, it appears that any association rules we come up with will mainly be based on sales from VIC and QLD. Furthermore, as not all products were stocked/sold in all states, it is expected that the association rules will be limited to a very few number of products. However, since I have already embarked on this mode of analysis, let\u2019s continue to see what we get.", "We have two years worth of data, 2016 and 2017. So, I decided to compare the gross number of sales for the two years.", "Despite the higher number of transactions in 2016 (2.5 times more than 2017), mean gross sales were higher for 2017 than 2016. This seems quite counter-intuitive. So, I decided to dive into this deeper by looking at monthly sales.", "In 2016, the highest number of sales were recorded for January and March with steep declines in September to November and then an increase in December. However, transactions continued to decline in 2017 with an increase in December (Xmas season).", "Deduction: As highest number of sales are for Camping, apparel and BBQ & Gas, it makes sense that sales for these products is high during the holiday season", "Recommendation to the retailer: May want to explore whether stores have sufficient stock for these products in Dec-Jan as they are the most popular.", "Deduction: Despite the steady decline in the number of transactions, mean gross sales continue to increase month on month with it being highest in Dec 2017. This indicates fewer customers that made purchases but made purchases of products of greater value.", "Recommendation: What can the retailer do to ensure there is a steady state of purchases throughout the year rather than an increasing trend with maximum number of purchases at the end of the year as the retailer is still paying overhead costs and employee salaries amongst other costs to run its stores?", "Let\u2019s go back to our objective.", "Aim: To determine which products are customers likely to buy together in order to make recommendations for products", "I used the arules package and the read.transactions function to convert the dataset into a transaction object. A summary of this object gives the following output", "Based on the output above, we can conclude the following.", "We can look at this information graphically via absolute frequency and relative frequency plots.", "Both plots are in descending order of frequency of purchase. The absolute frequency plot tells us that the highest number of sales are for gas related products. The relative frequency plot shows how the sales of the products that are close to each other in the bar chart are related to each other (i.e. relative). Thus, a recommendation that one can make to the retailer is to stock these products together in the store or send customers an EDM making recommendations for products that are related in the plot and have not yet been purchased by the customer.", "The next step to do is to generate rules for our transaction object. The output is as follows.", "The above output shows us that 7 rules were generated.", "Details of these rules are shown below.", "Now each of these rules have support, confidence, and lift values.", "Let\u2019s start with support which is the proportion of transactions out of all transactions used to generate the rules (i.e. 1,019,952) that contain the two items together (i.e. 1190/1019952 = 0.0011 or 0.11%, where count is the number of transactions that contain the two items.", "Confidence is the proportion of transactions where two items are bought together out of all transactions where one of the item is purchased. As these are apriori rules, the probability of buying item B is based on the purchase of item A.", "Mathematically, this looks like the following:", "In the results above, confidence values range from 54% to 79%.", "Probability of customers buying items together with confidence ranges from 54% to 79%, where buying item A has a positive effect on buying item B (as lift values are all greater than 1) .", "Note: When I ran the algorithm, I experimented with higher support and confidence values as if there is a greater number of transactions within the dataset where two items are bought together then the higher the confidence. However, when I ran the algorithm with 80% or more confidence, I obtained zero rules.", "This was expected due to the sparsity in data for frequent items where 1-item baskets are most common and the majority of purchased items related to camping or gas products.", "Thus, the algorithm was run with the following parameters.", "Lift indicates how two items are correlated to each other. A positive lift value indicates that buying item A is likely to result in a purchase of item B. Mathematically, lift is calculated as follows.", "All our rules have positive lift values indicating that buying item A is likely to lead to a purchase of item B.", "Interpretation of the first rule is as follows:", "If a customer buys the 9kg gas bottle, there is a 79% chance that customer will also buy its refill. This is identified for 1,683 transactions in the dataset.", "Now, let\u2019s look at these plots visually.", "All rules have a confidence value greater than 0.5 with lift ranging from 26 to 249.", "The Parallel coordinates plot for the seven rules shows how the purchase of one product influences the purchase of another product. RHS is the item we propose the customer buy. For LHS, 2 is the most recent addition to the basket and 1 is the item that the customer previously purchased.", "Looking at the first arrow we can see that if a customer has Weber Baby (Q1000) roasting trivet in their basket, then they are likely to purchase weber babgy q convection tray.", "The below plots would be more useful if we could visualize more than 2-itemset baskets.", "You have now learnt how to make recommendations to customers based on which items are most frequently purchased together based on apriori rules. However, some important things to note about this analysis.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1fd891dc8d2e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sheenalsrivastava?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sheenalsrivastava?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": "Sheenal Srivastava"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F42bf180d6f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&user=Sheenal+Srivastava&userId=42bf180d6f14&source=post_page-42bf180d6f14----1fd891dc8d2e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1fd891dc8d2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1fd891dc8d2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.datacamp.com/community/tutorials/market-basket-analysis-r", "anchor_text": "https://www.datacamp.com/community/tutorials/market-basket-analysis-r"}, {"url": "https://github.com/shedoesdatascience/basketanalysis", "anchor_text": "https://github.com/shedoesdatascience/basketanalysis"}, {"url": "https://medium.com/tag/association-rule?source=post_page-----1fd891dc8d2e---------------association_rule-----------------", "anchor_text": "Association Rule"}, {"url": "https://medium.com/tag/recommendation-engine?source=post_page-----1fd891dc8d2e---------------recommendation_engine-----------------", "anchor_text": "Recommendation Engine"}, {"url": "https://medium.com/tag/r-programming?source=post_page-----1fd891dc8d2e---------------r_programming-----------------", "anchor_text": "R Programming"}, {"url": "https://medium.com/tag/customer-segmentation?source=post_page-----1fd891dc8d2e---------------customer_segmentation-----------------", "anchor_text": "Customer Segmentation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1fd891dc8d2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&user=Sheenal+Srivastava&userId=42bf180d6f14&source=-----1fd891dc8d2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1fd891dc8d2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&user=Sheenal+Srivastava&userId=42bf180d6f14&source=-----1fd891dc8d2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1fd891dc8d2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1fd891dc8d2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1fd891dc8d2e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1fd891dc8d2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sheenalsrivastava?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sheenalsrivastava?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sheenal Srivastava"}, {"url": "https://medium.com/@sheenalsrivastava/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F42bf180d6f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&user=Sheenal+Srivastava&userId=42bf180d6f14&source=post_page-42bf180d6f14--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1966e1e5a2c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-recommendations-using-association-rules-r-programming-1fd891dc8d2e&newsletterV3=42bf180d6f14&newsletterV3Id=1966e1e5a2c8&user=Sheenal+Srivastava&userId=42bf180d6f14&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}