{"url": "https://towardsdatascience.com/embedding-contexts-into-recipe-ingredients-709a95841914", "time": 1683006253.6644769, "path": "towardsdatascience.com/embedding-contexts-into-recipe-ingredients-709a95841914/", "webpage": {"metadata": {"title": "Embedding \u201cContexts\u201d Into Recipe Ingredients | by Nishant Mohan | Towards Data Science", "h1": "Embedding \u201cContexts\u201d Into Recipe Ingredients", "description": "If I convert the ingredient list to a simple bag-of-words matrix, I get a one-hot-encoded matrix because each ingredient appears only once in a given recipe. Using simple linear regression, I get a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/whats-cooking", "anchor_text": "Yummly recipes data-set", "paragraph_index": 2}, {"url": "https://radimrehurek.com/gensim/models/word2vec.html", "anchor_text": "Gensim\u2019s Word2Vec implementation", "paragraph_index": 5}, {"url": "https://github.com/mohannishant6", "anchor_text": "GitHub", "paragraph_index": 16}], "all_paragraphs": ["Looking at a set of ingredients, we can identify where the cuisine is from.", "But, can machines do the same?", "If I convert the ingredient list to a simple bag-of-words matrix, I get a one-hot-encoded matrix because each ingredient appears only once in a given recipe. Using simple linear regression, I get a classification accuracy of 78% on the Yummly recipes data-set without even cleaning the text. Interestingly, Tree-based methods and Neural Nets have also successfully been applied for this task with good results.", "Since NLP is schway these days, I wondered if Word-Embedding vectors could be used for the classification task? I worked on answering this question in one of the group projects in my masters program.", "First, we cleaned the ingredient list by removing stop words, symbols, quantity markers, and kept only nouns. This is how it looked:", "Next, we used Gensim\u2019s Word2Vec implementation to get a 300-length vector for each unique ingredient in the data. We form a vector for the recipe by adding the vectors of its ingredients. Therefore, we got one vector for each recipe in the data. Let\u2019s see how those vectors look when converted to 2-D representation using tSNE:", "While there is a lot of noise, we do see some clusters. For instance, Chinese, Thai, Japanese and Korean cluster together in bottom left. An interesting fact I discovered just now while writing this: Moroccon and Indian cuisine share some similarities! And this is evident from the bottom right portion of the above image.", "Moving on, we used this vector-representation, which supposedly has \u201ccontext\u201d of the recipe, for classification. A cleaned recipe list and context vector representation gives classification accuracy of only 65% using simple linear regression, which is lower than the baseline 78%.", "I thought let\u2019s look in detail at some cuisines and their top ingredients.", "I observed that the recipes which were actually French, were misclassified as Italian the most. I thought that\u2019s okay, considering there is class imbalance and Italian cuisine has highest presence ratio in the data. However, a notable observation is that Italian cuisine were misrepresented as French cuisine the most. This was surprising considering French cuisine was not among those having high presence ratio in the data. Also, Italian was not misidentified as Irish cuisine in high numbers, but French was!", "We, therefore, took a closer look at the top ingredients of these three cuisines.", "It can be observed that French cuisine shares two ingredients, oil and clove, with Italian cuisines. French cuisine also shares two main ingredients, cream and butter with Irish cuisine, albeit a tiny fraction of butter also contributes to Italian. Interestingly, Italian cuisine and Irish cuisine do not share many ingredients other than the ones shared by all three cuisines, which are pepper, onion, egg and others. This further strengthens our observation that French cuisine has similarities with Italian as well as Irish cuisine, however, Italian and Irish cuisine is not as similar. Therefore, misclassification among Italian and French cuisine is natural, since they closely resemble each other based on the ingredients used in their recipes.", "For starters, the data has imbalanced classes. Italian and Mexican cuisine occur more frequently than others. However, this must have been the problem while estimating baseline too!", "Possibly, a more thorough (or maybe less thorough?) cleaning of data is needed. Our initial thought was to keep only nouns in the data. Maybe we need to keep other parts of speech too. Maybe Adverbs and Conjunctions, which did not make sense to keep in the data, did play a part?", "Maybe the vectors need more tuning. The hyperparameters used to make the word-vectors may need to be optimized. We added the individual word-vectors in a recipe to form the recipe-vector. Maybe we need to normalize the recipe vector, considering the number of ingredients in a recipe vary considerably.", "Finally, it should be noted that the explanation of cuisine composition above shows that the vectors are indeed successful in clustering similar cuisines together. I also explained the reasons for misclassification. This hints to the possibility that word-embeddings are good for clustering applications. While for classification, more work is needed.", "Check out some of my interesting projects on GitHub!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F709a95841914&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----709a95841914--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----709a95841914--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mohannishant6.medium.com/?source=post_page-----709a95841914--------------------------------", "anchor_text": ""}, {"url": "https://mohannishant6.medium.com/?source=post_page-----709a95841914--------------------------------", "anchor_text": "Nishant Mohan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F30ff2a59e5e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&user=Nishant+Mohan&userId=30ff2a59e5e5&source=post_page-30ff2a59e5e5----709a95841914---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F709a95841914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F709a95841914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/whats-cooking", "anchor_text": "Yummly recipes data-set"}, {"url": "https://radimrehurek.com/gensim/models/word2vec.html", "anchor_text": "Gensim\u2019s Word2Vec implementation"}, {"url": "https://github.com/mohannishant6/Recipe-Ingredients-as-Word-Embeddings", "anchor_text": "https://github.com/mohannishant6/Recipe-Ingredients-as-Word-Embeddings"}, {"url": "https://www.linkedin.com/in/mohannishant/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/mohannishant6", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/text-analytics?source=post_page-----709a95841914---------------text_analytics-----------------", "anchor_text": "Text Analytics"}, {"url": "https://medium.com/tag/word-embeddings?source=post_page-----709a95841914---------------word_embeddings-----------------", "anchor_text": "Word Embeddings"}, {"url": "https://medium.com/tag/word2vecs-gensim?source=post_page-----709a95841914---------------word2vecs_gensim-----------------", "anchor_text": "Word2vecs Gensim"}, {"url": "https://medium.com/tag/nlp?source=post_page-----709a95841914---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/classification?source=post_page-----709a95841914---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F709a95841914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&user=Nishant+Mohan&userId=30ff2a59e5e5&source=-----709a95841914---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F709a95841914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&user=Nishant+Mohan&userId=30ff2a59e5e5&source=-----709a95841914---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F709a95841914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----709a95841914--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F709a95841914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----709a95841914---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----709a95841914--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----709a95841914--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----709a95841914--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----709a95841914--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----709a95841914--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----709a95841914--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----709a95841914--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----709a95841914--------------------------------", "anchor_text": ""}, {"url": "https://mohannishant6.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mohannishant6.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nishant Mohan"}, {"url": "https://mohannishant6.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "74 Followers"}, {"url": "https://www.linkedin.com/in/mohannishant/", "anchor_text": "https://www.linkedin.com/in/mohannishant/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F30ff2a59e5e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&user=Nishant+Mohan&userId=30ff2a59e5e5&source=post_page-30ff2a59e5e5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9fbd44251677&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fembedding-contexts-into-recipe-ingredients-709a95841914&newsletterV3=30ff2a59e5e5&newsletterV3Id=9fbd44251677&user=Nishant+Mohan&userId=30ff2a59e5e5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}