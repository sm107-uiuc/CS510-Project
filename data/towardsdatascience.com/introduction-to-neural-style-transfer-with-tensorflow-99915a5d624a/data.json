{"url": "https://towardsdatascience.com/introduction-to-neural-style-transfer-with-tensorflow-99915a5d624a", "time": 1682995738.8167338, "path": "towardsdatascience.com/introduction-to-neural-style-transfer-with-tensorflow-99915a5d624a/", "webpage": {"metadata": {"title": "Introduction to Neural Style Transfer with TensorFlow | by Marco Peixeiro | Towards Data Science", "h1": "Introduction to Neural Style Transfer with TensorFlow", "description": "Neural style transfer is one of the most creative application of convolutional neural networks. By taking a content image and a style image, the neural network can recombine the content and the style\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/introduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18", "anchor_text": "convolutional neural networks", "paragraph_index": 0}, {"url": "https://prisma-ai.com/", "anchor_text": "Prisma,", "paragraph_index": 2}, {"url": "https://arxiv.org/abs/1508.06576", "anchor_text": "Gatys et al.", "paragraph_index": 3}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/4.Convolutional%20Neural%20Networks/4.Special%20Applications%20-%20Facial%20Recognition%20%26%20Neural%20Style%20Transfer/Neural%20Style%20Transfer.ipynb", "anchor_text": "full notebook", "paragraph_index": 4}, {"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel", "paragraph_index": 5}], "all_paragraphs": ["Neural style transfer is one of the most creative application of convolutional neural networks. By taking a content image and a style image, the neural network can recombine the content and the style image to effectively creating an artistic image!", "These algorithms are extremely flexible and the virtually infinite possible combinations of content and style resulted in very creative and unique results.", "In fact, a company optimized the algorithm and released a mobile application called Prisma, which uses neural style transfer to apply artistic styles to pictures taken from your mobile!", "In this post, we will recreate the algorithm proposed by Gatys et al. to achieve similar results as shown above. Note that I am working on a laptop, and so results might slightly differ if you are working on a desktop with a better CPU.", "As always, feel free to consult the full notebook is you ever get stuck.", "For hands-on video tutorials on machine learning, deep learning, and artificial intelligence, checkout my YouTube channel.", "Building the algorithm from scratch would require a lot of time and computation power, which is not readily available for everyone.", "Instead, we will load the weights of an existing network to achieve neural style transfer.", "The process of using a neural network for a different purpose is called transfer learning.", "Let\u2019s load the model like so:", "Great! Now, I will use a picture from the Louvre as the content image. You can load any picture you want, but make sure it is not too large:", "In my case, the output looks like:", "In order for our algorithm to generate nice images, we need to ensure that the content of the generated image will match that of the input image.", "In other words, the generated image should also have the pyramid, the surrounding buildings, the clouds, the sun, etc.", "Therefore, we want the layer activation of the generated image and content image to be similar. Hence, the content cost function can be defined as:", "From the equation above, n_H and n_W are the height and width respectively of the image, where n_c is the number of channels in the hidden layer.", "To compute the cost, it is more efficient to unroll the 3D volumes into 2D matrices, as it will speed up computation.", "Now, we need an style image. In my case, I will use an impressionist work from Monet, but feel free to use any other type of art:", "Defining the style cost function is a slightly more involved process than the content cost function. Let\u2019s break it down into smaller parts.", "The style matrix is also called the Gram matrix, and it represents the dot product of a set of vectors.", "This captures the similarity between each vector, since if two vectors are similar to one another, then their dot product will be large, and thus the Gram matrix will be large.", "This is how the Gram matrix can effectively measure the style of an image.", "Now, we want to make sure that the style of the generated image and style image is similar.", "In other words, we want to minimize the distance between the two Gram matrices. This is expressed as:", "In the previous step, we only captured the style cost of a single layer. It would be useful to combine the style cost of all layers to generate a better image.", "Mathematically, the style cost then becomes:", "where lambda is the weight for each layer.", "Thus, we add this code cell:", "Now, we simply combine everything into a single style cost function:", "Now that we have a cost function for the content and the style, we can combine both to obtain a total cost function that will be optimized:", "where alpha and beta are arbitrary weights.", "And now, the best part! With everything in place, we can solve the optimization problem and generate an artistic image!", "In my case, I get the following result:", "Of course, you can get much better results if you train the network for a longer time and with a smaller learning rate.", "Congratulations! You just performed neural style transfer in TensorFlow! Feel free to change the content and style image, and play around with the number of iterations and learning rate.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior data scientist | Author | Instructor. I write hands-on articles with a focus on practical skills."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F99915a5d624a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----99915a5d624a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99915a5d624a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----99915a5d624a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----99915a5d624a--------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd----99915a5d624a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99915a5d624a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99915a5d624a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@juandinella?utm_source=medium&utm_medium=referral", "anchor_text": "Juan Di Nella"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/introduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18", "anchor_text": "convolutional neural networks"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "Deeplearning.ai"}, {"url": "https://prisma-ai.com/", "anchor_text": "Prisma,"}, {"url": "https://prisma-ai.com/", "anchor_text": "Prisma"}, {"url": "https://arxiv.org/abs/1508.06576", "anchor_text": "Gatys et al."}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/4.Convolutional%20Neural%20Networks/4.Special%20Applications%20-%20Facial%20Recognition%20%26%20Neural%20Style%20Transfer/Neural%20Style%20Transfer.ipynb", "anchor_text": "full notebook"}, {"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "Source"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "Source"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "Deeplearning.ai"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----99915a5d624a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----99915a5d624a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----99915a5d624a---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----99915a5d624a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----99915a5d624a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99915a5d624a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----99915a5d624a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99915a5d624a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----99915a5d624a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99915a5d624a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99915a5d624a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F99915a5d624a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----99915a5d624a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----99915a5d624a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----99915a5d624a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----99915a5d624a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----99915a5d624a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----99915a5d624a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----99915a5d624a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----99915a5d624a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----99915a5d624a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/@marcopeixeiro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9835bccb3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-neural-style-transfer-with-tensorflow-99915a5d624a&newsletterV3=741c1c8fcfbd&newsletterV3Id=9835bccb3d51&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/time-series-forecasting-in-python-book", "anchor_text": "Time Series Forecasting in Python2022"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}