{"url": "https://towardsdatascience.com/dbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d", "time": 1682996571.053906, "path": "towardsdatascience.com/dbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d/", "webpage": {"metadata": {"title": "DBSCAN Clustering: Theory & Example | Towards Data Science", "h1": "DBSCAN Algorithm: Complete Guide and Application with Python Scikit-Learn", "description": "Complete theory of DBSCAN Clustering. Example of using DBSCAN from Scikit-Learn to cluster weather stations in Canada."}, "outgoing_paragraph_urls": [{"url": "https://www.aaai.org/Papers/KDD/1996/KDD96-037.pdf", "anchor_text": "Density-Based Spatial Clustering of Applications with Noise", "paragraph_index": 1}, {"url": "https://matplotlib.org/basemap/users/intro.html", "anchor_text": "Basemap Toolkit", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/Mercator_projection", "anchor_text": "Mercator projection", "paragraph_index": 25}, {"url": "https://scikit-learn.org/stable/auto_examples/cluster/plot_dbscan.html#sphx-glr-auto-examples-cluster-plot-dbscan-py", "anchor_text": "scikit-learn demo of DBSCAN", "paragraph_index": 27}, {"url": "https://github.com/suvoooo/Machine_Learning/tree/master/DBSCAN_Complete", "anchor_text": "Github", "paragraph_index": 32}, {"url": "https://towardsdatascience.com/latent-variables-expectation-maximization-algorithm-fb15c4e0f32c", "anchor_text": "Expectation Maximization Algorithm", "paragraph_index": 34}, {"url": "https://www.aaai.org/Papers/KDD/1996/KDD96-037.pdf", "anchor_text": "KDD-96 Proceedings.", "paragraph_index": 35}, {"url": "https://cse.buffalo.edu/~jing/cse601/fa12/materials/clustering_density.pdf", "anchor_text": "Presentation Link.", "paragraph_index": 36}, {"url": "https://saptashwa.medium.com/membership", "anchor_text": "My Link", "paragraph_index": 37}], "all_paragraphs": ["What I intend to cover in this post \u2014", "While dealing with spatial clusters of different density, size and shape, it could be challenging to detect the cluster of points. The task can be even more complicated if the data contains noise and outliers. To deal with large spatial databases, Martin Ester and his co-authors proposed Density-Based Spatial Clustering of Applications with Noise (DBSCAN), which still remains as one of the highest cited science papers. 3 main reasons for using the algorithm according to Ester et.al. are", "1. It requires minimum domain knowledge.", "2. It can discover clusters of arbitrary shape.", "3. Efficient for large database, i.e. sample size more than few thousands.", "To understand DBSCAN in more detail, let\u2019s dive into it. The main concept of DBSCAN algorithm is to locate regions of high density that are separated from one another by regions of low density. So, how do we measure density of a region ? Below are the 2 steps \u2014", "The Epsilon neighborhood of a point P in the database D is defined as (following the definition from Ester et.al.)", "Following the definition of dense region, a point can be classified as a Core Point if |N (p)|\u2265 MinPts. The Core Points, as the name suggests, lie usually within the interior of a cluster. A Border Point has fewer than MinPts within its \u03f5-neighborhood (N), but it lies in the neighborhood of another core point. Noise is any data point that is neither core nor border point. See the picture below for better understanding.", "One problem of this approach could be \u2014 \u03f5-neighborhood of the border points contain significantly less number of points than the core points. Since MinPts is a parameter in the algorithm, setting it to a low value to include the border points in the cluster can cause problem to eliminate the noise. Here comes the concept of density-reachable and density-connected points.", "Directly Density Reachable: Data-point a is directly density reachable from a point b if \u2014", "Considering a border point and a core point, we can understand that notion of directly density reachable is not symmetric, because even though the core point falls in the epsilon neighborhood of border point, the border point doesn\u2019t have enough MinPts, and thus fail to satisfy both conditions.", "Density Reachable: Point a is density reachable from a point b with respect to \u03f5 and MinPts, if \u2014", "Density reachable is transitive in nature but, just like direct density reachable, it is not symmetric.", "Density Connected: There can be cases when 2 border points will belong to the same cluster but they don\u2019t share a specific core point, then we say that they are density connected if, there exists a common core point, from which these borders points are density reachable. As you can understand that density connectivity is symmetric. Definition from the Ester et.al. paper is given below \u2014", "\u201cA point a is density connected to a point b with respect to \u03f5 and MinPts, if there is a point c such that, both a and b are density reachable from c w.r.t. to \u03f5 and MinPts.\u201d", "With the definitions above, we can go through the steps of DBSCAN algorithm as below \u2014", "From the definitions and algorithm steps above, you can guess two of the biggest drawbacks of DBSCAN algorithm.", "Once the fundamentals are cleared a little, now will see an example of DBSCAN algorithm using Scikit-learn and python.", "To see one realistic example of DBSCAN algorithm, I have used Canada Weather data for the year 2014 to cluster weather stations. First let\u2019s load the data \u2014", "The data-frame consists of 1341 rows and 25 columns and to understand what column names represent, let\u2019s take a look below for the most important features \u2014", "Since, I wanted to use different temperatures as few of the main features as a first try to cluster weather stations, first, let\u2019s drop the rows that contain NaN values in the column \u2018Mean Temperature (Tm)\u2019, \u2018Minimum Temperature (Tn)\u2019, \u2018Maximum Temperature (Tx)\u2019.", "After dropping the rows containing NaN values in the above mentioned columns, we are left with 1255 samples. Even though that\u2019s almost ~7% of data loss, but given that we still have more than 1000 samples, let\u2019s go ahead with the clustering.", "Since we want to do spatial clustering and view the clustering in a map projection, along with different temperatures (\u2018Tm\u2019, \u2018Tn\u2019, \u2018Tx\u2019), \u2018Lat\u2019, \u2018Long\u2019 should also be taken as features. Here, I have used Basemap Toolkit, a library to plot 2D data for visualizing maps in Python. As mentioned in the Basemap documentation that\u200a\u2014\u200a\u201cBasemap does not do any plotting on its own, but provides the facilities to transform coordinates to one of 25 different map projections\u201d. One of the important properties of Basemap is \u2014 calling a Basemap class instance with the arguments latitude/longitude (in degrees, as in our data-frame), to get x/y map projection coordinates.", "Let\u2019s plot the weather stations using Basemap to get familiarized with it. Start by importing the necessary libraries", "We are ready to call the Basemap class now \u2014", "Let me explain the code block in brief. I started off calling a Basemap class instance with Mercator projection (projection= \u2018merc\u2019), low resolution (resolution= \u2018l\u2019), and the boundaries of the map domain are given by the 4 parameters llcrnrlon, llcrnrlat, urcrnrlon, urcrnrlat, where llcrnrlon denotes longitude of lower left hand corner of the selected map domain and so on. Drawcoastlines, drawcountries do exactly what the names suggest, drawlsmask draws a high resolution land-sea mask as an image with land and ocean colors specified to orange and sky-blue. Latitude and Longitude are converted to x/y map projection coordinates using the command below \u2014", "These map projection coordinates will be used as features to cluster the data points spatially along with the temperatures. First let\u2019s take a look below the weather stations \u2014", "For clustering data, I\u2019ve followed the steps shown in scikit-learn demo of DBSCAN.", "Choosing temperatures (\u2018Tm\u2019, \u2018Tx\u2019, \u2018Tn\u2019) and x/y map projections of coordinates (\u2018xm\u2019, \u2018ym\u2019) as features and, setting \u03f5 and MinPts to 0.3 and 10 respectively, gives 8 unique clusters (noise is labeled as -1). Feel free to change these parameters to test how much clustering is affected accordingly.", "Let\u2019s visualize these clusters using Basemap \u2014", "Finally, I included precipitation (\u2018P\u2019) in the features and repeated the same clustering steps with \u03f5 and MinPts set to 0.5 and 10. We see some differences from the previous clustering and, thus it gives us an idea about problem of clustering unsupervised data even using DBSCAN when we lack the domain knowledge.", "You can try to repeat the process including some more features, or, change the clustering parameters, to get a better overall knowledge.", "To conclude this post, we went through some basic concepts of DBSCAN algorithm and tested this algorithm to cluster weather stations in Canada. The detail codes and all the pictures will be available in my Github. A direct comparison with K-Means clustering can be made to understand even better the differences between these algorithms. Hopefully, this will help you to get started with one of the most used clustering algorithm for unsupervised problems.", "Share your thoughts and ideas and, stay strong. Cheers !", "P.S: Another unsupervised clustering method Gaussian mixture and detailed Expectation Maximization Algorithm is discussed in another post.", "[1] \u201cA Density-Based Algorithm for Discovering Clusters in Large Spatial Databases with Noise\u201d; Martin Ester et.al. KDD-96 Proceedings.", "[2] Density Based Clustering Methods; Gao,J., Associate Professor Buffalo University. Presentation Link.", "If you\u2019re interested in further fundamental machine learning concepts and more, you can consider joining Medium using My Link. You won\u2019t pay anything extra but I\u2019ll get a tiny commission. Appreciate you all!!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd690cbae4c5d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://saptashwa.medium.com/?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": ""}, {"url": "https://saptashwa.medium.com/?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": "Saptashwa Bhattacharyya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9a3c3c477239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=post_page-9a3c3c477239----d690cbae4c5d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd690cbae4c5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd690cbae4c5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/nmF_6DxByAw", "anchor_text": "Adil Wahid"}, {"url": "https://www.aaai.org/Papers/KDD/1996/KDD96-037.pdf", "anchor_text": "Density-Based Spatial Clustering of Applications with Noise"}, {"url": "https://matplotlib.org/basemap/users/intro.html", "anchor_text": "Basemap Toolkit"}, {"url": "https://en.wikipedia.org/wiki/Mercator_projection", "anchor_text": "Mercator projection"}, {"url": "https://scikit-learn.org/stable/auto_examples/cluster/plot_dbscan.html#sphx-glr-auto-examples-cluster-plot-dbscan-py", "anchor_text": "scikit-learn demo of DBSCAN"}, {"url": "https://github.com/suvoooo/Machine_Learning/tree/master/DBSCAN_Complete", "anchor_text": "Github"}, {"url": "https://towardsdatascience.com/latent-variables-expectation-maximization-algorithm-fb15c4e0f32c", "anchor_text": "Expectation Maximization Algorithm"}, {"url": "https://www.aaai.org/Papers/KDD/1996/KDD96-037.pdf", "anchor_text": "KDD-96 Proceedings."}, {"url": "https://cse.buffalo.edu/~jing/cse601/fa12/materials/clustering_density.pdf", "anchor_text": "Presentation Link."}, {"url": "https://github.com/suvoooo/Machine_Learning/tree/master/DBSCAN_Complete", "anchor_text": "Link to Github"}, {"url": "https://saptashwa.medium.com/membership", "anchor_text": "My Link"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d690cbae4c5d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d690cbae4c5d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/clustering?source=post_page-----d690cbae4c5d---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d690cbae4c5d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----d690cbae4c5d---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd690cbae4c5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=-----d690cbae4c5d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd690cbae4c5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=-----d690cbae4c5d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd690cbae4c5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd690cbae4c5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d690cbae4c5d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d690cbae4c5d--------------------------------", "anchor_text": ""}, {"url": "https://saptashwa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://saptashwa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saptashwa Bhattacharyya"}, {"url": "https://saptashwa.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.3K Followers"}, {"url": "https://www.linkedin.com/in/saptashwa", "anchor_text": "https://www.linkedin.com/in/saptashwa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9a3c3c477239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=post_page-9a3c3c477239--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F423a8008308d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d&newsletterV3=9a3c3c477239&newsletterV3Id=423a8008308d&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}