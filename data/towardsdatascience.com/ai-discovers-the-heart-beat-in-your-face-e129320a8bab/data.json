{"url": "https://towardsdatascience.com/ai-discovers-the-heart-beat-in-your-face-e129320a8bab", "time": 1682997736.0259058, "path": "towardsdatascience.com/ai-discovers-the-heart-beat-in-your-face-e129320a8bab/", "webpage": {"metadata": {"title": "AI discovers the heart beat in your face | by Shor Joel | Towards Data Science", "h1": "AI discovers the heart beat in your face", "description": "It can sometimes be hard to see how today\u2019s clunky stethoscopes will turn into tomorrow\u2019s Star Trek tricorders. This post will help you better envision that path by explaining one concrete\u2026"}, "outgoing_paragraph_urls": [{"url": "https://youtu.be/IHd9bYGJtoI?t=27", "anchor_text": "Star Trek tricorders", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Deepfake", "anchor_text": "Deepfake", "paragraph_index": 3}], "all_paragraphs": ["By Joel Shor, Google ML Research Engineer, Saleh Nabil Shehada, M.D, Matt O\u2019Brien", "It can sometimes be hard to see how today\u2019s clunky stethoscopes will turn into tomorrow\u2019s Star Trek tricorders. This post will help you better envision that path by explaining one concrete development in healthcare: a technology that determines your heart rate just from video.", "Heart-rate-from-video will unlock a number of cool applications inside and outside the hospital.", "You could also imagine watching a video of your favorite politician saying something implausibly heinous and learn that the heart rate of the politician was reliably zero the entire time. You might then conclude that either she is a zombie, or you\u2019ve been watching a Deepfake.", "Current techniques to measure heart rate often fall into one of three categories:", "Technique 1: Electrical signal. The most reliable way to measure heart rate is to directly monitor the heart\u2019s electrical activity. Like all muscles, the heart is controlled by the nervous system. Electrodes attached to the proper locations on the skin\u2019s surface can detect these electrical pulses.", "Technique 2: Mechanical signal. ER doctors commonly measure heart rate by holding a finger to a patient\u2019s wrist for 15 seconds. This works because the force of the heart beat is so strong that arteries move with each beat. The doctor counts how many times per minute the vein or artery pulses, and the muscle contraction is so strong that the pulse is reliably felt in wrists and ankles.", "Technique 3: Light absorption. Photoplethysmography (PPG) leverages the reflective and absorptive properties of light. Different amounts of blood absorb different amounts of light, so changes in blood volume can be tracked by light absorption (and hence when the heart beats). Typically, an LED illuminates the skin, and another device measures how much light is reflected back. Changes in the amount of light reflected correspond with beats of the heart.", "Algorithmic techniques take advantage of many of the same physical phenomena.", "Software can leverage mechanical signals by watching the subtle movements of the head. Movement of the blood from the heart to the head causes the head to move in a periodic motion, and heart-rate-from-motion algorithms try to carefully measure cyclic head motion of roughly the expected frequency, then work backwards and infer a heart rate (similar to previous heart rate technique #2 in the above section). The schematic below visualizes the algorithm flow.", "Step a: Track the head and neck. This is done using traditional computer vision techniques.", "Step b: Map the motion of the head to a 1D axis. The authors found that the vertical direction best captured the involuntary motion due to heart beat, since motion in the horizontal directions were dominated by involuntary swaying.", "Step c: Even in the vertical direction, there are many sources of motion other than heart rate. For example, respiration and changes in posture also move the head and neck. To remove these sources of noise, the authors use traditional signal processing filtering techniques to target motion only in the frequency range corresponding to \u201cnormal\u201d heart rate.", "Step d: Even after filtering, only part of the vertical head-and-neck movement is due to heart rate. The authors decompose the remaining mixed motion into submotion vectors and assume that the most periodic motion vectors correspond to the heart rate. They use a standard decomposition technique (Principle Components Analysis, or PCA) to extract the dominant direction and magnitude of motion. See the figure below for a visual depiction of the result of this step.", "Their results on their private dataset were excellent: all 18 subjects had average heart rate errors less than 4% over a 70\u201390 second window, with a mean error of 1.5%.", "Heart rate from video using normal, ambient light was introduced in 2008. [2] used a carefully-controlled, carefully-collected dataset to detect heart rate from the minor color fluctuations of the face (similar to previous heart rate technique #3 in the section above). They avoided issues of changing background light and head movements by recording their volunteers while they were motionless in a carefully controlled environment. Interestingly, they discovered that most of the heart rate information was carried by the green channel in the digital RGB color space, which is consistent with the fact that green light is better absorbed by red blood cells than red light.", "In 2014, [3] improved on the 2008 algorithm. They evaluated on a public dataset [4], meaning that their results were more reproducible. The dataset also had more variety in illumination and motion, so the results are closer to being representative of real-life scenarios. The following is a schematic of their method, which I\u2019ll go into more detail below.", "Step 1: Detect the face and reliably, stably track it through the video frames. Stably tracking the face is important because the paper uses the mean green value of the pixels in the face-region to estimate pulse. A constantly-shifting face region would lead to incorrect estimates of the pulse.", "Step 2: Control for changes in illumination. If you assume that the face and background are illuminated by the same light source, you can ignore color changes in the face if they co-occur with color changes in the background.", "Step 3: Face-tracking from step #1 takes care of certain types of face movements (ex translations), but other kinds are still problematic for the green-based analysis (ex eye-blinking or smiling). To avoid this problem, the authors simply exclude segments in time which contain a lot of problematic motion. They can do this because they measure average heart rate over a time window (ex 30 seconds). They identify such problematic regions by looking at the periods of time with color-channel variance. In other words, they are (correctly) suspicious if the average color of your face changes too dramatically and too quickly.", "Step 4: Finally, the authors apply a filter to exclude implausible signal information. Heart rates are known to be between 42 and 240 beats-per-minute (and usually exist in a much more narrow range), so color changes that happen more quickly or more slowly than that are excluded by standard signal-processing techniques.", "Their results on the public dataset [4] with 27 subjects using a 30 second window are within 3.5 heart beats of the actual value, on average, with a standard deviation just under 7.", "There are still a number of challenges that need to be solved before this technology becomes mainstream. One problem is accuracy, and another problem is robustness. Both could be fixed with more data, but collecting large datasets in a medical situation always requires a high degree of care, to protect patient information and preserve anonymity. Another problem is potential bias: algorithms trained from data need to work well on people of all skin colors.", "Being able to measure heart rate from video promises to make existing care more accessible, and unlocks a number of applications that are impossible with a human-in-the-loop. This article has hopefully demystified some of the algorithmic witchcraft behind the technique.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m a Bay Area software engineer who\u2019s no longer in the Bay. Trying to push the boundaries of ML in healthcare."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe129320a8bab&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e129320a8bab--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e129320a8bab--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shor.joel?source=post_page-----e129320a8bab--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shor.joel?source=post_page-----e129320a8bab--------------------------------", "anchor_text": "Shor Joel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F49a0448d486f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&user=Shor+Joel&userId=49a0448d486f&source=post_page-49a0448d486f----e129320a8bab---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe129320a8bab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe129320a8bab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://youtu.be/IHd9bYGJtoI?t=27", "anchor_text": "Star Trek tricorders"}, {"url": "https://en.wikipedia.org/wiki/Deepfake", "anchor_text": "Deepfake"}, {"url": "https://ieeexplore.ieee.org/document/6619284", "anchor_text": "Detecting Pulse from Head Motions in Video"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2717852/", "anchor_text": "Remote plethysmographic imaging using ambient light"}, {"url": "https://ieeexplore.ieee.org/abstract/document/6909939", "anchor_text": "Remote Heart Rate Measurement from Face Videos under Realistic Situations"}, {"url": "https://ieeexplore.ieee.org/document/5975141", "anchor_text": "A Multimodal Database for Affect Recognition and Implicit Tagging"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e129320a8bab---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----e129320a8bab---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e129320a8bab---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----e129320a8bab---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----e129320a8bab---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe129320a8bab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&user=Shor+Joel&userId=49a0448d486f&source=-----e129320a8bab---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe129320a8bab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&user=Shor+Joel&userId=49a0448d486f&source=-----e129320a8bab---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe129320a8bab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e129320a8bab--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe129320a8bab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e129320a8bab---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e129320a8bab--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e129320a8bab--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e129320a8bab--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e129320a8bab--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e129320a8bab--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e129320a8bab--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e129320a8bab--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e129320a8bab--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shor.joel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shor.joel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shor Joel"}, {"url": "https://medium.com/@shor.joel/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "78 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F49a0448d486f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&user=Shor+Joel&userId=49a0448d486f&source=post_page-49a0448d486f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff5b41d15f066&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-discovers-the-heart-beat-in-your-face-e129320a8bab&newsletterV3=49a0448d486f&newsletterV3Id=f5b41d15f066&user=Shor+Joel&userId=49a0448d486f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}