{"url": "https://towardsdatascience.com/decision-tree-build-prune-and-visualize-it-using-python-12ceee9af752", "time": 1683003615.2648342, "path": "towardsdatascience.com/decision-tree-build-prune-and-visualize-it-using-python-12ceee9af752/", "webpage": {"metadata": {"title": "Decision Tree: build, prune and visualize it using Python | by Gustavo Hideo | Towards Data Science", "h1": "Decision Tree: build, prune and visualize it using Python", "description": "Binary Tree is one of the most common and powerful data structures of the computing world. The main reason machine learning engineers like decision trees so much is that it has a low cost to process\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/what-is-a-decision-tree-22975f00f3e1", "anchor_text": "this article from Thomas Plapinger", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/titanic", "anchor_text": "Titanic", "paragraph_index": 1}], "all_paragraphs": ["Binary Tree is one of the most common and powerful data structures of the computing world. The main reason machine learning engineers like decision trees so much is that it has a low cost to process and it\u2019s really easy to understand (it\u2019s transparent, in opposition to the \u201cblack box\u201d from the neural network). It uses a branching method to go over every feature and its different outcomes finding patterns for the target values. For a more detailed explanation of decision trees and different methods of branching, check out this article from Thomas Plapinger.", "We will be using the Titanic data set from a Kaggle to predict survivors. We will import the data and select some features to work with. \u2018Survived\u2019 is our target value.", "Missing valuesWe have some missing values for \u2018age\u2019. To fix it, we could run some predictive analysis and fill up these spots, but that\u2019s not the goal for this article, so we will let it for a future story. For now, let\u2019s just drop those rows with missing values.", "Encoding categorical featuresTo keep all the features in numeric format, we will encode the \u2018Sex\u2019, that means to transform the values from \u2018female\u2019 and \u2018male\u2019 to 0 and 1.", "Splitting data set into train and test sets", "Building the decision tree classifierDecisionTreeClassifier() from sklearn is a good off the shelf machine learning model available to us. It has fit() and predict() methods. The fit() method is the \u201ctraining\u201d part of the modeling process. It finds the coefficients for the algorithm. Then, the predict() method will use the trained model to make predictions on a new set of data (test set).", "AccuracyTo determine how good our model is, we use another package from sklearn to give it a measure:", "Accuracy: 0.75It means that we have 75% accuracy in our predictions.", "We can plot the tree to see its root, branches, and nodes. We will use a set of new libraries to do so.", "StringIO(): creates an object (empty in this case) to receive a string buffer (the tree will be created first as a string before as an image) in DOT (graph description language) format.export_graphviz(): this function exports the tree in DOT format, generating a representation of the decision tree, which is written into the \u2018out_file\u2019.graph_from_dot_data(): will use the DOT object to create the graph.Image(): uses raw data to return an image (png, jpeg, gif).", "This tree seems pretty long. Let\u2019s change a couple of parameters to see if there is any effect on the accuracy and also to make the tree shorter.", "The gini method has a slight improvement over the entropy. Now, let\u2019s check if pruning the tree using max_depth can give us any better results. In the code chunk below, I create a simple function to run our model using different values for max_depth (from 1 to 30) and visualize its results to see how the accuracy differs for each value.", "It seems like in this scenario gini works best for longer trees (as we saw in the previous accuracies), but entropy does a better job for shorter trees and it\u2019s more accurate (near 0.82). So let\u2019s draw the tree with max_depth=7 and criterion=entropy to see how it looks like.", "We went from 0.75 of accuracy to 0.81 just by changing the function to create the branches and limiting the tree to avoid overfitting. Each case is different and it\u2019s a good practice to test different parameters to find the best for your scenario. As you learn new functions and machine learning models, don\u2019t hesitate in reading the documentation. It will give you a broader set of options to customize the model to your needs.", "Now, go ahead, use your new set of skills and save the planet by planting a tree.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F12ceee9af752&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----12ceee9af752--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----12ceee9af752--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gustavohideo?source=post_page-----12ceee9af752--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gustavohideo?source=post_page-----12ceee9af752--------------------------------", "anchor_text": "Gustavo Hideo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd7e4530589&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&user=Gustavo+Hideo&userId=d7e4530589&source=post_page-d7e4530589----12ceee9af752---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12ceee9af752&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12ceee9af752&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@brandgreen?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Brandon Green"}, {"url": "https://towardsdatascience.com/what-is-a-decision-tree-22975f00f3e1", "anchor_text": "this article from Thomas Plapinger"}, {"url": "https://www.kaggle.com/c/titanic", "anchor_text": "Titanic"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----12ceee9af752---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----12ceee9af752---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/data-science?source=post_page-----12ceee9af752---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----12ceee9af752---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----12ceee9af752---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F12ceee9af752&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&user=Gustavo+Hideo&userId=d7e4530589&source=-----12ceee9af752---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F12ceee9af752&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&user=Gustavo+Hideo&userId=d7e4530589&source=-----12ceee9af752---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12ceee9af752&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----12ceee9af752--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F12ceee9af752&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----12ceee9af752---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----12ceee9af752--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----12ceee9af752--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----12ceee9af752--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----12ceee9af752--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----12ceee9af752--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----12ceee9af752--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----12ceee9af752--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----12ceee9af752--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gustavohideo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gustavohideo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gustavo Hideo"}, {"url": "https://medium.com/@gustavohideo/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "76 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd7e4530589&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&user=Gustavo+Hideo&userId=d7e4530589&source=post_page-d7e4530589--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5d31a8cdae9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdecision-tree-build-prune-and-visualize-it-using-python-12ceee9af752&newsletterV3=d7e4530589&newsletterV3Id=5d31a8cdae9b&user=Gustavo+Hideo&userId=d7e4530589&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}