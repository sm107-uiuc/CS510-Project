{"url": "https://towardsdatascience.com/predicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3", "time": 1682996208.940755, "path": "towardsdatascience.com/predicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3/", "webpage": {"metadata": {"title": "Predicting 2018\u201319 NBA\u2019s Most Valuable Player using Machine Learning | by Daniel Bratuli\u0107 | Towards Data Science", "h1": "Predicting 2018\u201319 NBA\u2019s Most Valuable Player using Machine Learning", "description": "We are already quite deep in playoff basketball but the results of award votings haven\u2019t been released yet which gave me an idea to try and predict the results for MVP award. I found the data on\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.basketball-reference.com", "anchor_text": "basketball-reference", "paragraph_index": 1}, {"url": "https://www.basketball-reference.com/awards/awards_2016.html#mvp::none", "anchor_text": "example", "paragraph_index": 1}, {"url": "https://gist.github.com/danchyy/c80080fcfa08be61aa31a73d7cfa44fb", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/danchyy/Basketball_Analytics/blob/master/Scripts/2018_19_season/mvp_predictions/mvp_votings.csv", "anchor_text": "GitHub repo", "paragraph_index": 5}, {"url": "https://www.kaggle.com/danchyy/nba-mvp-votings-through-history", "anchor_text": "Kaggle", "paragraph_index": 5}, {"url": "https://www.basketball-reference.com/about/per.html", "anchor_text": "Player Efficiency Rating", "paragraph_index": 13}, {"url": "https://www.basketball-reference.com/about/bpm.html", "anchor_text": "Box Plus Minus", "paragraph_index": 14}, {"url": "https://www.basketball-reference.com/about/glossary.html", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://www.basketball-reference.com/about/ws.html", "anchor_text": "Win Shares", "paragraph_index": 17}, {"url": "https://github.com/danchyy/Basketball_Analytics/tree/master/Scripts/2018_19_season/mvp_predictions", "anchor_text": "GitHub repository", "paragraph_index": 30}, {"url": "https://github.com/danchyy/Basketball_Analytics/blob/master/Scripts/2018_19_season/mvp_predictions/Predicting%20MVP.ipynb", "anchor_text": "direct link", "paragraph_index": 46}, {"url": "https://github.com/danchyy/Basketball_Analytics", "anchor_text": "direct link", "paragraph_index": 47}, {"url": "https://www.kaggle.com/danchyy/nba-mvp-votings-through-history", "anchor_text": "Kaggle dataset", "paragraph_index": 48}], "all_paragraphs": ["We are already quite deep in playoff basketball but the results of award votings haven\u2019t been released yet which gave me an idea to try and predict the results for MVP award.", "I found the data on basketball-reference for each season all the way to 1968\u201369 season, but I used only the data from 1980\u201381 season, which is the first one where media voted, prior to that voting was done by players. Here is an example of how that data looks for season 2015\u201316.", "This was also the first and so far only case where a player was unanimously voted as MVP (each voter gave him first place vote).", "Along with data in the previous table, I scraped player profiles for some data that wasn\u2019t available, for example, BPM, PER, TS% more on that data in later sections.", "The code for that scraper can be found here.", "But I encourage you to avoid scraping it again since the data is already retrieved and can be found in my GitHub repo and Kaggle.", "So with the data being presented, I\u2019m going to define the problem that will be solved. Since this is a task of ranking, there aren\u2019t really any out of the box algorithms which solve that. I\u2019ll try to simplify this issue by approaching as a regression problem.", "The target value for our task will be Share column in the previous table. That number is always between zero and one and represents the points that are won by each player in voting.", "Because of the way the data is structured, we\u2019re basically trying to model how the media will vote for players this season. Of course, the regression is great for tackling such a problem, but the issue here lies in the data since it\u2019s quite unbalanced. On histogram of award share values, you can see that more than half of examples lie between 0.0 and 0.2 which can cause issues for models.", "Before I started to train and validate models, I\u2019ll explain what I will use as features and some simple feature selection processes.", "pts_per_g, ast_per_g, trb_per_g, stl_per_g, blk_per_g are simple stats. Points, assists, rebounds, steals, and blocks per game. mp_per_g stands for minutes per game, win_pct stands for win percentage by the team (there are 82 games in a season, so this value stands for games_won divided with games_total).", "fga, fg3a, fta are field goals attempted, three-pointers attempted and free throws attempted, and fg_pct, fg3_pct, ft_pct represent field goals percentage, three-pointer percentage, and free throw percentage.", "Now we come to some advanced statistics.", "PER stands for Player Efficiency Rating, and is basically a calculation of all positives and negatives simple stats.", "BPM stands for Box Plus Minus and is an advanced statistic for evaluating players\u2019 quality and contribution to the team. It takes more team based stats into the calculation in comparison to PER.", "TS_PCT stands for True Shooting Percentage, and calculation is rather simple (and actually included in stats above). Here is the formula:", "USG_PCT is short for Usage Percentage and is an estimate of team plays which a player uses while on the court. The calculation can be found here.", "And in the end, WS and WS_per_48 stand for Win Shares and Win shares per 48 minutes. That stat attempts to divide team success on individual members of the team.", "Now even in my short description of these statistics, you can see that they are similar, so that is why I went on and made several simple feature selection procedures to eliminate those which don\u2019t bring a lot of information.", "First one was finding out the dependency between variables using mutual information, this was done using sklearn\u2019s feature selection package.", "Then I used Random Forest regressors, I fitted instance of random forest and found the most important features for that model.", "And in the end, I found the correlation matrix between the features. That helped me the most because I had a good way of visualizing which features are very correlated and thus bringing duplicated information which in some situations doesn\u2019t help the model.", "On the previous image, you can view the correlations between all features in the dataset. After that, I removed those which are highly correlated or features which basically represent the same thing or can be represented by some scalar multiplications.", "With these several described procedures and the definitions of statistics which I described above, I decided to reduce the features to these final features:", "While there still is some correlation between them, I still decided to use these features as they seem the most appropriate to use. I tried to run an experiment with all features and that resulted in slower train time and worse results which means that this feature selection makes sense.", "I approached the cross-validation by using all seasons for train data except one season, which I used for validation. I trained each model in that way and averaged the results over each season.", "The metrics which I used were mean squared error for regression since I wanted to get an accurate representation of the media\u2019s voting. But I also sorted the results and measured the accuracy of rankings, which I used as a helper metric.", "For Regression I used the following models:", "I ran experiments with regular and polynomial features (polynomial degrees 2 and 3) in an above-described way. During the training, I experimented with and without scaling the data between 0 and 1, and the results didn\u2019t show much difference.", "Best results were achieved by Gradient Boosting Regressor, that model held the first 6 places (some models had different parameters or different degree of polynomials).", "Full results can be seen on my GitHub repository as well They are placed in three files called reg_results_mse_sorted.txt, reg_results_sorted_top_1.txt, and reg_results_sorted_top_5.txt.", "For the end, here are the predictions for this season. First I will show the results for several regression models which had the best Mean Squared Errors over all validation splits.", "The model with 50 estimators and 0.1 learning rate, also the features had a 2nd degree of polynomial features.", "Other variations of Gradient Boosting Regressor had similar results, with Harden being in the first place. Also, the markdown to pdf converter is awkward and spaced out the letters (I created the table in markdown and converted to pdf, then took a screenshot of that table to place here, a rough procedure I\u2019ll admit).", "The model with 50 estimators where features had a third degree of polynomials with interaction only.", "But for a bit different parameters, such as 100 estimators and 2nd degree of polynomial features with interaction only, the results were a bit different.", "Ridge is a regularized linear regression. Alpha with value 10 and polynomial features of 2nd degree showed to be the best results.", "Now I used the normal linear regression as well, and while the MSE was really good for this model, the results were rather funny.", "Since there is no regularization, the model probably overfitted on some features and gave these results. This is the only occurrence of Dwight Powell and Deandre Jordan in top 5, so they were excluded from charts you will see in next sections.", "This is a variation of Support Vector Machine which is used for regression. Here are the results for the model with C=100 and gamma=0.001.", "Also, since all of these models are regression models, they could, of course, overshoot the values, and go beyond 1.0 value which is the maximum. That isn\u2019t ideal but since we are most interested in rank we can live with that.", "On the following image, you can see the average score for each of the top 10 players based on top 50 models sorted by MSE metric.", "It is very close between Harden and Giannis but Harden has a slight advantage. After them, Jokic holds the third position even though he wasn\u2019t in top 5 predictions for the top model. And after that, all other scores are relatively similar, and in reality, will be a lot smaller than that.", "To conclude this post, I would like to congratulate to James Harden, the 2018\u201319 NBA\u2019s Most Valuable Player! Harden was predicted as MVP by most models I have trained and tested (including top model, Gradient Boosting Regressor with various different parameters), and when a person takes a moment and looks at his stats it should be logical for him to get it, however Giannis had amazing season as well and in my opinion media might be more biased towards him.", "I think I just scratched the surface with this post and all of the work I have done so far, I think that a lot more feature engineering, as well as scraping, can be done in order to obtain the data.", "I think a lot could be gained if data averages through team and through seasons generally could be obtained. As better normalization of the data can be achieved with it. Also, you could check out who stands out most in their team, in other words, who is carrying them the most (like James Harden this year). I wanted to do it as well, but I had to draw a line for now.", "I uploaded the full notebook which does all that was described in this post on my GitHub repository, here is a direct link to it.", "Also here is a direct link to my GitHub repository which has a lot more stuff connected with basketball and data science.", "I uploaded the dataset to Kaggle as well, here is a link to Kaggle dataset.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Trying to connect sports and data science."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F512e577032e3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----512e577032e3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----512e577032e3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@danielbratulic?source=post_page-----512e577032e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@danielbratulic?source=post_page-----512e577032e3--------------------------------", "anchor_text": "Daniel Bratuli\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8a822e9f7e24&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&user=Daniel+Bratuli%C4%87&userId=8a822e9f7e24&source=post_page-8a822e9f7e24----512e577032e3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F512e577032e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F512e577032e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@neonbrand?utm_source=medium&utm_medium=referral", "anchor_text": "Kenny Eliason"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://www.basketball-reference.com", "anchor_text": "basketball-reference"}, {"url": "https://www.basketball-reference.com/awards/awards_2016.html#mvp::none", "anchor_text": "example"}, {"url": "https://gist.github.com/danchyy/c80080fcfa08be61aa31a73d7cfa44fb", "anchor_text": "here"}, {"url": "https://github.com/danchyy/Basketball_Analytics/blob/master/Scripts/2018_19_season/mvp_predictions/mvp_votings.csv", "anchor_text": "GitHub repo"}, {"url": "https://www.kaggle.com/danchyy/nba-mvp-votings-through-history", "anchor_text": "Kaggle"}, {"url": "https://www.basketball-reference.com/about/per.html", "anchor_text": "Player Efficiency Rating"}, {"url": "https://www.basketball-reference.com/about/bpm.html", "anchor_text": "Box Plus Minus"}, {"url": "https://www.basketball-reference.com/about/glossary.html", "anchor_text": "here"}, {"url": "https://www.basketball-reference.com/about/ws.html", "anchor_text": "Win Shares"}, {"url": "https://github.com/danchyy/Basketball_Analytics/tree/master/Scripts/2018_19_season/mvp_predictions", "anchor_text": "GitHub repository"}, {"url": "https://github.com/danchyy/Basketball_Analytics/blob/master/Scripts/2018_19_season/mvp_predictions/Predicting%20MVP.ipynb", "anchor_text": "direct link"}, {"url": "https://github.com/danchyy/Basketball_Analytics", "anchor_text": "direct link"}, {"url": "https://www.kaggle.com/danchyy/nba-mvp-votings-through-history", "anchor_text": "Kaggle dataset"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----512e577032e3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/regression?source=post_page-----512e577032e3---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/visualization?source=post_page-----512e577032e3---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/sports?source=post_page-----512e577032e3---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/data-journalism?source=post_page-----512e577032e3---------------data_journalism-----------------", "anchor_text": "Data Journalism"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F512e577032e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&user=Daniel+Bratuli%C4%87&userId=8a822e9f7e24&source=-----512e577032e3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F512e577032e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&user=Daniel+Bratuli%C4%87&userId=8a822e9f7e24&source=-----512e577032e3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F512e577032e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----512e577032e3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F512e577032e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----512e577032e3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----512e577032e3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----512e577032e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----512e577032e3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----512e577032e3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----512e577032e3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----512e577032e3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----512e577032e3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----512e577032e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@danielbratulic?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@danielbratulic?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Daniel Bratuli\u0107"}, {"url": "https://medium.com/@danielbratulic/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "49 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8a822e9f7e24&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&user=Daniel+Bratuli%C4%87&userId=8a822e9f7e24&source=post_page-8a822e9f7e24--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F8a822e9f7e24%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-2018-19-nbas-most-valuable-player-using-machine-learning-512e577032e3&user=Daniel+Bratuli%C4%87&userId=8a822e9f7e24&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}