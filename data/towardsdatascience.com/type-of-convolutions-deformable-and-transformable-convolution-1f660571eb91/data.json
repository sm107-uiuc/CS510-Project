{"url": "https://towardsdatascience.com/type-of-convolutions-deformable-and-transformable-convolution-1f660571eb91", "time": 1682997051.457931, "path": "towardsdatascience.com/type-of-convolutions-deformable-and-transformable-convolution-1f660571eb91/", "webpage": {"metadata": {"title": "Type of convolutions: Deformable and Transformable Convolution | by Ali Raza | Towards Data Science", "h1": "Type of convolutions: Deformable and Transformable Convolution", "description": "If you\u2019ve ever heard of Deformable or Transformable convolution and got confused what they actually mean, this article is for you. I will try to explain two less known but very interesting\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1703.06211", "anchor_text": "J. Dai, H. Qi, Y Xiong, Y Li, G Zhang, H Hu, Y Wei, Deformable Convolutional Networks (2017), Microsoft Research Asia", "paragraph_index": 36}, {"url": "https://www.ijcai.org/proceedings/2018/0625.pdf", "anchor_text": "J. Dai, H. Qi, Y Xiong, Y Li, G Zhang, H Hu, Y Wei, Transformable Convolutional Neural Network for Text Classification (2018), International Joint Conference on Artificial Intelligence (IJCAI)", "paragraph_index": 37}], "all_paragraphs": ["If you\u2019ve ever heard of Deformable or Transformable convolution and got confused what they actually mean, this article is for you. I will try to explain two less known but very interesting convolutions to you, in an intuitive way.", "With the assumption that you are already familiar with standard convolution, I will start from presenting standard convolution in an intuitive (but not usual) way, leading up to deformable and transformable convolutions.", "The content of this article includes:", "First, we need to understand a standard 2D convolution operation. A standard 2D convolution applies 2D filters/kernels over the input at fixed perceptive field and spatial locations to generate the output feature map. Certain parameters are involved in the convolution operation named as kernel size, stride, and padding.", "Kernel size: Defines the field of view of the convolution.", "Stride: Defines the step size of the kernel when traversing the image.", "Padding: Defines how the border of a sample is handled. For instance, for a kernel of 3 with stride of 1, no padding would result in down-sampling.", "Standard convolution is essentially applying a sampling matrix over the image to extract samples of inputs and then apply kernel over it. Following figure illustrates the concept of sampling matrix:", "For any p\u2092 position in the input, the sampling matrix (represented as green rectangular shaped grid) defines how the points should be sampled from input, to apply the kernel (represented as dark blue map over the input grid) as seen in Figure 2.", "The shape of the kernel can be described by a center position p\u2092 and the sampling locations p\u1d62, the relative distances from the p\u2092. The collection of these sampling locations p\u2092,\u2026.,p\u1d62 is called the sampling matrix.", "Output feature map is generated by a convolution operation between kernel w and the input x, which can be formulated as y = w * x and every element in feature map y can be calculated as:", "where p\u2092 is the center location of sample in input, and p\u1d62 enumerates the points in the collection of sampling points (i.e sampling matrix).", "Given a sampling matrix, we can change the offsets (p\u1d62) for getting any arbitrary receptive field in the input for applying the kernel.", "In a standard convolution operation, offsets are always 1 in all directions as defined in Figure 2.", "In another type of convolution, called dilated convolution (a.k.a. atrous convolutions), an offset greater than 1 is used, allowing for a bigger receptive field for applying the kernel (Figure 3).", "If you are able to follow along so far and have understood the concept of sampling matrix, understanding deformable and transformable convolutions should would be very easy at this stage. But first let\u2019s talk about an inherent limitation of the standard convolution operation.", "CNNs are inherently limited to model large unknown transformations because of the fixed geometric structure of the sampling matrix. For one example, the receptive field sizes of all activation units in the same CNN layer are the same.", "Because different locations in the input feature maps may correspond to objects with different scales or deformation, adaptive determination of scales or receptive field sizes is desirable for certain tasks.", "For example, in Natural Language Processing, capturing different adaptable features from transformable and non-consecutive language phrases using traditional CNNs pose a great challenge, for instance, directly capturing the \u201cnot\u2026.good\u201d pattern from phrase \u201cnot nearly as good\u201d. Also, capturing above pattern from different transformed forms like \u201cnot so good\u201d and \u201cnot even good\u201d is difficult.", "What if we could make the sampling matrix adaptive to the transformations of features in the input?", "Both the deformable and transformable convolutions try to solve the above problem by introducing parameters to learn adaptive sampling matrix (a.k.a offset or deviation matrix, usually denoted as R or C) for recognizing various transformations of the same pattern.", "Deformable convolution introduces the mechanism of deformable module, which has learn-able shape to adapt to the changes of features. Conventionally, the shapes of kernels and samples in convolution, defined by the sampling matrix, is fixed from the start.", "Deformable convolution makes the sampling matrix learn-able, allowing the shape of the kernel to adopt to the unknown complex transformations in the input. Let\u2019s take a look at the following figure to understand the concept. [1]", "Instead of using the fixed sampling matrix with fixed offsets, as in standard convolution in Figure 2, the deformable convolution learns the sampling matrix with location offsets. The offsets are learned from the preceding feature maps, via additional convolutional layers.", "Thus the deformation is conditioned on the input features in a local, dense, and adaptive manner.", "To put this into equation, in deformable convolution, the regular sampling matrix C is augmented with offsets {\u2206p\u1d62|n = 1, \u2026, N}, where N = |C|.", "where p\u2092 is the center location of sample in input, and p\u1d62 enumerates the points in the collection C of sampling/offset points. Now the sampling is on the irregular and offset locations p\u1d62 + \u2206p\u1d62 i.e. sampling locations of kernel are redistributed, and are not in the shape of regular rectangle any longer.", "Like deformable convolution, transformable convolution also adds the position offsets onto the kernels, making their shapes flexible and adaptable through a sampling matrix.", "But transformable convolution takes it to the next step by splitting the sampling matrix into two matrices named as dynamic and static deviations.", "Hence, two samples are taken from the input using two learned sampling matrices and added together for getting the output feature map.", "At inference stage, the dynamic deviations are related to the current input, whose values are actively learned from current features to capture the current transformation information (just like the offset matrix in deformed convolution).", "Values of static deviations are updated by back-propagation and keep static at inference state, which describes the global distribution of shape information.", "Hence, the sampling matrix C is divided into two parts, one is current feature related, and the other is globally dependent. Let D\ud835\udcb8 \u2282 C and S\ud835\udcb8 \u2282 C denote them respectively. Then they are added with different deviations/offsets \u2206p\u1d62 for D\ud835\udcb8 and \u2206p\u1d62 for S\ud835\udcb8 to adjust the sampling locations.", "Here, again the sampling is on the irregular and offset locations p\u1d62 + \u2206p\u1d62 and p\u1d62 + \u2206p\u1d62 i.e. the sampling locations of kernel are redistributed, and are not in the shape of rectangle. But instead of one, two samples are taken, one based on static deviation matrix and the other based on dynamic deviation matrix. Kernel is then convolved on both the samples and result is added to get an element in the output feature map.", "I hope this article makes it easier for you to develop an intuitive understanding of the two convolutions and serves as a useful reference to your studies/research.", "Thank you for reading the article.. Please feel free to leave questions and comments below if you have any confusions.", "[1] J. Dai, H. Qi, Y Xiong, Y Li, G Zhang, H Hu, Y Wei, Deformable Convolutional Networks (2017), Microsoft Research Asia", "[2] J. Dai, H. Qi, Y Xiong, Y Li, G Zhang, H Hu, Y Wei, Transformable Convolutional Neural Network for Text Classification (2018), International Joint Conference on Artificial Intelligence (IJCAI)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer at Revolut, Berlin"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f660571eb91&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f660571eb91--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f660571eb91--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ali.raza.nisar?source=post_page-----1f660571eb91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ali.raza.nisar?source=post_page-----1f660571eb91--------------------------------", "anchor_text": "Ali Raza"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf87cfc58c0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&user=Ali+Raza&userId=bf87cfc58c0a&source=post_page-bf87cfc58c0a----1f660571eb91---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f660571eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f660571eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1703.06211.pdf", "anchor_text": "Microsoft Research Asia"}, {"url": "https://arxiv.org/abs/1703.06211", "anchor_text": "J. Dai, H. Qi, Y Xiong, Y Li, G Zhang, H Hu, Y Wei, Deformable Convolutional Networks (2017), Microsoft Research Asia"}, {"url": "https://www.ijcai.org/proceedings/2018/0625.pdf", "anchor_text": "J. Dai, H. Qi, Y Xiong, Y Li, G Zhang, H Hu, Y Wei, Transformable Convolutional Neural Network for Text Classification (2018), International Joint Conference on Artificial Intelligence (IJCAI)"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1f660571eb91---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----1f660571eb91---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----1f660571eb91---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1f660571eb91---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f660571eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&user=Ali+Raza&userId=bf87cfc58c0a&source=-----1f660571eb91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f660571eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&user=Ali+Raza&userId=bf87cfc58c0a&source=-----1f660571eb91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f660571eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f660571eb91--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f660571eb91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f660571eb91---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f660571eb91--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f660571eb91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f660571eb91--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f660571eb91--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f660571eb91--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f660571eb91--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f660571eb91--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f660571eb91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ali.raza.nisar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ali.raza.nisar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ali Raza"}, {"url": "https://medium.com/@ali.raza.nisar/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "49 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf87cfc58c0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&user=Ali+Raza&userId=bf87cfc58c0a&source=post_page-bf87cfc58c0a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe03f5ca2bfa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftype-of-convolutions-deformable-and-transformable-convolution-1f660571eb91&newsletterV3=bf87cfc58c0a&newsletterV3Id=e03f5ca2bfa3&user=Ali+Raza&userId=bf87cfc58c0a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}