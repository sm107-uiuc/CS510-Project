{"url": "https://towardsdatascience.com/one-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d", "time": 1683004963.944265, "path": "towardsdatascience.com/one-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d/", "webpage": {"metadata": {"title": "One Potential Cause of Overfitting That I Never Noticed Before | by Yufeng | Towards Data Science", "h1": "One Potential Cause of Overfitting That I Never Noticed Before", "description": "Honestly, based on her description, I couldn\u2019t think of anywhere wrong in the procedure. However, after my checking her code line by line, I found the issue that caused the overfitting problem and I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/preprocessing.html#imputation-of-missing-values", "anchor_text": "imputer", "paragraph_index": 8}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler", "anchor_text": "scaler", "paragraph_index": 8}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "sklearn", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html", "anchor_text": "TimeSeriesSplit", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html", "anchor_text": "k-fold", "paragraph_index": 11}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html", "anchor_text": "stratified k-fold", "paragraph_index": 11}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "sklearn", "paragraph_index": 13}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html", "anchor_text": "RandomForestRegressor", "paragraph_index": 13}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html", "anchor_text": "RandomForestRegressor", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Random_forest", "anchor_text": "tree in your random forest model", "paragraph_index": 18}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html", "anchor_text": "each leave is pure or all leaves have at most m samples", "paragraph_index": 18}, {"url": "https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff", "anchor_text": "tradeoff between bias and variance", "paragraph_index": 19}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html", "anchor_text": "RandomForestRegressor", "paragraph_index": 21}, {"url": "https://medium.com/@falcaopetri", "anchor_text": "Antonio Carlos", "paragraph_index": 30}, {"url": "https://towardsdatascience.com/pre-process-data-with-pipeline-to-prevent-data-leakage-during-cross-validation-e3442cca7fdc", "anchor_text": "Pre-Process Data with Pipeline to Prevent Data Leakage during Cross-Validation", "paragraph_index": 30}, {"url": "https://jianan-lin.medium.com/membership", "anchor_text": "https://jianan-lin.medium.com/membership", "paragraph_index": 34}], "all_paragraphs": ["\u201cWhy is my tuned model still overfitting?\u201d", "\u201cWhat model did you use and what are the hyperparameters you tuned?\u201d", "\u201cRandom Forest regressor and I tuned tree number and maximum feature numbers per tree.\u201d", "\u201cI need to check your code.\u201d", "This was the dialogue between my wife and me when she was doing a mini-project.", "Honestly, based on her description, I couldn\u2019t think of anywhere wrong in the procedure. However, after my checking her code line by line, I found the issue that caused the overfitting problem and I have never thought of before.", "This is the block of code that tuned the model in the training dataset and it is also where the problem happened.", "The pre_pipeline in the code is a pipeline for missing value imputation and feature scaling, both of which are essential steps in data pre-processing. Here is what it looks like:", "The imputer she used here is to replace the NA values by the column median, and the scaler is the standard scaler which normalizes the columns as:", "where u is the mean and s is the standard deviation of the column [1]. Some other imputers and scalers in the sklearn package can also be used. But this part is not related to the overfitting problem.", "Here she used a method specifically designed for time-series data, TimeSeriesSplit.", "Usually, people use k-fold cross-validation to randomly split the training data or stratified k-fold cross-validation to preserve the percentage of samples for each class [2]. But these two methods are not suitable for time-series data because they don\u2019t keep the raw order of the data points.", "This step is pretty standard and cannot be related to the overfitting problem.", "As for hyperparameter tuning, a set of candidates should be given, which are usually defined as a dictionary format in sklearn package. The names of the hyperparameters are from the model to build, for example, RandomForestRegressor in my wife\u2019s code.", "The so-called \u201ctuning-hyperparameter\u201d step is to select the best hyperparameter combination from your given candidates that outperforms other combinations of hyperparameters in the cross-validation procedure.", "It is the part that resulted in the overfitting problem.", "If we refer to the manual page of Random Forest Regressor in sklearn, we can see a long list of parameters in the function RandomForestRegressor (not listed here, please refer to the webpage if interested).", "However, in the code above, only n_estimators and max_features were passed to the function during the tuning process, which resulted in that all the other parameters took the default values.", "One of the parameters in the function is called max_depth, which is the maximum depth of the tree in your random forest model. The default value of it is \u201cNone\u201d, which means that the decision tree will go as deep as that each leave is pure or all leaves have at most m samples, where m is defined by min_samples_split (default = 2).", "This setting significantly increased the complexity of the trained model. And based on the tradeoff between bias and variance, the model trained in the code above had low bias and high variance. Of course, it finally led to the overfitting problem.", "I solved the problem by adding max_depth to the hyperparameter space.", "Actually, there are some other parameters that can affect the complexity of the model in RandomForestRegressor, but it is not recommended to put all of them into the hyperparameter space.", "The extra hyperparameter in the code above already increased the computation cost by three folds. So, it\u2019s not worth increasing the running time exponentially to just tune more parameters.", "Instead, you can set some of them in the model initiation like this.", "In the code above, the only tuned hyperparameter is n_estimators, and max_features, as well as max_depth, are fixed during the training process. The tuned or fixed parameters do not have to be like that.", "The rationale of the setting is to reduce the computational cost when you already have some idea on the selection of some hyperparameters.", "Yes, my wife\u2019s problem has been solved. To be honest, however, I could not have found it until I went over all the default parameters in the package. That\u2019s why I want to share this experience with you so that you can be more careful about the default parameters in your machine learning model training processes.", "Overfitting is one of the most common problems in data science, which mostly comes from the high complexity of the model and the lack of data points.", "To avoid it, it\u2019s better to take full control of the packages you use.", "Hope this piece of advice can help you.", "I would like to thank Antonio Carlos for pointing out this issue in my original post. He also suggested a nice post \u201cPre-Process Data with Pipeline to Prevent Data Leakage during Cross-Validation.\u201d to the topic. I really appreciate that.", "It is related to the pre-processing part of the pipeline. It shouldn\u2019t have been done on the entire training dataset, but on each iteration of the Cross-Validation step because the overall normalization of the training data will cause leakage between the train and validation dataset in the CV step.", "So, I put the corrected code with a corresponding revision as below:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D., Data Scientist and Bioinformatician. Support my writing by becoming one of my referred members: https://jianan-lin.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa57904c8c89d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jianan-lin.medium.com/?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": "Yufeng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cda0369fb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&user=Yufeng&userId=9cda0369fb2&source=post_page-9cda0369fb2----a57904c8c89d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa57904c8c89d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa57904c8c89d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@joaosilas?utm_source=medium&utm_medium=referral", "anchor_text": "Jo\u00e3o Silas"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html#imputation-of-missing-values", "anchor_text": "imputer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler", "anchor_text": "scaler"}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "sklearn"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html", "anchor_text": "TimeSeriesSplit"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html", "anchor_text": "k-fold"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html", "anchor_text": "stratified k-fold"}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "sklearn"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html", "anchor_text": "RandomForestRegressor"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html", "anchor_text": "RandomForestRegressor"}, {"url": "https://en.wikipedia.org/wiki/Random_forest", "anchor_text": "tree in your random forest model"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html", "anchor_text": "each leave is pure or all leaves have at most m samples"}, {"url": "https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff", "anchor_text": "tradeoff between bias and variance"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html", "anchor_text": "RandomForestRegressor"}, {"url": "https://unsplash.com/@sortino?utm_source=medium&utm_medium=referral", "anchor_text": "Joshua Sortino"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html"}, {"url": "https://en.wikipedia.org/wiki/Random_forest", "anchor_text": "https://en.wikipedia.org/wiki/Random_forest"}, {"url": "https://medium.com/@falcaopetri", "anchor_text": "Antonio Carlos"}, {"url": "https://towardsdatascience.com/pre-process-data-with-pipeline-to-prevent-data-leakage-during-cross-validation-e3442cca7fdc", "anchor_text": "Pre-Process Data with Pipeline to Prevent Data Leakage during Cross-Validation"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a57904c8c89d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/overfitting?source=post_page-----a57904c8c89d---------------overfitting-----------------", "anchor_text": "Overfitting"}, {"url": "https://medium.com/tag/life-lessons?source=post_page-----a57904c8c89d---------------life_lessons-----------------", "anchor_text": "Life Lessons"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a57904c8c89d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----a57904c8c89d---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa57904c8c89d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&user=Yufeng&userId=9cda0369fb2&source=-----a57904c8c89d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa57904c8c89d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&user=Yufeng&userId=9cda0369fb2&source=-----a57904c8c89d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa57904c8c89d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa57904c8c89d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a57904c8c89d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a57904c8c89d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a57904c8c89d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a57904c8c89d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a57904c8c89d--------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yufeng"}, {"url": "https://jianan-lin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "728 Followers"}, {"url": "https://jianan-lin.medium.com/membership", "anchor_text": "https://jianan-lin.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cda0369fb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&user=Yufeng&userId=9cda0369fb2&source=post_page-9cda0369fb2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff12c76e2ba88&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-potential-cause-of-overfitting-that-i-never-noticed-before-a57904c8c89d&newsletterV3=9cda0369fb2&newsletterV3Id=f12c76e2ba88&user=Yufeng&userId=9cda0369fb2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}