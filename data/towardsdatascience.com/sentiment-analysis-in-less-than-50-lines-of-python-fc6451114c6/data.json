{"url": "https://towardsdatascience.com/sentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6", "time": 1683006689.5649579, "path": "towardsdatascience.com/sentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6/", "webpage": {"metadata": {"title": "Sentiment analysis in less than 50 lines of Python | by Alexander Bailey | Towards Data Science", "h1": "Sentiment analysis in less than 50 lines of Python", "description": "Natural language processing (NLP) can be a daunting topic to understand. NLP covers a huge range of different disciplines and modelling techniques from topic analysis to machine translation and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948", "anchor_text": "excellent material", "paragraph_index": 1}, {"url": "https://www.kaggle.com/c/tweet-sentiment-extraction/overview", "anchor_text": "Kaggle", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/tf-idf-for-document-ranking-from-scratch-in-python-on-real-world-dataset-796d339a4089", "anchor_text": "TFIFD embedding", "paragraph_index": 8}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier.fit", "anchor_text": "sk-learn\u2019s random forest classifier", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/what-is-out-of-bag-oob-score-in-random-forest-a7fa23d710", "anchor_text": "this", "paragraph_index": 10}, {"url": "https://github.com/cjhutto/vaderSentiment#features-and-updates", "anchor_text": "VADER", "paragraph_index": 16}], "all_paragraphs": ["Natural language processing (NLP) can be a daunting topic to understand. NLP covers a huge range of different disciplines and modelling techniques from topic analysis to machine translation and speech recognition to speech synthesis. Sentiment analysis is included within the NLP family and is the process of quantifying the sentiment expressed within a piece of text. Typically, sentiment is evaluated on the basis of how positive or negative the text is.", "State-of-the-art sentiment analysis techniques often involve recurrent neural networks like Long Short Term Memory models (LSTMs) or computationally expensive BERT embedding and plenty of excellent material has been written on how to create and train these. However, maybe you don\u2019t need complex modelling or vast swathes of code to achieve competitive performance.", "So how can we go about creating our own sentiment analysis model?", "The data used here can be found on Kaggle and comprises of 27,481 labelled tweets in the training set and 3,534 tweets in the test set. So let\u2019s go ahead and load the data using every data scientist\u2019s best friend, Pandas:", "And let\u2019s do the same for the test set:", "Notice that the test set doesn\u2019t have the selected_text column. So let's make sure that any data cleaning we do is applied to the text column for both the training and test set.", "For the sake of simplicity, we don\u2019t want to overdo it on the cleaning front but there are a few simple things that we can do to help any model identify sentiment. The data cleaning process is as follows:", "Whilst we\u2019re cleaning, we can also map the sentiment labels to integers and return them from the same function.", "Now we need to tokenize each tweet into a single, fixed-length vector \u2014 specifically a TFIFD embedding. To achieve this we can use Keras\u2019s built-in Tokenizer(), fit to the training data.", "Next, we need to choose our model. When it comes to sentiment analysis, the world is your oyster, however to keep this short & sweet we turn to every data scientist\u2019s second best-friend, sk-learn\u2019s random forest classifier:", "n_estimators and num_samples_leaf were chosen with a small amount of hyper-parameter tuning to try and maximise score whilst avoiding over-fitting. This gives us a training score of 0.77 and an out of bag score of 0.69 (for more on out of the bag scoring, this article explains it well but the TL;DR is that it\u2019s a proxy for a validation score for a random forest).", "Now, let\u2019s take a look at the performance on the test set:", "This evaluates to 0.69, so we\u2019re shaping up nicely so far!", "sk-learn makes it easy to take both the classifier and test data to produce a confusion matrix showing the performance on the test set as follows:", "As the confusion matrix shows, so far, so good when it comes to our humble random forest.", "This tells us a lot about the types of mistakes we made. Most of them occur when predicting the difference between positive and neutral and negative and neutral sentiment, which in the grand scheme of mistakes, isn\u2019t the worst one to have. Whereas thankfully, we rarely confuse positive with negative sentiment and vice versa.", "VADER is a \u201crule-based sentiment analysis tool that is specifically attuned to sentiments expressed in social media\u201d. But, importantly for us, it\u2019s an out of the box model that can be used as a benchmark.", "Given the threshold of 0.5, VADER achieves roughly the same true-positive rate on the neutral sentiment class, but worse performance than our model on both the positive and negative sentiment classes \u2014 good to know it was worthwhile training our own model!", "Sentiment analysis isn\u2019t that mythical beast it may appear to be. Of course, we could do better if we increased the model complexity, improved data cleaning and used more complex embeddings, we were still able to achieve reasonable performance without the need for any of that. When you consider that the current Kaggle competition leader has a score of 0.73 and we have managed to hit 0.69 with less than 50 lines of code, I\u2019m happy to leave it there\u2026", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist trying to learn something new"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffc6451114c6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc6451114c6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc6451114c6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alexanderbailey?source=post_page-----fc6451114c6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=post_page-----fc6451114c6--------------------------------", "anchor_text": "Alexander Bailey"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb3e72c9d461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&user=Alexander+Bailey&userId=db3e72c9d461&source=post_page-db3e72c9d461----fc6451114c6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc6451114c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc6451114c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/Free-Photos-242387/", "anchor_text": "Free-Photos-242387"}, {"url": "https://towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948", "anchor_text": "excellent material"}, {"url": "https://www.kaggle.com/c/tweet-sentiment-extraction/overview", "anchor_text": "Kaggle"}, {"url": "https://towardsdatascience.com/tf-idf-for-document-ranking-from-scratch-in-python-on-real-world-dataset-796d339a4089", "anchor_text": "TFIFD embedding"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier.fit", "anchor_text": "sk-learn\u2019s random forest classifier"}, {"url": "https://towardsdatascience.com/what-is-out-of-bag-oob-score-in-random-forest-a7fa23d710", "anchor_text": "this"}, {"url": "https://github.com/cjhutto/vaderSentiment#features-and-updates", "anchor_text": "VADER"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fc6451114c6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fc6451114c6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fc6451114c6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----fc6451114c6---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----fc6451114c6---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc6451114c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&user=Alexander+Bailey&userId=db3e72c9d461&source=-----fc6451114c6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc6451114c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&user=Alexander+Bailey&userId=db3e72c9d461&source=-----fc6451114c6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc6451114c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc6451114c6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffc6451114c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fc6451114c6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc6451114c6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fc6451114c6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fc6451114c6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fc6451114c6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fc6451114c6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fc6451114c6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fc6451114c6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fc6451114c6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexander Bailey"}, {"url": "https://medium.com/@alexanderbailey/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "156 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb3e72c9d461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&user=Alexander+Bailey&userId=db3e72c9d461&source=post_page-db3e72c9d461--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff756d91c4fbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-in-less-than-50-lines-of-python-fc6451114c6&newsletterV3=db3e72c9d461&newsletterV3Id=f756d91c4fbd&user=Alexander+Bailey&userId=db3e72c9d461&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}