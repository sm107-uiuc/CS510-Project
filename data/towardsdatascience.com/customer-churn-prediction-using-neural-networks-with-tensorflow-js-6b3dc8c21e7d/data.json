{"url": "https://towardsdatascience.com/customer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d", "time": 1683000738.911743, "path": "towardsdatascience.com/customer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d/", "webpage": {"metadata": {"title": "Customer churn prediction using Neural Networks with TensorFlow.js | by Venelin Valkov | Towards Data Science", "h1": "Customer churn prediction using Neural Networks with TensorFlow.js", "description": "Learn about Deep Learning and create Deep Neural Network model to predict customer churn using TensorFlow.js. Learn how to preprocess string categorical data."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "Kaggle", "paragraph_index": 6}, {"url": "https://www.papaparse.com/", "anchor_text": "Papa Parse", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Deep_learning#Deep_neural_networks", "anchor_text": "Deep Artificial Neural Networks", "paragraph_index": 24}, {"url": "https://paperswithcode.com/sota", "anchor_text": "holding state-of-the-art scores", "paragraph_index": 28}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow", "paragraph_index": 30}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch", "paragraph_index": 30}, {"url": "https://mxnet.apache.org/", "anchor_text": "MXNet", "paragraph_index": 30}, {"url": "https://chainer.org/", "anchor_text": "Chainer", "paragraph_index": 30}, {"url": "https://en.wikipedia.org/wiki/One-hot", "anchor_text": "one-hot", "paragraph_index": 35}, {"url": "https://js.tensorflow.org/api/latest/#oneHot", "anchor_text": "tf.oneHot()", "paragraph_index": 35}, {"url": "https://en.wikipedia.org/wiki/Feature_scaling", "anchor_text": "normalize it", "paragraph_index": 36}, {"url": "https://js.tensorflow.org/api/latest/#sequential", "anchor_text": "sequential model API", "paragraph_index": 42}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU", "paragraph_index": 43}, {"url": "https://js.tensorflow.org/api/latest/#train.adam", "anchor_text": "Adam optimizer", "paragraph_index": 44}, {"url": "https://js.tensorflow.org/api/latest/#metrics.binaryCrossentropy", "anchor_text": "Binary Crossentropy", "paragraph_index": 44}, {"url": "https://js.tensorflow.org/api/latest/#tf.Sequential.fit", "anchor_text": "fit", "paragraph_index": 45}, {"url": "https://github.com/tensorflow/tfjs-vis", "anchor_text": "tfjs-vis", "paragraph_index": 45}], "all_paragraphs": ["TL;DR Learn about Deep Learning and create Deep Neural Network model to predict customer churn using TensorFlow.js. Learn how to preprocess string categorical data.", "First day! You\u2019ve landed this Data Scientist intern job at a large telecom company. You can\u2019t stop dreaming about the Lambos and designer clothes you\u2019re going to get once you\u2019re a Senior Data Scientist.", "Even your mom is calling to remind you to put your Ph.D. in Statistics diploma on the wall. This is the life, who cares about that you\u2019re in your mid-30s and this is your first job ever.", "Your team lead comes around, asking how do you enjoy the job and saying that he might have a task for you! You start imagining implementing complex statistical models from scratch, doing research, and adding cutting-edge methods but\u2026 Well, the reality is slightly different. He sent you a link to a CSV fail and asks you to predict customer churn. He suggests that you might to try to apply Deep Learning to the problem.", "Your dream is starting now. Time do to some work!", "Run the complete source code for this tutorial right in your browser:", "Our dataset Telco Customer Churn comes from Kaggle.", "\u201cPredict behavior to retain customers. You can analyze all relevant customer data and develop focused customer retention programs.\u201d [IBM Sample Data Sets]", "The data set includes information about:", "We\u2019ll use Papa Parse to load the data:", "Note that we ignore the last row since it is empty.", "Let\u2019s get a feeling of our dataset. How many of the customers churned?", "About 74% of the customers are still using the company services. We have a very unbalanced dataset.", "Does gender play a role in losing customers?", "Seems like it doesn\u2019t. We have about the same amount of female and male customers. How about seniority?", "About 20% of the customers are senior, and they are much more likely to churn, compared to the nonseniors.", "For how long customers stay with the company?", "It seems like the more you stay, the more likely you\u2019re to stay with the company.", "How do monthly charges affect churn?", "A customer with low monthly charges (< $30) produce is much more likely to be retained.", "How about the total amount charged per customer?", "The higher the total amount charged by the company, the more likely it is for this customer to be retained.", "Our dataset has a total of 21 features, and we didn\u2019t look through all of those. However, we found some interesting stuff.", "We\u2019ve learned that SeniorCitizen, tenure, MonthlyCharges, and TotalCharges are somewhat correlated with the churn status. We\u2019ll use them for our model!", "Deep Learning is a subset of Machine Learning, using Deep Artificial Neural Networks as a primary model to solve a variety of tasks.", "To obtain a Deep Neural Network, take a Neural Network with one hidden layer (shallow Neural Network) and add more layers. That\u2019s the definition of a Deep Neural Network \u2014 Neural Network with more than one hidden layer!", "In Deep Neural Networks, each layer of neurons is trained on the features/outputs of the previous layer. Thus, you can create a feature hierarchy of increasing abstraction and learn complex concepts.", "These networks are very good at discovering patterns within raw data (images, texts, video, and audio recordings), which is the most amounts of data we have. For example, Deep Learning can take millions of images and categorize them into photos of your grandma, funny cats, and delicious cakes.", "Deep Neural Nets are holding state-of-the-art scores on a variety of important problems. Examples are image recognition, image segmentation, sound recognition, recommender systems, natural language processing, etc.", "So basically, Deep Learning is Large Neural Networks. Why now? Why Deep Learning wasn\u2019t practical before?", "Last but not least, we have software that is performant and (sometimes) easy to use. Libraries like TensorFlow, PyTorch, MXNet and Chainer allows practitioners to develop, analyze, test and deploy models of varying complexity and reuse work done by other practitioners and researchers.", "Let\u2019s use the \u201call-powerful\u201d Deep Learning machinery to predict which customers are going to churn. First, we need to do some data preprocessing since a lot of the features are categorical.", "We\u2019ll use all numerical (except customerID) and the following categorical features:", "Let\u2019s create training and testing datasets from our data:", "Here\u2019s how we create our Tensors:", "First, we use the function toCategorical() to convert categorical features into one-hot encoded vectors. We do that by converting the string values into numbers and use tf.oneHot() to create the vectors.", "We create a 2-dimensional Tensor from our features (categorical and numerical) and normalize it. Another, one-hot encoded, Tensor is made from the Churn column.", "Finally, we split the data into training and testing datasets and return the results. How do we encode categorical variables?", "First, we extract a vector of all values for the feature. Next, we obtain the unique values and create a string to int mapping from it.", "Note that we check for missing values and encode those as 0. Finally, we one-hot encode each value.", "Here are the remaining utility functions:", "We\u2019ll wrap the building and training of our model into a function called trainModel():", "Let\u2019s create a Deep Neural Network using the sequential model API in TensorFlow:", "Our Deep Neural Network has two hidden layers with 32 and 64 neurons, respectively. Each layer has a ReLU activation function.", "We\u2019ll train our model using the Adam optimizer and measure our error using Binary Crossentropy.", "Finally, we\u2019ll pass the training data to the fit method of our model and train for 100 epochs, shuffle the data, and use 10% of it for validation. We\u2019ll visualize the training progress using tfjs-vis:", "It seems like our model is learning during the first ten epochs and plateaus after that.", "Let\u2019s evaluate our model on the test data:", "The model has an accuracy of 79.2% on the test data. Let\u2019s have a look at what kind of mistakes it makes using the confusion matrix:", "It seems like our model is overconfident in predicting retained customers. Depending on your needs, you might try to tune the model, and predict retained customers better.", "Great job! You just built a Deep Neural Network that predicts customer churn with ~80% accuracy. Here\u2019s what you\u2019ve learned:", "But can it be that Deep Learning is even more powerful? So powerful that it can understand images?", "Run the complete source code for this tutorial right in your browser:", "Build Machine Learning models (especially Deep Neural Networks) that you can easily integrate with existing or new web apps. Think of your ReactJs, Vue, or Angular app enhanced with the power of Machine Learning models:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6b3dc8c21e7d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1----6b3dc8c21e7d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b3dc8c21e7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b3dc8c21e7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/curiousily/Customer-Churn-Detection-with-TensorFlow-js", "anchor_text": "Source code on GitHub"}, {"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "Kaggle"}, {"url": "https://www.papaparse.com/", "anchor_text": "Papa Parse"}, {"url": "https://en.wikipedia.org/wiki/Deep_learning#Deep_neural_networks", "anchor_text": "Deep Artificial Neural Networks"}, {"url": "https://paperswithcode.com/sota", "anchor_text": "holding state-of-the-art scores"}, {"url": "https://www.cs.toronto.edu/~hinton/absps/JMLRdropout.pdf", "anchor_text": "Dropout"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch"}, {"url": "https://mxnet.apache.org/", "anchor_text": "MXNet"}, {"url": "https://chainer.org/", "anchor_text": "Chainer"}, {"url": "https://en.wikipedia.org/wiki/One-hot", "anchor_text": "one-hot"}, {"url": "https://js.tensorflow.org/api/latest/#oneHot", "anchor_text": "tf.oneHot()"}, {"url": "https://en.wikipedia.org/wiki/Feature_scaling", "anchor_text": "normalize it"}, {"url": "https://js.tensorflow.org/api/latest/#sequential", "anchor_text": "sequential model API"}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU"}, {"url": "https://js.tensorflow.org/api/latest/#tf.LayersModel.compile", "anchor_text": "compile"}, {"url": "https://js.tensorflow.org/api/latest/#train.adam", "anchor_text": "Adam optimizer"}, {"url": "https://js.tensorflow.org/api/latest/#metrics.binaryCrossentropy", "anchor_text": "Binary Crossentropy"}, {"url": "https://js.tensorflow.org/api/latest/#tf.Sequential.fit", "anchor_text": "fit"}, {"url": "https://github.com/tensorflow/tfjs-vis", "anchor_text": "tfjs-vis"}, {"url": "https://github.com/curiousily/Customer-Churn-Detection-with-TensorFlow-js", "anchor_text": "Source code on GitHub"}, {"url": "https://machinelearningmastery.com/what-is-deep-learning/", "anchor_text": "Deep Learning & Artificial Neural Networks"}, {"url": "https://www.mathworks.com/discovery/deep-learning.html", "anchor_text": "What Is Deep Learning?"}, {"url": "https://skymind.ai/wiki/neural-network", "anchor_text": "A Beginner\u2019s Guide to Neural Networks and Deep Learning"}, {"url": "https://www.curiousily.com/posts/customer-churn-prediction-using-deep-neural-network-with-tensorflow-js/", "anchor_text": "https://www.curiousily.com"}, {"url": "https://leanpub.com/deep-learning-for-javascript-hackers", "anchor_text": "Deep Learning for JavaScript HackersBuild Machine Learning models (especially Deep Neural Networks) that you can easily integrate with existing or new web\u2026leanpub.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6b3dc8c21e7d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/javascript?source=post_page-----6b3dc8c21e7d---------------javascript-----------------", "anchor_text": "JavaScript"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----6b3dc8c21e7d---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6b3dc8c21e7d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----6b3dc8c21e7d---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b3dc8c21e7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&user=Venelin+Valkov&userId=102e34a0beb1&source=-----6b3dc8c21e7d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b3dc8c21e7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&user=Venelin+Valkov&userId=102e34a0beb1&source=-----6b3dc8c21e7d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b3dc8c21e7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6b3dc8c21e7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6b3dc8c21e7d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6b3dc8c21e7d--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://venelinvalkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.5K Followers"}, {"url": "https://mlexpert.io", "anchor_text": "https://mlexpert.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5323954064aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-churn-prediction-using-neural-networks-with-tensorflow-js-6b3dc8c21e7d&newsletterV3=102e34a0beb1&newsletterV3Id=5323954064aa&user=Venelin+Valkov&userId=102e34a0beb1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}