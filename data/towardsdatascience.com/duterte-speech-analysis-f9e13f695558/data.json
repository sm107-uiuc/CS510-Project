{"url": "https://towardsdatascience.com/duterte-speech-analysis-f9e13f695558", "time": 1683007300.282793, "path": "towardsdatascience.com/duterte-speech-analysis-f9e13f695558/", "webpage": {"metadata": {"title": "Analysis of Duterte\u2019s Speeches using NLP | by Daniel Del Rio | Towards Data Science", "h1": "Analysis of Duterte\u2019s Speeches using NLP", "description": "Given the present situation of the COVID-19 across different countries, the urgency for their governments to step up and address the pandemic has elevated even further. The story isn\u2019t any different\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/daniddelrio/duterte-speech-analysis", "anchor_text": "GitHub repository", "paragraph_index": 1}, {"url": "https://pcoo.gov.ph/presidential-speech/", "anchor_text": "in their website", "paragraph_index": 2}, {"url": "http://www.gov.ph/robots.txt", "anchor_text": "robots.txt", "paragraph_index": 4}, {"url": "https://www.scrapehero.com/how-to-prevent-getting-blacklisted-while-scraping/", "anchor_text": "prevent my IP address from being blacklisted", "paragraph_index": 5}, {"url": "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent", "anchor_text": "user agent", "paragraph_index": 5}, {"url": "https://pcoo.gov.ph/presidential-speech/talk-to-the-people-of-president-rodrigo-roa-duterte-on-coronavirus-disease-2020-covid-19/", "anchor_text": "example", "paragraph_index": 6}, {"url": "https://pcoo.gov.ph/presidential-speech/talk-to-the-people-of-president-rodrigo-roa-duterte-on-coronavirus-disease-2020-covid-19/", "anchor_text": "example", "paragraph_index": 6}, {"url": "https://docs.python.org/3/library/multiprocessing.html", "anchor_text": "multiprocessing", "paragraph_index": 13}, {"url": "https://github.com/daniddelrio/duterte-speech-analysis", "anchor_text": "Github repository", "paragraph_index": 19}], "all_paragraphs": ["Given the present situation of the COVID-19 across different countries, the urgency for their governments to step up and address the pandemic has elevated even further. The story isn\u2019t any different here in the Philippines, as the frequency of President Rodrigo Duterte\u2019s press conferences addressed to the Filipino people has risen. This inspired me to work on a personal project that will analyze his speeches throughout the years using Natural Language Processing (NLP).", "Of course, before I can analyze his speeches, I need to actually collect them first. This is Part 1 of the Duterte Speech Analysis, which will focus on scraping Duterte\u2019s speeches. The succeeding articles of this series will then be centered on analyzing them using NLP. For the code I made, check out my GitHub repository \u2014 though I admit my code\u2019s kind of messy here \u2014 and leave comments or suggestions if you have any. I\u2019ll also eventually update my README with instructions on how to run the Python programs.", "Luckily for me, the country\u2019s Presidential Communications Operations Office (PCOO) publishes his speeches in their website, at least up until a certain point (the page shows that it has 31 pages but if you navigate beyond a certain page number, it returns a \u201cpage can\u2019t be found\u201d error). Hence, the speeches I gathered were only from 2020 until 2018.", "For the scraping of the speeches, I primarily used theBeautifulSoup4 and requests Python libraries, while also using pandas for structuring the dataset, python-dotenv for the environment variables, and a bunch of libraries for extracting texts from PDFs.", "Initially, when I tried using the requests library to make a GET request to the PCOO website, I kept getting a connection error for some reason. Upon further research, I found out that it\u2019s because some websites, including PCOO\u2019s, generally dislike robots crawling all over them. You can see this by going to their robots.txt, showing the following settings aimed for disallowing robots.", "Hence, I had to perform several extra steps as a measure to overcome the settings against robots and as a precaution in order to prevent my IP address from being blacklisted. Firstly, I had to disguise my robot program as a human by attaching a user agent to my every request, which I stored in my .env file (hence why I installed python-dotenv). Secondly, it would be way too obvious if one IP address made GET requests to a website at a rapid-fire pace, so I spread out each request by 15 seconds using time.sleep to make it look more human. Admittedly, this increased the scraping time by a lot, but later I will explain how I was able to vastly speed up the process.", "The above snippet shows part of the main program found in the 01_scraper.py file, which scrapes the speeches per page of the website. Each page contains 20 speeches, each of which I refer to as row in my program. Each speech takes you to the speech detail page (example) containing the audio, full transcript, and possibly the video of the press conference. The full transcript redirects you to a PDF of the transcript of the speech (example).", "I made a function called extract_page in my scraper_functions.py that processes each row using the above procedure and returns a dictionary containing the title, date of speech, and the extracted text.", "The next question then is, how do I extract the text from the PDFs?", "To reduce scraping time in case I wanted to try more PDF libraries, I saved the PDFs in my repository. This way, I didn\u2019t have to scrape through the PCOO website again. After that, I found four Python libraries for extracting text from PDFs:", "Initially, I used PyPDF2, but for some speeches it was only able to extract empty new lines, so it would end up with something like \\n\\n\\n\\n\\n\\n\\n\\n. As a result, I made a function for to check whether the extracted text returned a string with no words using regex. If the function returned True, then I use slate3k to extract for that speech instead. Still, the library sometimes had faulty results, such as totally missing parts of the speech and weirdly spacing out each letter of the text for some speeches (l i k e t h i s). Nevertheless, I compiled all the results using PyPDF2 and slate3k into one csv.", "Next, I tried out tika because I was too frustrated with the previous results while I was trying to analyze, and it worked beautifully. So beautifully in fact that I didn\u2019t get to try out PDFPlumber (so if you\u2019ve used it before, do let me know whether it\u2019s as functional!). No errors were caught while extracting everything, so it was pretty much a smooth process using that library. I\u2019ve decided that I\u2019ll use the tika results instead of the other three packages for my analysis.", "I mentioned above that there were two stages of scraping for each speech: the speech detail page and the PDF transcript page, amounting to more than 30 seconds of scraping per speech. Given that there are 20 speeches per page, it takes us more than 10 minutes (plus an additional 15 seconds for scraping the page itself) to extract all the speeches in one page. There were about 21 valid pages, so overall it should theoretically take 210 minutes or about 3.5 hours to extract all of them. However, in reality it took me about a week to finish the scraping because of the numerous errors that popped up while using PyPDF2 and slate3k.", "This led me to explore multiprocessing to speed up the whole process using tika instead as my PDF extractor, and it worked wonders.", "Since I wasn\u2019t able to save the PDFs locally during my first trial run, I had to restart the whole process of scraping. But with multiprocessing, I could have multiple workers process the same set of data (in this case, the 20 speeches per page) concurrently instead of having to process each speech sequentially.", "Using the Pool object representing the pool of worker processes, I was able to map the data (the 20 rows of data per page) to the worker processes, and the workers ran the extract_page function concurrently. After all the workers are done, the list of 20 dictionaries returned by the function was appended to the working pandas DataFrame. I also included a text file for logging each speech as I processed them (which I had also done for the first trial run).", "I compared the total time it took to scrape one whole page for the first and second trial runs using my scrape_logs.txt, and the difference was apparent. For the first trial run, it took 13\u201320 minutes to complete one whole page, while it took only 4\u20135 minutes for my second trial run involving multiprocessing. This is also thanks to the smooth sailing of the tika library, where I encountered no errors in extracting the text (though I did encounter this weird recursion limit error related to the multiprocessing, which I remedied by adding the sys.recursionlimit(10000)). Overall, the multiprocessing trial run lasted only about 1.5 hrs!", "I was also satisfied with the PDF extraction itself, seeing that there were only negligible errors in the texts obtained using tika. Hence, I opted not to proceed with the PDFPlumber anymore.", "Overall, I successfully scraped the PCOO website in order to collect Duterte\u2019s speeches and to compile them into one csv file, further speeding up the whole process by incorporating multiprocessing.", "For Part 2 (and possibly Part 3), I will attempt to analyze this data that I gathered using NLP tools such as NLTK and TF-IDF/N-gram. Again, please feel free to go through my Github repository and leave comments or suggestions below if you have any! I will very much appreciate it.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A college student taking up Computer Science with nothing better to do than coding and watching basketball"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff9e13f695558&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f9e13f695558--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f9e13f695558--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@danielraymonddelrio?source=post_page-----f9e13f695558--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@danielraymonddelrio?source=post_page-----f9e13f695558--------------------------------", "anchor_text": "Daniel Del Rio"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4be6b5abda8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&user=Daniel+Del+Rio&userId=4be6b5abda8c&source=post_page-4be6b5abda8c----f9e13f695558---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff9e13f695558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff9e13f695558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@denniz-futalan-339724", "anchor_text": "Denniz Futalan"}, {"url": "https://www.pexels.com/photo/rodrigo-duterte-on-stage-1394506/", "anchor_text": "Pexels"}, {"url": "https://github.com/daniddelrio/duterte-speech-analysis", "anchor_text": "GitHub repository"}, {"url": "https://pcoo.gov.ph/presidential-speech/", "anchor_text": "in their website"}, {"url": "https://www.pexels.com/@foodie-factor-162291", "anchor_text": "Foodie Factor"}, {"url": "https://www.pexels.com/photo/appetizer-bowl-bread-breakfast-539451/", "anchor_text": "Pexels"}, {"url": "http://www.gov.ph/robots.txt", "anchor_text": "robots.txt"}, {"url": "https://www.scrapehero.com/how-to-prevent-getting-blacklisted-while-scraping/", "anchor_text": "prevent my IP address from being blacklisted"}, {"url": "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent", "anchor_text": "user agent"}, {"url": "https://pcoo.gov.ph/presidential-speech/talk-to-the-people-of-president-rodrigo-roa-duterte-on-coronavirus-disease-2020-covid-19/", "anchor_text": "example"}, {"url": "https://pcoo.gov.ph/presidential-speech/talk-to-the-people-of-president-rodrigo-roa-duterte-on-coronavirus-disease-2020-covid-19/", "anchor_text": "example"}, {"url": "https://pcoo.gov.ph/presidential-speech/", "anchor_text": "PCOO Website"}, {"url": "https://pythonhosted.org/PyPDF2/", "anchor_text": "PyPDF2"}, {"url": "https://github.com/TakesxiSximada/slate3k", "anchor_text": "slate3k"}, {"url": "https://github.com/chrismattmann/tika-python", "anchor_text": "tika"}, {"url": "https://github.com/jsvine/pdfplumber", "anchor_text": "PDFPlumber"}, {"url": "https://docs.python.org/3/library/multiprocessing.html", "anchor_text": "multiprocessing"}, {"url": "https://www.pexels.com/@fauxels", "anchor_text": "fauxels"}, {"url": "https://www.pexels.com/photo/photo-of-people-leaning-on-wooden-table-3183183/", "anchor_text": "Pexels"}, {"url": "https://github.com/daniddelrio/duterte-speech-analysis", "anchor_text": "Github repository"}, {"url": "https://medium.com/tag/python?source=post_page-----f9e13f695558---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/scraping?source=post_page-----f9e13f695558---------------scraping-----------------", "anchor_text": "Scraping"}, {"url": "https://medium.com/tag/duterte?source=post_page-----f9e13f695558---------------duterte-----------------", "anchor_text": "Duterte"}, {"url": "https://medium.com/tag/multiprocessing?source=post_page-----f9e13f695558---------------multiprocessing-----------------", "anchor_text": "Multiprocessing"}, {"url": "https://medium.com/tag/pdf?source=post_page-----f9e13f695558---------------pdf-----------------", "anchor_text": "Pdf"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff9e13f695558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&user=Daniel+Del+Rio&userId=4be6b5abda8c&source=-----f9e13f695558---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff9e13f695558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&user=Daniel+Del+Rio&userId=4be6b5abda8c&source=-----f9e13f695558---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff9e13f695558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f9e13f695558--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff9e13f695558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f9e13f695558---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f9e13f695558--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f9e13f695558--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f9e13f695558--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f9e13f695558--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f9e13f695558--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f9e13f695558--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f9e13f695558--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f9e13f695558--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@danielraymonddelrio?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@danielraymonddelrio?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Daniel Del Rio"}, {"url": "https://medium.com/@danielraymonddelrio/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4be6b5abda8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&user=Daniel+Del+Rio&userId=4be6b5abda8c&source=post_page-4be6b5abda8c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F4be6b5abda8c%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fduterte-speech-analysis-f9e13f695558&user=Daniel+Del+Rio&userId=4be6b5abda8c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}