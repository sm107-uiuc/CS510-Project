{"url": "https://towardsdatascience.com/poodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03", "time": 1683001825.821192, "path": "towardsdatascience.com/poodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03/", "webpage": {"metadata": {"title": "A Keras CNN to Predict if a Dog is a Poodle | by GreekDataGuy | Towards Data Science", "h1": "A Keras CNN to Predict if a Dog is a Poodle", "description": "Building a Keras CNN to predict if the breed of dog in a photo is a poodle."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Rotational_invariance", "anchor_text": "rotation invariant", "paragraph_index": 20}, {"url": "http://gmail.com", "anchor_text": "gmail.com", "paragraph_index": 29}], "all_paragraphs": ["I wanted to incorporate my mini poodle into a post. So instead of a boring tutorial on classifying images of numbers, we\u2019ll build a CNN to detect if a photo contains a poodle (rather than another breed of dog).", "I call this: Poodle not Poodle.", "I found a Kaggle dataset containing ~10k photos of dogs, labelled by breed. Download and save it in the same directory as your notebook.", "An accompanying CSV contains the mapping from breed to photo name. Import it with pandas.", "Now get a sense of the distribution across breeds by counting the number per breed and sorting in descending order. Pandas makes this easy.", "Great. But I\u2019m interested in poodles. How many examples of poodles does it contain? I know from reading about the dataset on Kaggle that there are 3 different poodle breeds included.", "Nice. Going forward we\u2019ll build a classifier to detect just miniature poodles. We\u2019ll also pick one other specific breed of dog (rather than a mix of breeds) to make it easier on the CNN. The per-breed volume of data we have to train on is NOT a lot!", "Create 2 dataframes, poodles and non-poodles.", "poodle_df => contains mini poodles.non_poodle_df => contains bernese mountain dogs.", "Define a function that builds paths to the images in the downloaded dataset.", "Perfect. Now let\u2019s add a boolean column to each table specifying whether the image is of a poodle or not.", "Combine the 2 dataframes (now that we have a boolean column to tell the examples apart).", "And shuffle the rows so that all the poodles aren\u2019t at the top or bottom. By using frac=1 we\u2019re essentially taking a sample that includes the whole population, and in the process, changing the order.", "Split the dataframe into 2 dataframes again. But this time one will be the train set and the other the test set. Here we\u2019re using a 70/30 split.", "The images are all different sizes, so let\u2019s look at the average size of the images.", "The average width is 448 and the average height is 385.", "Making the width and height equal makes it simpler to do transformations later. So we\u2019ll resize images to 300x300.", "Write a function to:- load an image- convert to greyscale- resize to 300x300", "And another function to create 2 transformations of each passed in image.", "The above function takes an image and creates 2 images from it with random rotations. We\u2019ll then completely ignore the passed-in image and only train on the transformations.", "Transformations of training images are important when working with CNNs because they are not rotation invariant by default. That\u2019s to say an upright image and the same image flipped 90 degrees could look completely different to your model. So it\u2019s helpful to train on both.", "Generate test data, for which we won\u2019t generate additional transformations.", "Convert our features to numpy arrays.", "This is a pretty typical model with convolutional layers that increase in size.", "That\u2019s actually better than I expected given the small amount of training data. Though we made this a lot easier for ourselves by only choosing 2 breeds of dog.", "And just for fun, we\u2019ll classify the photo of my poodle I showed you at the top.", "Could we have done better? Of course! More different kinds of transformations like flips, brightness and zooms might have helped. But most importantly, more data.", "Though we should be happy with the current result regardless.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Just a developer. Contact: greek.data.guy \u201cat\u201d gmail.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F17fff85eaf03&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://greekdataguy.medium.com/?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": "GreekDataGuy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd67bf018ae6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&user=GreekDataGuy&userId=d67bf018ae6d&source=post_page-d67bf018ae6d----17fff85eaf03---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17fff85eaf03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17fff85eaf03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Rotational_invariance", "anchor_text": "rotation invariant"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----17fff85eaf03---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----17fff85eaf03---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/keras?source=post_page-----17fff85eaf03---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----17fff85eaf03---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----17fff85eaf03---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17fff85eaf03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&user=GreekDataGuy&userId=d67bf018ae6d&source=-----17fff85eaf03---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17fff85eaf03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&user=GreekDataGuy&userId=d67bf018ae6d&source=-----17fff85eaf03---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17fff85eaf03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F17fff85eaf03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----17fff85eaf03---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----17fff85eaf03--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----17fff85eaf03--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----17fff85eaf03--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----17fff85eaf03--------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "GreekDataGuy"}, {"url": "https://greekdataguy.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.97K Followers"}, {"url": "http://gmail.com", "anchor_text": "gmail.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd67bf018ae6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&user=GreekDataGuy&userId=d67bf018ae6d&source=post_page-d67bf018ae6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F26b33036e2a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpoodle-not-poodle-a-keras-cnn-to-predict-if-a-dog-is-a-poodle-17fff85eaf03&newsletterV3=d67bf018ae6d&newsletterV3Id=26b33036e2a7&user=GreekDataGuy&userId=d67bf018ae6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}