{"url": "https://towardsdatascience.com/geometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844", "time": 1683007750.007809, "path": "towardsdatascience.com/geometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844/", "webpage": {"metadata": {"title": "Geometric transformations in Computer Vision: an intuitive explanation with Python examples | by Raktim Bora | Towards Data Science", "h1": "Geometric transformations in Computer Vision: an intuitive explanation with Python examples", "description": "Rotation, Scaling, Translation are the most common geometric transformations used in Computer Vision. in this post, we discuss them from scratch with Numpy and Python code."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Rotation", "anchor_text": "rotation", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Translation_(geometry)", "anchor_text": "translation", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Image_scaling", "anchor_text": "scaling", "paragraph_index": 0}, {"url": "https://translate.google.com/#view=home&op=translate&sl=de&tl=en&text=los%20geht's", "anchor_text": "los geht\u2019s!", "paragraph_index": 0}, {"url": "https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image.transform", "anchor_text": "PIL", "paragraph_index": 1}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#getrotationmatrix2d", "anchor_text": "getRotationMatrix2D()", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Rotation_matrix", "anchor_text": "rotation matrix", "paragraph_index": 4}, {"url": "https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw", "anchor_text": "3blue1brown", "paragraph_index": 6}, {"url": "https://www.linkedin.com/in/raktimb/", "anchor_text": "https://www.linkedin.com/in/raktimb/", "paragraph_index": 26}], "all_paragraphs": ["Geometric transformations are one of the most common transformation operations that feature in any image processing pipeline. In today\u2019s post we would look at three of these transformations: rotation, translation and scaling and then build them up from scratch using only Numpy. Fig. 1 shows what we want to achieve visually. So, los geht\u2019s!", "Achieving the above is pretty trivial if you are using any imaging library like OpenCV or PIL built-in functions. With OpenCV, we can do this in two lines of code as shown below.", "We get the Fig.2 image as the result. Notice that OpenCV doesn\u2019t automatically expand the bounds of your image. To make sure we see the entire rotated image we need to do two additional things. First, calculate what size the destination image has changed to and second, since the center of this new image is different from the original center, we would need to account for the difference of the center values in the rotation matrix. With these additions, we are golden!", "This time the rotation includes the whole image as we expected! Let\u2019s break down what exactly happens behind those function calls.", "We used the getRotationMatrix2D() method above (snippet 1 line 5) to create a rotation matrix which we later use to warp the original image (snippet 1 line6). This function takes the image center, an angle of rotation and a scaling factor as it\u2019s arguments and gives us a rotation matrix. What exactly is this rotation matrix? Well, It has it\u2019s roots in linear algebra. Let\u2019s consider an arbitrary 2D point [x, y], then the rotation operation can be expressed by the following matrix operation.", "where, R is the rotation matrix", "In even simpler terms, the rotation matrix gives us the \u201cfunction f\u201d x\u2019, y\u2019 = f(x, y) that maps an input point to it\u2019s rotated counterpart. The matrix R consists of two column vector which represent where our initial basis vectors end-up after the transformation (If you are a fan of 3blue1brown like me, this will immediately ring a bell!).", "Let\u2019s use the unit circle to make things more clear.", "In this unit circle, consider the two vectors u with head at B = [1, 0] and w with head at D [0, 1]. These vectors are then rotated about the center A (=origin = [0, 0]) by some angle theta, (= phi) after which they land up at points C and E respectively.", "After transformation, vector v can be expressed by it\u2019s orthogonal projection vectors with heads at F and H respectively. Using basic trigonometry and keeping in mind vector v and a have unit length, one can easily see that the length of vector with head at F is b = cos(theta) and the length of vector ending at H is d= sin(theta).", "The vector v can thus be expressed as the column vector [cos(theta) sin(theta)]. Similarly, we can show that vector a can be expressed as the column vector [-sin(theta) cos(theta)]. The negative sign indicates the direction.", "Putting these column vectors together gives us our rotation matrix R. For ease of matrix multiplication, it\u2019s common to add a 3rd-axis to the rotation matrix. Intuitively, this will be the axis of rotation by which you rotate a 3D structure. All points on this axis will remain the same after the transformation hence this additional axis has no net effect on the remaining transformation.", "Similarly, a translation operation can be expressed by the translation matrix shown below, where tx and ty are the translation quantities in X and Y directions.", "And our scaling matrix, where Sx ans Sy are our scaling factor in x and y direction is", "Note: Generally, rotation and translation are combined into a single transformation matrix as shown below. It has the same effect as rotating about origin by theta and then translation by tx and ty", "Try it out! Take any of the above matrices, give them some values and multiply by an arbitrary point [x, y] and see if the transformed point value is what you expect!", "We now have all our requisite ingredients to express our geometric transformations. Just a few of important things to keep in mind:", "Great, so let\u2019s now get back to our original image and see what do we need to do get the desired transformed image. The operations in exact order are as follows:", "In terms of matrices, we can express the above four steps as below. From right to left, we translate the center to origin (first matrix from right), rotate about center and translate back center (center matrix) and finally adjust the center for new dimensions (first matrix form left).", "We haven\u2019t used the scaling transformation here but if you would like to scale your image as well, it\u2019s just about adding the scaling transformation to the equation above (at the right place!). Simplifying the above and replacing a=cos(theta), b =sin(theta)", "This is our final rotation matrix, one which we will use to rotate our images using Numpy in the following section.", "Calling the OpenCV methods is fast and easy but no fun! So we will put together everything we discussed into code and rotate images using just Numpy!", "Since this script is a bit too long to paste here, check out the link below for the full code.", "After this, we can rotate and translate images using our own functions!", "That\u2019s all for today, hope you liked it. As always, thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Freelance Data Scientist. On a journey to create and share. Get in touch: https://www.linkedin.com/in/raktimb/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb0b6f06e1844&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@reachraktim?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@reachraktim?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": "Raktim Bora"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb4a151ad137&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&user=Raktim+Bora&userId=db4a151ad137&source=post_page-db4a151ad137----b0b6f06e1844---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0b6f06e1844&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0b6f06e1844&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@paytonctuttle?utm_source=medium&utm_medium=referral", "anchor_text": "Payton Tuttle"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Rotation", "anchor_text": "rotation"}, {"url": "https://en.wikipedia.org/wiki/Translation_(geometry)", "anchor_text": "translation"}, {"url": "https://en.wikipedia.org/wiki/Image_scaling", "anchor_text": "scaling"}, {"url": "https://translate.google.com/#view=home&op=translate&sl=de&tl=en&text=los%20geht's", "anchor_text": "los geht\u2019s!"}, {"url": "http://cocodataset.org/#home", "anchor_text": "COCO datatset"}, {"url": "https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image.transform", "anchor_text": "PIL"}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#getrotationmatrix2d", "anchor_text": "getRotationMatrix2D()"}, {"url": "https://en.wikipedia.org/wiki/Rotation_matrix", "anchor_text": "rotation matrix"}, {"url": "https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw", "anchor_text": "3blue1brown"}, {"url": "https://github.com/borarak/imutils/blob/master/geometric/rotate.py", "anchor_text": "borarak/imutilsImaging utility scripts. Contribute to borarak/imutils development by creating an account on GitHub.github.com"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----b0b6f06e1844---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/programming?source=post_page-----b0b6f06e1844---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----b0b6f06e1844---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/python?source=post_page-----b0b6f06e1844---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0b6f06e1844&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&user=Raktim+Bora&userId=db4a151ad137&source=-----b0b6f06e1844---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0b6f06e1844&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&user=Raktim+Bora&userId=db4a151ad137&source=-----b0b6f06e1844---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0b6f06e1844&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb0b6f06e1844&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b0b6f06e1844---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b0b6f06e1844--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@reachraktim?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@reachraktim?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Raktim Bora"}, {"url": "https://medium.com/@reachraktim/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "112 Followers"}, {"url": "https://www.linkedin.com/in/raktimb/", "anchor_text": "https://www.linkedin.com/in/raktimb/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb4a151ad137&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&user=Raktim+Bora&userId=db4a151ad137&source=post_page-db4a151ad137--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff102040dc3ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-transformations-in-computer-vision-an-intuitive-explanation-with-python-examples-b0b6f06e1844&newsletterV3=db4a151ad137&newsletterV3Id=f102040dc3ad&user=Raktim+Bora&userId=db4a151ad137&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}