{"url": "https://towardsdatascience.com/paper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18", "time": 1683010342.132322, "path": "towardsdatascience.com/paper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18/", "webpage": {"metadata": {"title": "Paper Dissection: Cloze-driven Pretraining of Self-attention Networks; Facebook AI | by Subhadip Maji | Towards Data Science", "h1": "Paper Dissection: Cloze-driven Pretraining of Self-attention Networks; Facebook AI", "description": "Cloze-driven Pretraining of Self-attention Networks is a new type of language pre-training published Facebook AI Research by to get improved word embedding for fine-tuning using transformer modules\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1903.07785.pdf", "anchor_text": "Cloze-driven Pretraining of Self-attention Networks", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/1706.03762.pdf", "anchor_text": "Transformers", "paragraph_index": 1}, {"url": "http://jalammar.github.io/illustrated-transformer/", "anchor_text": "blog", "paragraph_index": 1}, {"url": "https://arxiv.org/pdf/1508.06615.pdf", "anchor_text": "here.", "paragraph_index": 6}, {"url": "http://M.Tech", "anchor_text": "M.Tech", "paragraph_index": 19}], "all_paragraphs": ["Cloze-driven Pretraining of Self-attention Networks is a new type of language pre-training published Facebook AI Research by to get improved word embedding for fine-tuning using transformer modules. As this is a paper dissection session, I will try to explain the main idea of the paper section-wise both intuitively and mathematically if needed for a better understanding of the readers. It would be great if the readers open both this article and the paper side by side and start going through together. I will skip the Abstract, Introduction, and Related work section and start from section 3.", "Knowledge on Transformers. Along with the original paper this blog from Jay Alammar is very helpful in understanding transformers.", "In this section, the paper reveals their novel architecture to pretrain word embeddings. Before directly jumping to the architecture, let\u2019s build the intuition of this pretraining.", "Now, what is Cloze reading? Cloze reading is an instructional strategy where users are required to fill in the blanks within a passage with correct words from a word bank. For example, given a sentence, This is my first medium article, the pretraining idea is to predict my, given This is and first medium article. Makes sense? If not, do not worry. In a moment I will present a pictorial diagram that will make you super clear.", "Let\u2019s come to the two tower analogy. For now, assume these two towers are two black boxes. As the word/token my is in between phrases This is and first medium article, This is will go the left tower and first medium article will go to the right tower as inputs to finally predict my. This left tower or forward tower works left to right which means given This is, it tries to predict my, where the right or backward tower works from right to left which means given article medium first, it tries to predict my. Sentences are appended with <s> token at the beginning and end. As the input sentences for both the towers are not equal in length masking needs to be done.", "In this section, I will talk in detail about the towers. These towers are the Transformer decoder blocks stacked on top of each other as shown in Figure 1. The green blocks are the part of the forward tower and the blue blocks are the part of the backward tower. From the given figure it is seen that given, <s>, a in the forward tower and c, <s> in the backward tower b is desired to be predicted finally.", "This paper used one different kind of word embeddings using CNN encodings. The details of the encoding can be found here. In short, given a word input it is broken into characters and character embeddings are generated. On top of this, Conv1D layers of different filter size areused, and different sizes of outputs are obtained. After this, a max-over-time pooling operation is applied to obtain a fixed-dimensional representation of the word, which is given to the highway network to get the final word embeddings. This process is shown in Figure 2.", "Cloze-pretraining uses this CNN encoding to generate word embeddings. Fixed sinusoidal positional encodings (as described in the transformer paper) are summed with the CNN encoded word embeddings to provide the relative position of words in sentences. I have prepared an extended version of the model architecture for a better understanding of the readers. This is shown in Figure 3. CNN Encoding + Positional Encoding generates word/token embeddings to be used as the inputs of transformer modules. Input embeddings are shared between two towers. The number of blocks in forward and backward towers are the same for each layer. Just to be clear, Block 11 means the first block of the first layer and Block N3 means the third block of the N-th layer. While pretraining if we want to predict the i-th token/word (e.g. my), in the forward tower they mask all the tokens after i including the i-th token. Similarly in the backward tower, they mask all the tokens before i including i-th token so that the model does not get the information of i-th token while predicting the same.", "One thing to note here is that, in the left (green) side, Block 11 takes inputs from <s> only, Block 12 takes inputs from both <s> and This and Block 13 takes input from <s>, This and is, etc.", "In this section, I will talk about the combine block shown in the Figure 3. Once the two towers are build the outputs of the final layers are combined with a self-attention layer. One Feed Forward module is used after that with a softmax activation of size V (where V is vocabulary size) to predict the correct word/token.", "They do not suggest to simply feed all the outputs of final layers of forward and backward towers, rather they use masking before doing so. The masking is almost similar to earlier, i.e. for forward tower, all the outputs after i-th block is masked including i-th block and for backward tower, all the outputs before i-th block including i-th block is masked while predicting i-th token. If, FL1 (same as green Block N1 in Figure 3) and BL1 (same as blue Block N1 in Figure 3) are the outputs of block 1 in the final layer (L in the notation and N in Figure 3), then FL1, FL2, \u2026, FL(i-1) in the forward block and BL(i+1), BL(i+2), \u2026, BLn are only needed to be considered as the inputs of self-attention module. Rest blocks of the final layers are masked to predict the i-th token as shown in Figure 3. In the self-attention layer, FL(i-1) and BL(i+1) are summed and concatenated to be used as query vectors for base models and large models respectively. Keys and value vectors are created based on the other unmasked final layer outputs of forward and backward blocks.", "The masking of the output of the i-th block is done during pretraining, but while fine tuning the masking is removed which showed improvement in test results.", "Different processes are used for different fine-tuning tasks.", "Figure 4 shows the fine-tuning process of a single sentence task. The changes are: (a) All the tokens of the input sentences go to each of the towers. (b) The feed forward layer with softmax activation is removed. In this scenario, the output of the language model will be the output of the self-attention layer i.e. : [batch-size X Time-steps X attention-dim]. As all the input sentences are appended with token <s> at the very start and end, it is very easy to get the self-attention output vector for these two tokens and they are concatenated to produce a vector of 2*attention-dim (attention-dim = 1024 in the paper) size. Basically, these two tokens are used to calculate the final output for the classification and regression tasks. If it is a classification problem, on the top of the concatenated vector one feed forward layer is used with softmax activation to output the desired number of classes. For regression the output dimension is 1 and activation is linear.", "When the inputs are two sentences or question-answer pair, then one separator token (<sep>) is used between two inputsentences. So, at the output of the self-attention layer along with the <s> token vectors, we also get vector output of <sep> token. Instead of concatenating only the <s> token vectors, in sentence pair problems, along with <s> token vectors <sep> token vector is also concatenated to produce 3*attention-dim vector. Now on the based of regression or classification problem feed forward layer is used as described for the single sentence task.", "For Named entity recognition, the input will the output of the pretrained language model but without the masking just at the input of the self-attention layer.", "It is seen that disabling the masking at the input of the self-attention layer improves the test result. But it not recommended disabling the masking before the final layer of the towers.", "I skipped the rest parts as they describe the model parameters, datasets, and results in a very straight-forward way which is very easy to understand. Let me know in comments whether I should extend the article to cover up the Experimental Setup and Results section also.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Subhadip is a Data Scientist at Optum United Health Group. He has done his B.E from Jadavpur University and M.Tech from Indian Statistical Institute, Kolkata."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa91adb2d9b18&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@subhadip.k3note1?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@subhadip.k3note1?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": "Subhadip Maji"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F396035b3bf06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&user=Subhadip+Maji&userId=396035b3bf06&source=post_page-396035b3bf06----a91adb2d9b18---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa91adb2d9b18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa91adb2d9b18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1903.07785.pdf", "anchor_text": "Cloze-driven Pretraining of Self-attention Networks"}, {"url": "https://arxiv.org/pdf/1706.03762.pdf", "anchor_text": "Transformers"}, {"url": "http://jalammar.github.io/illustrated-transformer/", "anchor_text": "blog"}, {"url": "https://arxiv.org/pdf/1903.07785.pdf", "anchor_text": "Paper"}, {"url": "https://arxiv.org/pdf/1508.06615.pdf", "anchor_text": "here."}, {"url": "https://arxiv.org/pdf/1508.06615.pdf", "anchor_text": "Paper"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----a91adb2d9b18---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a91adb2d9b18---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/transformers?source=post_page-----a91adb2d9b18---------------transformers-----------------", "anchor_text": "Transformers"}, {"url": "https://medium.com/tag/facebook?source=post_page-----a91adb2d9b18---------------facebook-----------------", "anchor_text": "Facebook"}, {"url": "https://medium.com/tag/nlp?source=post_page-----a91adb2d9b18---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa91adb2d9b18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&user=Subhadip+Maji&userId=396035b3bf06&source=-----a91adb2d9b18---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa91adb2d9b18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&user=Subhadip+Maji&userId=396035b3bf06&source=-----a91adb2d9b18---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa91adb2d9b18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa91adb2d9b18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a91adb2d9b18---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a91adb2d9b18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@subhadip.k3note1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@subhadip.k3note1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Subhadip Maji"}, {"url": "https://medium.com/@subhadip.k3note1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5 Followers"}, {"url": "http://M.Tech", "anchor_text": "M.Tech"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F396035b3bf06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&user=Subhadip+Maji&userId=396035b3bf06&source=post_page-396035b3bf06--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F396035b3bf06%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpaper-dissection-cloze-driven-pretraining-of-self-attention-networks-a91adb2d9b18&user=Subhadip+Maji&userId=396035b3bf06&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}