{"url": "https://towardsdatascience.com/introduction-to-scikit-learn-pipelines-454a7a1ad3f4", "time": 1683017897.2011578, "path": "towardsdatascience.com/introduction-to-scikit-learn-pipelines-454a7a1ad3f4/", "webpage": {"metadata": {"title": "Introduction to Scikit-learn Pipelines | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Introduction to Scikit-learn Pipelines", "description": "In a typical machine learning task, the features are not likely to be in the most appealing format for a model. Thus, we usually need to proprocess the features before training. The common\u2026"}, "outgoing_paragraph_urls": [{"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 32}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 32}], "all_paragraphs": ["In a typical machine learning task, the features are not likely to be in the most appealing format for a model. Thus, we usually need to proprocess the features before training.", "The common preprocessing operations are handling missing values, scaling the numerical features, and encoding the categorical features. The preprocessing operations can be viewed as transforming the features in some sense.", "The pipeline module of Scikit-learn is a tool that makes the preprocessing simple and easy by combining the transformations in a pipe. It is important to note that the intermediate steps in a pipeline must transform a feature. Thus, they need to be able to implement the fit and transform methods.", "In this article, we will be creating a pipeline to transform features for a machine learning model.", "We will first create a sample dataframe that includes both numerical and categorical features.", "Here are the first 5 rows of the sample dataframe:", "It contains 1 categorical and 3 numerical features. The target variable has 2 classes so we have a binary classification task.", "Let us also add some missing values.", "We have added 6 missing values to all the columns except for the target.", "The sample dataframe is ready. We can start to create the pipelines.", "The numerical and categorical features require different kinds of preprocessing techniques. Thus, we will create separate pipelines for numerical and categorical features and them combine them in another transformer. The final pipeline will include the combined transformer and a machine learning model.", "Let us start by creating the base pipelines.", "The transformations are passed to the steps parameter of Pipeline as a list of tuples. Each tuple contains a name and the transformation function.", "The num_transformer fills the missing values with the mean value of a column (SimpleImputer) and scales the values between 0 and 1 (MinMaxScaler).", "The cat_transformer fills the missing values with the most frequent value of a column and encode the categories using the OneHotEncoder.", "We now have the transformers but they are not applied to the features yet. For this task, we will use the column transformer module of Scikit-learn.", "Before creating the column transformer object, we need to create two lists that include numerical and categorical features. One way of doing this is through the \u201cselect_dtypes\u201d function of Pandas.", "Please keep in mind that the categorical features might also have the \u201ccategory\u201d data type in addition to the \u201cobject.", "The next step is to create the column transformer.", "We pass the operations to the transformers parameter as a list of tuples. In our case, the operations are the pipelines we created previously.", "Each tuple contains a name, the transformer, and a list of features that will be transformed by that transformer.", "The next step is to combine the column transformer we have just created and a machine learning model. We will implement a new pipeline for this operation.", "Let us analyze this new pipeline by breaking it into parts.", "The \u201cclf\u201d is a pipeline that contains a transformer called \u201cpreprocess\u201d and a logistic regression model.", "The \u201cpreprocess\u201d transformer contains two pipelines which are \u201cnum_transformer\u201d and \u201ccat_transformer\u201d.", "We can now directly call the fit method on the \u201cclf\u201d pipeline. Before training the clf pipeline, we will split the dataset into train and test subsets.", "The next step is calling the fit method on clf.", "We now have a pipeline that contains all the feature preprocessing steps and a trained model. It can be used to make predictions on the test set. Furthermore, it is just like any other machine learning model of Scikit-learn. Thus, we can use the methods that are used on other models. The pipeline can also be used in cross validation.", "The main advantage of using pipelines is to simplify the preprocessing by combining many different operations in a single pipeline.", "We can use pipelines for model selection as well. For instance, the clf pipeline we have created can be used to try different models. We can iterate over a list of models and use each model in the pipeline.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F454a7a1ad3f4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----454a7a1ad3f4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F454a7a1ad3f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F454a7a1ad3f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sortino?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Joshua Sortino"}, {"url": "https://unsplash.com/s/photos/automation?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----454a7a1ad3f4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----454a7a1ad3f4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----454a7a1ad3f4---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----454a7a1ad3f4---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----454a7a1ad3f4---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F454a7a1ad3f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----454a7a1ad3f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F454a7a1ad3f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----454a7a1ad3f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F454a7a1ad3f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F454a7a1ad3f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----454a7a1ad3f4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----454a7a1ad3f4--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-scikit-learn-pipelines-454a7a1ad3f4&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}