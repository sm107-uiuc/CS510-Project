{"url": "https://towardsdatascience.com/naive-bayes-and-lstm-based-classifier-models-63d521a48c20", "time": 1683017329.822654, "path": "towardsdatascience.com/naive-bayes-and-lstm-based-classifier-models-63d521a48c20/", "webpage": {"metadata": {"title": "Naive Bayes and LSTM Based Classifier Models | by Ruthu S Sanketh | Towards Data Science", "h1": "Naive Bayes and LSTM Based Classifier Models", "description": "If you\u2019re not familiar with the NLTK library and data pre-processing, take a look at this article. If you\u2019re interested in language models and how to build them, read this article. If you\u2019re familiar\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/text-preprocessing-with-nltk-9de5de891658", "anchor_text": "this", "paragraph_index": 0}, {"url": "https://medium.com/swlh/language-modelling-with-nltk-20eac7e70853", "anchor_text": "this", "paragraph_index": 0}, {"url": "https://github.com/ruthussanketh/natural-language-processing/blob/main/classifier-models/dataset", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab", "paragraph_index": 21}, {"url": "https://github.com/ruthussanketh/natural-language-processing/tree/main/classifier-models", "anchor_text": "here", "paragraph_index": 26}], "all_paragraphs": ["If you\u2019re not familiar with the NLTK library and data pre-processing, take a look at this article. If you\u2019re interested in language models and how to build them, read this article. If you\u2019re familiar with NLP and language models, continue reading!", "A statistical language model is a probability distribution over sequences of words which can be used to predict the next word for text generation and many other applications. Classifiers such as Naive Bayes make use of a language model to assign class labels to some instances, based on a set of features which can be numerically represented using statistical techniques. For example, given a set of movie reviews, we can train a model to predict whether the review has a positive or a negative sentiment.", "Many machine learning techniques have been applied to automatic text classification apart from the Naive Bayes, such as K-Nearest Neighbors and Support Vector Machines(SVM). The NB classifier is widely used in text classification for its simplicity and efficiency. An LSTM or Long-Short-Term-Memory classifier is an artificial recurrent neural network which has both feedforward and feedback connections, and is usually used for classifying and making predictions on time-series data. In this article, we will be using the NB classifier on an IMDB movie review dataset with contains reviews and their sentiments, and then comparing its accuracy and other metrics with those of an LSTM classifier.", "Naive Bayes is a conditional probability model, based on Bayes\u2019 theorem, which states that the conditional probability is given by -", "for each of K possible outcomes. Using the chain rule for repeated applications of the definition of conditional probability, this becomes -", "Under the naive assumption that all the features x are mutually independent, the probability now becomes -", "This formula is the basis behind the Multinomial Naive Bayes classifier which we will be building, which deals with the occurrences of a word in a single document.", "First we import the required libraries and tools.", "We then import the IMDB movie reviews dataset. The dataset can be found here. We load the data using pandas, as a dataframe. We then look at some important parameters, such as the number of null values in the dataset. If a dataset has many null values, methods such as median or mode value are used to fill up these cells for better results. We also convert the \u2018sentiment\u2019 column to lowercase for ease of encoding later on.", "Looking at a preview of the data, we see that there are some HTML tags, newlines, and other special characters that need to be removed from the \u2018review\u2019 column. We also remove stopwords and perform lemmatization of the words in the column using regular expressions.", "We now have a cleaned set of reviews as well as a list of lemmatized and preprocessed tokens for each review. Now let us print some statistics of the data, such as the number of unique tokens, etc. which can be passed as a parameter while initializing our model.", "Since the ratio of positive to negative samples is 1, we don\u2019t need to do any data normalization. Let us create the NB classifier now. We encode the \u2018sentiments\u2019 column by assigning the integer 0 to negative sentiments and 1 to positive sentiments. This makes training as well as data storage easier.", "Now that we have the columns ready for the model, we can split the data into train and test sets. We use a 80-20% train-test split and also the stratify parameter so that the ratio of positive to negative sentiments are the same in both the train and test sets.", "We now have train and test sentences as well as the corresponding train and test labels. There are two approaches possible for building vocabulary for the Naive Bayes classifier -", "We use the 2nd approach since the 1st one is data intensive with nearly the same results. Also, since building vocab by taking all words in the train set is also memory intensive, we build the vocab by choosing the 3000 most frequent words in the training corpus.", "Now that we have the vocabulary, let us build the MNB classifier. NLTK also has an inbuilt Multinomial Bayes Classifier model which we can use, but in this article we will be writing code for the classifier to get a better idea of its working.", "Now that we have built the MNB classifier, let us pass the train sentences and labels to train the model. After training the model, we obtain its accuracy and other performance metrics on the test set.", "We see that the accuracy of the MNB model on the test set is around 85%.", "We use the same train and test splits to build and study this model. Keras has an inbuilt LSTM model which we will be using after setting the parameters to our necessity.", "We define some hyperparameters of the model, and perform padding on the train and test sentences.", "Now we initialize the model, using the Adam optimizer and binary cross entropy loss function. Feel free to try out other optimizers such as SGD. We use word embeddings, which is a technique where words are encoded as real-valued vectors in a high dimensional space, such that the similarity between words in terms of meaning translates to closeness in the vector space, using an Embedded Layer provided by Keras.", "Now that we have defined the model and set up the hyperparameters, we train the model. This might take time if you\u2019re running the code on your local machine, but Google Colab with GPU runtime is fast, so we use that.", "Now that we have trained the model, we can find its accuracy on the test set. First we find the probabilities, and convert these to predictions using a 0.5 threshold. Then we get a classification report.", "We see that the accuracy of the LSTM model on the test set is around 87%.", "We can also use the model to get predictions for random samples and look at the output.", "We see that the LSTM model predicts the sentiments with a decent accuracy.", "The LSTM model with an accuracy of 87% is slightly better than the MNB model with an accuracy of 85%. Both the models can be used to predict the sentiments of random samples. Their accuracy can be improved by increasing the number of training epochs, or varying the hyperparameters. The entire code used in this article as well as the dataset can be found here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior at IIT Kharagpur. Passionate about tech that is shaping the future. Spend most of my time reading :)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F63d521a48c20&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----63d521a48c20--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63d521a48c20--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ruthussanketh.medium.com/?source=post_page-----63d521a48c20--------------------------------", "anchor_text": ""}, {"url": "https://ruthussanketh.medium.com/?source=post_page-----63d521a48c20--------------------------------", "anchor_text": "Ruthu S Sanketh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43c63c0677bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&user=Ruthu+S+Sanketh&userId=43c63c0677bc&source=post_page-43c63c0677bc----63d521a48c20---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d521a48c20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d521a48c20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/text-preprocessing-with-nltk-9de5de891658", "anchor_text": "this"}, {"url": "https://medium.com/swlh/language-modelling-with-nltk-20eac7e70853", "anchor_text": "this"}, {"url": "https://unsplash.com/@milkovi?utm_source=medium&utm_medium=referral", "anchor_text": "MILKOV\u00cd"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/ruthussanketh/natural-language-processing/blob/main/classifier-models/dataset", "anchor_text": "here"}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab"}, {"url": "https://github.com/ruthussanketh/natural-language-processing/tree/main/classifier-models", "anchor_text": "here"}, {"url": "https://machinelearningmastery.com/classification-as-conditional-probability-and-the-naive-bayes-algorithm/", "anchor_text": "How to Develop a Naive Bayes Classifier from Scratch in Python"}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "Colah\u2019s Blog \u2014 Understanding LSTM Networks"}, {"url": "https://towardsdatascience.com/pos-tagging-using-crfs-ea430c5fb78b", "anchor_text": "POS Tagging Using CRFs"}, {"url": "https://towardsdatascience.com/word-and-character-based-lstms-12eb65f779c2", "anchor_text": "Word and Character Based LSTM Models"}, {"url": "https://medium.com/tag/naive-bayes?source=post_page-----63d521a48c20---------------naive_bayes-----------------", "anchor_text": "Naive Bayes"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----63d521a48c20---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/lstm?source=post_page-----63d521a48c20---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/classification?source=post_page-----63d521a48c20---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/text-processing?source=post_page-----63d521a48c20---------------text_processing-----------------", "anchor_text": "Text Processing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63d521a48c20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&user=Ruthu+S+Sanketh&userId=43c63c0677bc&source=-----63d521a48c20---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63d521a48c20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&user=Ruthu+S+Sanketh&userId=43c63c0677bc&source=-----63d521a48c20---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d521a48c20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63d521a48c20--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F63d521a48c20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----63d521a48c20---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----63d521a48c20--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----63d521a48c20--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----63d521a48c20--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----63d521a48c20--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----63d521a48c20--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----63d521a48c20--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----63d521a48c20--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----63d521a48c20--------------------------------", "anchor_text": ""}, {"url": "https://ruthussanketh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ruthussanketh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ruthu S Sanketh"}, {"url": "https://ruthussanketh.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "167 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43c63c0677bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&user=Ruthu+S+Sanketh&userId=43c63c0677bc&source=post_page-43c63c0677bc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3d93ce75710a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-and-lstm-based-classifier-models-63d521a48c20&newsletterV3=43c63c0677bc&newsletterV3Id=3d93ce75710a&user=Ruthu+S+Sanketh&userId=43c63c0677bc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}