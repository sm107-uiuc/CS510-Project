{"url": "https://towardsdatascience.com/support-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60", "time": 1683018011.660049, "path": "towardsdatascience.com/support-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60/", "webpage": {"metadata": {"title": "Support Vector Regression (SVR) \u2014 One of the Most Flexible Yet Robust Prediction Algorithms | by Saul Dobilas | Towards Data Science", "h1": "Support Vector Regression (SVR) \u2014 One of the Most Flexible Yet Robust Prediction Algorithms", "description": "A visual explanation of the SVR algorithm with hands-on Python implementation examples"}, "outgoing_paragraph_urls": [{"url": "https://solclover.com/subscribe", "anchor_text": "subscribe", "paragraph_index": 6}, {"url": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "anchor_text": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "paragraph_index": 19}, {"url": "https://github.com/SolClover/Art015_ML_SVR", "anchor_text": "GitHub repository", "paragraph_index": 40}, {"url": "https://bit.ly/SaulD", "anchor_text": "https://bit.ly/SaulD", "paragraph_index": 43}, {"url": "https://bit.ly/SolClover", "anchor_text": "https://bit.ly/SolClover", "paragraph_index": 43}], "all_paragraphs": ["Machine Learning is making huge leaps forward, with an increasing number of algorithms enabling us to solve complex real-world problems.", "This story is part of a deep dive series explaining the mechanics of Machine Learning algorithms. In addition to giving you an understanding of how ML algorithms work, it also provides you with Python examples to build your own ML models.", "While you may not be familiar with SVR, chances are you have previously heard about Support Vector Machines (SVM). SVMs are most frequently used for solving classification problems, which fall under the supervised machine learning category.", "With small adaptations, however, SVMs can also be used for other types of problems such as:", "These use cases utilize the same idea behind support vectors, but each has a slightly different implementation. This enables us to use these algorithms across different categories of machine learning.", "The below graph is interactive, so make sure to click on different categories to enlarge and reveal more\ud83d\udc47.", "If you enjoy Data Science and Machine Learning, please subscribe to get an email whenever I publish a new story.", "In general, you can use SVR to solve the same problems you would use linear regression for. Unlike linear regression, though, SVR also allows you to model non-linear relationships between variables and provides the flexibility to adjust the model's robustness by tuning hyperparameters.", "Before we look at the regression side, let us familiarize ourselves with SVM usage for classification. This will aid our understanding of how the algorithm has been adapted for regression.", "Let\u2019s assume we have a set of points that belong to two separate classes. We want to separate those two classes in a way that allows us to correctly assign any future new points to one class or the other.", "SVM algorithm achieves that by finding a hyperplane that separates the two classes with the highest possible margin. The points that end up on the margins are known as support vectors (see illustration below).", "Sometimes, however, it may not be possible to separate the two classes correctly, or you may have some outliers which fall inside the margin. Any such misclassified points or points inside the margin would be penalized. This is where the \u201cslack\u201d value comes in, denoted by a greek letter \u03be (xi, pronounced \u201cksi\u201d). You may ignore it for now, but it will become more relevant when we look at support vector regression.", "In the graph above, we have a class of blue points and a class of green points. We try a few different hyperplanes to separate the points with the following results:", "In general, SVR is quite similar to SVM, but there are some notable differences:", "A simple way to think about SVR is to imagine a tube with an estimated function (hyperplane) in the middle and boundaries on either side defined by \u03b5. The algorithm's goal is to minimize the error by identifying a function that puts more of the original points inside the tube while at the same time reducing the \u201cslack.\u201d", "While the above explanations focus on linear examples, SVM and SVR algorithms can also handle non-linear situations through a kernel trick. A kernel is a function (you can choose between a few different ones) that takes the original non-linear problem and transforms it into a linear one, which is then handled by the algorithm in a higher-dimensional space.", "While I will not go into the details about kernel functions, you will see how to pick between different ones in the Python examples section below. However, if you are interested in how kernel functions work, you can refer to my SVM and RBF kernel story here:", "Now that we have some background about SVRs, it is time to build a couple of Python prediction models. Similar to other regression algorithms analyzed in my previous stories, we will utilize the following data and Python packages:", "First, we import the required libraries.", "Next, we download and ingest the data that we will use to build our SVR and linear regression models. Note, we also perform Min-Max scaling on features X2 and X3. I will explain the reason for this later on when we build a model with 2 independent variables. (source: https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv)", "We will take \u2018X3 distance to the nearest MRT station\u2019 as our input (independent) variable and \u2018Y house price of unit area\u2019 as our output (dependent) variable and create a scatterplot to visualize the data.", "As we can see from the graph above, there is a clear relationship between the two variables, with house price (per unit area) decreasing as the distance from the nearest MRT station increases.", "Let us now fit the two models. Note, we use the following hyperparameter values for the SVR model: epsilon = 10, C = 1. As explained before, epsilon defines the width of the tube around the hyperplane. Meanwhile, regularization parameter C allows us to assign the weight to \u201cslack,\u201d telling the algorithm how much we care about the error.", "Also, we use the default \u2018rbf\u2019 (radial-basis function) kernel. Other choices available in sklearn\u2019s SVR package are: \u2018linear\u2019, \u2018poly\u2019, \u2018sigmoid\u2019, and \u2018precomputed\u2019.", "With fitting done, let\u2019s visualize the two models.", "Visually we can see how support vector regression is much more flexible compared to linear regression. SVR can capture the slope change as the increase in the distance from the nearest MRT has a diminishing effect on a house's price.", "Meanwhile, simple linear regression has only one slope parameter, meaning that it maintains the curve's steepness throughout, overestimating the relationship at higher distance values.", "Let us now adjust the hyperparameter C, increasing it to 1000, and see how that affects the SVR model. Note, the Python code we use is identical to the one above apart from C=1000 instead of C=1. Here are the results visualized:", "You will note how increasing C to 1000 created a much more \u201cwavy\u201d best-fit line. By increasing C's value, we told the algorithm that we care a lot more about minimizing the \u201cslack.\u201d The algorithm responded to this by capturing more points inside the epsilon-tube.", "While increasing C allows us to fit the data better, it also makes our model less robust, risking overfitting. Hence, it is best to be cautious when tuning hyperparameters and split the data into training and testing datasets so you can evaluate your model with unseen data.", "Let\u2019s now take a look at another example using multiple independent variables.", "Given that SVR relies on distances between data points, it is beneficial to scale independent variables to ensure that they fit into the same range. Without scaling, we would have the most variation along the dimension with the highest range, leading to a worse prediction model.", "We start by creating a 3D scatterplot with the scaled versions of \u2018X3 distance to the nearest MRT station\u2019 and \u2018X2 house age\u2019 as our independent variables.", "We can see from the graph that the house price tends to increase as the house age decreases. Although the relationship between X2 and Y is not as strong as the one between X3 and Y, it will still improve our model.", "Let us now fit the two models and create a prediction plane. This time we use the following hyperparameters for the SVR model: epsilon = 1, C = 100. Note that we do not go through hyperparameter tuning in these examples. This means that the above hyperparameters may not be ideal for this model. Therefore, you should train and test multiple versions of the model to identify more optimal hyperparameter values.", "As we now have all the data ready, let us use Plotly again to create two 3D scatterplots. The first one contains a prediction plane from the linear regression model, and the second one shows the same for SVR.", "It is easy to see the difference between the two models. Multiple linear regression creates a prediction plane that looks like a flat sheet of paper. Meanwhile, SVR is more like a soft fabric that you can bend and fold in whatever way you need to fit your data better. This gives you a lot more flexibility and enables you to get a more accurate model.", "I have also embedded an interactive graph for you to explore.", "Support vector regression algorithm is a huge improvement over simple linear regression. It allows you to build non-linear models and gives you control over the flexibility vs. robustness of your models.", "As long as you are willing to spend a little bit of time tuning hyperparameters and evaluating model performance on the test samples, you will be able to get some excellent results.", "I hope you found this useful! You can find the complete Jupyter notebook in my GitHub repository. Please feel free to reach out if you have any feedback or questions. If you would like to learn about alternative regression methods, I have included links to my MARS and LOWESS stories below.", "If you have already spent your learning budget for this month, please remember me next time. My personalized link to join Medium is:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Demystifying Data Science and Machine Learning | Let\u2019s connect on LinkedIn \ud83e\udd1d https://bit.ly/SaulD | Join me on Medium \ud83e\udd13 https://bit.ly/SolClover"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4d25fbdaca60&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@solclover", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://solclover.com/?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": ""}, {"url": "https://solclover.com/?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": "Saul Dobilas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff77accd417be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&user=Saul+Dobilas&userId=f77accd417be&source=post_page-f77accd417be----4d25fbdaca60---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d25fbdaca60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d25fbdaca60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.com/", "anchor_text": "author"}, {"url": "https://solclover.com/subscribe", "anchor_text": "subscribe"}, {"url": "https://solclover.medium.com/", "anchor_text": "author."}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://towardsdatascience.com/svm-classifier-and-rbf-kernel-how-to-make-better-models-in-python-73bb4914af5b", "anchor_text": "SVM Classifier and RBF Kernel \u2014 How to Make Better Models in PythonA complete explanation of the inner workings of Support Vector Machines (SVM) and Radial Basis Function (RBF) kerneltowardsdatascience.com"}, {"url": "https://solclover.com/membership", "anchor_text": ""}, {"url": "https://www.linkedin.com/in/saulius-dobilas/", "anchor_text": ""}, {"url": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "anchor_text": "House price data from Kaggle"}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "Scikit-learn"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html", "anchor_text": "MinMaxScaler"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVR.html", "anchor_text": "SVR"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "linear regression"}, {"url": "https://plotly.com/python/", "anchor_text": "Plotly"}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas"}, {"url": "https://numpy.org/", "anchor_text": "Numpy"}, {"url": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "anchor_text": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv"}, {"url": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "anchor_text": "Kaggle"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.com/", "anchor_text": "author"}, {"url": "https://github.com/SolClover/Art015_ML_SVR", "anchor_text": "GitHub repository"}, {"url": "https://solclover.com/membership", "anchor_text": "Join Medium with my referral link - Saul DobilasAs a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026solclover.com"}, {"url": "https://towardsdatascience.com/mars-multivariate-adaptive-regression-splines-how-to-improve-on-linear-regression-e1e7a63c5eae", "anchor_text": "MARS: Multivariate Adaptive Regression Splines \u2014 How to Improve on Linear Regression?A visual explanation of the MARS algorithm with Python examples and comparison to linear regressiontowardsdatascience.com"}, {"url": "https://towardsdatascience.com/lowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35", "anchor_text": "LOWESS Regression in Python: How to Discover Clear Patterns in Your Data?A detailed guide to using Locally Weighted Scatterplot Smoothing (LOWESS) algorithm in Pythontowardsdatascience.com"}, {"url": "https://medium.com/tag/python?source=post_page-----4d25fbdaca60---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4d25fbdaca60---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/support-vector-machine?source=post_page-----4d25fbdaca60---------------support_vector_machine-----------------", "anchor_text": "Support Vector Machine"}, {"url": "https://medium.com/tag/support-vector-regression?source=post_page-----4d25fbdaca60---------------support_vector_regression-----------------", "anchor_text": "Support Vector Regression"}, {"url": "https://medium.com/tag/regression?source=post_page-----4d25fbdaca60---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d25fbdaca60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&user=Saul+Dobilas&userId=f77accd417be&source=-----4d25fbdaca60---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d25fbdaca60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&user=Saul+Dobilas&userId=f77accd417be&source=-----4d25fbdaca60---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d25fbdaca60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4d25fbdaca60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4d25fbdaca60---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4d25fbdaca60--------------------------------", "anchor_text": ""}, {"url": "https://solclover.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://solclover.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saul Dobilas"}, {"url": "https://solclover.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://bit.ly/SaulD", "anchor_text": "https://bit.ly/SaulD"}, {"url": "https://bit.ly/SolClover", "anchor_text": "https://bit.ly/SolClover"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff77accd417be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&user=Saul+Dobilas&userId=f77accd417be&source=post_page-f77accd417be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F35094ab887f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupport-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60&newsletterV3=f77accd417be&newsletterV3Id=35094ab887f3&user=Saul+Dobilas&userId=f77accd417be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}