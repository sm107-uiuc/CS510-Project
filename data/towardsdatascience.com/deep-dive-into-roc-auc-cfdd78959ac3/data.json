{"url": "https://towardsdatascience.com/deep-dive-into-roc-auc-cfdd78959ac3", "time": 1683009228.500725, "path": "towardsdatascience.com/deep-dive-into-roc-auc-cfdd78959ac3/", "webpage": {"metadata": {"title": "Deep dive into ROC-AUC. deep dive into ROC-AUC | by Songhao Wu | Towards Data Science", "h1": "Deep dive into ROC-AUC", "description": "Why ROC curve and Area under the curve are important for classification?"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@songhaowu/top-5-metrics-for-evaluating-classification-model-83ede24c7584", "anchor_text": "top metrics for classification", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_roc.html", "anchor_text": "here", "paragraph_index": 21}, {"url": "http://linkedin.com/in/songhaowu/", "anchor_text": "linkedin.com/in/songhaowu/", "paragraph_index": 25}], "all_paragraphs": ["I believe most people have heard of the ROC curve or Area under the Curve before if you are interested in data science. However, what exactly is the ROC curve, and why area under the ROC curve is a good metric to evaluate the classification model? I have briefly walked through in my previous article on top metrics for classification but I will go through in more detail in this article.", "The full name for ROC is Receiver Operating Characteristic. It was first created for the usage of radar signal detection during World War II. The US has used it to improve the accuracy of detecting Japanese Aircraft from Radar. That is why it is called receiver operating characteristic.", "AUC or the area under the curve is just the area under the ROC curve. Before we go into what is ROC curve, we need to understand quickly is Confusion Matrix.", "As you can see from the picture above, the confusion matrix is the combination of your prediction(1 or 0) vs actual value(1 or 0). Based on your prediction value and whether you have correctly classified it is divided into 4 sections. For example, true positive is the number of cases that you correctly classify the case to be positive while false positive means the number of cases that you wrongly classify the case to be positive.", "The confusion matrix contains only absolute numbers. However, based on these numbers, we can develop many new percentage-based metrics. True Positive Rate and False Positive Rate are two of them.", "Ok let us go into ROC curve now!", "As you can see from the graph, the ROC curve is simply TPR plotted against NPR. Ok end of the story\u2026", "There are a lot more information you can read from the chart. The first thing I want to ask here is : There is only one set of TPR,FPR for the model result and how do you form so many points to plot the graph?", "This goes back to how the classification model works. When you build a classification model like a decision tree and you want to classify maybe whether the stock will increase or decrease tomorrow based on the input. The classification model will first calculate the probability of increase or decrease based on the historical value you provided. After that, based on the threshold, it will decide whether the result is increasing or decreasing.", "Yes, the keyword here is the threshold. Different threshold creates different TPR and FPR. They represent different points and form up the ROC curve. You can choose the output to be \u2018Increase\u2019 if more than a 50% chance of increase based on historical data but you can also increase the threshold and only show \u2018Increase\u2019 if more than a 90% chance. If you choose 90% confidence instead of 50%, you will be more confident that the stocks you choose to show \u2018Increase\u2019 are very likely to increase but you may miss out on some potential stocks.", "As we know the bigger the area under the curve(AUC), the better the classification. The ideal or perfect curve is a vertical line from (0,0) to (0,1) and then to (1,1) which means the model can 100% separate positive and negative cases. However, if you pick randomly for each case, TPR and FPR should increase at the same rate. The blue dotted line shows the curve TPR and FPR when you blindly guess positive or negative for each case and for that diagonal line, the area under the curve(AUC) is 0.5.", "Look at the two dots on the ROC curve. Green dot has a very high threshold it means only if you are 99% sure then you can classify the case as positive. The red dot has a relatively lower threshold and it means you can classify the case to be positive if you are 90% confident.", "Whats the movement of TPR and FPR from green dot to red dot?", "Both TPR and FPR increase. When you reduce the threshold, more positive cases can be identified, thus TP increases, and TP/(TP+FN) also increases. On the other side, inevitably you will wrongly classify some negative cases to be positive due to the lowering of threshold and so FP & FP/(FP+TN) also increases.", "We can see that TPR and FPR are positively correlated and you have to balance between maximizing capture of positive cases and minimizing the wrong classification of negative cases.", "It is hard to define the optimal point because you should choose the most suitable threshold for the business case. However, the general rule is to maximize (TPR-FPR) which in the graph is represented by the vertical distance between the orange and blue dotted line.", "We can see from the chart above that among the three points, redpoint has the biggest TPR-FPR and should be considered as the optimal point. Moving from red point to green point, the threshold gets more strict. However, a big number of positive cases are not captured from the model with a less than proportionate decrease in wrongly classified cases. Moving from the red point to the blue point, the threshold is getting more lenient and adding more wrongly classified positive points than correctly identified positive points.", "A good metric of a machine learning model should display the true and consistent prediction ability of the model. It means if I change the testing dataset it should not have a very different score.", "ROC curve does not only consider the classification results but also the prediction probability of all classes. For example, if the output is classified correctly based on 51% probability, then it is very likely to be wrongly classified if you use another testing dataset. In addition, the ROC curve also considers the performance across the different thresholds and so it is a comprehensive metric to assess how good the separation of the cases in different groups.", "As I have shown before, for the binary classification problems, if you pick randomly you can achieve 0.5 AUC. Thus, if you are solving a binary classification problem, a reasonable ROC score should>0.5. A good classification model usually has AUC score >0.9 but it is totally application dependent.", "If you just want to find AUC score, you can refer to sklearn metric package here.", "If you want to plot the ROC curve for your model results you can refer to here", "Here is the code for me to plot the ROC example plot which I used in this article. You need two inputs which are the true value of y and also prediction probability. Note that the roc_curve function only needs probability for the positive cases but not the probability for both classes. If you have a multi-class classification problem, you can also use the package and there is an example of how to plot it in the link above.", "If you are interested to know what are the other top metrics for the evaluation of the classification model, you can refer to the link below:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Enthusiast | Let's have this data journey together! | linkedin.com/in/songhaowu/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcfdd78959ac3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://songhaowu.medium.com/?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": ""}, {"url": "https://songhaowu.medium.com/?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": "Songhao Wu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F33a26b3749a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&user=Songhao+Wu&userId=33a26b3749a7&source=post_page-33a26b3749a7----cfdd78959ac3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcfdd78959ac3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcfdd78959ac3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@songhaowu/top-5-metrics-for-evaluating-classification-model-83ede24c7584", "anchor_text": "top metrics for classification"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_roc.html", "anchor_text": "here"}, {"url": "https://medium.com/@songhaowu/top-5-metrics-for-evaluating-classification-model-83ede24c7584", "anchor_text": "Top 5 metrics for evaluating Classification ModelDifferent from Regression model, when we assess classification model results , we should not only focus on prediction\u2026medium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cfdd78959ac3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cfdd78959ac3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification-models?source=post_page-----cfdd78959ac3---------------classification_models-----------------", "anchor_text": "Classification Models"}, {"url": "https://medium.com/tag/classification-problem?source=post_page-----cfdd78959ac3---------------classification_problem-----------------", "anchor_text": "Classification Problem"}, {"url": "https://medium.com/tag/roc?source=post_page-----cfdd78959ac3---------------roc-----------------", "anchor_text": "Roc"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcfdd78959ac3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&user=Songhao+Wu&userId=33a26b3749a7&source=-----cfdd78959ac3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcfdd78959ac3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&user=Songhao+Wu&userId=33a26b3749a7&source=-----cfdd78959ac3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcfdd78959ac3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcfdd78959ac3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cfdd78959ac3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cfdd78959ac3--------------------------------", "anchor_text": ""}, {"url": "https://songhaowu.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://songhaowu.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Songhao Wu"}, {"url": "https://songhaowu.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "433 Followers"}, {"url": "http://linkedin.com/in/songhaowu/", "anchor_text": "linkedin.com/in/songhaowu/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F33a26b3749a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&user=Songhao+Wu&userId=33a26b3749a7&source=post_page-33a26b3749a7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7a191443ce50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-dive-into-roc-auc-cfdd78959ac3&newsletterV3=33a26b3749a7&newsletterV3Id=7a191443ce50&user=Songhao+Wu&userId=33a26b3749a7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}