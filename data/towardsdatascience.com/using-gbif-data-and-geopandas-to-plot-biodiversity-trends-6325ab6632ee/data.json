{"url": "https://towardsdatascience.com/using-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee", "time": 1683005435.2840052, "path": "towardsdatascience.com/using-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee/", "webpage": {"metadata": {"title": "Using GBIF data and GeoPandas to plot biodiversity trends | by Wyatt Sharber, PhD | Towards Data Science", "h1": "Using GBIF data and GeoPandas to plot biodiversity trends", "description": "Continuing from my last post where I introduced GBIF and how to access this excellent source of biodiversity data via the API using Python code, in this post I\u2019m going to show a couple of different\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@wvsharber/introduction-to-gbif-the-global-biodiversity-information-facility-8a0ab65aae34", "anchor_text": "my last post", "paragraph_index": 0}, {"url": "https://rasterio.readthedocs.io/en/latest/", "anchor_text": "rasterio", "paragraph_index": 2}, {"url": "https://geopandas.org/index.html", "anchor_text": "GeoPandas", "paragraph_index": 2}, {"url": "https://www.iban.com/country-codes", "anchor_text": "ISO A3 code", "paragraph_index": 5}, {"url": "https://www.naturalearthdata.com/downloads/50m-cultural-vectors/", "anchor_text": "NaturalEarth", "paragraph_index": 6}, {"url": "https://github.com/wvsharber/gbif-occurences", "anchor_text": "Here\u2019s the link to my GitHub page", "paragraph_index": 13}], "all_paragraphs": ["Continuing from my last post where I introduced GBIF and how to access this excellent source of biodiversity data via the API using Python code, in this post I\u2019m going to show a couple of different ways to map the previously downloaded biodiversity data. This will be a code-heavy post, mostly using GeoPandas, and culminating in the reproduction of a figure I used in my dissertation. However, I used a combination of R and ArcGIS to create that figure, and now I just use Python! Hopefully, it will be a useful tutorial on mapping with GeoPandas, which is a great tool for working with geospatial data!", "If you\u2019re interested in how biodiversity changes between different areas, a map is a great way to visualize the differences spatially. In evolutionary biology, it\u2019s often interesting to know where different \u201chotspots\u201d of biodiversity are, i.e., areas of relatively high biodiversity. These hotspots can represent areas of high speciation rates, or if you\u2019re looking at a single group of organisms, they might represent their area of origin. Good visualizations of biodiversity are very useful for biologists!", "Creating quality maps is complicated and when I first approached this problem as a grad student, I relied heavily on pre-existing software and the extremely helpful GIS help desk at my library. Now that I have a lot more programming skills, it was really fun to redo this problem with Python. In Python, there are a few great packages for dealing with geospatial data. If you\u2019re working with raster data (pixel-based data), definitely check out rasterio. In this problem though, I found it easier to work with the package GeoPandas, which is built off of the incredibly useful Pandas DataFrame, but incorporates a geometry feature using the shapely library. Just like there are DataFrames and Series in Pandas, in GeoPandas you have GeoDataFrames and GeoSeries, allowing you to associate other features with your geographic data. Almost anything that can be done with Pandas can be done with GeoPandas.", "One way to map biodiversity could be by some existing geographical delimitation, such as country. These are called choropleth maps, and there are a few different packages out there that can make them. It\u2019s pretty easy in GeoPandas, which builds upon matplotlib for plotting. This is what we\u2019ll make first.", "Mapping by Country-wide Species Counts (Choropleth Maps)", "Starting with a DataFrame of the species data, country of origin, and geographic coordinates, getting a count for the number of species per country is a simple aggregation function away. I suggest adding a column in your dataset using the three-letter ISO A3 code for each country, it makes things a lot simpler when joining DataFrames later. You can check out my GitHub (link at the bottom of this post) for details on that.", "In addition to your species DataFrame, you\u2019ll need a GeoDataFrame to serve as the basemap for plotting. I used the medium resolution country shapefiles available from NaturalEarth. In the code below, I show how to merge the two DataFrames, and then plot the choropleth map (Figure 1).", "While the choropleth shows where the species diversity in Ayenia is located, it\u2019s not quite specific enough. Some of these countries are very large (e.g., Brazil, U.S.), so it would be more interesting to know where in these countries these species are found. Furthermore, by coloring the entire country the map can be misleading. For example, in Argentina in South America, Ayenia is restricted to the northern parts of the country (above -30\u00ba), and in the U.S., Ayenia is only found in the most southern parts of the country. I want a more realistic representation of where these plants are found.", "For the next map, I want to count the number of species that can be found in each 1\u00ba grid square on the map. This will make a more detailed map of where biodiversity in Ayenia is found. In order to do this, I had to do the following steps:", "And here is my code for each step:", "At this point, we have a GeoDataFrame of non-overlapping 1\u00ba grid cells across our range of interest (Figure 2). You could easily adapt this code to have a smaller or larger grid cell size (say, 0.5\u00ba or 10\u00ba) and to cover a larger or smaller range of portion of the earth depending on your needs. I would suggest making it as small as possible though, because this next step is not very efficient and took over 30 minutes to run on my laptop.", "Now we have a much better representation of where Ayenia is growing and where it isn\u2019t, and where there are more species and where there are fewer. In Figure 3, you can see that Mexico, especially southern Mexico, is a hotspot for Ayenia diversity. There are a couple more hotspots in southern Brazil and in the area around Paraguay, Bolivia, and northern Argentina. These areas all have similar habitats consisting of seasonally dry tropical forests or savannas. There are a couple of grid cells in the middle of Brazil and Argentina with very high species numbers, but those are likely not real and due to some specimens from our data with ambiguous locality data and were given GIS coordinates in the middle of the country. I\u2019ll have to remove those by hand in the future.", "I hope these bits of code have been useful for learning how to make maps of biodiversity. If anyone is interested in applying this to their own group of organisms and needs help getting this running, I\u2019d be happy to help you out!", "Here\u2019s the link to my GitHub page with this code in Jupyter Notebooks.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist and plant evolutionary biologist. Seattle, WA, USA."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6325ab6632ee&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wvsharber?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wvsharber?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": "Wyatt Sharber, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff5f584e78ef8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=post_page-f5f584e78ef8----6325ab6632ee---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6325ab6632ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6325ab6632ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@wvsharber/introduction-to-gbif-the-global-biodiversity-information-facility-8a0ab65aae34", "anchor_text": "my last post"}, {"url": "https://rasterio.readthedocs.io/en/latest/", "anchor_text": "rasterio"}, {"url": "https://geopandas.org/index.html", "anchor_text": "GeoPandas"}, {"url": "https://www.iban.com/country-codes", "anchor_text": "ISO A3 code"}, {"url": "https://www.naturalearthdata.com/downloads/50m-cultural-vectors/", "anchor_text": "NaturalEarth"}, {"url": "https://github.com/wvsharber/gbif-occurences", "anchor_text": "Here\u2019s the link to my GitHub page"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6325ab6632ee---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----6325ab6632ee---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/maps?source=post_page-----6325ab6632ee---------------maps-----------------", "anchor_text": "Maps"}, {"url": "https://medium.com/tag/gbif?source=post_page-----6325ab6632ee---------------gbif-----------------", "anchor_text": "Gbif"}, {"url": "https://medium.com/tag/geopandas?source=post_page-----6325ab6632ee---------------geopandas-----------------", "anchor_text": "Geopandas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6325ab6632ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=-----6325ab6632ee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6325ab6632ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=-----6325ab6632ee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6325ab6632ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6325ab6632ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6325ab6632ee---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6325ab6632ee--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6325ab6632ee--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6325ab6632ee--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6325ab6632ee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wvsharber?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wvsharber?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wyatt Sharber, PhD"}, {"url": "https://medium.com/@wvsharber/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff5f584e78ef8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=post_page-f5f584e78ef8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F710da34dfc22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-gbif-data-and-geopandas-to-plot-biodiversity-trends-6325ab6632ee&newsletterV3=f5f584e78ef8&newsletterV3Id=710da34dfc22&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}