{"url": "https://towardsdatascience.com/speed-cubing-for-machine-learning-8d32a40aa474", "time": 1683016759.7186382, "path": "towardsdatascience.com/speed-cubing-for-machine-learning-8d32a40aa474/", "webpage": {"metadata": {"title": "Speed Cubing for Machine Learning | by Nicolas Morizet | Towards Data Science", "h1": "Speed Cubing for Machine Learning", "description": "In Episode 1 [1], we described how to generate 3D data as fast as possible to feed some Generative Adversarial Networks, using CPUs, multithreading and Cloud resources. We reached a rate of 2 billion\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/speed-cubing-for-machine-learning-a5c6775fff0b", "anchor_text": "Episode 1", "paragraph_index": 1}, {"url": "https://rapids.ai/", "anchor_text": "RAPIDS", "paragraph_index": 6}, {"url": "https://rapids.ai/start.html", "anchor_text": "website", "paragraph_index": 6}, {"url": "https://cupy.dev/", "anchor_text": "CuPy library", "paragraph_index": 9}, {"url": "https://docs.cupy.dev/en/stable/", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://vispy.org/", "anchor_text": "VisPy", "paragraph_index": 15}, {"url": "https://vispy.org/documentation.html", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://github.com/vispy/vispy/blob/master/examples/basics/scene/volume.py", "anchor_text": "volume rendering example", "paragraph_index": 16}, {"url": "http://vispy.org", "anchor_text": "VisPy: a Python library for interactive scientific visualization (2020)", "paragraph_index": 18}, {"url": "https://www.advestis.com/", "anchor_text": "Advestis", "paragraph_index": 19}, {"url": "https://www.linkedin.com/company/advestis/", "anchor_text": "https://www.linkedin.com/company/advestis/", "paragraph_index": 19}], "all_paragraphs": ["Previously on \u201cSpeed Cubing for Machine Learning\u201d\u2026", "In Episode 1 [1], we described how to generate 3D data as fast as possible to feed some Generative Adversarial Networks, using CPUs, multithreading and Cloud resources. We reached a rate of 2 billion data points per second !In this Episode 2, we are going to benefit from GPUs through a dedicated framework called RAPIDS. Also, we will see how to visualize the generated data, thanks to a GPU accelerated library named VisPy.", "Our new objective is to go even faster at creating cubes and to be able to properly visualize them.", "As a reminder, our raw data are still represented by a numpy.ndarray, built like this:", "And the function to generate a cube is written as follows:", "Also, here are the specs of our local machine:", "RAPIDS [2] is a GPU oriented data science framework. RAPIDS uses optimized NVIDIA CUDA primitives and high-bandwidth GPU memory to accelerate the execution of your Python code. It is simple to use, and is available as some conda packages, docker images or source builds. We recommend you to choose the selected configuration bellow (Figure 1), except for the CUDA version that must be compatible with your hardware. Don\u2019t forget to follow the prerequisites on their website before diving in:", "Once you execute the above command (Figure 1) in a terminal, you will download the docker image corresponding to the selected configuration (this can take some time).", "Then, you will be able to run a local Jupyter Lab (an improved Notebook), where you have the whole technical environment already set up for you (Linux, Python, RAPIDS, CUDA library, etc.), along with several demos to explore the usage of tools like CuML, CuGraph or XGBoost. Time to have fun with your graphic card !", "In order to harness the power of your GPU, you will use the CuPy library [3].CuPy is an open-source array library accelerated with NVIDIA CUDA, higly compatible with NumPy and provides GPU accelerated computing with Python. CuPy is already included in the RAPIDS framework. You will find the CuPy official documentation here.", "Now, this is where the magic happens ! In only one line, we are going to perform what we call a data transfer by moving our previous numpy.ndarray to the current GPU device. Our data array will now be considered as a GPU object :", "Now, Let\u2019s see how long it takes to generate 10,000 cubes of dimension 100 x 100 x 100 in a simple loop (we don\u2019t need to care about multithreading anymore):", "This is quite impressive because it\u2019s nearly 2,5x faster than the best solution we previously found in the Cloud (the \u2018n2-highcpu-80\u2019 virtual machine instance, with 80 cores, Intel Cascade Lake @2.80 GHz, 80GB of RAM).And, it\u2019s only on our single local GPU (NVIDIA GeForce GTX 1080 Ti).", "\u201cThe Central Processing Unit (CPU) has often been called the brains of the PC. But increasingly, that brain is being enhanced by another part of the PC \u2014 the GPU (Graphics Processing Unit), which is its soul.\u201d", "Here, we will share some simple insights that may explain why GPUs are so fast compared to CPUs. CPUs have a few complex cores which run processes sequentially, with a lot of cache memory that can handle a few software threads at a time. In contrast, GPUs have hundreds of simple cores which allow parallel computing, that can handle thousands of threads simultaneously (Table 2). GPUs were designed with one goal in mind: process graphics really fast. Bandwidth is one of the main reasons why GPUs are faster for computing than CPUs.", "VisPy [4] is a high-performance interactive 2D/3D data visualization library leveraging the computational power of modern GPUs through the OpenGL library. You will find the official documentation here.", "We finally can visualize one generated cube (Figure 3). Here, we adapted a code from the volume rendering example you can find on their GitHub repository.", "In this episode, we have seen how to take advantage of the GPU to increase the rate of 3D data generation and how to visualize them. In the last episode of this series, we will tackle the multi-GPUs challenge. See you in Episode 3 !", "[4] VisPy: a Python library for interactive scientific visualization (2020).", "Advestis is a European Contract Research Organization (CRO) with a deep understanding and practice of statistics, and interpretable machine learning techniques. The expertise of Advestis covers the modeling of complex systems and predictive analysis for temporal phenomena.LinkedIn: https://www.linkedin.com/company/advestis/", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD, Senior AI Research Scientist at Advestis."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8d32a40aa474&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nicolas.morizet?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nicolas.morizet?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": "Nicolas Morizet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8f408c864b3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&user=Nicolas+Morizet&userId=8f408c864b3d&source=post_page-8f408c864b3d----8d32a40aa474---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8d32a40aa474&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8d32a40aa474&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lazycreekimages?utm_source=medium&utm_medium=referral", "anchor_text": "Michael Dziedzic"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/speed-cubing-for-machine-learning-a5c6775fff0b", "anchor_text": "Speed Cubing for Machine LearningEpisode 1: How to optimize Python code, CPU and I/O utilizations along with deployment in the Cloud.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/speed-cubing-for-machine-learning-a5c6775fff0b", "anchor_text": "Episode 1"}, {"url": "https://rapids.ai/", "anchor_text": "RAPIDS"}, {"url": "https://rapids.ai/start.html", "anchor_text": "website"}, {"url": "https://developer.nvidia.com/cuda-gpus", "anchor_text": "compute capability"}, {"url": "https://github.com/NVIDIA/nvidia-docker#quickstart", "anchor_text": "nvidia-container-toolkit"}, {"url": "https://rapids.ai/start.html", "anchor_text": "https://rapids.ai/start.html"}, {"url": "https://cupy.dev/", "anchor_text": "CuPy library"}, {"url": "https://docs.cupy.dev/en/stable/", "anchor_text": "here"}, {"url": "https://blogs.nvidia.com/blog/2009/12/16/whats-the-difference-between-a-cpu-and-a-gpu/", "anchor_text": "https://blogs.nvidia.com/blog/2009/12/16/whats-the-difference-between-a-cpu-and-a-gpu/"}, {"url": "https://blogs.nvidia.com/blog/2009/12/16/whats-the-difference-between-a-cpu-and-a-gpu/", "anchor_text": "https://blogs.nvidia.com/blog/2009/12/16/whats-the-difference-between-a-cpu-and-a-gpu/"}, {"url": "https://vispy.org/", "anchor_text": "VisPy"}, {"url": "https://vispy.org/documentation.html", "anchor_text": "here"}, {"url": "https://github.com/vispy/vispy/blob/master/examples/basics/scene/volume.py", "anchor_text": "volume rendering example"}, {"url": "https://towardsdatascience.com/speed-cubing-for-machine-learning-a5c6775fff0b", "anchor_text": "N. Morizet, \u201cSpeed Cubing for Machine Learning \u2014 Episode 1\u201d (2020), Towards Data Science."}, {"url": "https://rapids.ai/", "anchor_text": "RAPIDS: open GPU Data Science (2020)"}, {"url": "https://cupy.dev/", "anchor_text": "CuPy: a NumPy-compatible array library accelerated by CUDA (2020)"}, {"url": "http://vispy.org", "anchor_text": "VisPy: a Python library for interactive scientific visualization (2020)"}, {"url": "https://www.advestis.com/", "anchor_text": "Advestis"}, {"url": "https://www.linkedin.com/company/advestis/", "anchor_text": "https://www.linkedin.com/company/advestis/"}, {"url": "https://medium.com/tag/gpu?source=post_page-----8d32a40aa474---------------gpu-----------------", "anchor_text": "Gpu"}, {"url": "https://medium.com/tag/python?source=post_page-----8d32a40aa474---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8d32a40aa474---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----8d32a40aa474---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/rapids-ai?source=post_page-----8d32a40aa474---------------rapids_ai-----------------", "anchor_text": "Rapids Ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8d32a40aa474&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&user=Nicolas+Morizet&userId=8f408c864b3d&source=-----8d32a40aa474---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8d32a40aa474&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&user=Nicolas+Morizet&userId=8f408c864b3d&source=-----8d32a40aa474---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8d32a40aa474&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8d32a40aa474&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8d32a40aa474---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8d32a40aa474--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8d32a40aa474--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8d32a40aa474--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8d32a40aa474--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nicolas.morizet?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nicolas.morizet?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nicolas Morizet"}, {"url": "https://medium.com/@nicolas.morizet/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "16 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8f408c864b3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&user=Nicolas+Morizet&userId=8f408c864b3d&source=post_page-8f408c864b3d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F8f408c864b3d%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeed-cubing-for-machine-learning-8d32a40aa474&user=Nicolas+Morizet&userId=8f408c864b3d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}