{"url": "https://towardsdatascience.com/how-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38", "time": 1683015625.525076, "path": "towardsdatascience.com/how-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38/", "webpage": {"metadata": {"title": "How much of your Neural Network\u2019s Prediction can be Attributed to each Input Feature? | by Youness Mansar | Towards Data Science", "h1": "How much of your Neural Network\u2019s Prediction can be Attributed to each Input Feature?", "description": "Neural networks are known to be black box predictors where the data scientist does not usually know which particular input feature influenced the prediction the most. This can be rather limiting if\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Neural networks are known to be black box predictors where the data scientist does not usually know which particular input feature influenced the prediction the most. This can be rather limiting if we want to get some understanding of what the model actually learned. Having this kind of understanding may allow us to find bugs or weaknesses in our learning algorithm or in our data processing pipeline and thus be able to improve them.", "The approach that we will implement in this project is called integrated gradients and it was introduced in the following paper:", "In this paper, the authors list some desirable axioms that a good attribution method should follow and prove that their method Integrated gradients satisfies those axioms. Some of those axioms are:", "More axioms are available in detail in the paper linked above.", "The Integrated Gradient is very easy to implement and use, it only requires the ability to compute the gradient of the output of the neural network with respect to its inputs. This is easily doable in PyTorch, we will detail how it can be done in what follows.", "We represent our neural network as a function F:", "We are interested in the attribution of the feature vector x and also introduce a baseline feature vector x\u2019. This baseline x\u2019 allows us to model the \u201cabsence\u201d of a cause, and its output by the neural network should be close to zero.", "The integrated gradients method is computed as follows:", "Where x_i is the i-th feature of the vector x.", "Let's generate a synthetic data set to try and understand this method better.", "We set our data generation process as:", "Which can be done in python like this:", "We can see that the coefficients are not the same for all features, some are positive, some are negative and some are null.", "We train a multi-layer perceptron on this data and if the model correctly learns the data pattern then we expect to find that the attribution of feature x_i is approximately equal to:", "Since it is the amount by which feature i changed the output compared to the baseline.", "So let's implement Integrated gradients and check if our empirical results make sense.", "First, we train a regression model in PyTorch by fitting it on the training data. We then choose x\u2019 to be all zeros.", "In order to compute the integral, we use an approximation by which we compute the value of dF at small intervals by going from x to x\u2019 and then summing dF * size_of_interval. The whole process is implemented using the following function:", "The gradient is easily computed using torch.autograd.grad. In our function, the operations are vectorized for all features at the same time.", "Now that we got the Integrated Gradients, let's check if it fits what we expected:", "We can see that the estimated value of the attribution (in orange) fits very closely with what we were expecting (in blue). The approach was able to identify how features influenced the output and which ones had no effect on the target.", "Now let's work on an image classification example, we will use resnet18 trained on ImageNet applied to a picture of my cat. We will use the exact same process as above and each image pixel will be considered as an input feature. We will get a result where each pixel is represented by how much it influenced the classification of the image as a Tabby cat.", "We can see that pixels that mostly influenced the \u201cTabby Cat\u201d output neuron are located on the face of the cat.", "Integrated Gradients is a great method to get some understanding of the influence of each input feature on the output of your neural network. This method solves some of the shortcomings of existing approaches and satisfies some axioms like Sensitivity and implementation invariance.This approach can be a great tool when working on neural networks in order to better understand their predictions or even detect if there are some issues with the training algorithm or dataset.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F62581efd9b38&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----62581efd9b38--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62581efd9b38--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@CVxTz?source=post_page-----62581efd9b38--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@CVxTz?source=post_page-----62581efd9b38--------------------------------", "anchor_text": "Youness Mansar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F830ca2245343&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&user=Youness+Mansar&userId=830ca2245343&source=post_page-830ca2245343----62581efd9b38---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62581efd9b38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62581efd9b38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@imgly?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "img.ly"}, {"url": "https://unsplash.com/s/photos/gradient?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1703.01365", "anchor_text": "Axiomatic Attribution for Deep Networks"}, {"url": "https://github.com/CVxTz/IntegratedGradientsPytorch", "anchor_text": "https://github.com/CVxTz/IntegratedGradientsPytorch"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----62581efd9b38---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----62581efd9b38---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----62581efd9b38---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----62581efd9b38---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/attribution?source=post_page-----62581efd9b38---------------attribution-----------------", "anchor_text": "Attribution"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62581efd9b38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&user=Youness+Mansar&userId=830ca2245343&source=-----62581efd9b38---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62581efd9b38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&user=Youness+Mansar&userId=830ca2245343&source=-----62581efd9b38---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62581efd9b38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62581efd9b38--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F62581efd9b38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----62581efd9b38---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----62581efd9b38--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----62581efd9b38--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----62581efd9b38--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----62581efd9b38--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----62581efd9b38--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----62581efd9b38--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----62581efd9b38--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----62581efd9b38--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@CVxTz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@CVxTz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Youness Mansar"}, {"url": "https://medium.com/@CVxTz/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "425 Followers"}, {"url": "https://www.linkedin.com/in/mansar/", "anchor_text": "https://www.linkedin.com/in/mansar/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F830ca2245343&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&user=Youness+Mansar&userId=830ca2245343&source=post_page-830ca2245343--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7e379bdcb386&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-much-of-your-neural-networks-prediction-can-be-attributed-to-each-input-feature-62581efd9b38&newsletterV3=830ca2245343&newsletterV3Id=7e379bdcb386&user=Youness+Mansar&userId=830ca2245343&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}