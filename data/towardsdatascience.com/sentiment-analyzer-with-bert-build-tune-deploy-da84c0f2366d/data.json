{"url": "https://towardsdatascience.com/sentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d", "time": 1683011525.533338, "path": "towardsdatascience.com/sentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d/", "webpage": {"metadata": {"title": "Sentiment Analyzer with BERT (build, tune, deploy) | by Zuzanna Deutschman | Towards Data Science", "h1": "Sentiment Analyzer with BERT (build, tune, deploy)", "description": "I used the dataset published by The Stanford NLP Group. I merged two files, namely \u2018dictionary.txt\u2019 including 239,232 text fragments and \u2018sentiment_labels.txt\u2019 containing the sentiment scores\u2026"}, "outgoing_paragraph_urls": [{"url": "https://nlp.stanford.edu/sentiment/", "anchor_text": "dataset published by The Stanford NLP Group", "paragraph_index": 0}, {"url": "https://github.com/hanxiao/bert-as-service", "anchor_text": "bert-as-service", "paragraph_index": 3}, {"url": "https://www.simplilearn.com/tutorials/docker-tutorial", "anchor_text": "Docker", "paragraph_index": 20}], "all_paragraphs": ["I used the dataset published by The Stanford NLP Group. I merged two files, namely \u2018dictionary.txt\u2019 including 239,232 text fragments and \u2018sentiment_labels.txt\u2019 containing the sentiment scores assigned to the various text fragments.", "To clean the text, I usually use a bunch of functions containing regular expressions. In common.py you can find all of them, for example remove_nonwords described below:", "Similar functions were used for empty rows, special signs, numbers and html code removal.", "After text cleaning, it\u2019s time for BERT embeddings creation. For that purpose, I used bert-as-service. It is very simple and consists of only 3 steps: download a pre-trained model, start the BERT service and use client for sentence encodings of specified length.", "There are multiple parameters that can be setup, when running a service. For example, to define max_seq_len, I calculated 0.9 quantile of train data length.", "Preprocessed data has a form of data frame containing 768 features. For full code, please go to nlp_preprocess.py.", "In this part, we build and train the model on different parameters. Let\u2019s assume we want 5-layers neural network as below. We will parametrize batch_size, number of epochs, number of nodes in the first 4 dense layers and 5 dropout layers.", "Now we can tune the parameters. We will use sacred module. Key points here are:", "1. Create an Experiment and add Observer", "First we need to create an experiment and observer that logs all kinds of information. It\u2019s very simple!", "The @ex.automain decorator defines and runs the main function of the experiment when we run the Python script.", "We will define them through Config Scope.", "In our case here I want to know the MAE and MSE. We can use the Metrics API for that.", "Functions from the previous steps are stored in model_experiment.py script. In order to run our exepriment for bunch of parameters, we create and run run_sacred.py. For all possible permutations, MAE and MSE will be saved in MongoDB.", "The best result I got is 9% of MAE score. That means that our sentiment analyzer works pretty good. We can check it with model_inference function.", "Please note that the score is normalized so that outlier values can be also obtained. After model is saved, we can build a Web API!", "Now we want to create an API that runs the code in the function and displays the returned result in the browser.", "The syntax @app.route('/score', methods=['PUT']) lets Flask know that the function, score, should be mapped to the endpoint/score. The methods list is a keyword argument that tells us what kind of HTTP requests are allowed. We\u2019ll be using PUT requests to receive sentences from a user. In function score, we get a score in dictionary form, since it can be easily converted to a JSON string. Full code is available in api.py.", "For web interface, three files were created:", "For gradient HSV model was used. Saturation and Value are constants. Hue corresponds to score value. Changing hue in range [0;120] yields smooth colour change from red to yellow to green.", "The brilliance of Docker is that, once you package an application and all its dependencies into container, you ensure it will run in any environment. It is generally recommended to separate areas of concern by using one service per container. In my small app there are 3 parts that should be combined: bert-as-service, application and frontend. The tool that helps you build Docker images and run containers is Docker Compose.", "Steps that we need to do to dockerize our code:", "Now we are ready to build and run our application! Please see the sample outputs below.", "As usual, please feel free to view the full code on my GitHub.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Machine Learning Engineer at EY, Poland"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fda84c0f2366d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zuzannadeutschman?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zuzannadeutschman?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": "Zuzanna Deutschman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdc134fe9f7c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&user=Zuzanna+Deutschman&userId=dc134fe9f7c3&source=post_page-dc134fe9f7c3----da84c0f2366d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda84c0f2366d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda84c0f2366d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://nlp.stanford.edu/sentiment/", "anchor_text": "dataset published by The Stanford NLP Group"}, {"url": "https://github.com/hanxiao/bert-as-service", "anchor_text": "bert-as-service"}, {"url": "https://www.simplilearn.com/tutorials/docker-tutorial", "anchor_text": "Docker"}, {"url": "https://docs.docker.com/engine/reference/builder/", "anchor_text": "documentation"}, {"url": "https://github.com/zuzadeu/Sentiment-Analyzer-with-BERT", "anchor_text": "GitHub - zuzadeu/Sentiment-Analyzer-with-BERTYou can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or\u2026github.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----da84c0f2366d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----da84c0f2366d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----da84c0f2366d---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/deployment?source=post_page-----da84c0f2366d---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----da84c0f2366d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda84c0f2366d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&user=Zuzanna+Deutschman&userId=dc134fe9f7c3&source=-----da84c0f2366d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda84c0f2366d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&user=Zuzanna+Deutschman&userId=dc134fe9f7c3&source=-----da84c0f2366d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda84c0f2366d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fda84c0f2366d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----da84c0f2366d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----da84c0f2366d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----da84c0f2366d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----da84c0f2366d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----da84c0f2366d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zuzannadeutschman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zuzannadeutschman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Zuzanna Deutschman"}, {"url": "https://medium.com/@zuzannadeutschman/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "129 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdc134fe9f7c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&user=Zuzanna+Deutschman&userId=dc134fe9f7c3&source=post_page-dc134fe9f7c3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fdc134fe9f7c3%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analyzer-with-bert-build-tune-deploy-da84c0f2366d&user=Zuzanna+Deutschman&userId=dc134fe9f7c3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}