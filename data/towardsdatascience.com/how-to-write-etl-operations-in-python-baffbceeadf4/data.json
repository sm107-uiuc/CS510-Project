{"url": "https://towardsdatascience.com/how-to-write-etl-operations-in-python-baffbceeadf4", "time": 1683013013.518259, "path": "towardsdatascience.com/how-to-write-etl-operations-in-python-baffbceeadf4/", "webpage": {"metadata": {"title": "How to write ETL operations in Python | by hotglue | Towards Data Science", "h1": "How to write ETL operations in Python", "description": "In this article, you\u2019ll learn how to work with Excel/CSV files in a Python environment to clean and transform raw data into a more ingestible format. This is typically useful for data integration\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/hotgluexyz/recipes", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://hotglue.xyz/", "anchor_text": "hotglue", "paragraph_index": 5}, {"url": "https://pypi.org/project/gluestick/", "anchor_text": "gluestick", "paragraph_index": 8}, {"url": "https://pypi.org/project/gluestick/", "anchor_text": "gluestick", "paragraph_index": 13}, {"url": "https://pypi.org/project/gluestick/", "anchor_text": "gluestick", "paragraph_index": 17}, {"url": "https://github.com/hotgluexyz/recipes", "anchor_text": "hotglue recipes", "paragraph_index": 22}], "all_paragraphs": ["In this article, you\u2019ll learn how to work with Excel/CSV files in a Python environment to clean and transform raw data into a more ingestible format. This is typically useful for data integration.", "This example will touch on many common ETL operations such as filter, reduce, explode, and flatten.", "The code for these examples is available publicly on GitHub here, along with descriptions that mirror the information I\u2019ll walk you through.", "These samples rely on two open source Python packages:", "Without further ado, let\u2019s dive in!", "This example leverages sample Quickbooks data from the Quickbooks Sandbox environment, and was initially created in a hotglue environment \u2014 a light-weight data integration tool for startups.", "Feel free to follow along with the Jupyter Notebook on GitHub below!", "Let\u2019s start by reading the data.", "This example is built on a hotglue environment with data coming from Quickbooks. In hotglue, the data is placed in the local sync-output folder in a CSV format. We will use the gluestick package to read the raw data in the input folder into a dictionary of pandas dataframes using the read_csv_folder function.", "By specifying index_cols={'Invoice': 'DocNumber'} the Invoices dataframe will use the DocNumber column as an index. By specifying converters, we can use ast to parse the JSON data in the Line and CustomField columns.", "Let\u2019s take a look at what data we\u2019re working with. For simplicity, I\u2019ve selected the columns I\u2019d like to work with and saved it to input_df. Typically in hotglue you can configure this using a field map, but I've done it manually here.", "Let\u2019s clean up the data by renaming the columns to more readable names.", "The Line column is actually a serialized JSON object provided by Quickbooks with several useful elements in it. We'll need to start by flattening the JSON and then exploding into unique columns so we can work with the data.", "Again, we\u2019ll use the gluestick package to accomplish this. The explode_json_to_rows function handles the flattening and exploding in one step. To avoid exploding too many levels of this object, we'll specify max_level=1", "Here is a snippet from one to give you an idea.", "For our purposes, we only want to work with rows with a Line.DetailType of SalesItemLineDetail (we dont need sub-total lines). This is a common ETL operation known as filtering and is accomplished easily with pandas", "Look at some of the entries from the Line column we exploded. You'll notice they are name value pairs in JSON.", "Let\u2019s use gluestick again to explode these into new columns via the json_tuple_to_cols function. We'll need to specify lookup_keys - in our case, the key_prop=name and value_prop=value", "Take a look at the CustomField column. Below is an example of an entry", "You can see this is JSON encoded data, specifying one custom field: Crew # with value 102", "To explode this, we\u2019ll need to reduce this as we only care about the Name and StringValue. We can use gluestick's explode_json_to_cols function with an array_to_dict_reducer to accomplish this.", "Our final data looks something like below. In this sample, we went through several basic ETL operations using a real world example all with basic Python tools.", "Feel free to check out the open source hotglue recipes for more samples in the future. Thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Easily build integrations with your customers\u2019 business apps"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbaffbceeadf4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hotglue.medium.com/?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": ""}, {"url": "https://hotglue.medium.com/?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": "hotglue"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F12b73f121333&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&user=hotglue&userId=12b73f121333&source=post_page-12b73f121333----baffbceeadf4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbaffbceeadf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbaffbceeadf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/EySEKaimdKo", "anchor_text": "Unsplash"}, {"url": "https://github.com/hotgluexyz/recipes", "anchor_text": "here"}, {"url": "https://pandas.pydata.org/", "anchor_text": "site"}, {"url": "https://pypi.org/project/pandas/", "anchor_text": "PyPi"}, {"url": "https://hotglue.xyz", "anchor_text": "hotglue"}, {"url": "https://pypi.org/project/gluestick/", "anchor_text": "PyPi"}, {"url": "https://github.com/hotgluexyz/gluestick", "anchor_text": "GitHub"}, {"url": "https://hotglue.xyz/", "anchor_text": "hotglue"}, {"url": "https://github.com/hotgluexyz/recipes/blob/master/src/basic.ipynb", "anchor_text": "hotgluexyz/recipesSimple samples for writing ETL transform scripts in Pythongithub.com"}, {"url": "https://pypi.org/project/gluestick/", "anchor_text": "gluestick"}, {"url": "https://pypi.org/project/gluestick/", "anchor_text": "gluestick"}, {"url": "https://pypi.org/project/gluestick/", "anchor_text": "gluestick"}, {"url": "https://github.com/hotgluexyz/recipes", "anchor_text": "hotglue recipes"}, {"url": "https://medium.com/tag/data-integration?source=post_page-----baffbceeadf4---------------data_integration-----------------", "anchor_text": "Data Integration"}, {"url": "https://medium.com/tag/python?source=post_page-----baffbceeadf4---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/etl?source=post_page-----baffbceeadf4---------------etl-----------------", "anchor_text": "Etl"}, {"url": "https://medium.com/tag/b2b?source=post_page-----baffbceeadf4---------------b2b-----------------", "anchor_text": "B2B"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbaffbceeadf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&user=hotglue&userId=12b73f121333&source=-----baffbceeadf4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbaffbceeadf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&user=hotglue&userId=12b73f121333&source=-----baffbceeadf4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbaffbceeadf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbaffbceeadf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----baffbceeadf4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----baffbceeadf4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----baffbceeadf4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----baffbceeadf4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----baffbceeadf4--------------------------------", "anchor_text": ""}, {"url": "https://hotglue.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hotglue.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "hotglue"}, {"url": "https://hotglue.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "244 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F12b73f121333&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&user=hotglue&userId=12b73f121333&source=post_page-12b73f121333--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F90c8a715f77e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-etl-operations-in-python-baffbceeadf4&newsletterV3=12b73f121333&newsletterV3Id=90c8a715f77e&user=hotglue&userId=12b73f121333&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}