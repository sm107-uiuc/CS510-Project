{"url": "https://towardsdatascience.com/monte-carlo-methods-made-simple-91758ba58dde", "time": 1683014094.450517, "path": "towardsdatascience.com/monte-carlo-methods-made-simple-91758ba58dde/", "webpage": {"metadata": {"title": "Monte Carlo Methods, Made Simple. Using Chaos to Find Clarity | by Andre Ye | Towards Data Science", "h1": "Monte Carlo Methods, Made Simple", "description": "Imagine a 10 by 10 square on a coordinate grid. Some shape is drawn on that grid, but you don\u2019t know what it looks like. However, you can query a function f(x, y) where (x, y) is the coordinate and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/finding-the-formula-for-circle-area-without-using-any-math-898cbee70253", "anchor_text": "Finding the Formula for Circle Area Without Using Any Math", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm", "anchor_text": "Metropolis-Hastings algorithm", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Gibbs_sampling", "anchor_text": "Gibbs sampling", "paragraph_index": 17}, {"url": "https://levelup.gitconnected.com/how-deepminds-alphago-became-the-world-s-top-go-player-5b275e553d6a", "anchor_text": "AlphaGo", "paragraph_index": 26}, {"url": "https://digitalcommons.morris.umn.edu/cgi/viewcontent.cgi?article=1028&context=horizons", "anchor_text": "applications elsewhere", "paragraph_index": 26}, {"url": "https://medium.com/@andre_ye/the-fascinating-no-gradient-approach-to-neural-net-optimization-abb287f88c97", "anchor_text": "non-gradient function optimization", "paragraph_index": 27}, {"url": "https://andre-ye.medium.com/subscribe", "anchor_text": "subscribing", "paragraph_index": 36}, {"url": "https://andre-ye.medium.com/membership", "anchor_text": "referral link", "paragraph_index": 36}, {"url": "https://andre-ye.medium.com/membership", "anchor_text": "https://andre-ye.medium.com/membership", "paragraph_index": 38}], "all_paragraphs": ["Imagine a 10 by 10 square on a coordinate grid. Some shape is drawn on that grid, but you don\u2019t know what it looks like. However, you can query a function f(x, y) where (x, y) is the coordinate and the output is either 1 (in the shape) or 0 (not in the shape). How would you find the area of the shape?", "The answer is quite simple. It comes from one principle of statistics, the Law of Large Numbers, which states that the more times a function is randomly sampled, the more accurate its approximation is. Then, our solution is simply to randomly choose points in the 10\u00d710 grid, count how many land in the shape, and divide that by the total number of sampled points.", "While this instinctive idea on random sampling is simple, it has applications in many fields, from law to climate forecasting, and perhaps most relevant to this article, machine learning and statistics. It goes by a formal name: the Monte Carlo methods.", "When presented with a problem consisting of deterministic principles \u2014 like the area of a shape, the distribution of a function, or which move a player should choose next in a game \u2014 Monte Carlo methods fundamentally assume that it can be modelled through probability and stochasticity (randomness).", "Monte Carlo methods rely on repeated random sampling from a distribution to obtain a numerical result. It is an approach rather than an algorithm.", "For another shape-based example, check out Finding the Formula for Circle Area Without Using Any Math (with Monte Carlo sampling and polynomial regression). Random sampling can be used as a cheap way to find the integral (area under curve) of a function. Famously, the value of pi, the important circle constant, can also be approximated through Monte Carlo sampling:", "Generally, there are three classes/applications of Monte Carlo sampling:", "Monte Carlo sampling is usually seen used in two contexts:", "Because the ideas behind Monte Carlo methods are simple but can be used in fairly complex and creative ways, it\u2019s best to explore the mindset through several examples.", "For one, consider Markov Chain Monte Carlo (MCMC) methods, which attempts to generate random samples from a target distribution without knowing what the distribution is. Markov Chains \u2014 a graph where each node is a state that has some probability p of moving to another state \u2014 are used to represent these distributions.", "Consider this weather Markov Chain in a city (with horrible weather) where the only possible weather states are wind, hail/snow, thunderstorms, or rain. Each day, the next day\u2019s weather can be forecasted based on a probability extending from the current day\u2019s weather. For instance, if it is snowing today, there is an 80 percent chance it will be windy and a 20 percent chance it will be rainy tomorrow.", "To wander around a Markov Chain, we begin at one location s and move to another, s\u2019, with the designated probability. Then, s\u2019 becomes the new s and the process repeats. Although this example features a small Markov Chain, huge graphs with thousands of nodes and hundreds of thousands of connections can be used to model intricated probabilistic relationships.", "If we run through the Markov Chain after a substantial amount of time (e.g. 10,000 simulated days), we begin to reach a \u2018probability equilibrium\u2019. This simply means that we can estimate a static probability that it will rain simply based on how many of our travelled states were Raining (predicated on the Law of Large Numbers).", "For example, if we receive the following (hypothetical) results from running through the Markov Chain over 10,000 states:", "We would be able to generate the following probabilities:", "Then, one can simply sample from the distribution accordingly \u2014 randomly draw a state from the Markov Chain without needing to traverse it. Through repeated iteration and random traversal (the \u2018Monte Carlo\u2019 part of the process) of the Markov Chain, the system was able to be collapsed and represented as a probability distribution.", "Markov Chains can be constructed to model complex relationships that cannot be directly sampled, then simplified to find their underlying probability distributions.", "There are plenty of well-established MCMC algorithms, like the Metropolis-Hastings algorithm or Gibbs sampling. All seek to do something similar to what was described \u2014 to model the underlying probabilities of the system.", "To take a step out of theory and one into application, look at the Monte Carlo Tree Search (MCTS), a key part of intelligent game-playing reinforcement learning systems. Early game-playing systems, like IBM DeepBlue\u2019s initial victory over chess champion Gary Kasparov in 1997, were based on minimax-like algorithms that played out all possible games from the current move and determined the one that offered definite victory (or the highest chance).", "As tested games became more complex \u2014 most famously, the game of Go or even advanced graphics shooter games like DOTA \u2014 it\u2019s computationally infeasible, and foolish, to play out all possible scenarios. Instead, it\u2019s wiser for a player to explore potentially beneficial moves while abandoning moves that have a high probability of failing and exploit known moves.", "Say we begin constructing a tree as such, where each node represents some game state. We can transition between nodes by taking certain actions. From the initial starting state of the game, we can take several possible nodes.", "Value neural networks attempt to place a value on each move: given this move, what is the probability that the agent will win? Note that in the beginning, since the value network has not been trained, it will give random guesses. As the system plays enough games, however, it will become better at intelligently analyzing the effects of certain moves.", "Instead of simply choosing whichever node has the highest probability, we perform a \u2018weighted Monte Carlo sampling\u2019. If the network thinks that node 2 will result in a 90% chance of winning, then it has a greater chance of being chosen, but it is also possible that nodes 3 and 1 are chosen. The policy \u2014 or how potential nodes are chosen \u2014 is also learned.", "The logic behind this is that the foreseeable value of a certain move is limited and bounded by chance (perhaps the opponent will make an unexpected move). Additionally, exploiting only known moves instead of taking risks to explore other areas and potentially find more profitable moves would result in a noncompetitive and lazy model, something undesirable in complex reinforcement learning environments.", "Then, the selected node is further expanded and the process repeats until the game terminates. Incorporating probability into decision-making instead of deterministically choosing a \u2018best\u2019 value helps reinforcement learning balance an exploitation/exploration trade-off.", "If we look at this from a statistical perspective, the Monte Carlo sampling is used to model the optimal probability distribution p(v) to select a node given that it have some foreseeable value v.", "Monte Carlo Tree Search was the framework in which AlphaGo, DeepMind\u2019s reinforcement learning system that beat (and continues to beat) top Go players. MCTS has a wide variety of applications elsewhere.", "Simulated annealing is another application of Monte Carlo sampling, used as an effective method of non-gradient function optimization in the task of finding a global optima. Like other problems Monte Carlo methods are applied on, the search space is discrete (e.g. we\u2019re not trying to optimize continuous values, like the parameters of a neural network).", "In problems where finding an approximate global optima in a fixed amount of time is more valuable than its precise values, simulated annealing may actually be preferable to algorithms like gradient descent.", "The idea of simulated annealing comes from metallurgy, or the manipulation of metals. In metallurgy, annealing is the controlled heating or cooling of a material to increase its size and eliminate defects. Similarly, simulated annealing controls the amount of energy in the system, which determines how much risk it is willing to take in exploring new possibilities.", "The temperature begins at some initial amount, which represents a timer of sorts. At each state s, simulated annealing moves to some neighboring state s\u2019 depending on the value of both states (is moving to s\u2019 a gain or a loss?), as well as the current temperature T, with probability P(s, s\u2019, T).", "As the temperature decreases (time left decreases) with each timestep, the model becomes less explorative and more exploitative. Simulated annealing allows for a progressive transition from exploration to exploitation with respect to the time that is very beneficial in finding global optima.", "Monte Carlo sampling and Bayesian methods are used to model the probability function P(s, s\u2019, T). In fact, often the Metropolis-Hastings algorithm, as you may recall is a Markov Chain Monte Carlo method, (or methods modelled after it) are used to find transition thresholds (the probability in which one should transition).", "This is natural because simulated annealing treats solutions as states and is attempting to find the optimal transition probabilities \u2014 a landscape perfect for Markov Chain modelling.", "Often, Monte Carlo methods \u2014 or Monte Carlo-like thinking \u2014 will appear in places we least expect it. While it is a simple mechanism, it has deep and complex roots in countless applications.", "Thanks for reading, and let me know your thoughts in the responses!", "If you\u2019re interested in staying updated on new articles, consider subscribing. If you\u2019d like to support my writing, joining Medium via my referral link is a great way. Cheers!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML enthusiast. Join Medium through my referral link: https://andre-ye.medium.com/membership."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F91758ba58dde&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----91758ba58dde--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----91758ba58dde--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andre-ye.medium.com/?source=post_page-----91758ba58dde--------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=post_page-----91758ba58dde--------------------------------", "anchor_text": "Andre Ye"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe743a65b006&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&user=Andre+Ye&userId=be743a65b006&source=post_page-be743a65b006----91758ba58dde---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91758ba58dde&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91758ba58dde&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/mBHuEkka5wM", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/finding-the-formula-for-circle-area-without-using-any-math-898cbee70253", "anchor_text": "Finding the Formula for Circle Area Without Using Any Math"}, {"url": "https://en.wikipedia.org/wiki/File:Pi_30K.gif", "anchor_text": "WikiMedia"}, {"url": "https://towardsdatascience.com/the-beauty-of-bayesian-optimization-explained-in-simple-terms-81f3ee13b10f", "anchor_text": "Bayesian optimization"}, {"url": "https://medium.com/analytics-vidhya/the-fascinating-no-gradient-approach-to-neural-net-optimization-abb287f88c97", "anchor_text": "surrogate optimization"}, {"url": "https://pixabay.com/vectors/weather-icon-forecast-symbol-sign-3440568/", "anchor_text": "Pixabay"}, {"url": "https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm", "anchor_text": "Metropolis-Hastings algorithm"}, {"url": "https://en.wikipedia.org/wiki/Gibbs_sampling", "anchor_text": "Gibbs sampling"}, {"url": "https://levelup.gitconnected.com/how-deepminds-alphago-became-the-world-s-top-go-player-5b275e553d6a", "anchor_text": "AlphaGo"}, {"url": "https://digitalcommons.morris.umn.edu/cgi/viewcontent.cgi?article=1028&context=horizons", "anchor_text": "applications elsewhere"}, {"url": "https://medium.com/@andre_ye/the-fascinating-no-gradient-approach-to-neural-net-optimization-abb287f88c97", "anchor_text": "non-gradient function optimization"}, {"url": "https://en.wikipedia.org/wiki/File:Hill_Climbing_with_Simulated_Annealing.gif", "anchor_text": "WikiMedia"}, {"url": "https://andre-ye.medium.com/subscribe", "anchor_text": "subscribing"}, {"url": "https://andre-ye.medium.com/membership", "anchor_text": "referral link"}, {"url": "https://towardsdatascience.com/the-beauty-of-bayesian-optimization-explained-in-simple-terms-81f3ee13b10f", "anchor_text": "The Beauty of Bayesian Optimization, Explained in Simple TermsThe intuition behind an ingenious algorithmtowardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----91758ba58dde---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----91758ba58dde---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/statistics?source=post_page-----91758ba58dde---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----91758ba58dde---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----91758ba58dde---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F91758ba58dde&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&user=Andre+Ye&userId=be743a65b006&source=-----91758ba58dde---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F91758ba58dde&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&user=Andre+Ye&userId=be743a65b006&source=-----91758ba58dde---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91758ba58dde&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----91758ba58dde--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F91758ba58dde&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----91758ba58dde---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----91758ba58dde--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----91758ba58dde--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----91758ba58dde--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----91758ba58dde--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----91758ba58dde--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----91758ba58dde--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----91758ba58dde--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----91758ba58dde--------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andre-ye.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andre Ye"}, {"url": "https://andre-ye.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.8K Followers"}, {"url": "https://andre-ye.medium.com/membership", "anchor_text": "https://andre-ye.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbe743a65b006&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&user=Andre+Ye&userId=be743a65b006&source=post_page-be743a65b006--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff44a966e4ff1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-methods-made-simple-91758ba58dde&newsletterV3=be743a65b006&newsletterV3Id=f44a966e4ff1&user=Andre+Ye&userId=be743a65b006&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}