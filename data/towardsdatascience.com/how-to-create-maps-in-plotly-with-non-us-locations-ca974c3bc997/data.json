{"url": "https://towardsdatascience.com/how-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997", "time": 1683011736.865141, "path": "towardsdatascience.com/how-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997/", "webpage": {"metadata": {"title": "How to create maps in Plotly with non-US locations | by Kerry Halupka | Towards Data Science", "h1": "How to create maps in Plotly with non-US locations", "description": "Plotly makes it really easy to display geospatial data in an interactive choropleth map, particularly if your data pertains to the US. Unfortunately, if the location of your data is outside of the\u2026"}, "outgoing_paragraph_urls": [{"url": "http://stat.data.abs.gov.au/", "anchor_text": "Stat portal", "paragraph_index": 1}, {"url": "https://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/1270.0.55.003June%202020?OpenDocument", "anchor_text": "this link", "paragraph_index": 4}, {"url": "http://www.diva-gis.org/gdata", "anchor_text": "http://www.diva-gis.org/gdata", "paragraph_index": 6}, {"url": "https://account.mapbox.com/access-tokens/", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://github.com/KerryHalupka/plotly_choropleth", "anchor_text": "click here", "paragraph_index": 15}], "all_paragraphs": ["Plotly makes it really easy to display geospatial data in an interactive choropleth map, particularly if your data pertains to the US. Unfortunately, if the location of your data is outside of the US, and more granular than country-level, things get a bit murky. You might feel like the poor cousin when sifting through the depths of Stack Overflow and GitHub Issues to find clues to achieving your mapping goals. I\u2019m here to say I\u2019ve been there, I feel your pain, and there is a solution. Let\u2019s jump in!", "For this tutorial, I\u2019m going to display unemployment data from Victoria, Australia. I got my data from the Australian Bureau of Statistics Stat portal. This portal allows you to select the geospatial granularity of your data. I selected to download \u201cCensus 2016, G43 Labour force status by age by sex (LGA)\u201d, where LGA refers to Local Government Area, which is the spatial granularity of the data. Let\u2019s load it in and reshape it a bit:", "The column \u201cLGA_2016\u201d is referring to the ID or code for each Local Government Area (LGA). By pivoting the data we\u2019ve created one row, and therefore one unemployment rate, for each LGA. This is important since when we create our map we will need one value for each geospatial area we show.", "The key to creating a Plotly choropleth with data outside of the US is to have a GeoJSON with geometries corresponding to your data. While sometimes you may already have a GeoJSON, it\u2019s more likely you\u2019ll have to create one, which is the case for me.", "I\u2019m using The Australian Bureau of Statistics again to access geometries of my data in ESRI Shapefile format, via this link (I downloaded \u201cLocal Government Areas ASGS Ed 2020 Digital Boundaries in ESRI Shapefile Format\u201d). This format can be loaded in to Python using Geopandas, by pointing it at the \u2018.shp\u2019 file:", "Now we can see that both the data frames have a column containing a code for each LGA, which is what we will be joining on. Each row also has a \u201cgeometry\u201d value, which is the geospatial outline of the LGA.", "Side note: For plotting of Australian data the ABS will be your best bet for acquiring a shape file. I\u2019m not as well versed in data for other countries (please leave a comment if you know of websites providing geo data from your country), but if you\u2019re stuck http://www.diva-gis.org/gdata contains shape files, free to download, for most countries.", "If both of your data frames have matching keys like mine, then it\u2019s a simple matter to join them on that column, and drop rows with no data in the required columns.", "I also like to display my data frame at this point using Geopandas as a sanity check, and to know what my plotly map should end up looking like.", "NOTE: Merging the data frames isn\u2019t strictly necessary for choropleths in Plotly, but it does serve to align the geometries with the data to be plotted. If you don\u2019t do this merging step you will need to make sure that the data frame containing your data and the shapefile/geoJSON containing the geometries have corresponding and identically sorted rows.", "So now we\u2019ve got a Geo Dataframe with all of the info in it that we need to map it using Plotly. Except for one little detail: Plotly wants it in GeoJSON format. Luckily, Geopandas can easily convert from data frame to GeoJSON, as below. First though, you will want to make sure your geometries are in lat/long format (EPSG:4236), which is what Plotly is expecting.", "Your GeoJSON should look something like this:", "You can see that this dictionary contains a nested dictionary called \u2018features\u2019, in which the index of each of your data frames rows is stored as \u2018id\u2019. If you didn\u2019t create your geoJSON using this method then make sure yours has a similar format.", "There\u2019s a couple of things of note in the code below. First up, you need a Mapbox access token. You can get this by creating a Mapbox account here. For personal use levels, accessing the API will be free. Secondly, we assign the data for the map, using the geoJSON for the geometries, and the merged data frame for the colors and text.Finally, we set some parameters to define the layout of the map, including the title, centre lat/long, and zoom level.", "This will make a beautiful, interactive map, showing the unemployment rate in Victoria. Nice!", "You can customise this tutorial using your own data and shapefiles. To see the code on GitHub click here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m a Machine Learning Engineer at Canva. Writing to fight my imposter syndrome and share my love of all things ML."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fca974c3bc997&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kerry.halupka?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kerry.halupka?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": "Kerry Halupka"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32cfb3418f0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&user=Kerry+Halupka&userId=32cfb3418f0e&source=post_page-32cfb3418f0e----ca974c3bc997---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca974c3bc997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca974c3bc997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@anniespratt?utm_source=medium&utm_medium=referral", "anchor_text": "Annie Spratt"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://stat.data.abs.gov.au/", "anchor_text": "Stat portal"}, {"url": "https://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/1270.0.55.003June%202020?OpenDocument", "anchor_text": "this link"}, {"url": "http://www.diva-gis.org/gdata", "anchor_text": "http://www.diva-gis.org/gdata"}, {"url": "https://account.mapbox.com/access-tokens/", "anchor_text": "here"}, {"url": "https://github.com/KerryHalupka/plotly_choropleth", "anchor_text": "click here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ca974c3bc997---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----ca974c3bc997---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/programming?source=post_page-----ca974c3bc997---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----ca974c3bc997---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data?source=post_page-----ca974c3bc997---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fca974c3bc997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&user=Kerry+Halupka&userId=32cfb3418f0e&source=-----ca974c3bc997---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fca974c3bc997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&user=Kerry+Halupka&userId=32cfb3418f0e&source=-----ca974c3bc997---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca974c3bc997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fca974c3bc997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ca974c3bc997---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ca974c3bc997--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ca974c3bc997--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ca974c3bc997--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ca974c3bc997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kerry.halupka?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kerry.halupka?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kerry Halupka"}, {"url": "https://medium.com/@kerry.halupka/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "62 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32cfb3418f0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&user=Kerry+Halupka&userId=32cfb3418f0e&source=post_page-32cfb3418f0e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F937c94f9bcde&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-maps-in-plotly-with-non-us-locations-ca974c3bc997&newsletterV3=32cfb3418f0e&newsletterV3Id=937c94f9bcde&user=Kerry+Halupka&userId=32cfb3418f0e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}