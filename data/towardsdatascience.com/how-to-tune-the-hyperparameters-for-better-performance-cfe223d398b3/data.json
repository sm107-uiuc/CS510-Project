{"url": "https://towardsdatascience.com/how-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3", "time": 1683017577.507954, "path": "towardsdatascience.com/how-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3/", "webpage": {"metadata": {"title": "How to Tune the Hyperparameters for Better Performance | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "How to Tune the Hyperparameters for Better Performance", "description": "There are various ready-to-use machine learning algorithms. They all have their pros and cons. For a given task, it is the job of the machine learning engineer or data scientist to select the optimal\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/understanding-the-lightgbm-772ca08aabfa", "anchor_text": "this post", "paragraph_index": 13}, {"url": "https://lightgbm.readthedocs.io/en/latest/Parameters.html", "anchor_text": "list", "paragraph_index": 38}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 42}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 42}], "all_paragraphs": ["There are various ready-to-use machine learning algorithms. They all have their pros and cons. For a given task, it is the job of the machine learning engineer or data scientist to select the optimal algorithm and make the most out of it.", "A critical part of making the most out of a model is hyperparameter tuning. The performance of a model is greatly influenced by the selected hyperparameter values.", "In this post, we will focus on how to tune hyperparameters to obtain a more robust and generalized mode.", "In some sense, we design our own implementation of an algorithm by finding the optimal hyperparameter values for a given task and dataset.", "As the model complexity increases, the number of hyperparameters also increase. Tree based ensemble learners such as xgboost and lightgbm have lots of hyperparameters.", "The hyperparameters need to be tuned very well in order to get accurate, and robust results. Our focus should not be getting the best accuracy or lowest lost. The ultimate goal is to have a robust, accurate, and not-overfit model.", "The tuning process cannot be just trying random combinations of hyperparameters. We need to understand what they mean and how they change the model.", "The outline of the post is as follows:", "The make_classification function of scikit-learn allows creating customized classification datasets. You can customize the dataset by choosing the number of samples, informative and redundant features. It is also possible to adjust the difficulty of classification task by using the class_sep and flip_y parameters.", "The dataset contains 50000 samples and 20 features.", "The next step is to split the dataset into train and test subsets.", "It is very important the evaluate the performance of a model on the samples it has not trained on. This is the most accurate way of detecting overfitting.", "We have the train and test sets now. The next step is to create, train, and evaluate a classifier.", "LightGBM is an implementation of gradient boosted decision trees. It is super fast and efficient. If you\u2019d like to learn more about LightGBM, please read this post that I have written how LightGBM works and what makes it super fast.", "I will be using the scikit-learn API of LightGBM. Let\u2019s first import it and create the initial model.", "We have a classifier whose hyperparameters are described in the params dictionary. We will not change the first four parameters. Although different boosting types are available, we stick with the gradient boosted decision trees (gbdt). The objective and num_class parameters defined by the task so they cannot be changed. We have options for the metric but log loss is a commonly used one for classification tasks.", "These are the basic parameters. We will adjust these after the initial evaluation and also introduce new parameters that will help us reduce overfitting.", "Let\u2019s first train the model and evalute its performance.", "The fit method will train the model with the train set and evaluate the performance on both train and test according to the given metric.", "The early stopping parameter is used to control the training process. If there is no improvement on the loss in ten consecutive rounds, the model will stop training.", "Here are the results of the last 2 iterations.", "The log loss is 0.019 on train set and 0.196 on test set which is definitely not acceptable. There is a significant overfitting issue that needs to be solved. Please note that the loss on the test set is not realistic and it will increase as the degree of overfitting reduces.", "We will add new hyperparameters as well as adjusting the existing ones in order to reduce overfitting.", "The first one is the min_data_in_leaf parameter.", "It puts a constraint on splitting the nodes in a tree so the model will not capture the details or noise in the train set.", "Here is the result after setting the min_data_in_leaf parameter as 100.", "The loss on the test set increased but the difference between train and test loss decreased. The loss or accuracy of test set is not reliable when there is a huge difference between train and test set.", "The next hyperparameters that can be used to reduce overfitting are colsample_bytree and subsample.", "We can also use regularization to reduce overfitting. LightGBM supports both L1 and L2 regularization.", "Adding L1 regularization has further decreased overfitting.", "The max_bin parameter helps preventing a model from overfitting as well.", "Small number of bins may reduce training accuracy but may increase the generalization performance of a model.", "Finally, we can adjust the max_depth and num_leaves parameter to reduce overfitting.", "The current parameter dictionary is as below:", "The performance of the model with these parameters:", "We have reduced the overfitting by a significant amount but there is still room for improvement. Getting more data will definitely help in making the model more generalized so overfitting will be reduced. We can also keep trying different values of these hyperparameters or use other available ones.", "I do not claim that these values are the optimal value for these hyperparameters. In fact, you might well get a better result by trying different combinations.", "I wanted to show how these hyperparameters adjust a model and therefore its performance. Instead of trying random combinations, it is always better to have an idea who a particular hyperparameter can be used for.", "LightGBM or other complex models such as xgboost have many more hyperparameters than the ones we have discussed. Here is the entire hyperparamer list of the LightGBM.", "There are also tools and packages that help optimize hyperparameter tuning such as optuna. The GridSearchCV and RandomizedSearchCV functions of scikit-learn also help in finding the optimal hyperparameter values.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcfe223d398b3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----cfe223d398b3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcfe223d398b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcfe223d398b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@adigold1?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Adi Goldstein"}, {"url": "https://unsplash.com/s/photos/control-board?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/understanding-the-lightgbm-772ca08aabfa", "anchor_text": "this post"}, {"url": "https://lightgbm.readthedocs.io/en/latest/Parameters.html", "anchor_text": "list"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cfe223d398b3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artficial-intelligence?source=post_page-----cfe223d398b3---------------artficial_intelligence-----------------", "anchor_text": "Artficial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cfe223d398b3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----cfe223d398b3---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----cfe223d398b3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcfe223d398b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----cfe223d398b3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcfe223d398b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----cfe223d398b3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcfe223d398b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcfe223d398b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cfe223d398b3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cfe223d398b3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cfe223d398b3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cfe223d398b3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cfe223d398b3--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-tune-the-hyperparameters-for-better-performance-cfe223d398b3&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}