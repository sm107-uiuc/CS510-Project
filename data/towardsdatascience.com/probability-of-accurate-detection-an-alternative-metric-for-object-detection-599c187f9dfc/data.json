{"url": "https://towardsdatascience.com/probability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc", "time": 1683017916.0096672, "path": "towardsdatascience.com/probability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc/", "webpage": {"metadata": {"title": "Probability of accurate detection \u2014 An alternative metric for object detection | by Rafael Iriya | Towards Data Science", "h1": "Probability of accurate detection \u2014 An alternative metric for object detection", "description": "Object detection neural networks are usually evaluated over the COCO dataset, using metrics such as mean average precision (mAP) and mean average recall (mAR). However such metrics might have limited\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cocodataset.org/#home", "anchor_text": "COCO dataset", "paragraph_index": 0}, {"url": "https://rafael-iriya.medium.com/speeding-up-inference-using-parallel-model-runs-d76dcf393567", "anchor_text": "speeding up inference with parallel model runs", "paragraph_index": 19}], "all_paragraphs": ["Object detection neural networks are usually evaluated over the COCO dataset, using metrics such as mean average precision (mAP) and mean average recall (mAR). However such metrics might have limited meaning when deploying practical real-world applications. For example, consider a system composed of a camera feed and a robot that tags objects of interest. Let\u2019s say your company makes money based on the number of objects tagged by the robot. To make it a little harder, let\u2019s say there are several types of objects (several classes) and you are only interested in objects of a few specific classes. A solid model would ideally have high recall and high precision, i.e. , does not miss many objects and does not incorrectly tag many objects, respectively. Two questions arise when using metrics such as mAP and mAR:", "A first choice for a metric that combines both recall and precision is the f1 score. The f1 score is defined as the harmonic mean between recall and precision. Harmonic mean? @#$ does that mean? Precisely\u2026 It is hard to understand the physical meaning of a metric such as f1 score, making it not such an obvious choice.", "In light of these questions, let\u2019s think of our original problem. What we really want to know is: given a certain number of targets, how many of those or what proportion are correctly identified? A number like 80\u201390% could be considered a good one. At this point, one might think this is just the recall metric. However, recall does not take false positives into account, so a model that tags everything it sees would have a recall of 100%, but is definitely a terrible model. In order to have a metric that\u2019s truly meaningful for the original problem, I have derived a metric called probability of accurate detection, which we will discuss throughout the rest of this article.", "In order to obtain the metric we are looking for, let\u2019s think of this probabilistically. I call this metric probability of accurate detection, because it is exactly what it is: the probability of detecting the object (do not miss it), and at the same time, detecting it correctly (with the correct class). We could express this as:", ", where D stands for a detection event, and A stands for accurate.", "Ok, we already did half of the work by dividing this probability into two terms, P(D) and P(A|D). Now let\u2019s figure out how to calculate them.", "To calculate the desired probabilities we need to know a few quantities, which can be experimentally determined by evaluating the model on a test dataset, using different thresholds. Each threshold will generate different numbers and they can be calculated separately for each class.", "GT \u2014 Number of target ground truth objects", "TP \u2014 True positives or number of correctly identified objects", "FN \u2014 False negatives or number of objects missed by the model", "FP \u2014False positives or number of incorrectly identified objects (Background classified as a certain class)", "LM _GT \u2014 Label mismatches with respect to the ground truth.", "LM_D \u2014 Label mismatches with respect to the detection.", "To clarify the difference between LM_GT and LM_D, suppose there are two classes, class 1 and class 2. If an object with a ground truth of class 1 is classified as class 2, it will count as one LM_GT for class 1 and one LM_D for class_2.", "P(D) is the probability of not missing the object. Given the definitions provided in the last section, it can be calculated as:", "This term is almost the same as the recall, with the addition of LM_GT in the numerator.", "Probability of accurate given detection \u2014 P(A|D)", "If you think carefully, this term is the definition of precision. Therefore:", "Full expression for probability of accurate detection", "We are almost there, the derived expression works if we are analyzing single frames. However, if we are considering a video feed, the network might have N chances to detect the object. N can be calculated considering the inference time of the network and how long the object stays under the camera field of view. This is where it\u2019s important to analyze the trade offs between more accurate vs faster models. Also check my post on speeding up inference with parallel model runs.", "The final metric PADmf (I included mf to indicate multiple frames) can be calculated by considering that the object will be either detected on the first frame, or missed on the first frame then detected on the second, or missed on the second then detected on the third and so on\u2026", "There you go. For each class, all we need to do is select the threshold that maximizes PADmf and compare models based on this metric.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD, computer vision engineer and research scientist"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F599c187f9dfc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rafael-iriya.medium.com/?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": ""}, {"url": "https://rafael-iriya.medium.com/?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": "Rafael Iriya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbdc1f6035181&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&user=Rafael+Iriya&userId=bdc1f6035181&source=post_page-bdc1f6035181----599c187f9dfc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F599c187f9dfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F599c187f9dfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cocodataset.org/#home", "anchor_text": "COCO dataset"}, {"url": "https://rafael-iriya.medium.com/speeding-up-inference-using-parallel-model-runs-d76dcf393567", "anchor_text": "speeding up inference with parallel model runs"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----599c187f9dfc---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/metrics?source=post_page-----599c187f9dfc---------------metrics-----------------", "anchor_text": "Metrics"}, {"url": "https://medium.com/tag/recall?source=post_page-----599c187f9dfc---------------recall-----------------", "anchor_text": "Recall"}, {"url": "https://medium.com/tag/precision?source=post_page-----599c187f9dfc---------------precision-----------------", "anchor_text": "Precision"}, {"url": "https://medium.com/tag/f1-score?source=post_page-----599c187f9dfc---------------f1_score-----------------", "anchor_text": "F1 Score"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F599c187f9dfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&user=Rafael+Iriya&userId=bdc1f6035181&source=-----599c187f9dfc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F599c187f9dfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&user=Rafael+Iriya&userId=bdc1f6035181&source=-----599c187f9dfc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F599c187f9dfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F599c187f9dfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----599c187f9dfc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----599c187f9dfc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----599c187f9dfc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----599c187f9dfc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----599c187f9dfc--------------------------------", "anchor_text": ""}, {"url": "https://rafael-iriya.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rafael-iriya.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rafael Iriya"}, {"url": "https://rafael-iriya.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbdc1f6035181&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&user=Rafael+Iriya&userId=bdc1f6035181&source=post_page-bdc1f6035181--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6ee4949ed4cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobability-of-accurate-detection-an-alternative-metric-for-object-detection-599c187f9dfc&newsletterV3=bdc1f6035181&newsletterV3Id=6ee4949ed4cf&user=Rafael+Iriya&userId=bdc1f6035181&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}