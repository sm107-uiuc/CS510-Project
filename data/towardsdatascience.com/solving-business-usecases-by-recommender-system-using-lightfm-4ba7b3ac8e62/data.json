{"url": "https://towardsdatascience.com/solving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62", "time": 1682993440.0631208, "path": "towardsdatascience.com/solving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62/", "webpage": {"metadata": {"title": "Solving business usecases by recommender system using lightFM | by Aayush Agrawal | Towards Data Science", "h1": "Solving business usecases by recommender system using lightFM", "description": "In this post, I am going to write about Recommender systems, how they are used in many e-commerce websites. The post will also cover about building simple recommender system models using Matrix\u2026"}, "outgoing_paragraph_urls": [{"url": "https://aayushmnit.github.io/posts/2018/04/Business_usecases_by_recommender_system_using_lightFM/", "anchor_text": "post", "paragraph_index": 0}, {"url": "https://github.com/lyst/lightfm", "anchor_text": "lightFM", "paragraph_index": 0}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py", "anchor_text": "recommender system cookbook", "paragraph_index": 0}, {"url": "http://www.quuxlabs.com/blog/2010/09/matrix-factorization-a-simple-tutorial-and-implementation-in-python/", "anchor_text": "Matrix Factorization: A Simple Tutorial and Implementation in Python", "paragraph_index": 7}, {"url": "https://www.analyticsvidhya.com/blog/2018/01/factorization-machines/", "anchor_text": "Introductory Guide \u2014 Factorization Machines & their application on huge datasets (with codes in Python)", "paragraph_index": 7}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "MovieLens", "paragraph_index": 8}, {"url": "http://files.grouplens.org/datasets/movielens/ml-latest-small.zip", "anchor_text": "small size data", "paragraph_index": 8}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py", "anchor_text": "recommender system cookbook", "paragraph_index": 9}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/generic_preprocessing.py", "anchor_text": "preprocessing cookbook", "paragraph_index": 9}, {"url": "https://github.com/aayushmnit/cookbook", "anchor_text": "cookbook codes", "paragraph_index": 9}, {"url": "https://www.linkedin.com/in/aayushmnit/", "anchor_text": "LinkedIn", "paragraph_index": 28}, {"url": "http://aayushmnit.com", "anchor_text": "aayushmnit.com", "paragraph_index": 30}], "all_paragraphs": ["In this post, I am going to write about Recommender systems, how they are used in many e-commerce websites. The post will also cover about building simple recommender system models using Matrix Factorization algorithm using lightFM package and my recommender system cookbook. The post will focus on business use cases and simple implementations. The post only cover basic intuition around algorithms and will provide links to resources if you want to understand the math behind the algorithm.", "I am an avid reader and a believer in open source education and continuously expand my knowledge around data science & computer science using online courses, blogs, Github repositories and participating in data science competitions. While searching for quality content on the internet, I have come across various learning links which either focus on the implementation of the algorithm using specific data/modeling technique in ABC language or focus on business impact/results using the broad concept of a family of algorithms(like classification, forecasting, recommender systems etc.) but don\u2019t go into details of how to do it. So the idea is to write some blogs which can combine both business use cases with codes & algorithmic intuition to provide a holistic view of how data science is used in business scenarios.", "As the world is becoming more digital, we are already getting used to a lot of personalized experience and the algorithm which help us achieve this falls in the family of recommender systems. Almost every web-based platform is using some recommender system to provide customized content. Following are the companies I admire the most.", "Personalization is a technique of dynamically tailoring your content based on needs of each user. Simple examples of personalization could be movie recommendation on Netflix, personalized email targeting/re-targeting by e-commerce platforms, item recommendation on Amazon, etc. Personalization helps us achieve these four Rs -", "Personalization has a lot of benefits for both users and companies. For users, it makes their life easy as they only get to see more relevant stuff to them (unless it\u2019s an advertisement, even they are personalized). For business benefits are countless but here are few which I would like to mention -", "Matrix factorization is one of the algorithms from recommender systems family and as the name suggests it factorize a matrix, i.e., decompose a matrix in two(or more) matrices such that once you multiply them you get your original matrix back. In case of the recommendation system, we will typically start with an interaction/rating matrix between users and items and matrix factorization algorithm will decompose this matrix in user and item feature matrix which is also known as embeddings. Example of interaction matrix would be user-movie ratings for movie recommender, user-product purchase flag for transaction data, etc.", "Typically user/item embeddings capture latent features about attributes of users and item respectively. Essentially, latent features are the representation of user/item in an arbitrary space which represents how a user rate a movie. In the example of a movie recommender, an example of user embedding might represent affinity of a user to watch serious kind of movie when the value of the latent feature is high and comedy type of movie when the value is low. Similarly, a movie latent feature may have a high value when the movie is more male driven and when it\u2019s more female-driven the value is typically low.", "For more information on matrix factorization and factorization machines you can read these articles \u2014 Matrix Factorization: A Simple Tutorial and Implementation in Python Introductory Guide \u2014 Factorization Machines & their application on huge datasets (with codes in Python)", "In the hands-on section, we will be building recommender system for different scenarios which we typically see in many companies using LightFM package and MovieLens data. We are using small size data which contains 100,000 ratings and 1,300 tag applications applied to 9,000 movies by 700 users", "Let\u2019s start by importing data, recommender system cookbook and preprocessing cookbook files for this hands-on section. I have written these reusable generic cookbook codes to increase productivity and write clean/modular codes; you will see we can build a recommender system using 10\u201315 lines of code by using these cookbooks(do more with less!).", "As we can see rating data contain user id, movie id and a rating between 0.5 to 5 with a timestamp representing when the rating was given.", "Movie data consist of movie id, their title, and genre they belong.", "As I mentioned before, to create a recommender system we need to start by creating an interaction matrix. For this task, we will use the create_interaction_matrix function from the recsys cookbook. This function requires you to input a pandas dataframe and necessary information like column name for user id, item id, and rating. It also takes an additional parameter threshold if norm=True which means any rating above the mentioned threshold is considered a positive rating. In our case, we don\u2019t have to normalize our data, but in cases of retail data any purchase of a particular type of item can be considered a positive rating, quantity doesn\u2019t matter.", "As we can see the data is created in an interaction format where rows represent each user and columns represent each movie id with ratings as values. We will also create user and item dictionaries to later convert user_id to user_name or movie_id to movie_name by using create_user_dict and create_item dict function.", "To build a matrix factorization model, we will use the runMF function which will take following input -", "Now we have built our matrix factorization model we can now do some interesting things. There are various use cases which can be solved by using this model for a web platform let\u2019s look into them.", "In this use case, we want to show a user, items he might be interested in buying/viewing based on his/her interactions done in the past. Typical industry examples for this are like \u201cDeals recommended for you\u201d on Amazon or \u201cTop pics for a user\u201d on Netflix or personalized email campaigns.", "We can use the sample_recommendation_user function for this case. This functions take matrix factorization model, interaction matrix, user dictionary, item dictionary, user_id and the number of items as input and return the list of item id\u2019s a user may be interested in interacting.", "As we can see in this case user is interested in \u201cDark Knight Rises(2012)\u201d so the first recommendation is \u201cThe Dark Knight(2008)\u201d. This user also seems to have a strong liking towards movies in drama, sci-fi and thriller genre and there are many movies recommended in the same genre like Dark Knight(Drama/Crime), Inception(Sci-Fi, Thriller), Iron Man(Sci-FI thriller), Shutter Island(Drame/Thriller), Fight club(drama), Avatar(Sci-fi), Forrest Gump(Drama), District 9(Thriller), Wall-E(Sci-fi), The Matrix(Sci-Fi)", "Similar models can also be used for building sections like \u201cBased on your recent browsing history\u201d recommendations by just changing the rating matrix only to contain interaction which is recent and based on browsing history visits on specific items.", "In this use case, we will discuss how we can recommend a list of users specific to a particular item. Example of such cases is when you are running a promotion on an item and want to run an e-mail campaign around this promotional item to only 10,000 users who might be interested in this item.", "We can use the sample_recommendation_item function for this case. This functions take matrix factorization model, interaction matrix, user dictionary, item dictionary, item_id and the number of users as input and return the list of user id\u2019s who are more likely be interested in the item.", "As you can see function return a list of userID who might be interested in item id 1. Another example why you might need such model is when there is an old inventory sitting in your warehouse which needs to clear up otherwise you might have to write it off, and you want to clear it by giving some discount to users who might be interested in buying.", "In this use case, we will discuss how we can recommend a list of items specific to a particular item. This kind of models will help you to find similar/related items or items which can be bundled together. Typical industry use case for such models are in cross-selling and up-selling opportunities on product page like \u201cProducts related to this item\u201d, \u201cFrequently bought together\u201d, \u201cCustomers who bought this also bought this\u201d and \u201cCustomers who viewed this item also viewed\u201d. \u201cCustomers who bought this also bought this\u201d and \u201cCustomers who viewed this item also viewed\u201d can also be solved through market basket analysis.", "To achieve this use case, we will create a cosine distance matrix using item embeddings generated by matrix factorization model. This will help us calculate similarity b/w items, and then we can recommend top N similar item to an item of interest. First step is to create a item-item distance matrix using the create_item_emdedding_distance_matrix function. This function takes matrix factorization models and interaction matrix as input and returns an item_embedding_distance_matrix.", "As we can see the matrix have movies as both row and columns and the value represents the cosine distance between them. Next step is to use item_item_recommendation function to get top N items with respect to an item_id. This function takes item embedding distance matrix, item_id, item_dictionary and number of items to be recommended as input and return similar item list as output.", "As we can see for \u201cStar Wars: Episode II \u2014 Attack of the Clones (2002)\u201d movie we are getting it\u2019s next released movies which is \u201cStar Wars: Episode III \u2014 Revenge of the Sith (2005)\u201d as the first recommendation.", "Like any other blog, this method isn\u2019t perfect for every application, but the same ideas can work if we use it effectively. There is a lot of advancements in recommender systems with the advent of Deep learning. While there is room for improvement, I am pleased with how it has been working for me so far. I might write about deep learning based recommender systems later sometime.", "In the meantime, I hope you enjoyed reading, and feel free to use my code to try it out for your purposes. Also, if there is any feedback on code or just the blog post, feel free to reach out on LinkedIn or email me at aayushmnit@gmail.com.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Experienced data scientist. Passionate about solving interesting problems with data. All views are my own unless you share them. More on aayushmnit.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4ba7b3ac8e62&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aayushmnit?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aayushmnit?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": "Aayush Agrawal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85dd669ac015&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&user=Aayush+Agrawal&userId=85dd669ac015&source=post_page-85dd669ac015----4ba7b3ac8e62---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ba7b3ac8e62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ba7b3ac8e62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://aayushmnit.github.io/posts/2018/04/Business_usecases_by_recommender_system_using_lightFM/", "anchor_text": "post"}, {"url": "https://github.com/lyst/lightfm", "anchor_text": "lightFM"}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py", "anchor_text": "recommender system cookbook"}, {"url": "https://www.forbes.com/sites/shephyken/2017/10/29/personalized-customer-experience-increases-revenue-and-loyalty/#36e9f054bd61", "anchor_text": "Forbes article"}, {"url": "http://www.quuxlabs.com/blog/2010/09/matrix-factorization-a-simple-tutorial-and-implementation-in-python/", "anchor_text": "Matrix Factorization: A Simple Tutorial and Implementation in Python"}, {"url": "https://www.analyticsvidhya.com/blog/2018/01/factorization-machines/", "anchor_text": "Introductory Guide \u2014 Factorization Machines & their application on huge datasets (with codes in Python)"}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "MovieLens"}, {"url": "http://files.grouplens.org/datasets/movielens/ml-latest-small.zip", "anchor_text": "small size data"}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py", "anchor_text": "recommender system cookbook"}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/generic_preprocessing.py", "anchor_text": "preprocessing cookbook"}, {"url": "https://github.com/aayushmnit/cookbook", "anchor_text": "cookbook codes"}, {"url": "https://lyst.github.io/lightfm/docs/examples/warp_loss.html", "anchor_text": "warp loss"}, {"url": "https://www.linkedin.com/in/aayushmnit/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4ba7b3ac8e62---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/recommender-systems?source=post_page-----4ba7b3ac8e62---------------recommender_systems-----------------", "anchor_text": "Recommender Systems"}, {"url": "https://medium.com/tag/business?source=post_page-----4ba7b3ac8e62---------------business-----------------", "anchor_text": "Business"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4ba7b3ac8e62---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----4ba7b3ac8e62---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ba7b3ac8e62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&user=Aayush+Agrawal&userId=85dd669ac015&source=-----4ba7b3ac8e62---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ba7b3ac8e62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&user=Aayush+Agrawal&userId=85dd669ac015&source=-----4ba7b3ac8e62---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ba7b3ac8e62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4ba7b3ac8e62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4ba7b3ac8e62---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4ba7b3ac8e62--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aayushmnit?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aayushmnit?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aayush Agrawal"}, {"url": "https://medium.com/@aayushmnit/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "414 Followers"}, {"url": "http://aayushmnit.com", "anchor_text": "aayushmnit.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85dd669ac015&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&user=Aayush+Agrawal&userId=85dd669ac015&source=post_page-85dd669ac015--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8137fc02bcb8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-business-usecases-by-recommender-system-using-lightfm-4ba7b3ac8e62&newsletterV3=85dd669ac015&newsletterV3Id=8137fc02bcb8&user=Aayush+Agrawal&userId=85dd669ac015&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}