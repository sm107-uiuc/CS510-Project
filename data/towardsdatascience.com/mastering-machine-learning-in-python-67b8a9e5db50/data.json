{"url": "https://towardsdatascience.com/mastering-machine-learning-in-python-67b8a9e5db50", "time": 1683004456.4583411, "path": "towardsdatascience.com/mastering-machine-learning-in-python-67b8a9e5db50/", "webpage": {"metadata": {"title": "Mastering Machine Learning in Python | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Mastering Machine Learning in Python", "description": "Machine learning is the process of using features to predict an outcome measure. Machine learning plays an important role in many industries. A few examples include using machine learning for medical\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/sumitm004/forest-fire-area", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "Understanding Random Forest", "paragraph_index": 12}, {"url": "https://www.kaggle.com/puneet6060/intel-image-classification", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/", "anchor_text": "A beginner\u2019s Guide to Understanding Convolutional Neural Networks", "paragraph_index": 27}, {"url": "https://missinglink.ai/guides/convolutional-neural-networks/fully-connected-layers-convolutional-neural-networks-complete-guide/", "anchor_text": "Fully Connected Layers in Convolutional Neural Networks: The Complete Guide", "paragraph_index": 27}, {"url": "https://www.kaggle.com/vincee/intel-image-classification-cnn-keras", "anchor_text": "Intel Image Classification (CNN \u2014 Keras)", "paragraph_index": 28}, {"url": "https://www.kaggle.com/search?q=image+classification+in%3Adatasets", "anchor_text": "here", "paragraph_index": 37}, {"url": "https://www.packtpub.com/big-data-and-business-intelligence/machine-learning-r", "anchor_text": "Machine Learning with R", "paragraph_index": 39}, {"url": "https://www.kaggle.com/mirichoi0218/insurance", "anchor_text": "here", "paragraph_index": 39}, {"url": "https://www.kaggle.com/search?q=anomaly+detection+in%3Adatasets", "anchor_text": "here", "paragraph_index": 51}, {"url": "https://www.kaggle.com/simjeg/lymphoma-subtype-classification-fl-vs-cll", "anchor_text": "here", "paragraph_index": 52}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud/version/3", "anchor_text": "here", "paragraph_index": 52}, {"url": "https://github.com/spierre91/medium_code/blob/master/what_is_ml.py", "anchor_text": "GitHub", "paragraph_index": 52}], "all_paragraphs": ["Machine learning is the process of using features to predict an outcome measure. Machine learning plays an important role in many industries. A few examples include using machine learning for medical diagnoses, predicting stock prices, and ad promotion optimization.", "Machine learning employs methods of statistics, data mining, engineering, and many other disciplines. In machine learning, we use a training set of data, in which we observe past outcome and feature measurements, to build a model for prediction. We can subsequently use this model to predict outcome measurements of future events. This is method is called supervised machine learning. Here are a few more use cases of machine learning:", "Before we move forward let\u2019s briefly go over some terminology. Let\u2019s distinguish between supervised and unsupervised machine learning.", "Supervised learning is the task of learning a function that maps feature measurements to outcome measures based on past examples of feature-outcome pairs. In supervised machine learning, the measurement outputs can vary in nature depending on the example. There are quantitative measurement outcomes, for which we use regression models and qualitative measurement outcomes for which we use classification models.", "Another type of machine learning is unsupervised learning, where we only observe feature measurements and no outcomes. Unsupervised learning is the task of finding undetected patterns with no pre-existing measurement outcomes.", "In predicting the burn area of forest fires, for example, the output is a quantitative measurement. You can have large burn areas, small burn areas, and a range of values in between. Similarly, in the predicting medical costs example, you can have large and small medical expenses and examples in between. In general, outcome measurements close in value have a similar nature (similar features/input).", "Qualitative variables are categorical or discrete variables that are either descriptive labels or ordered categorical values. In the image classification example, the image labels are simply descriptions of what the image contains (ie: building, airplane, \u2026 etc). Qualitative variables are typically represented by numerical codes. For example, if you are classifying images of cats and dogs, cat can be encoded with a \u201c0\u201d and dogs can be encoded with a \u201c1\u201d (because dogs are better).", "For the remainder of this post, I will walk through the three machine learning use cases listed above. I will develop a baseline model, implemented in python, to demonstrate supervised learning for both regression and classification.", "The data for this example contains 517 fires from the Montesinho natural park in Portugal. The data contains the burn area and corresponding incident weekday, month, and coordinates. It also contains meteorological information such as rain, temperature, humidity, and wind. The goal is to predict the burn area from a number of measurements including spatial, temporal, and weather variables. This example is a supervised learning regression problem, since the outcome measurement is quantitative. The data can be found here.", "To begin, let\u2019s import Pandas. Pandas is a python library used for a variety of tasks, including data reading, statistical analysis, data aggregation and much more. We will use Pandas to read our data into what is called a data frame. A data frame is a two-dimensional data structure with labelled columns. Data frames are very similar to Excel spreadsheets.", "Let\u2019s read in our data using Pandas:", "Let\u2019s print the first five rows of data:", "Let\u2019s use a random forest model for our predictions. Random forests use an ensemble of uncorrelated decision trees. Decision trees are flow charts containing yes or no questions and answers about the features in our data. For a good introduction to random forests, I recommend you read Understanding Random Forest.", "For our model, we will use \u2018month\u2019, \u2018temp\u2019, \u2018wind\u2019, and \u2018rain\u2019 to predict burn area. Let\u2019s convert the month into a numerical value that we can use as input:", "We then split our data for training and testing:", "Now let\u2019s define our random forest object and fit our model to our training data. Here we will use 100 estimators (number of decision trees) and a max depth of 100 (number of questions to ask):", "We can then make predictions on our test data:", "We can evaluate the performance of our model by running the train/test split and prediction calculation 1000 times and taking the average across all runs:", "Now, let\u2019s move on to another machine learning use case: image classification.", "In this example, we will be building a classification model using data which comes from the Intel Image Classification challenge. It contains 25k images of forests, the sea, buildings, glaciers, mountains and streets. The data can be found here.", "We will be using a convolutional neural network (CNN) to classify the objects in the image data. CNNs are a class of deep neural networks most frequently applied to computer vision. CNNs find low level features of images like edges and curves and build up to more general concepts through a series of convolutions.", "The constituents of a CNN are the following layers:", "Convolution layer: A filter scans a few pixels at a time. From these pixels, features are generated and used to predict the class to which each feature belongs.", "Pooling Layer: This layer down samples the amount of information in each feature that is output by the convolutional layer while preserving the most important information.", "Flatten Layer: This layer takes the output from the previous layers and turns them into a single vector that will be used for input.", "Fully Connect Layer: This layer applies weights to the resulting features.", "Output Layer: The final layer gives the class prediction.", "CNNs are loosely inspired by the visual cortex, where small regions of cells are sensitive to specific regions in visual fields. As a result, neurons fire in the presence of edges in specific orientations, which collectively produce visual perception. For a more thorough discussion of CNNs consider reading A beginner\u2019s Guide to Understanding Convolutional Neural Networks. The article, Fully Connected Layers in Convolutional Neural Networks: The Complete Guide, is another useful resource if you want to further understand CNNs.", "Now let\u2019s build our image classification model. The code in this post is inspired by the Kaggle kernel: Intel Image Classification (CNN \u2014 Keras).", "To begin, let\u2019s import the necessary packages:", "Next, let\u2019s define a function that will load our data:", "We then define our data for training and testing:", "We then compile our model. We use sparse categorical cross entropy, or log loss, as our loss function. This metric is typically used to measure the performance of classification models:", "Next, let\u2019s fit our model. Here, we\u2019ll use one epoch (in the interest of time) and a batch size of 128:", "Next let\u2019s generate prediction probabilities and select the labels with the highest probabilities:", "Finally, we can visualize the output of the model using a heatmap confusion matrix in seaborn:", "Our model does a decent job predicting streets and forests but leaves much to be desired for the other categories. Feel free to perform further hyper-parameter tuning (experimenting with number of layers, neurons, epochs and batch size) to further decrease the classification error rate.", "You can also try applying this to other image classification problems. You can find a few here.", "Now let\u2019s move on the the final machine learning use case: Predicting medical costs.", "The data we will be using is simulated insurance cost data from Brett Lantz\u2019s introduction to machine learning book, Machine Learning with R. The data contains the age of primary insurance holders, sex, body mass index, number of children, smoking status, the beneficiary\u2019s residential area, and the individual medical costs billed by health insurance. The data can be found here.", "Let\u2019s import Pandas and read the data into a pandas data frame:", "Let\u2019s print the first five rows of data:", "As we can see this is a pretty simple data set. In this example, we will be using age, sex, BMI, parental status, smoker status, and geographic region to predict medical costs.", "For this example, we will build a k-nearest neighbors regression model to predict medical costs. While we will be using k-nearest neighbors for regression, it can also be used for classification. In both cases, it uses Euclidean distance calculations to predict the outcome measure of the k nearest neighbors.", "To proceed, let\u2019s convert the categorical columns into numerical values we can use as input to our model:", "Let\u2019s split our data for training and testing:", "Now, let\u2019s define our k-nearest neighbors regression model object. Let\u2019s use 5 neighbors:", "Next, we fit our model to the training data:", "Generate predictions on the test data:", "We can now evaluate our model. Let\u2019s use the mean absolute error metric:", "And finally, let\u2019s visualize our output:", "I\u2019ll stop here, but feel free to tune the k-nearest neighbors algorithm by playing with the number of neighbors. In general, the k-nearest neighbors algorithm is better suited for anomaly detection problems. You can check out a few examples of these problems here.", "To summarize, in this post we discussed machine learning and three relevant use cases that employ machine learning and statistical methods. We briefly discussed the difference between supervised and unsupervised learning. We also made a distinction between regression and classification models with examples of both problem types. I encourage you to apply these methods to other interesting use cases. For example, you can use CNNs to detect breast cancer in X-ray images (data can be found here) or you can use K-nearest neighbors to detect credit card fraud (data can be found here). I hope you found this post interesting/useful. Please leave a comment if you have any questions. The code from this post is available on GitHub. Good luck and happy machine learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F67b8a9e5db50&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----67b8a9e5db50---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67b8a9e5db50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67b8a9e5db50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@hiteshchoudhary", "anchor_text": "Hitesh Choudhary"}, {"url": "https://www.pexels.com/photo/man-in-grey-sweater-holding-yellow-sticky-note-879109/", "anchor_text": "Pexels"}, {"url": "https://www.kaggle.com/sumitm004/forest-fire-area", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "Understanding Random Forest"}, {"url": "https://www.kaggle.com/puneet6060/intel-image-classification", "anchor_text": "here"}, {"url": "https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/", "anchor_text": "A beginner\u2019s Guide to Understanding Convolutional Neural Networks"}, {"url": "https://missinglink.ai/guides/convolutional-neural-networks/fully-connected-layers-convolutional-neural-networks-complete-guide/", "anchor_text": "Fully Connected Layers in Convolutional Neural Networks: The Complete Guide"}, {"url": "https://www.kaggle.com/vincee/intel-image-classification-cnn-keras", "anchor_text": "Intel Image Classification (CNN \u2014 Keras)"}, {"url": "https://www.kaggle.com/search?q=image+classification+in%3Adatasets", "anchor_text": "here"}, {"url": "https://www.packtpub.com/big-data-and-business-intelligence/machine-learning-r", "anchor_text": "Machine Learning with R"}, {"url": "https://www.kaggle.com/mirichoi0218/insurance", "anchor_text": "here"}, {"url": "https://www.kaggle.com/search?q=anomaly+detection+in%3Adatasets", "anchor_text": "here"}, {"url": "https://www.kaggle.com/simjeg/lymphoma-subtype-classification-fl-vs-cll", "anchor_text": "here"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud/version/3", "anchor_text": "here"}, {"url": "https://github.com/spierre91/medium_code/blob/master/what_is_ml.py", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----67b8a9e5db50---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----67b8a9e5db50---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----67b8a9e5db50---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/software-development?source=post_page-----67b8a9e5db50---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/python?source=post_page-----67b8a9e5db50---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F67b8a9e5db50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----67b8a9e5db50---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F67b8a9e5db50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----67b8a9e5db50---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67b8a9e5db50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F67b8a9e5db50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----67b8a9e5db50---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----67b8a9e5db50--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-machine-learning-in-python-67b8a9e5db50&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}