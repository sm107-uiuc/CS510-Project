{"url": "https://towardsdatascience.com/machine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8", "time": 1683014156.1126778, "path": "towardsdatascience.com/machine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8/", "webpage": {"metadata": {"title": "Machine Learning Algorithms for Football Predictions | by Matheus Kempa | Towards Data Science", "h1": "Machine Learning Algorithms for Football Predictions", "description": "This article evaluated football/Soccer results (victory, draw, loss) prediction in Brazilian Football Championship using various machine learning models based on real-world data from the real\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.dn.pt/desporto/leicester-campeao-a-aposta-mais-improvavel-da-historia-britanica-5152206.html#:~:text=Segundo%20Joe%20Crilly%2C%20da%20William,paga%20mais%20alta%20na%20hist%C3%B3ria", "anchor_text": "probability for the title at the beginning of the season was one to five thousand", "paragraph_index": 1}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "Git repository", "paragraph_index": 7}, {"url": "https://scikit-learn.org/", "anchor_text": "Sklearn", "paragraph_index": 21}], "all_paragraphs": ["This article evaluated football/Soccer results (victory, draw, loss) prediction in Brazilian Football Championship using various machine learning models based on real-world data from the real matches. The models were tested recursively and average predictive results were compared. The results showed that logistic regression and support vectors machine yielded the best results, exhibiting superior average accuracy performance in comparison to others classifiers (KNN and Random Forest), with 49.77% accuracy (logistic Regression), almost 17% better than a random decision (benchmark) which has 33% of success chance. In addition, a ranking of the features\u2019 relative importance was made to orient the use of Data.", "Football/Soccer is a sport that is very present in people life\u2019s, people use to watch, play, and also bet. Thinking about betting, we clearly can see that football is a very unpredictable sport, and it does not acquire serious research to prove that. In the premier league 2015/2016 season, we had a very unexpected champion, and their probability for the title at the beginning of the season was one to five thousand.", "So, the prior objective of this project is to create a supervised machine learning algorithm that predicts the football matches results based on the statistics of the matches. Thus it will be possible to evaluate the difficulty level of prediction.", "In classification problems, is common to use accuracy, as an evaluation metric. As our outcome prediction is a multi-class problem, it\u2019s not going to be necessary to use other metrics.", "Where TP are the true positives, FP are the false positives, TN are the true negatives and FN are false negatives.", "However, before exploring the collected data, it\u2019s crucial to understand how this information was collected. So, this part will reach since the web-scrap robot developed for the final analysis of the whole database treated. The first and the second image below show how displays the page that the data was collected. So step number one is Web-scrap the main page, picking the football data, and creating a Data frame with all information combined.", "Now that we have the code ready to pick data from the matches it is necessary to create another code to collect all the season matches URLs so that it will be an automatized robot to do this task.", "All the codes will be attached to the Git repository.", "Before the data were clean and ready to be used for analysis, the below steps were done:", "Now it\u2019s time to evaluate the data collected so that it could be possible to create a prediction model to the results. These were the columns that our cleaned data had:", "The meaning of all the variables:", "Observation: Every match had to lines one for the home team, and another for the away team.", "It\u2019s good to check how these variables relate to each other so that it was created to approaches: Attack and Defense. In the code, it was also provided with a function that does this approach by the team and places played (Home/Away).", "For the attacking approach, it was selected 4 variables: \u201cSoT\u201d, \u201cSh\u201d, \u201cGls\u201d, \u201cTorcida\u201d. Looking at the data it\u2019s possible to see how difficult is to solve this problem because we can\u2019t find patterns looking at it. But it might be possible to conjecture some hypotheses different from the usual as:", "With these graphs, it\u2019s possible to see how our data is related, how the columns are related to each other, thus looking at 3 variables at the same time is possible to see the level of difficulty to separate this data. For the defense approach, it was selected 4 variables: \u201cTklW\u201d, \u201cFls\u201d, \u201cCrdY\u201d, \u201cTorcida\u201d. And as in attack analysis, it was not possible to find any patterns on the Defense Data either.", "However looking at Columns Info Figure, there are more variables available than those shown on graphs. And it\u2019s clear that at least 17 collected variables, can influence the match outcome therefore also on the performance of the prediction. But because football is a lot more complex, more variables were needed to have a good predict a match outcome, so in the next part, it will generate some other variables.", "As it\u2019s not possible to have the statistic of the games before the result of the match, it\u2019s necessary to create some new variables that would be available before the games. So in order to solve this dilemma, it is necessary to generate a mean for all the variables, this means will contain all the games before the correspondent game, by this way when a team plays on September 18, the code will provide a mean of all the variables available to all the games before this exactly game.", "It\u2019s going to be created some variables that try to show the computer the sequence of points for every team in the last 5 games, 3 games, and for the last game also. For every victory, the team the code summed 3 points, for a draw summed 1 point and for a loss summed no point, 0 points. In this way, it would be possible to see if the team comes from victories, draws, and losses.", "Since these treatments were done, it was found a way to inform the machine of the \u201cplace\u201d of the match. Because of this variable (place) and as the championship has 2 turns, the first turn may be in the Home of a team, and if the first game of the first championship turn it was on their home, the second necessarily has to me Away, or in other words, not him their stadium. And in Football matches, this is a very important variable. So the way designed to consider this variable was: Taking all data with all the variables created for the home teams(Place = Home) for every match, and then, subtract by the same dataset(the same variables) but from visiting teams (Place = Away). By this way it could be possible to generate a Database that the data would basically say:", "The final Database had 41 columns and 380 lines, and looked like this:", "Coming at this point our database has finally been treated and by now it\u2019s possible to run some models and check their performances", "To run we dropped the first four variables and \u201cGls\u201d variable either also was used MinMaxScalar on all the features variables. As can be seen on Sklearn, this estimator scales and translates each feature individually such that it is in the given range on the training set, e.g. between zero and one. Moreover were used all these 4 models:", "In order to run all these models we split the Database randomly using the library \u201dtrain test split\u201d from scikit-learn. For the test, it was used 30% of the Data. Moreover, the algorithm was randomly played through 1000 times, for all four models. In this way it was possible to check the standard deviation and the accuracy of all models. All models were used by the default values, not exploring the parameters of each specific model.", "As can be seen in the table below, the results weren\u2019t too expressive. The algorithm achieved almost 50% of accuracy, but, considering that the random prediction probability of success is 33% (Victory/Draw/Loss), it is a good signal, showing that the algorithm was able to identify some patterns after all.", "After all 1000 times, the Logistic Regression had the best results, with one of the lowest standard deviation rates and the highest accuracy between all four models. SVM performed better than the others, but had the highest standard deviation, maybe showing that the model tends to vary more than other models. Also were created a feature ranking using Random Forest features importance. As can be seen in the figure bellow, the football game crowd from the last 3 matches, the yellow card numbers, and also football game crowd from all the season were influencing more on the prediction outcome.", "It\u2019s weird to see logistic regression performed much better than the other models, mainly because as it was seen, data clearly it did not have patterns and it was a complex problem and surprisingly a very complex problem was solved, by a \u201dlinear\u201d approach, maybe the simplest here. One of the reasons for this may be because of the parameters of each model, that were not explored in this approach. Because SVM has a lot of kernels, trying different kernels might be a solution to reach a better performance for this model. Another strange point is that the \u201dpoints sequence\u201d was one of the lasts variables to interfere with the prediction. As far as I am concerned this variable should not be ignored and maybe there are more ways to show these patterns to the machine.", "This article proves that football prediction is still a very hard task, it still needs more variables to help with the prediction of the results. However, we can see by this article that a machine learning algorithms can already \u201dthink\u201d on which team bet and can still be more accurate than people that do not know about the games having almost 17% of advantage in the prediction when comparing to the probability of a random prediction.", "For the future, I suggest to investigate and find more variables that could be useful, as injuries for example, or more details of the players of each team, maybe FIFA or Pro Evolution game data could help to bring more information inside of the Base. Another thing that could be done for the future is on predicting the number of goals for of each team, this is more complex because it depends on the results predicted and they must conciliate with it, for example, it couldn\u2019t be two goals for the home team and two goals for the way team if the result was predicted as a victory of the home team. So, maybe, this article can be a source of inspiration for the creation of better and complex models in the future.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F51b7d4ea0bc8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@matheuskempa?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matheuskempa?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": "Matheus Kempa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7fa5bc03b175&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&user=Matheus+Kempa&userId=7fa5bc03b175&source=post_page-7fa5bc03b175----51b7d4ea0bc8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51b7d4ea0bc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51b7d4ea0bc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@willianjusten?utm_source=medium&utm_medium=referral", "anchor_text": "Willian Justen de Vasconcellos"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.dn.pt/desporto/leicester-campeao-a-aposta-mais-improvavel-da-historia-britanica-5152206.html#:~:text=Segundo%20Joe%20Crilly%2C%20da%20William,paga%20mais%20alta%20na%20hist%C3%B3ria", "anchor_text": "probability for the title at the beginning of the season was one to five thousand"}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "github"}, {"url": "https://fbref.com/en/matches/e1867e7b/Sao-Paulo-Botafogo-RJ-April-27-2019-Serie-A", "anchor_text": "Webscrapping Match Page"}, {"url": "https://www.sports-reference.com/sharing.html", "anchor_text": "FBREF"}, {"url": "https://fbref.com/en/comps/24/3320/schedule/2019-Serie-A-Scores-and-Fixtures", "anchor_text": "Season Games"}, {"url": "https://www.sports-reference.com/sharing.html", "anchor_text": "FBREF"}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "Git repository"}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "github"}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "github"}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "github"}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "github"}, {"url": "https://scikit-learn.org/", "anchor_text": "Sklearn"}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "github"}, {"url": "https://github.com/Matheuskempa/My_Udacity_Capstone", "anchor_text": "github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----51b7d4ea0bc8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/sports?source=post_page-----51b7d4ea0bc8---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----51b7d4ea0bc8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/football?source=post_page-----51b7d4ea0bc8---------------football-----------------", "anchor_text": "Football"}, {"url": "https://medium.com/tag/big-data?source=post_page-----51b7d4ea0bc8---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51b7d4ea0bc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&user=Matheus+Kempa&userId=7fa5bc03b175&source=-----51b7d4ea0bc8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51b7d4ea0bc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&user=Matheus+Kempa&userId=7fa5bc03b175&source=-----51b7d4ea0bc8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51b7d4ea0bc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F51b7d4ea0bc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----51b7d4ea0bc8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----51b7d4ea0bc8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matheuskempa?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matheuskempa?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matheus Kempa"}, {"url": "https://medium.com/@matheuskempa/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "38 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7fa5bc03b175&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&user=Matheus+Kempa&userId=7fa5bc03b175&source=post_page-7fa5bc03b175--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4d95a98bb307&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-for-football-prediction-using-statistics-from-brazilian-championship-51b7d4ea0bc8&newsletterV3=7fa5bc03b175&newsletterV3Id=4d95a98bb307&user=Matheus+Kempa&userId=7fa5bc03b175&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}