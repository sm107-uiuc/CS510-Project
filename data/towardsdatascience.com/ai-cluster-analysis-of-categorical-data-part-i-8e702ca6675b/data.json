{"url": "https://towardsdatascience.com/ai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b", "time": 1683007717.17999, "path": "towardsdatascience.com/ai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b/", "webpage": {"metadata": {"title": "AI, Cluster Analysis of Categorical Data (Part I) | by Michelangiolo Mazzeschi | Towards Data Science", "h1": "AI, Cluster Analysis of Categorical Data (Part I)", "description": "In this article I will create an AI that, given a dataset of Clash Royale matches, will identify what are the main clusters. All data is categorical, hence I won\u2019t be using a traditional factor\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/arditoibryan/Projects/tree/master/20200518_CRL", "anchor_text": "Full code available at my repository.", "paragraph_index": 1}, {"url": "https://statsroyale.com/", "anchor_text": "www.statsroyale.com", "paragraph_index": 11}, {"url": "https://github.com/arditoibryan/Projects/tree/master/20200518_CRL", "anchor_text": "already downloaded and prepared the dataset", "paragraph_index": 17}, {"url": "https://medium.com/towards-artificial-intelligence/clash-royale-api-looping-query-for-data-collection-2a6ed6a505d4", "anchor_text": "follow this complete guide on how to create an API that downloads the data.", "paragraph_index": 17}], "all_paragraphs": ["***The code begins after the Clash Royale introduction: skip, if you are not interested", "Full code available at my repository. The notebook is called: CRL_Clustering.", "In this article I will create an AI that, given a dataset of Clash Royale matches, will identify what are the main clusters. All data is categorical, hence I won\u2019t be using a traditional factor analysis technique, but rather a K-Node algorithm.", "Before explaining the code behind the AI I am going to create, I need to clarify what are meta-decks and how they relate to this project. Professional Videogame players have turned the study of competitive videogames into a real subject.", "In videogames where you need to prepare your deck from a pool of cards, there is a gigantic number of possible combinations, and from this sea of possibilities emerge a small batch that helps players gain a competitive advantage: the so-called meta-decks.", "I will be creating an AI that can find which are the meta-decks used in the competitive game called Clash Royale, extracting them from raw data.", "In this game there is a pool of 98 cards (up to May 2020, every few months the game adds another card). Every player has to compose a deck of 8 cards, to play against other players.", "The number of possible decks is 6345015248033280, from this pool of combinations, top players find out which are the meta-decks. The meta-decks keep changing now and then, so pros need to stay updated and keep studying the game.", "Unfortunately, there is no mathematical way to determine which are the best decks. The only possibility that champions have is to try out many of them and see which one plays out better against other players.", "Essentially, through continuous iterations, the meta-decks are the ones that allow the top players to win with consistency, hence allowed them to climb the hierarchy of competitive players up to the top spots. Therefore, these specific decks survived a selection of millions of matches fought among the community.", "As you can see, being excellent at something, even at videogames, takes a lot of effort, commitment, and study.", "Finally, how does the community of players (not only the top 100) find out the meta decks of every season? Thanks to the use of Youtube, Facebook groups, and statistics websites of Clash Royale such as www.statsroyale.com, people can see what the top players play and their win rate. The decks are then copied and used by all the players in the community, average or expert, up to the pro level.", "Let us now assume that we do not know anything about this videogame and which are the main decks of this season. I have in my possession almost 700 matches (669) played by the top players.", "What my AI will do is finding out which are the decks that are played more consistently and isolate them.", "Let\u2019s remember than anybody can edit their deck, so players can easily create a unique variation of a meta-deck that we do not want to take into account to the calculation, so we need an algorithm to figure out which are the original decks rather than the variations. We assume that the variations will be played with less frequency, leaving the original decks with the highest frequency.", "Within the hierarchy of meta-decks, the level of variations can reach a depth of hundreds due to the frequency of possible changes and experiments from millions of players.", "In this article I will cover up to step 3: label encoding the entire dataset. In the next part of the tutorial I will finalize the AI.", "For your convenience, I already downloaded and prepared the dataset we are going to use for applying clustering on categorical data. If you wish to download your own dataset of Clash Royale matches, please follow this complete guide on how to create an API that downloads the data.", "At the moment, the dataset contains too much information: we will need to get rid of all the columns that do not contain data about player n. 2. The reason is that I downloaded the most recent 25 games of several players selected as player n.1. One player usually plays a single archetype, and if the proportion of our entire dataset that contains repetitively the deck played by a single user is too high, the variance of meta-decks in our dataset would be highly decreased.", "We will only be looking at a list of decks played by player n. 2.", "***In my case I imported the data connecting it with my Google Drive. You should edit the first line depending on where you have stored your .csv file.", "Unfortunately, the data we collected is very chaotic. The order of the cards in every row corresponds to the order of the cards played in one match. A player could start using a Troop, but it may also start using a Spell. To see things clearly, we will need to sort the cards in a specific order.", "***The order of the features do not impact the final results. However, I believe this step is necessary to see the final results clearly and in a comprehensive way.", "In the game, there are essentially four types of cards. They have been conceptualized in this order to allow people to create proper decks.", "Because the dataset in my possession does not show the type of cards, we will need to create an algorithm capable of converting every card to its corresponding type.", "This is what I mean by mapping every card to its type: with the following mock list:", "I have created a .csv file that maps every existing card with its corresponding Type called CRL_Cards_Classification.csv.", "For every deck in the dataset I want all cards sorted in the order: Win Condition, Troop, Building, Spell.", "To do so, we will first assign an ascending value to each one of the types, so that we know which type comes first:", "***If instead, we wanted to order the lists alphabetically, we would use the following code rather than using order_now", "Now that we have sorted our dataset based on a hierarchy we can comprehend easily, we can start pre-processing it. We will now label the entire dataset, you will understand why later on, and that will be more problematic that labeling a single row.", "Usually, engineers use scikit-learn tools to easily label categorical data. Unfortunately, scikit-learn and other tools only allow the labeling of a single column at a time. This is an example of why it can represent a problem for us:", "As you can see, in the first column b = 1, in the second column b = 0. The reason is that the algorithm is applying labeling to each individual column without considering the values in the other columns.", "To have accurate labeling, we will need to flat everything to one column, then apply the labeling and rebuild the initial dataset:", "This will be performed using the code below:", "Now that we managed to label correctly each of our features, we can perform one_hot encoding for feeding our dataset into the AI.", "In my next article I will describe the entire procedure, however, on the notebook available in my repository you will find Part II already.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Evangelist, Machine Learning and NLP expert"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8e702ca6675b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ardito.bryan?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ardito.bryan?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": "Michelangiolo Mazzeschi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F153452706ad7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&user=Michelangiolo+Mazzeschi&userId=153452706ad7&source=post_page-153452706ad7----8e702ca6675b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8e702ca6675b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8e702ca6675b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/arditoibryan/Projects/tree/master/20200518_CRL", "anchor_text": "Full code available at my repository."}, {"url": "http://www.theclashify.com", "anchor_text": "www.theclashify.com"}, {"url": "http://www.statsroyale.com", "anchor_text": "www.statsroyale.com"}, {"url": "https://statsroyale.com/", "anchor_text": "www.statsroyale.com"}, {"url": "https://clashroyale.fandom.com/wiki/2v2", "anchor_text": "https://clashroyale.fandom.com/wiki/2v2"}, {"url": "http://www.statsroyale.com", "anchor_text": "www.statsroyale.com"}, {"url": "https://github.com/arditoibryan/Projects/tree/master/20200518_CRL", "anchor_text": "already downloaded and prepared the dataset"}, {"url": "https://medium.com/towards-artificial-intelligence/clash-royale-api-looping-query-for-data-collection-2a6ed6a505d4", "anchor_text": "follow this complete guide on how to create an API that downloads the data."}, {"url": "https://towardsdatascience.com/ai-cluster-analysis-of-categorical-data-part-ii-47f3a13601a2", "anchor_text": "GO TO PART II"}, {"url": "https://medium.com/tag/clash-royale?source=post_page-----8e702ca6675b---------------clash_royale-----------------", "anchor_text": "Clash Royale"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----8e702ca6675b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/clustering?source=post_page-----8e702ca6675b---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8e702ca6675b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8e702ca6675b---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8e702ca6675b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&user=Michelangiolo+Mazzeschi&userId=153452706ad7&source=-----8e702ca6675b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8e702ca6675b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&user=Michelangiolo+Mazzeschi&userId=153452706ad7&source=-----8e702ca6675b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8e702ca6675b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8e702ca6675b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8e702ca6675b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8e702ca6675b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8e702ca6675b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8e702ca6675b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8e702ca6675b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ardito.bryan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ardito.bryan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michelangiolo Mazzeschi"}, {"url": "https://medium.com/@ardito.bryan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "797 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F153452706ad7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&user=Michelangiolo+Mazzeschi&userId=153452706ad7&source=post_page-153452706ad7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc2be7e99e1ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-cluster-analysis-of-categorical-data-part-i-8e702ca6675b&newsletterV3=153452706ad7&newsletterV3Id=c2be7e99e1ee&user=Michelangiolo+Mazzeschi&userId=153452706ad7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}