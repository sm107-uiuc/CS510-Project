{"url": "https://towardsdatascience.com/sparse-group-lasso-in-python-255e379ab892", "time": 1683011999.0888908, "path": "towardsdatascience.com/sparse-group-lasso-in-python-255e379ab892/", "webpage": {"metadata": {"title": "Sparse Group Lasso in Python. A tutorial on how to use one of the\u2026 | by \u00c1lvaro M\u00e9ndez Civieta | Towards Data Science", "h1": "Sparse Group Lasso in Python", "description": "So yesterday I launched a new package for python: asgl (the name comes from Adaptive Sparse Group Lasso) that adds a lot of features that were already available in R packages but not in python, like\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/alvaromc317/asgl", "anchor_text": "asgl", "paragraph_index": 0}, {"url": "https://github.com/alvaromc317/asgl/blob/master/user_guide.ipynb", "anchor_text": "jupyter notebook", "paragraph_index": 26}], "all_paragraphs": ["So yesterday I launched a new package for python: asgl (the name comes from Adaptive Sparse Group Lasso) that adds a lot of features that were already available in R packages but not in python, like solving sparse group lasso models, and goes beyond that, adding extra features that improve the results that sparse group lasso can provide.", "This is going to be the first article on a series about state-of-the-art regularization techniques in regression, and I would like to start talking about the sparse group lasso: what is it and how to use it. Specifically, here we will see:", "To understand what is sparse group lasso we need to talk (briefly) about two techniques: lasso and group lasso. Given a risk function, for example the linear regression risk,", "Lasso: is defined by adding a penalization on the absolute value of the \u03b2 coefficients,", "This definition provides sparse solutions, because it will send to zero some of the \u03b2 coefficients (the least related with the response variable). The effect of this penalization can be controlled using the \u03bb parameter. A large \u03bb value provides solutions where the penalization has a greater importance, and thus there are more zeros among the \u03b2 coefficients. This is mainly useful in high dimensional datasets, where there are more variables than observations but we only expect a small fragment of the variables to be truly meaningful.", "However, there are situations in which the predictor variables in X have a natural grouped structure. For example, in biostatistics it is common to deal with genetic datasets in which predictors are grouped into genetical pathways. In stock market analysis one can group companies from the same business segment. In climate data one can group different regions\u2026 And lasso provides individual sparse solutions, not group sparse.", "Group lasso: So here comes group lasso to the rescue. Group lasso is built as the sum of squares of coefficients belonging to the same group.", "This way it takes into account the possible grouped structure of predictors, and it sends to zero whole groups of variables. If all the groups are of size 1 (only one predictor per group) we will be solving a lasso model. Lets see lasso and group lasso graphically,", "In the image above we have a simple problem with three coefficients, \u03b2\u2081\u03b2\u2081\u2081 and \u03b2\u2081\u2082. The last two coefficients form a group, and as we can see, lasso (left image) does not take this grouping information into account, but group lasso does. So group lasso can be seen as lasso between groups and ridge within groups. If a group is meaningful, we select the whole group. If it is not, we send it to zero.", "Sparse group lasso: and finally here it is,", "Sparse group lasso is a linear combination between lasso and group lasso, so it provides solutions that are both between and within group sparse.", "This technique selects the most meaningful predictors from the most meaningful groups, and is one of the best variable selection alternatives of recent years. However, there was no implementation of sparse group lasso for python\u2026 until now.", "Lets start by installing asgl. This can be easily done using pip", "Or alternatively, one can pull the github repository and run the setup.py", "Once we have the package installed, we can start using it. First lets import the libraries and the BostonHousing dataset that we will use in this example.", "Here, in addition to importing the dataset, we have created a variable called group_index . This variable describes the group structure of the data, so if we have 13 predictors, group_index should be a variable of length 13, and if the first three predictors form a group, they should have the same group_index value. However, BostonHousing dataset does not have a natural grouped structure, so here we define a fake one just for the sake of this article.", "If we have a look to the sparse group lasso equation above, we can see that there are two parameters, \u03b1 and \u03bb, that can be optimized. \u03bb controlls how much weight we want to give to the penalization, so larger \u03bb values produce more sparse solutions. And \u03b1 controls the tradeoff between lasso and group lasso. \u03b1 equal to 1 provides a lasso, and \u03b1 equal to 0 provides a group lasso. Now, usually, we can define a grid of possible values for both parameters and try to find the combination that minimizes the error.", "Additionally, we specify the type of model to solve (lm, because we are solving a linear model), the penalization (sgl, because we want the sparse group lasso), the error type to use (MSE, because we will use the mean squared error) and finally, we can indicate if we want to run this code sequentially or in parallel. Parallel execution makes use of the multiprocess python library and can solve the problem much faster than sequentially.", "We have defined a grid of 23 possible \u03bb values and 20 possible \u03b1 values. A total number of 460 combinations of parameters. And we are going to find the optimal combination using cross validation (that will run in parallel)", "So first, we define a CV object, and we plug in all the parameter information defined above. Then, we run the cross_validation() function, that will return the error that each of the 460 models achieve on each of the k folds.", "With that, we search for the parameter values that minimize the mean squared error, and store their values in optimal_lambda and optimal_alpha .", "As simple as that, we have found our optimal model.", "However, one should remember that cross validation errors are a little bit biased, so in order to obtain the final prediction error we are going to run a final train / test split just using the optimal parameters,", "First, we define an ASGL object, that we will use for fitting a simple sparse group lasso model (no cross validation). We then split the data into 70% train 30% test using the function train_test_split() , and we fit the model so that we obtain the final estimates of the \u03b2 coefficients (stored in final_beta_solution )", "Given a new dataset, we can predict the value of the response variable using the function ASGL.predict() , and compute the final prediction error using the test set with the function error_calculator .", "And that\u2019s it on how to implement sparse group lasso in python. I hope you enjoyed this post and found it useful, so stay tuned for future posts on this series and please do not hesitate on contacting me if you have any question / suggestion.", "For a deeper review on what the asgl package has to offer, I recommend reading the jupyter notebook provided in the github repository.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hello, I am a Ph.D. student at University Carlos III of Madrid. I mainly work in high dimensional statistics, but I am also very interested in deep learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F255e379ab892&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----255e379ab892--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----255e379ab892--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alvaromc317?source=post_page-----255e379ab892--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alvaromc317?source=post_page-----255e379ab892--------------------------------", "anchor_text": "\u00c1lvaro M\u00e9ndez Civieta"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97c9cdfb03c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&user=%C3%81lvaro+M%C3%A9ndez+Civieta&userId=97c9cdfb03c5&source=post_page-97c9cdfb03c5----255e379ab892---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F255e379ab892&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F255e379ab892&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@priscilladupreez?utm_source=medium&utm_medium=referral", "anchor_text": "Priscilla Du Preez"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/alvaromc317/asgl", "anchor_text": "asgl"}, {"url": "https://github.com/alvaromc317/asgl", "anchor_text": "https://github.com/alvaromc317/asgl"}, {"url": "https://github.com/alvaromc317/asgl/blob/master/user_guide.ipynb", "anchor_text": "jupyter notebook"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----255e379ab892---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----255e379ab892---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----255e379ab892---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/regression?source=post_page-----255e379ab892---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/lasso-regression?source=post_page-----255e379ab892---------------lasso_regression-----------------", "anchor_text": "Lasso Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F255e379ab892&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&user=%C3%81lvaro+M%C3%A9ndez+Civieta&userId=97c9cdfb03c5&source=-----255e379ab892---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F255e379ab892&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&user=%C3%81lvaro+M%C3%A9ndez+Civieta&userId=97c9cdfb03c5&source=-----255e379ab892---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F255e379ab892&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----255e379ab892--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F255e379ab892&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----255e379ab892---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----255e379ab892--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----255e379ab892--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----255e379ab892--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----255e379ab892--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----255e379ab892--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----255e379ab892--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----255e379ab892--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----255e379ab892--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alvaromc317?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alvaromc317?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "\u00c1lvaro M\u00e9ndez Civieta"}, {"url": "https://medium.com/@alvaromc317/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "37 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97c9cdfb03c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&user=%C3%81lvaro+M%C3%A9ndez+Civieta&userId=97c9cdfb03c5&source=post_page-97c9cdfb03c5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fec20f9e9838b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsparse-group-lasso-in-python-255e379ab892&newsletterV3=97c9cdfb03c5&newsletterV3Id=ec20f9e9838b&user=%C3%81lvaro+M%C3%A9ndez+Civieta&userId=97c9cdfb03c5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}