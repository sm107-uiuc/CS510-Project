{"url": "https://towardsdatascience.com/creating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7", "time": 1683010330.599297, "path": "towardsdatascience.com/creating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7/", "webpage": {"metadata": {"title": "Data Pipelines for financial and economic data | by Paul Simpson | Towards Data Science", "h1": "Data Pipelines for financial and economic data", "description": "Creating Data pipelines in python with SQLite and macroeconomic data. Matplotlib visualisation plots."}, "outgoing_paragraph_urls": [{"url": "https://fred.stlouisfed.org/", "anchor_text": "Federal Reserve Economic Data (FRED) at federal reserve bank of St. Louis for economic research", "paragraph_index": 4}, {"url": "https://economics.yale.edu/people/faculty]", "anchor_text": "Yale Department of Economics", "paragraph_index": 4}, {"url": "https://www.sqlite.org/index.html", "anchor_text": "download", "paragraph_index": 6}, {"url": "https://sqlitestudio.pl/", "anchor_text": "SQLiteStudio", "paragraph_index": 6}], "all_paragraphs": ["Pre-requirements: Python 3, SQLite, SQLiteStudio (Optional), Quandl Account", "Python modules required: Quandl, pandas, sqlite3, matplotlib, seaborn, numpy", "This is a fairly straight forward solution, and is just illustrative of how simple ETL can be achieved with python and the various modules available. I have included some snippets of code to give an idea of how I have pieced it all together.", "This of-course can be achieved with cloud platforms. However, for this project, I have opted to keep and manage my data locally. This also serves as an alternative to paying for cloud compute resources. Even if you can manage to get free compute and storage, most certainly for a limited period of time or limited capability. Running this locally will help me keep the project alive.", "I will look at a range of data from Federal Reserve Economic Data (FRED) at federal reserve bank of St. Louis for economic research. Including data from Yale Department of Economics. All of which is derived from Quandl\u2019s API.", "The structure of my approach project is the following: by creating user defined functions to handle each stage; extract, transform, load, database query and charts.", "The first step is to download and install SQLite on your local machine. Next step from this is to create a database. Optionally, you can create a database from the command line using SQLite commands or via SQLiteStudio. This will serve as database management.", "There are 2 parts required in order to create the function to connect to the API. Firstly, a Quandl account is required. After creating an account it is as simple as collecting an API token, in which can be used to access the data.", "The transformation function is fairly simple as the data does not need refined or cleaned for this example. Object returned from Quandl\u2019s API is converted into a pandas Dataframe. For sanity reasons, column headers spaces are replaced with underscores prior to loading the data into the SQLite Database.", "This stage again fairly simple with the module pandas provides base connectivity to SQL databases. The commit() function will commit changes to the database.", "The idea behind this function was to allow to iterate over lists of different tables to extract, transform and load into the database.", "Using the main function to perform ETL then analysis on selected instruments from Quandl. In the main function, I usually just include behavioural aspects that I want to perform, e.g. load/ refresh the datasets within the database. Or as below in the next section choose to extract data from my database into a dataframe to plot them through a function.", "To caveat my solution to date, you will have to know or search the name of the indicator within Quandl\u2019s database. Also, being familiar with what the data represents and the actual data itself will also be an advantage.", "This is the more meticulous part of the process, there was more time spent here putting together the visuals. I have created functions to accept multiple times series data. All be it this is an Interim solution; producing Matplotlib time series charts, as well as Seaborn for correlation analysis. It has been designed to look a simple yet professional and a lot less scientific. The following figures represent the final outputs on a few of the data sets loaded into the Database.", "Fig 2 above the result of a query against the database that has returned a new dataframe that can be passed into the charting function. Yielding a time series plot of price to earnings ratio of the S&P500 with the NASDAQ100", "Fig 3 is just another example of data pulled into the database and then plotted again in the same function as above.", "FRED Velocity of Money Stock M2 - The velocity of money is the frequency at which one unit of currency is used to purchase domestically- produced goods and services within a given time period. In other words, it is the number of times one dollar is spent to buy goods and services per unit of time. [1]", "Trade weighted U.S. Dollar Index represents a number of foreign exchange pairs against the US dollar to indicate dollar strength.", "Note: Annotation overlaps with axis labels which need to be amended.", "Fig 4 is loaded with the same extract of data as above in fig 3. The idea here was to highlight any correlation between the features. Applying rolling correlation with 2 different sample sizes, the plot on the right shows the change of correlation over time. On the left is a seaborn plot that displays the total observed period correlation.", "Plans for the future iteration of this project.", "Please feel free to reach out with any questions or tips for me.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MSc Data Science, Consultant @ EY"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fad852e8daca7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@DrPaulSimpson?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@DrPaulSimpson?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": "Paul Simpson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8e98217de665&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&user=Paul+Simpson&userId=8e98217de665&source=post_page-8e98217de665----ad852e8daca7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad852e8daca7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad852e8daca7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://fred.stlouisfed.org/", "anchor_text": "Federal Reserve Economic Data (FRED) at federal reserve bank of St. Louis for economic research"}, {"url": "https://economics.yale.edu/people/faculty]", "anchor_text": "Yale Department of Economics"}, {"url": "https://www.sqlite.org/index.html", "anchor_text": "download"}, {"url": "https://sqlitestudio.pl/", "anchor_text": "SQLiteStudio"}, {"url": "https://plotly.com/dash/", "anchor_text": "Dash library"}, {"url": "https://fred.stlouisfed.org/series/M2V,", "anchor_text": "https://fred.stlouisfed.org/series/M2V,"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----ad852e8daca7---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/python?source=post_page-----ad852e8daca7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/economics?source=post_page-----ad852e8daca7---------------economics-----------------", "anchor_text": "Economics"}, {"url": "https://medium.com/tag/matplotlib?source=post_page-----ad852e8daca7---------------matplotlib-----------------", "anchor_text": "Matplotlib"}, {"url": "https://medium.com/tag/sqlite?source=post_page-----ad852e8daca7---------------sqlite-----------------", "anchor_text": "Sqlite"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad852e8daca7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&user=Paul+Simpson&userId=8e98217de665&source=-----ad852e8daca7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad852e8daca7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&user=Paul+Simpson&userId=8e98217de665&source=-----ad852e8daca7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad852e8daca7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fad852e8daca7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ad852e8daca7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ad852e8daca7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ad852e8daca7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ad852e8daca7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ad852e8daca7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@DrPaulSimpson?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@DrPaulSimpson?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Paul Simpson"}, {"url": "https://medium.com/@DrPaulSimpson/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "133 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8e98217de665&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&user=Paul+Simpson&userId=8e98217de665&source=post_page-8e98217de665--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4d382d94a721&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-smart-etl-data-pipelines-in-python-for-financial-and-economic-data-ad852e8daca7&newsletterV3=8e98217de665&newsletterV3Id=4d382d94a721&user=Paul+Simpson&userId=8e98217de665&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}