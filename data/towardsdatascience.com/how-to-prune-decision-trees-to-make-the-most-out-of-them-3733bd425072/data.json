{"url": "https://towardsdatascience.com/how-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072", "time": 1683014863.202517, "path": "towardsdatascience.com/how-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072/", "webpage": {"metadata": {"title": "How to Prune Decision Trees to Make the Most Out of Them | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "How to Prune Decision Trees to Make the Most Out of Them", "description": "Decision trees are supervised machine learning algorithms that work by iteratively partitioning the dataset into smaller parts. The partitioning process is the most critical part of building decision\u2026"}, "outgoing_paragraph_urls": [{"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 26}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 26}], "all_paragraphs": ["Decision trees are supervised machine learning algorithms that work by iteratively partitioning the dataset into smaller parts. The partitioning process is the most critical part of building decision trees.", "The partitions are not random. The aim is to increase the predictiveness of the model as much as possible at each partitioning so that the model keeps gaining information about the dataset.", "For instance, the following is a decision tree with a depth of 3.", "The first partition is based on feature 6 (X[6]) and able to put all data instances that belong to the first class (59) on the right side of the tree.", "This clearly shows that partitions that maximize the information gain are prioritized. The information gain can be quantified by Entropy or Gini impurity. In general, the information gain is proportional to the increase in purity (or decrease in impurity).", "The purity of a node is inversely proportional to the distribution of different classes in that node.", "Consider a case where you pick a data instance and randomly label it. Gini impurity measures how often your random label would be incorrect. If all data points had the same label, then the label would always be correct and Gini impurity would be zero. On the other hand, if data points were equally distributed among multiple labels, the random labels would often be incorrect. Thus, Gini impurity increases with randomness.", "Entropy is another measure of uncertainty or randomness. The more randomness a variable has, the higher the entropy is.", "Partitions that result in more pure nodes are chosen. Thus, when selecting a feature to partition the dataset, the decision tree algorithm tries to achieve:", "The decision trees need to be carefully tuned to make the most out of them. Too deep trees are likely to result in overfitting. Scikit-learn provides several hyperparameters to control the growth of a tree.", "We will see how these hyperparameters achieve using the plot_tree function of the tree module of scikit-learn.", "I will use the wine dataset available under the datasets module of scikit-learn. Let\u2019s first import the libraries and load the dataset.", "The dataset 178 observations that belong to 3 different classes. There are 13 features that describe the observations.", "We can now start building decision trees with different hyperparameter values. The obvious one is the max_depth which stops tree growth at the specified depth level.", "The partitions are selected based on Gini impurity and the depth of the tree is 2. Max_depth provides a simple way to control tree growth which may not be enough in more complex cases.", "The min_samples_split specifies the minimum number of samples in a node to be further split.", "I only put a part of the visualization where we see the effect of the current hyperparameter. The node at the right is not further split because there are only 5 samples in it. Without min_samples_split=10, it\u2019d be further split as follows.", "Another hyperparameter to control tree growth is min_impurity_decrease which sets a threshold on the impurity decrease to consider a partition. It is a more educated way than the max depth because it takes into account the quality of a partition.", "All the partitions achieved a decrease of more than 0.1 on the impurity. When setting this value, we should also consider the criterion because Gini impurity and Entropy have different values.", "The max_leaf_nodes can also be used to control tree growth. It limits the number of leaf nodes a decision tree can have. The leaf nodes are the nodes at the end of a decision tree.", "The tree keeps growing in the best-first fashion until the maximum number of leaf nodes is reached. The best partitions are chosen based on the decrease in impurity.", "We have covered 5 different hyperparameters that can be used to control tree growth.", "We have adjusted them one by one to see the individual effects. However, in real-life cases, these hyperparameters need to be tuned together in order to create a robust and accurate model.", "If we grow a tree more than we should, we are likely to end up having an overfit model. Overfitting occurs when a tree fits the training set too well. Having very different accuracies on training and test sets is a strong indication of overfitting. In such cases, we should control the tree growth to obtain a well-generalized model.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3733bd425072&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3733bd425072--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3733bd425072--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----3733bd425072--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----3733bd425072--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----3733bd425072---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3733bd425072&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3733bd425072&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kris_ricepees?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Gary Bendig"}, {"url": "https://unsplash.com/s/photos/tree-pruning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3733bd425072---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/ai?source=post_page-----3733bd425072---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3733bd425072---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----3733bd425072---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3733bd425072---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3733bd425072&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----3733bd425072---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3733bd425072&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----3733bd425072---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3733bd425072&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3733bd425072--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3733bd425072&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3733bd425072---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3733bd425072--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3733bd425072--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3733bd425072--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3733bd425072--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3733bd425072--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3733bd425072--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3733bd425072--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3733bd425072--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-prune-decision-trees-to-make-the-most-out-of-them-3733bd425072&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}