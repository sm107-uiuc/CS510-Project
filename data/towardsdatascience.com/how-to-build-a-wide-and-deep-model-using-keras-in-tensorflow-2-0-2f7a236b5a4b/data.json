{"url": "https://towardsdatascience.com/how-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b", "time": 1682996385.134229, "path": "towardsdatascience.com/how-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b/", "webpage": {"metadata": {"title": "How to build a wide-and-deep model using Keras in TensorFlow 2.0 | by Lak Lakshmanan | Towards Data Science", "h1": "How to build a wide-and-deep model using Keras in TensorFlow 2.0", "description": "In TensorFlow 2.0, Keras has support for feature columns, opening up the ability to represent structured data using standard feature engineering techniques like embedding, bucketizing, and feature\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/GoogleCloudPlatform/data-science-on-gcp/blob/master/updates/cloudml/flights_model_tf2.ipynb", "anchor_text": "full notebook", "paragraph_index": 1}], "all_paragraphs": ["In TensorFlow 2.0, Keras has support for feature columns, opening up the ability to represent structured data using standard feature engineering techniques like embedding, bucketizing, and feature crosses. In this article, I will first show you a simple example of using the Functional API to build a model that uses features columns. Then, I will update the code to build out a full wide-and-deep model.", "To keep the article short, I am focusing on just the model, but you can see the full notebook (including reading data using tf.data) on GitHub.", "The code here assumes you are using TensorFlow 2.0. pip install it in Colab using:", "or use Cloud AI Platform (CAIP) Notebooks to get a TensorFlow 2.0 Jupyter instance:", "Create feature columns for each of the fields in your input:", "Here, I\u2019m creating numeric columns for the float fields and hashed-categorical columns for the categorical fields.", "For each of the inputs, also create a Keras Input layer, making sure to set the dtype and name for each of the input fields:", "In order to use a categorical variable in a deep learning model, we have to encode it. A sparse variable will have to be either embedded or one-hot encoded. So, let\u2019s do both:", "The key thing is to create a DenseFeatures layer to transform the inputs using the feature columns:", "If you want to build a wide-and-deep network, you want to wire the sparse features directly to the output node, but pass the real features through a set of dense layers. Here\u2019s a model architecture that will do that:", "Of course, this being Keras, you can easily sprinkle in dropout, batch normalization, etc. into the model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "articles are personal observations and not investment advice."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2f7a236b5a4b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lakshmanok.medium.com/?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": "Lak Lakshmanan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F247b0630b5d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&user=Lak+Lakshmanan&userId=247b0630b5d6&source=post_page-247b0630b5d6----2f7a236b5a4b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f7a236b5a4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f7a236b5a4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/GoogleCloudPlatform/data-science-on-gcp/blob/master/updates/cloudml/flights_model_tf2.ipynb", "anchor_text": "full notebook"}, {"url": "https://github.com/GoogleCloudPlatform/data-science-on-gcp/blob/master/09_cloudml/flights_model_tf2.ipynb", "anchor_text": "full notebook"}, {"url": "http://shop.oreilly.com/product/0636920057628.do", "anchor_text": "Data Science on GCP"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2f7a236b5a4b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----2f7a236b5a4b---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----2f7a236b5a4b---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/structured-data?source=post_page-----2f7a236b5a4b---------------structured_data-----------------", "anchor_text": "Structured Data"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----2f7a236b5a4b---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2f7a236b5a4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&user=Lak+Lakshmanan&userId=247b0630b5d6&source=-----2f7a236b5a4b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2f7a236b5a4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&user=Lak+Lakshmanan&userId=247b0630b5d6&source=-----2f7a236b5a4b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f7a236b5a4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2f7a236b5a4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2f7a236b5a4b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2f7a236b5a4b--------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lak Lakshmanan"}, {"url": "https://lakshmanok.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F247b0630b5d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&user=Lak+Lakshmanan&userId=247b0630b5d6&source=post_page-247b0630b5d6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F44e3f26acd1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-wide-and-deep-model-using-keras-in-tensorflow-2-0-2f7a236b5a4b&newsletterV3=247b0630b5d6&newsletterV3Id=44e3f26acd1a&user=Lak+Lakshmanan&userId=247b0630b5d6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}