{"url": "https://towardsdatascience.com/deep-learning-for-clinical-diagnostics-ca7bc254e5ac", "time": 1682996324.792851, "path": "towardsdatascience.com/deep-learning-for-clinical-diagnostics-ca7bc254e5ac/", "webpage": {"metadata": {"title": "Deep Learning for Clinical Diagnostics | by Nikolay Oskolkov | Towards Data Science", "h1": "Deep Learning for Clinical Diagnostics", "description": "This is the fourth article in the series Deep Learning for Life Sciences. In the previous posts, I showed how to use Deep Learning on Ancient DNA, Deep Learning for Single Cell Biology and Deep\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/deep-learning-on-ancient-dna-df042dc3c73d", "anchor_text": "Deep Learning on Ancient DNA", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/deep-learning-for-single-cell-biology-935d45064438", "anchor_text": ", Deep Learning for Single Cell Biology", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/deep-learning-for-data-integration-46d51601f781", "anchor_text": "Deep Learning for Data Integration", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/DNA_sequencing", "anchor_text": "Next Generation Sequencing (NGS)", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/deep-learning-for-single-cell-biology-935d45064438", "anchor_text": "post", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/deep-learning-for-single-cell-biology-935d45064438", "anchor_text": "Single Cell Biology", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Anscombe%27s_quartet", "anchor_text": "Anscombe\u2019s quartet", "paragraph_index": 7}, {"url": "https://www.nature.com/articles/s41467-018-07582-3", "anchor_text": "Cancer Associated Fibroblats (CAFs)", "paragraph_index": 12}, {"url": "https://www.ncbi.nlm.nih.gov/pubmed/29503172", "anchor_text": "In a similar manner", "paragraph_index": 12}, {"url": "https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE111229", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "tSNE", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/DBSCAN", "anchor_text": "DBSCAN", "paragraph_index": 12}, {"url": "https://twiecki.io/blog/2016/06/01/bayesian-deep-learning/", "anchor_text": "blog of Thomas Wiecki", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo", "anchor_text": "MCMC", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Hamiltonian_Monte_Carlo", "anchor_text": "Hamiltonian Monte Carlo", "paragraph_index": 15}, {"url": "https://docs.pymc.io/notebooks/posterior_predictive.html", "anchor_text": "Posterior Predictive Check (PPC)", "paragraph_index": 16}, {"url": "https://medium.com/u/8570b484f56c?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "Nikolay Oskolkov,", "paragraph_index": 20}, {"url": "https://github.com/NikolayOskolkov/DeepLearningClinicalDiagnostics", "anchor_text": "github", "paragraph_index": 20}], "all_paragraphs": ["This is the fourth article in the series Deep Learning for Life Sciences. In the previous posts, I showed how to use Deep Learning on Ancient DNA, Deep Learning for Single Cell Biology and Deep Learning for Data Integration. Now we are going to dive into Biomedicine and learn why and how we should use Bayesian Deep Learning for patient safety.", "Next Generation Sequencing (NGS) provided a major advance for our understanding of pathogenic mechanisms leading to common human diseases. Nevertheless, amount of data still remains a bottleneck for analysis in Biomedicine. In contrast to Data Science, millions of examples are rather uncommon in Biomedicine while high dimensional data are quite typical, therefore Machine Learning has very limited applications in Biomedicine. Lack of data and high-dimensional parameter space hinder precision in clinical diagnostics bringing a lot of false predictions which do not hold in clinical trials. When data are sparse/scarce/noisy and high-dimensional, Bayesian Statistics helps to make generalizable predictions.", "Here we will discuss how to implement Bayesian Deep Learning with PyMC3 in order to ensure patient safety and provide more accurate and intelligent predictions for clinical diagnostics.", "In the previous post I explained that performing a statistical analysis you should pay particular attention to the balance between the number of statistical observations, N, and the dimension of your space, i.e. number of features, P. Depending on the amount of data, you can select between Bayesian Statistics, Frequentist Statistics and Machine/Deep Learning.", "So it makes sense to use Deep Learning when you have a lot of data because you can abandon the dull world of Linear Algebra and jump into the rabbit hole of non-linear mathematics. In contrast, Biomedicine usually works in the opposite limit, N<<P, and needs Priors to compensate for the lack of data. This is the first reason why Biomedical analysis should be Bayesian.", "Now imagine for a moment that you got some Biomedical Big Data, this is uncommon but not impossible if one works with Imaging or Single Cell Biology, here you can and should do Deep Learning. But why would you want to be Bayesian in this case?", "Here comes the second reason: the necessity to generate less categorical (compared to traditional Frequentist based Deep Learning) predictions by incorporating uncertainties into the model. This is of tremendous importance for the areas with a very high price of false predictions such as self-driving cars, modelling stock market, earthquakes and particularly clinical diagnostics.", "There are many reasons to be cautious when applying Frequentist Statistics to clinical diagnostics. It is heavily based on normality assumption and hence sensitive to outliers, it operates with descriptive statistics which do not always reflect the underlying data distributions and therefore fail to correctly capture the difference between data sets in the Anscombe\u2019s quartet.", "In contrast, Bayesian probabilistic modelling of the Anscombe\u2019s data sets would result in large discrepancies in probability distributions.", "Intelligence is to know how much you do not know", "There are a few famous examples commonly referred to as Data Saurus which further demonstrate that Frequentist Statistics can not capture the difference between groups of samples with identical descriptive statistics such as mean, standard deviation or Pearson\u2019s correlation coefficient.", "Therefore, the simplistic Frequentist analysis should not be used for clinical diagnostics where we can not afford making false predictions that can damage people\u2019s lives.", "Here I will use scRNAseq data on Cancer Associated Fibroblats (CAFs) and apply Bayesian Deep Learning for their classification between malignant and non-malignant cell types. In a similar manner, diabetes patients can be assigned to certain disease sub-types for accurate treatment prescription. We will start with downloading expression data from here, loading them into Python, splitting into training and validation subsets and visualizing with tSNE. As usually, rows of the expression matrix are samples/cells, columns are features/genes, last column contains cell labels derived from unbiased DBSCAN clustering.", "Four clusters are clearly distinguishable at the tSNE plot. Next we are going to construct a Bayesian Neural Network (BNN) model with one hidden layer and 16 neurons, this is done by assigning Normal Priors to weights and biases and initializing them with random values.", "For building BNN, I am going to use PyMC3 and follow approach described in the fantastic blog of Thomas Wiecki. Within the model we define also the likelihood which is a Categorical distribution since we are dealing with a scRNAseq multi-class (4 classes) classification problem.", "By putting Priors on the weights and biases we let the model know that those parameters have uncertainties, therefore the MCMC sampler will build Posterior distributions for them. Now we are going to define a function which draws samples from the Posteriors of the parameters of the Bayesian Neural Network using one of the Hamiltonian Monte Carlo (a much faster sampler compared to e.g. Metropolis when derivatives of the parameters can be calculated) algorithms called NUTS. Sampling is the training of the BNN.", "Now we are going to validate the predictions of the Bayesian Neural Network model using Posterior Predictive Check (PPC) procedure. For this purpose, we will use the trained model and draw decision boundary on the tNSE plot for the test subset. Decision boundary is created by building a 100 x 100 grid on the tSNE plot and running the model prediction for each point of the grid. Next, we calculate the mean and the standard deviation of the probability of assignment of each point on the grid to one of the 4 cell sub-types and visualize the mean probability and uncertainty of the probability.", "The plots above correspond to the tSNE on the test subset (upper left); tSNE on the test subset with mean probability of assignment of each point to any of the 4 cell sub-types (upper right), which is basically what Maximum Likelihood / Frequentist Neural Network would predict; and tSNE on the test subset with the uncertainty of the probability of assignment of each point to the 4 cell sub-types (lower right), which is a particular output of Bayesian Neural Network. Here red and blue colors imply high and low probability of assigning points of tSNE to any cell sub-type, respectively. The darker area on the uncertainty heatmap indicates regions of higher uncertainty.", "What we can immediately see is that the mean probability heatmap contains two cells from the yellow class assigned with 100% probability to the purple cluster. This is a severe misclassification and a demonstration of the failure of Maximum Likelihood / Frequentist Neural Network. In contrast, the uncertainty heatmap shows that the two yellow cells fall onto a relatively dark area meaning that the Bayesian Neural Network was not at all sure about assigning those cells to any cluster. This example demonstrates the power of Bayesian Deep Learning for making safer and less radical classifications which is of particular importance for clinical diagnostics.", "Here we have learnt that Bayesian Deep Learning is a more accurate and safe way of doing predictions, which makes a lot of sense to use in clinical diagnostics where we are not allowed to be mistaken with treatment prescriptions. We have used PyMC3 and MCMC in order to build a Bayesian Neural Network model and sample from the posterior probability of the assignment of samples to malignant vs. non-malignant classes. Finally, we demonstrated superiority of the Bayesian Deep Learning over the Frequentist approach in utilizing uncertainty information to avoid sample missclassification.", "As usually, let me know in the comments if you have a specific favorite area in Life Sciences which you would like to address within the Deep Learning framework. Follow me at Medium Nikolay Oskolkov, in twitter @NikolayOskolkov, and check out the codes for this post on my github. I plan to write the next post about Deep Learning for Microscopy Image Analysis, stay tuned.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fca7bc254e5ac&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nikolay-oskolkov.medium.com/?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8570b484f56c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&user=Nikolay+Oskolkov&userId=8570b484f56c&source=post_page-8570b484f56c----ca7bc254e5ac---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca7bc254e5ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca7bc254e5ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/dl-for-life-sciences", "anchor_text": "Deep Learning for Life Sciences"}, {"url": "https://unsplash.com/photos/7jjnJ-QA9fY", "anchor_text": "Image source"}, {"url": "https://towardsdatascience.com/deep-learning-on-ancient-dna-df042dc3c73d", "anchor_text": "Deep Learning on Ancient DNA"}, {"url": "https://towardsdatascience.com/deep-learning-for-single-cell-biology-935d45064438", "anchor_text": ", Deep Learning for Single Cell Biology"}, {"url": "https://towardsdatascience.com/deep-learning-for-data-integration-46d51601f781", "anchor_text": "Deep Learning for Data Integration"}, {"url": "https://en.wikipedia.org/wiki/DNA_sequencing", "anchor_text": "Next Generation Sequencing (NGS)"}, {"url": "https://towardsdatascience.com/deep-learning-for-single-cell-biology-935d45064438", "anchor_text": "post"}, {"url": "https://towardsdatascience.com/deep-learning-for-single-cell-biology-935d45064438", "anchor_text": "Single Cell Biology"}, {"url": "https://emtiyaz.github.io/papers/ukjapan2018.pdf", "anchor_text": "Emtiyaz Khan"}, {"url": "https://alexgkendall.com/computer_vision/bayesian_deep_learning_for_safe_ai/", "anchor_text": "Alex Kendall"}, {"url": "https://en.wikipedia.org/wiki/Anscombe%27s_quartet", "anchor_text": "Anscombe\u2019s quartet"}, {"url": "https://www.autodeskresearch.com/publications/samestats", "anchor_text": "Image source"}, {"url": "https://www.nature.com/articles/s41467-018-07582-3", "anchor_text": "Cancer Associated Fibroblats (CAFs)"}, {"url": "https://www.ncbi.nlm.nih.gov/pubmed/29503172", "anchor_text": "In a similar manner"}, {"url": "https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE111229", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "tSNE"}, {"url": "https://en.wikipedia.org/wiki/DBSCAN", "anchor_text": "DBSCAN"}, {"url": "https://medium.com/@joeDiHare/deep-bayesian-neural-networks-952763a9537", "anchor_text": "Image source"}, {"url": "https://twiecki.io/blog/2016/06/01/bayesian-deep-learning/", "anchor_text": "blog of Thomas Wiecki"}, {"url": "https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo", "anchor_text": "MCMC"}, {"url": "https://en.wikipedia.org/wiki/Hamiltonian_Monte_Carlo", "anchor_text": "Hamiltonian Monte Carlo"}, {"url": "https://docs.pymc.io/notebooks/posterior_predictive.html", "anchor_text": "Posterior Predictive Check (PPC)"}, {"url": "https://medium.com/u/8570b484f56c?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "Nikolay Oskolkov,"}, {"url": "https://github.com/NikolayOskolkov/DeepLearningClinicalDiagnostics", "anchor_text": "github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ca7bc254e5ac---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ca7bc254e5ac---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ca7bc254e5ac---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----ca7bc254e5ac---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/dl-for-life-sciences?source=post_page-----ca7bc254e5ac---------------dl_for_life_sciences-----------------", "anchor_text": "Dl For Life Sciences"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fca7bc254e5ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&user=Nikolay+Oskolkov&userId=8570b484f56c&source=-----ca7bc254e5ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fca7bc254e5ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&user=Nikolay+Oskolkov&userId=8570b484f56c&source=-----ca7bc254e5ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca7bc254e5ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fca7bc254e5ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ca7bc254e5ac---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ca7bc254e5ac--------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "https://nikolay-oskolkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8570b484f56c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&user=Nikolay+Oskolkov&userId=8570b484f56c&source=post_page-8570b484f56c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff4a74ad409c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-clinical-diagnostics-ca7bc254e5ac&newsletterV3=8570b484f56c&newsletterV3Id=f4a74ad409c6&user=Nikolay+Oskolkov&userId=8570b484f56c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}