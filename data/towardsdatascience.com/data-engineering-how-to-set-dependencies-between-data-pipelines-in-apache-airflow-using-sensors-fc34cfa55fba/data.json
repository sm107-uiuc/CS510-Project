{"url": "https://towardsdatascience.com/data-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba", "time": 1683000325.1840699, "path": "towardsdatascience.com/data-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba/", "webpage": {"metadata": {"title": "Data Engineering \u2014 How to Set Dependencies Between Data Pipelines in Apache Airflow | by Nicholas Leong | Towards Data Science", "h1": "Data Engineering \u2014 How to Set Dependencies Between Data Pipelines in Apache Airflow", "description": "Use Apache Airflow Sensors to Set Dependencies between your Data Pipelines"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/data-engineering-how-to-build-a-google-drive-data-pipeline-with-google-app-script-d056958e6de6", "anchor_text": "Article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/data-engineering-how-to-build-a-gmail-data-pipeline-on-apache-airflow-ce2cfd1f9282", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://www.analyticsvidhya.com/blog/2018/04/googles-machine-learning-model-can-detect-cancer-real-time/", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/data-engineering-basics-of-apache-airflow-build-your-first-pipeline-eefecb7f1bb9", "anchor_text": "article", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/data-engineering-basics-of-apache-airflow-build-your-first-pipeline-eefecb7f1bb9", "anchor_text": "Basics of Apache Airflow", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/data-engineering-basics-of-apache-airflow-build-your-first-pipeline-eefecb7f1bb9", "anchor_text": "basics of Apache Airflow", "paragraph_index": 6}, {"url": "https://www.linkedin.com/in/nickefy/", "anchor_text": "LinkedIn Profile", "paragraph_index": 18}, {"url": "https://github.com/nickefy", "anchor_text": "Github", "paragraph_index": 18}, {"url": "https://www.linkedin.com/in/nickefy/", "anchor_text": "https://www.linkedin.com/in/nickefy/", "paragraph_index": 20}], "all_paragraphs": ["Greetings my fellow readers, it\u2019s me again.That guy who writes about his life experiences and a little tad bit about data.Just a little bit.Article after article, I always start with how important is data in a strong organisation. How large companies are using data to impact their business, impact our society and in turn, making them profits. Data can be used to save lives, just take a look at this article on how data is used to predict cancer cells. So please, let\u2019s skip the small talk about how important is data and how it\u2019s always right, just like your wife.", "In God we trust. All others must bring data. \u2014 W.Edwards Demming", "Before the world began, there was only darkness. Then somehow, someone said let there be light and suddenly all life came to life. Similarly, before there were any data, there was only darkness. Then somehow, data engineers built amazing pipelines to feed data into data warehouses and suddenly, all the data scientists be coming up with their models. The foundation of the data available heavily depends on the structure of the pipelines written by the engineers. Hence, it is important that we use the right tools to optimise our pipelines.", "In my previous article, I talk about how CRONJOBS are no longer viable in scheduling pipelines for a proper data warehouse. Instead, engineers should look into well documented workflow management systems that provide huge benefits like monitoring, setting dependencies and not to mention a nice UI to work with. The WMS that I have chosen is Apache Airflow simply because after researching between all the WMS available, my company thinks that Apache Airflow is the best fit currently for our warehouse. Did I also mention that twitter is using Apache Airflow for their data warehousing as well ? I also guided readers into setting up their first pipeline, talking about the Basics of Apache Airflow and how it works. This article is an extension to that because I will be talking about setting dependencies between your pipelines and why is it so important for your data warehouse.", "Every data warehouse differs from one another. As engineers, the best we can do is to build efficient pipelines to fit the PROs and CONs of the data warehouse itself. Every data warehouse gets data from a data source, and that might potentially be your master database or a clone of that. Depending on your company, you might run ETL pipelines to ingest data into your data warehouse. However, having Google Bigquery as my company\u2019s data warehouse, we think that it is more speed and cost efficient to run ELT pipelines since Google BQ handles transformations very well. It also takes the load off of our slave of the master db. I believe this is not unique to our company, its a pretty common practice in the data space right now. The usual agenda is pure data extractions of raw tables starting midnight for X hours, leading to transformations of those tables for another X hours to complete the full pipeline. Here\u2019s a visualisation I made to represent that.", "The reason that the pipeline is designed like this is because the first level of transformed tables originate and depends on the completion of the extraction of the raw tables. The second level of transformed tables then depend on these first level transformed tables. Hence, it is important that we set dependencies between these tasks. We do not want to execute a transformation of a table if one of it\u2019s origin tables has not been extracted/transformed yet. This would result in incorrect data, which is really what data engineers are blamed for.", "As mentioned, we will be working with Apache Airflow as our main WMS. By doing so, we can monitor our workflow efficiently, being able to track the tasks that failed, if there is any. If you have no idea on how to operate airflow then the following will look like puzzles to you, please read the basics of Apache Airflow first.", "Sensors are pre-built in airflow. As the title suggests, they sense for the completion of a state of any task in airflow, simple as that. We will be using sensors to set dependencies between our DAGS/Pipelines, so that one does not run until the dependency had finished. There is no need to write any custom operator for this. Here\u2019s the default format of sensors:", "We write this block of code as one of our tasks in our DAG. 2 things to note:", "In this example, say Table 1 is a result of a few joins from raw data sources. We will need to create 4 sensors to sense for the completion of the extraction dags before running the transformation of Table 1.", "To clear all doubts, let\u2019s assume that all of the extraction dags :", "We will write the following code in the transformation DAG for Table 1:", "With the above code written, the task \u2018transform_table_1\u2019 shall not proceed before the completion of the four dependencies we set. Once the sensors start, they will sense for the completion of the dependencies for 5 minutes. If the mentioned dependencies fail to complete, the sensors then appear as failure and up for retry.", "Here\u2019s the complete code for the DAG.", "You are one more step ahead in achieving clean data. Even if you are not a fellow data engineer, knowledge like these are beneficial to all data practitioners. Furthermore, sensors can be used for all airflow tasks.", "Wanna send an email after a query is ran? Use sensors", "Wanna scan through a certain shared google drive after a new file is inserted? Use sensors", "Ending note: Pardon my absence recently, I am working on Apache Beam to implement streaming pipelines. Interesting Stuff!Once its up I\u2019ll write about it !", "Thanks for reading! If you want to get in touch with me, feel free to reach me on nickmydata@gmail.com or my LinkedIn Profile. You can also view the code in my Github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist turned Engineer \u2014 Crunching data and writing about it so you don\u2019t get headaches. https://www.linkedin.com/in/nickefy/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffc34cfa55fba&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nickefy.medium.com/?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": ""}, {"url": "https://nickefy.medium.com/?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": "Nicholas Leong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc4539c5f517b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&user=Nicholas+Leong&userId=c4539c5f517b&source=post_page-c4539c5f517b----fc34cfa55fba---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc34cfa55fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc34cfa55fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@frostroomhead?utm_source=medium&utm_medium=referral", "anchor_text": "Rodion Kutsaev"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/data-engineering-how-to-build-a-google-drive-data-pipeline-with-google-app-script-d056958e6de6", "anchor_text": "Article"}, {"url": "https://towardsdatascience.com/data-engineering-how-to-build-a-gmail-data-pipeline-on-apache-airflow-ce2cfd1f9282", "anchor_text": "article"}, {"url": "https://www.analyticsvidhya.com/blog/2018/04/googles-machine-learning-model-can-detect-cancer-real-time/", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/data-engineering-basics-of-apache-airflow-build-your-first-pipeline-eefecb7f1bb9", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/data-engineering-basics-of-apache-airflow-build-your-first-pipeline-eefecb7f1bb9", "anchor_text": "Basics of Apache Airflow"}, {"url": "https://towardsdatascience.com/data-engineering-basics-of-apache-airflow-build-your-first-pipeline-eefecb7f1bb9", "anchor_text": "basics of Apache Airflow"}, {"url": "https://www.nicholas-leong.com/sign-up-here", "anchor_text": "Subscribe to my newsletter to stay in touch."}, {"url": "https://www.linkedin.com/in/nickefy/", "anchor_text": "LinkedIn Profile"}, {"url": "https://github.com/nickefy", "anchor_text": "Github"}, {"url": "https://medium.com/tag/python?source=post_page-----fc34cfa55fba---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/big-data?source=post_page-----fc34cfa55fba---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fc34cfa55fba---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----fc34cfa55fba---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/tag/data?source=post_page-----fc34cfa55fba---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc34cfa55fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&user=Nicholas+Leong&userId=c4539c5f517b&source=-----fc34cfa55fba---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc34cfa55fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&user=Nicholas+Leong&userId=c4539c5f517b&source=-----fc34cfa55fba---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc34cfa55fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffc34cfa55fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fc34cfa55fba---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fc34cfa55fba--------------------------------", "anchor_text": ""}, {"url": "https://nickefy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nickefy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nicholas Leong"}, {"url": "https://nickefy.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2K Followers"}, {"url": "https://www.linkedin.com/in/nickefy/", "anchor_text": "https://www.linkedin.com/in/nickefy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc4539c5f517b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&user=Nicholas+Leong&userId=c4539c5f517b&source=post_page-c4539c5f517b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2cfd2d291e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-engineering-how-to-set-dependencies-between-data-pipelines-in-apache-airflow-using-sensors-fc34cfa55fba&newsletterV3=c4539c5f517b&newsletterV3Id=2cfd2d291e3&user=Nicholas+Leong&userId=c4539c5f517b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}