{"url": "https://towardsdatascience.com/ml-basics-loan-prediction-d695ba7f31f6", "time": 1682996530.157328, "path": "towardsdatascience.com/ml-basics-loan-prediction-d695ba7f31f6/", "webpage": {"metadata": {"title": "ML basics: Loan prediction. The complete Data Science pipeline on a\u2026 | by Tariq Massaoudi | Towards Data Science", "h1": "ML basics: Loan prediction", "description": "Dream Housing Finance company deals in all home loans. They have presence across all urban, semi urban and rural areas. Customer first apply for home loan after that company validates the customer\u2026"}, "outgoing_paragraph_urls": [{"url": "https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/", "anchor_text": "https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/", "paragraph_index": 5}], "all_paragraphs": ["Dream Housing Finance company deals in all home loans. They have presence across all urban, semi urban and rural areas. Customer first apply for home loan after that company validates the customer eligibility for loan.", "The Company wants to automate the loan eligibility process (real time) based on customer detail provided while filling online application form. These details are Gender, Marital Status, Education, Number of Dependents, Income, Loan Amount, Credit History and others. To automate this process, they have given a problem to identify the customers segments, those are eligible for loan amount so that they can specifically target these customers.", "It\u2019s a classification problem , given information about the application we have to predict whether the they\u2019ll be to pay the loan or not.", "We\u2019ll start by exploratory data analysis , then preprocessing , and finally we\u2019ll be testing different models such as Logistic regression and decision trees.", "The data consists of the following rows:", "We\u2019ll be using seaborn for visualisation and pandas for data manipulation. You can download the dataset from here : https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/", "We\u2019ll import the necessary libraries and load the data :", "We can look at few top rows using the head function", "We can see that there\u2019s some missing data , we can further explore this using the pandas describe function:", "Some variables have missing values that we\u2019ll have to deal with , and also there seems to be some outliers for the Applicant Income , Coapplicant income and Loan Amount . We also see that about 84% applicants have a credit_history. Because the mean of Credit_History field is 0.84 and it has either (1 for having a credit history or 0 for not)", "It would be interesting to study the distribution of the numerical variables mainly the Applicant income and the loan amount. To do this we\u2019ll use seaborn for visualization.", "The distribution is skewed and we can notice quite a few outliers.", "Since Loan Amount has missing values , we can\u2019t plot it directly. One solution is to drop the missing values rows then plot it, we can do this using the dropna function", "People with better education should normally have a higher income, we can check that by plotting the education level against the income.", "The distributions are quite similar but we can see that the graduates have more outliers which means that the people with huge income are most likely well educated.", "Another interesting variable is credit history , to check how it affects the Loan Status we can turn it into binary then calculate it\u2019s mean for each value of credit history . A value close to 1 indicates a high loan success rate", "People with a credit history a way more likely to pay their loan, 0.07 vs 0.79 . This means that credit history will be an influential variable in our model.", "The first thing to do is to deal with the missing value , lets check first how many there are for each variable.", "For numerical values a good solution is to fill missing values with the mean , for categorical we can fill them with the mode (the value with the highest frequency)", "Next we have to handle the outliers , one solution is just to remove them but we can also log transform them to nullify their effect which is the approach that we went for here. Some people might have a low income but strong CoappliantIncome so a good idea is to combine them in a TotalIncome column.", "plotting the histogram of loan amount log we can see that it\u2019s a normal distribution!", "We\u2019re gonna use sklearn for our models , before doing that we need to turn all the categorical variables into numbers. We\u2019ll do that using the LabelEncoder in sklearn", "Now all our variables have became numbers that our models can understand.", "To try out different models we\u2019ll create a function that takes in a model , fits it and mesures the accuracy which means using the model on the train set and mesuring the error on the same set . And we\u2019ll use a technique called Kfold cross validation which splits randomly the data into train and test set, trains the model using the train set and validates it with the test set, it will repeat this K times hence the name Kfold and takes the average error. The latter method gives a better idea on how the model performs in real life.", "Now we can test different models we\u2019ll start with logistic regression:", "We\u2019ll try now a Decision tree which is should give us more accurate result", "We\u2019ve got the same score on accuracy but a worse score in cross validation , a more complex model doesn\u2019t always means a better score.", "The model is giving us perfect score on accuracy but a low score in cross validation , this a good example of over fitting. The model is having a hard time at generalizing since it\u2019s fitting perfectly to the train set.", "Solutions to this include : Reducing the number of predictors or Tuning the model parameters.", "We\u2019ve gone through a good portion of the data science pipe line in this article, namely EDA , preprocessing and modeling and we\u2019ve used essential classification models such as Logistic regression , Decision tree and Random forests. It would be interesting to learn more about the backbone logic behind these algorithms, and also tackle the data scraping and deployment phases.We\u2019ll try to do that in the next articles.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd695ba7f31f6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tariqmassaoudi.medium.com/?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": ""}, {"url": "https://tariqmassaoudi.medium.com/?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": "Tariq Massaoudi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F999f9755b9ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&user=Tariq+Massaoudi&userId=999f9755b9ef&source=post_page-999f9755b9ef----d695ba7f31f6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd695ba7f31f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd695ba7f31f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@wildbook?utm_source=medium&utm_medium=referral", "anchor_text": "Dmitry Demidko"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/", "anchor_text": "https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d695ba7f31f6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d695ba7f31f6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----d695ba7f31f6---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----d695ba7f31f6---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd695ba7f31f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&user=Tariq+Massaoudi&userId=999f9755b9ef&source=-----d695ba7f31f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd695ba7f31f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&user=Tariq+Massaoudi&userId=999f9755b9ef&source=-----d695ba7f31f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd695ba7f31f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd695ba7f31f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d695ba7f31f6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d695ba7f31f6--------------------------------", "anchor_text": ""}, {"url": "https://tariqmassaoudi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tariqmassaoudi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tariq Massaoudi"}, {"url": "https://tariqmassaoudi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "110 Followers"}, {"url": "https://www.linkedin.com/in/tariqmassaoudi", "anchor_text": "https://www.linkedin.com/in/tariqmassaoudi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F999f9755b9ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&user=Tariq+Massaoudi&userId=999f9755b9ef&source=post_page-999f9755b9ef--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc1c8bde83f3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-basics-loan-prediction-d695ba7f31f6&newsletterV3=999f9755b9ef&newsletterV3Id=c1c8bde83f3b&user=Tariq+Massaoudi&userId=999f9755b9ef&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}