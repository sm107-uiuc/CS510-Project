{"url": "https://towardsdatascience.com/checking-grammar-with-bert-and-ulmfit-1f59c718fe75", "time": 1683006504.825963, "path": "towardsdatascience.com/checking-grammar-with-bert-and-ulmfit-1f59c718fe75/", "webpage": {"metadata": {"title": "Checking grammar with BERT and ULMFiT. | by Sayak Misra | Towards Data Science", "h1": "Checking grammar with BERT and ULMFiT.", "description": "BERT and ULMFiT are two of the leaders of transfer learning in NLP. Here we can see both take on each other, on the task of grammar checking. And we can play around with these two models without even having a GPU."}, "outgoing_paragraph_urls": [{"url": "https://einstein.ai/research/the-wikitext-long-term-dependency-language-modeling-dataset", "anchor_text": "Wikitext 103 dataset", "paragraph_index": 5}, {"url": "https://nyu-mll.github.io/CoLA/", "anchor_text": "The Corpus of Linguistic Acceptability (CoLA)", "paragraph_index": 8}, {"url": "https://huggingface.co/transformers/index.html", "anchor_text": "Hugging Face\u2019s PyTorch", "paragraph_index": 11}, {"url": "https://gist.github.com/sayakmisra/dbb06efec99e760cf9e5d197175ad9c5#file-grammar-checker-bert-ipynb", "anchor_text": "notebook", "paragraph_index": 14}, {"url": "https://docs.fast.ai/", "anchor_text": "Fast.ai", "paragraph_index": 15}, {"url": "https://gist.github.com/sayakmisra/3f5a3fc7eb18e0a6f93dac4a08b08dd8#file-grammar-checker-ulmfit-ipynb", "anchor_text": "notebook", "paragraph_index": 16}, {"url": "https://github.com/sayakmisra/bert_ulmfit_grammar_checker", "anchor_text": "Github repo", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.matthews_corrcoef.html", "anchor_text": "Matthew\u2019s correlation coefficient", "paragraph_index": 19}, {"url": "http://Salesken.ai", "anchor_text": "Salesken.ai", "paragraph_index": 22}], "all_paragraphs": ["Transfer Learning came as a game changer for all the NLP researchers, so before diving in let\u2019s quickly revisit what transfer learning is.", "Transfer learning is a machine learning method where a model developed for a task is reused as the starting point for a model on a second task.", "Simply it leverages prior knowledge from one domain and task into a different domain and task. Luckily for us, we have various such models, which have prior knowledge about the language and its semantics, so we will just use those (knowledgeable) models and see how they perform on the task we have in hand(here checking grammar).", "But a major issue that many of us face in various NLP tasks is lack of good hardware(GPUs and TPUs), which is a must for NLP tasks as we deal with high dimension dense vectors. In this article we will see how we can overcome that too, using Google Colab for training the model and use a even a CPU machine to test and play around with our grammar checker.", "On one hand, we have ULMFiT, proposed by fast.ai\u2019s Jeremy Howard and NUI Galway Insight Center\u2019s Sebastian Ruder. ULMFiT achieves state-of-the-art result using novel techniques like:", "This method involves fine-tuning a pre-trained language model (LM), trained on the Wikitext 103 dataset, to a new dataset in such a manner that it does not forget what it previously learned.", "To compete with Fast.ai\u2019s ULMFIT we have Google\u2019s BERT (Bidirectional Encoder Representations from Transformers), which provide state-of-the-art results for most of the NLP tasks. BERT\u2019s key technical innovation is applying the bidirectional training of Transformer, a popular attention model, to language modelling. This is in contrast to previous efforts which looked at a text sequence either from left to right or combined left-to-right and right-to-left training.", "In this article we will not get into the details of each of the model but see how they perform on checking grammar.", "We\u2019ll use The Corpus of Linguistic Acceptability (CoLA) dataset for single sentence classification. It\u2019s a set of sentences labeled as grammatically correct or incorrect. It was first published in May of 2018, and is one of the tests included in the \u201cGLUE Benchmark\u201d on which models like BERT are competing.", "Let\u2019s have a glimpse of our data:", "We will use Google Colab for fine-tuning the pre-trained models as we can easily use the GPUs provided to us by Colab for free and it will largely reduce the training time.", "For BERT we will be using the Hugging Face\u2019s PyTorch implementation as it\u2019s quite simple and intuitive. Here are the steps that we broadly follow:", "4. Save the fine-tuned model to our local disk or drive.", "5. Download the saved model and do some grammar checking in our local machine.", "Here the notebook containing the whole code.", "Fast.ai provides a much simpler interface to implement ULMFIT. Here are the steps involved:", "Here is the notebook containing the above code.", "To visualize the results let\u2019s build a small flask application with a simple UI with HTML and CSS. Here is the Github repo of the Flask application, where you can easily download your own model and play around with this application.", "After playing with this for a day, BERT seemed to be the clear winner in this fight. Though we can fine-tune the hyper-parameters more to improve the results further.", "A better way to evaluate the models is through the predictions using Matthew\u2019s correlation coefficient because this is the metric used by the wider NLP community to evaluate performance on CoLA. With this metric, +1 is the best score, and -1 is the worst score. This way, we can see how well we perform against the state of the art models for this specific task.", "In this fight BERT might have an edge over fast.ai\u2019s ULMFiT in understanding the semantics of the language but we can further optimize our models to get better results. We can also try other Transfer learning models like: Facebook\u2019s RoBERTa, XLNET, ALBERT etc. for checking grammar.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science enthusiast, working towards solving various NLP problems at Salesken.ai"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f59c718fe75&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sayakmisra.misra?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sayakmisra.misra?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": "Sayak Misra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffcb2f933e1d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&user=Sayak+Misra&userId=fcb2f933e1d7&source=post_page-fcb2f933e1d7----1f59c718fe75---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f59c718fe75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f59c718fe75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@craftedbygc?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Green Chameleon"}, {"url": "https://unsplash.com/s/photos/write-book?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://einstein.ai/research/the-wikitext-long-term-dependency-language-modeling-dataset", "anchor_text": "Wikitext 103 dataset"}, {"url": "https://nyu-mll.github.io/CoLA/", "anchor_text": "The Corpus of Linguistic Acceptability (CoLA)"}, {"url": "https://huggingface.co/transformers/index.html", "anchor_text": "Hugging Face\u2019s PyTorch"}, {"url": "https://nyu-mll.github.io/CoLA/", "anchor_text": "dataset"}, {"url": "https://huggingface.co/transformers/main_classes/tokenizer.html", "anchor_text": "Encode"}, {"url": "https://gist.github.com/sayakmisra/dbb06efec99e760cf9e5d197175ad9c5#file-grammar-checker-bert-ipynb", "anchor_text": "notebook"}, {"url": "https://docs.fast.ai/", "anchor_text": "Fast.ai"}, {"url": "https://nyu-mll.github.io/CoLA/", "anchor_text": "dataset"}, {"url": "https://gist.github.com/sayakmisra/3f5a3fc7eb18e0a6f93dac4a08b08dd8#file-grammar-checker-ulmfit-ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/sayakmisra/bert_ulmfit_grammar_checker", "anchor_text": "Github repo"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.matthews_corrcoef.html", "anchor_text": "Matthew\u2019s correlation coefficient"}, {"url": "https://docs.fast.ai/", "anchor_text": "https://docs.fast.ai/"}, {"url": "https://huggingface.co/transformers/index.html", "anchor_text": "https://huggingface.co/transformers/index.html"}, {"url": "http://mccormickml.com/2019/11/11/bert-research-ep-1-key-concepts-and-sources/", "anchor_text": "http://mccormickml.com/2019/11/11/bert-research-ep-1-key-concepts-and-sources/"}, {"url": "https://medium.com/tag/bert?source=post_page-----1f59c718fe75---------------bert-----------------", "anchor_text": "Bert"}, {"url": "https://medium.com/tag/ulmfit?source=post_page-----1f59c718fe75---------------ulmfit-----------------", "anchor_text": "Ulmfit"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----1f59c718fe75---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----1f59c718fe75---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/fastai?source=post_page-----1f59c718fe75---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f59c718fe75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&user=Sayak+Misra&userId=fcb2f933e1d7&source=-----1f59c718fe75---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f59c718fe75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&user=Sayak+Misra&userId=fcb2f933e1d7&source=-----1f59c718fe75---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f59c718fe75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f59c718fe75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f59c718fe75---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f59c718fe75--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f59c718fe75--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f59c718fe75--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f59c718fe75--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sayakmisra.misra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sayakmisra.misra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sayak Misra"}, {"url": "https://medium.com/@sayakmisra.misra/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "49 Followers"}, {"url": "http://Salesken.ai", "anchor_text": "Salesken.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffcb2f933e1d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&user=Sayak+Misra&userId=fcb2f933e1d7&source=post_page-fcb2f933e1d7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8f7d5c4f2189&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchecking-grammar-with-bert-and-ulmfit-1f59c718fe75&newsletterV3=fcb2f933e1d7&newsletterV3Id=8f7d5c4f2189&user=Sayak+Misra&userId=fcb2f933e1d7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}