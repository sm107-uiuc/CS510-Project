{"url": "https://towardsdatascience.com/handling-messy-csv-files-2ef829aa441d", "time": 1683001623.01971, "path": "towardsdatascience.com/handling-messy-csv-files-2ef829aa441d/", "webpage": {"metadata": {"title": "Handling Messy CSV Files. Why they\u2019re a problem and what to do\u2026 | by Gerrit J.J. van den Burg | Towards Data Science", "h1": "Handling Messy CSV Files", "description": "CSV files are often used to store and transmit tabular data. But they can come in various formats and automatically detecting this format is hard. We show an example and present a solution."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/orgesleka/imdbmovies", "anchor_text": "This dataset on Kaggle", "paragraph_index": 3}, {"url": "https://docs.python.org/3/library/csv.html#csv.Sniffer", "anchor_text": "the documentation for the Python standard csv library", "paragraph_index": 4}, {"url": "https://github.com/alan-turing-institute/clevercsv", "anchor_text": "CleverCSV", "paragraph_index": 9}, {"url": "https://rdcu.be/bLVur", "anchor_text": "research", "paragraph_index": 9}, {"url": "https://github.com/alan-turing-institute/CleverCSV", "anchor_text": "on GitHub", "paragraph_index": 11}, {"url": "https://pypi.org/project/clevercsv/", "anchor_text": "PyPI", "paragraph_index": 11}, {"url": "https://github.com/alan-turing-institute/CSV_Wrangling", "anchor_text": "fully reproducible and publicly available", "paragraph_index": 11}, {"url": "https://visit.figure-eight.com/data-science-report.html", "anchor_text": "survey\u2019s show", "paragraph_index": 12}, {"url": "https://gertjanvandenburg.com/blog/csv", "anchor_text": "https://gertjanvandenburg.com", "paragraph_index": 13}], "all_paragraphs": ["If you\u2019re a working data scientist, CSV files might very well be your bread and butter. They are easy to read for both humans and computers alike, can be tracked in version control, and can be emailed and compressed easily! However, if you\u2019ve been around for a bit longer you may also be familiar with the dark side of CSV files: uncommon cell delimiters, uneven row lengths, double quoting, escape characters, comment lines, and more! \ud83d\ude31", "There\u2019s a very simple reason for this problem: a \u201ccomma separated value\u201d file is not a standard file format, but is actually more a convention that people haven\u2019t fully agreed on.\u00b9 Because of this, the number of variations of CSV file formats that you may encounter on the internet is enormous! As an illustration, here are some examples of real-world CSV files:", "Now, why is this a problem? Why do we care that CSV files come in different formats? Isn\u2019t this a wonderful way to express your individuality when saving tabular data? Well \u2026 no. A CSV file is used to store data, so it should be easy to load data from it. By varying the format that is used, CSV files require human inspection before they can be loaded.", "Here\u2019s an example of the latter point. This dataset on Kaggle contains information on 14,762 movies retrieved from IMDB. Say we want to load this data into Python, and want to use Pandas to load it into a nice data frame:", "Huh, that didn\u2019t work. What if we use the standard way of detecting the format, also known as the dialect, and load the file as suggested by the documentation for the Python standard csv library?", "Okay, that did something, but it ended up reading 13,928 rows, instead of the 14,762 that we expected!\u00b3 What's going on here??", "Well, it turns out that this particular CSV file uses an escape character (\\) when a movie title contains a comma! Neither Pandas nor the standard csv library detected this automatically, and therefore failed to load the data properly. Imagine if you would start analyzing this data without realizing that this happened! \ud83d\ude48", "Of course, you can manually inspect every CSV file you encounter on the web and make sure it doesn\u2019t have any problems. But it\u2019s 2019, why do we still have to deal with messy CSV files? Why can\u2019t these packages detect the dialect correctly? One reason this is difficult is that there are just too many variations of CSV files out there. Another reason is that it\u2019s actually non-trivial to come up with an algorithm that can do it correctly all the time, because any dialect will give you some table, but there\u2019s only supposed to be one table that correctly reflects the data that was stored.", "CSV is a textbook example of how not to design a textual file format. \u2014 The Art of Unix Programming (Raymond, 2003)", "Thankfully, there\u2019s now a solution: CleverCSV, a Python package for detecting the dialect of CSV files with high accuracy. It is modeled on the way in which a human would determine the dialect: by looking for patterns that result in a regular tabular structure with \u201cclean data\u201d in the cells (such as numbers, dates, etc.). CleverCSV is actually based on research, where we investigated almost 10,000 CSV files to develop the best way to detect CSV dialects. To make it easy to switch existing code to CleverCSV, the package has been designed to be a drop-in replacement for the CSV module. So instead of using import csv, you can use import clevercsv (or, if you're really smart: import clevercsv as csv).", "But wait, there\u2019s more! Of course you don\u2019t want to detect the dialect of the same file over and over again, because it\u2019s not likely to change all that often. So CleverCSV also provides a command line interface that simply gives you the code you need:\u2074", "CleverCSV also comes with handy wrappers for commonly used functionality, such as read_csv to detect the dialect and load the file as a list of lists, and csv2df to load a file into a Pandas data frame. CleverCSV is available on GitHub and on PyPI. Furthermore, the research that led to CleverCSV is fully reproducible and publicly available (if you care about such a thing! :))", "Data wrangling and data cleaning are some of the most time consuming tasks for data scientists, and they\u2019re not the most fun either. In fact, survey\u2019s show that data scientists spend the majority of their time on these menial tasks, while also being the part of their job they dislike the most! CleverCSV is a tool that aims to solve part of this problem, by giving data scientists a way to save time on the boring task of correctly loading data from messy CSV files. I hope that you give it a try!", "Originally published at https://gertjanvandenburg.com on November 26, 2019.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Researcher interested in the theoretical and applied aspects of machine learning. Currently working on automating the boring parts of data science using AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2ef829aa441d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gertjanvandenburg?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gertjanvandenburg?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": "Gerrit J.J. van den Burg"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb57b61b6ad8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&user=Gerrit+J.J.+van+den+Burg&userId=b57b61b6ad8c&source=post_page-b57b61b6ad8c----2ef829aa441d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ef829aa441d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ef829aa441d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jankolar", "anchor_text": "Jan Kolar"}, {"url": "https://gertjanvandenburg.com/blog/csv/unsplash.com", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/orgesleka/imdbmovies", "anchor_text": "This dataset on Kaggle"}, {"url": "https://docs.python.org/3/library/csv.html#csv.Sniffer", "anchor_text": "the documentation for the Python standard csv library"}, {"url": "https://github.com/alan-turing-institute/clevercsv", "anchor_text": "CleverCSV"}, {"url": "https://rdcu.be/bLVur", "anchor_text": "research"}, {"url": "https://github.com/alan-turing-institute/CleverCSV", "anchor_text": "on GitHub"}, {"url": "https://pypi.org/project/clevercsv/", "anchor_text": "PyPI"}, {"url": "https://github.com/alan-turing-institute/CSV_Wrangling", "anchor_text": "fully reproducible and publicly available"}, {"url": "https://visit.figure-eight.com/data-science-report.html", "anchor_text": "survey\u2019s show"}, {"url": "https://tools.ietf.org/html/rfc4180", "anchor_text": "RFC4180"}, {"url": "https://rdcu.be/bLVur", "anchor_text": "Wrangling Messy CSV Files by Detecting Row and Type Patterns"}, {"url": "https://gertjanvandenburg.com/blog/csv", "anchor_text": "https://gertjanvandenburg.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2ef829aa441d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-wrangling?source=post_page-----2ef829aa441d---------------data_wrangling-----------------", "anchor_text": "Data Wrangling"}, {"url": "https://medium.com/tag/data-cleaning?source=post_page-----2ef829aa441d---------------data_cleaning-----------------", "anchor_text": "Data Cleaning"}, {"url": "https://medium.com/tag/csv?source=post_page-----2ef829aa441d---------------csv-----------------", "anchor_text": "Csv"}, {"url": "https://medium.com/tag/csv-import?source=post_page-----2ef829aa441d---------------csv_import-----------------", "anchor_text": "Csv Import"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2ef829aa441d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&user=Gerrit+J.J.+van+den+Burg&userId=b57b61b6ad8c&source=-----2ef829aa441d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2ef829aa441d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&user=Gerrit+J.J.+van+den+Burg&userId=b57b61b6ad8c&source=-----2ef829aa441d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ef829aa441d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2ef829aa441d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2ef829aa441d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2ef829aa441d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2ef829aa441d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2ef829aa441d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2ef829aa441d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gertjanvandenburg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gertjanvandenburg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gerrit J.J. van den Burg"}, {"url": "https://medium.com/@gertjanvandenburg/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb57b61b6ad8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&user=Gerrit+J.J.+van+den+Burg&userId=b57b61b6ad8c&source=post_page-b57b61b6ad8c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fb57b61b6ad8c%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-messy-csv-files-2ef829aa441d&user=Gerrit+J.J.+van+den+Burg&userId=b57b61b6ad8c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}