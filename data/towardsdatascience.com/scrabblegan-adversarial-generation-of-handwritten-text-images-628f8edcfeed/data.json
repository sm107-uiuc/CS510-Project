{"url": "https://towardsdatascience.com/scrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed", "time": 1683007158.3007848, "path": "towardsdatascience.com/scrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed/", "webpage": {"metadata": {"title": "ScrabbleGAN \u2014 Adversarial Generation of Handwritten Text Images | by Nikolai K\u00f6rber | Towards Data Science", "h1": "ScrabbleGAN \u2014 Adversarial Generation of Handwritten Text Images", "description": "This article presents an open source project/ tutorial for the adversarial generation of handwritten text images based on ScrabbleGAN."}, "outgoing_paragraph_urls": [{"url": "https://github.com/Nikolai10/scrabble-gan", "anchor_text": "open source project", "paragraph_index": 0}, {"url": "http://www.fki.inf.unibe.ch/databases/iam-handwriting-database", "anchor_text": "IAM Handwriting Database", "paragraph_index": 0}, {"url": "https://github.com/Nikolai10/scrabble-gan", "anchor_text": "GitHub repo", "paragraph_index": 1}, {"url": "https://www.tensorflow.org/guide/keras/functional", "anchor_text": "functional API", "paragraph_index": 5}, {"url": "https://www.tensorflow.org/tutorials/customization/custom_training", "anchor_text": "custom training loop", "paragraph_index": 5}, {"url": "https://www.tensorflow.org/tutorials/generative/dcgan", "anchor_text": "Deep Convolutional Generative Adversarial Network", "paragraph_index": 5}, {"url": "http://www.fki.inf.unibe.ch/DBs/iamDB/data/ascii/words.txt", "anchor_text": "denoted as \u2018ok\u2019", "paragraph_index": 8}, {"url": "https://github.com/ajbrock/BigGAN-PyTorch", "anchor_text": "BigGAN-Pytorch", "paragraph_index": 11}, {"url": "https://github.com/google/compare_gan/blob/master/compare_gan/architectures/resnet_biggan.py", "anchor_text": "resnet_biggan", "paragraph_index": 11}, {"url": "https://github.com/google/compare_gan", "anchor_text": "google/compare_gan", "paragraph_index": 11}, {"url": "https://github.com/google/gin-config", "anchor_text": "Gin", "paragraph_index": 11}, {"url": "https://github.com/Nikolai10/crnn-tf2", "anchor_text": "CRNN-Tf2", "paragraph_index": 12}, {"url": "https://github.com/Nikolai10/scrabble-gan", "anchor_text": "GitHub repo", "paragraph_index": 13}, {"url": "https://github.com/google/compare_gan/blob/master/compare_gan/gans/loss_lib.py", "anchor_text": "compare_gan/gans/loss_lib.py", "paragraph_index": 14}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/backend/ctc_batch_cost", "anchor_text": "CTC loss", "paragraph_index": 14}, {"url": "https://superuser.com/questions/136236/where-on-disk-does-the-macos-system-wide-dictionary-store-the-list-of-words-i-ad", "anchor_text": "macOS word list", "paragraph_index": 15}, {"url": "https://aws.amazon.com/de/ec2/instance-types/p3/", "anchor_text": "AWS p3.2xlarge instance", "paragraph_index": 18}], "all_paragraphs": ["This article presents an open source project for the adversarial generation of handwritten text images, that builds upon the ideas presented in [1, 2] and leverages the power of generative adversarial networks (GANs [3]). Although GANs (in particular cGANs [4] and variations) have received a lot of attention in the research community, little work has focused on image generation conditioned on sequences so far (not to be confused with text to image learning tasks such as [5] or [6]). Moreover, recent works ([1, 2]) have not shared their source/ evaluation code, which makes a clean comparison difficult as it is not always clear which component has led to an improvement. In this work the model/ software is evaluated on the IAM Handwriting Database and is made available to the community for further experiments.", "Note: this article is not intended to explain state-of-the-art machine learning algorithms, but rather to highlight the design decisions made in this project. Technical details are well documented in the GitHub repo and can be found in the respective references.", "In many institutions (e.g. in healthcare or finance) handwriting is still the predominant method of data collection. Although Optical character recognition (OCR) is nowadays often considered as solved, (offline) Handwriting Recognition (HWR) still remains challenging and thus complicate automatic data processing. In contrast to printed text, handwriting greatly varies in style (handwriting is known to be as unique and unmistakable as a fingerprint) and therefore requires large-scale training data. As a consequence, and due to the popularity and success of GANs, more and more works have focused on extending existing datasets. In the following section two recent papers (which this article heavily relies on) are introduced.", "In [1], the authors have trained an Auxiliary Classifier GAN (AC-GAN [7]) in order to extend two benchmark datasets (French, Arabic). The main idea here is to embed each word into a 128-dimensional feature vector (similar to [5]), which is then fed into a BigGAN [8] network architecture. In order to control the textual content of the generated images a CRNN [9] is trained as auxiliary classifier. The gradients stemming from R and D are balanced (to account for their different magnitude) and finally back-propagated to G:", "Although their work has shown promising results, several limitations still exist and are addressed in [2]:", "In this work the functional API and a custom training loop is used. The general structure is based on the TensorFlow tutorial on Deep Convolutional Generative Adversarial Network; the main differences are highlighted in the following section.", "First, the IAM Handwriting (words) Database ist converted into the following format:", "where bucket x holds all samples with transcription length x and img_i.txt contains the ground truth annotation (transcription) for img_i.png.", "To reduce noise, only words ([a-zA-Z]) which were segmented correctly (denoted as \u2018ok\u2019) are considered in this work. Furthermore, words of size > bucket_size (here 10) are ignored to assert len(bucket) >> batch_size. In total, this preprocessing policy leads to 80.377 unique training samples.", "All images are reshaped to match the aspect ratio of each character proposed by [2]: (32, 16). E.g. a word of transcription length 10 has shape (32,160) px.", "At each training step, a batch of random words along its encoded transcriptions (of the same random bucket) is yielded to the respective models.", "Fundamentally, ScrabbleGAN is a mixture of the famous BigGAN and CRNN architecture. Although there are some open source implementations of BigGAN (e.g. BigGAN-Pytorch, resnet_biggan) \u2014 to the best of my knowledge \u2014 there is currently no \u201cofficial\u201d TF2 implementation available. As a result, I decided to rewrite a simplified version of the google/compare_gan in Tf2 myself. Similar to the original work, the code is configurable via Gin:", "The CRNN-model is based on CRNN-Tf2. All models are implemented making use of the fully convolutional paradigm as described in section 2, to allow for flexible input and output shapes. The final \u201cScrabbleGAN\u201d model is obtained by stacking these models together (composite model).", "For the sake of brevity, the interested reader is referred to the GitHub repo for more information.", "In this work both the \u201cnon_saturating\u201d and \u201chinge\u201d loss are considered, which are based on compare_gan/gans/loss_lib.py. For the CRNN part the CTC loss is used as usual.", "The training loop begins with the generator receiving a set of random seeds and transcriptions from a random word list (here: macOS word list) as input to produce a set of fake images. While D(real) and R(real) are computed separately, D(fake) and R(fake) are now computed through the composite model. The loss is then calculated for each of these models, and the gradients are used to update the discriminator, recognizer and composite model. E.g. the latter is updated as follows:", "Note: in this work, no gradient balancing has led to the best results (more information can be found in the respective references [1, 2].)", "Similar to [1, 2], R is trained only on real images, to prevent it from learning how to recognize generated (and potentially false) images.", "All experiments (different model configurations) were conducted using an AWS p3.2xlarge instance; each model was trained for 15 epochs. Here are some visual results:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F628f8edcfeed&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nikkoerber?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nikkoerber?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": "Nikolai K\u00f6rber"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F78f729b870d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&user=Nikolai+K%C3%B6rber&userId=78f729b870d6&source=post_page-78f729b870d6----628f8edcfeed---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F628f8edcfeed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F628f8edcfeed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@moroo", "anchor_text": "Moritz Schmidt"}, {"url": "https://unsplash.com/photos/UsTERdf7yEY", "anchor_text": "Unsplash"}, {"url": "https://github.com/Nikolai10/scrabble-gan", "anchor_text": "open source project"}, {"url": "http://www.fki.inf.unibe.ch/databases/iam-handwriting-database", "anchor_text": "IAM Handwriting Database"}, {"url": "https://github.com/Nikolai10/scrabble-gan", "anchor_text": "GitHub repo"}, {"url": "https://arxiv.org/pdf/1903.00277.pdf", "anchor_text": "source"}, {"url": "https://arxiv.org/pdf/2003.10557.pdf", "anchor_text": "source"}, {"url": "https://www.tensorflow.org/guide/keras/functional", "anchor_text": "functional API"}, {"url": "https://www.tensorflow.org/tutorials/customization/custom_training", "anchor_text": "custom training loop"}, {"url": "https://www.tensorflow.org/tutorials/generative/dcgan", "anchor_text": "Deep Convolutional Generative Adversarial Network"}, {"url": "http://www.fki.inf.unibe.ch/DBs/iamDB/data/ascii/words.txt", "anchor_text": "denoted as \u2018ok\u2019"}, {"url": "https://www.tensorflow.org/tutorials/generative/dcgan", "anchor_text": "DCGAN-Tutorial"}, {"url": "https://github.com/ajbrock/BigGAN-PyTorch", "anchor_text": "BigGAN-Pytorch"}, {"url": "https://github.com/google/compare_gan/blob/master/compare_gan/architectures/resnet_biggan.py", "anchor_text": "resnet_biggan"}, {"url": "https://github.com/google/compare_gan", "anchor_text": "google/compare_gan"}, {"url": "https://github.com/google/gin-config", "anchor_text": "Gin"}, {"url": "https://github.com/Nikolai10/crnn-tf2", "anchor_text": "CRNN-Tf2"}, {"url": "https://github.com/Nikolai10/scrabble-gan", "anchor_text": "GitHub repo"}, {"url": "https://github.com/google/compare_gan/blob/master/compare_gan/gans/loss_lib.py", "anchor_text": "compare_gan/gans/loss_lib.py"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/backend/ctc_batch_cost", "anchor_text": "CTC loss"}, {"url": "https://superuser.com/questions/136236/where-on-disk-does-the-macos-system-wide-dictionary-store-the-list-of-words-i-ad", "anchor_text": "macOS word list"}, {"url": "https://aws.amazon.com/de/ec2/instance-types/p3/", "anchor_text": "AWS p3.2xlarge instance"}, {"url": "https://arxiv.org/pdf/1903.00277.pdf", "anchor_text": "Adversarial Generation of Handwritten Text Images Conditioned on Sequences"}, {"url": "https://arxiv.org/pdf/2003.10557.pdf", "anchor_text": "ScrabbleGAN: Semi-Supervised Varying Length Handwritten Text Generation"}, {"url": "https://arxiv.org/abs/1406.2661", "anchor_text": "Generative Adversarial Networks"}, {"url": "https://arxiv.org/abs/1411.1784", "anchor_text": "Conditional Generative Adversarial Nets"}, {"url": "https://arxiv.org/pdf/1605.05396.pdf", "anchor_text": "Generative Adversarial Text to Image Synthesis"}, {"url": "https://arxiv.org/abs/1903.05854", "anchor_text": "MirrorGAN: Learning Text-to-image Generation by Redescription"}, {"url": "https://arxiv.org/pdf/1610.09585.pdf", "anchor_text": "Conditional Image Synthesis With Auxiliary Classifier GANs"}, {"url": "https://arxiv.org/abs/1809.11096", "anchor_text": "Large Scale GAN Training for High Fidelity Natural Image Synthesis"}, {"url": "https://arxiv.org/pdf/1507.05717.pdf", "anchor_text": "An End-to-End Trainable Neural Network for Image-based Sequence Recognition and Its Application to Scene Text Recognition"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----628f8edcfeed---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/generative-adversarial?source=post_page-----628f8edcfeed---------------generative_adversarial-----------------", "anchor_text": "Generative Adversarial"}, {"url": "https://medium.com/tag/handwriting?source=post_page-----628f8edcfeed---------------handwriting-----------------", "anchor_text": "Handwriting"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----628f8edcfeed---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F628f8edcfeed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&user=Nikolai+K%C3%B6rber&userId=78f729b870d6&source=-----628f8edcfeed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F628f8edcfeed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&user=Nikolai+K%C3%B6rber&userId=78f729b870d6&source=-----628f8edcfeed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F628f8edcfeed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F628f8edcfeed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----628f8edcfeed---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----628f8edcfeed--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----628f8edcfeed--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----628f8edcfeed--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----628f8edcfeed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nikkoerber?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nikkoerber?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nikolai K\u00f6rber"}, {"url": "https://medium.com/@nikkoerber/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F78f729b870d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&user=Nikolai+K%C3%B6rber&userId=78f729b870d6&source=post_page-78f729b870d6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffcfdd75f680&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscrabblegan-adversarial-generation-of-handwritten-text-images-628f8edcfeed&newsletterV3=78f729b870d6&newsletterV3Id=fcfdd75f680&user=Nikolai+K%C3%B6rber&userId=78f729b870d6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}