{"url": "https://towardsdatascience.com/how-can-we-explain-graph-neural-network-5031ea127004", "time": 1683007108.453386, "path": "towardsdatascience.com/how-can-we-explain-graph-neural-network-5031ea127004/", "webpage": {"metadata": {"title": "How to Explain Graph Neural Network \u2014 GNNExplainer | by Shanon Hong | Towards Data Science", "h1": "How to Explain Graph Neural Network \u2014 GNNExplainer", "description": "Graph Neural Network(GNN) is a type of neural network that can be directly applied to graph-structured data. My previous post gave a brief introduction on GNN. Readers may be directed to this post\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/datadriveninvestor/an-introduction-to-graph-neural-network-gnn-for-analysing-structured-data-afce79f4cfdc", "anchor_text": "this post", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1903.03894", "anchor_text": "this paper", "paragraph_index": 2}, {"url": "https://pytorch-geometric.readthedocs.io/en/latest/modules/nn.html?highlight=gnnexplainer#torch_geometric.nn.models.GNNExplainer", "anchor_text": "PyG website", "paragraph_index": 16}, {"url": "https://gist.github.com/hongxuenong/9f7d4ce96352d4313358bc8368801707", "anchor_text": "Github link", "paragraph_index": 25}], "all_paragraphs": ["Graph Neural Network(GNN) is a type of neural network that can be directly applied to graph-structured data. My previous post gave a brief introduction on GNN. Readers may be directed to this post for more details.", "Many research works have shown GNN\u2019s power for understanding graphs, but the way how and why GNN works still remains a mystery for most people. Unlike CNN, where we can extract activation of each layer to visualize the decisions of the network, in GNN it is hard to get a meaningful explanation of what features the network has learnt. Why does GNN determine a node is class A instead of class B? Why does GNN determine a graph is a chemical or molecule? It seems like GNN sees some useful structural information and determines are made upon these observations. But now the problem is, what observations does GNN see?", "GNNExplainer is introduced in this paper.", "Briefly speaking, it is trying to build a network to learn what a GNN has learnt.", "The main principle of GNNExplainer is by reducing redundant information in a graph which does not directly impact the decisions. To explain a graph, we want to know what are the crucial features or structures in the graph that affect the decisions of a neural network. If a feature is important, then the prediction should be altered largely by removing or replacing this feature with something else. On the other hand, if removing or altering a feature does not affect the prediction outcome, the feature is considered not essential and thus should not be included in the explanation for a graph.", "The primary objective for GNNExplainer is to generate a minimal graph that explains the decision for a node or a graph. To achieve this goal, the problem can be defined as finding a subgraph in the computation graph, that minimizes the difference in the prediction scores using the whole computation graph and the minimal graph. In the paper, this process is formulated as maximizing the mutual information(MI) between the minimal graph Gs and the computation graph G:", "Besides, there is a secondary objective: the graph needs to be minimal. Though it was also mentioned in the first objective, we need to have a method to formulate this objective as well. The paper addresses it by adding a loss for the number of edges. Therefore, the loss for GNNExplainer is literally the combination of prediction loss and edge size loss.", "Three types of explanations are discussed in the paper: the explanation for one node, the explanation for one class of nodes, and the explanation for a graph. The major difference is in the computation graphs.", "For an explanation on a single node, the computation graph is its k-hops neighbours, where k is the number of convolutions in the model.", "For an explanation on a class of nodes, the paper suggests selecting a reference node and using the same method to compute explanation. The reference node can be selected by taking the node whose features are closest to the mean features of all other nodes with the same class.", "For an explanation of the entire graph, the computation graph becomes the union of the computation graphs for all nodes in the graph. That makes the computation graph equivalent to the entire input graph.", "The learning of the minimal graph Gs is by learning a mask for edges and a mask for features. That is, for each edge in the computation graph, there exists a value in the edge_mask which determines the importance of the edge. Similarly, for each feature in the node feature, the feature_mask determines if the feature is important to the final decision.", "With all those concepts, we can summarize everything for a GNNExplainer:", "That\u2019s about everything we need to know before we can implement a GNNExplainer. To summarize up, we are trying to learn an edge_mask and a node_feature_mask which remove some edges and features from the computation graph while minimizing the difference in prediction score, the resultant graph is a minimal graph that explains the decision of the node or graph.", "I\u2019m going to implement this in Pytorch Geometric(PyG). One great advantage of PyG is that it updates very frequently and has many implementations of current models. Surprisingly I found GNNExplainer is already implemented in PyG library, which saves me a lot of time. Although it only works for node explanations, thanks to its open-source, it is not hard to change it to work for graph explanations as well.", "To start, we first need to install PyG. GNNExplainer is not yet in their current release (PyG 1.4.4) but the codes are already released their Github. So to get GNNExplainer, you must clone from their Github repository and install from there.", "The example code is provided on the PyG website. It is easy to follow so I\u2019m not going to show the code in this post. But the implementation details are something we want to check out and use it for graph classification thereafter.", "I\u2019m going to trace the code based on my short summary above. The example code passes node index, together with the full feature matrix and edge list to a GNNExplainer module.", "What\u2019s happening in GNNExplainer is exactly what we discussed in the previous section.", "To Explain a node, we first need to get its k-hop computation graph. This is done by __subgraph__() method in PyG.", "The hard_edge_mask removes all other edges outside the k-hop neighbourhood.", "2. Masks are initialized by __set_mask__() method and applied to every layer of the network.", "3. Initial prediction is performed using the trained model, then the prediction is used as a label to train the GNNExplainer.", "The current implementation is PyG is only for node explanation. But having understanding the principles behind, it isn\u2019t hard to rewrite the function for graph explanation.", "Only A few functions we need to replace: 1) we need to replace __subgraph__ function to obtain the computation graph for the entire graph. 2) we need to set masks for the entire graph. 3) We need to change the loss function to compute loss for graphs.", "Complete code implementation is available at this Github link.", "GNNExplainer provides a framework to visualize what a GNN model has learnt. However, the actual explanation result may not be good enough to explain a huge graph as search space for the optimal explanation is exponentially larger than a smaller one. Instead of fitting a neural network, other search techniques may also be applied to find the optimal explanation borrowing the same concepts and the performance is yet to be proved.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5031ea127004&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5031ea127004--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5031ea127004--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hongxuenong.medium.com/?source=post_page-----5031ea127004--------------------------------", "anchor_text": ""}, {"url": "https://hongxuenong.medium.com/?source=post_page-----5031ea127004--------------------------------", "anchor_text": "Shanon Hong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff044fc057968&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&user=Shanon+Hong&userId=f044fc057968&source=post_page-f044fc057968----5031ea127004---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5031ea127004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5031ea127004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/manuchi-1728328/?tab=popular&pagi=3", "anchor_text": "Manuchi"}, {"url": "https://pixabay.com/", "anchor_text": "Pixabay"}, {"url": "https://medium.com/datadriveninvestor/an-introduction-to-graph-neural-network-gnn-for-analysing-structured-data-afce79f4cfdc", "anchor_text": "this post"}, {"url": "https://arxiv.org/abs/1903.03894", "anchor_text": "this paper"}, {"url": "https://pytorch-geometric.readthedocs.io/en/latest/modules/nn.html?highlight=gnnexplainer#torch_geometric.nn.models.GNNExplainer", "anchor_text": "PyG website"}, {"url": "https://gist.github.com/hongxuenong/9f7d4ce96352d4313358bc8368801707", "anchor_text": "Github link"}, {"url": "https://arxiv.org/abs/1903.03894", "anchor_text": "https://arxiv.org/abs/1903.03894"}, {"url": "https://pytorch-geometric.readthedocs.io/en/latest/", "anchor_text": "https://pytorch-geometric.readthedocs.io/en/latest/"}, {"url": "https://medium.com/tag/graph-neural-networks?source=post_page-----5031ea127004---------------graph_neural_networks-----------------", "anchor_text": "Graph Neural Networks"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5031ea127004---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pattern-recognition?source=post_page-----5031ea127004---------------pattern_recognition-----------------", "anchor_text": "Pattern Recognition"}, {"url": "https://medium.com/tag/graph-theory?source=post_page-----5031ea127004---------------graph_theory-----------------", "anchor_text": "Graph Theory"}, {"url": "https://medium.com/tag/graph?source=post_page-----5031ea127004---------------graph-----------------", "anchor_text": "Graph"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5031ea127004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&user=Shanon+Hong&userId=f044fc057968&source=-----5031ea127004---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5031ea127004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&user=Shanon+Hong&userId=f044fc057968&source=-----5031ea127004---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5031ea127004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5031ea127004--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5031ea127004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5031ea127004---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5031ea127004--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5031ea127004--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5031ea127004--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5031ea127004--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5031ea127004--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5031ea127004--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5031ea127004--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5031ea127004--------------------------------", "anchor_text": ""}, {"url": "https://hongxuenong.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hongxuenong.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shanon Hong"}, {"url": "https://hongxuenong.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "201 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff044fc057968&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&user=Shanon+Hong&userId=f044fc057968&source=post_page-f044fc057968--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffdbc91fcf022&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-we-explain-graph-neural-network-5031ea127004&newsletterV3=f044fc057968&newsletterV3Id=fdbc91fcf022&user=Shanon+Hong&userId=f044fc057968&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}