{"url": "https://towardsdatascience.com/tidy-mail-merge-using-r-markdown-7c5a2ee1995e", "time": 1683016141.494432, "path": "towardsdatascience.com/tidy-mail-merge-using-r-markdown-7c5a2ee1995e/", "webpage": {"metadata": {"title": "Tidy Mail Merge Using R Markdown. Because Automating the Boring Stuff\u2026 | by Ted Lorenzen | Towards Data Science", "h1": "Tidy Mail Merge Using R Markdown", "description": "Businesses live and die by electronic mail in the modern world. Email (do you remember when we used to hyphenate that?) serves as the primary communication tool in most industries, and as a key\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.future-perfect.co.uk/grammar-tip/is-it-e-mail-email-e-mail-or-email/", "anchor_text": "that", "paragraph_index": 0}, {"url": "https://covidtracking.com/", "anchor_text": "https://covidtracking.com/", "paragraph_index": 4}, {"url": "https://www.r-bloggers.com/2020/06/rmarkdown-css-selector-tips/", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://cran.r-project.org/web/packages/taskscheduleR/vignettes/taskscheduleR.html", "anchor_text": "taskscheduleR", "paragraph_index": 9}, {"url": "https://www.goodreads.com/work/quotes/1925199", "anchor_text": "Cheaper by the Dozen", "paragraph_index": 11}], "all_paragraphs": ["Businesses live and die by electronic mail in the modern world. Email (do you remember when we used to hyphenate that?) serves as the primary communication tool in most industries, and as a key external communication tool in perhaps all industries.", "From a data science point of view, email is boring, too quotidian to be worthy of attention. But one thing that we can say about email that we can\u2019t say about a streamlit dashboard is that if we send a message to a stakeholder in email they will almost certainly at least glance at it. A passive resource like a dashboard requires analytics consumers to choose to go and get the results they want. But email can be actively pushed out to decision makers. This is a small difference, but it should not be underestimated.", "Of course, this doesn\u2019t mean we as data scientists want to be spending a lot of time drafting emails. We\u2019d much rather be reading articles on Medium (Amirite?). So we\u2019ll want to automate the process of customizing analytics reports in email for an arbitrarily long list of recipients.", "Interestingly, word processors solved this years ago with mail merge printing. The details varied by vendor, but effectively you could populate a table with names, addresses, and other individual mail specific details and then print (or save to a file) a separate message for each record in the table. While it might seem obvious that anything wordperfect could do in 1990, R can replicate in 2020, it is surprising how easy it is using the tidyverse, R markdown, and the R package blastula to email an arbitrarily long list of people with customized analytics.", "To work a concrete example, let\u2019s assume that we are tasked with sending daily covid19 new positive tests to three individuals. We\u2019ll source the data from https://covidtracking.com/ and create a friendly email with each state\u2019s chart at the bottom so that our data consumers don\u2019t have to work hard to see the current situation for their state. This will avoid each colleague from needing to open a separate file or go to a specific webportal. We can quickly and easily turn out a process to build emails that look like this:", "While this format isn\u2019t going to win any awards for aesthetics it is very clean and very low touch. And, since we\u2019ll be rendering R markdown to an html file, it\u2019s 100% customizable if we are willing to get into the html (perhaps using the pointers here).", "The first file we need to create is the mail template. In this case, this will be an R markdown document using the output type blastula_email and a key element to our success here is to create parameters in the YAML header block at the top of the file so that we can fill those values in with details that are different for each recipient.", "The rest of the file is very straightforward markdown, with a block to pull data, a block of text for the audience, and a ggplot call.", "The other key component here is an R script that will take a list of addressees and their pertinent details (in this case the state they are in, their name, and sign off to use with each), then render the markdown file into a message appropriate for each of them, and send it out. The tidyverse lmap() function (from the purrr package) allows us to store each person\u2019s details in a row of a tibble and then apply the blastula functions for knitting and emailing the messages without any explicit loops.", "Now, we still have to admit that sending these emails out isn\u2019t fully automatic, as each day we\u2019d have to go and run our R script. But 1) that means running one script and not writing potentially dozens of emails and 2) we can use a task scheduler to make it a \u2018no button\u2019 process (the fantastic taskscheduleR package will help with this on Windows machines).", "I encourage everyone to move to the fully automatic solution with scheduled jobs, but even without that step we can save ourselves multiple hours a week of drudgery with a hundred lines of code.", "\u201cSomeone once asked Dad: \u201cBut what do you want to save time for? What are you going to do with it?\u201d \u201cFor work, if you love that best,\u201d said Dad. \u201cFor education, for beauty, for art, for pleasure.\u201d He looked over the top of his pince-nez. \u201cFor mumblety-peg, if that\u2019s where your heart lies.\u201d\u2015 Ernestine Gilbreth Carey, Cheaper by the Dozen", "That\u2019s a win in my book!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019ve been untangling data and what it implies since before data science was a thing. Currently using analytics to advise the c-suite at a healthcare company."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7c5a2ee1995e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ted.lorenzen?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ted.lorenzen?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": "Ted Lorenzen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe218963b1eea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&user=Ted+Lorenzen&userId=e218963b1eea&source=post_page-e218963b1eea----7c5a2ee1995e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c5a2ee1995e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c5a2ee1995e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@carolran?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Carol Jeng"}, {"url": "https://unsplash.com/s/photos/mail?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "http://www.future-perfect.co.uk/grammar-tip/is-it-e-mail-email-e-mail-or-email/", "anchor_text": "that"}, {"url": "https://covidtracking.com/", "anchor_text": "https://covidtracking.com/"}, {"url": "https://www.r-bloggers.com/2020/06/rmarkdown-css-selector-tips/", "anchor_text": "here"}, {"url": "https://cran.r-project.org/web/packages/taskscheduleR/vignettes/taskscheduleR.html", "anchor_text": "taskscheduleR"}, {"url": "https://www.goodreads.com/work/quotes/1925199", "anchor_text": "Cheaper by the Dozen"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----7c5a2ee1995e---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7c5a2ee1995e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&user=Ted+Lorenzen&userId=e218963b1eea&source=-----7c5a2ee1995e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7c5a2ee1995e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&user=Ted+Lorenzen&userId=e218963b1eea&source=-----7c5a2ee1995e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c5a2ee1995e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7c5a2ee1995e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7c5a2ee1995e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7c5a2ee1995e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ted.lorenzen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ted.lorenzen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ted Lorenzen"}, {"url": "https://medium.com/@ted.lorenzen/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe218963b1eea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&user=Ted+Lorenzen&userId=e218963b1eea&source=post_page-e218963b1eea--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5ae3efbf67ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftidy-mail-merge-using-r-markdown-7c5a2ee1995e&newsletterV3=e218963b1eea&newsletterV3Id=5ae3efbf67ec&user=Ted+Lorenzen&userId=e218963b1eea&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}