{"url": "https://towardsdatascience.com/classifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21", "time": 1683013829.5783832, "path": "towardsdatascience.com/classifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21/", "webpage": {"metadata": {"title": "Classifying Parkinson\u2019s disease through image analysis: Part 2 | by Robin T. White, PhD | Towards Data Science", "h1": "Classifying Parkinson\u2019s disease through image analysis: Part 2", "description": "In my previous post, I outlined some manually obtained features such as number of intersection and end-points, line thickness, standard deviation, etc. In this post, we will apply those features to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/classifying-parkinsons-disease-through-image-analysis-2e7a152fafc9", "anchor_text": "post", "paragraph_index": 0}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5592741/", "anchor_text": "original paper", "paragraph_index": 1}, {"url": "https://github.com/robintwhite", "anchor_text": "Github", "paragraph_index": 16}], "all_paragraphs": ["In my previous post, I outlined some manually obtained features such as number of intersection and end-points, line thickness, standard deviation, etc. In this post, we will apply those features to try and classify two sets of drawings into either healthy or Parkinson\u2019s for wave and spiral type. In addition, we will also look at two other methods of classification using more advanced machine learning approaches: namely feature extraction combined with logistic regression; as well as a custom, trained-from-scratch convolutional model.", "Before we begin, disclaimer that this is not meant to be any kind of medical study or test. Please refer to the original paper for details on the actual experiment, which I was not a part of.Zham P, Kumar DK, Dabnichki P, Poosapadi Arjunan S, Raghav S. Distinguishing Different Stages of Parkinson\u2019s Disease Using Composite Index of Speed and Pen-Pressure of Sketching a Spiral. Front Neurol. 2017;8:435. Published 2017 Sep 6. doi:10.3389/fneur.2017.00435.", "One thing that is important to decide when doing a project like this is, what are the goals? Here, there are two:1. Obtain an understanding of the observable differences between sketch types (healthy or Parkinson\u2019s) for wave and spiral images.2. Create a classifier with high accuracy to determine if a patient is likely to have Parkinson\u2019s or not.As I mentioned in my previous post, one limitation with going straight to a neural network model is that it is a black-box classifier for the most part. We lose the understanding of what exactly are the fundamental differences in the drawings caused by symptoms of Parkinson\u2019s. This is where our first classifier is used, which actually targets both goals. We will start there.", "The title of this section says it all. I use a Random Forest classifier on the obtained features in my last post. Explicitly, the features we will be using, which are calculated for each image and stored in a pandas dataframe are:- \u2018mean_thickness\u2019; \u2018std_thickness\u2019; \u2018number_pixels\u2019; \u2018number_edgepoints\u2019; \u2018number_intersections\u2019.A trick I have found is also incorporating some non-linearity by creating interaction features, where each feature is multiplied by each other feature. For example: mean_thickness * number_intersections. This increases the number of features to be 15.We also have to remember to standardize each feature. This places the mean at 0. Essentially we subtract the mean and divide by the standard deviation for each feature column. Finally, we have to create a one-hot-coding for our target class. This is only a binary classification, so this will suffice. This will transform our \u2018healthy\u2019 or \u2018parkinson\u2019 label to a 0, or 1.We also make sure to separate our training data from our test data.That\u2019s it! We can pass our feature columns into a Random Forest classifier. It is important to note here as well, that we need separate models for the wave and spiral datasets. An obvious, but important note. Here are the results for wave:", "There are a number of nice advantages that the Random Forest classifier provide, the main one I am using here is the ability to give a list of the most impactful features. Here they are in order of appearance:", "In my last post, I asked, \u2018based on the results we had seen, which would we guess would be the most important?\u2019. One advantage of machine learning is that we can assign these non-linearity interactions that would potentially be difficult for us to predict. Also, we can see the impact is different for each type of drawing. The accuracy is not bad on the wave set, at 80% but quite low on the spiral set at 67% \u2014 still better than chance (50%). Clearly, there could be some fine tuning of the features then for the spiral set to achieve a better accuracy. However, using Random Forest we can now observe how important certain parts of the drawing are. Certainly the waviness identified through end-points and number of pixels is prominent in both wave and spiral models.", "In this next section we will pass our images first through the ResNet50 model trained on ImageNet, but leaving the top of the layer off. We can do this easily using tf.keras:", "When an image is passed through this, it will result in 2048 * 7 * 7 \u2018features\u2019 \u2014 numbers that classify the image. This is the number in the final layer of ResNet50. We can then pass this large vector through Logistic Regression to obtain a classification \u2014 a very quick and efficient way to obtain pretty decent accuracy, without every really training anything. One important note is that you have to first pass the images through some pre-processing to get into a suitable format. The size required for this model is 224 x 224. The tensor shape should be (N, 224, 224, 3), where N is the number of samples. There is a predefined prepossessing function to subtract the mean with imagenet_utils.preprocess_input. To give credit, I learned this technique from Adrian Rosebrock in the Practitioners Deep Learning for Computer Vision book.", "Once we have our features, and associated labels, stored in a dataframe, we can pass these to Logistic Regression. Essentially, the idea here, is that in this very high dimensional representation of the images, there should be a clear division. And well, I think that is correct given the accuracy:", "Definite improvement over our manually created model of just 15 features, also this one required the least amount of effort \u2014 but we also don\u2019t obtain much information other than the classification.", "In our last method we build a custom model and train from scratch. We have a very few number of training examples \u2014 just 72, so we use augmentation. During training I created a validation set which was 20% of the training set, and predicted on the untouched 30 images I have been comparing to so far. Below is a summary of the Spiral model. I downsample the images by a factor of 2 and also convert to greyscale. The Wave model is the exact same but the image size is different. I also apply a preprocessing function for contrast stretching and normalization. For details on the augmentation, callbacks etc. please refer to my code instead as this is beyond the scope of this post. Optimization was done using Adam.", "And here is the training board:", "Although we achieve the same accuracy on the wave set as with the ResNet50 feature extraction, we get much better improvement on the spiral set. We also only have 30 images in our training set, which is pretty small. With a higher number we could see closer to the validation accuracy for both which was around 95% in each for the best model.", "Here is a final summary of the results on the same test set for the different approaches:", "Looking at the images I am quite happy with the performance, some images I would not be able to tell the difference\u2026 Some more feature engineering could bump the Random Forest manual model but I will leave that to you.", "If you felt that any part of this post provided some useful information or just a bit of inspiration please follow me for more.", "You can find the source code on my Github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Computer Vision and Machine Learning. Applications Development Scientist"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fddbbf05aac21&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@robint.white90?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": "Robin T. White, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5eb85d3a614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=post_page-c5eb85d3a614----ddbbf05aac21---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fddbbf05aac21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fddbbf05aac21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/classifying-parkinsons-disease-through-image-analysis-2e7a152fafc9", "anchor_text": "post"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5592741/", "anchor_text": "original paper"}, {"url": "https://ozh.github.io/ascii-tables/", "anchor_text": "https://ozh.github.io/ascii-tables/"}, {"url": "https://github.com/robintwhite", "anchor_text": "Github"}, {"url": "https://towardsdatascience.com/classifying-parkinsons-disease-through-image-analysis-2e7a152fafc9", "anchor_text": "Classifying Parkinson\u2019s disease through image analysis: Part 1"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ddbbf05aac21---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----ddbbf05aac21---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----ddbbf05aac21---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/medical?source=post_page-----ddbbf05aac21---------------medical-----------------", "anchor_text": "Medical"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ddbbf05aac21---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fddbbf05aac21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=-----ddbbf05aac21---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fddbbf05aac21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=-----ddbbf05aac21---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fddbbf05aac21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fddbbf05aac21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ddbbf05aac21---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ddbbf05aac21--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Robin T. White, PhD"}, {"url": "https://medium.com/@robint.white90/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5eb85d3a614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=post_page-c5eb85d3a614--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3f1d8826832f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-part-2-ddbbf05aac21&newsletterV3=c5eb85d3a614&newsletterV3Id=3f1d8826832f&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}