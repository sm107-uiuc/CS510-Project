{"url": "https://towardsdatascience.com/classification-metrics-everyone-should-know-b67fd0044c0c", "time": 1683006809.0416691, "path": "towardsdatascience.com/classification-metrics-everyone-should-know-b67fd0044c0c/", "webpage": {"metadata": {"title": "Classification Metrics Data People Should Know | by Jeff Hale | Towards Data Science", "h1": "Classification Metrics Data People Should Know", "description": "Learning classification metrics can be a foggy mess. \u2601\ufe0f There are lots of metrics. Many sound alike. Sometimes there are two names for the same thing. Sometimes there are five. \ud83e\udd26\u200d\u2640\ufe0f\ud83e\udd26\u200d\u2642\ufe0f This series\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/classes.html", "anchor_text": "sklearn.metrics", "paragraph_index": 4}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.plot_confusion_matrix.html", "anchor_text": "plot_confusion_matrix", "paragraph_index": 18}, {"url": "https://medium.com/u/a9e4103439ec?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "Kevin Markham", "paragraph_index": 18}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.recall_score.html", "anchor_text": "accuracy_score", "paragraph_index": 38}, {"url": "https://towardsdatascience.com/the-3-most-important-basic-classification-metrics-3368dd425f74", "anchor_text": "next article", "paragraph_index": 41}, {"url": "https://memorablepython.com", "anchor_text": "Python", "paragraph_index": 43}, {"url": "https://memorablesql.com", "anchor_text": "SQL", "paragraph_index": 43}, {"url": "https://memorabledocker.com", "anchor_text": "Docker", "paragraph_index": 43}, {"url": "https://medium.com/@jeffhale", "anchor_text": "here", "paragraph_index": 43}, {"url": "https://dataawesome.com", "anchor_text": "https://dataawesome.com", "paragraph_index": 45}], "all_paragraphs": ["Learning classification metrics can be a foggy mess. \u2601\ufe0f There are lots of metrics. Many sound alike. Sometimes there are two names for the same thing. Sometimes there are five. \ud83e\udd26\u200d\u2640\ufe0f\ud83e\udd26\u200d\u2642\ufe0f", "This series of articles is designed to lift the fog.\ud83c\udf24 It\u2019s a guide to help you understand, use, and remember the seven most common classification metrics.", "Today we\u2019ll explore the foundation that everyone needs. Data scientists and statisticians must have the foundation down cold before moving on to more advanced metrics. \ud83d\ude00", "In binary classification problems there are two possible outcomes: true or false, 1 or 0, buy or don\u2019t buy, infected or not infected, etc. In this article we\u2019ll focus on binary classification, because it\u2019s common and this stuff is confusing enough with just two outcome classes. \ud83d\ude09", "The metrics we\u2019ll look at are in the scikit-learn Python package. Each function is imported from the sklearn.metrics module.", "We\u2019ll use a few hypothetical classification tasks to illustrate how these metrics work. Let\u2019s start with predicting whether a website visitor would purchase a shirt at Jeff\u2019s Awesome Hawaiian Shirt store! \ud83c\udfdd+\ud83c\udf3a+\ud83d\udc55+\ud83d\udcb5", "The confusion matrix is the foundation on which the metrics are built. It shows how many of your model\u2019s predictions were correct and how many were incorrect, organized by the actual positive and negative outcomes.", "One axis of the matrix is the real-life results \u2014 the positive and negative cases. In our example, if the visitor buys a shirt, that\u2019s an actual positive. \ud83d\ude00 If the visitor does NOT buy a shirt, that\u2019s an actual negative. \u2639\ufe0f", "The other axis is your model\u2019s predictions. If your model predicted that the visitor would buy a shirt, that\u2019s a positive prediction. If your model predicted that the visitor would NOT buy a shirt, that\u2019s a negative prediction.", "Combine the predictions and the actual results and you get the four quadrants:", "Or TP, TN, FP, and FN for short. \ud83d\ude01", "Let\u2019s break these four groups down:", "True refers to cases where the model\u2019s prediction was right. False refers to cases where the model\u2019s prediction was wrong. You want your model to predict well, so you want more Trues and fewer Falses. \ud83d\udc4d", "If the group has Positive in the name, those are people the model predicted would purchase. If the group has Negative in the name, those are people the model predicted would NOT purchase.", "Understanding these four groups is key. Make sure you can explain the four quadrants in your own words before moving on. \u261d\ufe0f", "Note that other confusion matrix diagrams might show the rows and columns in a different order. Unfortunately, there is no standard order. \u2639\ufe0f", "Here\u2019s the Python code to create the four outcome variables from the confusion matrix (with the numpy library imported and confusion_matrix imported from sklearn.metrics):", "This code is passing the ground truth (y_test), and the predictions to the confusion_matrix function, flattening the results with .ravel(), and then unpacking the results into four variables.", "You can make a prettier plot of a confusion matrix with scikit-learn\u2019s new plot_confusion_matrix function. Hat tip to Kevin Markham. \ud83e\udde2", "Here\u2019s the code I used to make this confusion matrix (with matplotlib.pyplot imported as plt and plot_confusion_matrix imported from sklearn.metrics):", "Notice that you must pass the estimator first. I added some additional arguments to show the labels and make the plot prettier. If you want to change the output values so they aren\u2019t in scientific notation format, the values_format argument can solve your problem. \ud83c\udf89", "Now let\u2019s see how to use these four numbers from the confusion matrix to make our most common classification metric.", "The term accuracy is often used to mean \u201cgood performance\u201d in general conversation, but it has a specific definition when in the classification metrics domain. The accuracy score answers the question:", "How many times were you right?", "Accuracy = (True Positives + True Negatives ) / All the Observations", "Here are hypothetical results from our model\u2019s predictions of whether visitors would make a purchase at Jeff\u2019s Hawaiian shirt store. \ud83c\udf3a\ud83d\udc55", "The model predicted 130 purchases and 70 non-purchases. There were actually 100 purchases and 100 non-purchases.", "Let\u2019s calculate the accuracy score. Add up the True Positives and the True Negatives and divide by the total number of observations.", "Looks like the model predicted 130 out of 200 cases correctly for an accuracy of 65%. That doesn\u2019t sound terrible. \ud83d\ude00", "But we don\u2019t really know how well our model did until we compare it to another model\u2019s predictions. The most basic alternative model is a simple decision rule that predicts a purchase 50% of the time. Our model did better than a 50% baseline, so that\u2019s something. \ud83d\ude09", "Note that the best possible accuracy score is 1 (100%), when the model predicts everything correctly. The worst possible score is 0, when the model predicts nothing correctly.", "Now let\u2019s look at what can happen when the outcome classes are imbalanced.", "Let\u2019s say you work for a bank \ud83c\udfe6 and want to detect fraud in credit card transactions. You have 1,000 transactions to predict. You build a machine learning model to predict which ones are fraudulent and here\u2019s the resulting confusion matrix:", "Our four confusion matrix values look like this:", "The model predicted 3 cases were fraudulent, when really 9 cases were fraudulent.", "But wait. Hold your horses. What\u2019s missing? \ud83e\udd14", "The model misclassified 8 out of 9 of the actual fraud cases! We missed 8 out of the 9 things we were trying to find! That\u2019s no good. \u2639\ufe0f", "The 99% accuracy score doesn\u2019t reflect how well the model did at its job. In fact, it would mislead many people if all they only saw was the accuracy score. Many folks don\u2019t know to ask whether the classes were balanced. This is one of the ways that people can intentionally or unintentionally mislead with statistics. \u261d\ufe0f", "In some good news, you don\u2019t need to calculate the accuracy by hand in scikit-learn. Accuracy is the default classification scoring metric. Additionally, you can use the function accuracy_score to find the accuracy with any set of predictions and ground truth values. \ud83c\udf89", "Accuracy weights all the quadrants of the confusion matrix equally. It\u2019s a good summary statistic when there are relatively equal numbers of both outcome classes. When you care more about avoiding false positives or false negatives you\u2019ll want to use one of the other metrics we\u2019ll explore in the next article.", "You definitely want to know the term accuracy and its risk of misleading with imbalanced data. \ud83d\ude00", "You\u2019ve learned about the confusion matrix and accuracy, the most foundational classification terms for a data scientist to know. In the next article we\u2019ll explore three basic metrics that you definitely want to know, but that can be tricky to keep straight.", "I hope you found this introduction to the fundamental parts of classification metrics to be helpful! If you did, please share it on your favorite social media so other folks can find it, too. \ud83d\ude00", "I write about Python, SQL, Docker, data science, and other tech topics. If any of that\u2019s of interest to you, follow me and read more here. \ud83d\udc4d", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about data science. Join my Data Awesome mailing list to stay on top of the latest data tools and tips: https://dataawesome.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb67fd0044c0c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jeffhale.medium.com/?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "Jeff Hale"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F451599b1142a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&user=Jeff+Hale&userId=451599b1142a&source=post_page-451599b1142a----b67fd0044c0c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb67fd0044c0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb67fd0044c0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/modules/classes.html", "anchor_text": "sklearn.metrics"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.plot_confusion_matrix.html", "anchor_text": "plot_confusion_matrix"}, {"url": "https://medium.com/u/a9e4103439ec?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "Kevin Markham"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.recall_score.html", "anchor_text": "accuracy_score"}, {"url": "https://towardsdatascience.com/the-3-most-important-basic-classification-metrics-3368dd425f74", "anchor_text": "next article"}, {"url": "https://memorablepython.com", "anchor_text": "Python"}, {"url": "https://memorablesql.com", "anchor_text": "SQL"}, {"url": "https://memorabledocker.com", "anchor_text": "Docker"}, {"url": "https://medium.com/@jeffhale", "anchor_text": "here"}, {"url": "https://dataawesome.com", "anchor_text": ""}, {"url": "https://medium.com/tag/data-science?source=post_page-----b67fd0044c0c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----b67fd0044c0c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b67fd0044c0c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----b67fd0044c0c---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b67fd0044c0c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb67fd0044c0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&user=Jeff+Hale&userId=451599b1142a&source=-----b67fd0044c0c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb67fd0044c0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&user=Jeff+Hale&userId=451599b1142a&source=-----b67fd0044c0c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb67fd0044c0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb67fd0044c0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b67fd0044c0c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b67fd0044c0c--------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeff Hale"}, {"url": "https://jeffhale.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "18K Followers"}, {"url": "https://dataawesome.com", "anchor_text": "https://dataawesome.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F451599b1142a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&user=Jeff+Hale&userId=451599b1142a&source=post_page-451599b1142a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe7ae6804f27a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-metrics-everyone-should-know-b67fd0044c0c&newsletterV3=451599b1142a&newsletterV3Id=e7ae6804f27a&user=Jeff+Hale&userId=451599b1142a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}