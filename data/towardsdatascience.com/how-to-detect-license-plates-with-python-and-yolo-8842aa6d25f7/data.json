{"url": "https://towardsdatascience.com/how-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7", "time": 1683016856.20665, "path": "towardsdatascience.com/how-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7/", "webpage": {"metadata": {"title": "How to Detect License Plates with Python and YOLO | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "How to Detect License Plates with Python and YOLO", "description": "Computer vision is everywhere \u2014 from facial recognition, manufacturing, agriculture, to self-driving vehicles. Today you\u2019ll enter the world of modern computer vision with a hands-on example. You will\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=DLngCtsG3bk", "anchor_text": "this one", "paragraph_index": 5}, {"url": "https://github.com/tzutalin/labelImg", "anchor_text": "LabelIMG", "paragraph_index": 9}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 56}, {"url": "https://betterdatascience.com/detect-license-plates-with-yolo/", "anchor_text": "https://betterdatascience.com", "paragraph_index": 57}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 59}], "all_paragraphs": ["Computer vision is everywhere \u2014 from facial recognition, manufacturing, agriculture, to self-driving vehicles. Today you\u2019ll enter the world of modern computer vision with a hands-on example. You will learn how to detect license plates with the YOLO algorithm.", "Why do you need YOLO? What\u2019s wrong with traditional computer vision approaches? Well, my friend, I have three words for you:", "Most articles use old-school computer vision methods to detect the plate. Thresholding and contour detection isn\u2019t enough in late 2020. Their algorithms work on images within the article due to hardcoded values, but fail to generalize. The result is an unusable garbage model.", "You are not here to build garbage. After reading this article, you will have a robust model for detecting license plates. It will work every time and in every weather condition.", "The article is structured as follows:", "Before we get started, I would like to take a moment to give a shoutout to all YOLO object detection tutorials, especially this one. Some of the solutions you\u2019ll see throughout the articles are based on them.", "There\u2019s one gotcha to this article. You\u2019ll have to put in the work. I have a solid database of a few hundred car images, but sharing it online wouldn\u2019t be ethical. For that reason, you\u2019ll have to collect the car images by yourself.", "We\u2019ll use a creative commons licensed image of a beautiful Mercedes Benz. It is excellent for demonstration and validation:", "You should collect images in various lighting conditions and taken from different angles.", "Dataset collected? Great, let\u2019s label it. We\u2019ll use a free tool called LabelIMG for the job. Please download it from GitHub, and follow instructions in the Readme to start it. Here\u2019s how to run the app on Mac:", "Executing these from Terminal opens this window:", "Next, click on the Open Dir icon on the left menu. Locate the folder where car images are stored. It should automatically open the first image:", "Make sure that the tag in the left panel says YOLO. Next, press the W key on the keyboard to open the RectBox tool. Draw a rectangle around the license plate, enter the tag, and click on OK:", "Neat. Make sure to hit CTRL + S to save the plate coordinates to a text file. A single file should look like this:", "I know what you are thinking now, and you are correct \u2014 you have to do this process for every image. It\u2019s a tedious and time-consuming task, but there\u2019s no way around it.", "The LabelIMG software will save a file with coordinates of the rectangle boxes for every image, alongside the class. It also saves a list of all classes to a file called classes.txt. If you open it, many of them are listed that are of no interest to you. Delete every except the license-plate:", "There\u2019s still one issue. We have a single class (license-plate), but the coordinate files say the class index is 15, which makes no sense. Just take a look at Image 5 and verify for yourself.", "We will load every coordinate file with Python to address this issue by changing the class index to 1. Here\u2019s the code snippet:", "Congratulations! You\u2019ve made it through the dataset gathering and preparation phase. You should now zip the files and continue to the next step.", "By now, you should have several hundreds of labeled car images. It is enough to train a good YOLO model, and that\u2019s what you will do next. You will train the model on Google Colab with a GPU backend.", "In Colab, it took around 2 hours to train the model in my case, but the time can change, depending on the GPU and the dataset size.", "You will train the model in the next seven steps.", "In a new Colab notebook, go to Runtime \u2014 Change runtime type, and select GPU in the dropdown:", "Click on Save, and you are good to go.", "In Google Drive, create a backup folder. I\u2019ve named mine yolo-license-plates. That\u2019s where model weights and configuration will get stored.", "In the first cell, execute the following code to mount Google Drive:", "Darknet is an open-source neural network framework that features a YOLO object detection system. To download it, execute this line from a code cell:", "Under darknet/Makefileyou\u2019ll have to configure a couple of things. Change values on the following lines:", "And save the file. These changes enable you to use GPU while training. You can now compile Darknet:", "It will take a couple of minutes, and you can proceed to the next step once done.", "To know how to set up the YOLO configuration file, you need to know how many classes there are. We only have one \u2014 license-plate, but this can change depending on the type of problem you are working on.", "Next, you need to calculate the number of batches and the number of filters. Here are the formulas:", "For safety reasons copy the YOLO configuration file:", "And make the following changes in cfg/yolov3-train.cfg:", "Next, we have to create two files \u2014 data/obj.names and data/obj.data. These files contain information on your class names and backup folders:", "Awesome! That\u2019s it configuration-wise. Let\u2019s now upload and prepare the images.", "Remember how I said you should have the images and their respective text file zipped? Well, now you\u2019ll understand why.", "Just drag and drop the zip file into a Files sidebar menu. It should look like this when done:", "The next step is to make a folder for images and unpack them:", "If everything went well, the data/obj folder should now contain the images and their respective text files.", "We are almost done here. What we have to do next is to create a data/train.txt file. It will contain paths to all training images:", "And finally, we have to download the pretrained Darknet convolutional network:", "It will take a couple of seconds to download, but once done, you have everything needed to begin training!", "Starting the training process now boils down to a single line of shell code:", "And now you wait. The training process could take hours, depending on the number of images. The weights are automatically saved to your Google Drive backup folder every 10\u201315 minutes.", "In the next section, we will create a script for finding and labeling license plates on images.", "This is the moment you\u2019ve been waiting for. The article is getting longer than I planned, so let\u2019s cut to the chase.", "In your Google Drive backup folder, you should have three files after the model is trained:", "Download them to a single folder on your machine and open JupyterLab. You can now copy the LicensePlateDetector class from the snippet below:", "Let\u2019s see the damn thing in action, finally:", "The above snippet makes an instance of the LicensePlateDetector class, detects the license plate, and crops it. Here\u2019s the visualization output:", "And there you have it \u2014 everything you worked for the last couple of hours (or days). The YOLO model is working flawlessly and is ready to be used for whatever use case you have.", "This was a long article. Congratulations to you if you managed to work through it in a single sitting. I know it took me days to understand how YOLO works and how to make a custom object detector.", "With the same logic, you can build any type of object detector. For instance, I\u2019ve reused the same images with different text labels to detect car color and car brand. There\u2019s no reason you couldn\u2019t do the same.", "Many people used YOLO to detect if people are wearing masks during this COVID-19 crisis. That sounds like an interesting project idea, so why don\u2019t you give it a try?", "For what did you use YOLO professionally? Please let me know in the comment section.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Originally published at https://betterdatascience.com on November 22, 2020.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8842aa6d25f7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----8842aa6d25f7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8842aa6d25f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8842aa6d25f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@mali?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "mali maeder"}, {"url": "https://www.pexels.com/photo/black-and-white-car-mercedes-oldtimer-105598/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://www.youtube.com/watch?v=DLngCtsG3bk", "anchor_text": "this one"}, {"url": "https://www.pexels.com/@mali?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "mali maeder"}, {"url": "https://www.pexels.com/photo/black-and-white-car-mercedes-oldtimer-105598/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://github.com/tzutalin/labelImg", "anchor_text": "LabelIMG"}, {"url": "https://github.com/AlexeyAB/darknet", "anchor_text": "https://github.com/AlexeyAB/darknet"}, {"url": "https://pjreddie.com/media/files/darknet53.conv.74", "anchor_text": "https://pjreddie.com/media/files/darknet53.conv.74"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://betterdatascience.com/detect-license-plates-with-yolo/", "anchor_text": "https://betterdatascience.com"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----8842aa6d25f7---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8842aa6d25f7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----8842aa6d25f7---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8842aa6d25f7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----8842aa6d25f7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8842aa6d25f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----8842aa6d25f7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8842aa6d25f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----8842aa6d25f7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8842aa6d25f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8842aa6d25f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8842aa6d25f7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8842aa6d25f7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-detect-license-plates-with-python-and-yolo-8842aa6d25f7&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}