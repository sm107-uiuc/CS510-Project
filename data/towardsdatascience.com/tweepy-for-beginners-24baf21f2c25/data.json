{"url": "https://towardsdatascience.com/tweepy-for-beginners-24baf21f2c25", "time": 1682996902.430651, "path": "towardsdatascience.com/tweepy-for-beginners-24baf21f2c25/", "webpage": {"metadata": {"title": "Tweepy for beginners. Using Twitter\u2019s API to build your own\u2026 | by Richard Chadwick | Towards Data Science", "h1": "Tweepy for beginners", "description": "A good way to build out your portfolio is with a natural language processing project, but like every project, the first step is getting hold of the data. Twitter can be a great resource for text\u2026"}, "outgoing_paragraph_urls": [{"url": "https://developer.twitter.com/", "anchor_text": "https://developer.twitter.com", "paragraph_index": 3}, {"url": "https://developer.twitter.com/en/apps", "anchor_text": "https://developer.twitter.com/en/apps", "paragraph_index": 4}, {"url": "https://tweepy.readthedocs.io/en/latest/", "anchor_text": "Tweepy", "paragraph_index": 5}, {"url": "https://docs.python.org/3/library/pprint.html", "anchor_text": "pprint", "paragraph_index": 13}, {"url": "https://tweepy.readthedocs.io/en/latest/api.html#tweepy-api-twitter-api-wrapper", "anchor_text": "appropriate API call", "paragraph_index": 18}, {"url": "https://tweepy.readthedocs.io/en/latest/api.html#API.user_timeline", "anchor_text": "user_timeline call", "paragraph_index": 18}, {"url": "https://tweepy.readthedocs.io/en/latest/api.html#tweepy-api-twitter-api-wrapper", "anchor_text": "different calls", "paragraph_index": 23}, {"url": "https://www.mpsontwitter.co.uk/list", "anchor_text": "every UK member of parliament", "paragraph_index": 25}, {"url": "https://twitter.com/dril", "anchor_text": "wint", "paragraph_index": 32}], "all_paragraphs": ["A good way to build out your portfolio is with a natural language processing project, but like every project, the first step is getting hold of the data. Twitter can be a great resource for text data; it has an API, credentials are easy to acquire and there is a number of python libraries available to help make calls to Twitter\u2019s API.", "Overall the resources are great, but they have a few quirks that can easily cause headaches, this article will help you navigate the process and avoid those headaches, consider it your pre-game paracetamol!", "Get yourself an account: A Twitter user account is a requirement to have a \u201cdeveloper\u201d account, so either register a new account or log-in to an existing one.", "Apply for a developer account: Head over to https://developer.twitter.com and apply for a developer account. If prompted, choose a personal or individual account rather than a business one. When submitting an intended use, ensure you answer is sufficiently descriptive, not just some junk or off the shelve copy paste statement.", "Create an app: Register an app at https://developer.twitter.com/en/apps. For the required website field you can put a placeholder. After you set up, go to \u2018Token and Keys\u2019 to generate an access token and secret. Along with the consumer API keys (already generated), these are the credentials we use to communicate with the Twitter API.", "There are a few libraries available for interacting with Twitter\u2019s API, I prefer Tweepy, it makes reliable calls and is well suited to dealing with tweets that exceed 140 characters.", "Just write pip install tweepy into your terminal.", "A few other libraries you may need (depending on what you want to do) are json, pandas, time and datetime. We\u2019ll see more about these later.", "API credentials, check. Tweepy installed, check. Time to see if it works, paste the code below in a notebook, sub in your own keys (watch for typos!) and run.", "Boom! You\u2019ve just made your first Twitter API call. You should now be looking at a stream of tweets from your accounts home timeline (the tweets of everyone your account follows). It will look something like this:", "Easy enough right? Wrong. We may be looking at some data, but it\u2019s not very useful in its current format, some tweets have been truncated and we only have data from accounts we already follow. If we want to build a structured data set for analysis we\u2019ll have to dive deeper into the API calls output\u2026 put on your hard hat!", "In a new cell type and execute public_tweets[0] to view the json associated with the first tweet, enjoy the output.", "This is no way to work through our data, try it for a few minutes and you\u2019ll be rereading lines and giving yourself a headache in no time.", "If you\u2019ve tried scraping before you\u2018ve probably used pprint (pretty print) to format data like this in a more readable way. Unfortunately pretty print can\u2019t help us here because public_tweets[0] is not a fundamental python data type, it\u2019s type is tweepy.models.Status, and the pprint module is not compatible.", "We need to make the tweepy output more readable so we can figure out what code we need to write to extract the data we want. We can do this as follows:", "Now you will be looking at something more structured:", "With this view, we can slowly work through the dictionaries and lists to determine what information is available and what keys are required to access them.", "If you just want primary data on tweets (the text, id, user id), accessing the information is relatively easy and reliable, as we already saw, we can access the text of a tweet with status.text when using the home timeline API call.", "Depending on the nature of your project and the data you need, you will need to choose the appropriate API call to collect it. The rest of this article focuses on using the user_timeline call, which (for a standard account) can retrieve up to 3200 most recent tweets of a user (as long as the profile is not locked).", "Here\u2019s where Tweepy gets a bit cumbersome. The json structure returned by an API call changes depending on the characteristics of the tweet (think regular tweet, retweet or quote tweet). Instead of providing a consistent format (where keys point to empty lists if no information is available), some keys are only present when there is data to point to.", "The easy way to overcome this is to settle for primary tweet information, but if you care about retweets and quotes then your data will be incomplete. If we want to build a rich dataset, we\u2019ll need to use try and except statements to handle this inconsistency.", "A good way to collect your data is by building a class that can make an API call and parses data in one go. It might look something like this:", "A few notes on this code:", "Make sure you take time to review this code against your version of the structured json output we made earlier and two additional outputs, one for each tweet type (regular, retweet and quote). By doing this you will gain a better understanding of how the data is accessed and be ready to create your own class for different calls or modify this class to collect additional data.", "This might have been step one for you, it might even be what led you to this article. You probably won\u2019t need much help here, but a few tips never hurt.", "Before starting a project find out if there are any existing resources available. Like every original data scientist, I picked up Tweepy with the intention of analysing politician\u2019s tweets, with a quick google I found a list of Twitter handles for every UK member of parliament with a Twitter account, this saved me a lot of grunt work.", "Be clear about your objectives, if it\u2019s to learn, make sure you look at other projects, it\u2019s good for motivation, getting ideas and can help point you in the right direction if you\u2019re stuck. If originality is your goal, again, look at other projects, you\u2019re best idea may be an addition to an existing project, embrace the open source philosophy.", "Once you have established who\u2019s tweets you want to collect, collect all the handles into a list of strings (do not include the @ preceding every Twitter username).", "Start your session by importing the libraries you need:", "Copy the code for the class, substituting in your own API credentials.", "Instantiate your miner, remember the default tweets collected is set to 20, you can alter this when you instantiate (the number of pages i.e. multiplies of result_limit that are collected with a call, is specified when making the call):", "Now you\u2019re all ready to make calls and have the data collected in a format you can use. To make a call:", "And there you have it. With a data frame of 3200 wint tweets, you\u2019re just a bit of EDA away from understanding the meaning of life!", "The last thing to remember is there is a limit on API calls, for a standard user this is 900 requests every 15 minutes. Don\u2019t worry, one tweet isn\u2019t one request, but it might be difficult to know when you\u2019re about to go over. For making multiple calls at once try this:", "Start making calls without the sleep timer, then if you get an error related to your call limit, play around with the sleep timer and counter if statement (that initiates the timer ever 25 calls) until you get something that works for you.", "Finally, note that the index for the all_tweets data frame is repeated for each handle. To make it unique for all tweets reset the index.", "That\u2019s everything! You\u2019re now ready to collect tweets on mass in a useable format. Happy hunting!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F24baf21f2c25&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@richchad?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@richchad?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": "Richard Chadwick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F74fe7ff65ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&user=Richard+Chadwick&userId=74fe7ff65ac&source=post_page-74fe7ff65ac----24baf21f2c25---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F24baf21f2c25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F24baf21f2c25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://developer.twitter.com/", "anchor_text": "https://developer.twitter.com"}, {"url": "https://developer.twitter.com/en/apps", "anchor_text": "https://developer.twitter.com/en/apps"}, {"url": "https://tweepy.readthedocs.io/en/latest/", "anchor_text": "Tweepy"}, {"url": "https://docs.python.org/3/library/pprint.html", "anchor_text": "pprint"}, {"url": "https://tweepy.readthedocs.io/en/latest/api.html#tweepy-api-twitter-api-wrapper", "anchor_text": "appropriate API call"}, {"url": "https://tweepy.readthedocs.io/en/latest/api.html#API.user_timeline", "anchor_text": "user_timeline call"}, {"url": "https://twitter.com/dril", "anchor_text": "wint"}, {"url": "https://tweepy.readthedocs.io/en/latest/api.html#tweepy-api-twitter-api-wrapper", "anchor_text": "different calls"}, {"url": "https://www.mpsontwitter.co.uk/list", "anchor_text": "every UK member of parliament"}, {"url": "https://twitter.com/dril", "anchor_text": "wint"}, {"url": "https://medium.com/tag/twitter?source=post_page-----24baf21f2c25---------------twitter-----------------", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/api?source=post_page-----24baf21f2c25---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/data-science?source=post_page-----24baf21f2c25---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/scraping?source=post_page-----24baf21f2c25---------------scraping-----------------", "anchor_text": "Scraping"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----24baf21f2c25---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F24baf21f2c25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&user=Richard+Chadwick&userId=74fe7ff65ac&source=-----24baf21f2c25---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F24baf21f2c25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&user=Richard+Chadwick&userId=74fe7ff65ac&source=-----24baf21f2c25---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F24baf21f2c25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F24baf21f2c25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----24baf21f2c25---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----24baf21f2c25--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----24baf21f2c25--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----24baf21f2c25--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----24baf21f2c25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@richchad?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@richchad?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richard Chadwick"}, {"url": "https://medium.com/@richchad/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F74fe7ff65ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&user=Richard+Chadwick&userId=74fe7ff65ac&source=post_page-74fe7ff65ac--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc06ab77db102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftweepy-for-beginners-24baf21f2c25&newsletterV3=74fe7ff65ac&newsletterV3Id=c06ab77db102&user=Richard+Chadwick&userId=74fe7ff65ac&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}