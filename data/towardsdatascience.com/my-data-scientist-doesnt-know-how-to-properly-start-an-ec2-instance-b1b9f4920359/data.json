{"url": "https://towardsdatascience.com/my-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359", "time": 1683004013.224998, "path": "towardsdatascience.com/my-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359/", "webpage": {"metadata": {"title": "\u201cMy data scientist doesn\u2019t know how to properly start an EC2 instance\u201d. | by Louis Douge | Towards Data Science", "h1": "\u201cMy data scientist doesn\u2019t know how to properly start an EC2 instance\u201d.", "description": "VPC, subnets or Internet Gateways refer to components that are at the heart of any AWS setup. However, data scientists often assume that it will be configured for them. Let\u2019s introduce the most important concepts and gain a clear understanding of their roles."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@louisdge/catching-up-with-the-cloud-trend-and-the-aws-ecosystem-dd512e8e2456", "anchor_text": "In my previous post", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/IP_address", "anchor_text": "Internet Protocol address", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Internet_protocol_suite", "anchor_text": "Internet Protocol Suite", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing", "anchor_text": "Classless Inter-Domain Routing", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Private_network", "anchor_text": "RFC1918 range", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/HTTPS", "anchor_text": "HTTPS", "paragraph_index": 33}, {"url": "https://en.wikipedia.org/wiki/Secure_Shell", "anchor_text": "SSH", "paragraph_index": 33}, {"url": "https://en.wikipedia.org/wiki/Ephemeral_port", "anchor_text": "ephemeral ports", "paragraph_index": 42}], "all_paragraphs": ["In my previous post, we set up a cloud infrastructure for a resilient and data-intensive app, at a high level as shown below. I recommend going through this post if you don\u2019t have a good understanding of AWS regions, AZs or High Availability zones.", "Let\u2019s use this example to explain the underlying Networking and Security concepts. Feel free to go to the AWS console and start the resources (most are free to start) as we present them. After reading this article, you\u2019ll be able to understand what you are actually doing when setting up an EC2 instance. More than that, it will also enable you to configure other AWS services and link them together. Also, parts are reasonably independent so feel free to jump straight to the concepts as the need arises.", "II. Communicating between your instances and networks", "First, remember that the Internet is fundamentally a huge network where nodes are made of servers or computers like yours, identified by a public Internet Protocol address or IP (like 104.16.122.127). These nodes communicate between themselves using the Internet Protocol Suite (TCP/IP).", "Make sure to familiarize yourself a bit with these concepts before continuing.", "When creating an app in the cloud such as the one presented above, we have exclusive access to a network residing inside a larger public network, created by the cloud provider. This is called a Virtual Private Cloud (VPC) and is the first thing to set up. This is the network inside which all our AWS resources will be running.", "Initially and by default, a VPC is isolated from any other network. It must reside in one AWS region. Then, you need to select some IP addresses that will be used to identify your instances running inside the VPC. This must be done when you start building your infrastructure. For instance, using the Classless Inter-Domain Routing (CIDR) notation, you could set aside these IP addresses (or CIDR block) for your future use: 176.13.0.0/16. This syntax designates all the IP addresses from 176.13.0.0 to 176.13.255.255.", "To make sure you do not overlap these addresses with public IP addresses currently in use on the Internet (like the one of medium.com for instance), you should choose them from the RFC1918 range. There shouldn\u2019t be an overlap with an existing VPC as well if you intend to connect the two! Choosing your IP addresses range is important as you won\u2019t be able to modify it once your VPC is created. So think about it carefully!", "Note that we\u2019ve used IPv4 addresses in our examples, similar concepts exist for the newer (1998\u2026) IPv6 addresses.", "It is not yet time to start our EC2 instances in the VPC we\u2019ve just created: we need another layer. Each instance must be associated with a subnet, which is simply a logical subnetwork inside a VPC. It is defined using a CIDR block, which has to be a subset of the VPC\u2019s CIDR block. For instance, we could define a subnet in the previously created VPC using this CIDR block: 176.13.0.0/24. It is indeed a subset of 176.13.0.0/16.", "Why do we need such subnetworks? There are three main reasons a cloud architect keeps in mind when building an app:", "Last but not least, you should remember that each subnet can only span one Availability Zone (AZ). As we\u2019ve seen in the previous post, that means resources inside a single subnet are vulnerable to a local failure (as an AZ corresponds to a physical data center). To make your application Highly Available (HA), you then need to replicate subnets across Availability Zones but still inside the same VPC.", "So let\u2019s see below what it could look like in the app we previously designed.", "We have now a proper setup for our network. Now, how do we make our instances communicate with each other?", "Elastic Network Interface (ENI) is what enables the communication between instances of a network to happen. It is therefore mandatory for any instance to have at least one: it is the link between your instance and one subnet. IP addresses are actually bound to ENI, not instances!", "Most of the time, we omit these ENI because they link a single instance to a single subnet. So our previous architecture should actually look like this (viewing only one AZ for simplicity):", "ENIs are nonetheless useful to redirect traffic when an instance fails. Consider the case below with two instances:", "If instance 1 fails, its ENI can be attached to instance 2 as a secondary ENI. From the outside, the traffic still reaches the same IP address, but it is actually processed by another instance behind the hood.", "So now we can communicate inside our subnets, how about communicating with the Internet?", "For this, we use an Internet Gateway (IG) as a middle man, attached to a subnet. It will give an instance:", "An IG is associated with a single VPC. You recognize it thanks to its ID on AWS starting with igw-xxx .", "Now, note that we\u2019ve never mentioned how exactly traffic should be flowing between instances, between subnets, between instances and the Internet, etc. That\u2019s where the route table intervenes. It will specify routes from your instances to other instances and to the outside world.", "The first thing you should keep in mind about route tables is that they are linked to one or more subnets. Route tables describe how traffic from the instances of the subnet(s) should be redirected. By route, we mean the following two things:", "At first, it seemed confusing to me that a route is made of only a destination. It is actually because the origin is the whole subnet associated with the route table.", "Equally confusing: what is the difference between a destination and a target? The destination is the final IP of where you want your packet (data) to end up, while the target is where the packet should go next in order to get closer to this final destination.", "There are in particular two routes that are important and that you will see almost all the time:", "In our app, we could typically configure the following table for our first subnet:", "You can see that the first route redirects traffic from the first subnet we created to the second one, defined by 2001:db8:1234:1a00::/56. The last two lines simply create an Internet connection with our first subnet by allowing all addresses (\u201c0.0.0.0/0\u201d in IPv4 and \u201c::/0\u201d in IPv6 refer to all addresses \u2014 public and those inside your VPC) to be reached through the IG. The subnet becomes a public subnet thanks to these two lines. Without these connections to the Internet Gateway, it would be a private subnet.", "Let\u2019s update our app\u2019s cloud architecture with these new elements:", "You can see that the upper subnet is public while the one containing the databases is private. Note that the private subnet can still access indirectly the Internet through the public subnet.", "What if now you want to control the traffic going to your instances in a detailed manner? Like which protocol is allowed to reach your instances, on what port, etc.?", "Fine-grained control of what is reaching your infrastructure is achieved mainly through the use of Security groups at the instance level, and Network Access Control Lists (NACL) at the subnet level.", "A Security group is basically a firewall controlling traffic to and from an instance that has been linked to this Security group. It does this by specifying inbound and outbound rules, made of the following:", "Let\u2019s take the example of an EC2 instance that you want to use as a web server. In this case, you would allow every IP address to be a source as you want your users to access your app, right? In this case, the protocol used to establish a connection between an Internet user and the instance would be TCP while the port range is 443, typically used for HTTPS data transfers. Now, you may also want to take control of your instance from a remote terminal to do some maintenance work. You will do this over SSH, and from a specific source (at 197.52.101.10 for instance). With this in mind, the inbound rules of your security group look like this:", "Note that by default, all outside communications are denied. You need to specifically whitelist sources that are going to communicate with your instance.", "On the other hand, all addresses are allowed by default when it comes to outbound communications. It means that your default outbound rules look like this:", "Finally, there is an important concept to remember about security groups: it is said to be stateful. This means that if some traffic is allowed in one direction, then it also allows some reply traffic in the opposite direction. This is important when communicating with Internet clients: our instance may try to send a packet to a web server (like a GET request) and expect an answer. Our security group will allow the answer to go through.", "While Security groups control traffic at the instance level, another service is used to more conveniently control traffic between subnets: NACL.", "Network Access Control Lists are comparable to Security groups in the sense that they control inbound and outbound traffic using rules. However, one NACL is attached to a subnet and controls traffic that may enter or exit the entire subnet. For traffic between instances of a subnet, Security groups are preferred.", "Similarly to a Security group, NACL implements rules characterized by the following elements:", "When creating a subnet, a default NACL is attached to it and can be modified further. Its default inbound rules look like this:", "Beware that all inbound traffic is allowed by default which was not the case with Security groups! Note also the last row with an asterisk as a rule number: it is a default rule that cannot be modified or removed. It denies any traffic not explicitly allowed by the previous rules.", "There is one NACLs\u2019 characteristic that can lead to some bugs and is, therefore, worth remembering: NACLs are stateless. This means it won\u2019t automatically return traffic: you need to specify the outbound rule corresponding to the inbound rule that allowed the communication to happen in the first place. Or you could use ephemeral ports but that\u2019s another story!", "We went through the fundamental concepts needed to properly start AWS services. We saw how to arrange instances into subnets depending on their utilization. We also enabled communication between instances and communication with the Internet as well (IG, Route Table). Finally, we protected our infrastructure by specifying which traffic should be allowed to reach our instances (Security groups, NACL).", "Bear in mind that this post only scratched the surface of what it takes to understand cloud architectures. As a next step, it would be interesting for you to play around the AWS UI, creating your own free resources (using free-tier services). Then, there are numerous subtleties that you can learn about by reading the documentation or following the new services regularly launched by AWS:", "As always thanks for reading, and please do not hesitate to provide feedback or comments for me to also improve my understanding of the subject.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb1b9f4920359&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@louisdge?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@louisdge?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": "Louis Douge"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7a9ab51dbc22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&user=Louis+Douge&userId=7a9ab51dbc22&source=post_page-7a9ab51dbc22----b1b9f4920359---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1b9f4920359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1b9f4920359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/ProGamerGov/neural-style-pt", "anchor_text": "Code"}, {"url": "https://arxiv.org/abs/1508.06576", "anchor_text": "Paper"}, {"url": "https://medium.com/@louisdge/catching-up-with-the-cloud-trend-and-the-aws-ecosystem-dd512e8e2456", "anchor_text": "In my previous post"}, {"url": "https://en.wikipedia.org/wiki/IP_address", "anchor_text": "Internet Protocol address"}, {"url": "https://en.wikipedia.org/wiki/Internet_protocol_suite", "anchor_text": "Internet Protocol Suite"}, {"url": "https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing", "anchor_text": "Classless Inter-Domain Routing"}, {"url": "https://en.wikipedia.org/wiki/Private_network", "anchor_text": "RFC1918 range"}, {"url": "https://en.wikipedia.org/wiki/Internet_protocol_suite", "anchor_text": "Protocol"}, {"url": "https://en.wikipedia.org/wiki/Port_(computer_networking)", "anchor_text": "Port"}, {"url": "https://en.wikipedia.org/wiki/HTTPS", "anchor_text": "HTTPS"}, {"url": "https://en.wikipedia.org/wiki/Secure_Shell", "anchor_text": "SSH"}, {"url": "https://en.wikipedia.org/wiki/Ephemeral_port", "anchor_text": "ephemeral ports"}, {"url": "https://aws.amazon.com/about-aws/whats-new/2017/08/amazon-virtual-private-cloud-vpc-now-allows-customers-to-expand-their-existing-vpcs/", "anchor_text": "here"}, {"url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html", "anchor_text": "Elastic IP addresses"}, {"url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_NAT_Instance.html\\", "anchor_text": "NAT device"}, {"url": "https://medium.com/tag/aws?source=post_page-----b1b9f4920359---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b1b9f4920359---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----b1b9f4920359---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/tag/technology?source=post_page-----b1b9f4920359---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/cloud-services?source=post_page-----b1b9f4920359---------------cloud_services-----------------", "anchor_text": "Cloud Services"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1b9f4920359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&user=Louis+Douge&userId=7a9ab51dbc22&source=-----b1b9f4920359---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1b9f4920359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&user=Louis+Douge&userId=7a9ab51dbc22&source=-----b1b9f4920359---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1b9f4920359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb1b9f4920359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b1b9f4920359---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b1b9f4920359--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b1b9f4920359--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b1b9f4920359--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b1b9f4920359--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@louisdge?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@louisdge?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Louis Douge"}, {"url": "https://medium.com/@louisdge/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "http://www.linkedin.com/in/louisdouge", "anchor_text": "www.linkedin.com/in/louisdouge"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7a9ab51dbc22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&user=Louis+Douge&userId=7a9ab51dbc22&source=post_page-7a9ab51dbc22--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c86fdc4b6e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-data-scientist-doesnt-know-how-to-properly-start-an-ec2-instance-b1b9f4920359&newsletterV3=7a9ab51dbc22&newsletterV3Id=3c86fdc4b6e7&user=Louis+Douge&userId=7a9ab51dbc22&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}