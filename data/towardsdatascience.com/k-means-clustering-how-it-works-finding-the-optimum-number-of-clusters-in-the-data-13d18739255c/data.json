{"url": "https://towardsdatascience.com/k-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c", "time": 1683013616.124925, "path": "towardsdatascience.com/k-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c/", "webpage": {"metadata": {"title": "K-Means Clustering: How It Works & Finding The Optimum Number Of Clusters In The Data | by Serafeim Loukas, PhD | Towards Data Science", "h1": "K-Means Clustering: How It Works & Finding The Optimum Number Of Clusters In The Data", "description": "The K-means algorithm clusters the data at hand by trying to separate samples into K groups of equal variance, minimizing a criterion known as the inertia or within-cluster sum-of-squares. This\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Variance", "anchor_text": "variance", "paragraph_index": 5}, {"url": "https://aigents.co/learn", "anchor_text": "https://aigents.co/learn", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Elbow_method_(clustering)", "anchor_text": "elbow method", "paragraph_index": 14}], "all_paragraphs": ["K-means is one of the most widely used unsupervised clustering methods.", "The K-means algorithm clusters the data at hand by trying to separate samples into K groups of equal variance, minimizing a criterion known as the inertia or within-cluster sum-of-squares. This algorithm requires the number of clusters to be specified. It scales well to large number of samples and has been used across a large range of application areas in many different fields.", "The k-means algorithm divides a set of N samples (stored in a data matrix X) into K disjoint clusters C, each described by the mean \u03bcj of the samples in the cluster. The means are commonly called the cluster \u201ccentroids\u201d.", "K-means algorithm falls into the family of unsupervised machine learning algorithms/methods. For this family of models, the research needs to have at hand a dataset with some observations without the need of having also the labels/classes of the observations. Unsupervised learning studies how systems can infer a function to describe a hidden structure from unlabeled data.", "Now let\u2019s discover the mathematical foundations of the algorithm.", "Given a set of observations (x1, x2, \u2026, xn), where each observation is a d-dimensional real vector, k-means clustering aims to partition the n observations into k (\u2264 n) sets S = {S1, S2, \u2026, Sk} so as to minimize the within-cluster sum of squares (WCSS) (i.e. variance). Formally, the objective is defined as follows:", "where \u03bci is the mean of points in group/cluster Si.", "If you want to learn Data Science by yourself with the support of interactive roadmaps and an active learning community have a look at this resource: https://aigents.co/learn", "The algorithm can also be understood through the concept of Voronoi diagrams.", "First, the Voronoi diagram of the points is calculated using the current centroids. Initially, the centroids are usually chosen randomly but this depends on the underlying package / library / software used.", "Each segment in the Voronoi diagram becomes a separate cluster.", "Secondly, the centroids are updated to the mean of each segment. The algorithm then repeats this until a stopping criterion is fulfilled.", "The algorithm stops when the relative decrease in the objective function between iterations is less than the given tolerance (\u03b5) value or when centroids move (in space) less than the tolerance.", "As stated in the introduction, the K-Means algorithm requires the number of clusters to be specified beforehand. In case that there is no valid assumption about the underlying number of clusters in the data, this task can be difficult to tackle.", "Fortunately, there are some methods for estimating the optimum number of clusters in our data such as the Silhouette Coefficient or the Elbow method. If the ground truth labels are not known, evaluation must be performed using the model itself. In this article we will only use the Silhouette Coefficient and not the Elbow method which is much simpler. Briefly, the elbow method looks at the percentage of variance explained as a function of the number of clusters: One should choose a number of clusters so that adding another cluster doesn\u2019t give much better modeling of the data.", "A higher Silhouette Coefficient score relates to a model with better defined clusters. The Silhouette Coefficient is defined for each sample and is composed of two scores:", "The Silhouette Coefficient s for a single sample is then defined as:", "Finally, the Total Silhouette Coefficient for a set of samples is given as the mean of the Silhouette Coefficient for each sample.", "The best value is 1 and the worst value is -1. Values near 0 indicate overlapping clusters. Negative values generally indicate that a sample has been assigned to the wrong cluster, as a different cluster is more similar.", "For this example we will create artificial data i.e. artificial clusters. This way we will know in advance the ground through i.e. the exact number of clusters in our dataset.", "Let\u2019s start with importing the required python libraries:", "Next, let\u2019s create some artificial data containing 500 samples, 2 features/variables, and K=4 clusters.", "We know that we have K=4 clusters in the data however, in order to understand how the Silhouette Score works we will fit the model using a range of different number of clusters.", "Each time, we will estimate the Silhouette Score and also plot the data with the final (converged) centroids. All these are done by the following code:", "We observe that the average/mean Silhouette Score is the highest in the case of K=4 clusters.", "This verifies that the Silhouette Score is a good measure of K-means fitting goodness.", "The vertical line is the average silhouette score of all the values.", "Again, we can also visually verify that the Silhouette Score is a good measure of K-means fitting goodness for the specific example.", "K-means is one of the most widely used unsupervised clustering methods. The algorithm clusters the data at hand by trying to separate samples into K groups of equal variance, minimizing a criterion known as the inertia or within-cluster sum-of-squares. This algorithm requires the number of clusters to be specified.", "However, if the ground truth labels are not known, the evaluation must be performed using the model itself.", "In this article we used the Silhouette Coefficient. From the working example, we can verify that the Silhouette Score is a good measure of K-means fitting goodness.", "That\u2019s all! Hope you liked this new article \u2014 more to come soon!", "If you liked and found this article useful, follow me to be able to see all my new posts.", "Questions? Post them as a comment and I will reply as soon as possible.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist / Research Scientist @ Natural Cycles (Switzerland). PhD, MSc, M.Eng."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F13d18739255c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----13d18739255c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----13d18739255c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://seralouk.medium.com/?source=post_page-----13d18739255c--------------------------------", "anchor_text": ""}, {"url": "https://seralouk.medium.com/?source=post_page-----13d18739255c--------------------------------", "anchor_text": "Serafeim Loukas, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F325d0d6c848b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=post_page-325d0d6c848b----13d18739255c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13d18739255c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13d18739255c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://patreon.com/TheDataScienceHub", "anchor_text": "patreon.com/TheDataScienceHub"}, {"url": "https://en.wikipedia.org/wiki/Variance", "anchor_text": "variance"}, {"url": "https://aigents.co/learn", "anchor_text": "https://aigents.co/learn"}, {"url": "https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_digits.html#sphx-glr-auto-examples-cluster-plot-kmeans-digits-py", "anchor_text": "https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_digits.html#sphx-glr-auto-examples-cluster-plot-kmeans-digits-py"}, {"url": "https://en.wikipedia.org/wiki/Elbow_method_(clustering)", "anchor_text": "elbow method"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html#sklearn.datasets.make_blobs", "anchor_text": "make_blobs"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans", "anchor_text": "KMeans"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_samples.html#sklearn.metrics.silhouette_samples", "anchor_text": "silhouette_samples"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html#sklearn.metrics.silhouette_score", "anchor_text": "silhouette_score"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html#sklearn.datasets.make_blobs", "anchor_text": "make_blobs"}, {"url": "https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots", "anchor_text": "plt.subplots"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans", "anchor_text": "KMeans"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html#sklearn.metrics.silhouette_score", "anchor_text": "silhouette_score"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_samples.html#sklearn.metrics.silhouette_samples", "anchor_text": "silhouette_samples"}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange", "anchor_text": "np.arange"}, {"url": "https://matplotlib.org/api/_as_gen/matplotlib.pyplot.suptitle.html#matplotlib.pyplot.suptitle", "anchor_text": "plt.suptitle"}, {"url": "https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show", "anchor_text": "plt.show"}, {"url": "https://doi.org/10.1016/0377-0427(87)90125-7", "anchor_text": "doi:10.1016/0377\u20130427(87)90125\u20137"}, {"url": "https://en.wikipedia.org/wiki/Silhouette_(clustering)", "anchor_text": "https://en.wikipedia.org/wiki/Silhouette_(clustering)"}, {"url": "https://towardsdatascience.com/lstm-time-series-forecasting-predicting-stock-prices-using-an-lstm-model-6223e9644a2f", "anchor_text": "LSTM Time-Series Forecasting: Predicting Stock Prices Using An LSTM ModelIn this post I show you how to predict stock prices using a forecasting LSTM modeltowardsdatascience.com"}, {"url": "https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-an-arima-model-2e3b3080bd70", "anchor_text": "Time-Series Forecasting: Predicting Stock Prices Using An ARIMA ModelIn this post I show you how to predict the TESLA stock price using a forecasting ARIMA modeltowardsdatascience.com"}, {"url": "https://medium.com/@seralouk/the-best-free-data-science-resources-free-books-online-courses-9c4a2df194e5", "anchor_text": "The Best FREE Data Science Resources: FREE Books & Online CoursesThe most useful FREE books and online courses for someone who wants to learn more about Data Science.medium.com"}, {"url": "https://towardsdatascience.com/roc-curve-explained-using-a-covid-19-hypothetical-example-binary-multi-class-classification-bab188ea869c", "anchor_text": "ROC Curve Explained using a COVID-19 hypothetical example: Binary & Multi-Class Classification\u2026In this post I clearly explain what a ROC curve is and how to read it. I use a COVID-19 example to make my point and I\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/support-vector-machines-svm-clearly-explained-a-python-tutorial-for-classification-problems-29c539f3ad8", "anchor_text": "Support Vector Machines (SVM) clearly explained: A python tutorial for classification problems\u2026In this article I explain the core of the SVMs, why and how to use them. Additionally, I show how to plot the support\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/pca-clearly-explained-how-when-why-to-use-it-and-feature-importance-a-guide-in-python-7c274582c37e", "anchor_text": "PCA clearly explained \u2014 How, when, why to use it and feature importance: A guide in PythonIn this post I explain what PCA is, when and why to use it and how to implement it in Python using scikit-learn. Also\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/everything-you-need-to-know-about-min-max-normalization-in-python-b79592732b79", "anchor_text": "Everything you need to know about Min-Max normalization in PythonIn this post I explain what Min-Max scaling is, when to use it and how to implement it in Python using scikit-learn but\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-and-why-to-standardize-your-data-996926c2c832", "anchor_text": "How Scikit-Learn\u2019s StandardScaler worksIn this post I am explaining why and how to apply Standardization using scikit-learntowardsdatascience.com"}, {"url": "https://www.linkedin.com/in/serafeim-loukas/", "anchor_text": "https://www.linkedin.com/in/serafeim-loukas/"}, {"url": "https://www.researchgate.net/profile/Serafeim_Loukas", "anchor_text": "https://www.researchgate.net/profile/Serafeim_Loukas"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----13d18739255c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----13d18739255c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/clustering?source=post_page-----13d18739255c---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/k-means?source=post_page-----13d18739255c---------------k_means-----------------", "anchor_text": "K Means"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----13d18739255c---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F13d18739255c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=-----13d18739255c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F13d18739255c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=-----13d18739255c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13d18739255c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----13d18739255c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F13d18739255c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----13d18739255c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----13d18739255c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----13d18739255c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----13d18739255c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----13d18739255c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----13d18739255c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----13d18739255c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----13d18739255c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----13d18739255c--------------------------------", "anchor_text": ""}, {"url": "https://seralouk.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://seralouk.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Serafeim Loukas, PhD"}, {"url": "https://seralouk.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F325d0d6c848b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=post_page-325d0d6c848b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe538e6363893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-how-it-works-finding-the-optimum-number-of-clusters-in-the-data-13d18739255c&newsletterV3=325d0d6c848b&newsletterV3Id=e538e6363893&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}