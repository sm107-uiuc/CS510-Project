{"url": "https://towardsdatascience.com/using-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3", "time": 1683015068.541279, "path": "towardsdatascience.com/using-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3/", "webpage": {"metadata": {"title": "Train and Build a Classification Machine Learning App Using Loan Data | by Edward Krueger | Towards Data Science", "h1": "Train and Build a Classification Machine Learning App Using Loan Data", "description": "We used GCP to code this project, which comes configured with Docker. If you are interested in following along with a pre-configured cloud VM check out this article to get started! Our data is taken\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/edkrueger/", "anchor_text": "Edward Krueger", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/douglas-franklin-1a3a2aa3/", "anchor_text": "Douglas Franklin", "paragraph_index": 0}, {"url": "https://faculty.marshall.usc.edu/gareth-james/ISL/ISLR%20Seventh%20Printing.pdf", "anchor_text": "ISLR", "paragraph_index": 3}, {"url": "https://console.cloud.google.com/run?_ga=2.112811590.313737761.1591368161-572251819.1590763098&amp;_gac=1.61558494.1591368161.CjwKCAjw2uf2BRBpEiwA31VZj5hm5tgEHH-Ldim6HaH954LjVPoeEdbL9XkMUnSw3yKCOv1UYdvGdRoCzasQAvD_BwE", "anchor_text": "GCP cloud run", "paragraph_index": 62}], "all_paragraphs": ["By: Edward Krueger and Douglas Franklin.", "Follow along with all of the code used in this project here!", "We used GCP to code this project, which comes configured with Docker. If you are interested in following along with a pre-configured cloud VM check out this article to get started!", "Our data is taken from a book known as ISLR. Check out this work for information on machine learning and statistics!", "We can imagine a bank would like to know who is a safe loan recipient, but how can we tell if someone is trustworthy while only knowing a few things about them?", "Our data set contains rows representing individuals with default status and some other information we will use to predict the default status. In other words, this is supervised learning.", "First, we will clean up the data so that it is better suited for a classification model.", "Let\u2019s have a look at our data.", "It looks like we have four columns and an index, including bank balance, yearly income, student status and loan default status. This data can be cleaned to better suit a classification model, so let's make some changes.", "To clean our data, we use pandas and some lambda functions to remove the index and change our yes/no strings to True/False booleans.", "Now our clean data looks like this.", "Before we set up our data for training models, let us take one final look using pandas.", "Here we use value_counts() to see how many Trues and Falses we have. This lets us see how many people default on their loans and how many don't. It is important to note that there are vastly more, almost 30x more, Falses than there are Trues. This means that our data contains many more examples of non-defaulters than defaulters, a class imbalance.", "This disparity in our sample data will be important to keep in mind when reviewing our model metrics. We could imagine a dummy model that always guesses False or no-default, and it will simultaneously have and accuracy of 96.67% and be a horrible model. To know if our model is doing well, we will want to look closely at when it is wrong. We are interested in misclassifications.", "Now we are going to set up our notebook to run some machine learning models. First, we are going to prepare the variables that we will feed into our models.", "Our X or independent variables will be student status, bank balance, and annual income. These are the variables we are going to use to predict if an individual is likely to default or not.", "Whether an individual has defaulted on a loan or not will be our y or dependent variable.", "Thus we assume that our three independent variables hold some causal relationship with our dependent variable. Phrased differently, we assume bank balance, income and student status are useful in predicting if someone will default on a loan.", "Using the X and y variables we set up above, we can build some models and analyze their metrics. First, however, let's review the model metrics precision and recall in the context of our current problem.", "How can we tell which model is the most effective at solving this problem?", "Precision attempts to answer the following question:", "What proportion of positive identifications was actually correct?", "Precision is the measure of individuals predicted to default that actually default.", "Recall attempts to answer the following question:", "What proportion of actual positives was identified correctly?", "Recall measures the ratio of defaulting individuals that were correctly classified.", "To fully evaluate the effectiveness of a model, you must examine both precision and recall. Unfortunately, precision and recall are often in tension. That is, improving precision typically reduces recall and vice versa.", "Note that we imagined a dummy model with 96.67% accuracy that never says \u201cTrue.\u201d Precision and recall allow us to zoom in on the values the model classifies as \u201cTrue\u201d so that we can see how our model behaves when it matters to us!", "Every problem is different, so you need to know which is more important for your situation, precision or recall? This will be a value-based decision where you decide which cost more, false positives or false negatives.", "Let\u2019s take a look at a few of our models built using scikit-learn.", "In decision analysis, a decision tree can visually and explicitly represent decisions and decision making. As the name goes, it uses a tree-like model of decisions.", "Here we can see our accuracy is nearly that of our dummy model that always says false. This is due to a large number of Falses, the class imbalance, in the dataset.", "Things get more interesting when we look at cv_recall and cv_precision. These low scores indicate this model struggles to identify actual \u201cTrue\u201d values, precision shows us that our model is only right about one-third of the time it predicts \u201cdefault.\u201d Recall shows us that when it does classify an individual as \u201cTrue,\u201d it is only right about one-third of the time. Not a very good model,", "The k-nearest neighbors (KNN) algorithm is a simple supervised machine learning algorithm that can be used to solve both classification and regression problems.", "We see our accuracy increase slightly, but once again, we are more interested in cv_recall and cv_precision. We see precision is much higher here, meaning that of our model's \u201cTrue\u201d values predicted, half were correct. This means that half of the people that our model thinks will default, actually do.", "However, we also see this corresponding drop in the recall. This means our model only identified 15% of the \u201cTrue\u201d values. It seems we are right more often when we say \u201cTrue,\u201d but we are overlooking many \u201cTrue\u201d values also.", "As its name implies, a random forest consists of a large number of individual decision trees that operate as an ensemble. Each particular tree in the random forest spits out a class prediction and the class with the most votes becomes our model\u2019s prediction. Some implementations of this model have each tree submit an average rather than a vote, which can increase accuracy.", "The fundamental concept behind random forest is a simple but powerful one \u2014 the wisdom of crowds. In data science speak, the reason that the random forest model works so well is that a large number of relatively uncorrelated trees operating as a committee will outperform any of the individual constituent trees.", "Once again, we see our accuracy increase slightly, but once again we are more interested in cv_recall and cv_precision both of which have increased in the random forest compared to a single KNN model. We see precision is slightly higher here, meaning that of the \u201cTrue\u201d values, our model predicted, 57% were chosen correctly. We see a cv_recall much higher than that of the KNN but slightly lower than a single decision tree. Still, we are only identifying about one-third of our \u201cTrue\u201d values with this model.", "Of these three models, the random forest has the best overall metrics, so we will move forward with that model and build it into an app.", "Once you have decided on a model, save it as a .joblib, as we have done below with our random forest model.", "Now we have our loan classifier saved as a .joblib and the file will appear in our directory.", "The application to serve this model is simple. We need to import our model into the app, receive a POST request and return the model\u2019s response to that POST.", "We can see we have a simple /home route to let us know the app is ready. Our /predict route is what does the real work. Notice that it takes a POST pulls variables out of that post, then feeds those variables to our model as X_predict. Then the route returns that model\u2019s response as a True or False and the probability of default as a float.", "Once we have a working app to serve our model, we need to containerize our app with Docker so we can deploy it easily.", "Docker is the best way to put apps into production. Docker uses a Dockerfile to build a container. The built container is stored in Google Container Registry, where it can be deployed. Docker containers can be built locally and will run on any system running Docker.", "Here is the Dockerfile used for this project:", "Be aware you will need Docker installed to run this locally. Alternatively, you can use a cloud platform that already comes configured with Docker (see the article linked at the start of this one).", "The docker build command treats each line of your Dockerfile as a \u2018Step\u2019 and provides a terminal output indicating when each step is run, as seen above.", "We run the command docker build . -t loan-classifier and see output confirmation that each step is being complete sequentially. Once our docker container is built, we can run the app in the container with the following command.", "Looks like our containerized app is running at the localhost address. Great, we have a successful Docker build. Now to get our app deployed to the public.", "GCP Cloud Build allows you to build containers remotely using the instructions contained in Dockerfiles.", "Once we have our Dockerfile ready, we can build our container image using Cloud Build.", "Run the following command from the directory containing the Dockerfile:", "Note: Replace PROJECT-ID with your GCP project ID and container-name with your container name. You can view your project ID by running the command gcloud config get-value project.", "This Docker image now accessible at the GCP container registry or GCR and can be accessed via URL with Cloud Run.", "Skip this section if you\u2019d prefer to use the GUI!", "Note: Replace PROJECT-ID with your GCP project ID and container-name with your containers\u2019 name. You can view your project ID by running the command gcloud config get-value project.", "2. You will be prompted for service name and region: select the service name and region of your choice.", "3. You will be prompted to allow unauthenticated invocations: respond y if you want public access, and n to limit IP access to resources in the same google project.", "4. Wait a few moments until the deployment is complete. On success, the command line displays the service URL.", "5. Visit your deployed container by opening the service URL in a web browser.", "Now that we have a container image stored in GCR, we are ready to deploy our application. Visit GCP cloud run and click create service, be sure to set up billing as required.", "Select the region you would like to serve and specify a unique service name. Then choose between public or private access to your application by choosing unauthenticated or authenticated, respectively.", "Now we use our GCR container image URL from above. Paste in the URL or click select and find it using a dropdown list. Check out the advanced settings to specify server hardware, container port and additional commands, maximum requests and scaling behaviors.", "Click create when you\u2019re ready to build and deploy!", "You\u2019ll be brought to the GCP Cloud Run service details page where you can manage the service and view metrics and build logs.", "Click the URL to view your deployed application!", "Congratulations! You have just deployed an application packaged in a container to Cloud Run.", "You only pay for the CPU, memory, and networking consumed during request handling. That being said, be sure to shut down your services when you do not want to pay for them!", "As we have seen, there is complexity and nuance to deciding if a model is good or not. Keep in mind we have covered a simple problem with simple data. As problems increase in complexity doing EDA and analyzing model outputs becomes more complicated and more relevant. Once you have a model that's \u201cgood enough\u2019\u201d for the problem at hand serving that model is the next step.", "Getting any decently good model out quickly can have significant business and tech value. Value from having something people can immediately use and from having software deployed that a data scientist can tune later. Getting software deployed can be a challenge, but it is a hurdle best overtaken sooner than later; deploy early deploy often. Additionally, services like Docker simplify the deployment process.", "We hope this content is informative and helpful; let us know what you are looking to learn more about in the software, development and machine learning space!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, Software Developer and Educator"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F174c2f1058e3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.edkruegerdata.com/?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.edkruegerdata.com/?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": "Edward Krueger"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4889b755e348&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&user=Edward+Krueger&userId=4889b755e348&source=post_page-4889b755e348----174c2f1058e3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F174c2f1058e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F174c2f1058e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.linkedin.com/in/edkrueger/", "anchor_text": "Edward Krueger"}, {"url": "https://www.linkedin.com/in/douglas-franklin-1a3a2aa3/", "anchor_text": "Douglas Franklin"}, {"url": "https://github.com/edkrueger/python-classification-labs", "anchor_text": "edkrueger/python-classification-labsContribute to edkrueger/python-classification-labs development by creating an account on GitHub.github.com"}, {"url": "https://towardsdatascience.com/using-gcp-ai-platform-notebooks-as-reproducible-data-science-environments-964cba32737", "anchor_text": "Using GCP AI Platform Notebooks as Reproducible Data Science EnvironmentsUsing a pre-configured cloud-hosted VM to solve reproducibility issues with Python and Jupyter Notebooks.towardsdatascience.com"}, {"url": "https://faculty.marshall.usc.edu/gareth-james/ISL/ISLR%20Seventh%20Printing.pdf", "anchor_text": "ISLR"}, {"url": "https://console.cloud.google.com/run?_ga=2.112811590.313737761.1591368161-572251819.1590763098&amp;_gac=1.61558494.1591368161.CjwKCAjw2uf2BRBpEiwA31VZj5hm5tgEHH-Ldim6HaH954LjVPoeEdbL9XkMUnSw3yKCOv1UYdvGdRoCzasQAvD_BwE", "anchor_text": "GCP cloud run"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----174c2f1058e3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----174c2f1058e3---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----174c2f1058e3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----174c2f1058e3---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/data-science?source=post_page-----174c2f1058e3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F174c2f1058e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&user=Edward+Krueger&userId=4889b755e348&source=-----174c2f1058e3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F174c2f1058e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&user=Edward+Krueger&userId=4889b755e348&source=-----174c2f1058e3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F174c2f1058e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F174c2f1058e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----174c2f1058e3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----174c2f1058e3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----174c2f1058e3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----174c2f1058e3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----174c2f1058e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.edkruegerdata.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.edkruegerdata.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Edward Krueger"}, {"url": "https://medium.edkruegerdata.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "699 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4889b755e348&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&user=Edward+Krueger&userId=4889b755e348&source=post_page-4889b755e348--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f629c0dbfb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-loan-data-to-train-and-build-a-classification-machine-learning-app-174c2f1058e3&newsletterV3=4889b755e348&newsletterV3Id=1f629c0dbfb9&user=Edward+Krueger&userId=4889b755e348&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}