{"url": "https://towardsdatascience.com/rnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe", "time": 1683009098.842589, "path": "towardsdatascience.com/rnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe/", "webpage": {"metadata": {"title": "RNNs vs Traditional ML for Predictive Customer Lifetime Value | by Adam Brownell | Towards Data Science", "h1": "RNNs vs Traditional ML for Predictive Customer Lifetime Value", "description": "My job as a Sr. Data Scientist is to build the best Customer Lifetime Value (CLV) model possible. My data science team is constantly working to refine and improve upon our models, leveraging the best\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.reutterer.com/papers/platzer&reutterer_pareto-ggg_2016.pdf", "anchor_text": "original paper", "paragraph_index": 10}, {"url": "https://cran.r-project.org/web/packages/BTYD/vignettes/BTYD-walkthrough.pdf", "anchor_text": "BTYD package.", "paragraph_index": 10}], "all_paragraphs": ["The company I work for, RETINA.ai, builds ML models to predict Customer Lifetime Value (CLV). Our data science team is constantly working to refine and improve upon those models, leveraging the best academic and industry research. This article describes our results from using Recurrent Neural Networks (RNNs) to predict CLV.", "Because RETINA\u2019s clients need both strategic and tactical insights into their customers, we build and test our models on both macro (cohort-level) and micro (customer-level) purchasing patterns. We use this as the basis for evaluating model performance so we can continually iterate on our models.", "In this blog post, we will demonstrate how the RNN-LSTM (Recurrent Neural Network with Long / Short-term Memory) machine learning model can predict CLV nearly as accurately as other industry-leading models.", "To build a predictive CLV model, we start with customer transaction history. The dataset we feed into our model might look something like this:", "From this transaction table we can not only determine CLV, but also predict future transactions per customer \u2014 and, we can visualize this with a Timing Patterns Graph:", "The above graphs shows each transaction in our transaction table as well as predicted future transactions:", "In addition to predicting the number of transactions, our models also predict the average revenue value of each of these future transactions. When we know both the price of each future transaction and the amount of transactions there will be, we can easily compute a customer\u2019s CLV.", "But how do we generate these predicted transactions and revenues? And more importantly, how do we know how accurate they are?", "First, we split our transaction history data into two datasets. We do so by determining a date that falls somewhere about 80% of the way between the oldest transaction and a more recent transaction in our data set. The transactions that happened before on or before this date are part of the calibration period, and the transactions that happened after are part of the holdout period. These datasets are so named because the calibration period data is fed into the model to calibrate it, while the holdout period data is deliberately withheld to test a model\u2019s prediction ability.", "If a model can use the data provided in the calibration period to accurately predict the data in the holdout period, then we know it is a strong model.", "A common model used to calculate CLV is the Pareto/NBD model, though Retina currently uses the Pareto/GGG model, which is an improvement upon the Pareto/NBD model. What makes Pareto/GGG such a powerful CLV model is that it creates three gamma distributions to determine customer inter-transaction time (ITT) and churn probability. If you\u2019d like to explore it deeper, you can read more about this model in the original paper or the BTYD package.", "However, the Retina team has also developed a newer model that is being compared against Pareto/GGG today. It\u2019s called the Long-Short-Term-Memory Recurrent Neural Network model (RNN-LSTM). This model takes in a sequence of events looks for patterns in those events leading up to the present, which allows it to predict the future. We feed the model with customer transaction history hoping it will learn future transactions in our case.", "By using our calibration/holdout technique outlined above, we were able to see the prediction strength of each of our models. We also included additional Pareto family models (BG/NBD and NBD) to provide context to our results. So, here are the results from our experiment:", "When we compare the actual number of transactions in our holdout period to the number each model predicted, we can see how well each model fared. The above table is sorted by Mean Absolute Error (MAE), or the average per customer difference between the predicted number transactions and the actual number of transactions.", "With the exception of NBD, the statistical models all performed strongly (less than 10% deviation from true values) on this metric. This means they are able to successfully capture customer purchasing trends at the aggregate level. Interestingly, our RNN-LSTM model is the only model that underestimates the total number of holdout transactions.", "The figure compares the accuracy of both RNN-LSTM and Pareto/GGG across different purchasing amount per customer:", "What this chart demonstrates is that RNN-LSTM severely underpredicts churned customers (customers who did not purchase anything in the holdout period) and over predicts 3\u20134 purchase customers. Pareto/GGG also underpredicts churned customers and overpredicts 3\u20134 purchase customers, but to a lesser degree.", "At first, Pareto/NBD appears to predict a near perfect number of transactions, this accuracy is due to the aggregate number of transactions predicted. As we seen when calculating MAE, Pareto/NBD actually performs worse on an individual level than Pareto/GGG and RNN-LSTM. CLV is a much more actionable metric at the individual level, so we decided to focus our further analysis on these two models.", "Back to our CLV Boxing Match: Pareto/GGG outperforms RNN-LSTM when using MAE, but not by much. These results are exciting because it not only demonstrates the superiority of Pareto/GGG, but also the validity of RNN-LSTM as a contender for CLV calculations.", "There are two concepts that become relevant beyond our results that should be discussed when considering which model is superior: extendability and explanatory power.", "RNN-LSTM is a strong option for CLV calculation because it is extendable. Unlike Pareto/GGG, RNN-LSTM takes in a larger number of features that can be customized and aggregated by the data scientist running the model. This means that RNN-LSTM can be informed by site visits, emails, and even specific industry trends, to create smarter and smarter iterations.", "Pareto/GGG is a strong option for CLV calculation thanks to its explanatory power. Unlike RNN-LSTM, which is essentially a black box in terms of understanding why it made a certain prediction, Pareto/GGG allows the data scientist to understand the underlying framework behind the predictions the model makes. If the model seems to underpredict churned customers, we can conclude that this is a function of an overly optimistic churn prediction gamma function. So, when the model is accurate or better than others, we can be more confident about why it is a stronger model. We are not afforded that luxury for machine learning models.", "Finally, there are several steps that would be thrilling experiments to build off of these results. A few future iterations we are enthusiastic to try are:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F42b6b12558fe&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://adam1brownell.medium.com/?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": ""}, {"url": "https://adam1brownell.medium.com/?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": "Adam Brownell"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2479b1fc8999&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&user=Adam+Brownell&userId=2479b1fc8999&source=post_page-2479b1fc8999----42b6b12558fe---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F42b6b12558fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F42b6b12558fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.reutterer.com/papers/platzer&reutterer_pareto-ggg_2016.pdf", "anchor_text": "original paper"}, {"url": "https://cran.r-project.org/web/packages/BTYD/vignettes/BTYD-walkthrough.pdf", "anchor_text": "BTYD package."}, {"url": "https://medium.com/tag/data-science?source=post_page-----42b6b12558fe---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/customer-lifetime-value?source=post_page-----42b6b12558fe---------------customer_lifetime_value-----------------", "anchor_text": "Customer Lifetime Value"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----42b6b12558fe---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recurrent-neural-network?source=post_page-----42b6b12558fe---------------recurrent_neural_network-----------------", "anchor_text": "Recurrent Neural Network"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----42b6b12558fe---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F42b6b12558fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&user=Adam+Brownell&userId=2479b1fc8999&source=-----42b6b12558fe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F42b6b12558fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&user=Adam+Brownell&userId=2479b1fc8999&source=-----42b6b12558fe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F42b6b12558fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F42b6b12558fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----42b6b12558fe---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----42b6b12558fe--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----42b6b12558fe--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----42b6b12558fe--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----42b6b12558fe--------------------------------", "anchor_text": ""}, {"url": "https://adam1brownell.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://adam1brownell.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adam Brownell"}, {"url": "https://adam1brownell.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "320 Followers"}, {"url": "http://www.thewizard.ai", "anchor_text": "www.thewizard.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2479b1fc8999&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&user=Adam+Brownell&userId=2479b1fc8999&source=post_page-2479b1fc8999--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff1faa9503b08&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe&newsletterV3=2479b1fc8999&newsletterV3Id=f1faa9503b08&user=Adam+Brownell&userId=2479b1fc8999&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}