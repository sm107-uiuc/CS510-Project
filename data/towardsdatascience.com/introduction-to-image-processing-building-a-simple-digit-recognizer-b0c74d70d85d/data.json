{"url": "https://towardsdatascience.com/introduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d", "time": 1682993941.5504692, "path": "towardsdatascience.com/introduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d/", "webpage": {"metadata": {"title": "Introduction to Image Processing: Building a Simple Digit Recognizer | by Sergi Lehkyi | Towards Data Science", "h1": "Introduction to Image Processing: Building a Simple Digit Recognizer", "description": "Digit recognition is not something that difficult or advanced. It is kind of \u201cHello world!\u201d program \u2014 not that cool, but you start exactly here. So I decided to share my work and at the same time\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/slehkyi/notebooks-for-articles/blob/master/digit-recognizer-colab.ipynb", "anchor_text": "GitHub", "paragraph_index": 18}, {"url": "http://sergilehkyi.com/introduction-to-image-recognition-building-a-simple-digit-detector/", "anchor_text": "sergilehkyi.com", "paragraph_index": 19}], "all_paragraphs": ["Digit recognition is not something that difficult or advanced. It is kind of \u201cHello world!\u201d program \u2014 not that cool, but you start exactly here. So I decided to share my work and at the same time refresh the knowledge \u2014 it\u2019s being a long ago I played with images.", "We start with importing all the necessary packages.", "MNIST dataset, which contains 20 thousand hand-written digits is a \u201cHello World\u201d dataset for this task, it is already preloaded in Colaboratory (cloud-based Python notebooks, fantastic thing BTW), so we will use it. No need to invent a wheel here.", "As we can see from the head() method, first column in dataset contains labels and the rest pixels of the image 28\u00d728 \u2014 that is why we have 784 columns more. It is also useful to check the length of the dataset each time after some modification to make sure we did everything correct.", "Next, let\u2019s visualize our pixels and watch the images we have. We use randint() to select random image every time we run the code below. Also we have to transform our pixels to numpy array (now its\u2019 type is Series) and reshape it to the size 28\u00d728 to be able to plot them.", "Now, to make our life little bit easier we will transform our dataframe to have only two columns \u2014 label and image, where image is a numpy array of pixels. Also we will reduce the size of dataframe for faster computation (first we want to make sure everything works and then we start playing with model)", "When we have our data prepared, we want to split it into 2 datasets: one to train our model and another to test it\u2019s performance. And the best way to do that is using sklearn. We set up a test_size=0.2 which is standard value for this operation (usually for test we leave 20\u201330% of data), which means that for training remains 80%. It is also a good practice to set shuffle=True as some datasets might have ordered data, so the model will learn to recognize 0s and 1s, but won\u2019t have any idea that 8 exists for example.", "We checked the length, the head of datasets \u2014 all good, we can start building our model. For this we will need to install pytorch. If we go to \u201cCode snippets\u201d and start typing there \u2018pyt\u2019 it will show us \u201cInstall [pytorch]\u201d, so we can insert it into our notebook. If someone has pytorch already installed this step can be skipped.", "Next, we have to transform our data into pytorch Dataset. torch.utils.data.Dataset is an abstract class representing a dataset. The custom dataset should inherit Dataset and override the following methods:", "The beauty of pytorch is its simplicity in defining the model. We define our layer with inputs and outputs, we add some batch normalization to improve our model (It is a technique to provide any layer in a neural network with inputs that are zero mean/unit variance) and activation function, in this case ReLU.", "For the first input we have 784 neurons (one neuron per each pixel) and 512 for output (this one is almost random \u2014 I tried few different values and this one performed pretty well, so I left it). Next layer will have 512 inputs (input_layer[n+1] == output_layer[n]) and 256 for output, next 256 inputs and 128 outputs and the last one \u2014 128 inputs and 10 for output (each neuron represents one of 10 digits)", "Now we need to create few additional parameters for our model:", "With all above we can start training and evaluating our model. Although we define 100 epochs, it is also useful to stop the loop if model doesn\u2019t improve with time. Here we have set up early_stop = 10, so if model doesn\u2019t change for 10 epochs in a row we will stop the training process.", "Training process: we iterate through our train data by assigning each image and label to a device defined previously, we give our model an image and it tries to find the correct class (preds), we clear all gradients (zero_grad()) and calculate the loss function and the gradient (loss), perform an optimizer step and append new value to a total_loss array.", "Testing process: we iterate through the test data, make predictions, calculate the loss and accuracy of the model. In torch.max() we are looking for an index of the maximum value as it will represent the class of a digit and in our case it will match labels. Then by comparing labels and predictions we calculate the accuracy of our model.", "Every time we find the best model we save it and if we hit the early_stop we exit and report the results. Usually it won\u2019t need all those 100 epochs.", "When we found our best model and saved it, we can play with it by feeding it with new data and see how it performs.", "Like it was said in the beginning it is a \u201cHello World\u201d for the image recognition, we didn\u2019t use convolutional neural network which is normally used in tasks like this, just entry level to understand the flow. I don\u2019t usually work with images, so if there are some mistakes, please let me know. It was a nice refresher for me, hopefully it helped someone else.", "You can find Python Notebook with the code on GitHub", "Originally published at sergilehkyi.com on November 14, 2018.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data and Cloud Developer, love technology in general, maybe too much humor and never too serious, based in amazing Barcelona"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb0c74d70d85d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sergilehkyi.medium.com/?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": ""}, {"url": "https://sergilehkyi.medium.com/?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": "Sergi Lehkyi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F82a9856ae35c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&user=Sergi+Lehkyi&userId=82a9856ae35c&source=post_page-82a9856ae35c----b0c74d70d85d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0c74d70d85d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0c74d70d85d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/MK4QKBqG_lA?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Toa Heftiba"}, {"url": "https://unsplash.com/search/photos/numbers?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://pytorch.org/docs/stable/nn.html#torch.nn.CrossEntropyLoss", "anchor_text": "CrossEntropyLoss"}, {"url": "https://github.com/slehkyi/notebooks-for-articles/blob/master/digit-recognizer-colab.ipynb", "anchor_text": "GitHub"}, {"url": "http://sergilehkyi.com/introduction-to-image-recognition-building-a-simple-digit-detector/", "anchor_text": "sergilehkyi.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b0c74d70d85d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b0c74d70d85d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data?source=post_page-----b0c74d70d85d---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----b0c74d70d85d---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----b0c74d70d85d---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0c74d70d85d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&user=Sergi+Lehkyi&userId=82a9856ae35c&source=-----b0c74d70d85d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0c74d70d85d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&user=Sergi+Lehkyi&userId=82a9856ae35c&source=-----b0c74d70d85d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0c74d70d85d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb0c74d70d85d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b0c74d70d85d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b0c74d70d85d--------------------------------", "anchor_text": ""}, {"url": "https://sergilehkyi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sergilehkyi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sergi Lehkyi"}, {"url": "https://sergilehkyi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "598 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F82a9856ae35c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&user=Sergi+Lehkyi&userId=82a9856ae35c&source=post_page-82a9856ae35c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F65a0e191fdf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-processing-building-a-simple-digit-recognizer-b0c74d70d85d&newsletterV3=82a9856ae35c&newsletterV3Id=65a0e191fdf8&user=Sergi+Lehkyi&userId=82a9856ae35c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}