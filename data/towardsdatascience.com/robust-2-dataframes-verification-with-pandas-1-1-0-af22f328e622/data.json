{"url": "https://towardsdatascience.com/robust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622", "time": 1683012136.140982, "path": "towardsdatascience.com/robust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622/", "webpage": {"metadata": {"title": "Robust 2 DataFrames verification with Pandas 1.1.0 | by Binlong Li | Towards Data Science", "h1": "Robust 2 DataFrames verification with Pandas 1.1.0", "description": "Pandas is one of the most used Python library for both data scientist and data engineers. Today, I want to share some Python tips to help us do qualification checks between 2 Dataframes. Notice, I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html", "anchor_text": "compare function", "paragraph_index": 2}], "all_paragraphs": ["Pandas is one of the most used Python library for both data scientist and data engineers. Today, I want to share some Python tips to help us do qualification checks between 2 Dataframes.", "Notice, I have used the word: qualification, instead of identical. Identical is easy to check, but qualification is a loose check. It is based on business logic. Therefore, it is harder to implement.", "In version 1.1.0 \u2014 released on July 28 2020, 8 days before \u2014 Pandas introduced the build-in compare function. All our following steps are built based on it.", "Tips: if you were using Anacondas distribution, you should use the following command line to upgrade your Pandas version.", "Always check number of columns between 2 frames first. In cases, this simple check could spot issues.", "In certain scenarios, such as enrichment change, we could have a different number of columns. The definition of qualification could be: for all the former columns having the same value between 2 data frames. Therefore, we will identify columns to check and save them in variable Columns for later usage.", "In real application, we would have various ids to identify a record, such as user-id, order_id etc. In order to make a unique query, we may need to use a combination of these keys. Ultimately, we want to verify records with the same keys have the same column values.", "The first step is to compose the key combination. This is where the DataFrame apply shines. We could use df.apply(lambda: x: func(x), axis = 1) to make any data transformation. With axis = 1, we are telling Pandas to do the same operation row by row. (axis = 0, column by column)", "For the new DataFrame.compare function, the following error is the most confusing. Let me try to explain.", "ValueError: Can only compare identically-labeled DataFrame objects", "The reason for this error, is the shape and the order of columns between two data frames is not identical. Yes. DataFrame.compare works only for identical checking, not qualification checking.", "The way to solve the issue is: use the keyColumn created before, compare for a subset between the DataFrames with the same keyColumn value. And do that for each keyColumn value.", "If the dimensions for keyColumn from 2 DataFrames are different, raise the issue and skip the check.", "Use latest Pandas 1.1.0 DataFrame.compare to do robust DataFrame qualification checks. In order to deal with ValueError, we use keyColumn to do multiple sub DataFrame checks and return the final decision.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m a software engineer manager, and a MBA student in UIUC. Talk about business, management, career development and technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf22f328e622&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----af22f328e622--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af22f328e622--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@herbert19lee?source=post_page-----af22f328e622--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herbert19lee?source=post_page-----af22f328e622--------------------------------", "anchor_text": "Binlong Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c30b96d9ba1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&user=Binlong+Li&userId=3c30b96d9ba1&source=post_page-3c30b96d9ba1----af22f328e622---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf22f328e622&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf22f328e622&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kunal_au?utm_source=medium&utm_medium=referral", "anchor_text": "Kunal Kalra"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html", "anchor_text": "compare function"}, {"url": "https://medium.com/tag/python?source=post_page-----af22f328e622---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----af22f328e622---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf22f328e622&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&user=Binlong+Li&userId=3c30b96d9ba1&source=-----af22f328e622---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf22f328e622&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&user=Binlong+Li&userId=3c30b96d9ba1&source=-----af22f328e622---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf22f328e622&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af22f328e622--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faf22f328e622&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----af22f328e622---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----af22f328e622--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----af22f328e622--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----af22f328e622--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----af22f328e622--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----af22f328e622--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----af22f328e622--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----af22f328e622--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----af22f328e622--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herbert19lee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herbert19lee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Binlong Li"}, {"url": "https://medium.com/@herbert19lee/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "51 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c30b96d9ba1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&user=Binlong+Li&userId=3c30b96d9ba1&source=post_page-3c30b96d9ba1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe190e0c5837d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-2-dataframes-verification-with-pandas-1-1-0-af22f328e622&newsletterV3=3c30b96d9ba1&newsletterV3Id=e190e0c5837d&user=Binlong+Li&userId=3c30b96d9ba1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}