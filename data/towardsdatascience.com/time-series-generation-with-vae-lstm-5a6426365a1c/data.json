{"url": "https://towardsdatascience.com/time-series-generation-with-vae-lstm-5a6426365a1c", "time": 1683018051.61217, "path": "towardsdatascience.com/time-series-generation-with-vae-lstm-5a6426365a1c/", "webpage": {"metadata": {"title": "Time Series generation with VAE LSTM | by Marco Cerliani | Towards Data Science", "h1": "Time Series generation with VAE LSTM", "description": "The usage of deep learning models for instance generation is becoming popular over time. These kinds of models are known as generative algorithms and are used in various fields to generate new and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Metro+Interstate+Traffic+Volume", "anchor_text": "Metro Interstate Traffic Volume Dataset", "paragraph_index": 3}], "all_paragraphs": ["The usage of deep learning models for instance generation is becoming popular over time. These kinds of models are known as generative algorithms and are used in various fields to generate new and unseen samples after studying a population of reference. The most famous adoption of these techniques is well documented in the computer vision domain, where various applications can generate images that don\u2019t exist before.", "The utility of the generative models is variegated and domain related. They can be useful to create new instances in a fast way where the manual creation of the same is more expensive or also not possible. They can simulate uncover situations that till that moment are not documented or missed. They can be used to generate different copies that vary from the original one of a certain degree of noise to have enough samples that replicate rare events.", "In this post, we present an application of VAE in a time series task. More precisely, we try to use a Variational AutoEncoder structure to fill some time series sequences that can be characterized by the presence of missing data in a real scenario. In the second stage, we also inspect the results produced by our trained VAE to investigate the possibility to produce augmented time-series samples.", "For our experiment, we choose the Metro Interstate Traffic Volume Dataset. It reports the hourly interstate traffic volume for a particular metro station roughly located midway between Minneapolis and St Paul. This dataset is also rich with additional useful information such as hourly weather features and holidays that may have an impact on traffic volume. Most of these additional attributes are available in the categorical format.", "Since the full history of traffic at our disposal is considerable but with some missing intervals, we decide to focus on the last 3 years of data. This is because the mentioned period seems to be consistent enough due to the rare presence of missing pieces that, in case, can be filled with simple interpolations to have a complete and valuable data source to develop our approach.", "As clearly visible and intuitable, the data show different levels of seasonality. Starting from the monthly aggregation, we can see a reduction in traffic level when people tend to go on holiday (Christmas/summer period). Weekly and hourly patterns are the results of human behaviors from the normal usage of the public transport system. Other analysis showed that in the presence of extreme events (such as snowstorms) the traffic can drastically change. This information is present as an additional categorical source.", "Our workflow is depicted as follows. Given a selected time interval of meaningful data, we force the introduction of some missing intervals (with a fixed length and proportion) in the data stream. The missing sequences form the main input for our Variational AutoEncoder that is trained to approximate the true sequences without missing pieces. Important to notice that we start from a complete data source, on which we insert random missing intervals because this enables us to make a comparison with the true reality and compute performance metrics.", "The second meaningful inputs of the VAE are sequences of integers that encode the additional information present as categorical features, i.e. month, weekday, hour, holiday, weather conditions. In correspondence with missing values in the raw traffic signals, we take care to substitute the corresponding categories with a special integer (let\u2019s say 0) to encode properly the status of \u2018missing information\u2019 (this is not valid for the month, weekday, hour which are known always for every date).", "The encoder consists of an LSTM cell. It receives as input 3D sequences resulting from the concatenation of the raw traffic data and the embeddings of categorical features. As in every encoder in a VAE architecture, it produces a 2D output that is used to approximate the mean and the variance of the latent distribution. The decoder samples from the 2D latent distribution upsampling to form 3D sequences. The generated sequences are then concatenated back with the original categorical embeddings which are passed through an LSTM cell to reconstruct the original traffic sequences.", "The training of a VAE is made minimizing a loss which is the combination of two pieces. A reconstruction part (scaled mean squared error in our case), that says how much the model can reproduce the target, and a regularization part (Kullback Leibler divergence), which acts as a constraint to make the latent space more similar to a normal distribution.", "The main purpose of our approach is to develop an unsupervised framework that can fill the missing pieces that appear in the traffic volume stream. To test the goodness of this task we reserve part of our data to compute performance metrics, like the classical MSE/RMSE to verify the reconstruction ability. We can also compute specific statistics only on the missing pieces subject to reconstruction. The test set is obtained with a simple temporal split on the last part of the dataset. This part is roughly composed of the same proportion of missing sequences as in the whole dataset.", "A second possible application of our trained model consists of using it to generate new sequences. This is a common behavior of all the VAE where the encoder and the decoder can be utilized separately to create new samples. The encoder projects the inputs in a specific region of the latent space. We use the coordinates of the projections to sample new points nearby. The \u2018vicinity\u2019 can be regulated by selecting a desired amount of variance. The latent points are passed through the decoder to operate the sequence generations. Obviously, the closer are the points more similar are the final reconstructions. Important to notice also that the goodness of the sample generation is strictly related to the reconstruction ability of the entire VAE.", "In this post, we introduced an application of Variational AutoEncoder for time-series analysis. We built a VAE based on LSTM cells that combines the raw signals with external categorical information and found that it can effectively impute missing intervals. We also tried to analyze the latent space learned by our model to explore the possibility to generate new sequences. Further work can be done to increase the performances, to adapt the procedure to other tasks, or find other interesting applications.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5a6426365a1c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----5a6426365a1c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a6426365a1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a6426365a1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://unsplash.com/@wilhelmgunkel?utm_source=medium&utm_medium=referral", "anchor_text": "Wilhelm Gunkel"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Metro+Interstate+Traffic+Volume", "anchor_text": "Metro Interstate Traffic Volume Dataset"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5a6426365a1c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5a6426365a1c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/variational-autoencoder?source=post_page-----5a6426365a1c---------------variational_autoencoder-----------------", "anchor_text": "Variational Autoencoder"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----5a6426365a1c---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----5a6426365a1c---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5a6426365a1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&user=Marco+Cerliani&userId=c843902314c7&source=-----5a6426365a1c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5a6426365a1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&user=Marco+Cerliani&userId=c843902314c7&source=-----5a6426365a1c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a6426365a1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5a6426365a1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5a6426365a1c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5a6426365a1c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5a6426365a1c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5a6426365a1c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5a6426365a1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-generation-with-vae-lstm-5a6426365a1c&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}