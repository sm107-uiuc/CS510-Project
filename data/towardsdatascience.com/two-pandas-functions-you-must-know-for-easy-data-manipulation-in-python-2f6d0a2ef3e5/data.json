{"url": "https://towardsdatascience.com/two-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5", "time": 1683004904.070961, "path": "towardsdatascience.com/two-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5/", "webpage": {"metadata": {"title": "Two Pandas functions you must know for easy data manipulation in Python | by JP Hwang | Towards Data Science", "h1": "Two Pandas functions you must know for easy data manipulation in Python", "description": "I do a lot of data work \u2014 some of it data science, some of it data visualisation, some of it data adjacent \u2014 like messing around with sports analytics. All of it is done in Python, and almost always\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/shivamb/netflix-shows", "anchor_text": "Netflix movie dataset", "paragraph_index": 3}, {"url": "https://www.kaggle.com", "anchor_text": "Kaggle", "paragraph_index": 3}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.set_option.html", "anchor_text": "documentation here", "paragraph_index": 13}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#why-does-assignment-fail-when-using-chained-indexing", "anchor_text": "found here", "paragraph_index": 16}, {"url": "https://twitter.com/_jphwang", "anchor_text": "twitter", "paragraph_index": 42}], "all_paragraphs": ["I do a lot of data work \u2014 some of it data science, some of it data visualisation, some of it data adjacent \u2014 like messing around with sports analytics. All of it is done in Python, and almost always Pandas is involved for data manipulation.", "I like to think that in all that time I learned a thing or two about using Pandas. The way I use Pandas is very different from how I used to when I first started dabbling in it a few years ago. The more I use Pandas, the less I find myself stepping outside of it for data manipulation. My impression is that my code has become more succinct and I\u2019ve saved a lot of time as a result.", "So in this article, I\u2019d like to share with you all a few functions that I now can\u2019t do without \u2014 I am sure that you\u2019ll find them as useful as I did.", "It\u2019s the time to stay indoors, so today I use the Netflix movie dataset from Kaggle. If nothing else, you might have discovered something to watch :).", "I assume you\u2019re familiar with python. Even if you\u2019re relatively new, this tutorial shouldn\u2019t be too tricky, though.", "You\u2019ll need pandas and plotly. Install each (in your virtual environment) with a simple pip install [PACKAGE_NAME].", "Load the Netflix csv data file into a Pandas DataFrame with:", "Let\u2019s inspect the DataFrame with the .head() method.", "Actually, that leads me to my first tip.", "If you\u2019re like me, and you don\u2019t work in Jupyter notebook or its variants, you might have been frustrated by the limited display width of Pandas in Python shells.", "This is what your output might look like when running nf_df.head().", "It\u2019s not all that useful. But wait! Pandas has a .set_option function which you can use to adjust the number of columns to display, and the overall width in which to display it. Set your parameters to something like:", "And now your shell will output something far more useful.", "There are other options which can be set via the .set_option function\u2014 take a look at the documentation here if you are interested.", "Have you ever come across this message?", "If this has never happened to you, you are a better person than I \u2014 you might have even learned Pandas properly through docs or a book.", "While the official explanation from Pandas can be found here; but the tl;dr version is that Pandas is warning you that it can\u2019t be certain whether you are operating on a copy of the DataFrame (in which case you might not be changing any values).", "This is one of the reasons to use .assign. Using .assign, a new object is returned to avoid potential confusion due to a SettingWithCopyWarning, which is often raised regardless of whether an actual problem exists.", "Following on, a more obvious reason is to create a new DataFrame where the existing DataFrame is left alone for whatever reason. As I mentioned, .assign returns a new object, so we can avoid any problems like this one:", "The first example prints 13, as we have accidentally modified the original DataFrame (nf_df), while in the second, the original DataFrame remains unchanged with 12 columns.", "Now, let\u2019s move on to .apply \u2014 which might be one of the most underrated Pandas functions :).", "If you\u2019re like me, you have probably tried to manipulate pandas data in a loop \u2014 maybe doing something like:", "Stop. There\u2019s no need for that.", "That\u2019s what the .apply method is there for. It applies a function to every element along an axis of the DataFrame. Let\u2019s take a look at some examples.", "Example 1 \u2014 Content count by release years", "Our DataFrame includes a column with the release year (release_year). The distribution can be plotted as below, and looks like this:", "What if we wanted to look at the data by decade? Simple \u2014 create a new column \u2018decade\u2019 as below:", "Here, we get the release_year column data by nf_df.release_year, and apply the lambda function lambda x: str(x)[:3]+\u20190s\u2019.", "Lambda functions can look confusing, but it is quite simple once you get used to it. Here, it grabs every element (x), and first applies the transformation str(x)[:3] to get the first 3 letters of the year string, and add \u20190s\u2019 to the end.", "So, take a look at a histogram of our new decade column:", "Also, you might have noticed my using .unique() method. It is an extremely useful method that will return an array of unique entities in that column \u2014 don\u2019t go without it!", "Okay. Let\u2019s go through one more example of using .apply.", "Example 2 \u2014 Content count by source country", "The DataFrame also includes a column (\u2018country\u2019) that (to my best knowledge) includes the source of the content.", "A quick look at the data (nf_df[\u2018country\u2019].nunique()) reveals that there are 555(!) unique entities in the country column. What is going on?", "As it turns out, many listings include multiple country names (e.g. \u2018United States, India, South Korea, China\u2019) \u2014 so, let\u2019s preserve the top 20 names, and change all the remaining names to \u2018Others\u2019.", "It\u2019s easy to do with .apply. I\u2019ll use two lines of code for clarity, but it\u2019s possible in just one. Ready?", "And that\u2019s it! Running nf_df[\u2018country\u2019].nunique() again, we see that there are only 21 \u2018countries\u2019 now.", "The lambda function here is a simple if\u2026 else statement, checking the \u2018country\u2019 entity against the list with the highest counts.", "Given that each column also includes the content type column, we can visualise breakdowns of content data by colouring in each bar by content type.", "Isn\u2019t that easy? Imagine doing that with some crazy looped function \u2014 finding the right indexer row/column numbers through .loc or .iloc indexers. No, thank you.", "With just these two short functions, you can do the same things that probably used to take lines and lines of code. Try it out \u2014 I\u2019d bet that you\u2019ll be pleasantly surprised, and improve your productivity.", "If you liked this, say \ud83d\udc4b / follow on twitter, or follow here for updates. ICYMI: I also wrote this article about building a web data dashboard with Plotly Dash.", "And also this article about visualising data across time for storytelling:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech / Data science writer & educator; Python dev; sports analytics enthusiast. \ud83c\udde6\ud83c\uddfa \ud83d\udc26: @_jphwang"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2f6d0a2ef3e5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@_jphwang?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": "JP Hwang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F964fe0870229&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&user=JP+Hwang&userId=964fe0870229&source=post_page-964fe0870229----2f6d0a2ef3e5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f6d0a2ef3e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f6d0a2ef3e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@stanyw?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Stan W."}, {"url": "https://unsplash.com/s/photos/pandas?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/shivamb/netflix-shows", "anchor_text": "Netflix movie dataset"}, {"url": "https://www.kaggle.com", "anchor_text": "Kaggle"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.set_option.html", "anchor_text": "documentation here"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#why-does-assignment-fail-when-using-chained-indexing", "anchor_text": "found here"}, {"url": "https://twitter.com/_jphwang", "anchor_text": "twitter"}, {"url": "https://towardsdatascience.com/build-a-web-data-dashboard-in-just-minutes-with-python-d722076aee2b", "anchor_text": "Build a web data dashboard in just minutes with PythonExponentially increase power & accessibility by converting your data visualizations into a web-based dashboard with\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/effectively-visualize-data-across-time-to-tell-better-stories-2a2c276e031e", "anchor_text": "Effectively visualize data across time to tell better storiesBuild clean, easy-to-read time-series data visualizations to support your narratives with Python and Plotly.towardsdatascience.com"}, {"url": "https://medium.com/tag/programming?source=post_page-----2f6d0a2ef3e5---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2f6d0a2ef3e5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/coding?source=post_page-----2f6d0a2ef3e5---------------coding-----------------", "anchor_text": "Coding"}, {"url": "https://medium.com/tag/technology?source=post_page-----2f6d0a2ef3e5---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/learning?source=post_page-----2f6d0a2ef3e5---------------learning-----------------", "anchor_text": "Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2f6d0a2ef3e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&user=JP+Hwang&userId=964fe0870229&source=-----2f6d0a2ef3e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2f6d0a2ef3e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&user=JP+Hwang&userId=964fe0870229&source=-----2f6d0a2ef3e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f6d0a2ef3e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2f6d0a2ef3e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2f6d0a2ef3e5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2f6d0a2ef3e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "JP Hwang"}, {"url": "https://medium.com/@_jphwang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F964fe0870229&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&user=JP+Hwang&userId=964fe0870229&source=post_page-964fe0870229--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F743cf2a1623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-pandas-functions-you-must-know-for-easy-data-manipulation-in-python-2f6d0a2ef3e5&newsletterV3=964fe0870229&newsletterV3Id=743cf2a1623e&user=JP+Hwang&userId=964fe0870229&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}