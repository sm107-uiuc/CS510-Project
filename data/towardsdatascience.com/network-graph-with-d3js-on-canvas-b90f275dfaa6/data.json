{"url": "https://towardsdatascience.com/network-graph-with-d3js-on-canvas-b90f275dfaa6", "time": 1683008304.467829, "path": "towardsdatascience.com/network-graph-with-d3js-on-canvas-b90f275dfaa6/", "webpage": {"metadata": {"title": "Network Graph with D3js on Canvas | by Ruben Trivi\u00f1o | Towards Data Science", "h1": "Network Graph with D3js on Canvas", "description": "Data visualization is a prism with many faces; where some see a simple bar chart, others see a clear growth trend or even an accomplished goal. There are many solutions for data graphing; from\u2026"}, "outgoing_paragraph_urls": [{"url": "https://buscoextra.es", "anchor_text": "BuscoExtra", "paragraph_index": 3}, {"url": "https://stenciljs.com/", "anchor_text": "Stencil", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/how-to-use-d3js-with-webcomponents-a75ae4f980de", "anchor_text": "here is how can do it super fast", "paragraph_index": 11}, {"url": "https://github.com/d3/d3-force", "anchor_text": "full reference here", "paragraph_index": 23}, {"url": "https://github.com/Anexon/interactiveNetworkGraphD3Stencil", "anchor_text": "this full project", "paragraph_index": 29}], "all_paragraphs": ["Data visualization is a prism with many faces; where some see a simple bar chart, others see a clear growth trend or even an accomplished goal.", "There are many solutions for data graphing; from enterprise applications like Tableau, QlikView, Carto or Datastudio, to do-it-yourself tools such as bokeh, matplotlib or d3.js. The truth is that each situation requires a different approach and many already offer more than enough, there is no need to reinvent the wheel if it is not necessary but\u2026 If you are in need of a DIY solution you have come to the right place.", "This time, we are going to explore an example of a network graphic using the HTML Canvas element. The Canvas element allows us to draw content without the need to store all the visual elements in the DOM, as it is the case when using an SVG for the graphing. This allows the creation of graphics with a high volume of elements without loosing performane caused by the browser rendering process.", "The graph that we are going to see is a diagram of nodes linked by lines that represent the relationship between them. The dataset used is from BuscoExtra where I work as operation analyst. In a nutshell, BuscoExtra is a staffing agency focused on hospitality. In Spain, employers need to draft a legal employment contract to hire employees even for small jobs that last only a few hours.", "So, the data structure stores different employment contracts that were generated in a certain period of time and these will be the lines while the restaurants, or employers, and waiters, or employees, will be the nodes of our diagram.", "Therefore, there are two types of nodes: Worker and Establishment. We will use two colors to distinguish between them and a smaller radius for the Worker nodes as they appear in a bigger amount.", "Nodes of type Establishment have a radius that varies with the number of workers that they have hired. So, the smaller nodes are related to those with less amount of Worker nodes linked to them.", "In addition, as a contract between Worker and Establishment may occur multiple times we will add a variable named interactions so lines between nodes will be wider or thinner depending on the number of interactions. We may see an example in the next picture:", "All these features are in fact different dimensions that enrich the graph and as someone said: a picture worth more than a thousand words. I believe that too.", "In another data structure we could use a range of colors to represent the nodes according to some other criterion; use different shapes according to the type of node (squares, triangles, etc..) or better still, change the type of line that joins the nodes according to the type of connection: dashed, punctuated line, different color, etc..", "We could use a variety of properties to arrange the information and add additional dimensions, as some do with Spotify to display the music styles, representing the more distant styles on opposite poles. The possibilities are simply endless, limited only by our creativity.", "First we create a base project in Stencil and provide the data structure in the input parameters (here is how can do it super fast).", "Once we have the data in the component, we will begin to define the drawing strategy. Unlike SVG, in Canvas we will use the properties of a brush: thickness, color, etc.. In addition, we will have to be updating the position of the brush within the canvas as we draw. Therefore, in Canvas we don\u2019t put elements into the painting, there is only what we have already painted, while in SVG the elements are placed through the properties of labels <g>, <image>, <text>, etc..", "Canvas offers painting operations to make basic geometries: lines, circles, arcs, squares, etc. We will have to do everything with these shapes. But don\u2019t worry, if you think about it, for this graphic we only have to draw circles and lines. It\u2019s easy, isn\u2019t it? It is.", "In the next code snippet we may see the steps required to draw a node:", "Three main things happen in this function: we begin the path of the drawing, set up the painting parameters (color, width, etc..) and the brush movement that generates a shape.", "All operations over Canvas are made through its context which we get when selecting HTML element using D3.js.", "Next code snippet shows the steps required to draw a link:", "This funciton is even easier, a part from the brush set up the difference between previus steps is that we call lineTo instead of arc.", "Once we have the functions to draw the nodes and lines we can define the general drawing operation:", "In this function we call the drawing methods for each node and link. In addition, with the functions clearRect, save and restore we clean the canvas and restore it in each iteration, so that the previous operations are not being overlapped.", "Remember, until now we haven\u2019t used D3.js, we have only created the logic to draw our elements. With D3 we will obtain the information we are missing yet: the actual position of the elements.", "All the painting operations make reference to the position of the nodes. However, the initial data structure only contains references between nodes, number of iterations, relationships, and so on, and does not contain anything related to the actual position of the elements.", "To get the elements\u2019 position we will use D3, specifically the function forceSimulation (full reference here). This function performs a simulation in which the position of the elements is updated and it modifies the original data structure.", "forceSimulation performs a force simulation from a list of nodes. Initially our nodes have no position and this is the one in charge of establishing the Xand Y values of each node in each iteration. For this reason, in the GIF at the begining of this article it is seen as an explosion of nodes from the center, it is the beginning of the simulation.", "This function allows us to provide a list of nodes, declare a series of forces and subscribe to each iteration of the simulation, where we will have the updated positions of the nodes and will allow us to draw. The forces we can declare are:", "Function tick is called for each iteration of the simulation and we can take advantage of it to draw our nodes thus obtaining an animation effect.", "HTML Canvas element introduces a series of complexities as it does not have a reference to the drawn elements, having to perform iterative operations on the data and store the position of the elements in order to update their status. However, the data structure is stored exclusively in the VirtualDOM, unlike SVG, whose data structure is rendered in the DOM and redrawn after any user interaction with the visual elements. This generates an important reduction in painting operations, specially when operating with thousands or hundreds of thousands of visual elements. However, when the surface to be painted is very large, Canvas loses overwhelmingly against the SVG.", "Drawing thousands of data points may not be every case or a pre-processing of the data may be done on the server before the drawing pocess. However, sometimes it is unavoidable and in these cases the Canvas element could be a solution when the SVG simply freezes the browser.", "If you would like to reproduce the process completely by your own you may check this full project with interactive functionalities using both Canvas and SVG. In addition, I include dataset files so you may explore the data structure or change it with one of yours.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb90f275dfaa6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@benru?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@benru?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": "Ruben Trivi\u00f1o"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44d1145c4fc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&user=Ruben+Trivi%C3%B1o&userId=44d1145c4fc8&source=post_page-44d1145c4fc8----b90f275dfaa6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb90f275dfaa6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb90f275dfaa6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/Anexon/interactiveNetworkGraphD3Stencil", "anchor_text": "Rub\u00e9n Trivi\u00f1o"}, {"url": "https://towardsdatascience.com/how-to-use-d3js-with-webcomponents-a75ae4f980de", "anchor_text": "How to use D3 with Web Components."}, {"url": "https://buscoextra.es", "anchor_text": "BuscoExtra"}, {"url": "https://i.redd.it/rxbclwgstcu41.jpg", "anchor_text": "Reddit:"}, {"url": "https://www.reddit.com/user/Enguzelharf/", "anchor_text": "u/Enguzelharf"}, {"url": "https://stenciljs.com/", "anchor_text": "Stencil"}, {"url": "https://towardsdatascience.com/how-to-use-d3js-with-webcomponents-a75ae4f980de", "anchor_text": "here is how can do it super fast"}, {"url": "https://github.com/d3/d3-force", "anchor_text": "full reference here"}, {"url": "https://github.com/Anexon/interactiveNetworkGraphD3Stencil", "anchor_text": "this full project"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----b90f275dfaa6---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/d3js?source=post_page-----b90f275dfaa6---------------d3js-----------------", "anchor_text": "D3js"}, {"url": "https://medium.com/tag/web-development?source=post_page-----b90f275dfaa6---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/tag/javascript?source=post_page-----b90f275dfaa6---------------javascript-----------------", "anchor_text": "JavaScript"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----b90f275dfaa6---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb90f275dfaa6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&user=Ruben+Trivi%C3%B1o&userId=44d1145c4fc8&source=-----b90f275dfaa6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb90f275dfaa6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&user=Ruben+Trivi%C3%B1o&userId=44d1145c4fc8&source=-----b90f275dfaa6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb90f275dfaa6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb90f275dfaa6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b90f275dfaa6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b90f275dfaa6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@benru?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@benru?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ruben Trivi\u00f1o"}, {"url": "https://medium.com/@benru/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "38 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44d1145c4fc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&user=Ruben+Trivi%C3%B1o&userId=44d1145c4fc8&source=post_page-44d1145c4fc8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F44d1145c4fc8%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetwork-graph-with-d3js-on-canvas-b90f275dfaa6&user=Ruben+Trivi%C3%B1o&userId=44d1145c4fc8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}