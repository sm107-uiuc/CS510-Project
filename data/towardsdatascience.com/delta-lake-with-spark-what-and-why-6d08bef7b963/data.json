{"url": "https://towardsdatascience.com/delta-lake-with-spark-what-and-why-6d08bef7b963", "time": 1683012864.609969, "path": "towardsdatascience.com/delta-lake-with-spark-what-and-why-6d08bef7b963/", "webpage": {"metadata": {"title": "Delta lake with Spark: What and Why? | by Jyoti Dhiman | Towards Data Science", "h1": "Delta lake with Spark: What and Why?", "description": "Let me start by introducing two problems that I have dealt time and again with my experience with Apache Spark: Sometimes I solved above with Design changes, sometimes with the introduction of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://delta.io/", "anchor_text": "Delta Lake", "paragraph_index": 6}, {"url": "https://github.com/delta-io/delta", "anchor_text": "open source storage layer", "paragraph_index": 6}, {"url": "https://databricks.com/discover/data-lakes/introduction", "anchor_text": "data lakes", "paragraph_index": 6}], "all_paragraphs": ["Let me start by introducing two problems that I have dealt time and again with my experience with Apache Spark:", "Sometimes I solved above with Design changes, sometimes with the introduction of another layer like Aerospike, or sometimes by maintaining historical incremental data.", "Maintaining historical data is mostly an immediate solution but I don\u2019t really like dealing with historical incremental data if it\u2019s not really required as(at least for me) it introduces the pain of backfill in case of failures which may be unlikely but inevitable.", "The above two problems are \u201cproblems\u201d because Apache Spark does not really support ACID. I know it was never Spark\u2019s use case to work with transactions(hello, you can\u2019t have everything) but sometimes, there might be a scenario(like my two problems above) where ACID compliance would have come in handy.", "When I read about Delta Lake and its ACID compliance, I saw it as one of the possible solutions for my two problems. Please read on to find out how the two problems are related to ACID compliance failure and how delta lake can be seen as a savior?", "Delta Lake Documentation introduces Delta lake as:", "Delta Lake is an open source storage layer that brings reliability to data lakes. Delta Lake provides ACID transactions, scalable metadata handling, and unifies streaming and batch data processing. Delta Lake runs on top of your existing data lake and is fully compatible with Apache Spark APIs.", "Consider the following piece of code to remove duplicates from a dataset:", "For my spark application running above piece of code consider a scenario where it fails on Line 4, that is while writing the data. This may or may not lead to data loss. [Problem #1: As mentioned above].You can replicate the scenario, by creating a test dataset and kill the job when it\u2019s in the Write stage.", "Let us try to understand ACID failure in spark with the above scenario.", "Delta lake maintains a delta log in the path where data is written. Delta Log maintains details like:", "Sample log file in _delta_log_ directory created after some operations:", "After successful execution, a log file is created in the _delta_log_ directory. The important thing to note is when you save your data as delta, no files once written are removed. The concept is similar to versioning.", "By keeping track of paths removed, added and other metadata information in the _delta_log_, Delta lake is ACID-compliant.", "Versioning enables time travel property of Delta Lake, which is, I can go back to any state of data because all this information is being maintained in _delta_log_.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6d08bef7b963&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mycupoftea00.medium.com/?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": ""}, {"url": "https://mycupoftea00.medium.com/?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": "Jyoti Dhiman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c38262e7804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&user=Jyoti+Dhiman&userId=8c38262e7804&source=post_page-8c38262e7804----6d08bef7b963---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d08bef7b963&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d08bef7b963&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@franki?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Franki Chamaki"}, {"url": "https://unsplash.com/s/photos/big-data?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://delta.io/", "anchor_text": "Delta Lake"}, {"url": "https://github.com/delta-io/delta", "anchor_text": "open source storage layer"}, {"url": "https://databricks.com/discover/data-lakes/introduction", "anchor_text": "data lakes"}, {"url": "https://medium.com/tag/delta-lake?source=post_page-----6d08bef7b963---------------delta_lake-----------------", "anchor_text": "Delta Lake"}, {"url": "https://medium.com/tag/apache-spark?source=post_page-----6d08bef7b963---------------apache_spark-----------------", "anchor_text": "Apache Spark"}, {"url": "https://medium.com/tag/big-data?source=post_page-----6d08bef7b963---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----6d08bef7b963---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/data?source=post_page-----6d08bef7b963---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d08bef7b963&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&user=Jyoti+Dhiman&userId=8c38262e7804&source=-----6d08bef7b963---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d08bef7b963&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&user=Jyoti+Dhiman&userId=8c38262e7804&source=-----6d08bef7b963---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d08bef7b963&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6d08bef7b963&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6d08bef7b963---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6d08bef7b963--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6d08bef7b963--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6d08bef7b963--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6d08bef7b963--------------------------------", "anchor_text": ""}, {"url": "https://mycupoftea00.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mycupoftea00.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jyoti Dhiman"}, {"url": "https://mycupoftea00.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "546 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c38262e7804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&user=Jyoti+Dhiman&userId=8c38262e7804&source=post_page-8c38262e7804--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1157276dcbca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-with-spark-what-and-why-6d08bef7b963&newsletterV3=8c38262e7804&newsletterV3Id=1157276dcbca&user=Jyoti+Dhiman&userId=8c38262e7804&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}