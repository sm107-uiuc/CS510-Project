{"url": "https://towardsdatascience.com/6-things-to-know-to-master-k-means-clustering-1d5be9b189dd", "time": 1683015419.5698152, "path": "towardsdatascience.com/6-things-to-know-to-master-k-means-clustering-1d5be9b189dd/", "webpage": {"metadata": {"title": "6 Things to Know to Master K-Means Clustering | by Yong Cui | Towards Data Science", "h1": "6 Things to Know to Master K-Means Clustering", "description": "How many types of customers are there on the market? How many types of players are there in the NBA? How many types of students are there in the Ivy League schools? There are many questions in real\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Cluster_analysis", "anchor_text": "Wikipedia", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/clustering-metrics-better-than-the-elbow-method-6926e1f723a6", "anchor_text": "Medium article", "paragraph_index": 20}, {"url": "https://www.manning.com/books/python-how-to", "anchor_text": "https://www.manning.com/books/python-how-to", "paragraph_index": 30}], "all_paragraphs": ["How many types of customers are there on the market? How many types of players are there in the NBA? How many types of students are there in the Ivy League schools?", "There are many questions in real life like these \u2014 the questions that are trying to understand the types of people (as well as objects) in a particular setting. By understanding what types of people that we\u2019re interested in, we can develop corresponding strategies to address our particular needs.", "For instance, let\u2019s say that marketing research in general has found that there are two types of customers on the market \u2014 one more sensitive to price increases and the other less sensitive to price increases. By studying the customers of your product, you can decide if you want to increase your product price or not to cover the increasing cost. Suppose that if most of your customers are price sensitive, you should be more cautious about the potential drop in sales if you do decide to increase your prices.", "It\u2019s just a trivial example that speaks to the actual application of cluster analysis. Here\u2019s the definition of clustering from the Wikipedia page.", "Cluster analysis or clustering is the task of grouping a set of objects in such a way that objects in the same group (called a cluster) are more similar (in some sense) to each other than to those in other groups (clusters).", "Related to the example given above, the process of identifying the types of customers for your product is conducting cluster analysis. It should be noted that there are various clustering methods, and the most commonly used one is called K-means clustering. In this article, I\u2019d like to review some key aspects of K-means and I hope that you\u2019ll have a better understanding of this popular clustering method.", "Before we start to explore K-means, the following animated figure intuitively shows you how a common K-means works through multiple iterations before reaching the final clustering result.", "The very first question is how we determine clustering or how we determine which cluster a particular sample should be assigned to. There are several categories of clustering methods available, including connectivity-based (i.e., hierarchical), grid-based, distribution-based, density-based, and prototype-based. Among them, K-means clustering belongs to the prototype-based category.", "To conceptualize the prototype-based clustering method, you can think of that for each cluster, there is a prototype data point, which represents what a typical member of the specific cluster should look like. It should be noted that the prototype data point is estimated from the data points that belong to the cluster and doesn\u2019t have to be an actual case of the original dataset.", "However, some algorithms require that the prototype data point has to be an actual data point, and it\u2019s referred to as K-medoid clustering. In most applications involving continuous features, the K-means refers to the use of the centroid as the prototype data point.", "Using the animated image as shown above as an example, let\u2019s say that we have picked three centroids for the clusters as the initial seeds. How do we determine which cluster we should assign our samples?", "To assign a data point, we need to calculate the distance between the data point and each of the centroids that we just picked. The distance is considered the similarity between data points \u2014 the closer the more similar between the data point to the centroid. The most commonly used measure is the squared Euclidean distance (SED), as shown above. If you think about a 2-dimensional feature, it\u2019s basically the distance between two data points on a Cartesian plane that we\u2019re probably most familiar with.", "By calculating these distances, we\u2019re able to assign the data point to the cluster which produces the least SED. Once each of the data points has been assigned, we\u2019re able to get updated centroids for our clusters and calculate the total sum of squared errors (SSE) of all applicable SED within each cluster. If you\u2019re familiar with the terminology in machine learning. You can think of the intra-cluster SSE as the output for the cost function that the K-means clustering tries to minimize, which makes the K-means more or less an optimization problem.", "In the next iteration, we assign data points to the updated centroids and calculate the SSE again to see if it\u2019s reduced or not. Until no further improvement (the SSE has become small enough and stable), we can conclude that the K-means clustering is done.", "When we run the K-means cluster analysis, we have to specify the number of clusters, a priori. It\u2019s sometimes considered a drawback for K-means methods because, for some dataset, we don\u2019t know how many clusters are reasonable. After all, we don\u2019t have the ground truth about the clusters that our data points belong to \u2014 otherwise, it becomes a supervised learning task if we do.", "If we\u2019re only dealing with 2-dimensional or 3-dimensional data, we can visualize the data to have some hypotheses regarding the number of clusters. However, with higher dimensions, it\u2019s not very possible to visualize the data in a human-understandable manner. Thus, it\u2019s best for you to use the related background content expertise and have an educated guess regarding the probable number of clusters for your data. Start with that and see how your clustering does.", "But the outstanding question is how we evaluate which clustering performance is better than others when we have different numbers of clusters.", "We\u2019ve talked about in Section 2 regarding the cluster assignment of our data points using the SED and the iterative optimization using the SSE. At the conclusion of the iterations, we\u2019ve arrived with a model (specific cluster assignment of all members) that has the least SSE.", "By varying the number of clusters for each clustering analysis of the same dataset, we can derive the SSE values for each model. With these data, we can plot a line figure as a function of the number of clusters and the SSE values, the latter of which is often referred to as the distortion. A trivial example of a hypothetical clustering model is shown below.", "As shown in the figure, there is a sharp turn when the number of clusters is 3. It means that beyond the three cluster methods, there is no meaningful increase in our clustering performance (not much reduction). As a result, it\u2019s meaningful to say that three is a good number of clusters to pick.", "Please note that besides the elbow method, we can also use the silhouette plot to evaluate the performance between models of different cluster numbers. If you\u2019re interested, here\u2019s an excellent Medium article on this topic.", "When we have multiple features for K-means clustering, chances are that the initial dataset has different scales for these features. For instance, let\u2019s say that one scale is the height of students measured in meters and the other scale is weight measures in kilograms. As you can expect, the absolute values of the variance for these scales can be very different.", "For the height, the variance is likely in the level of decimal values level, however, the weight can have a much larger variance. When our K-means clustering iterates to optimize the model, it\u2019ll try its best to rely more on reducing the SSE from the contribution of the weight. See the problem? The optimization will take the shortcut by more or less neglecting the contribution from the height scale.", "The solution is that we should standardize the data points by bringing individual scales to the same or similar level of the range. Usually, we can run the Z-score normalization and uses the standardized Z scores for each feature. Alternatively, you can also run the min-max scaling. Please note that the performance of these two methods will be dataset dependent, and there is no set rule regarding which one is definitely better than the other one.", "When we run the K-means clustering analysis, we start with randomly picked centroids. By multiple iterations, we\u2019ll be able to reach a model whose SSE has reached the minimum \u2014 with the contingency that the minimum is directly related to the initial centroids that were randomly picked. As mentioned previously, the centroids get updated iteratively and each iteration is built upon the result of the previous iteration.", "Therefore, the final model that we\u2019ll get will be related to the centroids that get picked before the first iteration. In other words, the initialization of the centroids directly impacts the final model that we\u2019re getting.", "Thus, in practice, for example, in scikit-learn implementations, we usually run the K-means clustering analysis multiple times and pick the best performer among these models. Although we can randomly pick our initial centroids, a better way is to use the so-called K-means++ initialization method. Briefly, instead of choosing the centroids randomly, K-mean++ is an algorithm that uses a probabilistic distribution to pick the initial centroids, which increases the performance of the K-means clustering.", "As a side note, in the scikit-learn K-means implementation, the default initialization method is the K-means++ method, so we don\u2019t need to worry about the choice of initial centroids.", "To conclude, this article reviews some key aspects of conducting K-means clustering analysis. Here\u2019s a quick overview of the steps for a typical K-means clustering analysis.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Work at the nexus of biomedicine, data science & mobile dev. Author of Python How-to by Manning (https://www.manning.com/books/python-how-to)."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1d5be9b189dd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yongcui01.medium.com/?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": ""}, {"url": "https://yongcui01.medium.com/?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": "Yong Cui"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88ff1e2545d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&user=Yong+Cui&userId=88ff1e2545d0&source=post_page-88ff1e2545d0----1d5be9b189dd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d5be9b189dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d5be9b189dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alex_andrews?utm_source=medium&utm_medium=referral", "anchor_text": "Alexander Andrews"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Cluster_analysis", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering#/media/File:K-means_convergence.gif", "anchor_text": "Wikipedia"}, {"url": "https://commons.wikimedia.org/wiki/User:Chire", "anchor_text": "Chire"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0", "anchor_text": "CC BY-SA 4.0"}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "Wikipedia"}, {"url": "https://towardsdatascience.com/clustering-metrics-better-than-the-elbow-method-6926e1f723a6", "anchor_text": "Medium article"}, {"url": "https://medium.com/tag/k-means?source=post_page-----1d5be9b189dd---------------k_means-----------------", "anchor_text": "K Means"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1d5be9b189dd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----1d5be9b189dd---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1d5be9b189dd---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1d5be9b189dd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1d5be9b189dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&user=Yong+Cui&userId=88ff1e2545d0&source=-----1d5be9b189dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1d5be9b189dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&user=Yong+Cui&userId=88ff1e2545d0&source=-----1d5be9b189dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d5be9b189dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1d5be9b189dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1d5be9b189dd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1d5be9b189dd--------------------------------", "anchor_text": ""}, {"url": "https://yongcui01.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yongcui01.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yong Cui"}, {"url": "https://yongcui01.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.5K Followers"}, {"url": "https://www.manning.com/books/python-how-to", "anchor_text": "https://www.manning.com/books/python-how-to"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88ff1e2545d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&user=Yong+Cui&userId=88ff1e2545d0&source=post_page-88ff1e2545d0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fef441bd78519&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-things-to-know-to-master-k-means-clustering-1d5be9b189dd&newsletterV3=88ff1e2545d0&newsletterV3Id=ef441bd78519&user=Yong+Cui&userId=88ff1e2545d0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/python-how-to", "anchor_text": "Python How-To2023"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}