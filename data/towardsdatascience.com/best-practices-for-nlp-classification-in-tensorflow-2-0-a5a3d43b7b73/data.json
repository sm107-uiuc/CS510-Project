{"url": "https://towardsdatascience.com/best-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73", "time": 1683001243.7316968, "path": "towardsdatascience.com/best-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73/", "webpage": {"metadata": {"title": "Best Practices for NLP Classification in TensorFlow 2.0 | by Ralph Brooks | Towards Data Science", "h1": "Best Practices for NLP Classification in TensorFlow 2.0", "description": "Use Data Pipelines, Transfer Learning and BERT to achieve 85% accuracy in Sentiment Analysis"}, "outgoing_paragraph_urls": [{"url": "https://www.fast.ai/", "anchor_text": "fast.ai", "paragraph_index": 0}, {"url": "https://github.com/huggingface/transformers", "anchor_text": "Huggingface\u2019s Transformers library", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "BERT", "paragraph_index": 1}, {"url": "https://github.com/ralphbrooks/tensorflow-tutorials", "anchor_text": "https://github.com/ralphbrooks/tensorflow-tutorials", "paragraph_index": 2}, {"url": "https://www.whiteowleducation.com/", "anchor_text": "https://www.whiteowleducation.com/", "paragraph_index": 32}], "all_paragraphs": ["When I first started working with Deep Learning, I went through Coursera and fast.ai courses, but afterwards I wondered where to go from here. I started asking questions like \u201cHow do I develop a data pipeline for a model?\u201d and \u201cHow do I implement state-of-the-art research?\u201d.", "This blog post answers these questions. The post covers the development a deep learning model in TensorFlow 2.0 from the ingestion of data all the way to the point where deep learning determines the emotion of a Yelp review (positive or negative). After reading this post, you will also be able to use Huggingface\u2019s Transformers library [1] in order to create state of the art models using a new technique called transfer learning and using a \u201cmodel backbone\u201d from Google (BERT [2]) that was pre-trained on Wikipedia.", "The full code is located on my GitHub at https://github.com/ralphbrooks/tensorflow-tutorials", "One of the keys to success in Deep Learning is to iterate quickly. If we are going to build a predictive model, it makes sense to store data once and write multiple experimental models based on that data. If we are going to build a predictive model, we want to put together a data pipeline where we can look at rows of information but where we don\u2019t have to process all of the information before we train our model.", "To illustrate these best practices, I am going to walk through the steps of creating a model that predicts sentiment (\u2018Negative\u2019 or \u2018Positive\u2019 sentiment) based on a Yelp reviews of cell phone stores. I will use the Yelp API to extract random reviews for stores associated with the keyword \u201cAT&T\u201d. and the associated rating (the \u201csentiment\u201d). Our goal is to see if we can create a deep learning model that can determine sentiment based ONLY on the text.", "Our goal is to predict sentiment. The TensorFlow abstraction of understanding the relationships between labels (the Yelp ratings) and features (the reviews) is commonly referred to as a model.", "The first step in this process is to think about the necessary inputs that will feed into this model. At this stage, it is helpful to think about the reviews and the sentiment score as a logical grouping. TensorFlow refers to this logical grouping as a tf.train.Example.", "For our use case, we should start by defining the example. That definition is as follows:", "Next, we are going to store these examples in an efficient manner in files called TFRecords.", "Example code that writes out this information looks like the following:", "In summary, using TFRecords for storage allows you to do to a preliminary cleanup of data, and to store this data efficiently for use by multiple models.", "The second step is to create a data pipeline that will feed your features (the reviews) and the labels (the sentiment score) from the saved file (the TFRecord) into some type of neural network. In TensorFlow, data pipelines can be implemented using tf.data.Dataset.", "tf.data.Dataset sets up your transformations without actually processing them until your model starts to train. This is critical if you are testing out your pipeline. Said differently, the last thing in the world that you want to do is to wait 3\u20134 minutes during different steps of data transformation because the previous transformation step is still running on all available data. It is better to have each step of the transformation pipeline operate on a small amount of data (a single batch of data) so that you can debug your pipeline faster.", "The following code will help to make this concept more concrete:", "As seen below, a pipeline can also be used to clean up data.", "In our example, we are attempting to get an understanding of human language and what emotion is contained in sentences. The first challenge that we have limited data; our model will only examine 738 reviews in order to determine sentiment.", "If we predicted missing words from all pages in Wikipedia, the deep learning model would have enough data to detect basic language patterns, but I do not have enough computing power to process this information.", "Because of these constraints, we are going to look at a model that has been pre-trained by another company and fine-tune this model with our limited training data (a concept typically called transfer learning). Specifically, we will use the BERT model from Google which has already been trained on Wikipedia information.", "Another best practice is to use proven frameworks when available. A startup company called Hugging Face has a framework called Transformers that makes it easier to use pre-trained models, and the following code shows how to convert words into numbers (tokenization) and to use the BERT model (TFBertForSequenceClassification)", "The Hugging Face Transformers framework also makes it easy to convert our data pipelines into something that can be understood by the BERT model.", "Now, we are ready to train the model. If we run the model for 3 iterations (epochs), we see accuracy of 85 %.", "This is still good considering that the Yelp rating captures the full sentiment of the user, but that in many cases, the Yelp API is only giving you part of the actual text review.", "The visualization of the 85% accuracy looks like the following:", "The matrix above shows the following:", "\u00b7 If the person is expressing negative sentiment, the classifier gets it right 91% of the time.", "\u00b7 If the customer expresses positive sentiment, our model gets this right roughly 66% of the time.", "Congratulations! You made it to the end of the blog post, and you now have a process that takes you from building a data pipeline to having an accurate model.", "1) T. Wolf, L. Debut, V. Sanh, J. Chaumond, C. Delangue, and A. Moi. Huggingface\u2019s Transformers: State-of-the-art Natural Language Processing. arXiv e-prints, October 2019.", "2) J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova. BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. arXiv e-prints, October 2018.", "Do you want to keep up with the current trends in artificial intelligence? Are you looking to process streaming data in real time or are you looking to deploy models into production?", "If so, my company can help \u2014 Check us at out https://www.whiteowleducation.com", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am the CEO of White Owl Education. Our company just released a course on 3D data visualization. Details at https://www.whiteowleducation.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa5a3d43b7b73&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ralph-a-brooks.medium.com/?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": ""}, {"url": "https://ralph-a-brooks.medium.com/?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": "Ralph Brooks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d6473be760d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&user=Ralph+Brooks&userId=3d6473be760d&source=post_page-3d6473be760d----a5a3d43b7b73---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa5a3d43b7b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa5a3d43b7b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.shutterstock.com/g/jirsak", "anchor_text": "Jirsak"}, {"url": "https://www.shutterstock.com/image-photo/best-practice-concept-manager-businessman-coach-389578870?src=6771d7ae-169b-49d0-b929-1e0e91347c57-1-30", "anchor_text": "Shutterstock"}, {"url": "https://www.fast.ai/", "anchor_text": "fast.ai"}, {"url": "https://github.com/huggingface/transformers", "anchor_text": "Huggingface\u2019s Transformers library"}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "BERT"}, {"url": "https://github.com/ralphbrooks/tensorflow-tutorials", "anchor_text": "https://github.com/ralphbrooks/tensorflow-tutorials"}, {"url": "https://www.shutterstock.com/g/nifty", "anchor_text": "Neale Cousland"}, {"url": "https://www.shutterstock.com/image-photo/water-pipelines-hydroelectric-power-station-australias-489908086?src=efd217dd-e435-4544-b5b3-fc39eeffb747-1-15", "anchor_text": "Shutterstock"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a5a3d43b7b73---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----a5a3d43b7b73---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/nlp?source=post_page-----a5a3d43b7b73---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a5a3d43b7b73---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa5a3d43b7b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&user=Ralph+Brooks&userId=3d6473be760d&source=-----a5a3d43b7b73---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa5a3d43b7b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&user=Ralph+Brooks&userId=3d6473be760d&source=-----a5a3d43b7b73---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa5a3d43b7b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa5a3d43b7b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a5a3d43b7b73---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a5a3d43b7b73--------------------------------", "anchor_text": ""}, {"url": "https://ralph-a-brooks.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ralph-a-brooks.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ralph Brooks"}, {"url": "https://ralph-a-brooks.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "56 Followers"}, {"url": "https://www.whiteowleducation.com/", "anchor_text": "https://www.whiteowleducation.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d6473be760d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&user=Ralph+Brooks&userId=3d6473be760d&source=post_page-3d6473be760d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff5a8d9fdd470&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbest-practices-for-nlp-classification-in-tensorflow-2-0-a5a3d43b7b73&newsletterV3=3d6473be760d&newsletterV3Id=f5a8d9fdd470&user=Ralph+Brooks&userId=3d6473be760d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}