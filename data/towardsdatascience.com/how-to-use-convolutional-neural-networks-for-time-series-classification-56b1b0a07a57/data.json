{"url": "https://towardsdatascience.com/how-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57", "time": 1683000732.818173, "path": "towardsdatascience.com/how-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57/", "webpage": {"metadata": {"title": "How to Use Convolutional Neural Networks for Time Series Classification | by Margarita Granat | Towards Data Science", "h1": "How to Use Convolutional Neural Networks for Time Series Classification", "description": "A large amount of data is stored in the form of time series: stock indices, climate measurements, medical tests, etc. Time series classification has a wide range of applications: from identification\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["A large amount of data is stored in the form of time series: stock indices, climate measurements, medical tests, etc. Time series classification has a wide range of applications: from identification of stock market anomalies to automated detection of heart and brain diseases.", "There are many methods for time series classification. Most of them consist of two major stages: on the first stage you either use some algorithm for measuring the difference between time series that you want to classify (dynamic time warping is a well-known one) or you use whatever tools are at your disposal (simple statistics, advanced mathematical methods etc.) to represent your time series as feature vectors. In the second stage you use some algorithm to classify your data. It can be anything from k-nearest neighbors and SVMs to deep neural network models. But one thing unites these methods: they all require some kind of feature engineering as a separate stage before classification is performed.", "Fortunately, there are models that not only incorporate feature engineering in one framework, but also eliminate any need to do it manually: they are able to extract features and create informative representations of time series automatically. These models are recurrent and convolutional neural networks (CNNs).", "Research has shown that using CNNs for time series classification has several important advantages over other methods. They are highly noise-resistant models, and they are able to extract very informative, deep features, which are independent from time. In this article we will examine in detail how exactly the 1-D convolution works on time series. Then, I will give an overview of a more sophisticated model proposed by the researchers from Washington University in St. Louis. Finally, we will look at a simplified multi-scale CNN code example.", "Imagine a time series of length n and width k. The length is the number of timesteps, and the width is the number of variables in a multivariate time series. For example, for electroencephalography it is the number of channels (nodes on the head of a person), and for a weather time series it can be such variables as temperature, pressure, humidity etc.", "The convolution kernels always have the same width as the time series, while their length can be varied. This way, the kernel moves in one direction from the beginning of a time series towards its end, performing convolution. It does not move to the left or to the right as it does when the usual 2-D convolution is applied to images.", "The elements of the kernel get multiplied by the corresponding elements of the time series that they cover at a given point. Then the results of the multiplication are added together and a nonlinear activation function is applied to the value. The resulting value becomes an element of a new \u201cfiltered\u201d univariate time series, and then the kernel moves forward along the time series to produce the next value. The number of new \u201cfiltered\u201d time series is the same as the number of convolution kernels. Depending on the length of the kernel, different aspects, properties, \u201cfeatures\u201d of the initial time series get captured in each of the new filtered series.", "The next step is to apply global max-pooling to each of the filtered time series vectors: the largest value is taken from each vector. A new vector is formed from these values, and this vector of maximums is the final feature vector that can be used as an input to a regular fully connected layer. This whole process is illustrated in the picture above.", "With this simple example in mind, let\u2019s examine the model of a multi-scale convolutional neural network for time series classification [1].", "The multi-scalability of this model consists in its architecture: in the first convolutional layer the convolution is performed on 3 parallel independent branches. Each branch extracts features of different nature from the data, operating at different time and frequency scales.", "The framework of this network consists of 3 consecutive stages: transformation, local convolution, and full convolution.", "On this stage different transformations are applied to the original time series on 3 separate branches. The first branch transformation is identity mapping, meaning that the original time series remains intact.", "The second branch transformation is smoothing the original time series with a moving average with various window sizes. This way, several new time series with different degrees of smoothness are created. The idea behind this is that each new time series consolidates information from different frequencies of the original data.", "Finally, the third branch transformation is down-sampling the original time series with various down-sampling coefficients. The smaller the coefficient, the more detailed the new time series is, and, therefore, it consolidates information about the time series features on a smaller time scale. Down-sampling with larger coefficients results in less detailed new time series which capture and emphasize those features of the original data that exhibit themselves on larger time scales.", "On this stage the 1-D convolution with different filter sizes that we discussed earlier is applied to the time series. Each convolutional layer is followed by a max-pooling layer. In the previous, simpler example global max pooling was used. Here, max pooling is not global, but still the pooling kernel size is extremely large, much larger than the sizes you are used to when working with image data. More specifically, the pooling kernel size is determined by the formula n/p, where n is the length of the time series, and p is a pooling factor, typically chosen between the values {2, 3, 5}. This stage is called local convolution because each branch is processed independently.", "On this stage all the outputs of local convolution stage from all 3 branches are concatenated. Then several more convolutional and max-pooling layers are added. After all the transformations and convolutions, you are left with a flat vector of deep, complex features that capture information about the original time series in a wide range of frequency and time scale domains. This vector is then used as an input to fully connected layers with Softmax function on the last layer.", "This model is a much simpler version of the multi-scale convolutional neural network.", "It takes the original time series and 2 down-sampled versions of it (medium and small length) as an input. The first branch of the model processes the original time series of length 3480 and of width 19. The corresponding convolution filter length is 24. The second branch processes the medium-length (1024 timesteps) down-sampled version of the time series, and the filter length used here is 16. The third branch processes the shortest version (512 timesteps) of the time series, with the filter length of 8. This way every branch extracts features on different time scales.", "After convolutional and global max-pooling layers, dropout regularization is added, and all the outputs are concatenated. The last fully connected layer returns the result of classification.", "In this article I tried to explain how deep convolutional neural networks can be used to classify time series. It is worth mentioning that the proposed method is not the only one that exists. There are ways of presenting time series in the form of images (for example, using their spectrograms), to which a regular 2-D convolution can be applied.", "Thank you very much for reading this article. I hope it was helpful to you, and I would really appreciate your feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist. I do research in the fields of machine learning, deep learning, and neuroscience."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F56b1b0a07a57&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mgranat?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mgranat?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": "Margarita Granat"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff823f8081550&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&user=Margarita+Granat&userId=f823f8081550&source=post_page-f823f8081550----56b1b0a07a57---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56b1b0a07a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56b1b0a07a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@christinhumephoto", "anchor_text": "Christin Hume"}, {"url": "https://unsplash.com/photos/hBuwVLcYTnA", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1603.06995", "anchor_text": "https://arxiv.org/abs/1603.06995"}, {"url": "https://arxiv.org/abs/1408.5882", "anchor_text": "https://arxiv.org/abs/1408.5882"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----56b1b0a07a57---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----56b1b0a07a57---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----56b1b0a07a57---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----56b1b0a07a57---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/programming?source=post_page-----56b1b0a07a57---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56b1b0a07a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&user=Margarita+Granat&userId=f823f8081550&source=-----56b1b0a07a57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56b1b0a07a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&user=Margarita+Granat&userId=f823f8081550&source=-----56b1b0a07a57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56b1b0a07a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F56b1b0a07a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----56b1b0a07a57---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----56b1b0a07a57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mgranat?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mgranat?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Margarita Granat"}, {"url": "https://medium.com/@mgranat/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "205 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff823f8081550&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&user=Margarita+Granat&userId=f823f8081550&source=post_page-f823f8081550--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F273779e5756d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-convolutional-neural-networks-for-time-series-classification-56b1b0a07a57&newsletterV3=f823f8081550&newsletterV3Id=273779e5756d&user=Margarita+Granat&userId=f823f8081550&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}