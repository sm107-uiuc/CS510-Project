{"url": "https://towardsdatascience.com/4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c", "time": 1683013632.423193, "path": "towardsdatascience.com/4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c/", "webpage": {"metadata": {"title": "4 Unique Approaches To Manage Imbalanced Classification Scenarios | by Kaushik Choudhury | Towards Data Science", "h1": "4 Unique Approaches To Manage Imbalanced Classification Scenarios", "description": "Out of billions of financial transactions, only a few involve cheating and fraud. Out of millions of cars on roads, only a few break down in the middle of the highway and rest drive fine. If we pay\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/accuracy-visualisation-supervised-machine-learning-classification-algorithms-af13d18fcc6c", "anchor_text": "Accuracy Visualisation: Supervised Machine Learning Classification Algorithms", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/5-advanced-visualisation-for-exploratory-data-analysis-eda-c8eafeb0b8cb", "anchor_text": "5 Advanced Visualisation for Exploratory data analysis (EDA)", "paragraph_index": 43}], "all_paragraphs": ["Out of billions of financial transactions, only a few involve cheating and fraud. Out of millions of cars on roads, only a few break down in the middle of the highway and rest drive fine. If we pay close attention to our daily activities, then a few exception incidents can also be identified. The same skewed data is present in many data points where one or a few couples of classes covers the majority of the cases.", "When we provide these imbalanced data points to machine learning algorithms, a few majority classes heavily influence at the cost of ignoring the minority class. Most business cases relate to predicting minority class events like fraud, detection of alignment etc. The prediction accuracy of the rare event of the machine learning model trained on imbalanced data is abysmally bad.", "In this article, I will discuss four unique ways to handle the imbalance dataset and improve the prediction accuracy of the minority class. Also, we will learn why only considering classification metric scores like F1 score or accuracy can mislead about model prediction performance in the rare event forecast.", "We will be using the make_classification method in Scitkit-Learn to generate the imbalanced dataset.", "We will be learning the five unique approaches to handle the imbalanced dataset of 5000 samples with one class comprising of 98% cases.", "Out of 5000 sample records, we have 4871 records for class 1 and 129 class 0 records. Lets us consider class 1 suggests normal transaction and class 0 as fraudulent transactions.", "Sample dataset is split into two parts viz. training and test set. The training set is to train the machine learning model, and the test set is to check the prediction of the model.", "We will train the model with 80% of the sample data set and the remaining 20% records which model has not seen before is reserved for the testing set.", "To understand the effect of the imbalanced dataset even on the sophisticated algorithm like Random Forest Classifier let us first train the standard Random Forest Classifier directly with the imbalanced training set and without any weight parameters.", "The F1 Score and accuracy score of the trained Random Forest Classifier Model on the test dataset is high. But only considering only these metric to judge the prediction performance of the model can be very misleading in case of the imbalanced dataset.", "Deploying such a model only based on these two metrics and not understanding the areas in which the classification model is making an error can be quite costly.", "A visual metric, like the confusion matrix, outshines other metrics in several ways. We get an instant view on the model performance in terms of classification areas the model excelled and the areas which require fine-tuning. Based on the business use case, we can judge quickly from the false positive, false negative, true positive and true negative counts whether the model is ready for deployment.", "You can learn in-depth about the confusion matrix in the article Accuracy Visualisation: Supervised Machine Learning Classification Algorithms", "As expected, the majority class has completely influenced the model, and the trained model has predicted the classification of all records in test dataset as the majority class. Such misclassification prediction in case of rare fraud detection or uncommon malignant disease prediction is very detrimental.", "Fortunately, Random Forrest Classifier has a parameter \u201cclass_weight\u201d to specify the weights of each class in case of an imbalanced dataset.", "In the sample dataset, class 1 is approx 38 times more prevalent than class 0. Hence, we will mention the \u201cclass weights\u201d in such proportion for the algorithm to compensate during training.", "The F1 Score and accuracy score for Random Forest Classifier Model with class weigh compensated is also high, but we can ascertain the real performance by checking the confusion matrix.", "We can see that the majority class has not completed overtaken the Random Forest Classifier Model with weight-adjusted.", "Out of the total 1000 records in the test dataset, it has misclassified only 14 records. Also, it has correctly classified 20 of the minority class sample records out of 26 minority class records in the test dataset.", "We have learned the way to handle imbalanced dataset with class_weight parameter in Random Forrest Classifier and improve the prediction accuracy of the minority class.", "Next, we will learn a different approach to manage the imbalance input training dataset with BalancedRandomForestClassifier in the imbalanced-learn library.", "Install the imbalance-learn library with pip", "In the below code, we trained the BalancedRandomForestClassifier with the training dataset and then checked the metrics scores on the testing dataset.", "Like the previous two examples, it also indicates high F1 and accuracy score.", "We can see in the confusion matrix that BalancedRandomForestClassifier handles the class weight internally quite well compare to RandomForestClassifier without weight_class parameter.", "Out of 1000 test records, it predicted the classification of 968 records correctly. It also performed slightly better than Random Forrest Classifier with class_weight by correctly classifying 21 records out of 26 records in the minority class.", "Next, we will use a completely different approach of oversampling to manage the minority class in the training dataset.", "Next, we will use a completely different approach of oversampling to manage the minority class in the training dataset. The basic idea is to randomly generate examples in the minority class to have a more balanced dataset.", "Earlier we divided the sample dataset of 5000 records into training and test dataset with 4000 and 1000 records respectively.", "Training dataset fit on RandomOverSampler generated minority class record at random and resampled balanced training data has 7794 records.", "Once the training dataset is artificially balanced, then we can train the standard Random Forest Classifier without \u201cclass_weight\u201d parameter.", "We see that standard Random Forest classifier trained on artificially balanced training dataset with oversampling could predict pretty good.", "Oversampling helped the Random Classifier to overcome the influence of majority classifier and predict the test data record classes with high accuracy.", "Out of 1000 test records, it predicted the classification of 985 records correctly. It also performed nearly at par with BalancedRandomForestClassifier with classifying 20 records out of 26 records in the minority class.", "Finally, we will learn about the undersampling strategy to handle the imbalanced dataset. It is a completely different approach than oversampling we learnt earlier. Randomly delete examples in the majority class. The key idea is to randomly delete the majority class records to have a more balanced dataset.", "A number for majority class records deleted at random to balance the training data set with 206 records from 4000 data records.", "Once the training dataset is balanced, we can use it directly to train the model just like oversampling strategy discussed earlier.", "It seems undersampling strategy enables to predict the rare minority class event with similar accuracy like other strategies discussed in this article, but in comparison to other strategies, it performed pretty badly in of predicting the majority class. It predicted incorrectly 82 majority class records from the test dataset.", "Most of the machine learning classification algorithms expect balanced training dataset. It is vital to check whether the training dataset is imbalanced and take appropriate pre-processing actions before training the machine learning model with the data.", "GIGO \u2014 Garbage In and Garbage Out: If we train a model with imbalanced data, then there is a high probability that the model will miss to predict the minority classes in production.", "Data is very valuable. I do not prefer the undersampling strategy as it forces to prune the data related to the majority class. We saw that due to this even though the model could predict the minority class records nearly with the same accuracy as other strategies discussed in this article it performed miserably in predicting the majority class records.", "I prefer the Random Forest Classifier with \u2018class_weight\u2019 parameter and BalancedRandomForestClassifier in imbalanced-learn library.", "I will suggest you check the training sample performance with all the strategies discussed in this article before selecting any one of them for your project.", "You can gain insight into the imbalanced dataset with exploratory data analysis. To know more about it read the article- 5 Advanced Visualisation for Exploratory data analysis (EDA)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Kaushik Choudhury is an experienced Supply Chain Strategy and Digital Transformation manager in one of the Big 4 Consulting firm in the UK."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7c5b92637b9c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kaushikthoughts.medium.com/?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": ""}, {"url": "https://kaushikthoughts.medium.com/?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": "Kaushik Choudhury"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf006e67e544&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&user=Kaushik+Choudhury&userId=df006e67e544&source=post_page-df006e67e544----7c5b92637b9c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c5b92637b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c5b92637b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/machine-learning/home", "anchor_text": "Inside AI"}, {"url": "https://unsplash.com/@ammarelamir?utm_source=medium&utm_medium=referral", "anchor_text": "Ammar ElAmir"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/accuracy-visualisation-supervised-machine-learning-classification-algorithms-af13d18fcc6c", "anchor_text": "Accuracy Visualisation: Supervised Machine Learning Classification Algorithms"}, {"url": "https://towardsdatascience.com/5-advanced-visualisation-for-exploratory-data-analysis-eda-c8eafeb0b8cb", "anchor_text": "5 Advanced Visualisation for Exploratory data analysis (EDA)"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7c5b92637b9c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7c5b92637b9c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----7c5b92637b9c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----7c5b92637b9c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----7c5b92637b9c---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7c5b92637b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&user=Kaushik+Choudhury&userId=df006e67e544&source=-----7c5b92637b9c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7c5b92637b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&user=Kaushik+Choudhury&userId=df006e67e544&source=-----7c5b92637b9c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c5b92637b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7c5b92637b9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7c5b92637b9c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7c5b92637b9c--------------------------------", "anchor_text": ""}, {"url": "https://kaushikthoughts.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kaushikthoughts.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kaushik Choudhury"}, {"url": "https://kaushikthoughts.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "474 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf006e67e544&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&user=Kaushik+Choudhury&userId=df006e67e544&source=post_page-df006e67e544--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F491da94209c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-unique-approaches-to-manage-imbalance-classification-scenario-7c5b92637b9c&newsletterV3=df006e67e544&newsletterV3Id=491da94209c1&user=Kaushik+Choudhury&userId=df006e67e544&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}