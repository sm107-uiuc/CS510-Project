{"url": "https://towardsdatascience.com/how-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764", "time": 1683017440.971276, "path": "towardsdatascience.com/how-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764/", "webpage": {"metadata": {"title": "How To Rock A categorical encoding That Will Save You Tons Of Time | by Salma El Shahawy | Towards Data Science", "h1": "How To Rock A categorical encoding That Will Save You Tons Of Time", "description": "This post will discuss the different strategies to encode the categorical variables as a preprocessing step necessary to develop reliable machine learning models. Encode categorical variables is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.statisticshowto.com/monotonic-relationship/", "anchor_text": "More about monotonic relationships", "paragraph_index": 4}, {"url": "https://www.kaggle.com/salmaeng/comparison-between-categorical-variable-encoding", "anchor_text": "The executable notebook", "paragraph_index": 16}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "LinkedIn", "paragraph_index": 18}], "all_paragraphs": ["This post will discuss the different strategies to encode the categorical variables as a preprocessing step necessary to develop reliable machine learning models. Encode categorical variables is considered one of several actions that could enhance the model performance if applied appropriately. There are different encoding types; in this article, I picked the widely used encoders to discuss their pros and cons, and when it is appropriate to use as possible as I can. So, let\u2019s get started.", "Disclaimer: I attached an executable notebook for each encoding strategy hosted on kaggle. Each notebook has implementation in both pandas and sklearn, please feel free to run and report if you catch any bug or error.", "In the end, I used sklearn to apply each strategy on the same dataset. After that, I utilized RandomForest and Logistic regression classifiers to compare each classifier\u2019s performance based on the area under the curve \u2014 AUC.", "Categorical encoding refers to replacing the category strings by a numerical representation. The goals of categorical encoding are:", "Monotonic relationship: When a variable increases, the target variable increase and vise versa. It could be linear and non-linear \u2014 More about monotonic relationships", "There are three main types as the following", "Generally, a categorical variables should be encoded by creating n-1binary variables, where n is the number of distinct categories.", "One hot encoding takes into account that we can use one less dimension and still represents the whole dataset \u2014 remove redundancy.", "There are few limitations in case there are large number of categorical variables in the dataset. Also, If the categorical variables have high cardinality \u2014 more than 4 levels it leads to:", "In this strategy, we replace the categories with the count of the observations that show that category in the dataset. We can replace the category with the frequency or percentage of observations in the dataset. For instance, if 100 out of 1000 observations show the color blue, we would replace blue by 100 if doing count encoding or by 0.1 if replaced by the frequency. That technique captures each label\u2019s representation in a dataset, however the encoding may not necessarily be predictive of the outcome.", "The concept is the same as the one hot encoding; however, the number n is assigned arbitrary not following a specific criteria. This encoding strategy allows for easy and quick benchmarking of machine learning models.", "Integers replace categories from 1 to n, where n is the number of distinct categories in the variable, but this numbering is informed by the mean of the target for each category. For instance, we have the variable city with values London, Manchester, and Bristol; if the default rate of unemployment is 30% for London, 20% for Bristol, and 10% for Manchester, then we replace London by 1, Bristol by 2, and Manchester by 3.", "The encoding is guided by the target, thus they create a monotonic relationship between the variable and the target.", "Mean encoding implies replacing the category with the average target value for that category. For example, if we have the variable city, with categories London, Manchester, and Bristol, we desire to predict the default rate of unemployment. If London\u2019s default rate is 30%, we replace London with 0.3; if the default rate for Manchester is 20%, we replace Manchester by 0.2, and so on.", "Weight of Evidence (WoE) was primarily developed for the credit and financial industries to build more predictive models to evaluate a loan\u2019s risk to default. That is, to predict how likely the money lent to a person or institution is to be lost. Weight of Evidence is the log of the proportion between good events to bad events.", "WoE is appropriately suited for Logistic Regression because the Logit transformation is simply the log of the odds \u2014 ln(P(Goods)/P(Bads)). Consequently, using WoE-coded predictors in logistic regression, the predictors are all developed and coded to the same scale. Then the parameters in the linear logistic regression equation are compared directly.", "For Logistic regression, the one-hot encoding showed the best performance. It preserved the linear relationships with variables and the target, the same with weight of evidence, and ordered encoding.However, count encoding returned the worst performance as it does not create a monotonic relationship between variables and the target. In this case, the mean target encoding is probably causing over-fitting \u2014 The executable notebook.", "Finally, I hope this short article gave you a comprehensive interpretation of each commonly used encoding approach. Harnessing those methods and applying the appropriate one would likely boost the model\u2019s predictive performance. Although some strategies seem to enhance the relationship between the categorical and the target variable, it may lead to overfitting. So, it is best practice to perform a model assessment before moving forward with the analysis. Data Scientists indeed spent almost 80% of their time preprocessing the data to get reliable models.", "My advice is to implement those strategies using pandas and sklearn and let us know in the comment section. What are the pros and cons of each library, and what is your favorite? If you have other questions, connect me over LinkedIn, I would be more than happy to help. Thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8b9b7649f764&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://salmaeng71.medium.com/?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0----8b9b7649f764---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b9b7649f764&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b9b7649f764&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@danielcgold?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Dan Gold"}, {"url": "https://unsplash.com/s/photos/sticker?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.statisticshowto.com/monotonic-relationship/", "anchor_text": "More about monotonic relationships"}, {"url": "https://www.kaggle.com/salmaeng/onehotencoder", "anchor_text": "Include reproducible notebook"}, {"url": "https://www.kaggle.com/salmaeng/ordinal-encoding", "anchor_text": "Include reproducible notebook"}, {"url": "https://www.kaggle.com/salmaeng/ordinal-encoding", "anchor_text": "Include reproducible notebook"}, {"url": "https://www.kaggle.com/salmaeng/ordered-integer-encoding", "anchor_text": "Include reproducible notebook"}, {"url": "https://www.listendata.com/2015/03/weight-of-evidence-woe-and-information.html", "anchor_text": "WOE calculation"}, {"url": "https://www.listendata.com/2015/03/weight-of-evidence-woe-and-information.html", "anchor_text": "More about WOE"}, {"url": "https://www.kaggle.com/salmaeng/comparison-between-categorical-variable-encoding", "anchor_text": "The executable notebook"}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/r?url=https%3A%2F%2Fwww.listendata.com%2F2015%2F03%2Fweight-of-evidence-woe-and-information.html", "anchor_text": "further readings"}, {"url": "https://www.kaggle.com/salmaeng/comparison-between-categorical-variable-encoding", "anchor_text": "Kaggle notebook"}, {"url": "https://brendanhasz.github.io/2019/03/04/target-encoding", "anchor_text": "Target guided encoded by Brendan Hasz"}, {"url": "https://medium.com/data-design/visiting-categorical-features-and-encoding-in-decision-trees-53400fa65931", "anchor_text": "Categorical Features and Encoding in Decision Trees"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8b9b7649f764---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-preprocessing?source=post_page-----8b9b7649f764---------------data_preprocessing-----------------", "anchor_text": "Data Preprocessing"}, {"url": "https://medium.com/tag/pandas?source=post_page-----8b9b7649f764---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/categorical-data?source=post_page-----8b9b7649f764---------------categorical_data-----------------", "anchor_text": "Categorical Data"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8b9b7649f764---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8b9b7649f764&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----8b9b7649f764---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8b9b7649f764&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----8b9b7649f764---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b9b7649f764&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8b9b7649f764&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8b9b7649f764---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8b9b7649f764--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8b9b7649f764--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8b9b7649f764--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8b9b7649f764--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://salmaeng71.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "414 Followers"}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "https://www.linkedin.com/in/salma-elshahawy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F428e575094be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-rock-a-categorical-encoding-that-will-save-you-tons-of-time-8b9b7649f764&newsletterV3=992085c0dce0&newsletterV3Id=428e575094be&user=Salma+El+Shahawy&userId=992085c0dce0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}