{"url": "https://towardsdatascience.com/an-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57", "time": 1683017691.0946088, "path": "towardsdatascience.com/an-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57/", "webpage": {"metadata": {"title": "An explainable topological search engine with Giotto-tda | by Matteo Caorsi | Towards Data Science", "h1": "An explainable topological search engine with Giotto-tda", "description": "In this blog post, based on the work by F. Cornell, we explain how one can use Giotto-tda [2] to cluster words and create a semantical search engine, retrieving documents similar to one's query\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@c.filip.cornell/about", "anchor_text": "F. Cornell", "paragraph_index": 0}, {"url": "https://medium.com/@c.filip.cornell/about", "anchor_text": "F. Cornell", "paragraph_index": 1}, {"url": "https://www.nltk.org/book/ch02.html", "anchor_text": "Reuters", "paragraph_index": 2}, {"url": "https://www.nltk.org/", "anchor_text": "nltk", "paragraph_index": 2}, {"url": "https://radimrehurek.com/gensim/", "anchor_text": "gensim", "paragraph_index": 2}, {"url": "https://github.com/mmihaltz/word2vec-GoogleNews-vectors", "anchor_text": "word2vec-google-news-300", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/getting-started-with-giotto-learn-a-python-library-for-topological-machine-learning-451d88d2c4bc", "anchor_text": "blog post", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/visualising-high-dimensional-data-with-giotto-mapper-897fcdb575d7", "anchor_text": "one", "paragraph_index": 3}, {"url": "https://github.com/giotto-ai/gtda-challenge-2020/blob/master/filco306/A_topological_search_engine.ipynb", "anchor_text": "this Jupyter notebook", "paragraph_index": 4}, {"url": "https://www.kaggle.com/amitkumarjaiswal/nlp-search-engine", "anchor_text": "Kaggle notebook", "paragraph_index": 6}, {"url": "https://giotto-ai.github.io/gtda-docs/latest/notebooks/mapper_quickstart.html", "anchor_text": "Mapper algorithm", "paragraph_index": 7}, {"url": "https://github.com/giotto-ai/gtda-challenge-2020/blob/master/filco306/A_topological_search_engine.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 12}, {"url": "https://pypi.org/project/rank-bm25/", "anchor_text": "BM25", "paragraph_index": 14}, {"url": "https://pypi.org/project/rank-bm25/", "anchor_text": "its guide on how to use it", "paragraph_index": 15}, {"url": "https://papers.nips.cc/paper/2013/file/9aa42b31882ec039965f3c4923ce901b-Paper.pdf", "anchor_text": "Distributed Representations of Words and Phrases and their Compositionality", "paragraph_index": 20}, {"url": "https://arxiv.org/abs/2004.02551", "anchor_text": "giotto-tda: A Topological Data Analysis Toolkit for Machine Learning and Data Exploration", "paragraph_index": 21}], "all_paragraphs": ["The co-author of the blogpost: F. Cornell.", "In this blog post, based on the work by F. Cornell, we explain how one can use Giotto-tda [2] to cluster words and create a semantical search engine, retrieving documents similar to one's query, thereby showing how we can use topological techniques in the context of Natural Language Processing (NLP).", "We will be using the classical Reuters dataset, consisting of around 10K news documents collected from Reuters (inherently available in the nltk package). We will also use pre-trained word vectors, available through the gensim API. These are the word2vec-google-news-300.", "If you are new to TDA, I recommend you read the following blog post as an introduction on getting started with giotto-tda [2]. This one is also useful to better understand the Mapper algorithm used below.", "The reader can find all the implementation details and the fully working code in this Jupyter notebook.", "A problem with many search engine techniques today is that they rely on the words to exist in the corpus of a document that are already indexed.", "When we search for certain terms in a collection of documents, many methods often look for the specific words, and this can be troublesome. A great example of a TF-IDF based approach for a search engine is the Kaggle notebook by Amit Kumar Jaiswal. Nevertheless, it also points out the weakness of this approach. Words in the query that do not exist in the documents vocabulary are removed from the query, and we might lose important information regarding what the user is searching for.", "A tool that allows for constructing a search engine mitigating this problem is the Mapper algorithm in Giotto-tda. By taking the word vectors of all the words existing in a collection of documents, we can create a graph from these word vectors by using the Mapper method. Each node will then work as a cluster of words that are similar and often replaceable by each other. Due to the inherent nature of word vectors, words are perceived as similar when they are used in the same context (see [2]) and can be measured with the use of the cosine similarity. We, therefore, use the cosine distance as our distance metric when constructing our graph.", "In essence, the mapper allows us to cluster the words into an arbitrary number of clusters, not a pre-determined number of clusters, with words that are similar in terms of semantical meaning. If a word does not exist, we can rely on its neighbours, defined through the vertices it belongs to, to fetch a document that might be about similar topics.", "This mapper graph can then be used to query the data and retrieve documents. Each document has words belonging to different nodes, as different words end up in different nodes based on which words they are similar to. A document will therefore implicitly belongs to many different nodes as it is a collection of words.", "We can explain a query in a few steps. Let\u2019s say a word is searched for, e.g. Soybean. We then look up which nodes this word belongs to: the same node would also contains other words and therefore be associated with many different documents. We look at all documents that have words in those nodes, and the documents are ranked based on their percentage of words contained in the same node as the query. In the simple example of Soybean, we simply rank all documents based on the percentage of the words they have in the same nodes as Soybean. The output of the query is the list of documents, ranked as just described. If a word does not exist in the corpus, we can simply leverage the word vectors and derive the most similar word that exists in the corpus.", "The construction of the Mapper graph therefore works as an efficient way of clustering words and implicitly creating what one might call a topological signature for each document.", "For a brief mathematical formulation of the problem, please refer to the Jupyter notebook associated with this blog post.", "Let\u2019s take a look at an example where we can clearly see the semantics of the mapper graph at work.", "Below is a search for \u201coil\u201d, for which one of the top results is \u201cSINGAPORE PETROLEUM CO RAISES OIL PRODUCT POSTING\u201d. The first result perfectly matches the most used connotation of the word \u201coil\u201d as fossil fuel, and the second result is about minerals and fossil fuels as well! The topological search engine captures semantics and meanings in the documents that BM25 does not (see the benchmark below for comparison)!", "Here below, we compare the Mapper-based search engine with a classical method, the BM25 search method. Following its guide on how to use it, we rank and retrieve results for the same keyword searches as in the topological method. We search for \u201coil\u201d to compare with the topological approach.", "The semantic richness oil as \u201cfossil fuel\u201d is completely lost in the top ranked documents: all top results explicitly contain the word \u201coil\u201d.", "In this work, we demonstrated a proof-of-concept, showing how it is possible to use Giotto-tda and its packages within NLP to create a semantic search engine. As seen with some examples (see oil) the Topological Search Engine captures semantics that BM25, a classical search engine, does not manage to capture.", "There are however a few points that need to be highlighted.", "More work is absolutely needed to improve these results; most of all, this method can clearly be fine-tuned to work better. Either way, this blog post serves as a demonstration that Giotto-tda and topology have their places within the realm of Natural Language Processing. It also shows, for a few sets of queries, that the topological search engine is not necessarily inferior to classical methods such as BM25; with more adjustments, we truly hope it could probably perform even better.", "[1] T. Mikolov, Distributed Representations of Words and Phrases and their Compositionality, Advances in neural information processing systems 26 (2013): 3111\u20133119.", "[2] G. Tauzin et al., giotto-tda: A Topological Data Analysis Toolkit for Machine Learning and Data Exploration, ArXiv2004.02551", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I like discovering new cultures, languages, experiences and places. I am currently the CSO at L2F, leading the R&D team to develop Giotto."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff1f3b2769a57&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@matteocaorsi?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matteocaorsi?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": "Matteo Caorsi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b71fe755ba1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&user=Matteo+Caorsi&userId=2b71fe755ba1&source=post_page-2b71fe755ba1----f1f3b2769a57---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1f3b2769a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1f3b2769a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@c.filip.cornell/about", "anchor_text": "F. Cornell"}, {"url": "https://medium.com/@c.filip.cornell/about", "anchor_text": "F. Cornell"}, {"url": "https://unsplash.com/@raphaelphotoch?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Raphael Schaller"}, {"url": "https://unsplash.com/s/photos/words?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.nltk.org/book/ch02.html", "anchor_text": "Reuters"}, {"url": "https://www.nltk.org/", "anchor_text": "nltk"}, {"url": "https://radimrehurek.com/gensim/", "anchor_text": "gensim"}, {"url": "https://github.com/mmihaltz/word2vec-GoogleNews-vectors", "anchor_text": "word2vec-google-news-300"}, {"url": "https://towardsdatascience.com/getting-started-with-giotto-learn-a-python-library-for-topological-machine-learning-451d88d2c4bc", "anchor_text": "blog post"}, {"url": "https://towardsdatascience.com/visualising-high-dimensional-data-with-giotto-mapper-897fcdb575d7", "anchor_text": "one"}, {"url": "https://github.com/giotto-ai/gtda-challenge-2020/blob/master/filco306/A_topological_search_engine.ipynb", "anchor_text": "this Jupyter notebook"}, {"url": "https://www.kaggle.com/amitkumarjaiswal/nlp-search-engine", "anchor_text": "Kaggle notebook"}, {"url": "https://giotto-ai.github.io/gtda-docs/latest/notebooks/mapper_quickstart.html", "anchor_text": "Mapper algorithm"}, {"url": "https://github.com/giotto-ai/gtda-challenge-2020/blob/master/filco306/A_topological_search_engine.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://pypi.org/project/rank-bm25/", "anchor_text": "BM25"}, {"url": "https://pypi.org/project/rank-bm25/", "anchor_text": "its guide on how to use it"}, {"url": "https://papers.nips.cc/paper/2013/file/9aa42b31882ec039965f3c4923ce901b-Paper.pdf", "anchor_text": "Distributed Representations of Words and Phrases and their Compositionality"}, {"url": "https://arxiv.org/abs/2004.02551", "anchor_text": "giotto-tda: A Topological Data Analysis Toolkit for Machine Learning and Data Exploration"}, {"url": "https://medium.com/tag/topological-data-analysis?source=post_page-----f1f3b2769a57---------------topological_data_analysis-----------------", "anchor_text": "Topological Data Analysis"}, {"url": "https://medium.com/tag/nlp?source=post_page-----f1f3b2769a57---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/search-engines?source=post_page-----f1f3b2769a57---------------search_engines-----------------", "anchor_text": "Search Engines"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f1f3b2769a57---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1f3b2769a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&user=Matteo+Caorsi&userId=2b71fe755ba1&source=-----f1f3b2769a57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1f3b2769a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&user=Matteo+Caorsi&userId=2b71fe755ba1&source=-----f1f3b2769a57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1f3b2769a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff1f3b2769a57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f1f3b2769a57---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f1f3b2769a57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matteocaorsi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matteocaorsi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matteo Caorsi"}, {"url": "https://medium.com/@matteocaorsi/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "23 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b71fe755ba1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&user=Matteo+Caorsi&userId=2b71fe755ba1&source=post_page-2b71fe755ba1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F70b05263b787&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-explainable-topological-search-engine-with-giotto-tda-f1f3b2769a57&newsletterV3=2b71fe755ba1&newsletterV3Id=70b05263b787&user=Matteo+Caorsi&userId=2b71fe755ba1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}