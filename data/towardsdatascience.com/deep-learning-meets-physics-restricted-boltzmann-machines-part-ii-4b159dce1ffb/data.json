{"url": "https://towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb", "time": 1682993367.035549, "path": "towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb/", "webpage": {"metadata": {"title": "Deep Learning meets Physics: Restricted Boltzmann Machines Part II | by Artem Oppermann | Towards Data Science", "h1": "Deep Learning meets Physics: Restricted Boltzmann Machines Part II", "description": "This article is the sequel of the first part where I introduced the theory behind Restricted Boltzmann Machines. This second part consists in a step by step guide through a practical implementation\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15", "anchor_text": "first part", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15", "anchor_text": "the first part of this series", "paragraph_index": 1}, {"url": "https://github.com/artem-oppermann/Restricted-Boltzmann-Machine", "anchor_text": "project repository on GitHub", "paragraph_index": 2}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "MovieLens 1M Dataset", "paragraph_index": 3}, {"url": "https://artem-oppermann.medium.com/subscribe", "anchor_text": "https://artem-oppermann.medium.com/subscribe", "paragraph_index": 23}], "all_paragraphs": ["This article is the sequel of the first part where I introduced the theory behind Restricted Boltzmann Machines. This second part consists in a step by step guide through a practical implementation of a Restricted Boltzmann Machine which serves as a Recommender System and can predict whether a user would like a movie or not based on the users taste.", "(1) In this article I wont cover the theory behind the steps I make, I will only explain the practical parts. Make sure to renew your theoretical knowledge by reviewing the first part of this series.", "(2) The code I present in this article is from my project repository on GitHub. Since I focus only on the implementation of the model I skip some preprocessing steps like, splitting the data into training/test sets and building the input pipeline. These steps can be examined in the repository.", "We are using the MovieLens 1M Dataset. This set contains 1 million ratings of approximately 4000 movies made by approximately 6000 users. The model will be trained on this dataset and will learn to make predictions whether a user would like a random movie or not. The dataset requires some reprocessing steps. Because an usual Restricted Boltzmann Machine accepts only binary values it is necessary to give ratings 1\u20132 a value of 0 \u2014 hence the user does not like the movie. Accordingly the ratings 3\u20135 receive a value of 1. The movies that are not rated yet receive a value of -1.", "In the next step the transformed original data is divided into two separate training and test datasets. It is necessary two have exactly the same users in both datasets but different movie ratings. Fig. 1 shows a simple example for the partitioning of the original dataset into the training and test data. In this example the first 5 ratings are put into the training set, while the rest is masked with -1 as not rated yet. Accordingly the test set receives the remaining 5 ratings.", "During the training time the Restricted Boltzmann Machine learns on the first 5 movie ratings of each user, while during the inference time the model tries to predict the ratings for the last 5 movies. These predicted ratings are then compared with the actual ratings which were put into the test set.", "Both datasets are saved in a binary TFRecords format that enables a very efficient data input pipeline.", "The model is implemented in an object oriented manner. The Restricted Boltzmann Machine is a class with all necessary operations like training, loss, accuracy, inference etc. inside of it. Some helper functions are outsourced into a separate script.", "The constructor sets the kernel initializers for the weights and biases. In the next step all weights and biases in the network get initialized. The weights are normal distributed with a mean of 0.0 and a variance of 0.02, while the biases are all set to 0.0 in the beginning. It can be noticed that the network consists only out of one hidden layer. As a result only one weight matrix is needed.", "Giving the binary input v the following function _sample_h(self) obtains the probabilities that a hidden neuron is activated (Eq.1). This is achieved by multiplying the input v by the weight matrix, adding a bias and applying a sigmoidal activation . The obtained probabilities are used to sample from Bernoulli distribution. The sampled values which are either 1.0 or 0.0 are the states of the hidden neurons.", "Given the hidden states h we can use these to obtain the probabilities that a visible neuron is active (Eq.2) as well as the corresponding state values. This is implemented in _sample_v(self) .", "The first part of the training consists in an operation that is called Gibbs Sampling. Briefly speaking we take an input vector v_0 and use it to predict the values of the hidden state h_0. The hidden state are used on the other hand to predict new input state v. This procedure is repeated k times. This procedure is illustrated in Fig. 2.", "Gibbs Sampling is implemented in the code snipped below. The iteration is happening in the while loop body. An important step in the body is Vk=tf.where(tf.less(V,0),V,Vk). This operations makes sure that the ratings in v which are -1 (meaning movies that have not been seen yet) remain -1 for every v_k in every iteration. After k iteration we obtain v_k and corresponding probabilities p(h_k|v_k). Together with v_0 and h_0 these values can be used to compute the gradient matrix in the next training step.", "The values obtained in the previous step can be used to compute the gradient matrix and the gradient vectors. The computation of gradients according to Eq. 3 are straight forward. Please notice that the symbols a and b in this equations stand for hidden respectively visible biases in contrasts to different symbols I used in my code.", "The only tricky part is that TensorFlow 1.5 does not support outer products. But this issue can be solved by temporary reshaping and applying usual point wise multiplication.", "Notice that the computation of the gradients is happening in while loop. This is only due to the fact that the training is happening in mini-batches. Meaning the loop computes for each data sample in the mini-batch the gradients and adds them to the previously defined gradient placeholders. In the end the sum of gradients is divided by the size of the mini-batch.", "After the gradients are computed all weights and biases can be updated through gradient ascent according to eq. 4. For this procedure we must create an assign operation in _update_parameter(self).", "The whole training operation is computed in optimize(self) method under the name scope \u201coperation\u201d. Below that the more complicated accuracy operation of the training is implemented. Basically this operation subtracts the original input values v_0 from v_k that are obtained during Gibbs Sampling. The subtraction is only happening for v_0 \u2265 0. After that the summed subtractions are divided by the number of all ratings \u2265 0. The accuracy gives the ratio of correctly predicted binary movie ratings during training.", "During inference time the method inference(self) receives the input v. That input is one training sample of a specific user that is used to activate the hidden neurons (the underlying features of users movie taste). The hidden neurons are used again to predict a new input v. In the best scenario this new input consists of the recreation of already present ratings as well as ratings of movies that were not rated yet.", "The made prediction are compared outside the TensorFlow Session with the according test data for validation purposes.", "To outline the previous steps here is the definition of the main network graph and the start of the session where the training and inference steps are executed.", "During the training process we can examine the progress of the accuracy on training and test sets. The accuracy gives the ratio of correctly predicted binary movie ratings. It can be seen that after 6 epochs the model predicts 78% of the time correctly if a user would like a random movie or not.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Deep Learning & AI Software Developer | MSc. Physics | https://artem-oppermann.medium.com/subscribe"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4b159dce1ffb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://artem-oppermann.medium.com/?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": ""}, {"url": "https://artem-oppermann.medium.com/?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": "Artem Oppermann"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F619319ac8220&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&user=Artem+Oppermann&userId=619319ac8220&source=post_page-619319ac8220----4b159dce1ffb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b159dce1ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b159dce1ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15", "anchor_text": "first part"}, {"url": "https://towardsdatascience.com/deep-learning-meets-physics-restricted-boltzmann-machines-part-i-6df5c4918c15", "anchor_text": "the first part of this series"}, {"url": "https://github.com/artem-oppermann/Restricted-Boltzmann-Machine", "anchor_text": "project repository on GitHub"}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "MovieLens 1M Dataset"}, {"url": "https://github.com/artem-oppermann/Restricted-Boltzmann-Machine/blob/master/README.md", "anchor_text": "https://github.com/artem-oppermann/Restricted-Boltzmann-Machine/blob/master/README.md"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4b159dce1ffb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4b159dce1ffb---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4b159dce1ffb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----4b159dce1ffb---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4b159dce1ffb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b159dce1ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&user=Artem+Oppermann&userId=619319ac8220&source=-----4b159dce1ffb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b159dce1ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&user=Artem+Oppermann&userId=619319ac8220&source=-----4b159dce1ffb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b159dce1ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4b159dce1ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4b159dce1ffb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4b159dce1ffb--------------------------------", "anchor_text": ""}, {"url": "https://artem-oppermann.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://artem-oppermann.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Artem Oppermann"}, {"url": "https://artem-oppermann.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.8K Followers"}, {"url": "https://artem-oppermann.medium.com/subscribe", "anchor_text": "https://artem-oppermann.medium.com/subscribe"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F619319ac8220&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&user=Artem+Oppermann&userId=619319ac8220&source=post_page-619319ac8220--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc09555d6711e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-meets-physics-restricted-boltzmann-machines-part-ii-4b159dce1ffb&newsletterV3=619319ac8220&newsletterV3Id=c09555d6711e&user=Artem+Oppermann&userId=619319ac8220&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}