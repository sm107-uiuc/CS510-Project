{"url": "https://towardsdatascience.com/categorical-feature-selection-via-chi-square-fc558b09de43", "time": 1683004819.280395, "path": "towardsdatascience.com/categorical-feature-selection-via-chi-square-fc558b09de43/", "webpage": {"metadata": {"title": "Feature Selection by Chi-Square | Towards Data Science", "h1": "Categorical Feature Selection via Chi-Square", "description": "We often encounter categorical features. Some people would be confused about how to handle these. Here I show how to handle the feature by using Chi-Square."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/burak3ergun/loan-data-set", "anchor_text": "Kaggle", "paragraph_index": 9}, {"url": "https://cornelliusyudhawijaya.medium.com/membership", "anchor_text": "my referral", "paragraph_index": 27}], "all_paragraphs": ["In our everyday data science work, we often encounter categorical features. Some people would be confused about how to handle these features, especially when we want to create a prediction model where those models basically an equation that accepting number; not a category.", "One way is to encode all the category variable using the OneHotEncoding method (encode all the categorical class into numerical values 0 and 1, where 0 mean absent and 1 is present).", "This method is preferable by many as the information is still present and it is easy to understand the concept. The downfall is when we possess many categorical features with high cardinality, the number of the features after OneHotEncoding process would be massive. Why we do not want a lot of features in our training dataset? it is because of the curse of dimensionality.", "While adding features could decrease the error in our prediction model, it would only decrease until a certain number of features; after that, the error will increase again. This is the concept of the curse of dimensionality.", "Many ways to alleviate this problem, but one of my to-go techniques is by doing feature selection via the Chi-Square test of independence.", "The Chi-Square test of independence is used to determine if there is a significant relationship between two categorical (nominal) variables. It means the Chi-Square Test of Independence is a hypothesis testing test with 2 hypotheses present; the Null Hypothesis and the Alternative Hypothesis. The hypothesis is written below.", "Null Hypothesis (H0): There is no relationship between the variables", "Alternative Hypothesis (H1): There is a relationship between variables", "Just like any statistical testing, we test it against our chosen p-value (often it is 0.05). If the p-value is significant, we can reject the null hypothesis and claim that the findings support the alternative hypothesis. I would not dwell much into the statistic theory, as the purpose of this article is to show how the feature selection using the Chi-Square test is works for practical use.", "As an example, I would work with a loan dataset from Kaggle for classification problems. Here, the dataset including various numerical, ordinal and nominal variables as stated below (for article purposes, I would drop all the Null values which actually need another analysis).", "In the Chi-Square test, we display the data in a cross-tabulation (contingency) format with each row representing a level (group) for one variable and each column representing a level (group) for another variable. Let\u2019s try to create a cross-tabulation table between Gender and Loan_Status columns.", "Now, let\u2019s try to use the Chi-Square test of independence to test the relationship between these 2 features. Luckily python library scipy already contains the test function for us to use.", "If we choose our p-value level to 0.05, as the p-value test result is more than 0.05 we fail to reject the Null Hypothesis. This means, there is no relationship between the Gender and Loan_Status feature based on the Chi-Square test of independence.", "We could try to use this test with all the categorical features present.", "The Chi-square test of independence is an omnibus test which means it tests the data as a whole. If we have multiple classes within a category, we would not be able to easily tell which class of the features are responsible for the relationship if the Chi-square table is larger than 2\u00d72. To pinpoint which class is responsible, we need a post hoc test.", "To conduct multiple 2\u00d72 Chi-square test of independence, we need to regroup the features for each test to where it is one category class against the rest. To do this, we could apply OneHotEncoding to each class and create a new cross-tab table against the other feature.", "For example, let\u2019s try to do a post hoc test to the Property_Area feature. First, we need to done OneHotEncoding to the Property_Area feature.", "Next, we create the cross-tab table for each of the Property_Area class against the target Loan_Status.", "We then could do a Chi-Square test of independence to this pair.", "However, there is something to remember. Comparing multiple classes against each other would means that the error rate of a false positive compound with each test. For example, if we choose our first test at p-value level 0.05 means there is a 5% chance of a false positive; if we have multiple classes, the test after that would compounding the error with the chance become 10% of a false positive, and so forth. With each subsequent test, the error rate would increase by 5%. In our case above, we had 3 pairwise comparisons. This means that our Chi-square test would have an error rate of 15%. Meaning our p-value being tested at would equal 0.15, which is quite high.", "In this case, we could use the Bonferroni-adjusted method for correcting the p-value we use. We adjust our P-value by the number of pairwise comparisons we want to do. The formula is p/N, where p= the p-value of the original test and N= the number of planned pairwise comparisons. For example, in our case, above we have 3 class within the Property_Area feature; which means we would have 3 pairwise comparisons if we test all the class against the Loan_Status feature. Our P-value would be 0.05/3 = 0.0167", "Using the adjusted P-value, we could test all the previously significant result to see which class are responsible for creating a significant relationship.", "Here I also include the binary feature for pairwise comparison. As we can see, many of the classes are not actually significant. Even the Loan_Amount_Term that previously significant before the post hoc test resulted in all the classes are not significant.", "The aim of this feature selection technique is to see how it impact our prediction model. Let\u2019s use the simplest model; Logistic Regression as a benchmark. First, I would use all the data and see the model performance in the initial phase. Here, I treat all the categorical data as nominal (even the ordinal data).", "Above is the model performance if we use all the data, let\u2019s compare it with the data we selecting via the Chi-Square Test of Independence.", "Previously, if we use all the data as it is we would end up with 21 independent variables. With feature selection, we only have 6 features to work with. I would not do the train test splitting once more because I want to test the data with the same training data and test data. Let\u2019s see how our model performance is with these selected features.", "Metrics wise, the model with selected features is doing slightly better than the one trained with all the features. Theoretically speaking, it could happen because we eliminate all the noise in the data and only end up with the most important pattern. Although, we have not yet analyzed the numerical data which could also be important. Overall, I have shown that with the Chi-Square test of independence we could end up only with the most important categorical features.", "If you are not subscribed as a Medium Member, please consider subscribing through my referral.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "2.1M+ Views |Top 1000 Writer | LinkedIn: Cornellius Yudha Wijaya | Twitter:@CornelliusYW"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffc558b09de43&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc558b09de43--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc558b09de43--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cornelliusyudhawijaya.medium.com/?source=post_page-----fc558b09de43--------------------------------", "anchor_text": ""}, {"url": "https://cornelliusyudhawijaya.medium.com/?source=post_page-----fc558b09de43--------------------------------", "anchor_text": "Cornellius Yudha Wijaya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb67131c013&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&user=Cornellius+Yudha+Wijaya&userId=db67131c013&source=post_page-db67131c013----fc558b09de43---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc558b09de43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc558b09de43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@siora18?utm_source=medium&utm_medium=referral", "anchor_text": "Siora Photography"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/burak3ergun/loan-data-set", "anchor_text": "Kaggle"}, {"url": "https://cornellius.substack.com/welcome", "anchor_text": "newsletter here."}, {"url": "https://cornelliusyudhawijaya.medium.com/membership", "anchor_text": "my referral"}, {"url": "https://medium.com/tag/python?source=post_page-----fc558b09de43---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fc558b09de43---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----fc558b09de43---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/education?source=post_page-----fc558b09de43---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc558b09de43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&user=Cornellius+Yudha+Wijaya&userId=db67131c013&source=-----fc558b09de43---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc558b09de43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&user=Cornellius+Yudha+Wijaya&userId=db67131c013&source=-----fc558b09de43---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc558b09de43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc558b09de43--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffc558b09de43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fc558b09de43---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc558b09de43--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fc558b09de43--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fc558b09de43--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fc558b09de43--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fc558b09de43--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fc558b09de43--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fc558b09de43--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fc558b09de43--------------------------------", "anchor_text": ""}, {"url": "https://cornelliusyudhawijaya.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cornelliusyudhawijaya.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cornellius Yudha Wijaya"}, {"url": "https://cornelliusyudhawijaya.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb67131c013&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&user=Cornellius+Yudha+Wijaya&userId=db67131c013&source=post_page-db67131c013--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5910a6c53f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcategorical-feature-selection-via-chi-square-fc558b09de43&newsletterV3=db67131c013&newsletterV3Id=5910a6c53f14&user=Cornellius+Yudha+Wijaya&userId=db67131c013&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}