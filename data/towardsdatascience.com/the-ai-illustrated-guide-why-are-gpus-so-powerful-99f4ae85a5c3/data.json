{"url": "https://towardsdatascience.com/the-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3", "time": 1683008173.194529, "path": "towardsdatascience.com/the-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3/", "webpage": {"metadata": {"title": "Why are GPUs So Powerful?. Understand the latency vs. throughput\u2026 | by Ygor Serpa | Towards Data Science", "h1": "Why are GPUs So Powerful?", "description": "In this installment of the AI Illustrated Guide, I overview why GPUs are so fast for AI and the explanation behind its speed. The core idea is to optimize for throughput instead of latency. To\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Von_Neumann_architecture", "anchor_text": "Von Neumann Architecture", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/the-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2?source=your_stories_page---------------------------", "anchor_text": "classification metrics", "paragraph_index": 34}, {"url": "https://www.linkedin.com/in/ygorreboucas/", "anchor_text": "connect with me", "paragraph_index": 35}, {"url": "https://ygorserpa.medium.com/membership", "anchor_text": "subscribing", "paragraph_index": 35}, {"url": "https://stackoverflow.com/", "anchor_text": "StackOverflow", "paragraph_index": 35}, {"url": "https://ygorserpa.medium.com/membership", "anchor_text": "my affiliate link when signing up.", "paragraph_index": 35}], "all_paragraphs": ["In this installment of the AI Illustrated Guide, I overview why GPUs are so fast for AI and the explanation behind its speed. The core idea is to optimize for throughput instead of latency. To understand this concept, I present an analogy with offline vs. online teaching, followed by an overview of how CPUs and GPUs are designed to favor either latency or throughput.", "By the end, I provide you with a simple procedure to compute the throughput and latency of common CPUs and GPUs and a brief overview of how this massive throughput is leveraged when training neural networks.", "Without further ado, let\u2019s take a look at some illustrations :)", "Hiring a private teacher is arguably the fastest way to learn something, but also the most expensive. Getting into a classroom is usually cheaper while still retaining many of the benefits, such as being able to ask questions directly.", "The most affordable option, however, is to enroll in an online course. These lack the physical and personal aspect of teaching but have all the content available to you in video format, which allows you to watch it over and over until you get it. Nevertheless, you are restricted to what is filmed. All else, you have to search for yourself or ask on forums.", "Although you might have your preferences, none is arguably better than the others. They all work, and they all fill a specific need. If you are in a hurry, hire a teacher ASAP. If you are doing it for fun, an online course might be just enough. Else, go for a traditional classroom setting.", "And, most importantly, they can all be used together to achieve optimal results. Say you are not exactly good with languages, but you need to learn Spanish for a job position. You may enroll on a Spanish course for the overall learning, hire a private teacher to get up to speed with technical jargon and play around Duolingo for some extra practice.", "It all boils down to your use case scenario.", "The private teacher can bring you up to a basic level of Chinese in about one month, while the online course might take up to five. This is the latency.", "In five months, the private teacher can teach basic Chinese to only five students, one per month. The online course, however, can do the same for millions of non-Chinese speakers in the same period. This is throughput.", "This is the core difference between CPUs and GPUs: CPUs are optimized for latency: to finish a task as fast as possible; GPUs are optimized for throughput: they are slow, but they operate on bulks of data at once.", "An alternative analogy is traveling by bus vs. traveling by car. In a sports car, you can go much faster and arrive way sooner. However, the car can only take about 2 to 5 people. The bus, although slower, can take up to 80 people with it. In a day, while the car can do maybe two round-trips and bring about ten people, the bus can do just one but it takes 80 people with it.", "The basic principle behind Machine Learning, a sub-field of AI, is to present a learning algorithm with several inputs and outputs and let the algorithm figure out how the inputs relate to the outputs.", "For instance, we could get a lot of data on each student of a previous online course and try to learn whether a person will finish the course or not based on its data. This could, later on, be used to guide a system that grants scholarships for future classes, favoring students that are likely to finish it.", "The algorithm has to see each profile (and its outcome) in order to learn. The more profiles the algorithm can view per second, the faster it will learn. This is where GPUs get into play. A CPU can study a profile very fast, but it can only do a few hundred per minute. A GPU, on the other hand, is far slower but can evaluate several hundred at a time, quickly inspecting more than a thousand entries per second. That\u2019s why it trains faster.", "This also explains why GPUs are considered ineffective after training. In the real world, this algorithm might run only a handful of times per day to process incoming proposals. Thus, the CPU can handle this load much faster. The GPU only excels when there is plenty of data to work on.", "One thing left to explain is how GPUs can manage to have such a high throughput compared to the CPU. The answer lies in its architecture.", "Most modern processors adhere to the \u201cVon Neumann Architecture.\u201d Its basic principle is to divide the processor into three interconnected parts:", "Current CPUs evolved this concept into \u201cmulti-core\u201d architectures, in which a processor has smaller \u201csub-processors,\u201d called cores, that do the actual work. The larger processor, in turn, keeps them in sync, manages the shared memory, and handles the communication with the outside world.", "The main idea behind the GPUs is that control units are large and expensive, while arithmetic units are somewhat more straightforward and cheaper. Therefore, if the same control unity could command several ALUs, it could operate on larger chunks of data, with the limitation that all ALUs must obey the same commands. In other words, they have to do the same thing.", "This diagram illustrates how the GPU trades \u201ccontrol\u201d for \u201carithmetic power.\u201d Each block of 16 ALUs is limited to processing the same instruction over 16 pairs of operands. They are not as versatile as CPU cores but can operate over large amounts of data in batches.", "Also, the GPU is not utterly devoid of flexibility. There is still the central control unit, which syncs all the sub-processors, and each one can do a different task. What is not possible is for the same set of ALUs to do multiple things in parallel. For instance, \u201cif\u201d statements are costly for the GPU.", "This diagram also shows a significant distinction: GPUs are HUGE chips. CPUs are constrained to the same form factor for decades. The best Intel or AMD chips are the same sizes as their worst ones. That\u2019s not the case for GPUs. A low-end GPU is visibly smaller and weaker than a high-end one. Theoretically, we could make faster GPUs by just making them bigger.", "Let\u2019s make a simple comparison: How does the best consumer-grade Ryzen processor fares against the best Nvidia gaming GPU?", "Last time I checked, the best Ryzen CPU was the Threadripper 2990X, which bolsters 32 cores, each capable of running two independent threads, and a clock of 3 GHz that can go up to 4.2 GHz.", "Meanwhile, the Nvidia RTX 2080 TI GPU has an impressive count of 4352 ALUs and a base clock of 1.350 GHz that can be boosted to 1.545 GHz.", "To compare both devices, we use the maximum theoretical number of floating-point operations they can handle per second. This metric measures the maximum possible performance of a device.", "For the CPU, we will assume perfect usage of all 64 threads, that each thread is processing eight floating-point values at the same time (using AVX instructions) and that it is at its peak of processing two instructions per clock tick at its highest possible clock rate. The same goes for the GPU. It has 4352 cores, each capable of one floating-point computation each, doing two operations per clock tick at the peak clock rate.", "This brings us to the following math: clock times efficiency times ALUs:", "Therefore, the 2080TI GPU is theoretically about three times as fast as the Ryzen CPU. In practice, however, it is way faster. Achieving peak utilization with a CPU is a nightmare, while on the GPU, it is relatively more straightforward.", "Alternatively, the latency of each device is mainly dominated by how fast it can go, which is its clock rate. The CPU clocks at 4.2 GHz, while the GPU lags with just ~1.5 GHz, nearly three times slower.", "Therefore, one is not better than the other; they serve different purposes.", "Deep learning is all about processing tensors: multi-dimensional arrays. For instance, a set of 8 RGB images of 256x256 resolution can be expressed as a tensor of shape 8x256x256x3. To apply 64 filters of size 3x3, we need to compute about 905,969,664 floating operations, and that\u2019s just the first layer of our network.", "It is no wonder why GPUs excel at training deep neural networks. It has plenty of data to be processed, and the processing is quite regular. Thus, it fully utilizes the massive arithmetic power while requiring little to no control, which is the weaker side of the GPUs.", "In the following installment of this series, I plan to overview the concepts of the ROC curve and regularization. So far, this one is the second article in the series, being the first one about classification metrics, namely accuracy, sensitivity, specificity, precision, and recall. If you liked this series and would like to see a specific topic illustrated, please let me know in the comments.", "Feel free to comment or connect with me if you have any questions on this article. If you are new to Medium, I highly recommend subscribing. Medium articles are the perfect pair to StackOverflow for Data and IT professionals, and even more so for new comers. Please consider using my affiliate link when signing up.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Former game developer turned data scientist after falling in love with AI and all its branches."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F99f4ae85a5c3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ygorserpa.medium.com/?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": ""}, {"url": "https://ygorserpa.medium.com/?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": "Ygor Serpa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F857d8734c7da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&user=Ygor+Serpa&userId=857d8734c7da&source=post_page-857d8734c7da----99f4ae85a5c3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99f4ae85a5c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99f4ae85a5c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/the-ai-illustrated-guide", "anchor_text": "The AI Illustrated Guide"}, {"url": "https://en.wikipedia.org/wiki/Von_Neumann_architecture", "anchor_text": "Von Neumann Architecture"}, {"url": "https://towardsdatascience.com/the-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2?source=your_stories_page---------------------------", "anchor_text": "classification metrics"}, {"url": "https://www.linkedin.com/in/ygorreboucas/", "anchor_text": "connect with me"}, {"url": "https://ygorserpa.medium.com/membership", "anchor_text": "subscribing"}, {"url": "https://stackoverflow.com/", "anchor_text": "StackOverflow"}, {"url": "https://ygorserpa.medium.com/membership", "anchor_text": "my affiliate link when signing up."}, {"url": "https://medium.com/tag/ai?source=post_page-----99f4ae85a5c3---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----99f4ae85a5c3---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----99f4ae85a5c3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/the-ai-illustrated-guide?source=post_page-----99f4ae85a5c3---------------the_ai_illustrated_guide-----------------", "anchor_text": "The Ai Illustrated Guide"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----99f4ae85a5c3---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99f4ae85a5c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&user=Ygor+Serpa&userId=857d8734c7da&source=-----99f4ae85a5c3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99f4ae85a5c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&user=Ygor+Serpa&userId=857d8734c7da&source=-----99f4ae85a5c3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99f4ae85a5c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F99f4ae85a5c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----99f4ae85a5c3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----99f4ae85a5c3--------------------------------", "anchor_text": ""}, {"url": "https://ygorserpa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ygorserpa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ygor Serpa"}, {"url": "https://ygorserpa.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F857d8734c7da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&user=Ygor+Serpa&userId=857d8734c7da&source=post_page-857d8734c7da--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3644829c90d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ai-illustrated-guide-why-are-gpus-so-powerful-99f4ae85a5c3&newsletterV3=857d8734c7da&newsletterV3Id=3644829c90d9&user=Ygor+Serpa&userId=857d8734c7da&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}