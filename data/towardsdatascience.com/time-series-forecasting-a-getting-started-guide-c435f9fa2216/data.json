{"url": "https://towardsdatascience.com/time-series-forecasting-a-getting-started-guide-c435f9fa2216", "time": 1682996182.977945, "path": "towardsdatascience.com/time-series-forecasting-a-getting-started-guide-c435f9fa2216/", "webpage": {"metadata": {"title": "Time Series Forecasting \u2014 A Getting Started Guide | by Oscar Arzamendia | Towards Data Science", "h1": "Time Series Forecasting \u2014 A Getting Started Guide", "description": "Make predictions with a multivariate time series and exogenous variables using Python, Pandas and SARIMAX model."}, "outgoing_paragraph_urls": [{"url": "https://www.analyticsvidhya.com/blog/2018/09/multivariate-time-series-guide-forecasting-modeling-python-codes/", "anchor_text": "Multivariate TS", "paragraph_index": 1}, {"url": "http://www.businessdictionary.com/definition/exogenous-variable.html", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://www.statsmodels.org/dev/generated/statsmodels.tsa.statespace.sarimax.SARIMAX.html", "anchor_text": "Seasonal AutoRegressive Integrated Moving Average with eXogenous", "paragraph_index": 3}, {"url": "https://medium.com/@oscarzamendia/an-introduction-to-time-series-analysis-using-python-and-pandas-222fe72b191a?source=friends_link&sk=ad5965b01d205cacee81aef407d5cda3", "anchor_text": "I have explained before", "paragraph_index": 5}, {"url": "https://otexts.com/fpp2/stationarity.html", "anchor_text": "differencing", "paragraph_index": 9}, {"url": "https://github.com/osbarge/salesforecaster", "anchor_text": "repo", "paragraph_index": 28}], "all_paragraphs": ["When I started writing this post I thought of just explaining how to do predictions with a \u201csimple\u201d time series (aka univariate time series). The challenging part of the project I was in, however, was the fact that the prediction needed to be made in conjunction with multiple variables. For this reason, I decided to bring this guide a little bit closer to reality and use a multivariate time series.", "A Multivariate TS is a time series with more than one time-dependent variable. Each variable depends on its past values but also has some dependency on other variables. This dependency is taken into account when predicting values. These variables can be endogenous or exogenous. I will be focusing on exogenous variables here.", "An exogenous variable is one whose value is determined outside the model and is imposed on the model. In other words, variables that affect a model without being affected by it. Read more about exogenous variables here.", "Many models can be used to solve a task like this, but SARIMAX is the one we\u2019ll be working with. SARIMAX stands for Seasonal AutoRegressive Integrated Moving Average with eXogenous regressors.", "All good! Now we will go through the steps one can follow to build a sales forecaster.", "As I have explained before, dealing with time series poses some challenges such as making it stationary. If you want more details on why I perform some transformations on the dataframe go and check out my previous post. The focus of this article is the forecasting method.", "In this opportunity, we have two files: one with data about past sales, and the other containing information about local public holidays. As you can imagine, the task will be to predict the amount of sales by combining these two datasets. After loading the files, the dataframes end up looking like this:", "The granularity of both of our datasets is at day level, that is, both columns \u2018Date\u2019 and \u2018fecha\u2019 are indices with a daily frequency. If we want to set the frequency of a dataset we can run the following line:", "We will need to join these two datasets in order to fit our model with all the data we have. \u2018ventas_df\u2019 has the variable we want to predict. \u2018feriados_df\u2019 contains our exogenous variables.", "To make our lives easier, it is better to stationarise ventas_df before joining it with feriados_df. The method I used to make the series more stationary consisted in applying a log transformation and differencing. The stationarised series was stored in \u2018ts_log_diff\u2019 dataframe.", "Now we can join feriados_df and ts_log_diff, which is our transformed ventas_df.", "Sometimes after performing some operations with Pandas, our resulting dataframe loses its frequency. To fix that we can do:", "One can come up with multiple ideas for creating new features out of the existing ones. For simplicity, let us compute the columns below.- holiday_weekday: whether the public holiday fell on a weekday- holiday_weekend: whether the public holiday fell on a Saturday or Sunday- isweekday: whether the date is a weekday- isweekend: if it is weekend- inbetween25and5: salaries are often paid during these days", "Let\u2019s apply one-hot-encoding on column \u2018Holiday\u2019 as well.", "Yass! Sort of\u2026 First, we have to split our data into train and test data. You know, for good practices and avoiding overfitting stuff ;)", "We can\u2019t just use k-folding methods to split our dataset up into training and test. This is because for TS we must take into account the time factor. There are some techniques that we can apply, among them:", "In\u00a0this\u00a0case, number one will be used. Data points from the beginning of the series up to February 2019 will serve as training data. The rest of the data points will be used for testing.", "In the line above, the training data points \u2018data_df[:\u20192019\u201302\u201328\u2019] are passed to the function. It is worth noticing that the first column in the dataframe must contain the values to predict. The rest of the columns are our exogenous variables (i.e., holidays and engineered features). The frequency of the dataframe is given in the \u2018i_freq\u2019 argument. Arguments \u2018i_order\u2019 and \u2018i_seasonorder\u2019 specify the parameters required to train the model, check documentation for SARIMAX to know more about these parameters.", "Definition of my_train_sarimax() function as follow.", "Now it\u2019s time to validate our predictions. To do that we are going to use a function to retrieve the predicted values and then compare them against the true values in our test data points.", "It is worth mentioning that the exogenous variables for the time frame to be predicted must be provided to the model. Remember that these are variables external to the model and it needs them to make the predictions.", "If we look at the \u2018compare_pred_vs_real()\u2019 definition, we can see that the predictions are made with the \u2018get_prediction()\u2019 function. The values can be extracted by using the \u2018predicted_mean\u2019 method.", "We can say our model has a pretty decent performance in terms of MSE and RMSE. Let\u2019s see how far appart are our predictions from the actual number of items sold.", "But, wait\u2026 Why do we see decimal values? The number of items to be sold should always be integers!", "Remember we log-transformed and then applied differencing to our dataset. In order to see the actual numbers our model estimates will be sold we must revert those transformations.", "Because of the differencing operation the original first date in the TS was lost. We need to fill that missing value from \u2018data_df\u2019. Next, we need to append to \u2018y_pred\u2019 all the dates before the prediction. These dates also come from \u2018data_df\u2019. Once we are done with all that, we can revert the differencing with cumsum() and then apply exp() to revert the log transformation.", "We can finally see our predicted values and compare them with the actual ones. Yay!", "Please keep in mind that many methods can be used to accomplish stationarity in a TS. Also, SARIMAX is not the only model that exists to make predictions on time series, and further parameter tuning can help improve the accuracy of the model.", "Feel free to check the entire code for this guide on my github repo.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc435f9fa2216&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://oscarzamendia.medium.com/?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": ""}, {"url": "https://oscarzamendia.medium.com/?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": "Oscar Arzamendia"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd53add7fec9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&user=Oscar+Arzamendia&userId=fd53add7fec9&source=post_page-fd53add7fec9----c435f9fa2216---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc435f9fa2216&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc435f9fa2216&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.analyticsvidhya.com/blog/2018/09/multivariate-time-series-guide-forecasting-modeling-python-codes/", "anchor_text": "Multivariate TS"}, {"url": "http://www.businessdictionary.com/definition/exogenous-variable.html", "anchor_text": "here"}, {"url": "https://www.statsmodels.org/dev/generated/statsmodels.tsa.statespace.sarimax.SARIMAX.html", "anchor_text": "Seasonal AutoRegressive Integrated Moving Average with eXogenous"}, {"url": "https://medium.com/@oscarzamendia/an-introduction-to-time-series-analysis-using-python-and-pandas-222fe72b191a?source=friends_link&sk=ad5965b01d205cacee81aef407d5cda3", "anchor_text": "I have explained before"}, {"url": "https://otexts.com/fpp2/stationarity.html", "anchor_text": "differencing"}, {"url": "https://github.com/osbarge/salesforecaster", "anchor_text": "repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c435f9fa2216---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----c435f9fa2216---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc435f9fa2216&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&user=Oscar+Arzamendia&userId=fd53add7fec9&source=-----c435f9fa2216---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc435f9fa2216&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&user=Oscar+Arzamendia&userId=fd53add7fec9&source=-----c435f9fa2216---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc435f9fa2216&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc435f9fa2216&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c435f9fa2216---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c435f9fa2216--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c435f9fa2216--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c435f9fa2216--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c435f9fa2216--------------------------------", "anchor_text": ""}, {"url": "https://oscarzamendia.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://oscarzamendia.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Oscar Arzamendia"}, {"url": "https://oscarzamendia.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "113 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd53add7fec9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&user=Oscar+Arzamendia&userId=fd53add7fec9&source=post_page-fd53add7fec9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6fab2744a495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-a-getting-started-guide-c435f9fa2216&newsletterV3=fd53add7fec9&newsletterV3Id=6fab2744a495&user=Oscar+Arzamendia&userId=fd53add7fec9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}