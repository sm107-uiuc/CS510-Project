{"url": "https://towardsdatascience.com/generalizing-data-load-processes-with-airflow-a4931788a61f", "time": 1683002844.01256, "path": "towardsdatascience.com/generalizing-data-load-processes-with-airflow-a4931788a61f/", "webpage": {"metadata": {"title": "Generalizing data load processes with Airflow | by Antony Henao | Towards Data Science", "h1": "Generalizing data load processes with Airflow", "description": "We use Airflow as our data pipeline orchestrator in order to easily orchestrating and monitoring data processes. Particularly, we\u2019ve been working on data load processes in order to make them easier\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Extract,_transform,_load", "anchor_text": "data load processes", "paragraph_index": 0}, {"url": "https://www.astronomer.io/guides/dynamically-generating-dags/", "anchor_text": "dynamically generates the DAG", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/creating-a-dynamic-dag-using-apache-airflow-a7a6f3c434f3", "anchor_text": "dynamically generating a DAG workflow", "paragraph_index": 9}, {"url": "https://airflow.apache.org/docs/stable/_api/airflow/operators/docker_operator/index.html", "anchor_text": "Airflow Docker Operators", "paragraph_index": 9}, {"url": "https://github.com/ajhenaor/pyspark-mysql-to-s3-loader", "anchor_text": "MySQL loader", "paragraph_index": 12}, {"url": "https://github.com/ajhenaor/pyspark-mysql-to-s3-loader", "anchor_text": "MySQL loader", "paragraph_index": 14}, {"url": "https://medium.com/u/9f4d525c99e2?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Maxime Beauchemin", "paragraph_index": 14}, {"url": "https://medium.com/@maximebeauchemin/functional-data-engineering-a-modern-paradigm-for-batch-data-processing-2327ec32c42a", "anchor_text": "post", "paragraph_index": 14}, {"url": "https://medium.com/u/9f4d525c99e2?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Maxime Beauchemin", "paragraph_index": 16}, {"url": "https://medium.com/@maximebeauchemin/functional-data-engineering-a-modern-paradigm-for-batch-data-processing-2327ec32c42a", "anchor_text": "post", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/implementing-the-functional-data-engineering-paradigm-in-data-load-processes-by-using-airflow-61d3bae486b0", "anchor_text": "post", "paragraph_index": 16}, {"url": "https://metadatacommunity.substack.com/", "anchor_text": "newsletter", "paragraph_index": 18}, {"url": "https://www.linkedin.com/in/ajhenaor", "anchor_text": "https://www.linkedin.com/in/ajhenaor", "paragraph_index": 20}, {"url": "https://www.buymeacoffee.com/ajhenaor", "anchor_text": "https://www.buymeacoffee.com/ajhenaor", "paragraph_index": 20}], "all_paragraphs": ["We use Airflow as our data pipeline orchestrator in order to easily orchestrating and monitoring data processes. Particularly, we\u2019ve been working on data load processes in order to make them easier. These processes allow us for extracting data from different sources and integrating them in our data lake\u2014in this case, AWS S3.", "In the early days of our experience with Airflow, we would create a DAG for each data source that should be integrated to the data lake. However, after a while, we end up with a lot of duplicated code. Basically, the source code creating the DAGs for extracting the data was the same for each one of them. The only difference among them was the database connection and the query for incrementally loading the data to the data lake.", "The problem with duplicated code is that when changes have to be introduced, they have to be propagated in each one of the DAGs executing data loads\u2014which is time-consuming and error-prone.", "We decided to solve such problem by generalizing the way we create DAGs for data load processes. To do so, we built a framework in which creating such DAGs for orchestrating data load processes is easier. Consequently, in this post, we want to share with you how the framework is structured and how it help us to make easier data load processes.", "We built a framework designed to make easier data loads. Particularly, easier as writing just a configuration file. Based on such a file, the framework dynamically generates the DAG allowing for incrementally extracting data from the target source and uploading it to AWS S3.", "The framework comprises three logic levels: config files, DAG factories, and loaders:", "You can find an illustration of the logical structure of our framework in the next image.", "Next, an example of a config file for a MySQL database named as \u201cdatabasename\u201d is presented. In the config file, some configurations such as DAG name, default args, schedule, database connection, and tables with their column data types are specified. So, they can be used to dynamically generate the DAG.", "In the DAG interface the config file information is read. Then, according to the database engine type, the DAG workflow is created by calling the appropriate factory method. Furthermore, necessary parameters are passed to the factory in order to create the appropriate DAG workflow.", "A factory allows for dynamically generating a DAG workflow allowing for extracting and loading data given a target source. Particularly, the DAG workflow will have as many tasks as tables are specified in the config file. Tasks are based on running the appropriate loader docker image by using Airflow Docker Operators. To do so, the parameters provided in the config file should be passed as environment variables to the docker image.", "Keep in mind the framework is designed to perform daily incremental loads. So, it\u2019s designed to do that. Some changes should be introduced in order to support other use cases.", "We present the MySQL factory in the next code snippet.", "Finally, this is how looks like the DAG workflow generated by the MySQL factory. Keep in mind each task is an airflow docker operator running the MySQL loader.", "A Loader is a docker image allowing for extracting data from a particular database engine and uploading to our data lake \u2014AWS S3.", "In the next snippet of code, the MySQL loader is presented. We try to follow the functional data engineering approach proposed by Maxime Beauchemin in this post. Accordingly, loaders are designed to be context-independent; they use an overwrite approach, and their results are part of immutable staging area. This allows making them easily reproducible.", "We built this framework based on the belief that data load processes should not be written twice, they should be generalized.", "Our solution is highly influenced by the functional data engineering paradigm proposed by Maxime Beauchemin in this post. In fact, you can find more information in this post about how such a paradigm shaped the way loaders are designed.", "Hope you find useful this information!", "If you want to stay updated with my work, please join my newsletter! I\u2019ll try to empower you with information and resources to make you a better data practitioner!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writing to learn! | LinkedIn profile: https://www.linkedin.com/in/ajhenaor | Buy me a coffee: https://www.buymeacoffee.com/ajhenaor"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa4931788a61f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a4931788a61f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ajhenaor.medium.com/?source=post_page-----a4931788a61f--------------------------------", "anchor_text": ""}, {"url": "https://ajhenaor.medium.com/?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Antony Henao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1e72839d5999&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&user=Antony+Henao&userId=1e72839d5999&source=post_page-1e72839d5999----a4931788a61f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa4931788a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa4931788a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/building-a-data-warehouse-basic-architectural-principles-66bd7059ffd0", "anchor_text": "Building a Data Warehouse: Basic Architectural principles"}, {"url": "https://unsplash.com/@maxcodes?utm_source=medium&utm_medium=referral", "anchor_text": "Max Nelson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Extract,_transform,_load", "anchor_text": "data load processes"}, {"url": "https://www.astronomer.io/guides/dynamically-generating-dags/", "anchor_text": "dynamically generates the DAG"}, {"url": "https://www.astronomer.io/guides/dynamically-generating-dags/", "anchor_text": "dynamically create DAGs"}, {"url": "https://towardsdatascience.com/implementing-the-functional-data-engineering-paradigm-in-data-load-processes-by-using-airflow-61d3bae486b0", "anchor_text": "implementing the functional data engineering approach in data load processes"}, {"url": "https://en.wikipedia.org/wiki/Deterministic_algorithm", "anchor_text": "deterministic"}, {"url": "https://en.wikipedia.org/wiki/Idempotence", "anchor_text": "idempotent"}, {"url": "https://towardsdatascience.com/creating-a-dynamic-dag-using-apache-airflow-a7a6f3c434f3", "anchor_text": "dynamically generating a DAG workflow"}, {"url": "https://airflow.apache.org/docs/stable/_api/airflow/operators/docker_operator/index.html", "anchor_text": "Airflow Docker Operators"}, {"url": "https://github.com/ajhenaor/pyspark-mysql-to-s3-loader", "anchor_text": "MySQL loader"}, {"url": "https://github.com/ajhenaor/pyspark-mysql-to-s3-loader", "anchor_text": "MySQL loader"}, {"url": "https://medium.com/u/9f4d525c99e2?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Maxime Beauchemin"}, {"url": "https://medium.com/@maximebeauchemin/functional-data-engineering-a-modern-paradigm-for-batch-data-processing-2327ec32c42a", "anchor_text": "post"}, {"url": "https://medium.com/u/9f4d525c99e2?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Maxime Beauchemin"}, {"url": "https://medium.com/@maximebeauchemin/functional-data-engineering-a-modern-paradigm-for-batch-data-processing-2327ec32c42a", "anchor_text": "post"}, {"url": "https://towardsdatascience.com/implementing-the-functional-data-engineering-paradigm-in-data-load-processes-by-using-airflow-61d3bae486b0", "anchor_text": "post"}, {"url": "https://metadatacommunity.substack.com/", "anchor_text": "newsletter"}, {"url": "https://medium.com/tag/airflow?source=post_page-----a4931788a61f---------------airflow-----------------", "anchor_text": "Airflow"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----a4931788a61f---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a4931788a61f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-warehouse?source=post_page-----a4931788a61f---------------data_warehouse-----------------", "anchor_text": "Data Warehouse"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa4931788a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&user=Antony+Henao&userId=1e72839d5999&source=-----a4931788a61f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa4931788a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&user=Antony+Henao&userId=1e72839d5999&source=-----a4931788a61f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa4931788a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa4931788a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a4931788a61f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a4931788a61f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a4931788a61f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a4931788a61f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a4931788a61f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a4931788a61f--------------------------------", "anchor_text": ""}, {"url": "https://ajhenaor.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ajhenaor.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Antony Henao"}, {"url": "https://ajhenaor.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "881 Followers"}, {"url": "https://www.linkedin.com/in/ajhenaor", "anchor_text": "https://www.linkedin.com/in/ajhenaor"}, {"url": "https://www.buymeacoffee.com/ajhenaor", "anchor_text": "https://www.buymeacoffee.com/ajhenaor"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1e72839d5999&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&user=Antony+Henao&userId=1e72839d5999&source=post_page-1e72839d5999--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f9db0144fc4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeneralizing-data-load-processes-with-airflow-a4931788a61f&newsletterV3=1e72839d5999&newsletterV3Id=1f9db0144fc4&user=Antony+Henao&userId=1e72839d5999&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}