{"url": "https://towardsdatascience.com/eigenfaces-face-classification-in-python-7b8d2af3d3ea", "time": 1683008221.4690938, "path": "towardsdatascience.com/eigenfaces-face-classification-in-python-7b8d2af3d3ea/", "webpage": {"metadata": {"title": "Eigenfaces \u2014 Face Classification in Python | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Eigenfaces \u2014 Face Classification in Python", "description": "Nowadays we can use neural networks to perform state of the art image classification, or face classification in this case. But what about taking a simpler approach? That\u2019s what this article aims to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/daradecic/Python-Eigenfaces", "anchor_text": "access it here", "paragraph_index": 1}, {"url": "https://github.com/daradecic/Python-Eigenfaces", "anchor_text": "GitHub page", "paragraph_index": 9}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 35}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 37}], "all_paragraphs": ["Nowadays we can use neural networks to perform state of the art image classification, or face classification in this case. But what about taking a simpler approach? That\u2019s what this article aims to cover.", "Official repo: access it here to get data and code.", "The idea of taking raw pixel values as input features might seem stupid at first \u2014 and it probably is, mostly because we\u2019d lose all 2D information, and there are also convolutional neural networks to extract important features (as not all pixels are relevant).", "Today we\u2019ll introduce the idea of the Eigenfaces algorithm \u2014 which is simply a principal component analysis applied to face recognition problem. By doing so our hope is to reduce the dimensionality of the dataset, keeping only the components that explain the most variance, and then apply a simple classification algorithm (like SVM) to do the classification task.", "Sounds like a plan, but what should you know before reading this article? It\u2019s a good question. You should be proficient in Python and its data analysis libraries, and also know what principal component analysis is, at least on the high level.", "Still reading? Then I guess you\u2019ve got the prerequisites covered. The last thing we want to discuss before jumping into the code is the article structure, and it can be listed as follows:", "Okay, without much ado, let\u2019s get started!", "As you\u2019ve probably expected, we\u2019ll need the usual suspects \u2014 Numpy, Pandas, and Matplotlib, but will also use a bunch of stuff from ScikitLearn \u2014 like SVM, PCA, train test split, and some metrics for evaluating model performance.", "Down below are all of the imports:", "As for the dataset, we\u2019ve found it a while back on GitHub but can\u2019t seem to find it now. You can download it from my GitHub page.", "And here\u2019s how you\u2019d load it into Pandas:", "Now we can quickly check for the shape of the dataset:", "So, 400 rows and 4097 columns, a strange combination. For the columns we here have normalized pixels values (meaning values in the range (0, 1)), and by the end we have a target column, indicating which person is on the photo.", "If we take a closer look at the number of unique elements of the target column, we\u2019d get the total number of people in the dataset:", "And since we have 4096 features, it\u2019s a clear indicator of 64x64 images in a single color channel:", "Great, we now have some basic information about the dataset, and in the next section we will make some visualizations.", "To visualize a couple of faces we\u2019ll declare a function which transforms 1D vector to a 2D matrix, and uses Matplotlib\u2019s imshow functionality to show it as a grayscale image:", "But before plotting, we need to separate features from the target, otherwise, our dataset will overflow the 64x64 matrix boundaries:", "And that\u2019s it, now we can use the declared function:", "And that\u2019s pretty much it for this section. In the next one we\u2019ll perform the train test split and PCA.", "The goal of this section is to reduce the dimensionality of our problem by keeping only those components that explain the most variance. That in a nutshell is a goal of PCA. But before doing so, we must split the dataset into training and testing portions:", "Now we can apply the PCA on the training features. Then it\u2019s easy to plot the cumulative sum of the explained variance, so we can approximate how many principal components are enough:", "Just by looking at the chart, it seems like around 100 principal components will keep around 95% of the variance, but let\u2019s verify that claim:", "Yes, it looks like 105 components will do the trick. Keep in mind that 95% isn\u2019t set in stone, keep free to go for lower or higher percent on your own.", "Let\u2019s perform the PCA again, but this time with additional n_components argument:", "And finally, we must transform the training features:", "Great! That\u2019s it for this section, and in the next one we\u2019ll train and evaluate the SVM model.", "By now have the training features transformed. The process of training the model is as simple as making an instance of it and fitting the training data:", "Awesome! Model is now trained, and to evaluate it on the test set we\u2019ll first need to bring the test features to the same feature space. Once done, SVM is used to make predictions:", "And now we can finally see it\u2019s performance. For this we\u2019ll use the classification_report from ScikitLearn, as it\u2019s easier to look at than 40x40 confusion matrix:", "So around 90% accuracy, certainly not terrible for 40 different classes and default model.", "And that does it for this article, let\u2019s quickly glance at possible areas of improvement in the next section.", "This was a rather quick guide \u2014 intentionally. You are free to perform a grid search to find optimal hyperparameters for the classifier or even to use a completely different algorithm.", "Also, try opting for 90% and 99% of the explained variance ratio, to see how the model performance changes.", "Thanks for reading, feel free to leave your thoughts in the comment section.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7b8d2af3d3ea&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----7b8d2af3d3ea---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b8d2af3d3ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b8d2af3d3ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@speckfechta?utm_source=medium&utm_medium=referral", "anchor_text": "x )"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/daradecic/Python-Eigenfaces", "anchor_text": "access it here"}, {"url": "https://github.com/daradecic/Python-Eigenfaces", "anchor_text": "GitHub page"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7b8d2af3d3ea---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7b8d2af3d3ea---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----7b8d2af3d3ea---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----7b8d2af3d3ea---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7b8d2af3d3ea---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7b8d2af3d3ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----7b8d2af3d3ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7b8d2af3d3ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----7b8d2af3d3ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b8d2af3d3ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7b8d2af3d3ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7b8d2af3d3ea---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7b8d2af3d3ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenfaces-face-classification-in-python-7b8d2af3d3ea&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}