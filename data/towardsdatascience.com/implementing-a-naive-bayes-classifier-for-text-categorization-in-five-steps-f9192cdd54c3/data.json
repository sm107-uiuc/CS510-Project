{"url": "https://towardsdatascience.com/implementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3", "time": 1682995212.702209, "path": "towardsdatascience.com/implementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3/", "webpage": {"metadata": {"title": "Implementing a Naive Bayes classifier for text categorization in five steps | by Gustavo Ch\u00e1vez | Towards Data Science", "h1": "Implementing a Naive Bayes classifier for text categorization in five steps", "description": "The remainder of this article will provide the necessary background and intuition to build a Naive Bayes classifier from scratch, in five steps. As seen before, the applications of the Bayes\u2026"}, "outgoing_paragraph_urls": [{"url": "https://spamassassin.apache.org/", "anchor_text": "SpamAssassin", "paragraph_index": 11}, {"url": "https://news.ycombinator.com/user?id=jgrahamc", "anchor_text": "jgrahamc", "paragraph_index": 36}, {"url": "http://getpopfile.org/docs/faq:bayesandlogs", "anchor_text": "http://getpopfile.org/docs/faq:bayesandlogs", "paragraph_index": 37}, {"url": "https://github.com/gchavez2/code_machine_learning_algorithms", "anchor_text": "https://github.com/gchavez2/code_machine_learning_algorithms", "paragraph_index": 38}, {"url": "https://amzn.to/2Xjkuqa", "anchor_text": "Conway & Myles Machine Learning for Hackers book, Chapter 3", "paragraph_index": 39}, {"url": "https://www.linkedin.com/in/guschavezcs/", "anchor_text": "LinkedIn", "paragraph_index": 41}], "all_paragraphs": ["Naive Bayes is a learning algorithm commonly applied to text classification.", "Some of the applications of the Naive Bayes classifier are:", "The remainder of this article will provide the necessary background and intuition to build a Naive Bayes classifier from scratch, in five steps.", "As seen before, the applications of the Bayes classifier for text classification are endless. The only prerequisite is to have an existing set of examples for each category (class) that we wish to bucket/categorize pieces of text into.", "For instance, for the job listings classification example, we need a set of job listings that are known for a fact to be targeted (i.e. labeled) for \u201csoftware developers\u201d, a set of job listings known to be targeted for \u201cdesigners\u201d, and a set of job listings targeted for \u201cmarketers\u201d.", "In this case, there are three classes (\u201csoftware development\u201d, \u201cdesign\u201d, and \u201cmarketing\u201d). With samples of job listings in each category, we can train a Naive Bayes classifier so that new job listings are automatically categorized.", "The example that we will explore for the remaining of this article is Spam/Ham classification, therefore, there are two classes: \u201cSpam\u201d and \u201cHam\u201d (i.e. non-spam). As mentioned before, the only prerequisite is to have an existing training set of e-mails known to be Spam and a training set of emails known to be Ham.", "For clarity of exposition, our training set will consist of three Ham emails and three Spam emails (images below are clickable so you can zoom in and read each email):", "Note that in a production-grade spam filter the size of the training set (i.e. the number of known Spam and Ham emails) is typically much larger, nevertheless, the concepts and intuition that we will develop here do apply.", "A term-document matrix (TDM) consists of a list of word frequencies appearing in a set of documents.", "The TDM matrix is a sparse rectangular matrix of n words and m documents. And it\u2019s said to be sparse because it contains mostly zeros. The entry (i,j) of the TDM matrix represents the frequency of word \u201ci\u201d in document \u201cj\u201d.", "For an English spam classifier that considers all the words in the English language, the number of the words (n) is approximately 170k. As for the number of examples per class, the general rule is that the more, the merrier :-). In practice, a few thousands of messages give reasonable predictions, however. For the task of spam detection, the de-facto source for spam labeled data is SpamAssassin.", "The following images are an excerpt of the TDM matrix for the Spam and Ham classes:", "Once the TDM matrices are computed for each class, the next step is to compute the frequency and occurrence of each term:", "From raw frequency count, you can infer that Spam messages contain in high frequency terms such as \u201cfree\u201d, whereas Ham messages contain in high frequency terms such as \u201cexam\u201d. This is how the classifier will be able to tell apart one class from the other.", "The \u201cfrequency\u201d column is the number of times each term appeared in all documents, that is, the sum of the columns of the TDM matrix. The \u201coccurrence\u201d column is the percentage of time each term appeared on all the documents.", "Both the \u201cfrequency\u201d and the \u201coccurrence\u201d columns could be used to compute probability estimates, however, the \u201coccurrence\u201d column is preferred as it is bounded between zero and one.", "From elementary probability, what is the probability of an event A happening given that another event B has also happened? In order words, what\u2019s the probability of A given B?", "we can see that the probability of A given B is the probability that A and B (the intersection) have happened divided by the probability that B has happened, that is:", "Now, what about the probability that B has happened, given that A has also happened? Following the previous formula, we have that:", "Notice from the Venn diagram that", "Thus, by equating Eq. 1 and Eq. 2 we get the Bayes theorem:", "Given the significance of Bayes theorem in the theory of probability, each term has a name:", "In simple terms, the \u201cprior\u201d P(A) and the \u201cevidence\u201d P(B) refer to the probabilities of observing A and B independently from each other, whereas the \u201cposterior\u201d and the \u201clikelihood\u201d are the conditional probabilities of observing A given B and vice versa.", "Going back to our example of email classification in Spam or Ham, the probability that we want to compute is:", "Where x is a feature vector containing the words coming from the Spam (or Ham) emails:", "The \u201cNaive\u201d assumption that the Naive Bayes classifier makes is that the probability of observing a word is independent of each other. The result is that the \u201clikelihood\u201d is the product of the individual probabilities of seeing each word in the set of Spam or Ham emails. We calculated these probabilities in Step 3 and stored them in the \u201coccurrence\u201d column. Formally:", "Notice that the \u201cevidence\u201d is a constant factor depending only on the features, thus the introduction of the proportionality symbol for the \u201clikelihood\u201d computation in the previous equation.", "Furthermore, since our dataset has 3 Spam emails, and 3 Ham emails, we know that the \u201cprior\u201d P(Spam) is 50%.", "In summary, since we have all necessary terms in the Bayes theorem (\u201clikelihood\u201d, \u201cprior\u201d, and \u201cevidence\u201d) we can proceed to compute \u201cposterior\u201d probabilities. Probabilities that will answer the equation, what is the probability that a given (unseen) email is Spam given that is composed of a particular set of words?", "Recall that the main assumption of the Naive Bayes classifier is that each feature (word) is independent of each other.", "Given that we computed a database of probabilities for terms appearing in Spam or Ham e-mails we can proceed to the last step of the Naive Bayes Classifier, which is the classification.", "What it means is that for every incoming e-mail we have to compute the probability of such e-mail being Spam and Ham (i.e. for each class), and our final veridic will be given by the largest probability.", "Consider the following e-mail as an example:", "The probabilities for each class, assuming an arbitrarily small probability of 1e-2 for words that are not in our training set, are:", "Indicating that the e-mail is Ham.", "Note from the comments regarding the chain multiplication of small numbers (thanks to jgrahamc):", "\u201cpractically it can be useful to take log() of the probabilities so that you work with sums of logs rather than multiplying small floats\u201dReference: http://getpopfile.org/docs/faq:bayesandlogs\"", "The source code for files processing, computation of the TDM matrices, frequencies, final classification, and sample emails, can be found in this repository: https://github.com/gchavez2/code_machine_learning_algorithms.", "The code borrows heavily from the Conway & Myles Machine Learning for Hackers book, Chapter 3, published by O\u2019Reilly Media, which also provides a larger database of Spam and Ham emails and strategies to estimate probabilities of words that are not in the vocabulary of the training sets.", "I am a postdoctoral fellow at the Lawrence Berkeley National Laboratory, where I work at the intersection of machine learning and high-performance computing.", "If you find this article interesting, feel free to say hello over LinkedIn, I\u2019m always happy to connect with other professionals in the field.", "And as always: comments, questions, and shares are highly appreciated! \u2764\ufe0f", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Postdoctoral fellow at the Lawrence Berkeley National Laboratory. I work at the intersection of machine learning and high-performance computing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff9192cdd54c3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@GustavoChavezCS", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@GustavoChavezCS?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@GustavoChavezCS?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": "Gustavo Ch\u00e1vez"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd5c3ddbb2482&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&user=Gustavo+Ch%C3%A1vez&userId=d5c3ddbb2482&source=post_page-d5c3ddbb2482----f9192cdd54c3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff9192cdd54c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff9192cdd54c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://spamassassin.apache.org/", "anchor_text": "SpamAssassin"}, {"url": "https://news.ycombinator.com/user?id=jgrahamc", "anchor_text": "jgrahamc"}, {"url": "http://getpopfile.org/docs/faq:bayesandlogs", "anchor_text": "http://getpopfile.org/docs/faq:bayesandlogs"}, {"url": "https://amzn.to/2Xjkuqa", "anchor_text": ""}, {"url": "https://github.com/gchavez2/code_machine_learning_algorithms", "anchor_text": "https://github.com/gchavez2/code_machine_learning_algorithms"}, {"url": "https://amzn.to/2Xjkuqa", "anchor_text": "Conway & Myles Machine Learning for Hackers book, Chapter 3"}, {"url": "https://www.linkedin.com/in/guschavezcs/", "anchor_text": "LinkedIn"}, {"url": "http://eepurl.com/giSKB9", "anchor_text": ""}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f9192cdd54c3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f9192cdd54c3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f9192cdd54c3---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----f9192cdd54c3---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----f9192cdd54c3---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff9192cdd54c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&user=Gustavo+Ch%C3%A1vez&userId=d5c3ddbb2482&source=-----f9192cdd54c3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff9192cdd54c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&user=Gustavo+Ch%C3%A1vez&userId=d5c3ddbb2482&source=-----f9192cdd54c3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff9192cdd54c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff9192cdd54c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f9192cdd54c3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f9192cdd54c3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@GustavoChavezCS?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@GustavoChavezCS?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gustavo Ch\u00e1vez"}, {"url": "https://medium.com/@GustavoChavezCS/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "271 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd5c3ddbb2482&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&user=Gustavo+Ch%C3%A1vez&userId=d5c3ddbb2482&source=post_page-d5c3ddbb2482--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F270fdb311ab4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-a-naive-bayes-classifier-for-text-categorization-in-five-steps-f9192cdd54c3&newsletterV3=d5c3ddbb2482&newsletterV3Id=270fdb311ab4&user=Gustavo+Ch%C3%A1vez&userId=d5c3ddbb2482&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}