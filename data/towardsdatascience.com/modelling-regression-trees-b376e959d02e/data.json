{"url": "https://towardsdatascience.com/modelling-regression-trees-b376e959d02e", "time": 1683009345.49986, "path": "towardsdatascience.com/modelling-regression-trees-b376e959d02e/", "webpage": {"metadata": {"title": "Modelling Regression Trees. How to program this classic Machine\u2026 | by Diego Lopez Yse | Towards Data Science", "h1": "Modelling Regression Trees", "description": "Decision Trees (DTs) are probably one of the most popular Machine Learning algorithms. In my post \u201cThe Complete Guide to Decision Trees\u201d, I describe DTs in detail: their real-life applications\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/the-complete-guide-to-decision-trees-28a4e3c7be14", "anchor_text": "The Complete Guide to Decision Tree", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/hyperparameter-tuning-explained-d0ebb2ba1d35", "anchor_text": "this link", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/ensemble-methods-bagging-boosting-and-stacking-c9214a10a205", "anchor_text": "Bagging or Boosting", "paragraph_index": 38}, {"url": "https://www.linkedin.com/in/lopezyse/", "anchor_text": "Linkedin", "paragraph_index": 39}, {"url": "https://twitter.com/lopezyse", "anchor_text": "Twitter", "paragraph_index": 39}], "all_paragraphs": ["Decision Trees (DTs) are probably one of the most popular Machine Learning algorithms. In my post \u201cThe Complete Guide to Decision Trees\u201d, I describe DTs in detail: their real-life applications, different DT types and algorithms, and their pros and cons. I\u2019ve detailed how to program Classification Trees, and now it\u2019s the turn of Regression Trees.", "Regression Trees work with numeric target variables. Unlike Classification Trees in which the target variable is qualitative, Regression Trees are used to predict continuous output variables. If you want to predict things like the probability of success of a medical treatment, the future price of a financial stock, or salaries in a given population, you can use this algorithm. Let\u2019s see an implementation example in Python.", "The Boston Housing dataset consists of price of houses in various places in Boston, USA. Alongside with their price, this dataset provides information such as crime level, areas of non-retail business in the town, the age of people who own the house, and other attributes.", "The variable called \u2018MEDV\u2019 indicates the prices of the houses and is the target variable. The rest of the variables are the predictors based on which we will predict the value of the house.", "You can cut down the complexity of building DTs by dealing with simpler sub-steps: each individual sub-routine in a DT will connect to other ones to increase complexity, and this construction will let you reach more robust models that are easier to maintain and improve. Now, let\u2019s build a Regression Tree (special type of DT) in Python.", "Loading a data file is the easy part. The problem (and most time-consuming part) usually refers to the data preparation process: setting the right data formats, dealing with missing values and outliers, eliminating duplicates, etc.", "Before loading the data, we\u2019ll import the necessary libraries:", "Now we load the dataset and convert it to a Pandas Dataframe:", "First understand the dataset and describe it:", "Nice: 506 records, 14 numeric variables and no missing values. We don\u2019t need to preprocess the data and we\u2019re ready to model.", "You need to divide your given columns into two types of variables: dependent (or target variable) and independent variable (or feature variables). In our example, variable \u201cMEDV\u201d (the median value of owner-occupied homes) is the one we\u2019re trying to predict.", "To understand model performance, dividing the dataset into a training set and a test set is a good strategy. By splitting the dataset into two separate sets, we can train using one set and test using another.", "Next, we split our dataset into 70% train and 30% test.", "Building a DT is as simple as this:", "In this case, we only defined the splitting criteria (chose mean squared error) and defined only one hyperparameter (the maximum depth to which the tree will be built). Parameters which define the model architecture are referred to as hyperparameters and thus, the process of searching for the ideal model architecture (the one that maximizes the model performance) is referred to as hyperparameter tuning. A hyperparameter is a parameter whose value is set before the learning process begins, and they can\u2019t be directly trained from the data.", "You can take a look at the rest of the hyperparameters you can tune by calling the model:", "Models can have many hyperparameters and there are different strategies for finding the best combination of parameters. You can take a look at some of them on this link.", "Fitting your model to the training data represents the training part of the modelling process. After it is trained, the model can be used to make predictions, with a predict method call:", "A test dataset is a dataset that is independent of the training dataset. This test dataset is the unseen data set for your model which will help you generalizing it:", "One of the biggest strengths of DTs is their interpretability. Visualizing DTs is not only a powerful way to understand your model, but also to communicate how your model works:", "The variable \u201cLSTAT\u201d seems to be critical to define the partition of the Regression Tree. We\u2019ll check this later once we calculate feature importances.", "The quality of a model is related to how well its predictions match up against actual values. Evaluating your machine learning algorithm is an essential part of any project: how can you measure its success and when do you know that it shouldn\u2019t be improved any more? Different machine learning algorithms have varying evaluation metrics, so let\u2019s mention some of the main ones for regression problems:", "Is the mean of the absolute values of the individual prediction errors on over all instances in the test set. It tells us how big of an error we can expect on average.", "Is the mean of the squared prediction errors over all instances in the test set. Because the MSE is squared, its units do not match that of the original output, and also because we are squaring the difference, the MSE will almost always be larger than the MAE: for this reason we can\u2019t directly compare the MAE to the MSE.", "The effect of the square term in the MSE equation is most apparent with the presence of outliers in our data: while each residual in MAE contributes proportionally to the total error, the error grows quadratically in MSE. This ultimately means that outliers in our data will contribute to much higher total error in the MSE than they would in the MAE, and the model will be penalized more for making predictions that differ greatly from the corresponding actual value.", "Is the square root of the mean of the square of all of the error. By squaring the errors before we calculate their mean and then taking the square root of the mean, we arrive at a measure of the size of the error that gives more weight to the large but infrequent errors than the mean. We can also compare RMSE and MAE to determine whether the forecast contains large but infrequent errors: the larger the difference between RMSE and MAE the more inconsistent the error size.", "Explains in percentage terms the amount of variation in the response variable that is due to variation in the feature variables. R Squared can take any values between 0 to 1, and although it provides some useful insights regarding the regression model, you shouldn\u2019t rely only on this measure for the assessment of your model.", "The most common interpretation of R Squared is how well the regression model fits the observed data. Like our example, an R Squared of 0,74 reveals that 74% of the data fit the regression model. Although a higher R Squared indicates a better fit for the model, it\u2019s not always the case that a high measure is good for the regression model: the quality of the statistical measure depends on many factors, such as the nature of the variables employed in the model, the units of measure of the variables, and the applied data transformation.", "Another key metric consists of assigning scores to input features of a predictive model, indicating the relative importance of each feature when making a prediction. Feature importance provides insights into the data, the model, and represents the basis for dimensionality reduction and feature selection, which can improve the performance of a predictive model. The more an attribute is used to make key decisions with the DT, the higher its relative importance.", "As highlighted in the visualization, the variable \u201cLSTAT\u201d has a higher importance in relation to other variables (being the main feature of the model). Let\u2019s see that on a plot:", "Features \u201cLSTAT\u201d and \u201cRM\u201d account for more than 80% of the importance for making predictions.", "We can only compare our model\u2019s error metrics to those of a competing model (e.g. R Squared scores of 2 different models), and although these measures provide valuable insights regarding the model\u2019s performance, always remember:", "Just because a forecast has been accurate in the past, it doesn\u2019t mean it will be accurate in the future.", "We\u2019ve covered several steps during our modelling, and each one of them is a discipline on its own: exploratory data analysis, feature engineering, or hyperparameter tuning are all extensive and complex aspects of any machine learning model. You should consider going deeper into those subjects.", "One important aspect to look at regarding Decision Trees is the way they partition the data space in comparison to other algorithms. If you had chosen to solve the boston housing price prediction with a linear regression, you\u2019d had visualized a graph like the following:", "A liner regression will search for the linear relationship between the target and its predictor. In this example, both variables (\u201cMEDV\u201d and \u201cRM\u201d) seem linearly related which is why this method may work relatively fine, but reality often shows non-linear relationships. Let\u2019s see how a Regression Tree would map the same relationship between target and predictor:", "In this example, a Regression Tree that uses MSE as partition criteria and a max_depth of 5 divides the data space in a completely different way, identifying relationships that a linear regression can\u2019t fit.", "The way a Decision Tree partitions the data space looking to optimize a given criteria will depend not only on the criteria itself (e.g. MSE or MAE as partition criteria), but on the set up of all hyperparamenters. Hyperparameter optimization defines the way a Decision Tree works, and ultimately its performance. Some hyperparameters will deeply affect the performance of the model, and finding their right levels is critical to reach the best possible performance. In the example below, you can see how the hyperparameter max_depth has a huge influence on the Regression Tree\u2019s R squared score when being set up between 0 and 10, but above 10, any level you choose will have no impact on it:", "In order to overcome the fact that you may overfit your model by trying to find the \u201cperfect\u201d hyperparameter levels for your DT, you should consider exploring ensemble methods. Ensemble methods combine several DTs to produce better predictive performance than single DTs. The main principle behind the ensemble model is that a group of weak learners come together to form a strong learner, significantly improving the performance of a single DT. They are used to decrease the model\u2019s variance and bias and improve predictions. Now that you saw how a Decision Tree works, I suggest you move forward with ensemble methods like Bagging or Boosting.", "Interested in these topics? Follow me on Linkedin or Twitter", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb376e959d02e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b376e959d02e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b376e959d02e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lopezyse.medium.com/?source=post_page-----b376e959d02e--------------------------------", "anchor_text": ""}, {"url": "https://lopezyse.medium.com/?source=post_page-----b376e959d02e--------------------------------", "anchor_text": "Diego Lopez Yse"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F806fa785a6af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&user=Diego+Lopez+Yse&userId=806fa785a6af&source=post_page-806fa785a6af----b376e959d02e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb376e959d02e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb376e959d02e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@purzlbaum?utm_source=medium&utm_medium=referral", "anchor_text": "\ud83c\udde8\ud83c\udded Claudio Schwarz | @purzlbaum"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/the-complete-guide-to-decision-trees-28a4e3c7be14", "anchor_text": "The Complete Guide to Decision Tree"}, {"url": "https://towardsdatascience.com/hyperparameter-tuning-explained-d0ebb2ba1d35", "anchor_text": "this link"}, {"url": "https://towardsdatascience.com/ensemble-methods-bagging-boosting-and-stacking-c9214a10a205", "anchor_text": "Bagging or Boosting"}, {"url": "https://www.linkedin.com/in/lopezyse/", "anchor_text": "Linkedin"}, {"url": "https://twitter.com/lopezyse", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b376e959d02e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b376e959d02e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b376e959d02e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----b376e959d02e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----b376e959d02e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb376e959d02e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&user=Diego+Lopez+Yse&userId=806fa785a6af&source=-----b376e959d02e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb376e959d02e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&user=Diego+Lopez+Yse&userId=806fa785a6af&source=-----b376e959d02e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb376e959d02e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b376e959d02e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb376e959d02e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b376e959d02e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b376e959d02e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b376e959d02e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b376e959d02e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b376e959d02e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b376e959d02e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b376e959d02e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b376e959d02e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b376e959d02e--------------------------------", "anchor_text": ""}, {"url": "https://lopezyse.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lopezyse.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Diego Lopez Yse"}, {"url": "https://lopezyse.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "944 Followers"}, {"url": "https://www.linkedin.com/in/lopezyse/", "anchor_text": "https://www.linkedin.com/in/lopezyse/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F806fa785a6af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&user=Diego+Lopez+Yse&userId=806fa785a6af&source=post_page-806fa785a6af--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe1178cb759ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-regression-trees-b376e959d02e&newsletterV3=806fa785a6af&newsletterV3Id=e1178cb759ee&user=Diego+Lopez+Yse&userId=806fa785a6af&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}