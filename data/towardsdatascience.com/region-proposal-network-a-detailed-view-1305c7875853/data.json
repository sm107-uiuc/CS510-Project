{"url": "https://towardsdatascience.com/region-proposal-network-a-detailed-view-1305c7875853", "time": 1683002268.7049391, "path": "towardsdatascience.com/region-proposal-network-a-detailed-view-1305c7875853/", "webpage": {"metadata": {"title": "Region Proposal Network \u2014 A detailed view | by Sambasivarao. K | Towards Data Science", "h1": "Region Proposal Network \u2014 A detailed view", "description": "If you are aware of the R-CNN family for object detection, you might have heard the term \u201cRPN\u201d, which is a region proposal network. If you don\u2019t know about the R-CNN family of detectors, I recommend\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/r-cnn-fast-r-cnn-faster-r-cnn-yolo-object-detection-algorithms-36d53571365e", "anchor_text": "this", "paragraph_index": 0}, {"url": "https://www.learnopencv.com/selective-search-for-object-detection-cpp-python/", "anchor_text": "selective search", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/region-of-interest-pooling-f7c637f409af", "anchor_text": "ROI pooling", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/non-maximum-suppression-nms-93ce178e177c", "anchor_text": "NMS (Non-maximum Suppression)", "paragraph_index": 8}, {"url": "https://github.com/rbgirshick/py-faster-rcnn", "anchor_text": "code", "paragraph_index": 9}, {"url": "http://MLearning.ai", "anchor_text": "MLearning.ai", "paragraph_index": 11}], "all_paragraphs": ["If you are aware of the R-CNN family for object detection, you might have heard the term \u201cRPN\u201d, which is a region proposal network. If you don\u2019t know about the R-CNN family of detectors, I recommend you go through this article before delving deep into RPN.", "We all have a vague idea that Region Proposal Network is used to generate proposals for object detection in faster-rcnn. We also heard that it does that by learning from feature maps obtained from a base network (VGG16, ResNet, etc.,). Many people have this vague idea, but very few have a thorough understanding of how it works. I used to have many doubts. How can RPN learn from feature maps to generate boxes? How does it generate boxes at the image level with feature maps at different spatial levels? What are anchors? How does it cover boxes of all shapes? Won\u2019t there be any missing box for my object? How much recall does it have? What if my box is very small? These are some of the questions I used to have. Going through paper and many blogs have clarified some of the doubts, then I thought of going through the code implementation to get a much clear idea and it helped! Let\u2019s get into it.", "Object Detection approach: We generate the candidate boxes (which might have our objects to detect) and classify those boxes as one of the objects like cat/dog/person etc.. That is classification. At the same time, these box shape adjustments learn to properly fit the actual object. That is bounding box regression.", "Now the first step, which is the generation of candidate boxes, is done by RPN. In the early versions of object detectors, this proposal generation happens offline by traditional computer vision techniques. One such approach is selective search. The drawbacks of these approaches are computation cost and also offline computation.", "RPN came to the rescue by doing this in very little time and also it can be merged to any object detection network which makes it useful for end-to-end training. Just like how our CNNs learn classification from feature maps, it also learns the proposals from feature maps. Let me note down the steps in RPN:", "Anchor point: Every point in the feature map generated by the backbone network is an anchor point. We need to generate anchor boxes for every anchor point. We generate candidate boxes using two parameters \u2014 scales and aspect ratios. The boxes need to be at image dimensions, whereas the feature map is reduced depending on the backbone. For example, in the case of vgg16, the image is reduced by 16 times by the end of the backbone. So how do we generate boxes at image dimensions? We use this 16 as the stride in generating anchor boxes at the image level. (Ex: If anchor scales are [8,16,32] and ratios are [0.5,1,2] and stride is 16, then we use the combination of these scales and ratios to generate 9 anchor boxes for each anchor point and then take a stride of 16 over the image to take the next anchor box.)", "Now we have generated the anchor boxes, but these are dummy boxes that are different from the actual object of interest. Also, there might be many boxes which are not having any object in it. So we need to learn whether the given box is foreground or background, at the same time we need to learn the offsets for the foreground boxes to adjust for fitting the objects. These two tasks are achieved by two convolution layers on the feature map obtained from the backbone network. Those layers are rpn_cls_score and rpn_bbox_pred and the architecture looks like below.", "We learn offsets for x,y,w,h values, where (x,y) is the center of the box, w and h are width and height. We learn these offsets are regression. For learning these scores and offsets, we need to have targets. These targets are generated by comparing the anchor boxes with ground truth boxes. This process is anchor target generation. In anchor target generation, we calculate the IOU of GT boxes with anchor boxes to check if it is fg/bg and then the difference in the coordinates are calculated as targets to be learned by the regressor. Then these targets are used as input for cross-entropy loss and smooth l1 loss.", "Once these fg/bg scores and offsets are learned using convolution layers, some portions of fg and bg boxes are considered according to confidence scores. The offsets are applied to those boxes to get the actual ROIs to be processed further. This post-processing of anchor boxes using offsets is called proposal generation. These final proposals are propagated forward through the ROI pooling layer and fc layers. You can refer to my previous posts to learn about ROI pooling and NMS (Non-maximum Suppression).", "That\u2019s all for this post, hope you got a good understanding of how actually boxes are generated from RPN. You can refer to this code repository for understanding the code. let\u2019s meet later in another post soon.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Computer Vision and Machine Learning Engineer @Honeywell. | Content creator at Analytics Vidhya, Geek Culture, and MLearning.ai"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1305c7875853&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1305c7875853--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1305c7875853--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@SambasivaraoK?source=post_page-----1305c7875853--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@SambasivaraoK?source=post_page-----1305c7875853--------------------------------", "anchor_text": "Sambasivarao. K"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76eb6b1e9d7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&user=Sambasivarao.+K&userId=76eb6b1e9d7f&source=post_page-76eb6b1e9d7f----1305c7875853---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1305c7875853&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1305c7875853&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/r-cnn-fast-r-cnn-faster-r-cnn-yolo-object-detection-algorithms-36d53571365e", "anchor_text": "this"}, {"url": "https://www.learnopencv.com/selective-search-for-object-detection-cpp-python/", "anchor_text": "selective search"}, {"url": "https://www.researchgate.net/publication/325385109_Yield_Estimation_using_faster_R-CNN", "anchor_text": "Source"}, {"url": "https://www.mdpi.com/2072-4292/11/3/286", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/region-of-interest-pooling-f7c637f409af", "anchor_text": "ROI pooling"}, {"url": "https://towardsdatascience.com/non-maximum-suppression-nms-93ce178e177c", "anchor_text": "NMS (Non-maximum Suppression)"}, {"url": "https://github.com/rbgirshick/py-faster-rcnn", "anchor_text": "code"}, {"url": "https://www.mdpi.com/2072-4292/11/3/286", "anchor_text": "https://www.mdpi.com/2072-4292/11/3/286"}, {"url": "https://www.researchgate.net/publication/325385109_Yield_Estimation_using_faster_R-CNN", "anchor_text": "https://www.researchgate.net/publication/325385109_Yield_Estimation_using_faster_R-CNN"}, {"url": "https://arxiv.org/abs/1506.01497", "anchor_text": "https://arxiv.org/abs/1506.01497"}, {"url": "https://medium.com/tag/faster-r-cnn?source=post_page-----1305c7875853---------------faster_r_cnn-----------------", "anchor_text": "Faster R Cnn"}, {"url": "https://medium.com/tag/region-proposal-network?source=post_page-----1305c7875853---------------region_proposal_network-----------------", "anchor_text": "Region Proposal Network"}, {"url": "https://medium.com/tag/rpn?source=post_page-----1305c7875853---------------rpn-----------------", "anchor_text": "Rpn"}, {"url": "https://medium.com/tag/anchor-generation?source=post_page-----1305c7875853---------------anchor_generation-----------------", "anchor_text": "Anchor Generation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1305c7875853&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&user=Sambasivarao.+K&userId=76eb6b1e9d7f&source=-----1305c7875853---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1305c7875853&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&user=Sambasivarao.+K&userId=76eb6b1e9d7f&source=-----1305c7875853---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1305c7875853&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1305c7875853--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1305c7875853&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1305c7875853---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1305c7875853--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1305c7875853--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1305c7875853--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1305c7875853--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1305c7875853--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1305c7875853--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1305c7875853--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1305c7875853--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@SambasivaraoK?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@SambasivaraoK?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sambasivarao. K"}, {"url": "https://medium.com/@SambasivaraoK/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "299 Followers"}, {"url": "http://MLearning.ai", "anchor_text": "MLearning.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76eb6b1e9d7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&user=Sambasivarao.+K&userId=76eb6b1e9d7f&source=post_page-76eb6b1e9d7f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbd5900a586d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregion-proposal-network-a-detailed-view-1305c7875853&newsletterV3=76eb6b1e9d7f&newsletterV3Id=bd5900a586d&user=Sambasivarao.+K&userId=76eb6b1e9d7f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}