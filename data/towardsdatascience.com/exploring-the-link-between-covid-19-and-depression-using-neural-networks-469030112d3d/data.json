{"url": "https://towardsdatascience.com/exploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d", "time": 1683012785.41077, "path": "towardsdatascience.com/exploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d/", "webpage": {"metadata": {"title": "Exploring the Link between COVID-19 and Depression using Neural Networks | by Soah | Towards Data Science", "h1": "Exploring the Link between COVID-19 and Depression using Neural Networks", "description": "The drastic changes in our lifestyles coupled with restrictions, quarantines, and social distancing measures introduced to combat the corona virus outbreak have lead to an alarming rise in mental\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/viritaromero/Detecting-Depression-in-Tweets/blob/master/sentiment_tweets3.csv", "anchor_text": "https://github.com/viritaromero", "paragraph_index": 1}, {"url": "https://github.com/viritaromero/Detecting-Depression-in-Tweets/blob/master/sentiment_tweets3.csv", "anchor_text": "https://github.com/viritaromero/Detecting-Depression-in-Tweets/blob/master/sentiment_tweets3.csv", "paragraph_index": 5}], "all_paragraphs": ["The drastic changes in our lifestyles coupled with restrictions, quarantines, and social distancing measures introduced to combat the corona virus outbreak have lead to an alarming rise in mental health issues all over the world. Social media is a powerful indicator of the mental state of people at a given location and time. In order to study the link between the corona virus pandemic and the accelerating pace of depression and anxiety in the general population, I decided to explore tweets related to corona virus.", "In this blog post, I will first use keras to train a neural network to recognize depressive tweets. For this, I will use a data set of 10,314 tweets divided into depressive tweets (labelled 1) and non depressive tweets (labelled 0). This data set is made by Viridiana Romero Martinez. Here is the link to her github profile: https://github.com/viritaromero", "Once I have the network trained, I will use it for testing tweets scraped from twitter. To establish the link between COVID-19 and depression, I will obtain two different data sets. The first data set will be comprised of tweets with corona virus related keywords such as \u2018COVID-19\u2019, \u2018quarantine\u2019, \u2018pandemic\u2019, and \u2018virus\u2019. The second data set will be comprised of random tweets searched using neutral keywords such as \u2018and\u2019, \u2018I\u2019, \u2018the\u2019 etc. The second data set will serve as a control to check the percentage of depressive tweets in a random sample of tweets. This will allow us to measure the difference in percentage of depressive tweets in a random sample and a sample with COVID-19 specific tweets.", "Before we can get started with training the neural networks, we need to collect and clean the data.", "To get started with the project, we will first need to import all the necessary libraries and modules.", "Once we have all the libraries in place, we need to get the data and pre-process it. You can download the data set from this link: https://github.com/viritaromero/Detecting-Depression-in-Tweets/blob/master/sentiment_tweets3.csv", "We can quickly check the structure of the data set by reading it into a pandas data frame.", "Now we will store the text of the tweets into an array called text. The corresponding labels of the tweets will be stored into a separate array called labels. The code is as follows:", "Apologies for printing out a rather huge data set, but I just did it so that we can quickly examine the overall structure. The first thing I notice is that in the labels array, there are much more zeroes than ones. This means that we have roughly 3.5 times more non-depressive tweets than depressive tweets in the data set. In an ideal situation, I would like to train my neural network on a data set of equal number of depressive and non-depressive tweets. However, in order to obtain equal number of depressive and non-depressive tweets, I will have to substantially truncate my data. I think a larger and imbalanced data set is better than a very small and balanced data set, therefore, I am going to go ahead and use the data set in its original state.", "The second thing you\u2019ll notice is that the tweets contain a lot of the so called \u2018stopwords\u2019 such as \u2018a\u2019, \u2018the\u2019, \u2018and\u2019 etc. These words are not important for classification of a tweet as depressive or non-depressive, hence we will remove these. We also need to remove the punctuation as it is again unnecessary and will only decrease the performance of our neural network.", "I decided to do a quick visualization of the data after cleaning using the amazing wordCloud library and the result is down below. Quite unsurprisingly, the most common word in depressive tweets is depression.", "What the on earth is tokenization?", "Basically, the neural networks do not understand raw text as we humans do. Therefore, in order to make the text more palatable to our neural network, we convert it into a series of ones and zeroes.", "To tokenize text in keras, we import the tokenizer class. This class basically makes a dictionary lookup for a set number of unique words in our overall text. Then using the dictionary lookup, keras allows us to create vectors replace the word with its index value in the dictionary lookup.", "We also go ahead and pad the shorter tweets and truncate the larger ones to make the maximum length of each vector equal to 100.", "You might be wondering, \u2018huh, we only converted words to numbers, not ones and zeroes!\u2019 You are right. There are two ways we can take care of that: either we can covert the numbers into one-hot-encoded vectors or create an embeddings matrix. One-hot-encoding vectors are usually very high dimensional and sparse whereas matrices are lower dimensional and dense. If you are interested, you can read more about it in the \u2018Deep Learning with Python\u2019 book by Francois Chollet. In this blog, I will be using matrices, but before we initialize them, we will need to take care of a few other things first.", "Another issue with the data that you might have identified earlier is that the text array contains all the non-depressive tweets first followed by the all depressive ones. We therefore need to shuffle the data to allow random samples of tweets to go into the training, validation, and test sets.", "Now we need to split the data into the training, validation, and test sets.", "Phew! Finally done with all the data munging!", "Now we can start making the model architecture.", "I will be trying two different models: one with a pre-trained word embeddings layer and one with a trainable word embeddings layer.", "In order to define the neural network architecture, you need to understand how word embeddings work. There is a wealth of information online about word embeddings. This blog post is one of my favorites:", "Now that you hopefully have an idea of the function of the embeddings layer, I will go ahead and create it in code.", "For the first model, the architecture consists of a pre-trained word embeddings layer followed by two dense layers. The code from training the model is as follows:", "Here we can see that the model performs very well with an accuracy of 98 % on the test set. Overfitting is likely to not be an issue because the validation accuracy and loss are almost the same as the training accuracy and loss.", "For the second model, I decided to exclude the pre-trained embeddings layer. The code is as follows.", "The accuracy of both the models on the test set are equally good. However, since the second model is less complex, I will be using it for predicting whether a tweet is depressive or not.", "In order to obtain my data sets of tweets, I used twint which is an amazing webscraping tool for twitter. I prepared two different data sets of 1000 tweets each. The first one consisted of tweets containing corona related keywords such as \u2018COVID-19\u2019, \u2018quarantine\u2019, and \u2018pandemic\u2019.", "Now in order to get a control sample to compare against, I searched for tweets containing neutral keywords such as \u2018the\u2019, \u2018a\u2019, \u2018and\u2019 etc. Using 1000 tweets from this sample, I made up the second control data set.", "I cleaned the data sets using a similar procedure to the one I used for cleaning the training set. After cleaning the data, I fed it to my neural network to predict the percentage of depressive tweets. The results, I obtained were surprising.", "One run of the code is shown below, I repeated it with different batches of data obtained using the same procedure as described above and calculated the average results.", "On average, my model predicted, 35 % depressive tweets and 65 % non-depressive in a data set of tweets obtained using neutral keywords. 35% depressive tweets on a randomly obtained sample is an alarmingly high number. However, the number of depressive tweets with COVID-related keywords was even higher: 55 % depressive vs 45 % non-depressive. That is a 57 % increase in depressive tweets!", "This leads to the conclusion that there is indeed a correlation between COVID-19 and depressive sentiments in tweets on Twitter.", "I hope this post helped you learn a bit more about sentiment analysis using machine learning and I hope you will try out a similar project yourself as well.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Engineering student at University of Cambridge. Passionate about coding, books, and art."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F469030112d3d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----469030112d3d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----469030112d3d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://soah.medium.com/?source=post_page-----469030112d3d--------------------------------", "anchor_text": ""}, {"url": "https://soah.medium.com/?source=post_page-----469030112d3d--------------------------------", "anchor_text": "Soah"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F305321cbf647&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&user=Soah&userId=305321cbf647&source=post_page-305321cbf647----469030112d3d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F469030112d3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F469030112d3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/data-for-change", "anchor_text": "Data for Change"}, {"url": "https://github.com/viritaromero/Detecting-Depression-in-Tweets/blob/master/sentiment_tweets3.csv", "anchor_text": "https://github.com/viritaromero"}, {"url": "https://xaltius.tech/why-is-data-cleaning-important/", "anchor_text": "https://xaltius.tech/why-is-data-cleaning-important/"}, {"url": "https://github.com/viritaromero/Detecting-Depression-in-Tweets/blob/master/sentiment_tweets3.csv", "anchor_text": "https://github.com/viritaromero/Detecting-Depression-in-Tweets/blob/master/sentiment_tweets3.csv"}, {"url": "https://unsplash.com/@svi_designs", "anchor_text": "Sergi Viladesau"}, {"url": "https://towardsdatascience.com/introduction-to-word-embedding-and-word2vec-652d0c2060fa", "anchor_text": "https://towardsdatascience.com/introduction-to-word-embedding-and-word2vec-652d0c2060fa"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----469030112d3d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----469030112d3d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/covid-19?source=post_page-----469030112d3d---------------covid_19-----------------", "anchor_text": "Covid-19"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----469030112d3d---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/data-for-change?source=post_page-----469030112d3d---------------data_for_change-----------------", "anchor_text": "Data For Change"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F469030112d3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&user=Soah&userId=305321cbf647&source=-----469030112d3d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F469030112d3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&user=Soah&userId=305321cbf647&source=-----469030112d3d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F469030112d3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----469030112d3d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F469030112d3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----469030112d3d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----469030112d3d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----469030112d3d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----469030112d3d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----469030112d3d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----469030112d3d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----469030112d3d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----469030112d3d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----469030112d3d--------------------------------", "anchor_text": ""}, {"url": "https://soah.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://soah.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soah"}, {"url": "https://soah.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "16 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F305321cbf647&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&user=Soah&userId=305321cbf647&source=post_page-305321cbf647--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc28fa6226138&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-the-link-between-covid-19-and-depression-using-neural-networks-469030112d3d&newsletterV3=305321cbf647&newsletterV3Id=c28fa6226138&user=Soah&userId=305321cbf647&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}