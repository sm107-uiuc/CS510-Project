{"url": "https://towardsdatascience.com/feature-selection-why-how-explained-part-2-352d9130c2e1", "time": 1682996607.543692, "path": "towardsdatascience.com/feature-selection-why-how-explained-part-2-352d9130c2e1/", "webpage": {"metadata": {"title": "Feature Selection Why & How Explained | by Zixuan Zhang | Towards Data Science", "h1": "Feature Selection Why & How Explained", "description": "In the last article, I explained the problems with including irrelevant or correlated features in model building. In this article, I\u2019ll show you several neat implementations of selection algorithms\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFECV.html", "anchor_text": "RFECV", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFE.html", "anchor_text": "RFE needs several parameters and you must provide these two", "paragraph_index": 6}, {"url": "https://medium.com/@zhangzix/feature-selection-why-how-explained-part-1-c2f638d24cdb", "anchor_text": "using condition number", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.GenericUnivariateSelect.html#sklearn.feature_selection.GenericUnivariateSelect", "anchor_text": "This function needs 3 parameters", "paragraph_index": 15}], "all_paragraphs": ["In the last article, I explained the problems with including irrelevant or correlated features in model building. In this article, I\u2019ll show you several neat implementations of selection algorithms that can be easily integrated into your project pipeline.", "Before diving into the detailed implementation, let\u2019s go through the dataset I created. The dataset has 20 features, among which 5 contribute to the output and 2 are correlated.", "Wrapper algorithms are straightforward. The validity of features is examined by training and validating models. That means wrappers are very slow when it comes to large datasets.", "Though the specific criteria for adding/dropping features might differ, the core ideas are the same. Therefore, I\u2019ll focus on one particular method called Backward Selection.", "Provided with a model that has feature coefficients (e.g. regression)or importance factors (e.g. trees), the algorithm starts from all features and greedily eliminates the least important feature. Once all features are removed, the algorithm returns the subset which gives the best performance.", "Scikit-Learn provides a nice implementation called RFECV (Recursive Feature Elimination and Cross-Validation Selection), an algorithm eliminates irrelevant features based on validation scores.", "RFE needs several parameters and you must provide these two:", "A supervised learning estimator with a fit method that provides information about feature importance either through coef_ or feature_importances_", "scoring : string, callable or None, optional, (default=None)", "There are many estimators in Scikit-Learn satisfy the criteria. In this example, a simple SVM classifier is used. A scoring function is a metric to evaluate the performance of the model (e.g. accuracy).", "RFECV selects 7 features, including all relevant features and redundant features. This shows that RFECV isn\u2019t good at removing multicollinearity (since the coefficients of colinear features tend to vary widely). Therefore, it is a good practice to identify multicollinearity first (e.g. using condition number ).", "In real-world applications where millions of data points are used, wrappers become impractical. Filtering algorithms approach the problem by estimating the validities of features through statistical tests (e.g. correlation coefficient) instead of training an actual model.", "Although there are many advanced filtering methods such as mRMR, I prefer this straightforward two-step method.", "As introduced in the first article, colinearity or multicollinearity is harmful. Following is an algorithm developed by myself to eliminate both.", "Univariate selection performs statistical tests on features and the output and only features with high scores are kept. Common tests include Chi-Square, ANOVA, or Mutual Information.", "Again, Scikit-Learn offers a nice function called GenericUnivariateSelect. This function needs 3 parameters", "Function taking two arrays X and y, and returning a pair of arrays (scores, pvalues). For modes \u2018percentile\u2019 or \u2018kbest\u2019 it can return a single array scores.", "param : float or int depending on the feature selection mode", "Choose your desired statistic methods (e.g. Chi-Square, F score) as the scoring function. I\u2019ll use Chi-Square since y is categorical.", "The algorithm drops features with P values greater than 0.5. It is a good practice to use threshold not too small so that we don\u2019t drop informative features(we dropped a useful feature here).", "Embedded feature selection intelligently drops unnecessary features during training. Common algorithms include Lasso regression, decision tree, and auto-encoder neural network. I\u2019ll explain Lasso regression here.", "Lasso regression penalizes the model for using large feature weights/too many features. As a result, the model tends to use as few parameters as possible and therefore produces sparse results (i.e. some features have weight 0).", "As usual, you can find lasso regression in Scikit-Learn. When initializing the model, the only parameter that you must provide is Alpha, which determines the strength of the penalty. Larger alpha leads to sparser results and alpha=0 essentially means no lasso penalty.", "As you can see, the selection strength is determined by Alpha. The problem is we don\u2019t know what alpha should be used. This issue is solved by selecting the value that performs the best in cross-validation.", "The model ultimately uses 5 parameters, which means all redundant and correlated features are excluded in the model.", "Every type of selection algorithms has its strength and drawbacks and there is no rule of thumb for what method to use. It is important to consider the trade-offs within the context of your project.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "New grad SDE at some random company. Student at Columbia & USC. I know how hard learning CS outside the classroom can be, so I hope my blog can help!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F352d9130c2e1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zixuan-zhang.medium.com/?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": ""}, {"url": "https://zixuan-zhang.medium.com/?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": "Zixuan Zhang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6bee41715a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&user=Zixuan+Zhang&userId=6bee41715a0e&source=post_page-6bee41715a0e----352d9130c2e1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F352d9130c2e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F352d9130c2e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFECV.html", "anchor_text": "RFECV"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFE.html", "anchor_text": "RFE needs several parameters and you must provide these two"}, {"url": "https://medium.com/@zhangzix/feature-selection-why-how-explained-part-1-c2f638d24cdb", "anchor_text": "using condition number"}, {"url": "https://pareonline.net/getvn.asp?v=13&n=5", "anchor_text": "\u201cRevisiting the Collinear Data Problem: An Assesment of Estimator \u2018Ill-Conditioning\u2019 in Linear Regression\u201d"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.GenericUnivariateSelect.html#sklearn.feature_selection.GenericUnivariateSelect", "anchor_text": "This function needs 3 parameters"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----352d9130c2e1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/feature-selection?source=post_page-----352d9130c2e1---------------feature_selection-----------------", "anchor_text": "Feature Selection"}, {"url": "https://medium.com/tag/statistics?source=post_page-----352d9130c2e1---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/python?source=post_page-----352d9130c2e1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F352d9130c2e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&user=Zixuan+Zhang&userId=6bee41715a0e&source=-----352d9130c2e1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F352d9130c2e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&user=Zixuan+Zhang&userId=6bee41715a0e&source=-----352d9130c2e1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F352d9130c2e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F352d9130c2e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----352d9130c2e1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----352d9130c2e1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----352d9130c2e1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----352d9130c2e1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----352d9130c2e1--------------------------------", "anchor_text": ""}, {"url": "https://zixuan-zhang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zixuan-zhang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Zixuan Zhang"}, {"url": "https://zixuan-zhang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6bee41715a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&user=Zixuan+Zhang&userId=6bee41715a0e&source=post_page-6bee41715a0e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8eaa96f63522&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-why-how-explained-part-2-352d9130c2e1&newsletterV3=6bee41715a0e&newsletterV3Id=8eaa96f63522&user=Zixuan+Zhang&userId=6bee41715a0e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}