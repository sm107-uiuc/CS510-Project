{"url": "https://towardsdatascience.com/how-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc", "time": 1682994680.794324, "path": "towardsdatascience.com/how-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc/", "webpage": {"metadata": {"title": "How to cut out the SQL middle-person in analytics | by Keith McNulty | Towards Data Science", "h1": "How to cut out the SQL middle-person in analytics", "description": "One of my current goals in life is to help data analysts cut out the boring, mind-numbing aspects of their work so that they can focus on more interesting, useful and cool stuff. One common situation\u2026"}, "outgoing_paragraph_urls": [{"url": "https://shiny.rstudio.com/articles/rmarkdown.html", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://blog.rstudio.com/2018/06/26/shiny-1-1-0/", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://www.linkedin.com/in/keith-mcnulty/", "anchor_text": "LinkedIn", "paragraph_index": 18}, {"url": "https://twitter.com/dr_keithmcnulty", "anchor_text": "Twitter", "paragraph_index": 18}, {"url": "http://keithmcnulty.org", "anchor_text": "keithmcnulty.org", "paragraph_index": 20}], "all_paragraphs": ["One of my current goals in life is to help data analysts cut out the boring, mind-numbing aspects of their work so that they can focus on more interesting, useful and cool stuff.", "One common situation I see in analytics teams is where analysts are playing an unnecessary and highly repetitive middle-person role \u2014 where business users want certain specific data repeatedly, and it is up to the analyst to manually perform these repetitive SQL queries to extract the data and send it to the client. The same or very similar queries, again and again. Not fun. And actually totally unnecessary with today\u2019s technology.", "I love the R ecosystem. One of the reasons I love it is because it allows you to easily do some magical stuff in terms of linking data sources with web-based interaction. In this post I\u2019ll show you how to set up a simple web app using R Shiny which will allow your non-tech savvy clients to the select raw data they want from a SQL database and fetch and download it in an Excel spreadsheet. This is a safe way to take out the middle-person because you can control who can access the Web app and what data it is allowed to retrieve from the database.", "I\u2019m going to use a simple scenario here to illustrate the concepts, but this idea can be expanded to be able to deliver a substantial amount of downloadable pre-processed data to your clients.", "Let\u2019s assume that you are a data analyst for a chain of vet clinics. Every day you get several requests for data on appointments and appointment cancellations. Two questions are asked: how many appointments did we have for each animal type between these particular years? What % of them were cancelled? You are getting tired and bored of answering these questions again and again using the same SQL queries to your appointments database.", "Your appointments database table is called APPTS_DB and it has a number of columns, in particular DATE (in the format DD-MMM-YYYY, eg 01-MAR-2017), ANIMAL_TYPE (eg Cat, Dog), CANCEL_FLAG (binary 1 if the appointment was cancelled and 0 otherwise).", "I assume you know about the structure of Shiny apps. In this article I will be writing the Shiny app as an interactive R markdown .Rmd document. For more info on this see here.", "Turning commonly used SQL queries into R functions is a really good idea even if you don\u2019t do anything else in this article. It allows you to perform common queries with a single command in your R session.", "For building this into your app, this step can be done in a separate R script that you can load into your Shiny app, or it can be done as a code chunk in the app itself. Let\u2019s assume the latter.", "First we set up a connection to the database. I suggest putting your credentials in the system environment if you are going to store code on Github or any other place where others might see it.", "First we write the SQL query with placeholders and then we use gsub() to swap the placeholders with function arguments and then run the query. We want to set it up to extract the total number of appointments by animal type between a time period commencing with a specified starting year and ending year, and to calculate the cancellation rate. Ideally I would recommend that you do this query in tidy form using dbplyr but I am going to do it in raw SQL here as most readers will be familiar with that.", "This is quite powerful because it allows the fetching of the information using a simple command like appt_query(2015, 2017). You can also use a simple paste() function to paste together the SQL query but I find using gsub() easier to manage and to detect bugs and errors.", "Now we set up some simple inputs for the end user, and a download button that they will press to execute the query and download the data they require.", "In this simple example, the only inputs required from the user is a start year and end year. We will start our year options back in 2010 and we will end with the current year", "This creates a user input panel with a download button confirming the years selected. This download button will link to a server process called downloadData where we will execute the query and write to an Excel file for download to the user.", "Now we write the server process to execute the query and download the data. This has been made simpler by the fact that we have a neat function set up to do the query (see Step 1). We will also set up a neat progress bar so that users can see how the process is progressing. This is not necessary for a simple query which will be done instantly, but if you are building a multiple tab spreadsheet using a number of different queries, it is essential so that users are reassured that something is happening.", "Using this method, the clients only have access to data that you have designed for them. If you use the RStudio Connect sharing platform, you can publish this as an app and provide access to only specific individuals or groups, ensuring that only authorised clients have access. If you use Shiny Server Pro, seek advice in how to control user access from user documentation.", "If you are a fluent Shiny user you can likely immediately grasp what is going on here. If not, you may need more training in Shiny before you take this on. This methodology can be extended to be extremely powerful. Dashboards can be designed using ggplot2 or plotly instead of \u2014 or in addition to \u2014 Excel downloads. Packages like async , future and promises can be used to scale for multiple concurrent users using asychronous programming (for more on that see here). In the most advanced case, an entire flexible business intelligence platform can be built and hosted on Shiny using the initial concepts presented here.", "Originally I was a Pure Mathematician, then I became a Psychometrician and a Data Scientist. I am passionate about applying the rigor of all those disciplines to complex people questions. I\u2019m also a coding geek and a massive fan of Japanese RPGs. Find me on LinkedIn or on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Expert and Author in Applied Mathematics, Data Science, Statistics. Also writes History, Science, Culture. Find me on Twitter or keithmcnulty.org"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9687d640cecc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9687d640cecc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9687d640cecc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://keith-mcnulty.medium.com/?source=post_page-----9687d640cecc--------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=post_page-----9687d640cecc--------------------------------", "anchor_text": "Keith McNulty"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa859aab532a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&user=Keith+McNulty&userId=a859aab532a0&source=post_page-a859aab532a0----9687d640cecc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9687d640cecc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9687d640cecc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://shiny.rstudio.com/articles/rmarkdown.html", "anchor_text": "here"}, {"url": "https://blog.rstudio.com/2018/06/26/shiny-1-1-0/", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/keith-mcnulty/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/dr_keithmcnulty", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9687d640cecc---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----9687d640cecc---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/analytics?source=post_page-----9687d640cecc---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/data?source=post_page-----9687d640cecc---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/automation?source=post_page-----9687d640cecc---------------automation-----------------", "anchor_text": "Automation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9687d640cecc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&user=Keith+McNulty&userId=a859aab532a0&source=-----9687d640cecc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9687d640cecc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&user=Keith+McNulty&userId=a859aab532a0&source=-----9687d640cecc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9687d640cecc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9687d640cecc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9687d640cecc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9687d640cecc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9687d640cecc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9687d640cecc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9687d640cecc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9687d640cecc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9687d640cecc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9687d640cecc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9687d640cecc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9687d640cecc--------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Keith McNulty"}, {"url": "https://keith-mcnulty.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11K Followers"}, {"url": "http://keithmcnulty.org", "anchor_text": "keithmcnulty.org"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa859aab532a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&user=Keith+McNulty&userId=a859aab532a0&source=post_page-a859aab532a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7991b3dbcee9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-cut-out-the-sql-middle-person-in-analytics-9687d640cecc&newsletterV3=a859aab532a0&newsletterV3Id=7991b3dbcee9&user=Keith+McNulty&userId=a859aab532a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://peopleanalytics-regression-book.org/", "anchor_text": "Handbook of Regression Modeling in People Analytics2021"}, {"url": "https://ona-book.org", "anchor_text": "Handbook of Graphs and Networks in People Analytics2022"}, {"url": "https://medium.com/@keith-mcnulty/books?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "See all (2)"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}