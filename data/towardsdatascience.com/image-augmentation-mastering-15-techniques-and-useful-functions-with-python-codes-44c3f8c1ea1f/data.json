{"url": "https://towardsdatascience.com/image-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f", "time": 1683008832.9911969, "path": "towardsdatascience.com/image-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f/", "webpage": {"metadata": {"title": "Image Augmentation Mastering: 15+ Techniques and Useful Functions with Python Codes | by \u2b50Axel Thevenot | Towards Data Science", "h1": "Image Augmentation Mastering: 15+ Techniques and Useful Functions with Python Codes", "description": "Whether we are enjoying Keras or Pytorch we have access to wonderful libraries to efficiently enhance our images. But what about those special cases where: For all these cases and many others, we\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.opencv.org/master/d4/d13/tutorial_py_filtering.html", "anchor_text": "average, median, Gaussian, or bilateral filters", "paragraph_index": 20}, {"url": "https://axel-thevenot.medium.com/membership", "anchor_text": "one click here", "paragraph_index": 34}], "all_paragraphs": ["Whether we are enjoying Keras or Pytorch we have access to wonderful libraries to efficiently enhance our images. But what about those special cases where:", "For all these cases and many others, we must be able to master our image augmentation. Moreover, I use my own functions each time and I am far from being the only one (I think). So in this article, I will introduce and give you my functions to perform image augmentation.", "For the examples, I will use a photo of a friend as a reminder of the great times I had in Canada. I hope you like this picture because it\u2019s the only one you will see in this article... \ud83c\udf41\ud83d\udc7c\ud83c\udf41", "I have segmented it to have a practical case of using our functions with image and target. This will give you an idea of the flexibility of the methods which will be described to you :", "\u26a0\ufe0f The purpose of this article is not to prove how the augmentation techniques were designed, but how to understand them to use them. \u26a0\ufe0f", "Before I begin, I would like to explain the common structure each method will have. It will actually be an object to initialize. This object will be called with our samples as arguments and will return our augmented sample. Is that all? Yes, that\u2019s all! Then let\u2019s just start with some useful functions before our augmentation ones.", "The first useful function allows us to resize our images with a (width, height) shape. This class allows us to see how all the others will be initialized. We instantiate an object with a size parameterized upstream. In our case, all the samples (image and target) will be returned with this same dimension. With a function of this type, we can easily process our image and target at same time in the way we want.", "The clip function is a very useful function, especially when you need to switch from one color space to another or reset the image between 0 and 1 or 0 and 255.", "By default, the minimum threshold is 0 if only one threshold is specified.", "Before passing the inputs in the model we generally want to normalize or standardize our data. Of course, these operations can be done on a specific axis.", "By default, normalization and standardization are performed over the entire image.", "Finally, if you are using Pytorch you will need to turn your images into a torch.Tensor. The only point to note is that with Pytorch our images are channels first and not channel last. Finally, we can also leave the possibility to choose the output type of tensors.", "Maybe at this point, you don\u2019t see how simple the setup is. And yet it is. All we have to do is define a list of the transformations we want to do on our sample and that\u2019s it. We do not touch anything else afterward. Note that the order of the transformations will have its importance. It\u2019s up to you.", "We can now dive into the purpose of the article and see the image augmentation techniques.", "The first, and one of the simplest, consists of randomly performing flips on the horizontal and vertical axes of the images. In other words, there is a 50/50 chance of performing a vertical flip and a 50/50 chance of performing a horizontal flip.", "To do image augmentation, it is common to crop the image randomly. In other words, we crop a part of the image of random size and over a random area.", "The size of the cropped image can be chosen from a ratio on the dimensions (height, width). If the proportional maximum size of the crop is not specified then we will consider by default that it is the size of the image.", "We are going to get into something a little more enjoyable. Filters are great classics but I think it\u2019 is important to be able to easily create our own convolution filters. If you do not know how a filter works I refer you to my article about Conv2d.", "So I wanted to make a general function to be able to use our own filters.", "As far as filters are concerned, it is possible to go even further by choosing a filter upstream and applying it with random weighting. For example, I introduce you the filter for sharpening our image.", "To finish with the filters, the most popular are used to randomly blur our image. There are a lot of ways to blur our image. The best known are the average, median, Gaussian, or bilateral filters.", "Concerning average filter. As its name indicates: it allows us to average the values on a given center. This is made by a kernel. Its size can be specified for more or less blur. To increase our images with an average filter we just need to filter our input image with a kernel of a random size.", "Finally in the same way as for the average blur. The Gaussian blur does not use an average filter but a filter so the values correspond to a Gaussian curve from the center. Note that the kernel dimension must contain odd numbers only.", "By far the most widely used image enhancement technique is perspective transformation. There are rotation, translation, shearing, and scaling. These transformations can be performed in a 3D dimension. Usually, they are used only in 2D which is a pity. Let\u2019s take advantage of everything we have at our disposition, right?", "I will not take more time on the 3D transformations of a 2D image because I wrote a whole article about it. So I picked up the function we get at the end of this article. I invite you to have a look at it if you want to know more about homogeneous coordinates and 3D transformation matrices.", "What should be noted is that this function allows us to randomly perform transformations according to the 4 proposed matrices. The order has its importance. Here we have the shearing, then the rotation, then the scale, and finally the translation. Note that the translation is done by a ratio of the dimensions of the image.", "The cutout is pretty intuitive. It involves removing regions of the input image at random. It works in the same way as the cropping we talked about earlier. But instead of returning the regions concerned, we delete them. We can, therefore, once again allow the user to provide a minimum and maximum size per ratio of regions to be deleted, a maximum number of regions, to cut the regions from the target at the same time or not, we can perform this cutout per channel, and also choose the default replacement value of the deleted regions.", "Now we get to the part I find the funniest. A part that is very rarely taken into account. If we know the color spaces we can take advantage of their properties to enhance our images. To give you a simple example, with the HSV color space we can have fun extracting the leaf thanks to its color and change its color randomly according to our wishes. That is a very cool thing to do! And we understand the interest of having our own image enhancement functions. Of course, this requires a little more creativity. So it is important to know our color spaces to make the most of them. Particularly since they can be crucial in preprocessing for our (Deep) Machine Learning models.", "Let\u2019s stay on our colors a little longer. A great classic in image augmentation is to be able to play with brightness. There are several ways to do so the simplest is to simply add a random bias.", "In the same way, it is very simple to play with contrasts. This can also be done randomly.", "The last fairly common image enhancement technique is noise injection. In reality, we only add a matrix of the same size as our input. This matrix is composed of elements following a random distribution. Noise injection can be done from any random distribution. In practice, we only see two of them. But feel free to go further \ud83d\ude03", "Finally, much less used but not useless. Some cameras have a vignetting effect. It is also interesting to think about how we can increase our images by randomly imitating this phenomenon. We will also try to give flexibility to the user. We will be able to decide the minimum distance from the effect can randomly start, decide its intensity, and even decide if it\u2019s an effect that goes towards black or toward white.", "And finally the best for last. I am surprised it is not used more often. But it can mimic the distortion of a camera lens. It is like looking through a round glass. What appears to us is distorted because the lens (the glass) is rounded. So if our images are taken from a camera with a lens why do we not simulate them. This should be used by default for images. At least I think so.", "I thus propose in this last function to be able to randomly simulate our lens distortion by playing on the radial coefficients k1, k2, k3 and on the tangential coefficients p1, p2. In this method, the order of the coefficients is as follows: k1, k2, p1, p2, k3. I invite you to have a look at the OpenCV documentation on this subject.", "Knowledge is all about sharing.Support me and get access of all my articles in one click here.", "Everything is homemade and free to use (Including the images and the GIFs)", "Special thanks to Elise for authorizing to use this picture \ud83d\udc4b", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F44c3f8c1ea1f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://axel-thevenot.medium.com/?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": ""}, {"url": "https://axel-thevenot.medium.com/?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": "\u2b50Axel Thevenot"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa8fcc1458e87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&user=%E2%AD%90Axel+Thevenot&userId=a8fcc1458e87&source=post_page-a8fcc1458e87----44c3f8c1ea1f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F44c3f8c1ea1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F44c3f8c1ea1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/conv2d-to-finally-understand-what-happens-in-the-forward-pass-1bbaafb0b148", "anchor_text": "Conv2d: Finally Understand What Happens in the Forward PassVisual and mathematical explanation of the 2D convolution layer and its argumentstowardsdatascience.com"}, {"url": "https://docs.opencv.org/master/d4/d13/tutorial_py_filtering.html", "anchor_text": "average, median, Gaussian, or bilateral filters"}, {"url": "https://towardsdatascience.com/how-to-transform-a-2d-image-into-a-3d-space-5fc2306e3d36", "anchor_text": "How to transform a 2D image into a 3D space ?Perform with transformation matrices with python. Mathematically and visually explained for video games and Deep\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/understand-and-visualize-color-spaces-to-improve-your-machine-learning-and-deep-learning-models-4ece80108526", "anchor_text": "Understand and Visualize Color Spaces to Improve Your Machine Learning and Deep Learning ModelsExplain, analyze and experiment 14 popular color spaces and their consequences on the accuracy of our models.towardsdatascience.com"}, {"url": "https://docs.opencv.org/2.4/doc/tutorials/calib3d/camera_calibration/camera_calibration.html", "anchor_text": "Camera calibration With OpenCV \u2014 OpenCV 2.4.13.7 documentationCameras have been around for a long-long time. However, with the introduction of the cheap pinhole cameras in the late\u2026docs.opencv.org"}, {"url": "https://axel-thevenot.medium.com/membership", "anchor_text": "one click here"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----44c3f8c1ea1f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----44c3f8c1ea1f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----44c3f8c1ea1f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----44c3f8c1ea1f---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----44c3f8c1ea1f---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://creativecommons.org/publicdomain/mark/1.0/", "anchor_text": "Public domain."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F44c3f8c1ea1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&user=%E2%AD%90Axel+Thevenot&userId=a8fcc1458e87&source=-----44c3f8c1ea1f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F44c3f8c1ea1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&user=%E2%AD%90Axel+Thevenot&userId=a8fcc1458e87&source=-----44c3f8c1ea1f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F44c3f8c1ea1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F44c3f8c1ea1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----44c3f8c1ea1f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----44c3f8c1ea1f--------------------------------", "anchor_text": ""}, {"url": "https://axel-thevenot.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://axel-thevenot.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "\u2b50Axel Thevenot"}, {"url": "https://axel-thevenot.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "733 Followers"}, {"url": "http://www.linkedin.com/in/axel-thevenot", "anchor_text": "www.linkedin.com/in/axel-thevenot"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa8fcc1458e87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&user=%E2%AD%90Axel+Thevenot&userId=a8fcc1458e87&source=post_page-a8fcc1458e87--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbb1ccd160e04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-augmentation-mastering-15-techniques-and-useful-functions-with-python-codes-44c3f8c1ea1f&newsletterV3=a8fcc1458e87&newsletterV3Id=bb1ccd160e04&user=%E2%AD%90Axel+Thevenot&userId=a8fcc1458e87&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}