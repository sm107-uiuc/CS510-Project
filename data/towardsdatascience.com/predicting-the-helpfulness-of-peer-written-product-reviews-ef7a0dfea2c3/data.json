{"url": "https://towardsdatascience.com/predicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3", "time": 1683004068.3604429, "path": "towardsdatascience.com/predicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3/", "webpage": {"metadata": {"title": "Predicting the \u201chelpfulness\u201d of peer-written product reviews | by JR Kreiger | Towards Data Science", "h1": "Predicting the \u201chelpfulness\u201d of peer-written product reviews", "description": "Some e-commerce sites let customers write reviews of their products, which other customers can then browse when considering buying a product. I know I\u2019ve read product reviews written by my fellow\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/snap/amazon-fine-food-reviews", "anchor_text": "large collection of product reviews from Amazon", "paragraph_index": 2}, {"url": "https://github.com/jrkreiger/helpful-reviews", "anchor_text": "check out my GitHub repo", "paragraph_index": 2}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "smart folks at Stanford trained a massive model", "paragraph_index": 16}, {"url": "https://github.com/jrkreiger/helpful-reviews", "anchor_text": "check out the code on GitHub", "paragraph_index": 24}], "all_paragraphs": ["Some e-commerce sites let customers write reviews of their products, which other customers can then browse when considering buying a product. I know I\u2019ve read product reviews written by my fellow customers to help me figure out if a product would be true to size, last a long time, or contain an ingredient I\u2019m concerned about.", "What if a business could predict which reviews its customers would find helpful? Maybe it could put those reviews first on the page so that readers could get the best information sooner. Maybe the business could note which topics come up in those helpful reviews and revise its product descriptions to contain more of that sort of information. Maybe the business could even identify \u201csuper reviewers,\u201d users who are especially good at writing helpful reviews, and offer them incentives to review more products.", "Using a large collection of product reviews from Amazon, I trained a range of machine learning models to try to identify which reviews readers rated as \u201chelpful.\u201d I tried Random Forests, logistic regression, a Support Vector Machine, GRU networks, and LSTM networks, along with a variety of natural language processing (NLP) techniques for preprocessing my data. As it turns it, predicting helpful reviews is pretty hard, but not impossible! To go straight to the code, check out my GitHub repo. To learn more about how I did it, read on.", "Here\u2019s what you need to know about the dataset:", "Here\u2019s a quick look at the counts of reviews, total tokens, and unique tokens by class:", "Although there are fewer helpful reviews, they contain more words and more unique words than the unhelpful ones.", "Given the contents of this dataset, I had two big questions. Question 1: Can \u201chelpfulness\u201d be predicted using any of the features other than the text of the reviews themselves? For instance, if helpful reviews always include a 5-star rating or are always written by the same subset of reviewers, that would save me a lot of text-wrangling!", "As it turns out, no: helpful reviews can\u2019t be predicted using any of the other features in the dataset, or any of a handful that I engineered myself. Helpful reviews can be short, long, positive, or negative; they can be written by newbie or experienced reviewers; they can be about popular or obscure products; and their vocabulary is very similar to that of unhelpful reviews.", "Here\u2019s a t-SNE plot of a sample of reviews, focusing on the texts themselves. A t-SNE plot basically does principal components analysis on a dataset, reduces all the features to just 2 or 3 components, and plots them so you can see how the classes overlap (or don\u2019t). This plot reveals a nightmare: at least in these two dimensions, the two classes overlap a lot.", "That brings me to Question 2: If there\u2019s no shortcut way to predict helpfulness, how should I go about predicting it from text? How should I preprocess the reviews for modeling? What models should I try? Using human-generated text as input for predictive models is notoriously difficult, partly because there are so many ways to turn text into data, and then you need fairly complex models to handle that data. Which to choose?", "When deciding how to preprocess the review texts, I wanted to try a range of techniques, focusing on those that seemed most promising during the exploratory phase of my project. As for modeling, I wanted to start with models that were simpler and quicker to train, then work up to my most complex options. I hoped that the first few rounds of testing would help me identify the best preprocessing option, while the last few rounds would help me hone my best model.", "My first big round of experimentation consisted of testing different preprocessing techniques against a baseline Random Forest model:", "All of these performed in the range of 54\u201355% accuracy on validation data, which is only a pinch better than random guessing, but at least it\u2019s not worse than random guessing! TF-IDF scored the highest, so I decided to try to tune a Random Forest to do even better with TF-IDF vectors as input. I tried the following:", "All this yielded a model that was overfit to the training data (over 99% accuracy) and 57% accurate on validation data, my best so far.", "But 7 percentage points better than random guessing isn\u2019t much to write home about, so I moved on to a transfer learning approach.", "Transfer learning involves taking weights calculated by someone else\u2019s model and plugging them into your own. This can be a really convenient way to benefit from someone else\u2019s investment in training a huge model on, for example, all of Wikipedia.", "That\u2019s where GloVe embeddings come in. Some smart folks at Stanford trained a massive model to quantify the relationships between English words in context. I can benefit from this by collecting the relevant embedding vector from GloVe for every word in my review corpus. Then for every review, I take the mean of all the individual word vectors to make a new vector that represents the whole text of the review. All the review vectors can then be passed to a model for training or prediction.", "I passed my GloVe embeddings to three models: a Random Forest, a logistic regression, and a Support Vector Classifier. These models also scored in the range of 53\u201356% accuracy on validation data, with the Random Forest doing the best. After some additional tuning, I was still only getting a validation accuracy of 56%.", "After all this, I was pretty keen to see what a neural network could do.", "Sequence-to-sequence models are known to perform well with text data, so I decided to try a couple different neural network architectures of this type. I was especially interested in having these networks calculate their own embeddings on the fly; since GloVe hadn\u2019t done so well, I hoped that embeddings based only on my dataset might be a better choice.", "Have a look at the structure of my baseline neural network:", "That\u2019s a layer to calculate embeddings, two layers of 25 Gated Recurrent Unit (GRU) nodes each, a layer to pool their outputs, two dense layers of 50 nodes each (with 50% dropout to try to avoid overfitting), and then a single node to make the final prediction for each sample. I also tried the same architecture but with Long Short-Term Memory (LSTM) nodes instead of GRUs. There was no substantial difference in the results, and the GRUs were a little faster, so I decided to continue tuning the GRU network with bigger input vectors and more training epochs.", "Overall, my best model was the last one: a GRU network achieving 59% accuracy on validation data. On my holdout dataset, this model scored 59% accuracy as well, which is not bad, considering the complexity of the problem it\u2019s trying to solve.", "A model like this could be used to sort reviews as they are submitted and move those likely to be helpful to the top of the queue. A business could also scrape its own website for reviews, filter for the helpful ones, and then review those to learn what potential customers want to know that their product descriptions aren\u2019t providing. Likewise, a business could identify the writers of helpful reviews and encourage them to write more, or modify their review submission form to include tips for writing more informative reviews (as AirBnB, TripAdvisor, and others already do).", "If you\u2019d like to see my whole project on helpful reviews in glorious detail, check out the code on GitHub. Thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist with a background in archaeology, museums, and libraries. On Twitter @j_re."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fef7a0dfea2c3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jrkreiger?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jrkreiger?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": "JR Kreiger"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F612d3a26f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&user=JR+Kreiger&userId=612d3a26f7&source=post_page-612d3a26f7----ef7a0dfea2c3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef7a0dfea2c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef7a0dfea2c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/snap/amazon-fine-food-reviews", "anchor_text": "large collection of product reviews from Amazon"}, {"url": "https://github.com/jrkreiger/helpful-reviews", "anchor_text": "check out my GitHub repo"}, {"url": "https://www.kaggle.com/snap/amazon-fine-food-reviews", "anchor_text": "It comes from Amazon (via Kaggle)"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.TruncatedSVD.html", "anchor_text": "TruncatedSVD"}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "smart folks at Stanford trained a massive model"}, {"url": "https://github.com/jrkreiger/helpful-reviews", "anchor_text": "check out the code on GitHub"}, {"url": "http://jrkreiger.net", "anchor_text": "jrkreiger.net"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ef7a0dfea2c3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ef7a0dfea2c3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----ef7a0dfea2c3---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/nlp?source=post_page-----ef7a0dfea2c3---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ef7a0dfea2c3---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fef7a0dfea2c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&user=JR+Kreiger&userId=612d3a26f7&source=-----ef7a0dfea2c3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fef7a0dfea2c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&user=JR+Kreiger&userId=612d3a26f7&source=-----ef7a0dfea2c3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef7a0dfea2c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fef7a0dfea2c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ef7a0dfea2c3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ef7a0dfea2c3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jrkreiger?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jrkreiger?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "JR Kreiger"}, {"url": "https://medium.com/@jrkreiger/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "146 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F612d3a26f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&user=JR+Kreiger&userId=612d3a26f7&source=post_page-612d3a26f7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1ffcf7fdc01f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-helpfulness-of-peer-written-product-reviews-ef7a0dfea2c3&newsletterV3=612d3a26f7&newsletterV3Id=1ffcf7fdc01f&user=JR+Kreiger&userId=612d3a26f7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}