{"url": "https://towardsdatascience.com/part-8-ab-joins-with-stumpy-af985e12e391", "time": 1683016696.3050811, "path": "towardsdatascience.com/part-8-ab-joins-with-stumpy-af985e12e391/", "webpage": {"metadata": {"title": "Part 8: AB-Joins with STUMPY. Finding Conserved Patterns Across Two\u2026 | by Sean Law | Towards Data Science", "h1": "Part 8: AB-Joins with STUMPY", "description": "STUMPY is a powerful and scalable Python library for modern time series analysis and, at its core, efficiently computes something called a matrix profile. The goal of this multi-part series is to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/TDAmeritrade/stumpy", "anchor_text": "STUMPY is a powerful and scalable Python library for modern time series analysis", "paragraph_index": 0}, {"url": "https://stumpy.readthedocs.io/en/latest/", "anchor_text": "STUMPY", "paragraph_index": 0}, {"url": "https://stumpy.readthedocs.io/en/latest/tutorials.html", "anchor_text": "STUMPY documentation", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/the-matrix-profile-e4a679269692", "anchor_text": "The Matrix Profile", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/stumpy-basics-21844a2d2d92", "anchor_text": "STUMPY Basics", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/part-3-time-series-chains-da281450abbf", "anchor_text": "Time Series Chains", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/part-4-semantic-segmentation-b42c3792833d", "anchor_text": "Semantic Segmentation", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/part-5-fast-approximate-matrix-profiles-with-scrump-c6d9c984c560", "anchor_text": "Fast Approximate Matrix Profiles with STUMPY", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/matrix-profiles-for-streaming-time-series-data-f877ff6f9eef", "anchor_text": "Matrix Profiles for Streaming Time Series Data", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/part-7-fast-pattern-searching-with-stumpy-2baf610a8de1", "anchor_text": "Fast Pattern Searching with STUMPY", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/part-8-ab-joins-with-stumpy-af985e12e391", "anchor_text": "AB-Joins with STUMPY", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/time-series-consensus-motifs-8345152bd6ac", "anchor_text": "Time Series Consensus Motifs", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/part-10-discovering-multidimensional-time-series-motifs-45da53b594bb", "anchor_text": "Discovering Multidimensional Time Series Motifs", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/part-11-user-guided-motif-search-d3d317caf9ea", "anchor_text": "User-Guided Motif Search", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/part-12-matrix-profiles-for-machine-learning-2dfd98d7ff3f", "anchor_text": "Matrix Profiles for Machine Learning", "paragraph_index": 2}, {"url": "https://www.cs.ucr.edu/~eamonn/PID4481997_extend_Matrix%20Profile_I.pdf", "anchor_text": "Matrix Profile I", "paragraph_index": 3}, {"url": "https://stumpy.readthedocs.io/en/latest/Tutorial_STUMPY_Basics.html", "anchor_text": "time series motifs", "paragraph_index": 4}, {"url": "https://stumpy.readthedocs.io/en/latest/Tutorial_The_Matrix_Profile.html", "anchor_text": "matrix profile", "paragraph_index": 4}, {"url": "https://stumpy.readthedocs.io/en/latest/Tutorial_STUMPY_Basics.html", "anchor_text": "in the past", "paragraph_index": 16}, {"url": "https://www.cs.ucr.edu/~eamonn/PID4481997_extend_Matrix%20Profile_I.pdf", "anchor_text": "Matrix Profile I", "paragraph_index": 23}, {"url": "https://stumpy.readthedocs.io/en/latest/", "anchor_text": "STUMPY Matrix Profile Documentation", "paragraph_index": 23}, {"url": "https://github.com/TDAmeritrade/stumpy", "anchor_text": "STUMPY Matrix Profile Github Code Repository", "paragraph_index": 23}], "all_paragraphs": ["STUMPY is a powerful and scalable Python library for modern time series analysis and, at its core, efficiently computes something called a matrix profile. The goal of this multi-part series is to explain what the matrix profile is and how you can start leveraging STUMPY for all of your modern time series data mining tasks!", "Note: These tutorials were originally featured in the STUMPY documentation.", "Part 1: The Matrix ProfilePart 2: STUMPY BasicsPart 3: Time Series ChainsPart 4: Semantic SegmentationPart 5: Fast Approximate Matrix Profiles with STUMPYPart 6: Matrix Profiles for Streaming Time Series DataPart 7: Fast Pattern Searching with STUMPYPart 8: AB-Joins with STUMPYPart 9: Time Series Consensus MotifsPart 10: Discovering Multidimensional Time Series MotifsPart 11: User-Guided Motif SearchPart 12: Matrix Profiles for Machine Learning", "This tutorial is adapted from the Matrix Profile I paper and replicates Figures 9 and 10.", "Previously, we had introduced a concept called time series motifs, which are conserved patterns found within a single time series, \ud835\udc47, that can be discovered by computing its matrix profile using STUMPY. This process of computing a matrix profile with one time series is commonly known as a \u201cself-join\u201d since the subsequences within time series \ud835\udc47 are only being compared with itself. However, what do you do if you have two time series, \ud835\udc47\ud835\udc34 and \ud835\udc47\ud835\udc35, and you want to know if there are any subsequences in \ud835\udc47\ud835\udc34 that can also be found in \ud835\udc47\ud835\udc35? By extension, a motif discovery process involving two time series is often referred to as an \u201cAB-join\u201d since all of the subsequences within time series \ud835\udc47\ud835\udc34 are compared to all of the subsequences in \ud835\udc47\ud835\udc35.", "It turns out that \u201cself-joins\u201d can be trivially generalized to \u201cAB-joins\u201d and the resulting matrix profile, which annotates every subsequence in \ud835\udc47\ud835\udc34 with its nearest subsequence neighbor in \ud835\udc47\ud835\udc35, can be used to identify similar (or unique) subsequences across any two time series. Additionally, as long as \ud835\udc47\ud835\udc34 and \ud835\udc47\ud835\udc35 both have lengths that are greater than or equal to the subsequence length, \ud835\udc5a, there is no requirement that the two time series must be the same length.", "In this short tutorial we will demonstrate how to find a conserved pattern across two independent time series using STUMPY.", "Let\u2019s import the packages that we\u2019ll need to load, analyze, and plot the data.", "In this tutorial we are going to analyze two songs, \u201cUnder Pressure\u201d by Queen and David Bowie as well as \u201cIce Ice Baby\u201d by Vanilla Ice. For those who are unfamiliar, in 1990, Vanilla Ice was alleged to have sampled the bass line from \u201cUnder Pressure\u201d without crediting the original creators and the copyright claim was later settled out of court. Have a look at this short video and see if you can hear the similarities between the two songs:", "The two songs certainly share some similarities! But, before we move forward, imagine if you were the judge presiding over this court case. What analysis result would you need to see in order to be convinced, beyond a shadow of a doubt, that there was wrongdoing?", "To make things easier, instead of using the raw music audio from each song, we\u2019re only going to use audio that has been pre-converted to a single frequency channel (i.e., the 2nd MFCC channel sampled at 100Hz).", "It was very clear in the earlier video that there are strong similarities between the two songs. However, even with this prior knowledge, it\u2019s incredibly difficult to spot the similarities (below) due to the sheer volume of the data:", "Fortunately, using the stumpy.stump function, we can quickly compute the matrix profile by performing an AB-join and this will help us easily identify and locate the similar subsequence(s) between these two songs:", "Above, we call stumpy.stump by specifying our two time series T_A = queen_df['under_pressure'] and T_B = vanilla_ice_df['ice_ice_baby']. Following the original published work, we use a subsequence window length of m = 500 and, since this is not a self-join, we set ignore_trivial = False. The resulting matrix profile, queen_mp, essentially serves as an annotation for T_A so, for every subsequence in T_A, we find its closest subsequence in T_B.", "As a brief reminder of the matrix profile data structure, each row of queen_mp corresponds to each subsequence within T_A, the first column in queen_mp records the matrix profile value for each subsequence in T_A (i.e., the distance to its nearest neighbor in T_B), and the second column in queen_mp keeps track of the index location of the nearest neighbor subsequence in T_B.", "One additional side note is that AB-joins are not symmetrical in general. That is, unlike a self-join, the order of the input time series matter. So, an AB-join will produce a different matrix profile than a BA-join (i.e., for every subsequence in T_B, we find its closest subsequence in T_A).", "Just as we\u2019ve done in the past, we can now look at the matrix profile, queen_mp, computed from our AB-join:", "Now, to discover the global motif (i.e., the most conserved pattern), queen_motif_index, all we need to do is identify the index location of the lowest distance value in the queen_mp matrix profile (see red circle above).", "In fact, the index location of its nearest neighbor in \u201cIce Ice Baby\u201d is stored in queen_mp[queen_motif_index, 1]:", "After identifying the motif and retrieving the index location from each song, let\u2019s overlay both of these subsequences and see how similar they are to each other:", "Wow, the resulting overlay shows really strong correlation between the two subsequences! Are you convinced?", "And that\u2019s it! In just a few lines of code, you learned how to compute a matrix profile for two time series using STUMPY and identified the top-most conserved behavior between them. While this tutorial has focused on audio data, there are many further applications such as detecting imminent mechanical issues in sensor data by comparing to known experimental or historical failure datasets or finding matching movements in commodities or stock prices, just to name a few.", "You can now import this package and use it in your own projects. Happy coding!", "Matrix Profile ISTUMPY Matrix Profile DocumentationSTUMPY Matrix Profile Github Code Repository", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Principal Data Scientist at a Fortune 500 FinTech company. PyData Ann Arbor organizer. Creator of STUMPY for modern time series analysis. Twitter: @seanmylaw"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf985e12e391&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----af985e12e391--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af985e12e391--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://seanmylaw.medium.com/?source=post_page-----af985e12e391--------------------------------", "anchor_text": ""}, {"url": "https://seanmylaw.medium.com/?source=post_page-----af985e12e391--------------------------------", "anchor_text": "Sean Law"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9aa0e35e270e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&user=Sean+Law&userId=9aa0e35e270e&source=post_page-9aa0e35e270e----af985e12e391---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf985e12e391&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf985e12e391&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@anniespratt", "anchor_text": "Annie Spratt"}, {"url": "https://github.com/TDAmeritrade/stumpy", "anchor_text": "STUMPY is a powerful and scalable Python library for modern time series analysis"}, {"url": "https://stumpy.readthedocs.io/en/latest/", "anchor_text": "STUMPY"}, {"url": "https://stumpy.readthedocs.io/en/latest/tutorials.html", "anchor_text": "STUMPY documentation"}, {"url": "https://towardsdatascience.com/the-matrix-profile-e4a679269692", "anchor_text": "The Matrix Profile"}, {"url": "https://towardsdatascience.com/stumpy-basics-21844a2d2d92", "anchor_text": "STUMPY Basics"}, {"url": "https://towardsdatascience.com/part-3-time-series-chains-da281450abbf", "anchor_text": "Time Series Chains"}, {"url": "https://towardsdatascience.com/part-4-semantic-segmentation-b42c3792833d", "anchor_text": "Semantic Segmentation"}, {"url": "https://towardsdatascience.com/part-5-fast-approximate-matrix-profiles-with-scrump-c6d9c984c560", "anchor_text": "Fast Approximate Matrix Profiles with STUMPY"}, {"url": "https://towardsdatascience.com/matrix-profiles-for-streaming-time-series-data-f877ff6f9eef", "anchor_text": "Matrix Profiles for Streaming Time Series Data"}, {"url": "https://towardsdatascience.com/part-7-fast-pattern-searching-with-stumpy-2baf610a8de1", "anchor_text": "Fast Pattern Searching with STUMPY"}, {"url": "https://towardsdatascience.com/part-8-ab-joins-with-stumpy-af985e12e391", "anchor_text": "AB-Joins with STUMPY"}, {"url": "https://towardsdatascience.com/time-series-consensus-motifs-8345152bd6ac", "anchor_text": "Time Series Consensus Motifs"}, {"url": "https://towardsdatascience.com/part-10-discovering-multidimensional-time-series-motifs-45da53b594bb", "anchor_text": "Discovering Multidimensional Time Series Motifs"}, {"url": "https://towardsdatascience.com/part-11-user-guided-motif-search-d3d317caf9ea", "anchor_text": "User-Guided Motif Search"}, {"url": "https://towardsdatascience.com/part-12-matrix-profiles-for-machine-learning-2dfd98d7ff3f", "anchor_text": "Matrix Profiles for Machine Learning"}, {"url": "https://www.cs.ucr.edu/~eamonn/PID4481997_extend_Matrix%20Profile_I.pdf", "anchor_text": "Matrix Profile I"}, {"url": "https://stumpy.readthedocs.io/en/latest/Tutorial_STUMPY_Basics.html", "anchor_text": "time series motifs"}, {"url": "https://stumpy.readthedocs.io/en/latest/Tutorial_The_Matrix_Profile.html", "anchor_text": "matrix profile"}, {"url": "https://stumpy.readthedocs.io/en/latest/Tutorial_STUMPY_Basics.html", "anchor_text": "in the past"}, {"url": "https://www.cs.ucr.edu/~eamonn/PID4481997_extend_Matrix%20Profile_I.pdf", "anchor_text": "Matrix Profile I"}, {"url": "https://stumpy.readthedocs.io/en/latest/", "anchor_text": "STUMPY Matrix Profile Documentation"}, {"url": "https://github.com/TDAmeritrade/stumpy", "anchor_text": "STUMPY Matrix Profile Github Code Repository"}, {"url": "https://towardsdatascience.com/part-7-fast-pattern-searching-with-stumpy-2baf610a8de1", "anchor_text": "Part 7: Fast Pattern Searching with STUMPY"}, {"url": "https://towardsdatascience.com/time-series-consensus-motifs-8345152bd6ac", "anchor_text": "Part 9: Time Series Consensus Motifs"}, {"url": "https://medium.com/tag/stumpy?source=post_page-----af985e12e391---------------stumpy-----------------", "anchor_text": "Stumpy"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----af985e12e391---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/matrix-profile?source=post_page-----af985e12e391---------------matrix_profile-----------------", "anchor_text": "Matrix Profile"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----af985e12e391---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/python?source=post_page-----af985e12e391---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf985e12e391&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&user=Sean+Law&userId=9aa0e35e270e&source=-----af985e12e391---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf985e12e391&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&user=Sean+Law&userId=9aa0e35e270e&source=-----af985e12e391---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf985e12e391&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af985e12e391--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faf985e12e391&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----af985e12e391---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----af985e12e391--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----af985e12e391--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----af985e12e391--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----af985e12e391--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----af985e12e391--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----af985e12e391--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----af985e12e391--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----af985e12e391--------------------------------", "anchor_text": ""}, {"url": "https://seanmylaw.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://seanmylaw.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sean Law"}, {"url": "https://seanmylaw.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "266 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9aa0e35e270e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&user=Sean+Law&userId=9aa0e35e270e&source=post_page-9aa0e35e270e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb8e4f4c073ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-8-ab-joins-with-stumpy-af985e12e391&newsletterV3=9aa0e35e270e&newsletterV3Id=b8e4f4c073ee&user=Sean+Law&userId=9aa0e35e270e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}