{"url": "https://towardsdatascience.com/ball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7", "time": 1683013017.7529652, "path": "towardsdatascience.com/ball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7/", "webpage": {"metadata": {"title": "Ball tracking in volleyball with OpenCV and Tensorflow | by Constantin Toporov | Towards Data Science", "h1": "Ball tracking in volleyball with OpenCV and Tensorflow", "description": "After the first experience of applying AI in sport, I was inspired to continue. Home exercises are looked like an insignificant goal and I targeted team plays. I am a big fan of playing volleyball\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/squats-detector-with-opencv-and-tensorflow-ce934f19aeb9", "anchor_text": "first experience of applying AI in sport", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/dogs-vs-cats", "anchor_text": "Cats-vs-Dogs challenge", "paragraph_index": 13}, {"url": "https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html", "anchor_text": "VGG neural network", "paragraph_index": 14}, {"url": "https://files.icg.tugraz.at/f/d5668bbb4a/?raw=1", "anchor_text": "Improved Sport Activity Recognition using Spatio-temporal Context", "paragraph_index": 25}, {"url": "https://files.icg.tugraz.at/f/43f43cbc00/?raw=1", "anchor_text": "Indoor Activity Detection and Recognition for Automated Sport Games Analysis", "paragraph_index": 26}], "all_paragraphs": ["After the first experience of applying AI in sport, I was inspired to continue. Home exercises are looked like an insignificant goal and I targeted team plays.", "AI in sports is a pretty new thing. There are a few interesting works:", "I am a big fan of playing volleyball, so let\u2019s talk about the last reference. This a site of one Austrian institute who analyzes games of a local amateur league. There are some documents to read and even more important \u2014 open video dataset.", "Volleyball is a complex game with many different aspects. So I started with a small but very important piece \u2014 the ball.", "Ball tracking is a pretty famous task. Google gives a lot of links but many of them are just a demo. Obviously, recognize and track a big ball of distinguished color in front of a camera cannot be compared with real game ball detection, where the ball is tiny, moving fast and blended into the background.", "And finally, we want to get something like that:", "Before start let\u2019s notice some detail about the video dataset:", "So far most obvious approach \u2014 with colors \u2014 does not work, I used a fact the ball is moving.Then let\u2019s find moving objects and pick the ball, sounds easy.", "OpenCV contains tools to detect moving object with background removal:", "In this example, the ball is on top and human brain and eye can easily detect it. How did we decide? Some rules could be deduced from the picture:", "The second rule does not work well. In this picture, for example, the highest blob is the referee\u2019s shoulder.", "But highest-blob approach gives an initial data for further steps.", "We can collect these blobs and train a classifier to distinguish the ball.", "In terms of AI \u2014 it is a binary classification of color images, very similar to Cats-vs-Dogs challenge.", "There are many ways to implement, but the most popular approach is with VGG neural network.", "A problem \u2014 ball pictures are very small and multiple convolution layers do not fit there. So I had to cut VGG to a very simple architecture:", "The model is simple and produces mediocre results: about 20% of false-positives and about 30% of false-negatives.That is better than nothing but, of course, not enough.", "The model applied to the game generates many false balls:", "There are actually two kinds of false balls:", "As the next step, there is an idea, the ball does not move randomly, but follows parabolic or linear trajectories.", "Validation of blob movements on this geometry will cut off random and consistent mistakes.", "There is an example of recorded trajectories during one ball play:", "Where directed paths are in blue, static \u2014 in green, and random are grey.", "Only blue trajectories are interesting. They consist of at least 3 points and have a direction. The direction is very important because the next point could be forecasted in case if it is missed in the real stream and no new paths detected.", "This logic applied to the clip generates a pretty realistic tracking:", "Improved Sport Activity Recognition using Spatio-temporal ContextGeorg Waltner, Thomas Mauthner and Horst BischofIn Proc. DVS-Conference on Computer Science in Sport (DVS/GSSS), 2014", "Indoor Activity Detection and Recognition for Automated Sport Games AnalysisGeorg Waltner, Thomas Mauthner and Horst BischofIn Proc. Workshop of the Austrian Association for Pattern Recognition (AAPR/OAGM), 2014", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Working on artificial intelligence and computer vision applied to sports."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3d6e857bd2e7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://const-toporov.medium.com/?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": ""}, {"url": "https://const-toporov.medium.com/?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": "Constantin Toporov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F95bd3440818b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&user=Constantin+Toporov&userId=95bd3440818b&source=post_page-95bd3440818b----3d6e857bd2e7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d6e857bd2e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d6e857bd2e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/squats-detector-with-opencv-and-tensorflow-ce934f19aeb9", "anchor_text": "first experience of applying AI in sport"}, {"url": "https://dev.to/stephan007/open-source-sports-video-analysis-using-maching-learning-2ag4", "anchor_text": "Basketball"}, {"url": "https://www.researchgate.net/publication/329740964_Convolutional_Neural_Networks_Based_Ball_Detection_in_Tennis_Games", "anchor_text": "Tennis"}, {"url": "https://www.tugraz.at/institute/icg/research/team-bischof/lrs/downloads/vb14/", "anchor_text": "Volleyball"}, {"url": "https://www.kaggle.com/c/dogs-vs-cats", "anchor_text": "Cats-vs-Dogs challenge"}, {"url": "https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html", "anchor_text": "VGG neural network"}, {"url": "https://github.com/tprlab/vball", "anchor_text": "Github repo"}, {"url": "https://www.tugraz.at/institute/icg/research/team-bischof/lrs/downloads/vb14/", "anchor_text": "Video source"}, {"url": "https://files.icg.tugraz.at/f/d5668bbb4a/?raw=1", "anchor_text": "Improved Sport Activity Recognition using Spatio-temporal Context"}, {"url": "https://files.icg.tugraz.at/f/43f43cbc00/?raw=1", "anchor_text": "Indoor Activity Detection and Recognition for Automated Sport Games Analysis"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----3d6e857bd2e7---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----3d6e857bd2e7---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/python?source=post_page-----3d6e857bd2e7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3d6e857bd2e7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3d6e857bd2e7---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3d6e857bd2e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&user=Constantin+Toporov&userId=95bd3440818b&source=-----3d6e857bd2e7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3d6e857bd2e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&user=Constantin+Toporov&userId=95bd3440818b&source=-----3d6e857bd2e7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d6e857bd2e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3d6e857bd2e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3d6e857bd2e7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3d6e857bd2e7--------------------------------", "anchor_text": ""}, {"url": "https://const-toporov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://const-toporov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Constantin Toporov"}, {"url": "https://const-toporov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "219 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F95bd3440818b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&user=Constantin+Toporov&userId=95bd3440818b&source=post_page-95bd3440818b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb4440225bd41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7&newsletterV3=95bd3440818b&newsletterV3Id=b4440225bd41&user=Constantin+Toporov&userId=95bd3440818b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}