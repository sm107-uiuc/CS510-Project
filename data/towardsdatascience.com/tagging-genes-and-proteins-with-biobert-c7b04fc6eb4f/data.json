{"url": "https://towardsdatascience.com/tagging-genes-and-proteins-with-biobert-c7b04fc6eb4f", "time": 1683013145.42367, "path": "towardsdatascience.com/tagging-genes-and-proteins-with-biobert-c7b04fc6eb4f/", "webpage": {"metadata": {"title": "Tagging Genes and Proteins with BioBERT | by Drew Perkins | Towards Data Science", "h1": "Tagging Genes and Proteins with BioBERT", "description": "Text mining in the clinical domain has become increasingly important with the number of biomedical documents currently out there with valuable information waiting to be deciphered and optimized by\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/perkdrew/advanced-nlp/tree/master/BioBERT", "anchor_text": "GitHub", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "BERT", "paragraph_index": 1}, {"url": "https://medium.com/dissecting-bert", "anchor_text": "blogs", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1901.08746", "anchor_text": "BioBERT", "paragraph_index": 2}, {"url": "https://link.springer.com/referenceworkentry/10.1007%2F978-1-4419-9863-7_138", "anchor_text": "BioNLP09 Corpus", "paragraph_index": 5}, {"url": "http://2011.bionlp-st.org/home", "anchor_text": "BioNLP11 Corpus", "paragraph_index": 5}, {"url": "http://2013.bionlp-st.org/", "anchor_text": "BioNLP13 Corpus", "paragraph_index": 5}, {"url": "https://github.com/dmis-lab/biobert", "anchor_text": "GitHub", "paragraph_index": 6}, {"url": "https://huggingface.co/transformers/", "anchor_text": "HuggingFace API", "paragraph_index": 6}, {"url": "https://colab.research.google.com/drive/18g_Z6tufHi_TPdVNO45KBcLRSr_k-mUQ?usp=sharing", "anchor_text": "notebook", "paragraph_index": 7}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC17719/", "anchor_text": "abstract", "paragraph_index": 21}, {"url": "https://www.youtube.com/channel/UCoRX98PLOsaN8PtekB9kWrw", "anchor_text": "ChrisMcCormickAI", "paragraph_index": 23}, {"url": "https://github.com/practical-nlp", "anchor_text": "Practical Natural Language Processing", "paragraph_index": 23}], "all_paragraphs": ["Text mining in the clinical domain has become increasingly important with the number of biomedical documents currently out there with valuable information waiting to be deciphered and optimized by NLP techniques. With the accelerated progress in NLP, pre-trained language models now carry millions (or even billions) of parameters and can leverage massive amounts of textual knowledge for downstream tasks such as question answering, natural language inference, and in the case that we will work through, biomedical text tagging via named-entity recognition. All of the code can be found on my GitHub.", "As a state-of-the-art breakthrough in NLP, Google researchers developed a language model known as BERT (Devlin et. al, 2018) that was developed to learn deep representations by jointly conditioning on a bidirectional context of the text in all layers of its architecture\u00b9. These representations are valuable for sequential data, such as text, that heavily relies on context and the advent of transfer learning in this field helps carry the encoded knowledge over to strengthen an individual\u2019s smaller tasks across domains. In transfer learning, we call this step \u201cfine-tuning\u201d, which means that the pre-trained model is now being fine-tuned for the particular task we have in mind. The original English-language model used two corpora in their pre-training: Wikipedia and BooksCorpus. For a deeper intuition behind transformers like BERT, I would suggest a series of blogs on their architecture and fine-tuned tasks.", "BioBERT (Lee et al., 2019) is a variation of the aforementioned model from Korea University and Clova AI. Researchers added to the corpora of the original BERT with PubMed and PMC. PubMed is a database of biomedical citations and abstractions, whereas PMC is an electronic archive of full-text journal articles. Their contributions were a biomedical language representation model that could manage tasks such as relation extraction and drug discovery to name a few. By having a pre-trained model that encompasses both general and biomedical domain corpora, developers and practitioners could now encapsulate biomedical terms that would have been incredibly difficult for a general language model to comprehend.", "Text is broken down in BERT and BioBERT is through a WordPiece tokenizer, which splits words into frequent subwords, such that Immunoglobulin will be tokenized into constituent pieces of I ##mm ##uno ##g ##lo ##bul ##in\u00b2. These word pieces can utilize the flexibility of characters as well as the general word meanings through character combinations. The fine-tuned tasks that achieved state-of-the-art results with BioBERT include named-entity recognition, relation extraction, and question-answering. Here we will look at the first task and what exactly is being accomplished.", "Named-entity recognition (NER) is the recognition process of numerous proper nouns (or given target phrases) that we establish as entity types to be labeled. The datasets used to evaluate NER are structured in the BIO (Beginning, Inside, Outside) schema, the most common tagging format for sentence tokens within this task. Additionally, an \u201cS\u201d like in \u201cS-Protein\u201d can be used to infer a single token. That way we can note the positional prefix and entity type that is being predicted from the training data.", "The dataset used in this example is a combination of the BioNLP09 Corpus, BioNLP11 Corpus, and BioNLP13 Corpus. Although we focus on genes and proteins, there are other entity types such as diseases, chemicals, and drugs. There are 74 tags included in these experiments, but for the sake of brevity, here is a peek at the BioNLP13 Corpus tags in the BIO schema:", "First, we will want to import BioBERT from the original GitHub and transfer the files to our Colab notebook. Here we are downloading the main BioBERT file, extracting the BioBERT weights, and converting them to be applicable in PyTorch so as to work with the HuggingFace API. We move the config file for simplicity, and now are good to go!", "You will need the transformers libraries from HuggingFace. For the full list of installs and imports, consult my notebook. We set the maximum length of text and batch size as constraints we will be working with later. We will also create a device that utilizes GPUs for computation in Colab. The BertTokenizer class will take in the vocab.txt from the BioBERT file we\u2019ve previously set up.", "The SentenceFetch class will take in our data, read the TSV files that the BIO schema text comes in, and organize the sentences and tags into workable data structures. We then have methods to retrieve the sentences and tags.", "We search through all the subdirectories of our root directory. In Colab, I would suggest uploading your data from either Google Drive or your local drive. We use the SentenceFetch class and create a list of sentences and tags to use in our experiments.", "We create a helper function to tokenize the text without losing the labels to each token. We need those labels intact for our model.", "Now we can get our input data normalized via \u201cpad_sequences\u201d in Keras. This is used to keep the fixed-length consistent with sequences that are shorter than our maximum length.", "Now we can finalize the data preparation for our modeling. Attention masks are used when batching sequences together to indicate which tokens should be observed. We split our inputs and masks between training and validation data. Then we convert our data as tensors to work properly with PyTorch. Afterward, we pass these tensors through the data utils in PyTorch and finally have the data ready for our model.", "In the modeling stage, we use the BertConfig class to use the configuration file for the model. We also use the pre-trained weights to help establish our \u201cstate_dict\u201d. The \u201cstate_dict\u201d is a dictionary that maps each layer to its parameter tensor, which heavily increases modularity to our models and optimizers in PyTorch.", "We create a simple BioBERT class for the NER model. Our attributes are the layers in our network along with a forward pass method.", "With our primary model created, we set up the optimization and learning rate scheduler. We also set other hyperparameters here.", "A function was created that manages epoch training. Here we notify the layers that we are in train mode so batch norm and dropout layers work in training mode rather than in eval mode, which is required in PyTorch. Gradients are computed and model weights are updated.", "A second function was created to evaluate our model. As one could guess, we know need to inform layers that we are in eval mode. We also deactivate the autograd engine to reduce memory usage and speed up computations. In the future, it would be more concise to consolidate these two functions as methods in the BioBERT model class.", "Here we will loop through our epochs, use our two functions, and print the results for both the training and validation loss/accuracy.", "Our results show high accuracy of 96% for training accuracy and 95% for validation accuracy. Given the time it takes (although here the model ran incredibly fast with the available GPU!), there is no reason to increase epochs.", "When we consider loss, the learning curve expresses a reasonable loss over the three epochs:", "Here we can now tag a random sentence from a biomedical paper abstract:", "We see that it has properly tagged singular/solo protein mentions. However, given the abundance of \u201c0\u201d denoting irrelevant words to the task at hand, there were results that overfit tagging to \u201c0\u201d because of the sheer number of examples in the training data. This tag imbalance would be an integral area to improve upon in the future.", "We got a general sense of how BioBERT operates and how it expands on the work of BERT. By leveraging BioBERT, we sought to properly tag biomedical text through the NER task. I walked us through my implementation of BioBERT that imported the necessary files, preprocessed the data, and finally, constructed, trained, and tested the model. For a deeper breakdown of BERT in Colab, I would highly recommend the tutorials of ChrisMcCormickAI. There is also some valuable information in Chapter 10 of Practical Natural Language Processing pertaining directly to NLP tools and applications (including BioBERT!) in the healthcare industry. I hope this was helpful in guiding you through a state-of-the-art model in the biomedical domain.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer | Optimistic Nihilist"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc7b04fc6eb4f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@drewperk?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@drewperk?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": "Drew Perkins"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe67c23662228&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&user=Drew+Perkins&userId=e67c23662228&source=post_page-e67c23662228----c7b04fc6eb4f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7b04fc6eb4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7b04fc6eb4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@anikolleshi?utm_source=medium&utm_medium=referral", "anchor_text": "Ani Kolleshi"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/perkdrew/advanced-nlp/tree/master/BioBERT", "anchor_text": "GitHub"}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "BERT"}, {"url": "https://medium.com/dissecting-bert", "anchor_text": "blogs"}, {"url": "https://arxiv.org/abs/1901.08746", "anchor_text": "BioBERT"}, {"url": "https://link.springer.com/referenceworkentry/10.1007%2F978-1-4419-9863-7_138", "anchor_text": "BioNLP09 Corpus"}, {"url": "http://2011.bionlp-st.org/home", "anchor_text": "BioNLP11 Corpus"}, {"url": "http://2013.bionlp-st.org/", "anchor_text": "BioNLP13 Corpus"}, {"url": "https://github.com/dmis-lab/biobert", "anchor_text": "GitHub"}, {"url": "https://huggingface.co/transformers/", "anchor_text": "HuggingFace API"}, {"url": "https://colab.research.google.com/drive/18g_Z6tufHi_TPdVNO45KBcLRSr_k-mUQ?usp=sharing", "anchor_text": "notebook"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC17719/", "anchor_text": "abstract"}, {"url": "https://www.youtube.com/channel/UCoRX98PLOsaN8PtekB9kWrw", "anchor_text": "ChrisMcCormickAI"}, {"url": "https://github.com/practical-nlp", "anchor_text": "Practical Natural Language Processing"}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "https://arxiv.org/abs/1901.08746"}, {"url": "https://arxiv.org/abs/1901.08746", "anchor_text": "https://arxiv.org/abs/1901.08746"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c7b04fc6eb4f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c7b04fc6eb4f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c7b04fc6eb4f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/language?source=post_page-----c7b04fc6eb4f---------------language-----------------", "anchor_text": "Language"}, {"url": "https://medium.com/tag/medicine?source=post_page-----c7b04fc6eb4f---------------medicine-----------------", "anchor_text": "Medicine"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7b04fc6eb4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&user=Drew+Perkins&userId=e67c23662228&source=-----c7b04fc6eb4f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7b04fc6eb4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&user=Drew+Perkins&userId=e67c23662228&source=-----c7b04fc6eb4f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7b04fc6eb4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc7b04fc6eb4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c7b04fc6eb4f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c7b04fc6eb4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@drewperk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@drewperk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Drew Perkins"}, {"url": "https://medium.com/@drewperk/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "14 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe67c23662228&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&user=Drew+Perkins&userId=e67c23662228&source=post_page-e67c23662228--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F886f3f4b9083&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftagging-genes-and-proteins-with-biobert-c7b04fc6eb4f&newsletterV3=e67c23662228&newsletterV3Id=886f3f4b9083&user=Drew+Perkins&userId=e67c23662228&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}