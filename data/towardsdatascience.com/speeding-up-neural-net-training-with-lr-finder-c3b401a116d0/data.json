{"url": "https://towardsdatascience.com/speeding-up-neural-net-training-with-lr-finder-c3b401a116d0", "time": 1682997297.703719, "path": "towardsdatascience.com/speeding-up-neural-net-training-with-lr-finder-c3b401a116d0/", "webpage": {"metadata": {"title": "Speeding up Neural Net Training with LR-Finder | by Faizan Ahemad | Towards Data Science", "h1": "Speeding up Neural Net Training with LR-Finder", "description": "While training a Deep Neural Network selecting a good learning rate is essential for both fast convergence and a lower error. We also have to select a optimiser which decides how weight updates are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/faizanahemad/data-science-utils/blob/master/data_science_utils/vision/keras/lr_finder.py", "anchor_text": "our implementation", "paragraph_index": 5}, {"url": "https://colab.research.google.com/drive/1snEPXi418CrctkDP240KdEkff1z83buV", "anchor_text": "this Google Colab Notebook", "paragraph_index": 11}, {"url": "https://colab.research.google.com/drive/1snEPXi418CrctkDP240KdEkff1z83buV", "anchor_text": "LR Scheduling in the example notebook", "paragraph_index": 17}, {"url": "https://colab.research.google.com/drive/1snEPXi418CrctkDP240KdEkff1z83buV", "anchor_text": "example notebook", "paragraph_index": 20}, {"url": "https://github.com/faizanahemad/data-science-utils/blob/master/data_science_utils/vision/keras/lr_finder.py", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://github.com/faizanahemad/data-science-utils/blob/master/data_science_utils/vision/keras/GradCam_with_misclassified_LRFinder.ipynb", "anchor_text": "Notebook/Github", "paragraph_index": 21}], "all_paragraphs": ["While training a Deep Neural Network selecting a good learning rate is essential for both fast convergence and a lower error. We also have to select a optimiser which decides how weight updates are done in a DNN.", "There are various optimisers available like Adam, SGD+momentum, Adagrad, RMSprop, AdaDelta, AdaBound. Of these Adam and SGD+momentum are most popular. While training a Fully Connected DNN or a Convolutional network most State of the Art networks use SGD+momentum. This is due to the fact that it generalises better to unseen data and gives better validation/test scores.", "There are two tiny problems with SGD though, SGD is slow to converge compared to Adam and SGD requires learning rate tuning. Surprisingly the solution to both problems is using a good starting learning rate. In case your LR is too high, your errors will never reduce and training will not converge. Too low LR and you have to wait too long for training to converge. So we start with a good LR given by LR-Finder, then decay it a little as we reach the end.", "Basic objective of a LR Finder is to find the highest LR which still minimises the loss and does not make the loss explode/diverge. We do this by training a model while increasing the LR after each batch, we record the loss and finally we use the LR just before loss exploded. We do this for 1 epoch.", "You will get a plot which looks like below", "We plot the points with a arrow to indicate location in our implementation", "From this plot we find the point after which loss starts increasing too much.", "I have written a small library which contains the LR Finder. This is for Keras. For pytorch fast.ai implementation works.To install:", "Next in your notebook (For Cifar 10)", "First Define Imports and Data generators for our Data set.", "Next We build our model and use LR Finder on it.", "The above 2 plots you saw were generated using this. You can see the example in this Google Colab Notebook.", "We can use LR scheduling or LR decay to reduce LR in later epochs since we started with high LR initially.", "We used SGD directly with a learning_rate of 0.01 and nesterov\u2019s momentum. We trained the network on CIFAR-10 for 100 epochs. Our network has 450K params.", "As you can notice it took about 60 epochs for validation error to converge and it is 86.7% accuracy.", "We use the LR provided by LR finder. Everything else is same.", "You can see that here we get 86.4% accuracy but training converges in 40 epochs instead of 60. Using LR given by LR finder along with EarlyStopping can reduce compute time massively.", "We use LR scheduling from keras to decrease LR in each epoch. Basically after each epoch we decrease LR by multiplying with 0.97. You can see the section LR Scheduling in the example notebook", "Notice that we get 88.4% with same network and LR. Also notice that towards the end the loss and accuracy graphs are no longer fluctuating as before.", "So we have gotten over 1% accuracy increase just by using LR finder with LR scheduling using the same 100 epochs we started with.", "Using LR Finder is shown to be beneficial for both faster training and increasing accuracy. We also show how to use LR finder using an example notebook. The code of LR Finder is here.", "In case you found this useful, do visit my Notebook/Github for full code.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc3b401a116d0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@faizanahemad?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@faizanahemad?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": "Faizan Ahemad"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6dc8fde8964b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&user=Faizan+Ahemad&userId=6dc8fde8964b&source=post_page-6dc8fde8964b----c3b401a116d0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3b401a116d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3b401a116d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/faizanahemad/data-science-utils/blob/master/data_science_utils/vision/keras/lr_finder.py", "anchor_text": "our implementation"}, {"url": "https://github.com/faizanahemad/data-science-utils/tarball/master", "anchor_text": "https://github.com/faizanahemad/data-science-utils/tarball/master"}, {"url": "https://colab.research.google.com/drive/1snEPXi418CrctkDP240KdEkff1z83buV", "anchor_text": "this Google Colab Notebook"}, {"url": "https://colab.research.google.com/drive/1snEPXi418CrctkDP240KdEkff1z83buV", "anchor_text": "LR Scheduling in the example notebook"}, {"url": "https://colab.research.google.com/drive/1snEPXi418CrctkDP240KdEkff1z83buV", "anchor_text": "example notebook"}, {"url": "https://github.com/faizanahemad/data-science-utils/blob/master/data_science_utils/vision/keras/lr_finder.py", "anchor_text": "here"}, {"url": "https://github.com/faizanahemad/data-science-utils/blob/master/data_science_utils/vision/keras/GradCam_with_misclassified_LRFinder.ipynb", "anchor_text": "Notebook/Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c3b401a116d0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c3b401a116d0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c3b401a116d0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----c3b401a116d0---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----c3b401a116d0---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3b401a116d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&user=Faizan+Ahemad&userId=6dc8fde8964b&source=-----c3b401a116d0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3b401a116d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&user=Faizan+Ahemad&userId=6dc8fde8964b&source=-----c3b401a116d0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3b401a116d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc3b401a116d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c3b401a116d0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c3b401a116d0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c3b401a116d0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c3b401a116d0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c3b401a116d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@faizanahemad?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@faizanahemad?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Faizan Ahemad"}, {"url": "https://medium.com/@faizanahemad/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "644 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6dc8fde8964b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&user=Faizan+Ahemad&userId=6dc8fde8964b&source=post_page-6dc8fde8964b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8eaefc5b0ffc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspeeding-up-neural-net-training-with-lr-finder-c3b401a116d0&newsletterV3=6dc8fde8964b&newsletterV3Id=8eaefc5b0ffc&user=Faizan+Ahemad&userId=6dc8fde8964b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}