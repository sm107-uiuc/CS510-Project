{"url": "https://towardsdatascience.com/feature-selection-you-are-probably-doing-it-wrong-985679b41456", "time": 1683005573.090383, "path": "towardsdatascience.com/feature-selection-you-are-probably-doing-it-wrong-985679b41456/", "webpage": {"metadata": {"title": "Feature Selection? You Are Probably Doing It Wrong | by Samuele Mazzanti | Towards Data Science", "h1": "Feature Selection? You Are Probably Doing It Wrong", "description": "I bet that, out there, 99% of feature-selection is carried out in a \u201cSelectFromModel\u201d mode (name coming from Scikit-learn\u2019s SelectFromModel), which works like this: In this post, I\u2019m going to test if\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFromModel.html", "anchor_text": "SelectFromModel", "paragraph_index": 0}, {"url": "https://www.jstatsoft.org/article/view/v036i11", "anchor_text": "this", "paragraph_index": 27}, {"url": "https://github.com/scikit-learn-contrib/boruta_py", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://towardsdatascience.com/boruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a", "anchor_text": "Boruta explained exactly how you wished someone explained to you", "paragraph_index": 36}, {"url": "https://www.linkedin.com/in/samuelemazzanti/", "anchor_text": "my Linkedin contact", "paragraph_index": 37}], "all_paragraphs": ["I bet that, out there, 99% of feature-selection is carried out in a \u201cSelectFromModel\u201d mode (name coming from Scikit-learn\u2019s SelectFromModel), which works like this:", "It seems a reasonable way to proceed, right? The answer may surprise you.", "In this post, I\u2019m going to test if this procedure actually works as expected. In the end, I will present a brilliant \u2014 but still largely unknown \u2014 Python package for feature selection which happens to outperform all the other algorithms tested.", "In this post, we will be using simulated data.", "I know data scientists turn up their nose in front of simulated data, but it\u2019s an effective way to test out things. In data science, it\u2019s the only case in which we can actually get to know the truth.", "How will our simulated dataset look like? We want to generate some independent features: some of them will be related to the target variable (called y), while the other features will just be noise. The aim is to find a feature selection method able to determine which features belong to the first group and which to the second group.", "Say our feature-matrix is made up of 16 independent features and we name them as follows:", "As you may have guessed from their names, the first 6 features have some kind of relationship with y, while the last 10 are just noise.", "The functional form of y should be complex enough to include some non-trivial effects existing in nature between variables. In particular, we want to account for the following types of relationships:", "Moreover, the relation between X and y should be non-deterministic, so an error factor, called \u03b5, is added. To account for all of this, I came up with the following function:", "which translates into the following Python code:", "Finally, we can generate X and y, and then split them in a training and a test set.", "Now that we have the data, it\u2019s time to pick some predictive models and try them in \u201cSelectFromModel\u201d mode. Let\u2019s take 8 models:", "There\u2019s a good chance you\u2019ve heard all of them, but the last one. You probably scratched your head and asked \u201cWhat the heck is the UnbeatableRegressor?\u201d. Well, since our data has been simulated with a function that we do know, we have access to the Holy Grail of every data scientist: the perfect model. It is the functional form of y and \u2014 needless to say \u2014 it cannot be beat.", "In order to obtain a scikit-compatible regressor, we just need to wrap our function in a class:", "Now, let\u2019s fit how our models on training data and see how they perform in terms of mean absolute error.", "So far, no wonder: cooler algorithms such as XGBoost or LightGBM perform better than the others (even if they are still pretty far from the theoretical minimum).", "Now, let\u2019s focus on feature importance, which is the core of the \u201cSelectFromModel\u201d mode.", "Feature importance is a rather elusive concept in machine learning, meaning that there is not an univocal way of computing it. Anyway, the idea is pretty intuitive: it is a way of quantifying the contribution brought by any single feature to the accuracy of a predictive model.", "A feature that is worth 0% does not affect the model\u2019s accuracy in any way (so it can be dropped). A feature that is worth 100% is the only feature affecting the predictions. In practical applications, features are never 0% or 100% important, they are always in between.", "However, since we have only 16 features and the last 10 of them (from noise_1 to noise_10) have no relation whatsoever with y, we would expect these to be 0% important and the remaining 6 features (linear, nonlinear_square, nonlinear_sin, interaction_1, interaction_2 and interaction_3) to share all the importance among them.", "But let\u2019s be a bit more conservative than that: let\u2019s take a safety buffer of 1%: we will drop any feature whose importance is below 1%. This threshold is rather arbitrary but, considering that we are dealing with only 16 features, it seems reasonable to believe that features below 1% importance are actually unuseful.", "In the next figure, the feature importances of all the 8 models are shown. Moreover, features that are below 1% importance are marked with a \u201c[DROP]\u201d next to their name.", "Surprisingly enough, one of the worst models \u2014 KNeighborsRegressor\u2014 is the only one that correctly guessed all the relevant features (however, it should be noted that nonlinear_sin is kept by a hair, since its importance is 1.17%: a slightly different threshold would have changed things).", "The model which got closer to the \u201cactual\u201d shape of feature importance \u2014 provided by UnbeatableRegressor \u2014 is LGBMRegressor, however, many noisy features are overrated, in the sense that they are above 1%.", "You might be surprised by the fact that better model in terms of performance are not necessarily better models in terms of feature selection: having an excellent model does not guarantee a succesful feature selection. Additionally, this way of proceeding is severely affected by the choice of the importance threshold: a different threshold would have given a completely different outcome.", "For these reasons, I started looking for an alternative. Until I stumbled in Boruta.", "Boruta is an algorithm for feature selection dating back to 2010. It was born as a package for R (this is the original article by Miron Kursa and Witold Rudnickii) and was adapted for Python by Daniel Homola: you can find the relevant project here.", "The intuition behind Boruta is really smart and deserves to be explained in a dedicated article. In this post, we will limit ourselves to use the Boruta library for Python, which can be installed through pip install Boruta.", "Boruta is a wrapper. The suggestion is to wrap a random forest with max_depth = 5. Not having to think about parameter tuning is a great benefit indeed.", "You are probably asking yourself: \u201cWhy are we using the RandomForestRegressor? In the previous experiment, it was one of the worst performing model\u201d. Well, this is precisely the beauty of Boruta: despite being a wrapper for a weak model such as a random forest, it is designed so as to overcome its shortcomings.", "The output of Boruta is a feature ranking which makes it possible to subdivide the features into 3 categories:", "It is possible to plot the ranking and visualize the 3 areas:", "Boruta did an amazing job: it has separated the 6 meaningful features from the remaing 10 noisy features, just as we expected.", "In this article, we have used simulated data to prove that even sophisticated models such as Xgboost or LightGBM may not be a good choice when it comes to feature selection.", "As an alternative, we have proposed a pretty unknown yet powerful Python package named Boruta, which has delivered the desired result.", "If you are interested in the functioning of Boruta (I believe that understanding algorithms is the only way to use them effectively), you can read the article that I wrote on the subject: \u201cBoruta explained exactly how you wished someone explained to you\u201d.", "Thank you for reading! I hope this post has been useful. I appreciate feedback and constructive criticism. If you want to talk about this article or other related topics, you can text me here or at my Linkedin contact.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Data Scientist | Striving for simplicity."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F985679b41456&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----985679b41456--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----985679b41456--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----985679b41456--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----985679b41456--------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03----985679b41456---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F985679b41456&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F985679b41456&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.shutterstock.com/image-photo/female-hand-picking-red-cherry-isolated-533345503", "anchor_text": "Shutterstock"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFromModel.html", "anchor_text": "SelectFromModel"}, {"url": "https://www.jstatsoft.org/article/view/v036i11", "anchor_text": "this"}, {"url": "https://github.com/scikit-learn-contrib/boruta_py", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/boruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a", "anchor_text": "Boruta explained exactly how you wished someone explained to you"}, {"url": "https://github.com/smazzanti/tds_feature_selection_you_are_probably_doing_it_wrong", "anchor_text": "https://github.com/smazzanti/tds_feature_selection_you_are_probably_doing_it_wrong"}, {"url": "https://www.linkedin.com/in/samuelemazzanti/", "anchor_text": "my Linkedin contact"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----985679b41456---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/feature-selection?source=post_page-----985679b41456---------------feature_selection-----------------", "anchor_text": "Feature Selection"}, {"url": "https://medium.com/tag/boruta?source=post_page-----985679b41456---------------boruta-----------------", "anchor_text": "Boruta"}, {"url": "https://medium.com/tag/python?source=post_page-----985679b41456---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----985679b41456---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F985679b41456&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----985679b41456---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F985679b41456&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----985679b41456---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F985679b41456&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----985679b41456--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F985679b41456&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----985679b41456---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----985679b41456--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----985679b41456--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----985679b41456--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----985679b41456--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----985679b41456--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----985679b41456--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----985679b41456--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----985679b41456--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/@mazzanti.sam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce90f5bea5f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-you-are-probably-doing-it-wrong-985679b41456&newsletterV3=e16f3bb86e03&newsletterV3Id=ce90f5bea5f9&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}