{"url": "https://towardsdatascience.com/customer-segmentation-with-machine-learning-a0ac8c3d4d84", "time": 1683004239.4535239, "path": "towardsdatascience.com/customer-segmentation-with-machine-learning-a0ac8c3d4d84/", "webpage": {"metadata": {"title": "Customer Segmentation with Machine Learning | by Ceren Iyim | Towards Data Science", "h1": "Customer Segmentation with Machine Learning", "description": "K-means algorithm applied to a real-world e-commerce sales data. Marketing strategies developed for each customer segment to extend CRM activities."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Unsupervised_learning", "anchor_text": "unsupervised machine learning algorithm", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-Means clustering", "paragraph_index": 6}, {"url": "https://github.com/cereniyim/Customer-Segmentation-Unsupervised-ML-Model", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://plot.ly/python/", "anchor_text": "Plotly", "paragraph_index": 14}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas", "paragraph_index": 14}, {"url": "https://numpy.org/", "anchor_text": "numpy", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/Skewness", "anchor_text": "skewed distributions", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "euclidian distance", "paragraph_index": 19}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "K-means algorithm from scikit-learn", "paragraph_index": 22}, {"url": "https://www.mathsisfun.com/definitions/converge.html", "anchor_text": "convergence", "paragraph_index": 23}, {"url": "https://www.geeksforgeeks.org/elbow-method-for-optimal-value-of-k-in-kmeans/", "anchor_text": "elbow method", "paragraph_index": 29}, {"url": "https://twitter.com/cereniyim", "anchor_text": "Twitter", "paragraph_index": 48}, {"url": "https://www.linkedin.com/in/ceren-iyim", "anchor_text": "Linkedin", "paragraph_index": 48}, {"url": "http://linkedin.com/in/ceren-iyim/", "anchor_text": "linkedin.com/in/ceren-iyim/", "paragraph_index": 50}, {"url": "http://github.com/cereniyim", "anchor_text": "github.com/cereniyim", "paragraph_index": 50}], "all_paragraphs": ["Imagine that you are treating the grocery shop owner that you shop every day, as you treat your significant other. That can be fun at the beginning, however may cause disastrous situations too. Likewise, it can be unfavourable for a company to manage its relationships with every customer similarly.", "Customer segmentation enables a company to customize its relationships with the customers, as we do in our daily lives.", "When you perform customer segmentation, you find similar characteristics in each customer\u2019s behaviour and needs. Then, those are generalized into groups to satisfy demands with various strategies. Moreover, those strategies can be an input of the", "There are different products/solutions available in the market from packaged software to CRM products. Today, I will apply an unsupervised machine learning algorithm with Python.", "This dataset from November 2018 \u2014 April 2019 is actual sales data courtesy of an e-commerce company. It was provided to me for an interview case study.", "Yes, they have an amazing interview process, but more on that later, at the end of this article. I also did not get the role, mainly because of remote employment logistics, but that\u2019s another story for another day.", "I will apply K-Means clustering to the dataset with the following steps.", "Along the way, I will explain how K-means clustering works. Eventually, I will provide specific strategies for the segments formed.", "P.S. I anonymized the data for confidentiality reasons.", "You can follow along with the steps from this notebook:", "\u2026and find the GitHub repository here.", "In the case study, I visualized the customer behaviour and characteristics from diverse aspects. Taking it one step further, I will form the business case around the question: Can the customer base be grouped to develop customized relationships?", "I will approach this question from a behavioural aspect (alternatives can be geographical or demographical perspectives) to better understand customers\u2019 spending and ordering habits with the following features: Number of products ordered, average return rate and total spending.", "There are approximately 25000 unique customers combined with their order information in the raw dataset:", "Dataset is well-formatted and had no NA values. So, we can start by forming the features. 3 features will be calculated per customer_id and they will help us with the visualization (using Plotly library) and algorithm explainability in the latter steps. Data preparation will be done with pandas and numpy.", "After the calculations, 3 features merged in the customers data frame:", "Let\u2019s have a look at the individual distribution of the features:", "All 3 distributions are positively skewed distributions. Products ordered shows a power-law distribution and average return rate of 99% of the customers are 0.", "3 features have different ranges varying between [1, 13], [0, 1] and [0, 1000] which is an important observation showing that features need scaling!", "K-means algorithm interprets each row in the customers data frame as a point in a 3-dimensional space. When grouping them, it uses the euclidian distance between the data points and the center of the group. With highly varying ranges, algorithm may perform poorly and not be able to form the groups as expected.", "For K-means to perform effectively, we are going to scale the data using logarithmic transformation which is a suitable transformation for skewed data. This will scale down proportionally the 3D space which our data is spread, yet preserving the proximity between the points.", "After applying the above function, customers data frame is ready to be fed into K-means clustering:", "We are going to use K-means algorithm from scikit-learn. Let\u2019s first understand how the algorithm will form customer groups:", "Repeat steps 2 and 3 until convergence.", "While running the steps through, the algorithm checks the sum of squared distances between clustered-point and center for each cluster. Mathematically speaking, it tries to minimize \u2014 optimize the within-cluster sum-of-squared-distances or inertia of each cluster.", "When inertia value does not minimize further, algorithm converges. Thus, iteration stops.", "This algorithm is easy to understand, fits well to large datasets in terms of computing times and guarantees convergence. However, when centroids are initialized randomly, algorithm may not assign the points to the groups in the most optimal way.", "One important consideration is the selection of k. In other words, how many groups should be formed? For example, K-means applied above uses k=8 as a default value.", "In the next step, we are going to choose k which is the most important hyperparameter of K-means.", "While selecting k, we are going to decide against the optimization criteria of the K-means, inertia, using elbow method. We are going to build different K-means models with k values 1 to 15, and save the corresponding inertia values.", "When we plot inertia against the k values:", "With the elbow method, we are going to select the k value where the decrease in the inertia stabilizes.", "When k=1 inertia is at the highest, meaning data is not grouped yet. Inertia decreases steeply until k=2. Between k=2 and 4, the curve continues to decrease fast.", "At k=4, the descent stabilizes and continues linearly afterwards, forming an elbow at k=4. This points out the optimal number of customer group is 4.", "Let\u2019s plug in the k=4 to K-means and visualize how customer groups are created:", "Data points are shown in spheres and centroids of each group are shown with cubes. 4 customer groups are as follows:", "Blue: Customers who ordered at least one product, with maximum total spending of 100 and having the highest average return rate. They might be the newcomers of the e-commerce website.", "Red: Customers who ordered 1 to 4 products, with average total spending of 150 and a maximum return rate of 0.5.", "Purple: Customers who ordered 1 to 4 products, with average total spending of 300 and a maximum return rate of 0.5.", "Green: Customers who ordered 1 to 13 products, with average total spending of 600 and average return rate as 0. It makes the most favourable customer group for the company.", "Let\u2019s look at how many customers are there in each group \u2014 known as cluster magnitudes:", "The overall strategy would be preserving the most favourable customer group \u2014 the green one \u2014 while moving the blue customer group to the red and purple areas.", "Blue group is 42% of all customers, any improvements achieved in this customer group will dramatically increase the revenue. Eliminating high return rates and offering gift cards can move this customer group to low-average-return-rate and high-total-spending area. If we assume that they are newcomers, gift cards can expedite their come-back.", "Red and purple group together consists of 50% of all customers. They are showing the same characteristics from the average return rate and products ordered perspectives but differ from total spending. These groups can be defined as who already know the brand and orders multiple products. Those customers can be kept up-to-date with the brand with some specialized communications and discounts.", "Green customer group consists of 8% of all customers, forming the most favourable customer group for the brand. They order multiple products and they are highly likely to keep them. To maintain and possibly expand this group, special deals and pre-product launches might help. Moreover, they can be magnets for new customers impacting the expansion of the customer base.", "We approached customer segmentation problem from a behavioural aspect with the number of products ordered, average return rate and total spending for each customer. Use of 3 features helped us with the understandability and visualization of the model.", "All in all, the dataset was apt to perform an unsupervised machine learning problem. At first, we only had customers data with order information and did not know if they belonged to any group. With the K-means clustering, patterns in the data were found and extended further into groups. We carved out strategies for the formed groups, making meaning out of a dataset that is a dust cloud initially.", "About the interview; I enjoyed working on the case study and the interview process is the best interview experience I had so far. It was a very realistic evaluation of my skills on a typical, practical task I would have regularly performed. This made the entire process very straightforward and fun. I hope this type of practical data science interviews become mainstream, benefitting both the candidates and the employers.", "Thanks for reading, for comments or constructive feedback, you can reach out to me on responses, Twitter or Linkedin!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer and Data Scientist | linkedin.com/in/ceren-iyim/ | github.com/cereniyim"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa0ac8c3d4d84&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cereniyim?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cereniyim?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": "Ceren Iyim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F287e9909d3b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&user=Ceren+Iyim&userId=287e9909d3b5&source=post_page-287e9909d3b5----a0ac8c3d4d84---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0ac8c3d4d84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0ac8c3d4d84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/machine-learning/home", "anchor_text": "Machine Learning"}, {"url": "https://unsplash.com/@graphwya?utm_source=medium&utm_medium=referral", "anchor_text": "Graph Wyatt"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Unsupervised_learning", "anchor_text": "unsupervised machine learning algorithm"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-Means clustering"}, {"url": "https://nbviewer.jupyter.org/github/cereniyim/Customer-Segmentation-Unsupervised-ML-Model/blob/0418ed702b0b8f87b472d68971c84a4913fa956e/Customer_Segmentation_Kmeans_Clustering.ipynb", "anchor_text": "Notebook on nbviewerCustomer segmentation will be applied to an e-commerce customer database using K-means clustering from scikit-learn. It\u2026nbviewer.jupyter.org"}, {"url": "https://github.com/cereniyim/Customer-Segmentation-Unsupervised-ML-Model", "anchor_text": "here"}, {"url": "https://plot.ly/python/", "anchor_text": "Plotly"}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas"}, {"url": "https://numpy.org/", "anchor_text": "numpy"}, {"url": "https://en.wikipedia.org/wiki/Skewness", "anchor_text": "skewed distributions"}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "euclidian distance"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "K-means algorithm from scikit-learn"}, {"url": "https://www.mathsisfun.com/definitions/converge.html", "anchor_text": "convergence"}, {"url": "https://commons.wikimedia.org/wiki/File:K-means_convergence.gif", "anchor_text": "Wikimedia"}, {"url": "https://www.geeksforgeeks.org/elbow-method-for-optimal-value-of-k-in-kmeans/", "anchor_text": "elbow method"}, {"url": "https://nbviewer.jupyter.org/github/cereniyim/Customer-Segmentation-Unsupervised-ML-Model/blob/0418ed702b0b8f87b472d68971c84a4913fa956e/Customer_Segmentation_Kmeans_Clustering.ipynb#Visualize-Customer-Segmentation", "anchor_text": "here"}, {"url": "https://twitter.com/cereniyim", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/ceren-iyim", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a0ac8c3d4d84---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a0ac8c3d4d84---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/marketing?source=post_page-----a0ac8c3d4d84---------------marketing-----------------", "anchor_text": "Marketing"}, {"url": "https://medium.com/tag/crm?source=post_page-----a0ac8c3d4d84---------------crm-----------------", "anchor_text": "CRM"}, {"url": "https://medium.com/tag/technology?source=post_page-----a0ac8c3d4d84---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa0ac8c3d4d84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&user=Ceren+Iyim&userId=287e9909d3b5&source=-----a0ac8c3d4d84---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa0ac8c3d4d84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&user=Ceren+Iyim&userId=287e9909d3b5&source=-----a0ac8c3d4d84---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0ac8c3d4d84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa0ac8c3d4d84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a0ac8c3d4d84---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a0ac8c3d4d84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cereniyim?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cereniyim?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ceren Iyim"}, {"url": "https://medium.com/@cereniyim/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "504 Followers"}, {"url": "http://linkedin.com/in/ceren-iyim/", "anchor_text": "linkedin.com/in/ceren-iyim/"}, {"url": "http://github.com/cereniyim", "anchor_text": "github.com/cereniyim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F287e9909d3b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&user=Ceren+Iyim&userId=287e9909d3b5&source=post_page-287e9909d3b5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff788c50c2bf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-with-machine-learning-a0ac8c3d4d84&newsletterV3=287e9909d3b5&newsletterV3Id=f788c50c2bf3&user=Ceren+Iyim&userId=287e9909d3b5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}