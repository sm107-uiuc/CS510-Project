{"url": "https://towardsdatascience.com/measuring-enhancing-image-quality-attributes-234b0f250e10", "time": 1683018418.211332, "path": "towardsdatascience.com/measuring-enhancing-image-quality-attributes-234b0f250e10/", "webpage": {"metadata": {"title": "Measuring and enhancing image quality attributes | by Marian Stefanescu | Towards Data Science", "h1": "Measuring and enhancing image quality attributes", "description": "Discover how exposure, tone mapping, and blur can be used to measure image quality and how to enhance images by using these attributes."}, "outgoing_paragraph_urls": [{"url": "https://www.wiley.com/en-us/Camera+Image+Quality+Benchmarking-p-9781119054498", "anchor_text": "Camera Image Quality Benchmarking", "paragraph_index": 0}, {"url": "https://stackoverflow.com/questions/48319918/whats-the-theory-behind-computing-variance-of-an-image", "anchor_text": "https://stackoverflow.com/questions/48319918/whats-the-theory-behind-computing-variance-of-an-image", "paragraph_index": 21}, {"url": "https://docs.opencv.org/master/d2/df0/tutorial_py_hdr.html", "anchor_text": "High Dynamic Range (HDR)", "paragraph_index": 22}], "all_paragraphs": ["Before starting our discussion about measuring or enhancing image quality attributes, we have to first properly introduce them. For this, I\u2019ve taken inspiration from the book Camera Image Quality Benchmarking, which describes in great detail the attributes that I will be speaking about here. It\u2019s important to note that, although the attributes described in the book are camera attributes, our discussion is centered around image attributes. Fortunately, a couple of camera attributes can be used as image attributes as well.", "Usually referring to the time of exposure, which is a property of the camera that affects the amount of light in an image. The corresponding image attribute is actually the brightness. There are multiple ways to compute the brightness or an equivalent measure:", "If we do the average for all the pixels, we can obtain a measure of perceived brightness. Also, by splitting the resulting value into five pieces (because the min is 0 and the max is 255) we can define a scale: (Very dark, dark, Normal, Bright, Very Bright).", "High-dynamic-range imaging (HDRI or HDR) is a technique used in imaging and photography to reproduce a greater dynamic range of luminosity than is possible with standard digital imaging or photographic techniques. While the human eye can adjust to a wide range of light conditions, most imaging devices use 8-bits per channel, so we are limited to only 256 levels. HDR imaging works with images that use more than 8 bits per channel (usually 32-bit float values), allowing a much wider dynamic range.", "There are different ways to obtain HDR images, but the most common one is to use photographs of the scene taken with different exposure values. To combine these exposures it is useful to know your camera\u2019s response function and there are algorithms to estimate it. After the HDR image has been merged, it has to be converted back to 8-bit to view it on usual displays. This process is called tone mapping.", "Measuring if an image is well tone-mapped", "From the above definition, I propose (so it\u2019s possible it\u2019s totally wrong) the following procedure for measuring tone mapping. The intuition behind this comes from the way histograms look when the images are not properly tone mapped. Most of the time they look like this:", "They are either too dark (shadow clipping), too bright (highlights clipping), or with both (for example a dark bathroom with the blitz visible in the mirror or a photo of a light pole in the middle of the night).", "In contrast, a well tone mapped image looks like this:", "Based on this, I propose (so take it with a grain of salt) a scoring method that tries to take into account the things described above. The score will be between [0, 1], 0 meaning the image is not correctly tone-mapped, and 1 that it is correctly tone-mapped. Besides the saturation effect, a poorly tone-mapped image might also be an image that has the majority of the brightness values in a tight interval (small variance => fewer available tones).", "4. We define a parabolic penalizing probability distribution, that\u2019s 0 in 0 and 1 with a maximum in 1/2 (This should be pretty fine as long as we penalize the extremes \u2014 thus low scores <=> the majority of the brightness was concentrated in the head and tail of the distribution).", "(Note: This is actually a simple example of a Bernoulli distribution, a good thing to use as a prior probability distribution).", "5. Next, we can define the \u201cpenalized\u201d brightness probability distribution as \u200b. The only thing left is to properly limit this product\u2026between 0 and 1. The first part is already solved\u2026the minimum of this product, for all the values of \u200b is 0. That\u2019s because we can define a black and white image that\u2019s with the following probability distribution:", "We can see because f is not 0 only at 0 and 255 the sum over all the pixels in the example image will be 0\u200b. Any other configuration would result in a sum that\u2019s greater than 0.", "To make the sum at most 1 we can use a high school trick, via the CBS inequality. In general:", "In our case, that would be:", "If we divide the left part with the right part we finally get a score that\u2019s between 0 and 1. Thus the final form of the first term is:", "I don\u2019t know why, but it resembles a lot with Pearson\u2019s correlation factor\u2026 \ud83e\udd14", "The next term I would simply define as:", "In the end, we get the following tone mapping score:", "Now, let\u2019s see some code as well:", "Because, the blurred image\u2019s edge is smoothed, so the variance is small. It's a one-liner in OpenCV, simply code \ud83c\udfa8: (https://stackoverflow.com/questions/48319918/whats-the-theory-behind-computing-variance-of-an-image).", "The OpenCV docs have a nice tutorial on this, High Dynamic Range (HDR).", "Finding flares reduces to the problem of finding very bright regions in the image. I haven\u2019t found a specific method of finding if an image has a flare, only for correcting one: The method is called CLAHE (Contrast Limited Adaptive Histogram Equalization).", "Before speaking about CLAHE, it\u2019s good to know why Histogram Equalization does NOT work:", "While the background contrast has improved after histogram equalization, the face of the statue became too bright. Because of this, a local version is preferred and thus, adaptive histogram equalization is used. In this, the image is divided into small blocks called \u201ctiles\u201d (tile size is 8x8 by default in OpenCV). Then each of these blocks is histogram equalized as usual. So in a small area, a histogram would confine to a small region (unless there is noise). If the noise is there, it will be amplified. To avoid this, contrast limiting is applied.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer, Software Developer and Math enthusiast."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F234b0f250e10&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----234b0f250e10--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----234b0f250e10--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://marianstefi20.medium.com/?source=post_page-----234b0f250e10--------------------------------", "anchor_text": ""}, {"url": "https://marianstefi20.medium.com/?source=post_page-----234b0f250e10--------------------------------", "anchor_text": "Marian Stefanescu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F69f423a66a77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&user=Marian+Stefanescu&userId=69f423a66a77&source=post_page-69f423a66a77----234b0f250e10---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F234b0f250e10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F234b0f250e10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.wiley.com/en-us/Camera+Image+Quality+Benchmarking-p-9781119054498", "anchor_text": "Camera Image Quality Benchmarking"}, {"url": "http://alienryderflex.com/hsp.html", "anchor_text": "Rex Finley"}, {"url": "https://stackoverflow.com/questions/48319918/whats-the-theory-behind-computing-variance-of-an-image", "anchor_text": "https://stackoverflow.com/questions/48319918/whats-the-theory-behind-computing-variance-of-an-image"}, {"url": "https://docs.opencv.org/master/d2/df0/tutorial_py_hdr.html", "anchor_text": "High Dynamic Range (HDR)"}, {"url": "http://www.pauldebevec.com/Research/HDR/debevec-siggraph97.pdf", "anchor_text": "http://www.pauldebevec.com/Research/HDR/debevec-siggraph97.pdf"}, {"url": "https://docs.opencv.org/3.4/d2/df0/tutorial_py_hdr.html", "anchor_text": "https://docs.opencv.org/3.4/d2/df0/tutorial_py_hdr.html"}, {"url": "https://docs.opencv.org/3.4/d2/df0/tutorial_py_hdr.html", "anchor_text": "https://docs.opencv.org/3.4/d2/df0/tutorial_py_hdr.html"}, {"url": "https://docs.opencv.org/3.1.0/d5/daf/tutorial_py_histogram_equalization.html", "anchor_text": "https://docs.opencv.org/3.1.0/d5/daf/tutorial_py_histogram_equalization.html"}, {"url": "https://medium.com/tag/image-quality-attributes?source=post_page-----234b0f250e10---------------image_quality_attributes-----------------", "anchor_text": "Image Quality Attributes"}, {"url": "https://medium.com/tag/image-quality?source=post_page-----234b0f250e10---------------image_quality-----------------", "anchor_text": "Image Quality"}, {"url": "https://medium.com/tag/histogram-equalization?source=post_page-----234b0f250e10---------------histogram_equalization-----------------", "anchor_text": "Histogram Equalization"}, {"url": "https://medium.com/tag/exposure?source=post_page-----234b0f250e10---------------exposure-----------------", "anchor_text": "Exposure"}, {"url": "https://medium.com/tag/image-blur?source=post_page-----234b0f250e10---------------image_blur-----------------", "anchor_text": "Image Blur"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F234b0f250e10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&user=Marian+Stefanescu&userId=69f423a66a77&source=-----234b0f250e10---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F234b0f250e10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&user=Marian+Stefanescu&userId=69f423a66a77&source=-----234b0f250e10---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F234b0f250e10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----234b0f250e10--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F234b0f250e10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----234b0f250e10---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----234b0f250e10--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----234b0f250e10--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----234b0f250e10--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----234b0f250e10--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----234b0f250e10--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----234b0f250e10--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----234b0f250e10--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----234b0f250e10--------------------------------", "anchor_text": ""}, {"url": "https://marianstefi20.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://marianstefi20.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marian Stefanescu"}, {"url": "https://marianstefi20.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F69f423a66a77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&user=Marian+Stefanescu&userId=69f423a66a77&source=post_page-69f423a66a77--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F470a260ebf54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmeasuring-enhancing-image-quality-attributes-234b0f250e10&newsletterV3=69f423a66a77&newsletterV3Id=470a260ebf54&user=Marian+Stefanescu&userId=69f423a66a77&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}