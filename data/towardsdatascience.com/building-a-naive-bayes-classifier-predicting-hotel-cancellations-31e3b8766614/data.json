{"url": "https://towardsdatascience.com/building-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614", "time": 1683011402.080076, "path": "towardsdatascience.com/building-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614/", "webpage": {"metadata": {"title": "Building a Naive Bayes Classifier: Predicting Hotel Cancellations | by Michael Grogan | Towards Data Science", "h1": "Building a Naive Bayes Classifier: Predicting Hotel Cancellations", "description": "A Naive Bayes Classifier is a probabilistic classifier, and one of the most fundamental classification models. The reason we refer to the classifier as a \u201cnaive\u201d one is because this classifier\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/MGCodesandStats/hotel-modelling", "anchor_text": "MGCodesandStats GitHub repository", "paragraph_index": 35}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 38}], "all_paragraphs": ["A Naive Bayes Classifier is a probabilistic classifier, and one of the most fundamental classification models. The reason we refer to the classifier as a \u201cnaive\u201d one is because this classifier naively assumes that all features in the dataset are independent of each other, i.e. conditional independence.", "From this standpoint, feature selection is not typically a strength of the Naive Bayes Classifier. Given the assumption that all features are independent of each other, this classifier is at risk of performing poorly when significant correlation exists between the features.", "Bayes\u2019 Theorem is defined as follows:", "This theorem works on the basis of conditional probability, i.e. the probability of an outcome occurring given the occurrence of a previous outcome. In this instance, the probabilities of a particular event occurring are updated as new information is gathered.", "For this particular scenario, we are looking to answer \u2014 what is the probability that a customer will cancel their hotel booking given prior probabilities?", "In this case, the Gaussian Naive Bayes algorithm for classification is applied. Even though the outcome variable is categorical (1 = cancellation, 0 = no cancellation), many of the features included in the model are continuous. Therefore, it is assumed that these continuous features are distributed according to a normal (Gaussian) distribution.", "In this regard, feature selection will not be conducted prior to running the Naive Bayes model. The model is built using the following features:", "The interval (or continuous random variables) are defined. As two examples:", "Variables with a categorical component are defined using \u2018\u2019\u2019cat.codes\u2019\u2019\u2019.", "A numpy column stack is formulated for the independent variables (both continuous and categorical):", "The data is then split into training and validation sets:", "Before we run the model, let\u2019s talk a little bit about precision versus recall.", "When comparing the accuracy scores, we see that numerous readings are provided in each confusion matrix.", "The two readings are often at odds with each other, i.e. it is often not possible to increase precision without reducing recall, and vice versa.", "An assessment as to the ideal metric to use depends in large part on the specific data under analysis. For example, cancer detection screenings that have false negatives (i.e. indicating patients do not have cancer when in fact they do), is a big no-no. Under this scenario, recall is the ideal metric.", "However, for emails \u2014 one might prefer to avoid false positives, i.e. sending an important email to the spam folder when in fact it is legitimate.", "The f1-score takes both precision and recall into account when devising a more general score.", "Which would be more important for predicting hotel cancellations?", "Well, from the point of view of a hotel \u2014 they would likely wish to identify customers who are ultimately going to cancel their booking with greater accuracy \u2014 this allows the hotel to better allocate rooms and resources. Identifying customers who are not going to cancel their bookings may not necessarily add value to the hotel\u2019s analysis, as the hotel knows that a significant proportion of customers will ultimately follow through with their bookings in any case.", "The relevant features as outlined above are included for determining whether the customer will cancel their booking.", "The GaussianNB library is imported from scikit-learn:", "The Gaussian Naive Bayes model is defined:", "Predictions are generated on the validation set:", "A confusion matrix is generated comparing the predictions with the actual results from the validation set:", "Recall for class 1 comes in at 94%, while the f1-score accuracy comes in at 54%. Now, let\u2019s test the prediction performance on H2 (the test set).", "We see that recall for class 1 is down slightly to 92%, while f1-score accuracy comes in at 48%.", "Clearly, there is a trade-off between higher recall and overall higher accuracy. Given that most entries in the dataset are 0 (non-cancellations), it stands to reason that a model with an overall high accuracy rate would perform quite well in predicting the non-cancellations, but poorly at predicting the 1 entries (cancellations).", "For instance, when an SVM was run on this dataset, the following results were obtained:", "We see that the f1-score accuracy is up to 63%, but recall for class 1 has fallen to 75%.", "In this regard, if one wished to prioritise identification of cancellations as opposed to maximising overall accuracy, then the argument could be made that the Naive Bayes model works better in this instance. However, it should be remembered that maximising recall only works to a certain point. If recall was 100%, then all bookings could be classified as a cancellation, and this does not reveal any insights regarding the differences between customers who cancel and those who do not.", "As mentioned, Naive Bayes regards all features as independent. In this regard, the model risks poor performance in situations where there is strong conditional dependence among the variables, e.g. let us say that more cancellations are observed across customers from a particular country of origin. However, we also observe that those cancellations are much higher across a particular market segment.", "In this regard, given the conditional dependence between these two features, we can no longer be certain that cancellations are higher for customers from a particular country of origin, as it could just so happen that a higher number of customers from a particular market segment are present for bookings from that particular country.", "Feature selection is an important part of machine learning \u2014 indeed, there are many models that are capable of explaining which features contribute more to influencing the outcome variable, as in the example below.", "However, Naive Bayes assumes all features are essentially weighted equally, and this can significantly affect accuracy readings depending on the data.", "In this example, we have seen how a Naive Bayes model can be constructed in Python and how model accuracy can be assessed using precision and recall.", "The datasets and notebooks for this example are available at the MGCodesandStats GitHub repository, along with further research on this topic.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F31e3b8766614&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----31e3b8766614--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----31e3b8766614--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----31e3b8766614--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----31e3b8766614--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----31e3b8766614---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31e3b8766614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31e3b8766614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/erik_stein-2524241/", "anchor_text": "erik_stein"}, {"url": "https://pixabay.com/illustrations/cube-random-luck-eye-numbers-1655118/", "anchor_text": "Pixabay"}, {"url": "https://github.com/MGCodesandStats/hotel-modelling", "anchor_text": "MGCodesandStats GitHub repository"}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "Antonio, Almedia and Nunes (2019). Hotel Booking Demand Datasets"}, {"url": "https://dzone.com/articles/naive-bayes-tutorial-naive-bayes-classifier-in-pyt", "anchor_text": "DZone: Naive Bayes Tutorial: Naive Bayes Classifier in Python"}, {"url": "https://www.researchgate.net/publication/220355799_Feature_Selection_for_the_Naive_Bayesian_Classifier_Using_Decision_Trees", "anchor_text": "Gunopulos and Ratanamahatana, 2003: Feature Selection for the Naive Bayesian Classifier Using Decision Trees"}, {"url": "https://towardsdatascience.com/svms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731", "anchor_text": "Imbalanced Classes: Predicting Hotel Cancellations with Support Vector Machines"}, {"url": "https://towardsdatascience.com/predicting-hotel-cancellations-using-interpretml-e4e64fefc7a8", "anchor_text": "Predicting Hotel Cancellations Using InterpretML"}, {"url": "https://scikit-learn.org/stable/modules/naive_bayes.html", "anchor_text": "Scikit-Learn Guide"}, {"url": "https://www.probabilisticworld.com/conditional-dependence-independence/", "anchor_text": "When Dependence Between Events Is Conditional"}, {"url": "https://medium.com/tag/data-science?source=post_page-----31e3b8766614---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----31e3b8766614---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/probability?source=post_page-----31e3b8766614---------------probability-----------------", "anchor_text": "Probability"}, {"url": "https://medium.com/tag/statistics?source=post_page-----31e3b8766614---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/classification?source=post_page-----31e3b8766614---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F31e3b8766614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&user=Michael+Grogan&userId=eec017a8b178&source=-----31e3b8766614---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F31e3b8766614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&user=Michael+Grogan&userId=eec017a8b178&source=-----31e3b8766614---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31e3b8766614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----31e3b8766614--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F31e3b8766614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----31e3b8766614---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----31e3b8766614--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----31e3b8766614--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----31e3b8766614--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----31e3b8766614--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----31e3b8766614--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----31e3b8766614--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----31e3b8766614--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----31e3b8766614--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-naive-bayes-classifier-predicting-hotel-cancellations-31e3b8766614&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}