{"url": "https://towardsdatascience.com/how-to-implement-a-for-loop-in-sql-37b19a89e1bb", "time": 1683016678.927271, "path": "towardsdatascience.com/how-to-implement-a-for-loop-in-sql-37b19a89e1bb/", "webpage": {"metadata": {"title": "How to implement a For Loop in SQL | by Roman Orac | Towards Data Science", "h1": "How to implement a For Loop in SQL", "description": "Until recently, I haven\u2019t thought much about for loops in SQL. If someone would ask me, I would say that there are no for loops in SQL. My answer would be right and wrong at the same time. While\u2026"}, "outgoing_paragraph_urls": [{"url": "http://sqlfiddle.com/#!17/9eecb/64994", "anchor_text": "SQL Fiddle", "paragraph_index": 7}, {"url": "http://sqlfiddle.com/#!17/9eecb/64994", "anchor_text": "SQL Fiddle", "paragraph_index": 21}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter", "paragraph_index": 22}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet", "paragraph_index": 22}], "all_paragraphs": ["Until recently, I haven\u2019t thought much about for loops in SQL. If someone would ask me, I would say that there are no for loops in SQL.", "My answer would be right and wrong at the same time. While there aren\u2019t for loops like in Python or Java, you can simulate a for loop with JOINs in SQL.", "In case you\u2019ve missed my previous article about this topic:", "While for loops in SQL sounds cool, but why would you need them?", "The concept I am describing here can be used for a Monte Carlo simulation.", "Monte Carlo methods are a broad class of computational algorithms that rely on repeated random sampling to obtain numerical results. The underlying concept is to use randomness to solve problems that might be deterministic in principle.", "In this article, we are going to use the Monte Carlo simulation to estimate the probability of a head with a fair and biased coin.", "Now, let\u2019s implement it! You can run this example by yourself in SQL Fiddle.", "The first step is to create a sequence table. The table has 10 numbers in a num column.", "The for_loop table combines 10 numbers from the sequence table in a longer sequence by cross joining the sequence table twice.", "CROSS JOIN joins each entry from table 1 with each entry in table 2. The sequence table has 10 entries, so cross joining two tables makes 10 * 10 entries in the for loop table.", "If you\u2019d need 1000 entries, you can cross join sequence table once again and update the select statement:", "The order of i column is not important for Monte Carlo simulation so you can remove ORDER BY statement.", "Now, that the for loop is implemented, let\u2019s add the data for the coins:", "In this step we CROSS JOIN coin and for loop tables. This makes 200 entries as the coin table has 2 entries and for loop has 100.", "In the CASE WHEN we simulate a coin flip with RANDOM(). If random > probability then it is head and tails otherwise.", "Now that we have the results of the experiment, we only need to summarize them.", "For each coin (fair and biased):", "As we know from the coin table, the probability of the head for a fair coin is 0.5. We estimated 0.6 with the Monte Carlo simulation. For biased coin it is 0.1 and we estimated 0.04", "Let\u2019s increase the number of iterations to 1000.", "With 1000 coins flips the estimated probabilities come closer to the probabilities we defined above.", "You can run this example by yourself in SQL Fiddle.", "Follow me on Twitter, where I regularly tweet about Data Science and Machine Learning.", "Here are a few links that might interest you:", "Some of the links above are affiliate links and if you go through them to make a purchase I\u2019ll earn a commission. Keep in mind that I link courses because of their quality and not because of the commission I receive from your purchases.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F37b19a89e1bb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://romanorac.medium.com/?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd----37b19a89e1bb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F37b19a89e1bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F37b19a89e1bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rishi_1?utm_source=medium&utm_medium=referral", "anchor_text": "Rishi Jhajharia"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/dont-repeat-these-5-mistakes-with-sql-9f61d6f5324f", "anchor_text": "Don\u2019t Repeat These 5 Mistakes with SQLDoing Data Analysis with SQL is pretty straightforward\u2026 until it is NOT!towardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "Wiki"}, {"url": "http://sqlfiddle.com/#!17/9eecb/64994", "anchor_text": "SQL Fiddle"}, {"url": "https://unsplash.com/@yogidan2012?utm_source=medium&utm_medium=referral", "anchor_text": "Daniele Levis Pelusi"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@tine999?utm_source=medium&utm_medium=referral", "anchor_text": "Tine Ivani\u010d"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@peejayvisual?utm_source=medium&utm_medium=referral", "anchor_text": "Pranav Kumar Jain"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@kristopher_allison?utm_source=medium&utm_medium=referral", "anchor_text": "Kristopher Allison"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@_louisreed?utm_source=medium&utm_medium=referral", "anchor_text": "Louis Reed"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://sqlfiddle.com/#!17/9eecb/64994", "anchor_text": "SQL Fiddle"}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter"}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet"}, {"url": "https://www.humanfirst.ai/", "anchor_text": "Labeling and Data Engineering for Conversational AI and Analytics"}, {"url": "https://imp.i115008.net/c/2402645/880006/11298", "anchor_text": "Data Science for Business Leaders"}, {"url": "https://imp.i115008.net/c/2402645/788201/11298", "anchor_text": "Intro to Machine Learning with PyTorch"}, {"url": "https://imp.i115008.net/c/2402645/803127/11298", "anchor_text": "Become a Growth Product Manager"}, {"url": "https://amzn.to/3ncTG7D", "anchor_text": "Deep Learning (Adaptive Computation and ML series)"}, {"url": "https://aigents.co/skills", "anchor_text": "Free skill tests for Data Scientists & Machine Learning Engineers"}, {"url": "https://unsplash.com/@cmhedger?utm_source=medium&utm_medium=referral", "anchor_text": "Courtney Hedger"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/sql?source=post_page-----37b19a89e1bb---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/data-science?source=post_page-----37b19a89e1bb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----37b19a89e1bb---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/analytics?source=post_page-----37b19a89e1bb---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/data?source=post_page-----37b19a89e1bb---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F37b19a89e1bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&user=Roman+Orac&userId=68bf0657a0cd&source=-----37b19a89e1bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F37b19a89e1bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&user=Roman+Orac&userId=68bf0657a0cd&source=-----37b19a89e1bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F37b19a89e1bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F37b19a89e1bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----37b19a89e1bb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----37b19a89e1bb--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://romanorac.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.7K Followers"}, {"url": "https://romanorac.medium.com/membership", "anchor_text": "https://romanorac.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa69c18dd3c04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-implement-a-for-loop-in-sql-37b19a89e1bb&newsletterV3=68bf0657a0cd&newsletterV3Id=a69c18dd3c04&user=Roman+Orac&userId=68bf0657a0cd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}