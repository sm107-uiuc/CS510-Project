{"url": "https://towardsdatascience.com/k-nearest-neighbors-94395f445221", "time": 1683008823.980779, "path": "towardsdatascience.com/k-nearest-neighbors-94395f445221/", "webpage": {"metadata": {"title": "K-Nearest Neighbors. All you need to know about KNN. | by Sangeet Aggarwal | Towards Data Science", "h1": "K-Nearest Neighbors", "description": "A perfect opening line I must say for presenting the K-Nearest Neighbors. Yes, that's how simple the concept behind KNN is. It just classifies a data point based on its few nearest neighbors. How\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/uciml/breast-cancer-wisconsin-data?select=data.csv", "anchor_text": "Breast Cancer Wisconsin(Diagnostic) Data Set", "paragraph_index": 4}, {"url": "http://faculty.marshall.usc.edu/gareth-james/ISL/data.html", "anchor_text": "advertising data", "paragraph_index": 20}], "all_paragraphs": ["\u201cA man is known for the company he keeps.\u201d", "A perfect opening line I must say for presenting the K-Nearest Neighbors. Yes, that's how simple the concept behind KNN is. It just classifies a data point based on its few nearest neighbors. How many neighbors? That is what we decide.", "Looks like you already know a lot of there is to know about this simple model. Let\u2019s dive in to have a much closer look.", "Before moving on, it\u2019s important to know that KNN can be used for both classification and regression problems. We will first understand how it works for a classification problem, thereby making it easier to visualize regression.", "The data we are going to use is the Breast Cancer Wisconsin(Diagnostic) Data Set. There are 30 attributes that correspond to the real-valued features computed for a cell nucleus under consideration. A total of 569 such samples are present in this data, out of which 357 are classified as \u2018benign\u2019 (harmless) and the rest 212 are classified as \u2018malignant\u2019 (harmful).", "The diagnosis column contains \u2018M\u2019 or \u2018B\u2019 values for malignant and benign cancers respectively. I have changed these values to 1 and 0 respectively, for better analysis.", "Also, for the sake of this post, I will only use two attributes from the data \u2192 \u2018mean radius\u2019 and \u2018mean texture\u2019. This will later help us visualize the decision boundaries drawn by KNN. Here\u2019s how the final data looks like (after shuffling):", "The above code should give you the following output with a slight variation.", "What just happened? When we trained the KNN on training data, it took the following steps for each data sample:", "Let\u2019s visualize how KNN drew a decision boundary on the train data set and how the same boundary is then used to classify the test data set.", "With the training accuracy of 93% and the test accuracy of 86%, our model might have shown overfitting here. Why so?", "When the value of K or the number of neighbors is too low, the model picks only the values that are closest to the data sample, thus forming a very complex decision boundary as shown above. Such a model fails to generalize well on the test data set, thereby showing poor results.", "The problem can be solved by tuning the value of n_neighbors parameter. As we increase the number of neighbors, the model starts to generalize well, but increasing the value too much would again drop the performance.", "Therefore, it\u2019s important to find an optimal value of K, such that the model is able to classify well on the test data set. Let\u2019s observe the train and test accuracies as we increase the number of neighbors.", "The above result can be best visualized by the following plot.", "The plot shows an overall upward trend in test accuracy up to a point, after which the accuracy starts declining again. This is the optimal number of nearest neighbors, which in this case is 11, with a test accuracy of 90%.", "Let\u2019s plot the decision boundary again for k=11, and see how it looks.", "We have improved the results by fine-tuning the number of neighbors. Also, the decision boundary by KNN now is much smoother and is able to generalize well on test data.", "Let\u2019s now understand how KNN is used for regression.", "While the KNN classifier returns the mode of the nearest K neighbors, the KNN regressor returns the mean of the nearest K neighbors.", "We will use advertising data to understand KNN\u2019s regression. Here are the first few rows of TV budget and sales.", "The above code will run KNN for various values of K (from 1 to 16) and store the train and test scores in a Dataframe. Let\u2019s see how these scores vary as we increase the value of n_neighbors (or K).", "At K=1, the KNN tends to closely follow the training data and thus shows a high training score. However, in comparison, the test score is quite low, thus indicating overfitting.", "Let\u2019s visualize how the KNN draws the regression path for different values of K.", "As K increases, the KNN fits a smoother curve to the data. This is because a higher value of K reduces the edginess by taking more data into account, thus reducing the overall complexity and flexibility of the model.", "As we saw earlier, increasing the value of K improves the score to a certain point, after which it again starts dropping. This can be better understood by the following plot.", "As we see in this figure, the model yields the best results at K=4. I have used R\u00b2 to evaluate the model, and this was the best we could get. This is because our dataset was too small and scattered.", "Some other points are important to know about KNN are:", "That\u2019s all for this post. I hope you had a good time learning KNN. For more, stay tuned.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Enthusiast | I try to simplify Data Science and other concepts through my blogs"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F94395f445221&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----94395f445221--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----94395f445221--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://datasciencewithsan.medium.com/?source=post_page-----94395f445221--------------------------------", "anchor_text": ""}, {"url": "https://datasciencewithsan.medium.com/?source=post_page-----94395f445221--------------------------------", "anchor_text": "Sangeet Aggarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb3258338f2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&user=Sangeet+Aggarwal&userId=db3258338f2f&source=post_page-db3258338f2f----94395f445221---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94395f445221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94395f445221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ro_ka?utm_source=medium&utm_medium=referral", "anchor_text": "Robert Katzki"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/uciml/breast-cancer-wisconsin-data?select=data.csv", "anchor_text": "Breast Cancer Wisconsin(Diagnostic) Data Set"}, {"url": "https://medium.com/u/db3258338f2f?source=post_page-----94395f445221--------------------------------", "anchor_text": "Sangeet Aggarwal"}, {"url": "https://medium.com/u/db3258338f2f?source=post_page-----94395f445221--------------------------------", "anchor_text": "Sangeet Aggarwal"}, {"url": "https://medium.com/u/db3258338f2f?source=post_page-----94395f445221--------------------------------", "anchor_text": "Sangeet Aggarwal"}, {"url": "http://faculty.marshall.usc.edu/gareth-james/ISL/data.html", "anchor_text": "advertising data"}, {"url": "https://medium.com/u/db3258338f2f?source=post_page-----94395f445221--------------------------------", "anchor_text": "Sangeet Aggarwal"}, {"url": "https://medium.com/u/db3258338f2f?source=post_page-----94395f445221--------------------------------", "anchor_text": "Sangeet Aggarwal"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----94395f445221---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/knn?source=post_page-----94395f445221---------------knn-----------------", "anchor_text": "Knn"}, {"url": "https://medium.com/tag/knn-algorithm?source=post_page-----94395f445221---------------knn_algorithm-----------------", "anchor_text": "Knn Algorithm"}, {"url": "https://medium.com/tag/data-science?source=post_page-----94395f445221---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nearest-neighbors?source=post_page-----94395f445221---------------nearest_neighbors-----------------", "anchor_text": "Nearest Neighbors"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F94395f445221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&user=Sangeet+Aggarwal&userId=db3258338f2f&source=-----94395f445221---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F94395f445221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&user=Sangeet+Aggarwal&userId=db3258338f2f&source=-----94395f445221---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94395f445221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----94395f445221--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F94395f445221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----94395f445221---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----94395f445221--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----94395f445221--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----94395f445221--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----94395f445221--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----94395f445221--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----94395f445221--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----94395f445221--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----94395f445221--------------------------------", "anchor_text": ""}, {"url": "https://datasciencewithsan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://datasciencewithsan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sangeet Aggarwal"}, {"url": "https://datasciencewithsan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "169 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb3258338f2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&user=Sangeet+Aggarwal&userId=db3258338f2f&source=post_page-db3258338f2f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3b6740e12074&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbors-94395f445221&newsletterV3=db3258338f2f&newsletterV3Id=3b6740e12074&user=Sangeet+Aggarwal&userId=db3258338f2f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}