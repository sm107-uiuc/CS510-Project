{"url": "https://towardsdatascience.com/few-shot-learning-with-fast-ai-81c66064e372", "time": 1683013160.126941, "path": "towardsdatascience.com/few-shot-learning-with-fast-ai-81c66064e372/", "webpage": {"metadata": {"title": "Few-Shot Learning with fast.ai. In few-shot learning, we train a model\u2026 | by Igor Susmelj | Towards Data Science", "h1": "Few-Shot Learning with fast.ai", "description": "Lately, posts and tutorials about new deep learning architectures and training strategies have dominated the community. However, one very interesting research area, namely few-shot learning, is not\u2026"}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/drive/11j4aJv50UxEVZbuUluOGqCMKIZrx7pUM?usp=sharing", "anchor_text": "our Google Colab Notebook", "paragraph_index": 1}, {"url": "https://colab.research.google.com/drive/11j4aJv50UxEVZbuUluOGqCMKIZrx7pUM?usp=sharing", "anchor_text": "The full code of this tutorial will be provided as a notebook", "paragraph_index": 2}, {"url": "https://www.fast.ai/", "anchor_text": "fast.ai", "paragraph_index": 3}, {"url": "https://www.lightly.ai", "anchor_text": "Lightly", "paragraph_index": 4}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle", "paragraph_index": 6}, {"url": "https://www.lightly.ai", "anchor_text": "Lightly app", "paragraph_index": 8}, {"url": "https://github.com/lightly-ai/lightly", "anchor_text": "lightly", "paragraph_index": 8}, {"url": "https://github.com/lightly-ai/lightly", "anchor_text": "Lightly", "paragraph_index": 8}, {"url": "https://app.lightly.ai", "anchor_text": "Lightly app", "paragraph_index": 9}, {"url": "https://www.lightly.ai", "anchor_text": "Lightly", "paragraph_index": 18}], "all_paragraphs": ["Lately, posts and tutorials about new deep learning architectures and training strategies have dominated the community. However, one very interesting research area, namely few-shot learning, is not getting the attention it deserves. If we want widespread adoption of ML we need to find ways to train them efficiently, with little data and code. In this tutorial, we will go through a Google Colab Notebook to train an image classification model using only 5 labeled samples per class. Using only 5 exemplary samples is also called 5-shot learning.", "Don\u2019t forget to check out our Google Colab Notebook for the full code of this tutorial!", "Jupyter Notebook (Google Colab)The full code of this tutorial will be provided as a notebook. Jupyter Notebooks are python programming environments accessible by web browsers and are very useful for fast prototyping and experiments. Colab is a service from Google where you get access to notebooks running on instances for free.", "Fast.aiTraining a deep learning model can be quite complicated and involve 100s of lines of code. This is where fast.ai comes to the rescue. A library developed by former Kaggler Jeremy Howard specifically aimed to make training deep learning models fast and simple. Using fast.ai we can train and evaluate our classifier with just a few lines of code. Under the hood, fast.ai is using the PyTorch framework.", "LightlyLightly aims to solve the question of which samples you should work with. If you only label a few samples out of your dataset one of the key questions arising is how do you pick the samples? Lightly aims at solving exactly this problem by providing you with different methods and metrics for selecting your samples", "We start by installing the necessary dependencies and downloading the dataset. You can run any shell command in a notebook by start the code with an \u201c!\u201dE.g. to install our dependencies we can run the following code within a notebook cell:", "In this tutorial, we work with a dataset consisting of cats and dogs images. You can download it from Kaggle using the fastai CLI (command-line interface) by running the following command. Note that you need to adapt the token you get from Kaggle:", "In order to get robust results with our few-shot learning algorithm, we want our training set to cover the full space of samples. That means we don\u2019t want lots of similar examples but rather select a very diverse set of images. To achieve this we can create an embedding of our dataset followed by a sampling method called coreset[1] sampling. Coreset sampling ensures that we build up our dataset by only adding samples which lie furthest apart from the existing set as possible.", "Now we will use the Lightly app and its python package lightly to select the most diverse 10 samples we want to work with. We first need to create an embedding. Lightly allows us to do this without any labels by leveraging recent success in self-supervised learning. We can simply run the following command to train the model for a few epochs and create our embedding:", "Finally, we need to upload our dataset and embedding to the Lightly app to run our selection algorithm. Since we don\u2019t want to upload the images we can tell the CLI to consider only metadata of the samples.", "Once the data and embedding are uploaded we can go back to the web platform and run our sampling algorithm. This might take a minute to complete. If everything went smoothly you should see a plot with a slider. Move the slider to the left to only keep 10 samples in the new subset. Hint: You can use the arrow keys to move the slider one by one. Once we have our 10 samples selected we need to create a new tag (left menu). For this tutorial, we use \u201ctiny\u201d as the name and press the enter key to create it.", "Download the newly created subset using the following CLI command:", "You might see that the dataset you downloaded is not perfectly balanced. E.g. you might have 4 images of cats and 6 of dogs. This is due to the algorithm we chose for selecting the samples. Our goal was to cover the whole embedding/ feature space. It might very well be that there are more similar images of cats in our dataset than images of dogs. As a result, more images of dogs than cats will be selected.", "If you reach this point you should have a dataset we obtained using Lightly and Coreset sampling ready to be used to train our classifier.", "Fast.ai requires only a few lines of code to train an image classifier. We first need to create a dataset and then a learner object. Finally, we train the model using the .fit(...) method.", "To evaluate our model we use the test set of the cats and dogs dataset consisting of 2'000 images. Looking at the confusion matrix we see that our model mostly struggles with predicting dogs as being cats.", "Fast.ai also helps us here getting interpretable performance plots of our model with just a few lines of code.", "The library allows us also to look at the images from the test set with the highest loss of the trained model. You see that the model struggles with smaller dogs looking more similar to cats. We could improve accuracy by selecting more samples for the training routine. However, the goal of this tutorial was to show that by leveraging transfer learning and a smart data selection process you can get already high accuracy (>80%) with just a handful of training data.", "I hope you enjoyed this brief guide on how to use few-shot learning using fast.ai and Lightly. Follow me for further tutorials on Medium!", "[1]Ozean S., (2017), Active Learning for Convolutional Neural Networks: A Core-Set Approach", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-founder at Lightly | Writer at Medium about Computer Vision, Startups and Machine Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F81c66064e372&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----81c66064e372--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----81c66064e372--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@isusmelj?source=post_page-----81c66064e372--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@isusmelj?source=post_page-----81c66064e372--------------------------------", "anchor_text": "Igor Susmelj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa20329809ac8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&user=Igor+Susmelj&userId=a20329809ac8&source=post_page-a20329809ac8----81c66064e372---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81c66064e372&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81c66064e372&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colab.research.google.com/drive/11j4aJv50UxEVZbuUluOGqCMKIZrx7pUM?usp=sharing", "anchor_text": "our Google Colab Notebook"}, {"url": "https://colab.research.google.com/drive/11j4aJv50UxEVZbuUluOGqCMKIZrx7pUM?usp=sharing", "anchor_text": "The full code of this tutorial will be provided as a notebook"}, {"url": "https://www.fast.ai/", "anchor_text": "fast.ai"}, {"url": "https://www.lightly.ai", "anchor_text": "Lightly"}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle"}, {"url": "https://www.lightly.ai", "anchor_text": "Lightly app"}, {"url": "https://github.com/lightly-ai/lightly", "anchor_text": "lightly"}, {"url": "https://github.com/lightly-ai/lightly", "anchor_text": "Lightly"}, {"url": "https://app.lightly.ai", "anchor_text": "Lightly app"}, {"url": "https://www.lightly.ai", "anchor_text": "Lightly"}, {"url": "https://www.lightly.ai", "anchor_text": "Lightly.ai"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----81c66064e372---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/few-shot-learning?source=post_page-----81c66064e372---------------few_shot_learning-----------------", "anchor_text": "Few Shot Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----81c66064e372---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----81c66064e372---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F81c66064e372&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&user=Igor+Susmelj&userId=a20329809ac8&source=-----81c66064e372---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F81c66064e372&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&user=Igor+Susmelj&userId=a20329809ac8&source=-----81c66064e372---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81c66064e372&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----81c66064e372--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F81c66064e372&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----81c66064e372---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----81c66064e372--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----81c66064e372--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----81c66064e372--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----81c66064e372--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----81c66064e372--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----81c66064e372--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----81c66064e372--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----81c66064e372--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@isusmelj?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@isusmelj?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Igor Susmelj"}, {"url": "https://medium.com/@isusmelj/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "81 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa20329809ac8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&user=Igor+Susmelj&userId=a20329809ac8&source=post_page-a20329809ac8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2b03a99fc891&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffew-shot-learning-with-fast-ai-81c66064e372&newsletterV3=a20329809ac8&newsletterV3Id=2b03a99fc891&user=Igor+Susmelj&userId=a20329809ac8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}