{"url": "https://towardsdatascience.com/all-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636", "time": 1683005963.367915, "path": "towardsdatascience.com/all-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636/", "webpage": {"metadata": {"title": "All the Core Functions of Python Pandas You Need to Know | Towards Data Science", "h1": "All the Core Functions of Python Pandas You Need to Know", "description": "Python Pandas Core functions that a Data Analyst must know, which are important for Data Science, Data Analysis, Data Analytics and Data Engineering."}, "outgoing_paragraph_urls": [], "all_paragraphs": ["As one of the most popular libraries in the Python programming language, Pandas is a \u201cmust-learn\u201d library for Data I/O, cleansing, transforming and aggregation.", "It is quite common to see such kinds of questions in Stack Overflow regarding Pandas:", "In my opinion, all the newbies of Pandas should know at least the basic Pandas functions and practice them before starting to actually use them. There are not too many, but can help you to solve most of the regular problems.", "What are these functions? OK. In this article, I\u2019ve organised all of these functions into different categories with separated tables. If you believe that you may already know some ( If you have ever used Pandas you must know at least some of them), the tables below are TD; DL for you to check your knowledge before you read through.", "Next, let me demonstrate these functions. I will give sample usage of them, but of course, I can\u2019t enumerate all the scenarios that these functions that might be used. So, it is highly recommended to practice them by yourself.", "Reading and Writing from CSV, Excel and JSON documents are used very similarly. Note that you can either read from a local path or an URL.", "In read_excel, we can specify which spreadsheet to load by giving the sheet_name, if multiple sheets are existing.", "For read_json, it is important to use the orient parameter correctly. The most commonly used are records when the JSON document is an array, and index if you want to use the root keys as indices.", "The to_csv, to_excel and to_json are the corresponding writing functions. The important difference is that we need to call these functions from a Data Frame object rather than the Pandas object.", "Reading and Writing directly from/to the database is a bit more tricky. Pandas support multiple libraries such as pymssql for SQL Server and pymysql for MySQL. However, the one I like the most is sqlalchemy which supports the most popular databases even including cloud databases such as Snowflake DB.", "Very often, we want to get a general picture of the dataset we have, or just want to check whether the data has been loaded into Pandas data frame correctly or not. We\u2019ll need to know several functions to do such.", "For demonstrating purpose, I firstly created a data frame with two columns \u2014 \u201cid\u201d and \u201cname\u201d.", "The df.head() function shows the top 5 rows by default.", "However, you can always specify how many rows to show such as df.head(10) to show 10 rows.", "Similar to df.head() this function will show the tail n rows.", "This will be helpful when your dataset is sorted, and you want to check the results.", "We can sort by either ascending or descending. Note that inplace needs to be set to True if you want to assign the sorted data frame back to your variable. Otherwise, your data frame df will not be changed.", "Please note that this is not a function, but a property of the data frame.", "Getting the property value will return the following results.", "Also, you can assign a list to this property to rename all the columns of the data frame. For example:", "This is also a property of the data frame that returns all the data types for the columns. It is very useful when you want to check the data types, especially dealing with datetime columns.", "This is probably the property that I use the most. Very frequently we may want to check the number of rows and columns of our data frame.", "Please note that this property is a tuple, where the first element is row count and the second one is column count.", "When we are dealing with some measures, we may want to have a picture of the data distribution. df.describe() gives this rough statistics.", "When this function is called for a data frame with multiple columns, the non-numeric ones will be ignored.", "Note that the stats for id columns doesn\u2019t make any sense, but it demonstrates the function.", "This function applies to a Pandas series rather than a data frame. It counts the occurrence of each value in the series.", "Let\u2019s create another data frame with some duplicated names. Then, count the name frequencies in this data frame. Please note that we use df.name or df['name'] to get the name column of the data frame as a series on which the value_counts() function can be applied.", "It is quite common that the raw dataset we got is not perfect. So, we need to clean the dataset before use. Here are the related Pandas functions.", "When we want to filter \u201cNULL\u201d values in the data frame, this function will help. Let\u2019s create another data frame with some NULL values in the name column. Note that we use None in Python for null objects.", "Then, suppose we want to filter all the NULL values out.", "df.name helps to get the \u201cname\u201d column of the data frame as a series, and then isna() returns a series of boolean values representing whether the name is null. After that, the ~ sign at the beginning reversed the boolean value, since we want to reserve the rows that NOT having NULL values. Finally, the data frame df will be filtered by this boolean series, where the row with the \u201cFalse\u201d boolean value will be discarded.", "What if we have multiple columns that have null values and we want to filter out all the rows having at least one null value? Well, we could still use the above method but you\u2019ll need to repeat many times for every column.", "Sometimes we may don\u2019t want to simply discard the row with null values. Instead, we want to fill the null values with something else.", "In this example, the name column with null values are replaced with the \u201cUnknown\u201d string, and we still have these rows.", "Sometimes the raw dataset may have some duplicated rows which we don\u2019t actually want them.", "In this example, we have two \u201cChris\u201d with id = 3. So, the function dropped the second.", "In this example, the data frame has 3 columns.", "Suppose that we don\u2019t need the \u201ccomments\u201d column, we could use df.drop() function to drop it.", "This function can also be used to drop rows.", "In this example, the data frame is still created with the column names \u201cid\u201d and \u201cname\u201d. However, the df.rename() function helped to rename the column headers.", "Please note that it takes a dictionary as the parameter, where the keys are the old headers and the values are the new headers.", "In this example, the data frame has only the \u201cname\u201d column. So, what if we want to create another column as an identity?", "If you think a column from the row number is fine, simply use the df.reset_index() function.", "There is another typical usage of this function. Imagine that we have just cleansed the dataset that some duplicated rows were discarded. However, the index will not be continuous anymore. If you want to have a continuous index again, this function helps too.", "After the data cleansing, we may need to transform the data.", "Commonly, we have our raw dataset with all the dates or times in string format. For the later on analytics purposes such as sorting, we may want to convert these strings into the datetime objects.", "Please note that this function returns a series, so we can assign it back to the column of the data frame.", "This function helps us to convert the data type of a column easily. In the example, the data frame was created with its \u201cid\u201d field with all string types. Then, the s.astype() function helped to convert them into integers.", "This is probably the function that I used the most. Although Pandas allows us to easily perform some transformation to a whole column of a data frame, for example, df.col + 1 will add 1 to all the values of this column. However, sometimes we may need to do something unique which are not supported by Pandas built-in functions. In this case, the apply() function helps.", "When we use the apply() function, it is very common to use a lambda function along with it. In the example below, we manually used apply() function achieved df.number + 1.", "In some special cases, the lambda function may not be enough. For example, we have a whole bunch of logic to apply to a column, which can only be put in a customised function. So, the apply() function can also be used along with customised functions.", "The example below uses a customised function that does the same thing.", "What if we need to use multiple columns in an apply() function? In fact, the apply() function can be used on a data frame object as well.", "In the above example, the data frame is created with two numeric columns. Then, we use the lambda function to get each row with all the cells. After that, we can still use ['col_name'] to access the values. So, row[\u2018num1\u2019] + row[\u2018num2\u2019] will return the sum of the values from both of the columns.", "Very importantly, the parameter axis=1 must be specified here, because the apply() function on a data frame object will be applied on row indices by default.", "Similarly, we can also use a customised function.", "I used to use this function when dealing with JSON documents. Because of the style of JSON, sometimes we have one key with an array value. In this case, we can easily flatten the array.", "In this example, the languages that are directly loaded from a JSON document are still arrays. Then, let\u2019s use df.explode() function to flatten it out.", "Data Aggregation plays an important role in Data Analytics. Pandas provide many ways to perform data aggregation. Here I organised some functions that you must know as basics.", "In this example, two data frames are created.", "Then, we can use the pd.concat() function to concatenate them together as one.", "Please note that we can also use this function to concatenate vertically. Feel not comfortable about the index? Do you still remember the df.reset_index() function? :)", "This is another one that I used a lot in practice. If you have experience in SQL queries, this is just like joining two tables.", "As shown in the code block above, there are two data frames created with the \u201cname\u201d column and the \u201clanguage\u201d column respectively. Then, we can use this function to \u201cjoin\u201d them together. Please note that we need to specify which column that is used to join on with on='id' and specify how the two data frames are joined how='inner'.", "These two functions would be better demonstrated together, as the function df.groupby() cannot produce meaningful results by itself. It has to be used together with other functions that apply to the groups, which I believe df.groupby().agg() is the most common one.", "In this example, we created a data frame with \u201cname\u201d, \u201clanguage\u201d and \u201cage\u201d.", "Then, the data frame is grouped by the languages, and we count the number of names and averaging the ages among these persons. Well, the column headers don\u2019t make sense now, but we can use the df.rename() function to fix them.", "For the above example, we can also implement it using the pd.pivot_table() function. That is, we need to specify the group keys and the measure values as follows (using the same data frame in the previous example):", "Therefore, it is obvious that the pd.pivot_table() function is more convenient when we have multiple levels of group keys and measure values.", "Indeed, the Pandas library of Python has a lot more functions that makes it such a flexible and powerful data analytics tool in Python. In this article, I just organised the basic ones that I believe are the most useful. If one can nail all of them, definitely can start to use Pandas to perform some simple data analytics. Of course, there is still a lot to learn to become a master.", "If you feel my articles are helpful, please consider joining Medium Membership to support me and thousands of other writers! (Click the link above)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd219cbd87636&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d219cbd87636--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d219cbd87636--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://qiuyujx.medium.com/?source=post_page-----d219cbd87636--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=post_page-----d219cbd87636--------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308----d219cbd87636---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd219cbd87636&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd219cbd87636&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/Sarah_Loetscher-4248505/", "anchor_text": "Sarah_Loetscher"}, {"url": "https://pixabay.com/photos/street-art-graffiti-wall-painting-2254146/", "anchor_text": "Pixabay"}, {"url": "https://unsplash.com/@roadtripwithraj?utm_source=medium&utm_medium=referral", "anchor_text": "Road Trip with Raj"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@christianw?utm_source=medium&utm_medium=referral", "anchor_text": "Christian Wiediger"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@thecreative_exchange?utm_source=medium&utm_medium=referral", "anchor_text": "The Creative Exchange"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@momentance?utm_source=medium&utm_medium=referral", "anchor_text": "SwapnIl Dwivedi"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@martinsanchez?utm_source=medium&utm_medium=referral", "anchor_text": "Martin Sanchez"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@aaronburden?utm_source=medium&utm_medium=referral", "anchor_text": "Aaron Burden"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@qiuyujx/membership", "anchor_text": "Join Medium with my referral link \u2014 Christopher TaoAs a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://medium.com/tag/python?source=post_page-----d219cbd87636---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----d219cbd87636---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----d219cbd87636---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d219cbd87636---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----d219cbd87636---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd219cbd87636&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&user=Christopher+Tao&userId=b8176fabf308&source=-----d219cbd87636---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd219cbd87636&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&user=Christopher+Tao&userId=b8176fabf308&source=-----d219cbd87636---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd219cbd87636&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d219cbd87636--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd219cbd87636&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d219cbd87636---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d219cbd87636--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d219cbd87636--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d219cbd87636--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d219cbd87636--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d219cbd87636--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d219cbd87636--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d219cbd87636--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d219cbd87636--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://qiuyujx.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8.7K Followers"}, {"url": "https://www.linkedin.com/in/christopher-tao-5717a274/", "anchor_text": "https://www.linkedin.com/in/christopher-tao-5717a274/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d2af94a683f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-core-functions-of-python-pandas-you-need-to-know-d219cbd87636&newsletterV3=b8176fabf308&newsletterV3Id=1d2af94a683f&user=Christopher+Tao&userId=b8176fabf308&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}