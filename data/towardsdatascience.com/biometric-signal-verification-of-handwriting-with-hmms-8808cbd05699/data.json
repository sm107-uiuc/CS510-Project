{"url": "https://towardsdatascience.com/biometric-signal-verification-of-handwriting-with-hmms-8808cbd05699", "time": 1683015171.8620229, "path": "towardsdatascience.com/biometric-signal-verification-of-handwriting-with-hmms-8808cbd05699/", "webpage": {"metadata": {"title": "Biometric Signal Verification of Handwriting with Hidden Markov Models | by Tim L\u00f6hr | Towards Data Science", "h1": "Biometric Signal Verification of Handwriting with Hidden Markov Models", "description": "Digital signatures are on the rise. Since many of us are working now from home, a lot of confidential company E-Mails need to be signed online. Ian Goodfellows' invention of Generative Adversarial\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.sciencedirect.com/science/article/abs/pii/S0167865507002395", "anchor_text": "HMM-Based On-Line Signature Verification", "paragraph_index": 2}, {"url": "https://ms.sapientia.ro/~manyi/mobisig.html", "anchor_text": "mobisig", "paragraph_index": 17}, {"url": "https://www.hindawi.com/journals/misy/2018/3127042/", "anchor_text": "Online Signature Verification on MOBISIG Finger-Drawn Signature Corpus", "paragraph_index": 17}, {"url": "https://hmmlearn.readthedocs.io/en/latest/", "anchor_text": "hmmlearn", "paragraph_index": 20}, {"url": "https://hmmlearn.readthedocs.io/en/latest/api.html#hmmlearn.hmm.GMMHMM", "anchor_text": "hmmlearn", "paragraph_index": 33}, {"url": "https://timloehr.me/", "anchor_text": "website", "paragraph_index": 45}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0167865507002395", "anchor_text": "HMM-based on-line signature verification: Feature extraction and signature modeling", "paragraph_index": 46}, {"url": "http://www.sciencedirect.com", "anchor_text": "Science Direct", "paragraph_index": 46}, {"url": "https://www.hindawi.com/journals/misy/2018/3127042/", "anchor_text": "Online Signature Verification on MOBISIG Finger-Drawn Signature Corpus", "paragraph_index": 46}, {"url": "http://www.hindawi.com", "anchor_text": "Hindawi", "paragraph_index": 46}, {"url": "https://link.springer.com/chapter/10.1007/11527923_54", "anchor_text": "An On-Line Signature Verification System Based on Fusion of Local and Global Information", "paragraph_index": 46}, {"url": "https://link.springer.com/", "anchor_text": "Springer", "paragraph_index": 46}], "all_paragraphs": ["Digital signatures are on the rise. Since many of us are working now from home, a lot of confidential company E-Mails need to be signed online. Ian Goodfellows' invention of Generative Adversarial Networks (GAN\u2019s) showed how easy it is nowadays to generate fake numbers on the MNIST dataset. It is actually just a tiny step from that, to also be able to generate imitated signatures with the handwriting style of any person. But isn\u2019t that dangerous?", "Can we distinguish with Machine Learning between an original and an artificially crafted signature? Indeed we can! We don\u2019t necessarily even need one of those fancy neural network approaches, we can go totally classic with Hidden Markov Models (HMM). I will show in this post how we can incorporate HMM\u2019s to classify whether a signature was original or imitated.", "This project is loosely inspired by the paper of Julian Fierrez et. al. published 2007, called: HMM-Based On-Line Signature Verification.", "Even though Hidden Markov Models are not state-of-the-art, as the publishing date \u201c2007\u201d of the paper above already suggests, they are still a fundamental concept every Data Scientist should at least have heard about. Understanding the way an HMM works can be enlightening when you want to understand more recent technologies like Recurrent Neural Networks, because many techniques have evolved out of the HMM\u2019s basic idea.", "Hidden Markov Models can include time dependency in their computations. In Figure 1 below we can see, that from each state (Rainy, Sunny) we can transit into Rainy or Sunny back and forth and each of them has a certain probability to emit the three possible output states at every time step (Walk, Shop, Clean). The start probability always needs to be provided as well (60% for Rainy and 40% for Sunny) to start the computational chain.", "In our case this means, that a signature is written from left to right with one letter after another. So the time dependency involves the speed, pressure and coordinates of the pen moving around to form a letter. All of this information can be taken into consideration to make an estimate of how likely it is going to be that a signature has been written by the original person or if it has been faked.", "Figure 1 suggests that we need prior knowledge about the:", "Notice that start probability sums up to 100% and for the Matrices transition and emission each row sums up to 100%.", "We need time-dependent data and compute features out of them, then we can fit the GMM to find the parameters for our HMM. When we have the parameters of the HMM, we can compute scores for the original and the imitated signatures. Based on the scores, we can make classification estimates of how likely it is going to be that the signature is true or not.", "Why should we even use a Gaussian Mixture Model for training the HMM parameters in the first place? Well basically hmmlearn offers us three possibilities to choose from:", "The GMM just works the best, because estimating the density of our signature is most likely not just a single Gaussian or single distribution, but the ground truth looks more like a valley, which can be way better approximated by a GMM.", "We can exploit GMM\u2019s with the so-called EM (Expectation-Maximization) algorithm let us compute those hidden parameters automatically. What is the EM algorithm expecting to compute the hidden parameters?", "The GMM uses the EM Algorithm to compute its parameters:", "Where we have to choose the Hyperparameters of the GMM, which are:", "In reality, we can\u2019t know what the best set of Hyperparameters are, but we could use for example the K-Fold Crossvalidation to find that out.", "Ok, Hyperparameters are values that we as humans need to choose. This is also called the Model Selection problem. The Model parameters are parameters that the GMM with the EM algorithms computes for us.", "For measuring those kinds of features (pressure, speed, etc.), we need a device like the one shown on the left-most picture below:", "I am using the mobisig dataset. It contains 83 entries in total (49 male, 34 female), which we later will split into the train-, test-, and imitationset. The signatures were collected by Margit Antal et. al. and was published 2017 in their research paper: Online Signature Verification on MOBISIG Finger-Drawn Signature Corpus.", "This paper provides one example signature.", "It can be seen that the forgery signature contains more densely connected pressure points. The paper explains how the forgery was created. You can read it if you want, but this post focuses on how we can detect this forgery, not how it was generated.", "I am going to use the hmmlearn package for python, so I don\u2019t have to reinvent the wheel for building HMM\u2019s from scratch.", "Let\u2019s start by importing the default packages for this project. I set the random seed, so you will have exactly the same plots as I have.", "Also, we want to make sure to load the dataset properly, as can be seen in the code snippet above. The data is stored in dictionaries, were each person has two entries (\u201coriginal\u201d and \u201cimitated\u201d) which are further split into multiple signatures each. Furthermore, all signatures have a few hundred or thousand rows with the timestamp id (which progresses in milliseconds).", "Looking back to Figure 1, the first step to proceed is the feature extraction. Fitting Gaussian, especially Mixture Gaussian is way more effective and efficient if the data points are zero centered and have a normalized standard deviation. From paper [1] we can obtain the following normalization step:", "Next, we extract the four features after the normalization step. The formulas (2. Step) are obtained from [3]:", "The normalization step 1 is shown in the function (lines: 1\u20132) of the code. This formula in Figure 3 just means to sum over all x\u2019s and y\u2019s and divide them by the number of occurrences N. So just taking the mean. Furthermore, epsilon (e = np.finfo) is added (lines: 2, 21, 22, 24, \u2026 ) to be protected against a division by zero error.", "The four features from step 2 are very straightforward computable. The dot over x and y indicate to use the normed x and y we just computed. Apart from that, theta can is calculated exactly like the formula suggests in line 24 of the code. The path velocity is calculated in line 27 the same way. It is just the square root!", "Special attention goes to the Log curvature radius, because if you look closely, you can see that the authors want theta also to be normalized. Therefore in line 30 where \u03c1 (rho) is computed, we also call the norm function on \u03b8 (theta).", "The last feature I called alpha in the code, because it sounds nicer than just a. It is as straightforwardly calculated as the rest in line 33 of the code.", "I appended all of the features to their according lists, because we need that in order to feed these features in the hidden Markov learning function.", "So, we are done with the feature extraction step. Now let\u2019s build the model.Oh no! We need to split the data into train-, test- and imitation datasets. From the mentioned entries I am using the first 25 people as training examples, this is the minimum amount to prevent overfitting, where one entry corresponds to multiple signatures by one person. So the trainset contains 25 different people with many according true and fake signatures. The testset contains another 20 different people and the validationset (X_val) set holds all the imitated signatures.", "Since I said that the row length of all of the signatures were different, I always needed to keep track of the current length and append it to the new data frame. That were quite a hustle to program properly. In line 51, I renamed the features to the names from the feature extraction step.", "Important to note is that I am calling the feature extraction function in line 47\u201349, to compute the features.", "To train the GMM HMM, we need to have a look at the documentation from hmmlearn.", "The transition matrix will be parameterized such that it is diagonally filled with a 50% probability (0.5), except for the first and the last entry. This is suggested by hmmlearn in the documentation. The same goes for the startprob matrix, I chose the default initialization from hmmlearn.", "The features variables X_train are now containing one timestamp and the seven features per row:", "Now we can create the model in line 20 of the code below. The number of components and the number of mixtures play an essential role in how good the estimation of imitated signatures will be, but we can\u2019t know what the best values will be as already said. For that reason, I tried different combinations against each other. So let us have a look at how these two hyperparameters behave against each other.", "The score function in line 35, 39 and 43 evaluates the scores for the three different sets. Those scores are calculated by the objective function of the GMM, which is the negative log-likelihood.", "Alright, let\u2019s call the fit_hmm function with different values for components and GMM\u2019s:", "We call it Success when we are having a set of imitated signatures with different or lower scores than the original (blue or green) signatures.", "We can see that the number of HMM states have the highest influence on the scores. We want scores that separate the red dots (imitation) as far as possible from the original blue and green dots. Seven or fewer HMM states appear to separate the red dots pretty well from the rest and the GMM components have apparently a low impact on the output.", "If we draw a linear classification line between the colored dots,", "we can see how well the HMM is able to detect if the signature is fake or not. We would for example set a threshold value at -2200 and then score a new signature. If the value of the score is less than -2200 we claim it to be fake, if it is bigger we say it is an original signature.", "What we could do now is save up the scores and train for example a Logistic Regression to predict the probability (0\u2013100%) based on the score on how likely it is that the signature is original or not. This Logistic Regression can be further extended with the accuracy score from sklearn, to estimate the uncertainty of the model.", "Success! We can successfully distinguish between imitated and original signatures. Some state-of-the-art approaches to also map time constraints are Recurrent Neural Networks. But for now, we saw that this is also possible with very classical approaches like the HMM.", "For more information, you can visit my website and add me in the social media I linked there. I would be happy if you give me a clap on this blog post :).", "[1] Julian Fierrez et. al., HMM-based on-line signature verification: Feature extraction and signature modeling (2007), Science Direct[2] Margit Antal, L\u00e1szl\u00f3 Zsolt Szab\u00f3 and T\u00fcnde Tordai, Online Signature Verification on MOBISIG Finger-Drawn Signature Corpus (2017), Hindawi[3] Julian Fierrez et. al., An On-Line Signature Verification System Based on Fusion of Local and Global Information (2005), Springer", "This blog post is based from knowledge gained through the course Pattern Analysis from the Friedrich Alexander University Erlangen-N\u00fcrnberg. I used some parts of the lecture from Dr. Christian Riess to illustrate the examples for this post. So all rights go to Dr. Christian Riess.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8808cbd05699&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8808cbd05699--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8808cbd05699--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mavengence.medium.com/?source=post_page-----8808cbd05699--------------------------------", "anchor_text": ""}, {"url": "https://mavengence.medium.com/?source=post_page-----8808cbd05699--------------------------------", "anchor_text": "Tim L\u00f6hr"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9295fa5a2499&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&user=Tim+L%C3%B6hr&userId=9295fa5a2499&source=post_page-9295fa5a2499----8808cbd05699---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8808cbd05699&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8808cbd05699&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/de/users/thedigitalartist-202249/", "anchor_text": "TheDigitalArtist"}, {"url": "http://www.pixabay.com", "anchor_text": "Pixabay"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0167865507002395", "anchor_text": "HMM-Based On-Line Signature Verification"}, {"url": "https://en.wikipedia.org/wiki/Hidden_Markov_model#/media/File:HMMGraph.svg", "anchor_text": "Wikipedia"}, {"url": "https://ms.sapientia.ro/~manyi/mobisig.html", "anchor_text": "mobisig"}, {"url": "https://www.hindawi.com/journals/misy/2018/3127042/", "anchor_text": "Online Signature Verification on MOBISIG Finger-Drawn Signature Corpus"}, {"url": "https://hmmlearn.readthedocs.io/en/latest/", "anchor_text": "hmmlearn"}, {"url": "https://hmmlearn.readthedocs.io/en/latest/api.html#hmmlearn.hmm.GMMHMM", "anchor_text": "hmmlearn"}, {"url": "https://timloehr.me/", "anchor_text": "website"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0167865507002395", "anchor_text": "HMM-based on-line signature verification: Feature extraction and signature modeling"}, {"url": "http://www.sciencedirect.com", "anchor_text": "Science Direct"}, {"url": "https://www.hindawi.com/journals/misy/2018/3127042/", "anchor_text": "Online Signature Verification on MOBISIG Finger-Drawn Signature Corpus"}, {"url": "http://www.hindawi.com", "anchor_text": "Hindawi"}, {"url": "https://link.springer.com/chapter/10.1007/11527923_54", "anchor_text": "An On-Line Signature Verification System Based on Fusion of Local and Global Information"}, {"url": "https://link.springer.com/", "anchor_text": "Springer"}, {"url": "https://medium.com/tag/biometrics?source=post_page-----8808cbd05699---------------biometrics-----------------", "anchor_text": "Biometrics"}, {"url": "https://medium.com/tag/hmm?source=post_page-----8808cbd05699---------------hmm-----------------", "anchor_text": "Hmm"}, {"url": "https://medium.com/tag/python?source=post_page-----8808cbd05699---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/gaussian-mixture-model?source=post_page-----8808cbd05699---------------gaussian_mixture_model-----------------", "anchor_text": "Gaussian Mixture Model"}, {"url": "https://medium.com/tag/handwriting?source=post_page-----8808cbd05699---------------handwriting-----------------", "anchor_text": "Handwriting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8808cbd05699&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&user=Tim+L%C3%B6hr&userId=9295fa5a2499&source=-----8808cbd05699---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8808cbd05699&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&user=Tim+L%C3%B6hr&userId=9295fa5a2499&source=-----8808cbd05699---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8808cbd05699&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8808cbd05699--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8808cbd05699&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8808cbd05699---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8808cbd05699--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8808cbd05699--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8808cbd05699--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8808cbd05699--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8808cbd05699--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8808cbd05699--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8808cbd05699--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8808cbd05699--------------------------------", "anchor_text": ""}, {"url": "https://mavengence.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mavengence.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tim L\u00f6hr"}, {"url": "https://mavengence.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "26 Followers"}, {"url": "https://www.linkedin.com/in/tim-l%C3%B6hr-821ba8188/", "anchor_text": "https://www.linkedin.com/in/tim-l%C3%B6hr-821ba8188/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9295fa5a2499&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&user=Tim+L%C3%B6hr&userId=9295fa5a2499&source=post_page-9295fa5a2499--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F9295fa5a2499%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiometric-signal-verification-of-handwriting-with-hmms-8808cbd05699&user=Tim+L%C3%B6hr&userId=9295fa5a2499&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}