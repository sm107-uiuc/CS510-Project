{"url": "https://towardsdatascience.com/understanding-rnns-recurrent-neural-networks-479cd0da9760", "time": 1683001812.3291361, "path": "towardsdatascience.com/understanding-rnns-recurrent-neural-networks-479cd0da9760/", "webpage": {"metadata": {"title": "Understanding RNNs (Recurrent Neural Networks) | by Tony Yiu | Towards Data Science", "h1": "Understanding RNNs (Recurrent Neural Networks)", "description": "The first time I heard of a RNN (Recurrent Neural Network), I was perplexed. The article I read was claiming that a RNN is a neural net with memory \u2014 that it could remember the sequential ups and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/understanding-neural-networks-19020b758230", "anchor_text": "then you should start with my Understanding Neural Networks post.", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/understanding-neural-networks-19020b758230", "anchor_text": "please take a second and read my previous blog on neural nets", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/how-much-analysis-is-too-much-e1dfc5b37cbb", "anchor_text": "How Much Analysis Is Too Much", "paragraph_index": 28}, {"url": "https://tonester524.medium.com/membership", "anchor_text": "https://tonester524.medium.com/membership", "paragraph_index": 30}], "all_paragraphs": ["The first time I heard of a RNN (Recurrent Neural Network), I was perplexed. The article I read was claiming that a RNN is a neural net with memory \u2014 that it could remember the sequential ups and downs of the data in order to make more informed predictions.", "My first thought back then was \u2014 how is a RNN different from a linear regression with many lags (an autoregressive model)? Turns out a RNN is not only a lot different but also more versatile and more powerful.", "But before we add it to our forecasting toolkit, we should do our best to develop an intuitive understanding of how it works \u2014 starting with how an RNN is able to remember the past. Let\u2019s find out.", "A RNN is a neural network that works best on sequential data. If you are unfamiliar with neural nets, then you should start with my Understanding Neural Networks post. Going forward in this article, I will assume that the reader has a basic understanding of what a neural net is and how one works.", "What\u2019s sequential data \u2014 it is data where the order matters. Some examples of sequential data include stock prices and interest rates (ordered by time), the words in a blog post (the order of the words convey context and meaning), or the average temperature for each day (ordered by time).", "Usually with sequential data we want to predict what\u2019s coming next. For example, we might want to forecast what the temperature will be tomorrow or whether a stock\u2019s price will be higher or lower next month.", "The simplest forecast that I can think of is an AR(1) model (an autoregressive model with a single lag) where you simply use the previous observation to attempt to forecast the next one. Let\u2019s use stock returns as our example:", "An AR(1) model would have the following equation:", "This should look familiar as it\u2019s the equation for a line (Y = mX + B). The picture below depicts our AR(1) model in more detail. Let\u2019s go through it piece by piece:", "You don\u2019t need to have been around the market for very long to know that this is not a good model. Stock prices can move for various reasons (company fundamentals, economic shocks, investor fear/euphoria) or sometimes no reason at all. So we shouldn\u2019t expect a simple AR(1) model to do a good job.", "Rather we should look further beyond just the most recent observation and consider the entire sequence (really we should be considering data beyond price movements, but that is a story for another day). RNNs allow us to do just that.", "Before we dive into RNNs, one question an alert reader might have is \u201cWhy not just increase the number of lags in our autoregressive model?\u201d That is instead of using a single lag, why not use something like AR(20), which forecasts next month\u2019s return using the 20 most recent monthly returns. The answer is twofold:", "Let us recreate our AR(1) model using a neural net neuron. Nothing complicated here \u2014 recall that a singular neuron (if you are unfamiliar with neurons, please take a second and read my previous blog on neural nets) takes an input, multiplies it by a weight (m), and adds a bias (B) to it. Those are exactly the operations of a single variable linear regression, which is what an AR(1) model is. Note that we are neglecting the activation function here to simplify the explanation.", "Now let\u2019s think about how we can add memory to this model. What is memory in the case of a quantitative model? There\u2019s no 100% correct answer, but in my opinion, memory is the ability to draw from relevant past experiences in order to aid decision making. In modeling terms, we want the model to be dynamic \u2014 in other words, we want it to be able to shift according to its read of the situation (based on its past experiences).", "Our AR(1) model might be trained with historical data (recall that we fed it the last 20 years of Apple\u2019s monthly stock returns), but it definitely doesn\u2019t have memory. The AR(1) model equally weights each data point that we give it when estimating the regression parameters m and B. Thus, it is not able to decide which data points are more relevant and which are less (the regression parameters are static, once estimated). It is static, not dynamic.", "Finally it\u2019s time to give our model memory. It actually requires just a simple trick. Notice the additions at the bottom in the picture below:", "The key addition is that we are now taking in the previous output, Output(t-1), multiplying it against a new parameter u, and adding it to what we previously had. So our updated equation looks like:", "Or with a more general notation:", "So why exactly does this constitute memory? To see why, we need to jump ahead a bit and first understand how an RNN analyzes data. Here\u2019s some Python pseudocode for how an RNN generates its predictions:", "OK, now let\u2019s walk through the code:", "Take note of a few key things:", "Let\u2019s write out the equation (using simpler notation) to make sure we understand everything. I will call the output at time t, O(t), and the input, X(t). Let\u2019s write out O(3):", "We can also write out O(2):", "See how the output at time t=3 includes previous parameters (u_2, m_2, and B_2) \u2014 these parameters are how the RNN made its decisions at time t=2 and they have now been passed on to the current iteration of the model. If we wanted to, we could expand O(1) as well to see that the parameters from time t=1 are included as well.", "Recall that we defined model memory as being dynamic and able to shift based on the situation. The RNN can do that now \u2014 by including past snapshots of itself via its previous output, the RNN acquires access to its historical parameters and can, as the situation requires, decide whether or not to include them in its decision making process.", "I learned a great deal writing this post. Previously I knew at a very high level how RNNs worked, but I always wanted to better understand what people meant when they said that RNNs had memory. I hope you understand it better now too.", "Our work is not yet finished though. Theoretically RNNs should be able to masterfully harness past experience to make decisions. But in reality, they suffer from something called the vanishing gradient problem. In a future post, we will explore why this is so and how an augmented RNN called a LSTM helps us get around this problem. Until then, cheers!", "More Data Science and Business Related Posts By Me:", "How Much Analysis Is Too Much", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist. Founder Alpha Beta Blog. Doing my best to explain the complex in plain English. Support my writing: https://tonester524.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F479cd0da9760&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----479cd0da9760--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----479cd0da9760--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tonester524.medium.com/?source=post_page-----479cd0da9760--------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=post_page-----479cd0da9760--------------------------------", "anchor_text": "Tony Yiu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F840a3210fbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&user=Tony+Yiu&userId=840a3210fbe7&source=post_page-840a3210fbe7----479cd0da9760---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F479cd0da9760&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F479cd0da9760&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@stayandroam?utm_source=medium&utm_medium=referral", "anchor_text": "Gemma Evans"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/understanding-neural-networks-19020b758230", "anchor_text": "then you should start with my Understanding Neural Networks post."}, {"url": "https://towardsdatascience.com/understanding-neural-networks-19020b758230", "anchor_text": "please take a second and read my previous blog on neural nets"}, {"url": "https://towardsdatascience.com/business-strategy-for-data-scientists-25e3ca0af5ee", "anchor_text": "Business Strategy For Data Scientists"}, {"url": "https://towardsdatascience.com/how-much-analysis-is-too-much-e1dfc5b37cbb", "anchor_text": "How Much Analysis Is Too Much"}, {"url": "https://towardsdatascience.com/business-simulations-with-python-a70d6cba92c8", "anchor_text": "Business Simulations With Python"}, {"url": "https://towardsdatascience.com/understanding-pca-fae3e243731d?source=post_page---------------------------", "anchor_text": "Understanding PCA"}, {"url": "https://towardsdatascience.com/understanding-bayes-theorem-7e31b8434d4b", "anchor_text": "Understanding Bayes\u2019 Theorem"}, {"url": "https://towardsdatascience.com/understanding-the-naive-bayes-classifier-16b6ee03ff7b", "anchor_text": "Understanding The Naive Bayes Classifier"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----479cd0da9760---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----479cd0da9760---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----479cd0da9760---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----479cd0da9760---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----479cd0da9760---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F479cd0da9760&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&user=Tony+Yiu&userId=840a3210fbe7&source=-----479cd0da9760---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F479cd0da9760&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&user=Tony+Yiu&userId=840a3210fbe7&source=-----479cd0da9760---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F479cd0da9760&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----479cd0da9760--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F479cd0da9760&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----479cd0da9760---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----479cd0da9760--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----479cd0da9760--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----479cd0da9760--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----479cd0da9760--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----479cd0da9760--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----479cd0da9760--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----479cd0da9760--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----479cd0da9760--------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tony Yiu"}, {"url": "https://tonester524.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "102K Followers"}, {"url": "https://tonester524.medium.com/membership", "anchor_text": "https://tonester524.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F840a3210fbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&user=Tony+Yiu&userId=840a3210fbe7&source=post_page-840a3210fbe7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F78d3e392d884&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-rnns-recurrent-neural-networks-479cd0da9760&newsletterV3=840a3210fbe7&newsletterV3Id=78d3e392d884&user=Tony+Yiu&userId=840a3210fbe7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}