{"url": "https://towardsdatascience.com/feature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317", "time": 1683001481.274923, "path": "towardsdatascience.com/feature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317/", "webpage": {"metadata": {"title": "Feature selection by filtering: what could go wrong? (Spoiler: A lot) | by Alex daSilva | Towards Data Science", "h1": "Feature selection by filtering: what could go wrong? (Spoiler: A lot)", "description": "Working with data sets that have far more features than number of observations is now common place across many fields from computer science to psychology. This is commonly referred to as the \u201cp > n\u201d\u2026"}, "outgoing_paragraph_urls": [{"url": "https://bookdown.org/max/FES/selection.html", "anchor_text": "overview", "paragraph_index": 2}, {"url": "https://web.stanford.edu/~hastie/Papers/ESLII.pdf", "anchor_text": "Elements of Statistical Learning", "paragraph_index": 3}, {"url": "https://www.pnas.org/content/99/10/6562.full", "anchor_text": "paper", "paragraph_index": 3}, {"url": "https://web.stanford.edu/~hastie/Papers/ESLII.pdf", "anchor_text": "ESL", "paragraph_index": 4}, {"url": "https://web.stanford.edu/~hastie/Papers/ESLII.pdf", "anchor_text": "ESL", "paragraph_index": 9}, {"url": "https://www.linkedin.com/in/alex-w-dasil/", "anchor_text": "https://www.linkedin.com/in/alex-w-dasil/", "paragraph_index": 15}], "all_paragraphs": ["Working with data sets that have far more features than number of observations is now common place across many fields from computer science to psychology. This is commonly referred to as the \u201cp > n\u201d problem (where p = the number features and n = number of observations), the \u201ccurse of dimensionality\u201d, or my personal favorite, working with \u201cshort fat data\u201d.", "Traditional methods, like linear regression, break down under these conditions. We can observe this in a toy example where we trim down the \u201cmtcars\u201d dataset to make # of rows < # of columns. When trying to calculate beta coefficients, we run into singularity problems.", "A common strategy to deal with this issue is to perform feature selection where the aim is to find a meaningful subset of features to use in model construction. There are many different ways to carry out feature selection (for a summary check out this overview). Here, we are going to focus on what might be the simplest variant, feature selection with a univariate filter. As with other feature selection strategies, the aim of a univariate filter is to find a subset of features relevant to the outcome. This can be accomplished in a very straightforward fashion by correlating features with the outcome and only selecting those that meet a certain threshold (e.g., absolute value of r > .10).", "As noted in the Elements of Statistical Learning (ESL) and in a 2002 paper, many published works have performed feature selection incorrectly. No doubt, this will continue to be an issue as p > n data continues to become more common in areas of biology, social science, and health as researchers grapple with larger data sets. It\u2019s really not surprising why filtering is commonly done incorrectly, at first thought, there doesn\u2019t seem to be anything wrong with simply removing features in your data set unrelated to your outcome.", "To illustrate how feature selection by filtering can be done incorrectly and correctly we\u2019ll first generate a short, fat data set where our predictors are largely unrelated to our dependent variable, \u201cy\u201d. In regards to model fitting, we\u2019ll essentially be following along with ESL pages 245\u2013247 and coding through an example to see how those figures may come about. First things first, let\u2019s generate some mostly orthogonal data.", "Now that we have data, I\u2019ll illustrate how to incorrectly filter the data by screening the data outside of cross validation. That is, by taking the entire data set, keeping features that are correlated with the outcome at or above r = .1, and subsequently building a model. For 100 iterations, we\u2019ll split this data set into train and test sets and examine the distribution of the correlations between the observed and predicted values.", "Overall the models look great, with a mean correlation between the observe and predicted of around .5. The only problem is, the simulated data are largely independent, the average correlation should be around 0! We\u2019ve introduced bias by choosing variables based on all of the data. Implementing a validation scheme after variable selection does not accurately portray the application of a model to a truly independent test data set. Now let\u2019s observe how to do perform selection by filtering correctly.", "When correctly performing univariate filtering, feature selection happens in the outer cross validation loop while model tuning happens during the inner loop. If what I mentioned earlier about the sample being biased is true, we should expect to see a similar high correlation during the inner validation loop but a total local lack of generalization to the outer loop and the subsequent left out sample.", "We\u2019ll use a function in caret, SBF (selection by filtering), to implement this. The specification of the outer validation loop that controls the filtering is done in \u201csbfControl\u201d while the parameter tuning is specified as normal in \u201ctrainControl\u201d. For continuous outcomes and features, caret utilizes generalized additive models to relate the outcome to each feature - a nice touch that may pick up on non-linear relationships. A p-value from each of these models is used as the filtering criterion. The default is set at p = .05 which means that features will only be retained if they have a significant relationship with the outcome at this level.", "As expected, we see a strong relationship in the inner training loop, but observe essentially orthogonal predictions (average r right around 0) in the outer training loop and when we finally fit our model on the left-out data. If you check out page 246 of ESL, you\u2019ll notice a similar pattern of results.", "Finally, just as a quality assurance check, we\u2019ll compare our results to a regularized model (a type of model with added parameter(s) to prevent overfitting) which should give us almost identical results to the correct univariate filtering approach.", "As Expected, the average r right is right around 0.", "Before closing, we\u2019ll look at one last quick visual to view the correct filtering, the incorrect filtering, and the glmnet model side by side noting how strongly incorrect filtering can bias predictions.", "In sum, if you do decide to use univariate filtering for feature screening make sure to perform the feature selection in a cross validation scheme and NOT on the entire data set. Doing so will result in features that have already \u201cwitnessed\u201d the left out data, and thus do not effectively simulate applying a model to a true test set. One thing to note is that this doesn\u2019t necessarily apply to screening features without taking the outcomes into account. For example, dropping features that: are highly correlated with each other, contain no variance, or are a linear combination of some other set of features. Finally, depending on your needs, it\u2019s also worth keeping in mind that there are many regularized methods that guard against overfitting and/or perform feature selection intrinsically that may be better options (and faster) than any wrapper or filter method for feature selection.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Social Science and Data Science Nerd | PhD Candidate in Psychological and Brain Sciences at Dartmouth College | https://www.linkedin.com/in/alex-w-dasil/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5d3bab16317&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d3bab16317--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d3bab16317--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@awdasilva21?source=post_page-----5d3bab16317--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awdasilva21?source=post_page-----5d3bab16317--------------------------------", "anchor_text": "Alex daSilva"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff71073bbf3b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&user=Alex+daSilva&userId=f71073bbf3b3&source=post_page-f71073bbf3b3----5d3bab16317---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d3bab16317&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d3bab16317&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://bookdown.org/max/FES/selection.html", "anchor_text": "overview"}, {"url": "https://web.stanford.edu/~hastie/Papers/ESLII.pdf", "anchor_text": "Elements of Statistical Learning"}, {"url": "https://www.pnas.org/content/99/10/6562.full", "anchor_text": "paper"}, {"url": "https://web.stanford.edu/~hastie/Papers/ESLII.pdf", "anchor_text": "ESL"}, {"url": "https://web.stanford.edu/~hastie/Papers/ESLII.pdf", "anchor_text": "ESL"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5d3bab16317---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/statistics?source=post_page-----5d3bab16317---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5d3bab16317---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----5d3bab16317---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----5d3bab16317---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d3bab16317&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&user=Alex+daSilva&userId=f71073bbf3b3&source=-----5d3bab16317---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d3bab16317&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&user=Alex+daSilva&userId=f71073bbf3b3&source=-----5d3bab16317---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d3bab16317&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d3bab16317--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5d3bab16317&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5d3bab16317---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d3bab16317--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5d3bab16317--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5d3bab16317--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5d3bab16317--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5d3bab16317--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5d3bab16317--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5d3bab16317--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5d3bab16317--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awdasilva21?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awdasilva21?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alex daSilva"}, {"url": "https://medium.com/@awdasilva21/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "82 Followers"}, {"url": "https://www.linkedin.com/in/alex-w-dasil/", "anchor_text": "https://www.linkedin.com/in/alex-w-dasil/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff71073bbf3b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&user=Alex+daSilva&userId=f71073bbf3b3&source=post_page-f71073bbf3b3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ff71073bbf3b3%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-by-filtering-what-could-go-wrong-spoiler-a-lot-5d3bab16317&user=Alex+daSilva&userId=f71073bbf3b3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}