{"url": "https://towardsdatascience.com/you-should-care-about-bootstrapping-ced0ffff2434", "time": 1683011259.0582259, "path": "towardsdatascience.com/you-should-care-about-bootstrapping-ced0ffff2434/", "webpage": {"metadata": {"title": "Bootstrapping and bagging 101 | Towards Data Science", "h1": "Bootstrapping and bagging 101", "description": "Bootstrapping methods are used to gain an understanding of the probability distribution for a statistic rather than taking it on face value."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Law_of_large_numbers", "anchor_text": "Weak Law of Large Numbers", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Convergence_of_random_variables", "anchor_text": "Convergence in Probability", "paragraph_index": 8}, {"url": "https://math.stackexchange.com/questions/731992/convergence-in-probability-of-sample-variance", "anchor_text": "here", "paragraph_index": 11}], "all_paragraphs": ["Bootstrapping methods are used to gain an understanding of the probability distribution for a statistic rather than taking it on face value. The underlying principle of bootstrapping relies on resampling a dataset with replacement. Here we\u2019ll take a look at the maths of why it works and how it can be used to estimate model parameters in the case of a simple linear regression model.", "Imagine we have a dataset that looks like a linear relationship between x and y but when we observe the values of y, we do so with the addition of noise.", "Where \u03b5 is drawn from a random distribution N(0,\u03c3\u00b2).", "Using maximum likelihood estimation we can analytically find an estimate for both a and b, let\u2019s called these estimates \u00e2 and b\u0302. Not only can we find a form for the values but we can also calculate the variance of the estimators.", "The variance of an estimator is always an important thing to know as it provides a confidence for the point estimate. In the case of a Gaussian noise regression model like this, we find that the distribution for the estimates \u00e2 and b\u0302 is also Gaussian. This distribution is fully defined by its mean and variance.", "In this simple linear regression model, the variance of a is \u03c3\u00b2/(n\u03c3_x) where \u03c3_x is the variance of x.", "The aim of bootstrapping is to also create confidence intervals for parameters or statistics. This is achieved by creating a number of new datasets by assuming that the observed data is the true data distribution. This means we can sample with replacement from that distribution to create a new dataset. This can be used to train a model or calculate a statistic in the same way that we would do normally but the difference is that we repeat this a large number of times, each time with a new resampled dataset.", "The benefit of this is there is no need to analytically calculate the distribution of the parameter or statistic, you can simply empirically work out the distribution using the different sampled datasets that were used to fit to the model.", "Bootstrapping works for two main reasons, the first is the Weak Law of Large Numbers (WLLN) and the Convergence in Probability.", "Firstly, the WLLN states for a random variable X_i, drawn from a distribution X, the empirical mean of the n samples of X_i will converge to the exception of X (E(X)) as n tends to infinity. More formally:", "However, the WLLN assumes you make that each estimate is made independently and identically distributed (iid), which no longer holds if you sample with replacement. This would be true if you had an infinite amount of data, sub-divided into smaller parts and used each sub-devision to calculate the parameter values. However, in the limit, as the size of the dataset becomes large the two situations become equivalent \u2014 empirically we know it works well for smaller datasets too.", "Secondly, the convergence of probability means that the empirical variance of samples converges on the distribution variance (shown very well here).", "Let\u2019s have a look at a basic example of fitting a linear line of best fit to a basic dataset.", "Not we build our bootstrapping function:", "This simple function assumes that the first dimension is the dimension that relates to the number of data points i.e (M x F) where F is the number of features. It then randomly chooses M x n_trials indexes and returns a reshaped, sampled version of the original data. This now has the shape n_trials x M x F.", "Now, let's fit a linear line of best fit to each bootstrapped version of the data:", "So now we have our distribution of alpha and beta parameters for a model \u0177 = \u00e2x + b\u0302 + N(0,\u03c3_hat)", "The mean value each of \u00e2, b\u0302, \u03c3_hat for the example came out to be 2.15, -9.28 and 9.58 compared to how the data was generated with values of 2, -10 and 10 so we got pretty good estimates but were we within the confidence intervals? Well each parameter has a standard deviation of 0.20, 1.11 and 0.69, so we\u2019re well within the one standard deviation of the mean!", "We can also look at the distribution of parameters as well as point statistics like means and standard deviations.", "Remember before we worked out the theoretical variance for \u00e2, for this data, this would yield a value of 0.037 compared to our estimated variance 0.041, not bad considering we didn\u2019t have to do any analysis!", "We can also use each of the values for \u00e2 and b\u0302 to make predictions. Of the predicted points we can also take the 95th and 5th percentile and plot them for each value of x.", "So now we can make predictions with a 90% confidence interval. We wouldn\u2019t be able to do that if we just a single prediction for \u00e2 and b\u0302.", "Bagging is a very related concept to bootstrapping, it involves the same resampling method to train multiple models.", "The most common application of bagging is applied to decision tree classifiers/ regressors. Shallow decision trees have a variance problem as they are highly dependent on the data that they were trained with (splits in features space are made between features and the order that you make spits can change the classier drastically).", "So how do we combat this? If we train a large number of trees each with a resampled dataset and take the average prediction then the overall variance of the resultant classifier is reduce.", "To demonstrate this we can train a forest and a tree with sklearn and see the results.", "If we predict on the test set with the single tree and a forest we get:", "We can see that the variance of the predictions is drastically reduces as we predicted.", "For an excellent lecture about bagging and bootstrapping I recommend this lecture from Cornell University.", "We look at the fundamental concepts of bootstrapping and why it\u2019s a useful skill to keep in the tool belt of any data scientist. We hopefully understand how it works, how we can implement it in Numpy and how we can use it to model the distribution of parameters rather than modelling them as single values. We also introduced the concept of bagging and how it can be applied to increase the performance of classifiers that suffer from a variance problem.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist trying to learn something new"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fced0ffff2434&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alexanderbailey?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": "Alexander Bailey"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb3e72c9d461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&user=Alexander+Bailey&userId=db3e72c9d461&source=post_page-db3e72c9d461----ced0ffff2434---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fced0ffff2434&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fced0ffff2434&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/brown-shoes-lace-up-shoes-1150071/", "anchor_text": "Free-photos on pixabay"}, {"url": "https://en.wikipedia.org/wiki/Law_of_large_numbers", "anchor_text": "Weak Law of Large Numbers"}, {"url": "https://en.wikipedia.org/wiki/Convergence_of_random_variables", "anchor_text": "Convergence in Probability"}, {"url": "https://math.stackexchange.com/questions/731992/convergence-in-probability-of-sample-variance", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Random_forest", "anchor_text": "wikipedia"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ced0ffff2434---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ced0ffff2434---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ced0ffff2434---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----ced0ffff2434---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ced0ffff2434---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fced0ffff2434&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&user=Alexander+Bailey&userId=db3e72c9d461&source=-----ced0ffff2434---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fced0ffff2434&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&user=Alexander+Bailey&userId=db3e72c9d461&source=-----ced0ffff2434---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fced0ffff2434&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fced0ffff2434&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ced0ffff2434---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ced0ffff2434--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ced0ffff2434--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ced0ffff2434--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ced0ffff2434--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexander Bailey"}, {"url": "https://medium.com/@alexanderbailey/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "156 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb3e72c9d461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&user=Alexander+Bailey&userId=db3e72c9d461&source=post_page-db3e72c9d461--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff756d91c4fbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-care-about-bootstrapping-ced0ffff2434&newsletterV3=db3e72c9d461&newsletterV3Id=f756d91c4fbd&user=Alexander+Bailey&userId=db3e72c9d461&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}