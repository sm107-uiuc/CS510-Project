{"url": "https://towardsdatascience.com/statistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9", "time": 1683017361.9229498, "path": "towardsdatascience.com/statistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9/", "webpage": {"metadata": {"title": "Statistical modeling with \u201cPomegranate\u201d \u2014fast and intuitive | by Tirthajyoti Sarkar | Towards Data Science", "h1": "Statistical modeling with \u201cPomegranate\u201d \u2014fast and intuitive", "description": "Pomegranate is a delicious fruit. It can also be a super useful Python library for statistical analysis. We will show how in this article."}, "outgoing_paragraph_urls": [{"url": "https://pomegranate.readthedocs.io/en/latest/index.html", "anchor_text": "a Python package", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Bayesian_network", "anchor_text": "Bayesian networks", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Hidden_Markov_model", "anchor_text": "Hidden Markov Models", "paragraph_index": 2}, {"url": "https://github.com/tirthajyoti/Stats-Maths-with-Python/blob/master/Pomegranate.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 20}, {"url": "https://github.com/tirthajyoti/Stats-Maths-with-Python/blob/master/Pomegranate.ipynb", "anchor_text": "Notebook", "paragraph_index": 23}, {"url": "https://github.com/jmschrei/pomegranate/tree/master/tutorials", "anchor_text": "Pomegranate Tutorials from their Github repo", "paragraph_index": 37}, {"url": "https://github.com/tirthajyoti?tab=repositories", "anchor_text": "GitHub", "paragraph_index": 39}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "add me on LinkedIn", "paragraph_index": 39}, {"url": "https://twitter.com/tirthajyotiS", "anchor_text": "follow me on Twitter", "paragraph_index": 39}], "all_paragraphs": ["First and foremost, it is a delicious fruit.", "But there is a double delight for fruit-lover data scientists!", "It is also a Python package that implements fast and flexible probabilistic models ranging from individual probability distributions to compositional models such as Bayesian networks and Hidden Markov Models.", "The central idea behind this package is that all probabilistic models can be viewed as a probability distribution. That means they all yield probability estimates for samples and can be updated/fitted given samples and their associated weights. The primary consequence of this realization is that the implemented classes can be stacked and chained more flexibly than those available from other common packages.", "This is a fair question. However, you will see that the implemented classes in the Pomegranate package are super intuitive and have uniform interfaces although they cover a wide range of statistical modeling aspects,", "It is like having useful methods from multiple Python libraries together with a uniform and intuitive API.", "Let us see some cool usage of this nifty little package.", "Let is initialize with a NormalDistribution class.", "We can, now, easily check the probability of a sample data point (or an array of them) belonging to this distribution,", "This is where it gets more interesting. Fitting with a data sample is super easy and fast.", "As initialized above, we can check the parameters (mean and std. dev) of the n1 object. We expect them to be 5.0 and 2.0.", "Now, let us create some synthetic data by adding random noise to a Gaussian.", "We can fir this new data to the n1 object and then check the estimated parameters.", "Phew! It looks like that n1 has updated its estimated mean and std.dev parameters to match with the input data now. The peak of the histogram is close to 4.0 from the plot and that\u2019s what the estimated mean shows.", "We showed how to fit data to a distribution class. Alternatively, one can create the object directly from the data,", "Plotting is easy on the distribution class with the `plot()` method, which also supports all the keywords for a Matplotlib histogram method. We illustrate by plotting a Beta distribution object.", "This is where it gets more interesting. Instead of passing parameters to a known statistical distribution (e.g. Normal or Beta), you can pass in a dictionary where keys can be any objects and values are the corresponding probabilities.", "Here is an illustration with some Hogwarts characters. Note, when we try to calculate the probability of \u2018Hagrid\u2019, we get a flat zero because the distribution does not have any finite probability for the \u2018Hagrid\u2019 object.", "We can do much more interesting things by fitting data to a discrete distribution object. Here is an example with a fictitious DNA nucleic acid sequence. It is common to have this type of sequence data in a string, and we can read the data and calculate the probabilities of the four nucleic acids in the sequence with simple code.", "We can write an extremely simple (and naive) DNA sequence matching application in just a few lines of code. The assumption is that the sequences, which have similar frequencies/probabilities of nucleic acids, are closer to each other. Somewhat arbitrarily, we choose to calculate the root-mean-square-distance for this distance metric.", "You can look at the Jupyter notebook for the helper function and the exact code, but here is a sample output.", "Pomegranate makes working with data, coming from multiple Gaussian distributions, easy.", "As usual, we can create a model directly from the data with one line of code. When we print the estimated parameters of the model, we observe that it has captured the ground truth (the parameters of the generator distributions) pretty well.", "Once the model is generated with data samples, we can calculate the probabilities and plot them easily. The code is in the Notebook, here is the illustrative plot \u2014 the left side shows a single Gaussian, and the right-side shows a Mixture Model.", "We can easily model a simple Markov chain with Pomegranate and calculate the probability of any given sequence.", "We will have the quintessential rainy-cloudy-sunny example for this one. Here is the transition probability table,", "We also know that, on average, there are 20% rainy days, 50% sunny days, and 30% cloudy days. We encode both the discrete distribution and the transition matrix in the MarkovChain class,", "Now, we can calculate the probability of any given sequence using this object. For example, if you look at the table above, you can convince yourself that a sequence like \u201cCloudy-Rainy-Cloudy\u201d has a high likelihood whereas a sequence like \u201cRainy-Sunny-Rainy-Sunny\u201d is unlikely to show up. We can confirm this with precise probability calculations (we take logarithm to handle small probability numbers),", "We write a small function to generate a random sequence of rainy-cloudy-sunny days and feed that to the GMM class.", "First, we feed this data for 14 days\u2019 observation\u2014 \u201cRainy-Sunny-Rainy-Sunny-Rainy-Sunny-Rainy-Rainy-Sunny-Sunny-Sunny-Rainy-Sunny-Cloudy\u201d. The probability transition table is calculated for us.", "If we generate a random sequence of 10 years i.e. 3650 days, then we get the following table. Because our random generator is uniform, as per the characteristic of a Markov Chain, the transition probabilities will assume limiting values of ~0.333 each.", "There are a lot of cool things you can do with the HMM class in Pomegranate. Here, we just show a small example of detecting the high-density occurrence of a sub-sequence within a long string using HMM predictions.", "Let\u2019s say we are recording the names of four characters in a Harry Potter novel as they appear one after another in a chapter, and we are interested in detecting some portion where Harry and Dumbledore are appearing together. However, because they may be conversing and may mention Ron or Hagrid\u2019s names in these portions, the sub-sequence is not clean i.e. it does not strictly contain Harry and Dumbledore\u2019s names.", "Following code initiates a uniform probability distribution, a skewed probability distribution, two states with names, and the HMM model with these states.", "Then, we need to add the state transition probabilities and \u2018bake\u2019 the model for finalizing the internal structure. Note the high self-loop probabilities for the transition i.e. the states tend to stay in their current state with high likelihood.", "Now, we have an observed sequence and we will feed this to the HMM model as an argument to the predict method. The transition and emission probabilities will be calculated and a sequence of 1\u2019s and 0\u2019s will be predicted where we can notice the island of 0\u2019s indicating the portion rich with the appearance of \u2018Harry-Dumbledore\u2019 together.", "In this article, we introduced a fast and intuitive statistical modeling library called Pomegranate and showed some interesting usage examples. Many more tutorials can be found here. Examples in this article were also inspired by these tutorials.", "Pomegranate Tutorials from their Github repo", "The library offers utility classes from various statistical domains \u2014 general distributions, Markov chain, Gaussian Mixture Models, Bayesian networks \u2014 with uniform API that can be instantiated quickly with observed data and then can be used for parameter estimation, probability calculations, and predictive modeling.", "You can check the author\u2019s GitHub repositories for code, ideas, and resources in machine learning and data science. If you are, like me, passionate about AI/machine learning/data science, please feel free to add me on LinkedIn or follow me on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sr. Director of AI/ML platform | Stories on Artificial Intelligence, Data Science, and ML | Speaker, Open-source contributor, Author of multiple DS books"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4d605d9c33a9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a----4d605d9c33a9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d605d9c33a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d605d9c33a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/pomegranate-fruit-seeds-food-fresh-3259161/", "anchor_text": "Pixabay"}, {"url": "https://pomegranate.readthedocs.io/en/latest/index.html", "anchor_text": "a Python package"}, {"url": "https://en.wikipedia.org/wiki/Bayesian_network", "anchor_text": "Bayesian networks"}, {"url": "https://en.wikipedia.org/wiki/Hidden_Markov_model", "anchor_text": "Hidden Markov Models"}, {"url": "https://github.com/tirthajyoti/Stats-Maths-with-Python/blob/master/Pomegranate.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://github.com/tirthajyoti/Stats-Maths-with-Python/blob/master/Pomegranate.ipynb", "anchor_text": "Notebook"}, {"url": "https://github.com/jmschrei/pomegranate/tree/master/tutorials", "anchor_text": "Pomegranate Tutorials from their Github repo"}, {"url": "https://github.com/tirthajyoti?tab=repositories", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "add me on LinkedIn"}, {"url": "https://twitter.com/tirthajyotiS", "anchor_text": "follow me on Twitter"}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "Tirthajyoti Sarkar - Sr. Principal Engineer - Semiconductor, AI, Machine Learning - ON\u2026Making data science/ML concepts easy to understand through writing: https://medium.com/@tirthajyoti Open-source and\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4d605d9c33a9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----4d605d9c33a9---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----4d605d9c33a9---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/statistics?source=post_page-----4d605d9c33a9---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----4d605d9c33a9---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d605d9c33a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----4d605d9c33a9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d605d9c33a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----4d605d9c33a9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d605d9c33a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4d605d9c33a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4d605d9c33a9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4d605d9c33a9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/@tirthajyoti/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb285331282ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstatistical-modeling-with-pomegranate-fast-and-intuitive-4d605d9c33a9&newsletterV3=cb9d97d4b61a&newsletterV3Id=b285331282ca&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}