{"url": "https://towardsdatascience.com/precision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538", "time": 1683002607.185706, "path": "towardsdatascience.com/precision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538/", "webpage": {"metadata": {"title": "Precision, Recall and Predicting Cervical Cancer with Machine Learning | by Giovanni Rosati | Towards Data Science", "h1": "Precision, Recall and Predicting Cervical Cancer with Machine Learning", "description": "Machine Learning is commonly described as a subset of artificial intelligence and in general, involves creating \u201cmodels\u201d that can analyze data in a variety of ways to make predictions. It has proven\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Cervical+cancer+%28Risk+Factors%29#", "anchor_text": "link", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/dealing-with-missing-data-17f8b5827664?source=friends_link&sk=5ecf67f2141e50bcd47dc37b33e96deb", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://github.com/giorosati/dsc-3-final-project-online-ds-pt-100118", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://archive.ics.uci.edu/ml/datasets/Cervical+cancer+%28Risk+Factors%29", "anchor_text": "https://archive.ics.uci.edu/ml/datasets/Cervical+cancer+%28Risk+Factors%29#", "paragraph_index": 51}], "all_paragraphs": ["Machine Learning is commonly described as a subset of artificial intelligence and in general, involves creating \u201cmodels\u201d that can analyze data in a variety of ways to make predictions. It has proven itself useful in countless areas, including such commonly known applications as \u201crecommendation engines\u201d that suggest content a user would like based on \u201clearning\u201d from that user's past behavior. As part of my journey into data science, I wrote and tested several machine learning models to make predictions using a dataset of information about women, and where a biopsy was performed to determine if cervical cancer was present.", "The dataset was obtained from the University of California at Irvine (UCI) Machine Learning Repository at this link. The information was collected at \u2018Hospital Universitario de Caracas\u2019 in Caracas, Venezuela and comprises 35 factors that include demographic information, habits, and historic medical records of 858 patients. Several patients chose not to answer some of the questions because of privacy concerns (missing values). I previously wrote a brief article about dealing with missing data here. The dataset comes from a research paper first published online in May of 2017.", "The objective of this project was to develop a machine learning model(s) that can, as best as possible, predict the presence of cervical cancer using 35 variables of possible risk factors for each woman. A challenge when developing prediction models with this type of data is the balance between precision and recall:", "Because not \u201ccapturing\u201d even one case of cancer could result in death, the models should place emphasis on the recall score. It is far preferable to not \u201cmiss\u201d anyone with cancer even if that means \u201cflagging\u201d some patients as having cancer that actually do not have the disease.", "Another challenge with creating predictive models using this type of data is that positive cases (cancer is present) are typically a small proportion of the total patients in a dataset. This creates what is referred to as an \u201cunbalanced\u201d dataset, ie. there is an unequal number of individuals in the two classes we are trying to predict. Unbalanced data makes prediction more difficult for machine learning models because there are fewer \u201cpositive\u201d (cancer is present) cases to learn from compared to the negative (no cancer) cases. With unbalanced data like this a prediction model can easily obtain a very high recall at the expense of precision, and vice-versa. For example, imagine a dataset of 1,000 patients where 10 individuals have cancer, a very realistic scenario:", "The goal for a predictive model in this scenario is to identify as high a percentage as possible of the cancer cases with as few as possible \u201cfalse positives\u201d (prediction of cancer but in fact no cancer).", "Each model I test will be evaluated by looking at recall first and foremost, and then the F1 score, which is a measurement reflecting an equally balanced weighting of both precision and recall:", "My approach to developing the models followed the OSEMN protocol:", "This project was developed in a Jupyter notebook using data science packages from scikit-learn as well as a few other sources which are noted in the notebook. The notebook and all necessary files to run it can be obtained at my GitHub repository here.", "After initializing the notebook and loading the dataset into a Pandas dataframe, I looked at the types of values it contained and what factors were missing information. During the dataframe import phase, I filled all missing values with NumPy \u201cNaN\u201d. Here\u2019s an overview of the data showing variables missing values in red:", "Despite the relatively small percentage of missing values in some factors I did not want to lose any information that may be present in these factors:", "I created new boolean factors to distinguish between records where the information was known and where no data was given. These new factors have a value of true (1) if the record had a value and a value of false (0) if the record was missing data for that factor:", "For this purpose, I wrote a function to create a new column from an existing column:", "Here\u2019s an example of how each new factor (column) was created using this function:", "The three original factors also had missing values and I dealt with them later along with all the other missing values.", "Dealing with the \u201choles\u201d in the data", "I created a function to display a count plot, a boxplot, and some summary statistics for a given factor so that I could get a better sense of that factors distribution:", "After evaluating each factor I made a decision on how best to deal with the missing values. Here\u2019s an example of the flow for the \u2018First sexual intercourse\u2019 factor, which represents the age of the woman when she first experienced sexual intercourse. I ran the above function passing that column name:", "By looking at these two plots it\u2019s evident that the distribution is somewhat normal with a long \u201ctail\u201d at the high end of the range. It\u2019s also significant that less than 1% of values are missing for this factor so whatever I fill the missing values with will have a minimal impact on the models. I chose to fill the missing values here with the median.", "I continued through each factor replacing missing values with either zero, the mean, or the median, but a few factors required some additional thought:", "Over 90% of the patients had no value for these factors. I could have simply deleted these factors \u2014 machine learning models can\u2019t handle missing values \u2014 but I didn\u2019t want to lose the information in the 10% of patients that did have value for these factors. I noticed that the \u201cparent\u201d factor \u2018STDs: Number of diagnosis\u2019 was also missing the same number of values. My assumption is that the women declined to answer this question and these two related questions. I chose to fill the missing values in all three factors with zero:", "I encountered a similar situation with the \u2018STD\u2019s (number)\u2019 factor. Again I ran my function to visualize the data:", "Here the values are overwhelmingly zero and about 12% are missing. As zero was so dominant in the distribution for this factor, I felt replacing the missing values with zero was the best choice. Additionally, each of the 12 individual boolean factors, each for a different STD, had about 12% missing values. I replaced the missing values in all of the individual boolean \u201cSTD\u201d factors with zero as well.", "After filling all the missing values a correlation heatmap revealed that two factors had no information at all:", "I dropped these factors from the database and then ran a correlation heatmap for how each factor individually related to the target variable \u201cBiopsy\u201d.", "This heatmap suggests that by themselves the factors:", "The next step was to split the data into training and testing sets:", "I used 80% of the data for training and specified a random_state to ensure reproducibility.", "The non-boolean factors in this dataset:", "have very different ranges. I standardized each factors\u2019 values (making each factor\u2019s range from zero to 1) so that the machine learning algorithm doesn\u2019t bias any of the factors simply because it has a larger range. The relationship stayed constant between the values for each patient for a given factor, but now every factor shares the same scale. This prevents a different scale between factors biasing a models\u2019 evaluation of that factor\u2019s importance. It\u2019s important to note that standardization (or normalization) is done separately to the training and testing datasets. I don\u2019t want to give the model any insights into the data that it will be tested on. The model must only learn from the test set.", "As discussed previously this is an \u201cunbalanced\u201d dataset with only about 10% of the records having a \u201cTrue\u201d value for the target variable. Some machine learning models have built-in functionality to compensate for this and some do not. I tested a package from imbalanced-learn called SMOTE (Synthetic Minority Over-sampling Technique) to create a balanced dataset \u2014 where there is an equal number of True and False target variable records. This is only done on the training data, not on the testing data. Here\u2019s the syntax for creating this resampled training data:", "Looking at the difference in the original data and the resampled data:", "608 \u201cfictitious\u201d records (1,294 minus 686) were created to \u201cbalance\u201d the dataset. These new records were created to be similar to the existing records where the target variable was True.", "Now I can test any model with both the original \u2018unbalanced\u2019 dataset or the resampled \u2018balanced\u2019 dataset. I found that the logistic regression and KNN models performed better when given this resampled training data, but that the decision tree, random forest, and support vector machine (SVM) models did better using the original unbalanced data but implementing their own built-in class weight parameters.", "For convenience in testing each model, I created a function that would return the information I wanted to see regarding each model\u2019s performance:", "The GridSearchCV method was utilized to search for optimal parameters with most of the models I tested. Here\u2019s an example of using GridSearchCV with a random forest classifier:", "In this example, \u2018class_weight\u2019 was set to \u2018balanced\u2019 to let the random forest implement its built-in methods that adjust for the unbalanced data it is being trained on. I then fit the model using the test data:", "GridSearchCV found that the following parameter values worked best:", "Based on this information, I re-ran another GridSearchCV to further refine the parameter values:", "A new random forest was created using these values, and then predictions were made using the testing data:", "Here are the results from this optimized random forest:", "This model was able to \u201cfind\u201d 88% of the women with cancer (recall), and 67% of its predictions of cancer were correct (precision).", "To see what features this model was using I used a feature importance chart. The red bars represent the importance of each feature, and the black line on top of each red bar represents the standard deviation of how important that feature was among all trees.", "Interestingly, the \u2018Age\u2019 factor was as roughly as important as the \u2018Citology\u2019 factor, a diagnostic test.", "One advantage of decision trees and random forests is their interpretability. Here\u2019s a graph showing how the best performing, single decision tree from this project works:", "This tree is only using these factors:", "to classify every patient. The random forest model uses 15 factors in 10 different trees to achieve slightly better performance. (see the Jupyter notebook to view all of the trees).", "After tuning and testing all the models I explored, here are the best results for each type of model:", "The random forest model, using the original unbalanced data, performed the best, followed closely by the decision tree model.", "In a future post, I intend to explore if a neural network predictive model can improve on these F1 and recall scores.", "Thanks for reading. I\u2019m always interested in learning how data science can, and is, making the world work better for everyone. If you know a situation where data science is \u201cmaking a difference\u201d please share!", "Kelwin Fernandes, Jaime S. Cardoso, and Jessica Fernandes. \u2018Transfer Learning with Partial Observability Applied to Cervical Cancer Screening.\u2019 Iberian Conference on Pattern Recognition and Image Analysis. Springer International Publishing, 2017. https://archive.ics.uci.edu/ml/datasets/Cervical+cancer+%28Risk+Factors%29#", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F367221e70538&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----367221e70538--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----367221e70538--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@giorosati?source=post_page-----367221e70538--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@giorosati?source=post_page-----367221e70538--------------------------------", "anchor_text": "Giovanni Rosati"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2f0d24cc1dc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&user=Giovanni+Rosati&userId=2f0d24cc1dc5&source=post_page-2f0d24cc1dc5----367221e70538---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F367221e70538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F367221e70538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Cervical+cancer+%28Risk+Factors%29#", "anchor_text": "link"}, {"url": "https://towardsdatascience.com/dealing-with-missing-data-17f8b5827664?source=friends_link&sk=5ecf67f2141e50bcd47dc37b33e96deb", "anchor_text": "here"}, {"url": "https://commons.wikimedia.org/w/index.php?curid=36926283", "anchor_text": "Precisionrecall.svgFrom Wikimedia Commons, the free media repositorycommons.wikimedia.org"}, {"url": "https://github.com/giorosati/dsc-3-final-project-online-ds-pt-100118", "anchor_text": "here"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Cervical+cancer+%28Risk+Factors%29", "anchor_text": "https://archive.ics.uci.edu/ml/datasets/Cervical+cancer+%28Risk+Factors%29#"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----367221e70538---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/medical-diagnosis?source=post_page-----367221e70538---------------medical_diagnosis-----------------", "anchor_text": "Medical Diagnosis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F367221e70538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&user=Giovanni+Rosati&userId=2f0d24cc1dc5&source=-----367221e70538---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F367221e70538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&user=Giovanni+Rosati&userId=2f0d24cc1dc5&source=-----367221e70538---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F367221e70538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----367221e70538--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F367221e70538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----367221e70538---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----367221e70538--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----367221e70538--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----367221e70538--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----367221e70538--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----367221e70538--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----367221e70538--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----367221e70538--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----367221e70538--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@giorosati?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@giorosati?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Giovanni Rosati"}, {"url": "https://medium.com/@giorosati/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "http://linkedin.com/in/giorosati", "anchor_text": "http://linkedin.com/in/giorosati"}, {"url": "http://github.com/giorosati", "anchor_text": "http://github.com/giorosati"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2f0d24cc1dc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&user=Giovanni+Rosati&userId=2f0d24cc1dc5&source=post_page-2f0d24cc1dc5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F75a6602626f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-recall-and-predicting-cervical-cancer-with-machine-learning-367221e70538&newsletterV3=2f0d24cc1dc5&newsletterV3Id=75a6602626f2&user=Giovanni+Rosati&userId=2f0d24cc1dc5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}