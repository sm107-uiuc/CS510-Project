{"url": "https://towardsdatascience.com/how-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71", "time": 1683016946.791264, "path": "towardsdatascience.com/how-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71/", "webpage": {"metadata": {"title": "How to build your own AutoML library in Python from scratch | by Gianluca Malato | Towards Data Science", "h1": "How to build your own AutoML library in Python from scratch", "description": "AutoML libraries and services have already entered the world of machine learning. They are very useful tools for a Data Scientist, but sometimes they must be adapted to fit the needs of the business\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/gianlucamalato/machinelearning/blob/master/Your_own_AutoML.ipynb", "anchor_text": "GitHub repository", "paragraph_index": 9}, {"url": "http://YourDataTeacher.com", "anchor_text": "YourDataTeacher.com", "paragraph_index": 32}], "all_paragraphs": ["AutoML libraries and services have already entered the world of machine learning. They are very useful tools for a Data Scientist, but sometimes they must be adapted to fit the needs of the business context a Data Scientist work in. That\u2019s why you would need to build your own AutoML library.", "Let\u2019s see how to do it in Python.", "An AutoML library is any piece of software that automates some of the hardest (and boring) parts of a machine learning pipeline. Despite doing all these tasks manually, using AutoML will speed the machine learning process avoiding the risk of mistakes.", "An AutoML library must automatically perform these actions:", "The idea is that an AutoML library tries all the combinations of these parameters, measuring the average model performance using k-fold cross-validation and selecting the best set of values. So, it\u2019s an optimization procedure in a grid of settings.", "In this article, I\u2019m going to cover only a classification pipeline using this grid of settings:", "Each model comes with its own hyperparameters, that must be optimized together with the pre-processing parameters. So, the idea is that all these parameters become the hyperparameters of a large machine learning pipeline that includes pre-processing and the models. Even the model itself becomes a hyperparameter of this pipeline. So, we have translated our problem into a hyperparameter optimization problem, that we can solve.", "The pipeline hyperparameter space is very large, so we are going to use a random search to find the best set of values of such hyperparameters.", "Our object will take a Pandas dataframe in input for training purposes and its \u201cfit\u201d method will perform the required optimization to find the best model and the best settings for the pre-processing phase.", "We are going to create an object called MyAutoMLClassifier and we\u2019re going to train and test it on the breast cancer dataset. You can find the whole code on my GitHub repository.", "Now, we can start defining the MyAutoMLClassifier class. Its constructor will accept a scoring function that will be used in k-fold CV and the number of iterations of the random search. For this example, their default values will be \u201cbalanced accuracy\u201d and 50.", "Now we can start building the \u201cfit\u201d method, that is the most important one.", "First, we have to detect the distinct values of the categorical variables in order to apply one-hot encoding.", "Now we have to define a pre-processing pipeline for the categorical variables. This pipeline will clean the blanks using the most frequent value and will one-hot encode them.", "At the same time, we are going to define a pipeline for the numerical variables, that will be cleaned according to a parameter that will be defined later and scaled according to a scaler that we\u2019ll decide in the random search part.", "Everything is finally included in the ColumnTransformer settings, that will perform all the pre-processing part.", "Finally, we have to define the ML pipeline, that is built by the pre-processing phase, the feature selection and the model itself. We can set the model to LogisticRegression at the moment; it will be changed later by random search.", "Then, we can calculate the number of the features (we\u2019ll need it for the feature selection part) and create an empty list that will contain the optimization grid according to the syntax needed by RandomSearchCV.", "Now we can start adding models to our optimization grid.", "As we can see, we are creating an object that will change the scaling among RobustScaler, StandardScaler and MinMaxscaler. Then will change the cleaning strategy among mean and median and will select the features from 1 to the total number of features with steps of 5. Finally, the model itself is set. The random search will check random combinations of this grid, searching for the one that maximizes the performance metrics in cross-validation.", "We can now add other models with their own pre-processing needs and hyperparameters. For example, trees don\u2019t require any scaling, but SVM do.", "We can add as many models as we want, optimizing their hyperparameters in the same grid.", "So, we are searching for the best combination of cleaning strategy, scaling procedure, set of features, model and hyperparameters\u2019 values, everything in the same search procedure. This is the core of any AutoML library and can be extended as you want.", "We have now a complete optimization grid, so we can finally apply the random search to find the best pipeline parameters and save the results in some properties of our object. The random search will apply a 5-fold cross-validation with the scoring function and the number of iterations we have chosen in the class constructor.", "We can now add the \u201cpredict\u201d and \u201cpredict_proba\u201d methods just like any other sklearn model and our MyAutoMLClassifier is complete.", "We can now import our dataset, split it into training and test, create an instance of MyAutoMLClassifier and fit it.", "With just the last line of code, we make all the difficult stuff of AutoML.", "Once the model is fitted, we can calculate the balanced accuracy in the test set and see which model and pre-processing parameters have been selected:", "As you can see, we are using a Gradient Boosting Tree Classifier with all the features and a numerical cleaning strategy based on the median value. The learning rate of the model is 0.1 and the number of estimators is 125. This is the result of AutoML.", "AutoML libraries are very useful tools for a Data Scientist and can actually make us save a lot of time. According to the business context we work on, we may need to work only with certain models or cleaning procedures, so we need our customized version of AutoML.", "The example showed in this article can be easily adapted to a regression problem and can be integrated with other models like neural networks.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Theoretical Physicists, Data Scientist and fiction author. I teach Data Science, statistics and SQL on YourDataTeacher.com. E-mail: gianluca@gianlucamalato.it"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F995940f3fa71&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----995940f3fa71--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----995940f3fa71--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://gianlucamalato.medium.com/?source=post_page-----995940f3fa71--------------------------------", "anchor_text": ""}, {"url": "https://gianlucamalato.medium.com/?source=post_page-----995940f3fa71--------------------------------", "anchor_text": "Gianluca Malato"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f015e9ee21d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&user=Gianluca+Malato&userId=1f015e9ee21d&source=post_page-1f015e9ee21d----995940f3fa71---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F995940f3fa71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F995940f3fa71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lazycreekimages?utm_source=medium&utm_medium=referral", "anchor_text": "Michael Dziedzic"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/gianlucamalato/machinelearning/blob/master/Your_own_AutoML.ipynb", "anchor_text": "GitHub repository"}, {"url": "https://medium.com/tag/data-science?source=post_page-----995940f3fa71---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----995940f3fa71---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----995940f3fa71---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----995940f3fa71---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----995940f3fa71---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F995940f3fa71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&user=Gianluca+Malato&userId=1f015e9ee21d&source=-----995940f3fa71---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F995940f3fa71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&user=Gianluca+Malato&userId=1f015e9ee21d&source=-----995940f3fa71---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F995940f3fa71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----995940f3fa71--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F995940f3fa71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----995940f3fa71---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----995940f3fa71--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----995940f3fa71--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----995940f3fa71--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----995940f3fa71--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----995940f3fa71--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----995940f3fa71--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----995940f3fa71--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----995940f3fa71--------------------------------", "anchor_text": ""}, {"url": "https://gianlucamalato.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://gianlucamalato.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gianluca Malato"}, {"url": "https://gianlucamalato.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "http://YourDataTeacher.com", "anchor_text": "YourDataTeacher.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f015e9ee21d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&user=Gianluca+Malato&userId=1f015e9ee21d&source=post_page-1f015e9ee21d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fadb09bc451d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-your-own-automl-library-in-python-from-scratch-995940f3fa71&newsletterV3=1f015e9ee21d&newsletterV3Id=adb09bc451d&user=Gianluca+Malato&userId=1f015e9ee21d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}