{"url": "https://towardsdatascience.com/introducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2", "time": 1683013512.943635, "path": "towardsdatascience.com/introducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2/", "webpage": {"metadata": {"title": "Introducing \u201cWalk Backward\u201d: A Novel Approach to Predicting the Future | by Samuele Mazzanti | Towards Data Science", "h1": "Introducing \u201cWalk Backward\u201d: A Novel Approach to Predicting the Future", "description": "These questions may be answered with machine learning. But \u2014 whereas questions 1 and 4 concern things that exist already (a picture, a sentence) \u2014 questions 2 and 3 regard future events, namely\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Concept_drift", "anchor_text": "concept drift", "paragraph_index": 2}, {"url": "http://www.rogermstein.com/wp-content/uploads/BenchmarkingDefaultPredictionModels_TR030124.pdf", "anchor_text": "this article", "paragraph_index": 14}, {"url": "https://www.youtube.com/watch?v=Psxktpxkc6o", "anchor_text": "going back and forth in time on a DeLorean", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/Autoregressive%E2%80%93moving-average_model", "anchor_text": "ARMA process", "paragraph_index": 32}, {"url": "https://github.com/smazzanti/walk-backward", "anchor_text": "this notebook", "paragraph_index": 42}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib", "paragraph_index": 43}, {"url": "https://www.codecogs.com/latex/eqneditor.php", "anchor_text": "codecogs", "paragraph_index": 43}, {"url": "https://www.linkedin.com/in/samuelemazzanti/", "anchor_text": "my Linkedin contact", "paragraph_index": 45}], "all_paragraphs": ["These questions may be answered with machine learning. But \u2014 whereas questions 1 and 4 concern things that exist already (a picture, a sentence) \u2014 questions 2 and 3 regard future events, namely events that haven\u2019t happened yet. Is this relevant? Indeed, it is.", "In fact, we all know \u2014 first as human beings, then as data scientists \u2014 that predicting the future is hard.", "From a technical point of view, this is due to concept drift, which is a very intuitive notion: phenomena change over time. Since the phenomenon we want to foresee is constantly changing, using a model (which learnt on the past) to predict the future poses additional challenges.", "In this post, I am going to describe three machine learning approaches that may be used for predicting the future, and how they deal with such challenges.", "In the first part of the article, we will go through the three approaches. In the second part, we will try them on data and see which one works best.", "Suppose today is October 1, 2020, and you want to predict the probability that the customers of your company will churn in the next month (i.e. from today to October 31).", "Here is how this problem is addressed in most data science projects:", "Note: information contained in X can go back in time indefinitely (however, in all the figures \u2014 for the sake of visual intuition \u2014 it goes back only 4 months).", "This approach is called \u201cIn-Time\u201d, because all the datasets (train, validation and test) are taken from the same timepoint (in this case, September). By train, validation and test set, we intend:", "Now that you gathered the data, you fit a predictive model (let\u2019s say an Xgboost) on the train set (September). Performance on the test set is the following: a precision of 50% with a recall of 60%. Since you are happy with this outcome, you decide to communicate this result to stakeholders and make the forecast on October.", "One month later, you go and check how your model actually did in October. A nightmare. A precision of 20% with a recall of 25%. How is that possible? You did everything right. You validated your model. Then you tested it. Why do test performance and observed performance differ so drastically?", "The problem is that concept drift is completely disregarded by the In-Time approach. In fact, this hypothesis is implicitly made:", "In this framework, it doesn\u2019t really matter when the model is trained, because f(\u03b8) is assumed to be constant over time. Unfortunately, what happens, in reality, is different. In fact, concept drift makes f(\u03b8) change over time. In formula, this would translate to:", "To take into account this effect, we need to move our mindset from in-time to out-of-time.", "One form of out-of-time \u2014 mostly used in finance \u2014 is called Walk-Forward (read this article by Roger Stein to know more). This name comes from the fact that the model is validated and/or tested forward in time with respect to the data used for training. Visually:", "This configuration has the advantage that it simulates the real usage of the model. In fact, the model is trained on t (August), and evaluated in t+1 (September). Therefore, this is a good proxy of what can be expected by training in September and making predictions on October.", "However, when I tried this approach on real data, I noticed it suffers from some major drawbacks:", "To sum up, I liked the idea of going out-of-time, but it seemed to me that Walk-Forward was not worth it.", "Then, this idea came to my mind: could it be that concept drift is in some way \u201cconstant\u201d over time? In other words, could it be that predicting 1 month forward or 1 month backward leads on average to the same performance?", "If that was the case, I would have killed two birds (no, wait, three birds) with one stone. In fact, I would have kept the benefits of:", "In short, I would have kept the advantages of each approach, while getting rid of their drawbacks. This is how I arrived to the following configuration:", "I\u2019ve called it \u201cWalk-Backward\u201d because it does the exact opposite of Walk-Forward: training is made on the latest data, whereas validation and testing are made on previous time windows.", "I know it may seem crazy to train a model in September (and validate it in July), then check how it performed in August, and even expect this is a good estimate of how it will do in October! This probably looks like as if we are going back and forth in time on a DeLorean, but I promise I\u2019ve got a good explanation.", "\u2026 then there is a philosophical explanation of why Walk-Backward makes sense. Let\u2019s break it down.", "\u2026 then, maybe, you like numbers. In that case, I can reassure you: I tried this approach on a real use-case and, compared to In-Time and Walk-Forward, Walk-Backward obtained:", "Basically, everything a data scientist can ask for.", "It\u2019s ok, I\u2019m a skeptical guy too! This is why we will try In-Time, Walk-Foward and Walk-Backward on some data, and see which one will perform best.", "To do that, we will use simulated data. Simulating data is a convenient way for reproducing concept drift \u201cin the lab\u201d and for making the results replicable. In this way, it will be possible to check whether the superiority of Walk-Backward is confirmed in a more general setting.", "Let\u2019s take 12 timepoints (monthly data from January 2020 to December 2020). Say that, each month, 50 features have been observed on 5,000 individuals. This means 12 dataframes (X_1, \u2026, X_12), each one with 5,000 rows and 50 columns. To keep things simple, the columns are generated from a normal distribution:", "Once X is available, we need y (dependent, or target, variable). Out of simplicity, y will be a continuous variable (but the results could be easily extended to the case in which y is discrete).", "A linear relationship is assumed between X and y:", "\u03b2s are indexed by t because parameters change constantly over time. This is how we account for concept drift in our simplified version of the world.", "In particular, \u03b2s change according to an ARMA process. This means that the fluctuations of \u03b2(i) are not totally random: they depend on the past values of \u03b2(i) itself.", "ARMA\u2019s coefficients (and error) are chosen based on the conservative assumption that fluctuations from month to month are not so huge (note that a more aggressive hypothesis would have favored out-of-time approaches). In particular, let\u2019s take AR coefficient to be -0.3, MA coefficient 0.3 and standard deviation of the error 0.5. These are the resulting trajectories for the first 6 (out of 50) \u03b2s.", "And this is how the target variables (y) look like:", "Now that we have the data, the three approaches can be compared.", "Since this is a regression problem (y is a continuous variable), mean absolute error (MAE) has been chosen as metric.", "To make the results more reliable, each approach has been carried out on all the timepoints (in a \u201csliding window\u201d fashion). Then, the outcomes have been averaged over all the timepoints.", "Typically, the most important indicator of a predictive model\u2019s goodness is the performance observed on y_future. From this point of view, Walk-Backward is the best approach, since it delivers the best MAE (3.98).", "But there\u2019s more than that. Take a look at In-Time: MAE(test) is on average 2.91, while MAE(future) is 4.20. Thus, in a real-world use case, you would communicate to stakeholders that you expect your model to deliver a MAE of 2.91. But the actual performance that you will observe one month later is on average 4.19. It\u2019s a huge difference (and a huge disappointment)!", "Indeed, the absolute difference between test performance and future performance is on average three times higher for In-Time than for Walk-Backward (1.28 versus 0.43). So, Walk-Backward turns out to be by far the best approach (also) from this perspective.", "Note that, in a real-world use case, this aspect is maybe even more important than performance itself. In fact, being able to anticipate the actual performance of a model \u2014 without having to wait the end of the following period \u2014 is crucial for allocating resources and for planning actions.", "Results are fully reproducible. Python code is available in this notebook.", "All images created by author, through matplotlib (for plots) or codecogs (for Latex formulas).", "Thank you for reading! I hope you found this post useful.", "I appreciate feedback and constructive criticism. If you want to talk about this article or other related topics, you can text me at my Linkedin contact.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Data Scientist | Striving for simplicity."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc7cf9e15e9e2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03----c7cf9e15e9e2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7cf9e15e9e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7cf9e15e9e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Concept_drift", "anchor_text": "concept drift"}, {"url": "http://www.rogermstein.com/wp-content/uploads/BenchmarkingDefaultPredictionModels_TR030124.pdf", "anchor_text": "this article"}, {"url": "https://www.youtube.com/watch?v=Psxktpxkc6o", "anchor_text": "going back and forth in time on a DeLorean"}, {"url": "https://en.wikipedia.org/wiki/Autoregressive%E2%80%93moving-average_model", "anchor_text": "ARMA process"}, {"url": "https://github.com/smazzanti/walk-backward", "anchor_text": "this notebook"}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib"}, {"url": "https://www.codecogs.com/latex/eqneditor.php", "anchor_text": "codecogs"}, {"url": "https://www.linkedin.com/in/samuelemazzanti/", "anchor_text": "my Linkedin contact"}, {"url": "https://medium.com/tag/predictive-modeling?source=post_page-----c7cf9e15e9e2---------------predictive_modeling-----------------", "anchor_text": "Predictive Modeling"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c7cf9e15e9e2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c7cf9e15e9e2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c7cf9e15e9e2---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/concept-drift?source=post_page-----c7cf9e15e9e2---------------concept_drift-----------------", "anchor_text": "Concept Drift"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7cf9e15e9e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----c7cf9e15e9e2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7cf9e15e9e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----c7cf9e15e9e2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7cf9e15e9e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc7cf9e15e9e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c7cf9e15e9e2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c7cf9e15e9e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/@mazzanti.sam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce90f5bea5f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-walk-backward-a-novel-approach-to-predicting-the-future-c7cf9e15e9e2&newsletterV3=e16f3bb86e03&newsletterV3Id=ce90f5bea5f9&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}