{"url": "https://towardsdatascience.com/recommendation-system-in-python-lightfm-61c85010ce17", "time": 1683004237.9108238, "path": "towardsdatascience.com/recommendation-system-in-python-lightfm-61c85010ce17/", "webpage": {"metadata": {"title": "Recommendation System in Python: LightFM | by Shashank Kapadia | Towards Data Science", "h1": "Recommendation System in Python: LightFM", "description": "A recommender system, or a recommendation system, is a subclass of information filtering system that seeks to predict the best \u201crating\u201d or \u201cpreference\u201d a user would give to an item [1]. The notion\u2026"}, "outgoing_paragraph_urls": [{"url": "https://making.lyst.com/lightfm/docs/home.html", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://github.com/kapadias/mediumposts/blob/master/recommender/published_notebooks/recommendation_python_lightfm.ipynb", "anchor_text": "Jupyter Notebook on GitHub", "paragraph_index": 16}, {"url": "https://github.com/aayushmnit", "anchor_text": "Aayush Agrawal", "paragraph_index": 36}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py", "anchor_text": "here", "paragraph_index": 36}, {"url": "https://www.google.com/url?q=https%3A%2F%2Fgithub.com%2FMengtingWan%2Fmengtingwan.github.io%2Fraw%2Fmaster%2Fpaper%2Frecsys18_mwan.pdf&sa=D&sntz=1&usg=AFQjCNGGcNRW1tSZKPWO0yZsr8mj7MkWuw", "anchor_text": "Item Recommendation on Monotonic Behavior Chains", "paragraph_index": 41}, {"url": "https://www.google.com/url?q=https%3A%2F%2Fwww.aclweb.org%2Fanthology%2FP19-1248&sa=D&sntz=1&usg=AFQjCNG8xlMi09lyuzzMI8lCW58wrBEGsQ", "anchor_text": "Fine-Grained Spoiler Detection from Large-Scale Review Corpora", "paragraph_index": 42}, {"url": "https://www.linkedin.com/in/shashankkapadia/", "anchor_text": "LinkedIn", "paragraph_index": 43}], "all_paragraphs": ["A recommender system, or a recommendation system, can be thought of as a subclass of information filtering system that seeks to predict the best \u201crating\u201d or \u201cpreference\u201d a user would give to an item which is typically obtained by optimizing for objectives like total clicks, total revenue, and overall sales.", "So, what is the basic principle that underlies the working of recommendation algorithms?", "The basic principle of recommendations is that there are significant dependencies between user- and item-centric activity. For example, a user who is interested in hotels in New York City is more likely to be interested in other NYC hotels, rather than in Boston.", "While the primary business goal of any recommender system is to provide users\u2019 with a personalized experience; from the problem setting standpoint, we can broadly classify recommenders into two categories:", "Broadly speaking, most recommender systems leverage two types of data:", "The modeling approach relying on the former data are generally known Collaborative Filtering method, and approach using the later are referred to as Content Base Filtering method. There is also another category known as Knowledge-Based recommender system that is based on explicitly specified user requirements.", "Of course, each of these methods has its strengths and weaknesses depending on which applications they are used for, and the amount of data available.", "Hybrid Systems are then used to combined the advantages of these approaches to have a robust performing system across a wide variety of applications.", "Memory-based methods also referred to as neighborhood-based collaborative filtering algorithms, where ratings of user-item combinations are predicted based on their neighborhoods. These neighborhoods can be further defined as (1) User Based, and (2) Item Based", "In Model-based methods, ML techniques are used to learn model parameters within the context of a given optimization framework", "There is more to different types of approaches, and nuances of each; if you are interested in learning more, I would highly recommend the Statistical Methods for Recommender Systems book by Deepak Agarwal.", "There are many open-source recommender system frameworks and libraries available across different languages that can help you get started with your first implementation of the recommendation model.", "For this article, we\u2019ll explore one of them that I have found valuable in my work, and covers a wide variety of underlying algorithms for varied use-cases, known as LighFM", "LightFM is a Python implementation of several popular recommendation algorithms for both implicit and explicit feedback types.", "Importantly, it allows you to incorporate both item and user metadata into the traditional matrix factorization algorithms, making it possible to generalize to new items (via item features) and new users (via user features).", "To learn more about it, you can check its documentation here.", "The complete code is available as a Jupyter Notebook on GitHub", "For this tutorial, we\u2019ll use book reviews data by Goodreads. The datasets were collected in late 2017 from goodreads.com, where the data from users\u2019 public shelves was scraped, i.e., everyone can see it on the web without login. User IDs and review IDs are anonymized.", "The dataset is collected for academic use only. Please do not redistribute them or use for commercial purposes.", "There are three groups of datasets:", "These datasets can be merged together by matching book/user/review ids. For this tutorial, we\u2019ll be using only the former two.", "You can download the dataset using in this article from here:", "Let\u2019s start by inspecting the books\u2019 metadata information. To develop a reliable and robust ML model, it is essential to get a thorough understanding of the available data.", "As the first step, let\u2019s take a look at all the available fields, and sample data", "While all the available information is vital to extract contextual information to be able to train a better recommendation system, for this example, we\u2019ll only focus on the selected fields that require minimal manipulation.", "Now that we have the data with selected fields, next, we\u2019ll run it through pandas profiler to perform preliminary exploratory data analysis to help us better understand the available data", "Considering the results from the profiler, we\u2019ll perform following transformations to the dataset:", "As the first step, let\u2019s take a look at all the available fields, and sample data", "Limit the data to only the selected fields", "Considering the results from the profiler, we\u2019ll convert is_read column to 1/0", "Since we have two fields denoting interaction between a user and a book, `is_read` and `rating` \u2014 let\u2019s see how many data points we have where the user hasn\u2019t read the book but have given the ratings.", "From the above results, we can conclusively infer that users with ratings >= 1 have all read the book. Therefore, we\u2019ll use the `ratings` as the final score, drop interactions where `is_read` is false, and limit interactions from random 5000 users to limit the data size for further analysis", "Now, let\u2019s transform the available data into CSR sparse matrix that can be used for matrix operations. We will start by the process by creating books_metadata matrix which is np.float64 csr_matrix of shape ([n_books, n_books_features]) \u2014 Each row contains that book\u2019s weights over features. However, before we create a sparse matrix, we\u2019ll first create an item dictionary for future references", "Next we\u2019ll create an iterations matrix which is np.float64 csr_matrix of shape ([n_users, n_books]). We\u2019ll also create a user dictionary for future use cases", "Ideally, we would build, train, and evaluate several models for our recommender system to determine which model holds the most promise for further optimization (hyper-parameter tuning).", "However, for this tutorial, we\u2019ll train the base model, with randomly selected input parameters for demonstrations.", "For getting back the top-n recommendations, we\u2019ll re-purpose the code by Aayush Agrawal here", "Machine learning has become increasingly popular over the past decade, and recent advances in computational availability have led to exponential growth to people looking for ways how new methods can be incorporated to advance the field of Recommendation Systems.", "Often, we treat the Recommendation System as black-box algorithms. Still, hopefully, this post addressed to shed light on the underlying math, and intuitions behind it, and high-level code to get you started with building your first recommendation model.", "In the next article, we\u2019ll go one step deeper into understanding how you can evaluate the performance of these models, tune its hyper-parameters to get more intuitive and reliable results.", "[2] Agarwal, Deepak K.. Statistical Methods for Recommender Systems. Cambridge University Press. Kindle Edition", "[4] Mengting Wan, Julian McAuley, \u201cItem Recommendation on Monotonic Behavior Chains\u201d, in RecSys\u201918", "[5] Mengting Wan, Rishabh Misra, Ndapa Nakashole, Julian McAuley, \u201cFine-Grained Spoiler Detection from Large-Scale Review Corpora\u201d, in ACL\u201919", "Thanks for reading. If you have any feedback, please feel to reach out by commenting on this post, messaging me on LinkedIn, or shooting me an email (shmkapadia[at]gmail.com)", "If you liked this article, read my other articles on NLP", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Manager @Monster Building scalable and operationalized ML solutions for data-driven products. My articles on Medium don\u2019t represent my employer."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F61c85010ce17&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----61c85010ce17--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----61c85010ce17--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shashank.kapadia?source=post_page-----61c85010ce17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shashank.kapadia?source=post_page-----61c85010ce17--------------------------------", "anchor_text": "Shashank Kapadia"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcc7314ace45c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&user=Shashank+Kapadia&userId=cc7314ace45c&source=post_page-cc7314ace45c----61c85010ce17---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F61c85010ce17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F61c85010ce17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.needpix.com/photo/642084/needle-hay-needle-in-a-haystack", "anchor_text": "https://www.needpix.com/photo/642084/needle-hay-needle-in-a-haystack"}, {"url": "https://medium.com/towards-data-science/in-depth-analysis/home", "anchor_text": "In-Depth Analysis"}, {"url": "https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.needpix.com%2Fphoto%2F18235%2Frating-stars-chart-poor-performance-result-statistical-success-symbols&psig=AOvVaw2TxYq_-XgJ5B65nDAszvSr&ust=1582730198563000&source=images&cd=vfe&ved=0CAIQjRxqFwoTCOiLz9D_7OcCFQAAAAAdAAAAABAE", "anchor_text": "Image Source"}, {"url": "https://www.google.com/url?sa=i&url=https%3A%2F%2Factionml.com%2Fblog%2Fpersonalized_search&psig=AOvVaw125Jk0lya25z8gCv9C4IwX&ust=1582412856268000&source=images&cd=vfe&ved=0CAIQjRxqFwoTCOCA-rXh4-cCFQAAAAAdAAAAABAJ", "anchor_text": "Image Source"}, {"url": "https://making.lyst.com/lightfm/docs/home.html", "anchor_text": "here"}, {"url": "https://github.com/kapadias/mediumposts/blob/master/recommender/published_notebooks/recommendation_python_lightfm.ipynb", "anchor_text": "Jupyter Notebook on GitHub"}, {"url": "https://drive.google.com/uc?id=1H6xUV48D5sa2uSF_BusW-IBJ7PCQZTS1", "anchor_text": "https://drive.google.com/uc?id=1H6xUV48D5sa2uSF_BusW-IBJ7PCQZTS1"}, {"url": "https://drive.google.com/uc?id=17G5_MeSWuhYnD4fGJMvKRSOlBqCCimxJ", "anchor_text": "https://drive.google.com/uc?id=17G5_MeSWuhYnD4fGJMvKRSOlBqCCimxJ"}, {"url": "https://github.com/aayushmnit", "anchor_text": "Aayush Agrawal"}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Recommender_system", "anchor_text": "https://en.wikipedia.org/wiki/Recommender_system"}, {"url": "https://www.google.com/url?q=https%3A%2F%2Fgithub.com%2FMengtingWan%2Fmengtingwan.github.io%2Fraw%2Fmaster%2Fpaper%2Frecsys18_mwan.pdf&sa=D&sntz=1&usg=AFQjCNGGcNRW1tSZKPWO0yZsr8mj7MkWuw", "anchor_text": "Item Recommendation on Monotonic Behavior Chains"}, {"url": "https://www.google.com/url?q=https%3A%2F%2Fwww.aclweb.org%2Fanthology%2FP19-1248&sa=D&sntz=1&usg=AFQjCNG8xlMi09lyuzzMI8lCW58wrBEGsQ", "anchor_text": "Fine-Grained Spoiler Detection from Large-Scale Review Corpora"}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py", "anchor_text": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py"}, {"url": "https://www.linkedin.com/in/shashankkapadia/", "anchor_text": "LinkedIn"}, {"url": "https://towardsdatascience.com/end-to-end-topic-modeling-in-python-latent-dirichlet-allocation-lda-35ce4ed6b3e0", "anchor_text": "Topic Modeling in Python: Latent Dirichlet Allocation (LDA)How to get started with topic modeling using LDA in Pythontowardsdatascience.com"}, {"url": "https://towardsdatascience.com/evaluate-topic-model-in-python-latent-dirichlet-allocation-lda-7d57484bb5d0", "anchor_text": "Evaluate Topic Models: Latent Dirichlet Allocation (LDA)A step-by-step guide to building interpretable topic modelstowardsdatascience.com"}, {"url": "https://medium.com/tag/in-depth-analysis?source=post_page-----61c85010ce17---------------in_depth_analysis-----------------", "anchor_text": "In Depth Analysis"}, {"url": "https://medium.com/tag/data-science?source=post_page-----61c85010ce17---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/recommendation-engine?source=post_page-----61c85010ce17---------------recommendation_engine-----------------", "anchor_text": "Recommendation Engine"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----61c85010ce17---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----61c85010ce17---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F61c85010ce17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&user=Shashank+Kapadia&userId=cc7314ace45c&source=-----61c85010ce17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F61c85010ce17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&user=Shashank+Kapadia&userId=cc7314ace45c&source=-----61c85010ce17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F61c85010ce17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----61c85010ce17--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F61c85010ce17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----61c85010ce17---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----61c85010ce17--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----61c85010ce17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----61c85010ce17--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----61c85010ce17--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----61c85010ce17--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----61c85010ce17--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----61c85010ce17--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----61c85010ce17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shashank.kapadia?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shashank.kapadia?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shashank Kapadia"}, {"url": "https://medium.com/@shashank.kapadia/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "556 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcc7314ace45c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&user=Shashank+Kapadia&userId=cc7314ace45c&source=post_page-cc7314ace45c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faaefd32c096f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecommendation-system-in-python-lightfm-61c85010ce17&newsletterV3=cc7314ace45c&newsletterV3Id=aaefd32c096f&user=Shashank+Kapadia&userId=cc7314ace45c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}