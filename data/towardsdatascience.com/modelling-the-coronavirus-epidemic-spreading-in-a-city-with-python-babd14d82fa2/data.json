{"url": "https://towardsdatascience.com/modelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2", "time": 1683003561.045743, "path": "towardsdatascience.com/modelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2/", "webpage": {"metadata": {"title": "Modelling the coronavirus epidemic in a city with Python | by Gevorg Yeghikyan | Towards Data Science", "h1": "Modelling the coronavirus epidemic in a city with Python", "description": "The recent 2019-nCoV Wuhan coronavirus outbreak in China has sent shocks through financial markets and entire economies, and has duly triggered panic among the general population around the world. On\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.udemy.com/course/covid-19-urban-epidemic-modelling-in-python/?referralCode=220EF2D17E80758E78B5", "anchor_text": "this online course", "paragraph_index": 0}, {"url": "https://skl.sh/30Vdq7J", "anchor_text": "this one", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Novel_coronavirus_(2019-nCoV)", "anchor_text": "2019-nCoV Wuhan coronavirus", "paragraph_index": 1}, {"url": "https://www.bbc.com/news/world-51318246", "anchor_text": "designated", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Basic_reproduction_number", "anchor_text": "basic reproduction number", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Small-world_network", "anchor_text": "small world network", "paragraph_index": 1}, {"url": "https://www.nature.com/articles/s41467-019-12809-y", "anchor_text": "shown", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology#The_SIR_model", "anchor_text": "compartmental model", "paragraph_index": 7}, {"url": "https://www.ncbi.nlm.nih.gov/pubmed/23864593", "anchor_text": "transmission dynamics varies significantly", "paragraph_index": 7}, {"url": "https://www.sciencedirect.com/science/article/pii/S0198971514001367", "anchor_text": "challenging", "paragraph_index": 8}, {"url": "https://www.nature.com/articles/s41467-017-02064-4", "anchor_text": "Nature article", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology#The_SIR_model", "anchor_text": "SIR model", "paragraph_index": 8}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJMoa2001316", "anchor_text": "has been estimated", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Modal_share", "anchor_text": "modal share", "paragraph_index": 15}, {"url": "https://www.ggtaxi.com/", "anchor_text": "gg", "paragraph_index": 17}, {"url": "https://link.springer.com/chapter/10.1007/978-1-4614-4496-1_4", "anchor_text": "still an active area of research", "paragraph_index": 26}, {"url": "https://en.wikipedia.org/wiki/Antifragility", "anchor_text": "antifragile", "paragraph_index": 26}, {"url": "https://lexparsimon.github.io/coronavirus/", "anchor_text": "here", "paragraph_index": 27}], "all_paragraphs": ["You can learn the entire modelling, simulation and spatial visualization of the Covid-19 epidemic spreading in a city using just Python in this online course or in this one.", "The recent 2019-nCoV Wuhan coronavirus outbreak in China has sent shocks through financial markets and entire economies, and has duly triggered panic among the general population around the world. On 30 January 2020, 2019-nCoV was even designated a global health emergency by the World Health Organization (WHO). At the time of this writing, no specific treatment verified by medical research standards has yet been discovered. Moreover, some key epidemiological metrics such as the basic reproduction number (the average number of people infected by an ill individual) are still unknown. In our times of unprecedented global connectedness and mobility, such epidemics are a major threat on a global scale due to small world network effects. One could conjecture that conditional on a global catastrophic event (loosely defined as > 100mln casualties) happening in 2020, the most likely cause would be precisely some pandemic\u200a\u2014\u200anot a nuclear disaster, not climate catastrophe, etc. This is further aggravated by worldwide rapid urbanisation, with our densely populated dynamic cities turning into propagation nodes in the disease diffusion network, thus becoming extremely vulnerable and fragile.", "In this post, we will discuss what can happen when an epidemic strikes a city, what measures should immediately be taken, and what implications this has for urban planning, policy making, and management. We will take the city of Yerevan as our case study and will mathematically model and simulate in Python the spread of the coronavirus in the city, looking at how urban mobility patterns affect the spread of the disease.", "Effective, efficient, and sustainable urban mobility is of crucial importance for the functioning of modern cities. It has been shown to directly affect livability and economic output (GDP) of cities. However, in the event of an epidemic, it will add fuel to the fire, amplifyig and propagating the disease spread.", "So let\u2019s begin by looking at the network of aggregated origin-destination (OD) flows on a uniform Cartesian grid in Yerevan to get an idea about the spatial structure of mobility patterns in the city:", "Further, if we look at the total inflow to the grid cells, we see a more or less monocentric spatial organisation with some cells with high daily inflow located off the center:", "Now, imagine that an epidemic breaks out at a random location in the city. How will it spread? What can be done to contain it?", "To answer these questions, we will build a simple compartmental model to simulate the spread of infectious disease in the city. As an epidemic breaks out, its transmission dynamics varies significantly, depending on the geographical locations of the initial infection and its connectivity with the rest of the city. This is one of the most important insights gained from recent, data-driven studies on epidemics in urban populations. However, as we will see further below, the various outcomes call for similar measures to contain the epidemic and to account for such a possibility in planning and managing cities.", "Since runnning individual-based epidemic models is challenging, and since our goal is to show general principles of epidemic spread in cities, and not to build a minutely calibrated and accurate epidemic model, we will follow the approach described in this Nature article, modifying the described classical SIR model for our needs.", "The model divides the population into three compartments. For each location i at time t, the three compartments are as follows:", "In our simulations, time will be a discrete variable as the state of the system is modelled at a daily basis. In a fully susceptible population at location j at time t, an outbreak happens with probability:", "where \u03b2t is the transmission rate on day t; mj,k reflects mobility from location k to location j, xk,t and yk,t denote the fraction of the infected and susceptible populations on day t at location k and location j, respectively, given by xk,t = Ik,t / Nk and yj,t = Sj,t / Nj, where Nk and Nj are the population sizes at the locations k and j. Then we go ahead and simulate a stochastic process introducing the disease into locations with entirely susceptible populations, with Ij,t+1 being a Bernoulli random variable with probability h(t,j).", "Once the infections are introduced at random locations, the disease spreads both within those locations and is carried and transmitted in other locations by travelling individuals. This is where the urban mobility patterns characterised by the OD flow matrix play a crucial role.", "Further, to formalise how the disease is transmitted by an infected person, we need the basic reproduction number, R0. It is defined as R0 = \u03b2t / \u03b3 where \u03b3 is the recovery rate, and can be thought of as the expected number of secondary infections after an infected individual comes into contact with a susceptible population. At the time of this writing, the basic reproduction number for the Wuhan coronavirus has been estimated to be between 1.4 and 4. Let\u2019s take the worst case and assume it\u2019s 4. However, we should note that it\u2019s actually a random variable and the reported number is but the expected number. To make things a bit more interesting, we will run our simulations with different R0 at each location, drawn from a good candidate distribution, Gamma, with mean 4:", "We can now proceed to the model dynamics:", "where \u03b2k,t is the (random) transmission rate at location k on day t, and \u03b1 is a coefficient denoting the modal share or the intensity of public transport vs. private car travel modes in the city.", "The model dynamics described in the above equations are very simple: on day t+1 at location j, we need to subtract from the susceptible population Sj,t the fraction of people infected within location j (the second term in the first equation) as well as the fraction of infected people that have arrived from other locations in the city, weighted by their respective transmission rates \u03b2k,t (the third term in the first equation). Since the total population Nj = Sj + Ij + Rj, we need to move the subtracted portion to the infected group, while also moving those recovered to Rj,t+1 (second and third equations).", "For this analysis, we will use the aggregated OD flow matrix of a typical day obtained from GPS data provided by local ride sharing company gg as a proxy for the mobility patterns in Yerevan city. Next, we need the population counts in each 250\u00d7250m grid cell, which we approximate by proportionally scaling the extracted flow counts so that the total inflows in different locations sum up to approximately half of Yerevan\u2019s population of 1.1 million. This is actually a bold assumption, but since varying this portion yielded very similar results, we will stick to it.", "For our first simulation, we will imagine a sustainable public transport-dominated future urban mobility with \u03b1=0.9:", "We see how fast the infected fraction of the population is climbing up immediately, reaching the epidemic\u2019s peak on around day 8\u201310, with almost 70% of the population infected, while only a small portion (~10%) of the population having recovered from the disease. Towards day 100, when the epidemic has receded, we see the fraction of recovered individuals reach a staggering 90%! Now let\u2019s see if reducing the intensity of public transport travel to something like \u03b1 = 0.2 has any effect on mitigating the epidemic spread. This can either be interpreted as taking drastic measures to reduce urban mobility (e.g., by issuing a curfew) or as increasing the share of private car travel to reduce chances of infection during the travel.", "We see how the peak of the epidemic comes somewhere between day 16 and 20, with a significantly smaller infected group (~45%) and twice as many recovered (~20%). Towards the end of the epidemic, the fraction of susceptible individuals is also twice as big (~24% vs. ~12%), meaning that more people have escaped the disease. As expected, we see that the introduction of dramatic measures to temporarily bring urban mobility down has a big impact on the disease spreading dynamics.", "Now, let\u2019s see whether another intuitive idea of completely cutting off a few key popular locations has the desired effect. To do this, let\u2019s pick the locations associated with the upper 1 percentile of mobility flows,", "and completely block all flow to and from those locations, effectively establishing there a quarantine regime. As we can see from the plot, in Yerevan these locations are mostly in the city center, with two other locations being the two largest shopping malls. Choosing a moderate \u03b1 = 0.5, we obtain:", "We see an even smaller fraction of infected individuals at the epidemic\u2019s peak (~35%), and, most importantly, we see that towards the end of the epidemic, around half of the population remains susceptible, effectively escaping from contracting the infection!", "Here is a small animation visualising the dynamics of the high public transport share scenario:", "By no means claiming accurate epidemic modelling (or even any substantial knowledge in epidemiology beyond the basics), our aim in this post was to get a first insight on how network effects come into play in an urban setting during an infectious disease outbreak. With ever-increasing population densities, mobility, and dynamics, our cities become more exposed to \u201cblack swans\u201d and become more fragile. And since you can\u2019t fetch the coffee if you\u2019re dead, smart and sustainable cities will be meaningless without effective and efficient crisis handling capability and mechanisms. For instance, we saw that the introduction of quarantine regimes in key locations, or taking draconian measures to curb mobility, can be instrumental during such a health crisis. However, a further important question would be how to implement such measures while minimizing damage and loss to the functioning of the city and its economy?", "Further yet, the exact epidemic spreading mechanisms of infectious diseases are still an active area of research and the advances in this fields will have to be communicated to and integrated in urban planning, policymaking, and management to make our cities safe and antifragile.", "P.S. Read the original post here.", "The code for the above simulations:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a postdoctoral researcher in urban data science with interests in spatial machine learning and complex networks for urban mobility and planning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbabd14d82fa2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gevorgyeghikyan?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gevorgyeghikyan?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": "Gevorg Yeghikyan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf8c41f7e3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&user=Gevorg+Yeghikyan&userId=df8c41f7e3d&source=post_page-df8c41f7e3d----babd14d82fa2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbabd14d82fa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbabd14d82fa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.udemy.com/course/covid-19-urban-epidemic-modelling-in-python/?referralCode=220EF2D17E80758E78B5", "anchor_text": "this online course"}, {"url": "https://skl.sh/30Vdq7J", "anchor_text": "this one"}, {"url": "https://en.wikipedia.org/wiki/Novel_coronavirus_(2019-nCoV)", "anchor_text": "2019-nCoV Wuhan coronavirus"}, {"url": "https://www.bbc.com/news/world-51318246", "anchor_text": "designated"}, {"url": "https://en.wikipedia.org/wiki/Basic_reproduction_number", "anchor_text": "basic reproduction number"}, {"url": "https://en.wikipedia.org/wiki/Small-world_network", "anchor_text": "small world network"}, {"url": "https://www.nature.com/articles/s41467-019-12809-y", "anchor_text": "shown"}, {"url": "https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology#The_SIR_model", "anchor_text": "compartmental model"}, {"url": "https://www.ncbi.nlm.nih.gov/pubmed/23864593", "anchor_text": "transmission dynamics varies significantly"}, {"url": "https://www.sciencedirect.com/science/article/pii/S0198971514001367", "anchor_text": "challenging"}, {"url": "https://www.nature.com/articles/s41467-017-02064-4", "anchor_text": "Nature article"}, {"url": "https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology#The_SIR_model", "anchor_text": "SIR model"}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJMoa2001316", "anchor_text": "has been estimated"}, {"url": "https://en.wikipedia.org/wiki/Modal_share", "anchor_text": "modal share"}, {"url": "https://www.ggtaxi.com/", "anchor_text": "gg"}, {"url": "https://link.springer.com/chapter/10.1007/978-1-4614-4496-1_4", "anchor_text": "still an active area of research"}, {"url": "https://en.wikipedia.org/wiki/Antifragility", "anchor_text": "antifragile"}, {"url": "https://lexparsimon.github.io/coronavirus/", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----babd14d82fa2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----babd14d82fa2---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/modeling?source=post_page-----babd14d82fa2---------------modeling-----------------", "anchor_text": "Modeling"}, {"url": "https://medium.com/tag/urban-planning?source=post_page-----babd14d82fa2---------------urban_planning-----------------", "anchor_text": "Urban Planning"}, {"url": "https://medium.com/tag/epidemic?source=post_page-----babd14d82fa2---------------epidemic-----------------", "anchor_text": "Epidemic"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbabd14d82fa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&user=Gevorg+Yeghikyan&userId=df8c41f7e3d&source=-----babd14d82fa2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbabd14d82fa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&user=Gevorg+Yeghikyan&userId=df8c41f7e3d&source=-----babd14d82fa2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbabd14d82fa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbabd14d82fa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----babd14d82fa2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----babd14d82fa2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----babd14d82fa2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----babd14d82fa2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----babd14d82fa2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gevorgyeghikyan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gevorgyeghikyan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gevorg Yeghikyan"}, {"url": "https://medium.com/@gevorgyeghikyan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "241 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf8c41f7e3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&user=Gevorg+Yeghikyan&userId=df8c41f7e3d&source=post_page-df8c41f7e3d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4954f4d37b67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-the-coronavirus-epidemic-spreading-in-a-city-with-python-babd14d82fa2&newsletterV3=df8c41f7e3d&newsletterV3Id=4954f4d37b67&user=Gevorg+Yeghikyan&userId=df8c41f7e3d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}