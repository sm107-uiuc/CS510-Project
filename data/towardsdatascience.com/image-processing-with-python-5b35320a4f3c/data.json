{"url": "https://towardsdatascience.com/image-processing-with-python-5b35320a4f3c", "time": 1683011488.273082, "path": "towardsdatascience.com/image-processing-with-python-5b35320a4f3c/", "webpage": {"metadata": {"title": "Image Processing with Python. Bytes, sampling, and filters \u2014 an\u2026 | by James Briggs | Towards Data Science", "h1": "Image Processing with Python", "description": "Image processing is often a reasonably infrequent task. Of course, this will depend heavily on our roles \u2014 but even in heavy analytical roles such as data science or machine learning \u2014 image\u2026"}, "outgoing_paragraph_urls": [{"url": "https://learn.datacamp.com/courses/image-processing-in-python?tap_a=5644-dce66f&tap_s=1014685-c39058&utm_medium=affiliate&utm_source=jamesbriggs3", "anchor_text": "this course on Datacamp", "paragraph_index": 39}, {"url": "https://twitter.com/jamescalam", "anchor_text": "Twitter", "paragraph_index": 40}, {"url": "https://neptune.ai/blog/what-image-processing-techniques-are-actually-used-in-the-ml-industry", "anchor_text": "What Image Processing Techniques Are Actually Used in the ML Industry", "paragraph_index": 41}, {"url": "https://www.youtube.com/c/jamesbriggs", "anchor_text": "https://www.youtube.com/c/jamesbriggs", "paragraph_index": 43}], "all_paragraphs": ["Image processing is often a reasonably infrequent task. Of course, this will depend heavily on our roles \u2014 but even in heavy analytical roles such as data science or machine learning \u2014 image manipulation is pretty common.", "In machine learning, we may need to take a number of images and classify them based on what their contents \u2014 we\u2019ll likely need to downsample the images \u2014 taking them from an original 2, 4, 8K resolution image to a more manageable size.", "There are many other disciplines that require a small amount of image processing, such as web development \u2014 or significantly more, as for image processing engineers.", "We will touch upon the basics of how image data is organized in a computer, and then explore a few different methods for image manipulation:", "We will use Numpy throughout the article \u2014 for quick and easy image manipulation, I would suggest another library called PIL.", "PIL code will be included too, but we won\u2019t focus on it \u2014 as it abstracts everything to a level where we can\u2019t focus on the actual processes.", "Throughout the article, we\u2019ll work with the article cover image.", "In the original format, this image consists of 7207 x 4801 pixels.", "We will be representing this image as an array. In this array, we will have three \u2018channels\u2019 (layers) \u2014 representing red, green, and blue.", "Now, let\u2019s write some code to convert our image into a Numpy array:", "We can also take a look at the values that make up our array:", "All values in our array vary from zero, the minimum \u2014 to 255, the maximum. This range is used because each of our colors is a 8-bit byte. Each bit can be either 0 or 1.", "As we can see, 0 shows all bytes to be off, whereas for 255 all bytes are on \u2014 this makes sense as 0 corresponds to the minimum of that respective color in the image, and 255 the maximum. Let\u2019s try turning our colors off-and-on.", "There are two major reasons to do this in machine learning applications:", "Both reasons require the same approach, we take our original array and compress groups of pixels into single pixels in a way that maximizes the information retained.", "Here, we will downsample our image by taking the average value of multiple pixels to create one new pixel.", "We use sklearn.measure.block_reduce to perform this operation and np.mean to specify the reduction operation using averages.", "To see a clear difference, we downsample our image by a factor of 20.", "We can compare the original and downsampled images using imshow, which gives us:", "Again \u2014 speaking from a ML/data science perspective \u2014 it is impossible (for any normal computer) to cope with training a classifier on big sets of 100M+ value arrays.", "This is the fun part \u2014 we\u2019re going to write some code to modify our picture \u2014 like Instagram filters.", "The vignette is essentially a darkening of pixels towards the outer edges of the image \u2014 it looks like this:", "A while back, this was the go-to effect for edgy teenagers trying to cover up their lackluster photography skills.", "It\u2019s a fun effect to get started with. All we need is a function that we can apply to our array that will reduce values towards the outer edges.", "To achieve this effect, we start with a Gaussian function \u2014 we will feed it a single value for every integer row-wise and column-wise.", "This code produces two Gaussian distributions that look like this:", "We then normalize these distributions and apply them to our image. Visualizing just the two distributions applied to a white square gives us this:", "This effect can be applied to an array easily:", "Taking this code and applying it to our Unsplash image gives us that edgy teen/hipster Instagram effect:", "Another cool thing we can do is modify the color layers in our image individually.", "Simple balancing is easily achieved by accessing each color layer individually and increasing/decreasing layer values.", "As we do this, we will inadvertently create numbers outside of our range of 0\u2013255. To deal with these we use a simple clamp function to squeeze our array back into the correct range, shown above.", "Playing around with the r, g, b values in col_bal can produce some interesting effects:", "We use the exact same approach to modify image brightness. All we need to do is modify our RGB values by the exact same value:", "Finally, we can put all of these together. Some color-balancing with the vignette effect can build some cool effects really easily.", "One thing that we have avoided throughout this article is the use of the PIL library. PIL is the go-to for image processing in Python \u2014 so this article wouldn\u2019t be complete without mentioning it.", "PIL is an excellent library, purpose-made for image processing in Python. With it, we can compress what would take us several lines of Numpy code \u2014 into a single function.", "However, PIL abstracts everything to a point where understanding the mechanics is not possible \u2014 hence our heavy use of Numpy.", "We\u2019ve covered the basics behind images in bits/bytes, how we can downsample images, and how to edit images with vignettes and color-balancing.", "If you\u2019re interested in learning more advanced concepts, I would highly recommend this course on Datacamp (the first part is free).", "I hope you have learned something from the article, if you have any questions or suggestions, get in touch on Twitter or in the comments below!", "What Image Processing Techniques Are Actually Used in the ML Industry (2020), Neptune.ai", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Freelance ML engineer learning and writing about everything. I post a lot on YT https://www.youtube.com/c/jamesbriggs"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5b35320a4f3c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jamescalam.medium.com/?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": "James Briggs"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9d77a4ca1d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&user=James+Briggs&userId=b9d77a4ca1d1&source=post_page-b9d77a4ca1d1----5b35320a4f3c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b35320a4f3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b35320a4f3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@giuliomagnifico?utm_source=medium&utm_medium=referral", "anchor_text": "Giulio Magnifico"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@johnwolf3?utm_source=medium&utm_medium=referral", "anchor_text": "John Hernandez"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://learn.datacamp.com/courses/image-processing-in-python?tap_a=5644-dce66f&tap_s=1014685-c39058&utm_medium=affiliate&utm_source=jamesbriggs3", "anchor_text": "this course on Datacamp"}, {"url": "https://twitter.com/jamescalam", "anchor_text": "Twitter"}, {"url": "https://neptune.ai/blog/what-image-processing-techniques-are-actually-used-in-the-ml-industry", "anchor_text": "What Image Processing Techniques Are Actually Used in the ML Industry"}, {"url": "https://medium.com/tag/python?source=post_page-----5b35320a4f3c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----5b35320a4f3c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5b35320a4f3c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----5b35320a4f3c---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/software-development?source=post_page-----5b35320a4f3c---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5b35320a4f3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&user=James+Briggs&userId=b9d77a4ca1d1&source=-----5b35320a4f3c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5b35320a4f3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&user=James+Briggs&userId=b9d77a4ca1d1&source=-----5b35320a4f3c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b35320a4f3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5b35320a4f3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5b35320a4f3c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5b35320a4f3c--------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "James Briggs"}, {"url": "https://jamescalam.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.6K Followers"}, {"url": "https://www.youtube.com/c/jamesbriggs", "anchor_text": "https://www.youtube.com/c/jamesbriggs"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9d77a4ca1d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&user=James+Briggs&userId=b9d77a4ca1d1&source=post_page-b9d77a4ca1d1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F75e31c56d187&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-processing-with-python-5b35320a4f3c&newsletterV3=b9d77a4ca1d1&newsletterV3Id=75e31c56d187&user=James+Briggs&userId=b9d77a4ca1d1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}