{"url": "https://towardsdatascience.com/a-step-by-step-introduction-to-pca-c0d78e26a0dd", "time": 1683005824.511013, "path": "towardsdatascience.com/a-step-by-step-introduction-to-pca-c0d78e26a0dd/", "webpage": {"metadata": {"title": "A Step-By-Step Introduction to PCA | by Conor O'Sullivan | Towards Data Science", "h1": "A Step-By-Step Introduction to PCA", "description": "In this article, I will be writing about how to overcome the issue of visualizing, analyzing and modelling datasets that have high dimensionality i.e. datasets that have a large number of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://gist.github.com/conorposullivan/7b40c9a84605ed9447ba520a5695a4bd", "anchor_text": "here", "paragraph_index": 1}, {"url": "http://matrixmultiplication.xyz/", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://www.youtube.com/watch?v=3-xfmbdzkqc", "anchor_text": "video", "paragraph_index": 17}, {"url": "https://gist.github.com/conorposullivan/7b40c9a84605ed9447ba520a5695a4bd", "anchor_text": "code", "paragraph_index": 30}, {"url": "https://datasciencesamurai.com/step-by-step-principal-component-analysis-pca-python", "anchor_text": "datasciencesamurai.com", "paragraph_index": 32}, {"url": "https://bit.ly/2yV8yDm", "anchor_text": "https://bit.ly/2yV8yDm", "paragraph_index": 34}], "all_paragraphs": ["In this article, I will be writing about how to overcome the issue of visualizing, analyzing and modelling datasets that have high dimensionality i.e. datasets that have a large number of measurements for each sample. For datasets of this type, it is hard to determine the relationship between features and to visualize their relationships with each other. When applying models to high dimensional datasets it can often result in overfitting i.e. poor performance for samples not in the training set.", "The approach I will discuss today is an unsupervised dimensionality reduction technique called principal component analysis or PCA for short. In this post I will discuss the steps to perform PCA. I will also demonstrate PCA on a dataset using python. You can find the full code script here. The steps to perform PCA are the following:", "In order to demonstrate PCA using an example we must first choose a dataset. The dataset I have chosen is the Iris dataset collected by Fisher.", "The dataset consists of 150 samples from three different types of iris: setosa, versicolor and virginica. The dataset has four measurements for each sample. These measurements are the sepal length, sepal width, petal length and petal width. In order to access this dataset, we will import it from the sklearn library:", "Now that the dataset has been imported, it can be loaded into a dataframe by doing the following:", "Now that the dataset has been loaded we can display some of the samples like so:", "Boxplots are a good way for visualizing how data is distributed. A group of boxplots can be created using :", "The boxplots show us a number of details such as virginica having the largest median petal length. We will come back to these boxplots later on the article.", "Now that the dataset has been loaded, it must be prepared for dimensionality reduction. The majority of machine learning and optimization algorithms perform better when all the features are along the same scale. In order to do this a standardization approach can be implemented. A feature value x\u2071 can be become a standardized feature value x\u2071\u209b by using the following calculation:", "where \u03bc\u2093 is the mean of the feature column and \u03c3\u2093 is the corresponding sample variance. This results in the feature values having a mean of 0 and a standard deviation of 1, therefore having the same parameters as a normal distribution. As an example, for a feature column with values from 0 to 5 applying standardization would result in the following new values:", "In terms of our dataset, the standardization of the iris features can be implemented using sklearn like so:", "Covariance measures how two features vary with each other. A positive covariance indicates that features increase and decrease together. Whereas, a negative covariance indicates that the two features vary in the opposite directions. For two feature vectors x\u2c7c and x\u2096 the covariance between them \u03c3\u2c7c\u2096 can be calculated using the following equation:", "A covariance matrix contains the covariance values between features and has shape d \u00d7 d. For our dataset, the covariance matrix should, therefore, look like the following:", "Since the feature columns have been standardized and therefore they each have a mean of zero, the covariance matrix \u03a3 can be calculated by the following:", "where X\u1d57 is the transpose of X. If you need a reminder of how matrix multiplication works, here is a great link.", "This can be implemented in python like so:", "The eigenvectors represent the principal components (the directions of maximum variance) of the covariance matrix. The eigenvalues are their corresponding magnitude. The eigenvector that has the largest corresponding eigenvalue represents the direction of maximum variance. An eigenvector v satisfies the following condition:", "Where \u03bb is a scalar and known as the eigenvalue. The manual computation is quite elaborate and could be a post all it\u2019s own. However, if you want to know more I would recommend checking out this video. Instead, I will use a eigendecomposition function from python:", "Which gives us the eigenvectors (principal components) and eigenvalues of the covariance matrix.", "Now that the eigenpairs have been computed they now need to be sorted based on the magnitude of their eigenvalues. This can be done in python by doing the following:", "Now that the principal components have been sorted based on the magnitude of their corresponding eigenvalues, it is time to determine how many principal components to select for dimensionality reduction. This can be done by plotting the cumulative sum of the eigenvalues. The cumulative sum is computed as the following:", "The formula above can be calculated and plotted as follows:", "From the plot, we can see that over 95% of the variance is captured within the two largest principal components. Therefore, it is acceptable to choose the first two largest principal components to make up the projection matrix W.", "Now that it has been decided how many of the principal components to make up the projection matrix W, the scores Z can be calculated as follows:", "This can be computed in python by doing the following:", "Now that the dataset has been projected onto a new subspace of lower dimensionality, the result can be plotted like so:", "From the plot, it can be seen that the versicolor and virignica samples are closer together while setosa is further from both of them. If you recall from the biplots above virginica had the largest average sepal length, petal length and petal width. Whereas, setosa had the highest average sepal width. This can be seen to hold true by following the axes of the original features.", "Some disadvantages of eigendecomposition is that it can be computationally expensive and requires a square matrix as input. Partly for these reasons, a more popular way of finding the principal components for PCA is by using singular value decomposition (SVD). SVD decomposes a matrix into three separate matrices that satisfy the following condition:", "Where U is known as the left singular vectors, V* is the complex conjugate of the right singular vectors and S are the singular values. The singular values are correlated with the eigenvalues calculated from eigendecomposition. Another useful feature of SVD is that the singular values are in order of magnitude and therefore no reordering needs to take place. The right singular vectors are identical to the eigenvectors found from eigendecomposition and therefore W=V. Using python, SVD of a matrix can be computed like so:", "From that, the scores can now be computed:", "From these scores a biplot can be graphed which will return the same result as above when eigendecompostion is used. Check out the code for full details.", "In this post, we looked at PCA and how it can be used to get a clearer understanding of the relationships between features of a dataset, while at the same time removing unnecessary noise. We went through each step and also discussed different ways to compute it. I hope that this article will help you in your future data science endeavors.", "Originally published at datasciencesamurai.com on April 25, 2020.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Lifelong Learner | Want to learn more about data science? Signup to my newsletter https://bit.ly/2yV8yDm"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc0d78e26a0dd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@conorposullivan?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@conorposullivan?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": "Conor O'Sullivan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F70d4b3c3b5b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&user=Conor+O%27Sullivan&userId=70d4b3c3b5b1&source=post_page-70d4b3c3b5b1----c0d78e26a0dd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0d78e26a0dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0d78e26a0dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/pixel2013-2364555/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2502898", "anchor_text": "S. Hermann & F. Richter"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2502898", "anchor_text": "Pixabay"}, {"url": "https://gist.github.com/conorposullivan/7b40c9a84605ed9447ba520a5695a4bd", "anchor_text": "here"}, {"url": "http://matrixmultiplication.xyz/", "anchor_text": "here"}, {"url": "https://www.youtube.com/watch?v=3-xfmbdzkqc", "anchor_text": "video"}, {"url": "https://gist.github.com/conorposullivan/7b40c9a84605ed9447ba520a5695a4bd", "anchor_text": "code"}, {"url": "https://datasciencesamurai.com/step-by-step-principal-component-analysis-pca-python", "anchor_text": "datasciencesamurai.com"}, {"url": "https://datasciencesamurai.ck.page/77020f333b", "anchor_text": "Join my email list to learn more about data science."}, {"url": "https://medium.com/tag/data-science?source=post_page-----c0d78e26a0dd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----c0d78e26a0dd---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c0d78e26a0dd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/visualization?source=post_page-----c0d78e26a0dd---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/statistics?source=post_page-----c0d78e26a0dd---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc0d78e26a0dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&user=Conor+O%27Sullivan&userId=70d4b3c3b5b1&source=-----c0d78e26a0dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc0d78e26a0dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&user=Conor+O%27Sullivan&userId=70d4b3c3b5b1&source=-----c0d78e26a0dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0d78e26a0dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc0d78e26a0dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c0d78e26a0dd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c0d78e26a0dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@conorposullivan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@conorposullivan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Conor O'Sullivan"}, {"url": "https://medium.com/@conorposullivan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "26 Followers"}, {"url": "https://bit.ly/2yV8yDm", "anchor_text": "https://bit.ly/2yV8yDm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F70d4b3c3b5b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&user=Conor+O%27Sullivan&userId=70d4b3c3b5b1&source=post_page-70d4b3c3b5b1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F70d4b3c3b5b1%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-step-by-step-introduction-to-pca-c0d78e26a0dd&user=Conor+O%27Sullivan&userId=70d4b3c3b5b1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}