{"url": "https://towardsdatascience.com/googles-approach-to-flexibility-in-machine-learning-170bd9d8f169", "time": 1683005112.9591308, "path": "towardsdatascience.com/googles-approach-to-flexibility-in-machine-learning-170bd9d8f169/", "webpage": {"metadata": {"title": "Google\u2019s Approach To Flexibility In Machine Learning | by Fabian Deuser | Towards Data Science", "h1": "Google\u2019s Approach To Flexibility In Machine Learning", "description": "An introduction to the new Machine Learning Framework Flax from Google and a comparison to Tensorflow with an Image Recognition CNN based on MNIST-Example."}, "outgoing_paragraph_urls": [{"url": "https://github.com/Skyy93/SimpsonsFaceRecognitionFlax", "anchor_text": "Github", "paragraph_index": 18}, {"url": "https://flax.readthedocs.io/en/latest/notebooks/flax_intro.html", "anchor_text": "documentation", "paragraph_index": 21}, {"url": "https://github.com/google/flax/tree/prerelease", "anchor_text": "Github page", "paragraph_index": 21}, {"url": "https://github.com/Skyy93/SimpsonsFaceRecognitionFlax", "anchor_text": "SimpsonsFaceRecognitionFlax", "paragraph_index": 22}, {"url": "http://M.Sc", "anchor_text": "M.Sc", "paragraph_index": 24}], "all_paragraphs": ["Thinking of Machine Learning, the first frameworks that come to mind are Tensorflow and PyTorch, which are currently the state-of-the-art frameworks if you want to work with Deep Neural Networks. Technology is changing rapidly and more flexibility is needed, so Google researchers are developing a new high performance framework for the open source community: Flax.", "The base for the calculations is JAX instead of NumPy, which is also a Google research project. One of the biggest advantages of JAX is the use of XLA, a special compiler for linear algebra, that enables execution on GPUs and TPUs as well. For those who do not know, TPU (tensor processing unit) is a specific chip optimized for Machine Learning. JAX reimplements parts of NumPy to run your functions on a GPU/TPU.", "Flax focuses on key points like:", "Enough praises, now let\u2019s start coding.", "Because the MNIST-Example becomes boring I will build an Image Classification for the Simpsons Family, unfortunately, Maggie is missing in the dataset :-( .", "First, we install the necessary libraries and unzip our dataset. Unfortunately you will still need Tensorflow at this point because Flax misses a good data input pipeline.", "Now we import the libraries. You see we have two \u201cversions\u201d of numpy, the normal numpy lib and the one part of the API that JAX implements. The print statement prints CPU, GPU or TPU out according to the available hardware.", "For training and evaluation we first have to create two Tensorflow datasets and convert them to numpy/jax arrays, because FLAX doesn\u2019t take TF data types. This is currently a bit hacky, because the evaluation method doesn\u2019t take batches. I had to create one large batch for the eval step and create a TF feature dictionary from it, which is now parsable and can be fed to our eval step after each epoch.", "The CNN-class contains our convolutional neural network. When you are familiar with Tensorflow/Pytorch you see it's pretty straight forward. Every call of our flax.nn.Conv defines a learnable kernel. I used the MNIST-Example and extended it with some additional layers. In the end, we have our Dense-Layer with four output neurons, because we have a four-class problem.", "Unlike in Tensorflow, the activation function is called explicitly, this makes it very easy to test new and own written activation functions. FLAX is based on the module abstraction and both initiating and calling the network is done with the apply function.", "Of course, we want to measure how good our network becomes. Therefore, we compute our metrics like loss and accuracy. Our accuracy is then computed with the JAX library, instead of NumPy because we can use JAX on TPU/GPU.", "To measure our loss we use the Cross Entropy Loss, unlike in Tensorflow it is calculated by yourself, we do not have the possibility to use ready-made loss objects yet. As you can see we use @jax.vmap as a function decorator for our loss function. This vectorizes our code for running on batches efficiently.", "How does the cross_entropy_loss work? @jax.vmap takes both arrays, logits and label, and performs our cross_entropy_loss on each pair, thus allowing the parallel calculation of a batch. The cross entropy formula for a single example is:", "Our ground truth y is 0 or 1 for one of the four output neurons, therefore we do not need the sum formula in our code, because we just calculate the log(y_hat) of the correct label. The mean in our loss calculation is used because we have batches.", "In our train step, we use again a function decorator, @jax.jit , for speeding up our function. This works very similar to Tensorflow. Please have in mind batch[0] is our image data and batch[1] our label.", "The loss function loss_fn returns the loss for our current model, optimizer.target , and our jax.grad()calculates its gradient. After the calculation we apply the gradient like in Tensorflow.", "The eval step is very simple and minimalistic in FLAX. Please note that the complete evaluation dataset is passed to this function.", "After 50 epochs we have very high accuracy. Of course, we can continue to tweak the model and optimize hyperparameter.", "For this experiment, I used Google Colab, so if you want to test it yourself create a new environment with a GPU/TPU and import my notebook from Github. Please note that FLAX is not working under Windows at the moment.", "It is important to note that FLAX is currently still in alpha and is not an official Google product.", "The work so far gives hope for a fast, lightweight and highly customizable ML framework. What is completely missing so far is a data-input pipeline, so Tensorflow still has to be used. The current set of optimizers is unfortunately limited to ADAM and SGD with Momentum. I especially liked the very strict forward direction of how to use this framework and the high flexibility. My next plans are to develop some activation features that are not yet available. Also a speed comparison between Tensorflow, PyTorch and FLAX would also be very interesting.", "If you want to try a little bit with FLAX, check out the documentation and their Github page.", "And if you want to download my example with dataset just clone SimpsonsFaceRecognitionFlax.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "M.Sc. in Computer Science and currently pursuing a Ph.D. in Deep Learning. Currently interested in multimodal deep learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F170bd9d8f169&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@skycore1337?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@skycore1337?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": "Fabian Deuser"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F83c8a0329297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&user=Fabian+Deuser&userId=83c8a0329297&source=post_page-83c8a0329297----170bd9d8f169---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F170bd9d8f169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F170bd9d8f169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@musicfox?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "MusicFox Fx"}, {"url": "https://unsplash.com/collections/8762704/flax?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/Skyy93/SimpsonsFaceRecognitionFlax", "anchor_text": "Github"}, {"url": "https://flax.readthedocs.io/en/latest/notebooks/flax_intro.html", "anchor_text": "documentation"}, {"url": "https://github.com/google/flax/tree/prerelease", "anchor_text": "Github page"}, {"url": "https://github.com/Skyy93/SimpsonsFaceRecognitionFlax", "anchor_text": "SimpsonsFaceRecognitionFlax"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----170bd9d8f169---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----170bd9d8f169---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----170bd9d8f169---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----170bd9d8f169---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----170bd9d8f169---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F170bd9d8f169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&user=Fabian+Deuser&userId=83c8a0329297&source=-----170bd9d8f169---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F170bd9d8f169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&user=Fabian+Deuser&userId=83c8a0329297&source=-----170bd9d8f169---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F170bd9d8f169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F170bd9d8f169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----170bd9d8f169---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----170bd9d8f169--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----170bd9d8f169--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----170bd9d8f169--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----170bd9d8f169--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@skycore1337?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@skycore1337?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Fabian Deuser"}, {"url": "https://medium.com/@skycore1337/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "http://M.Sc", "anchor_text": "M.Sc"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F83c8a0329297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&user=Fabian+Deuser&userId=83c8a0329297&source=post_page-83c8a0329297--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe3023dce1307&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogles-approach-to-flexibility-in-machine-learning-170bd9d8f169&newsletterV3=83c8a0329297&newsletterV3Id=e3023dce1307&user=Fabian+Deuser&userId=83c8a0329297&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}