{"url": "https://towardsdatascience.com/introduction-to-lstm-units-while-playing-jazz-fa0175b59012", "time": 1682995838.7769952, "path": "towardsdatascience.com/introduction-to-lstm-units-while-playing-jazz-fa0175b59012/", "webpage": {"metadata": {"title": "Introduction to LSTM Units While Playing Jazz | by Marco Peixeiro | Towards Data Science", "h1": "Introduction to LSTM Units While Playing Jazz", "description": "Long short-term memory (LSTM) units allow to learn very long sequences. It is a more general and robust version of the gated recurrent unit (GRU), which will not be addressed in this post. In this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel", "paragraph_index": 2}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/5.Sequence%20Models/1.Recurrent%20Neural%20Networks/Improvise%20a%20Jazz%20Solo%20with%20LSTM.ipynb", "anchor_text": "full notebook", "paragraph_index": 8}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/tree/master/5.Sequence%20Models/1.Recurrent%20Neural%20Networks", "anchor_text": "repository", "paragraph_index": 22}], "all_paragraphs": ["Long short-term memory (LSTM) units allow to learn very long sequences. It is a more general and robust version of the gated recurrent unit (GRU), which will not be addressed in this post.", "In this post, we will learn how an LSTM unit works, and we will apply it to generate some jazz music.", "For hands-on video tutorials on machine learning, deep learning, and artificial intelligence, checkout my YouTube channel.", "The main characteristic of an LSTM is the presence of three gates:", "Below is a schema of an LSTM unit. The three gates are shown by the presence of the three sigmas:", "From the picture above, notice that there is a line from left to right at the top of the LSTM unit. This line represents how earlier information can be passed on to further steps in the network, and this is why an LSTM unit is so good at memorizing long sequences. Consequently, this allows a model to capture longer range dependencies.", "This might seem like there is not a lot to know about LSTM, but understand that this is simply a unit within a recurrent neural network (MAKE LINK). The green box above simply represents one unit of an RNN. Then, multiple units are connected, resulting in a full network.", "Now, we will implement an RNN with LSTM to generate jazz music! We will implement the network using Keras, and it will generate a 15-second clip of jazz.", "As always, the full notebook is available for consultation.", "Unfortunately, the data used for training was too large to upload on Github", "Our model\u2019s architecture will look like this:", "Basically, the model will be fed with a musical value, and it will then generate a series of musical values in order to generate music.", "Here, a \u201cvalue\u201d represents a note, a duration, and it also contains information on whether another note is played at the same time (also called a chord).", "First, we define the number of hidden states in the network. In this case, we will use 64.", "Now, Keras has simple built-in functions to build the model. However, for sequence generation, not all input values are known; they are generated one at a time. Therefore, we need to add a custom for-loop, and define layer objects in order to have shared weights across steps.", "Now, we are ready to build the model:", "Now, we can create the model, compile it, and fit it to the data:", "Now, we get to the fun part: let\u2019s generate music with our model!", "At each sampling step, the activation and cell state from a previous LSTM cell will propagate in the following cell, and they will be used to generate another output.", "To generate music, we need to sample notes first:", "Whit that in place, we can now predict and create a sequence of music:", "The music is then generated with this code cell:", "You can find my generated music file (.midi file) in the repository.", "That\u2019s it! You learned what an LSTM unit is and how to apply it to generate music with Keras. Remember that an LSTM unit is just a block used in an RNN.", "For further reading, I suggest you look up the GRU unit, as it is a simpler version of an LSTM.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior data scientist | Author | Instructor. I write hands-on articles with a focus on practical skills."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffa0175b59012&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fa0175b59012--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fa0175b59012--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----fa0175b59012--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----fa0175b59012--------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd----fa0175b59012---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa0175b59012&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa0175b59012&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chrisbair?utm_source=medium&utm_medium=referral", "anchor_text": "Chris Bair"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel"}, {"url": "https://www.youtube.com/watch?v=uq-gYOrU8bA", "anchor_text": "You can call me Al"}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/5.Sequence%20Models/1.Recurrent%20Neural%20Networks/Improvise%20a%20Jazz%20Solo%20with%20LSTM.ipynb", "anchor_text": "full notebook"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "Source"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "Source"}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/tree/master/5.Sequence%20Models/1.Recurrent%20Neural%20Networks", "anchor_text": "repository"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fa0175b59012---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fa0175b59012---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fa0175b59012---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----fa0175b59012---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----fa0175b59012---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffa0175b59012&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----fa0175b59012---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffa0175b59012&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----fa0175b59012---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa0175b59012&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fa0175b59012--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffa0175b59012&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fa0175b59012---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fa0175b59012--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fa0175b59012--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fa0175b59012--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fa0175b59012--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fa0175b59012--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fa0175b59012--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fa0175b59012--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fa0175b59012--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/@marcopeixeiro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9835bccb3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-lstm-units-while-playing-jazz-fa0175b59012&newsletterV3=741c1c8fcfbd&newsletterV3Id=9835bccb3d51&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/time-series-forecasting-in-python-book", "anchor_text": "Time Series Forecasting in Python2022"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}