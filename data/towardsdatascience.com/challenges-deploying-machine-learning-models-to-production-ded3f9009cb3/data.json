{"url": "https://towardsdatascience.com/challenges-deploying-machine-learning-models-to-production-ded3f9009cb3", "time": 1683009676.471495, "path": "towardsdatascience.com/challenges-deploying-machine-learning-models-to-production-ded3f9009cb3/", "webpage": {"metadata": {"title": "Challenges Deploying Machine Learning Models to Production | by Adarsh Shah | Towards Data Science", "h1": "Challenges Deploying Machine Learning Models to Production", "description": "One of the known truths of the Machine Learning(ML) world is that it takes a lot longer to deploy ML models to production than to develop it. According to the famous paper \u201cHidden Technical Debt in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://papers.nips.cc/paper/5656-hidden-technical-debt-in-machine-learning-systems.pdf", "anchor_text": "Hidden Technical Debt in Machine Learning Systems", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/semantic-segmentation-popular-architectures-dff0a75f39d0", "anchor_text": "various architectures", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Hyperparameter_optimization", "anchor_text": "hyperparameter optimization", "paragraph_index": 14}, {"url": "https://jupyter.org/", "anchor_text": "Jupyter Notebook", "paragraph_index": 17}, {"url": "https://www.tesla.com/autopilotAI", "anchor_text": "website", "paragraph_index": 18}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/how-to-monitor-data-drift#what-is-data-drift", "anchor_text": "data drift", "paragraph_index": 20}, {"url": "https://en.wikipedia.org/wiki/Graphics_processing_unit", "anchor_text": "GPU", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Nvidia_Jetson", "anchor_text": "Nvidia Jetson series", "paragraph_index": 22}, {"url": "https://stackoverflow.com/questions/14794460/how-does-the-arm-architecture-differ-from-x86", "anchor_text": "ARM architecture instead of x86", "paragraph_index": 22}, {"url": "http://shahadarsh.com", "anchor_text": "shahadarsh.com", "paragraph_index": 30}], "all_paragraphs": ["Traditional Software Development vs Machine LearningMachine Learning WorkflowStage #1: Data Management- Large Data Size- High Quality- Data Versioning- Location- Security & ComplianceStage #2: Experimentation- Constant Research and Experimentation Workflow- Tracking Experiments- Code Quality- Training Time & Troubleshooting- Model Accuracy Evaluation- Retraining- Infrastructure RequirementsStage #3: Production Deployment- Offline/Online Prediction- Model DegradationConclusion", "One of the known truths of the Machine Learning(ML) world is that it takes a lot longer to deploy ML models to production than to develop it. According to the famous paper \u201cHidden Technical Debt in Machine Learning Systems\u201d:", "\u201cOnly a small fraction of real-world ML systems is composed of the ML code, as shown by the small black box in the middle(see diagram below). The required surrounding infrastructure is vast and complex.\u201d", "If you were to think of traditional software development in juxtaposition with Machine Learning, you can very clearly see where the latter diverges in diagram #2 below. Even though that\u2019s the case most of the principles and practices of traditional software development can be applied to Machine Learning but there are certain unique ML specific challenges that need to be handled differently. We will talk about those unique challenges that make it difficult to deploy ML models to production in this article.", "Typical ML workflow includes Data Management, Experimentation, and Production Deployment as seen in the workflow below.", "We will be looking at each stage below and the ML specific challenges that teams face with each of them.", "Training data is one of the fundamental factors that determine how well a model performs. This stage typically includes data acquisition and preparation. You need to be aware of the following challenges while working with ML data:", "Large Data Size: Models usually need large datasets during the training process to improve its accuracy during prediction against live data. Datasets can be in hundreds of Gigabytes or even larger. This brings up some unique challenges like moving around data is not as easy and there is usually a heavy cost associated with data transfer and is time-consuming.", "High-Quality Data: Having a large dataset is of no use if the quality of data is bad. Finding the right data of high quality is pretty important for model accuracy. Fetching data from the correct source and having enough validation to make sure that the quality is high helps the cause. Making sure your Model is not biased based on aspects like Race, Gender, Age, Income Groups, etc. is critical too. For that, you need to make sure you have Model Bias and Fairness Validation of your data.", "Dataset Tracking: Replicating how the model was trained is helpful for data scientists. For that, the dataset that was used during each training run needs to be versioned and tracked. This also gives data scientists the flexibility to go back to a previous version of the dataset and analyze it.", "Location: Depending on the use case these datasets reside at various locations and as mentioned above they might be of larger size. Because of these reasons, it might make sense to run the training and in some cases prediction closer to where the data is instead of transferring large data sets across locations.", "Caution: Make sure this is worth the effort. If you can manage without adding this complexity and run things centrally I would recommend you do that.", "Security & Compliance: In some cases, data being used might be sensitive or need to meet certain compliance standards (like HIPAA, PCI, or GDPR). You need to keep this in mind when you are supporting ML systems.", "This stage includes Model development where Data Scientists focus a lot of their time researching various architectures to see what fits their needs. For example, for Semantic Segmentation here are various architectures available. Data Scientists write code to use the data from the previous stage and use that to train the model and then do an evaluation to see if it meets the accuracy standards they are looking for. See below some of the challenges that you will face during this stage.", "Constant Research and Experimentation Workflow: They spend time collecting/generating data, experimenting, and trying out various architectures to see what works for their use case. They also try hyperparameter optimization and training with various datasets to see what gives more accurate results.", "Due to the research and experimental nature of this, the workflow that needs to be supported is different from traditional software development.", "Tracking Experiments: One of the key aspects of this workflow is to allow data scientists to track experiments and know what changed between various runs. They should easily be able to track dataset, architecture, code, and hyper-parameter changes between various experiments.", "Code Quality: Due to the research and experimentation phase a lot of code written is usually not of high quality and not ready for production. Data Scientists spend a lot of time working with tools like Jupyter Notebook and making changes there directly to test out. You need to keep this in mind and handle it before deploying ML models to production.", "Training Time & Troubleshooting: Training a model typically requires hours or sometimes days to run and needs special infrastructure(see challenge #4 below). For example, a full build of Tesla Autopilot neural networks takes 70,000 GPU hours to train as per their website. Since training typically takes a lot of time you need to be able to support easy troubleshooting using aspects like monitoring, logging, alerting, and validation during the training process. If the training process errors out, providing easy ways of fixing the issue, and continuing/restarting the training is important.", "Model Accuracy Evaluation: After training the model accuracy needs to be evaluated to see if it meets the standard required for prediction in production. As seen in diagram #3 above you reiterate through the training/data management steps to keep improving the accuracy until you reach an acceptable number.", "Retraining: In cases when you have a data drift, a bug in production, or change in requirements you might need to retrain the model. There needs to be a way to support retraining models.", "Infrastructure Requirements: ML workloads have certain special Infrastructure requirements like GPU & High-Density Cores. Thousands of processing cores run simultaneously in a GPU which enables training and prediction to run much faster compared to just CPUs. Since these infrastructure requirements (especially GPU) are costly and are needed mostly in periodic bursts for training, having support for elasticity and automation to scale as well as provision/de-provision infrastructure (especially when using the cloud) is a good idea.", "Edge Devices (IoT, mobile, etc) like the Nvidia Jetson series are more and more used these days, and deploying to these devices is another challenge as these devices mostly use ARM architecture instead of x86 that have limited resources. Models need to be tested on these devices for accuracy as well as performance.", "Due to lack of support for certain dependencies and their latest versions for the ARM architecture having good practices around building packages/models helps.", "After the model is trained and reaches certain accuracy it gets deployed to production where it starts making predictions against live data. Here are some challenges to be aware of for this stage.", "Offline/Online Prediction: Depending on the model and the way it is going to be used in production with live data you might have to support either offline (batch) prediction or online (real-time) prediction. You need an appropriate framework to serve the model based on the type (batch or real-time). If it\u2019s a batch prediction make sure you can schedule the batch job appropriately and for real-time, you need to worry about processing time since the result is usually needed back synchronously.", "Model Degradation: Model degrades (i.e. Predictions become less accurate) in Production due to various factors like data drift, environment changes, etc. over time. It\u2019s essential to have the information necessary to troubleshoot & fix a problem readily available to the teams so they can act on it.", "DevOps Principles and Practices that include all 3 aspects (People, Process & Technology) have been used effectively for mitigating challenges with traditional software. These same DevOps Principles and Practices along with some Machine Learning specific practices can be used for deploying & operating ML Systems successfully. These ML principles and practices are also known as MLOps or DevOps for Machine Learning. I will be writing follow-up articles that will look at those principles and practices that help overcome the challenges mentioned in this article.", "Acknowledgments: Priyanka Rao and Bobby Wagner read the draft version of this article and provided feedback to improve it.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Engineering Leader, Independent Consultant, Coach, Public Speaker, Hands-on Architect | Website: shahadarsh.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fded3f9009cb3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://shahadarsh.medium.com/?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": ""}, {"url": "https://shahadarsh.medium.com/?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": "Adarsh Shah"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4a718c031f75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&user=Adarsh+Shah&userId=4a718c031f75&source=post_page-4a718c031f75----ded3f9009cb3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fded3f9009cb3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fded3f9009cb3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://papers.nips.cc/paper/5656-hidden-technical-debt-in-machine-learning-systems.pdf", "anchor_text": "Hidden Technical Debt in Machine Learning Systems"}, {"url": "https://papers.nips.cc/paper/5656-hidden-technical-debt-in-machine-learning-systems.pdf", "anchor_text": "Hidden Technical Debt in Machine Learning Systems"}, {"url": "https://towardsdatascience.com/semantic-segmentation-popular-architectures-dff0a75f39d0", "anchor_text": "various architectures"}, {"url": "https://en.wikipedia.org/wiki/Hyperparameter_optimization", "anchor_text": "hyperparameter optimization"}, {"url": "https://jupyter.org/", "anchor_text": "Jupyter Notebook"}, {"url": "https://www.tesla.com/autopilotAI", "anchor_text": "website"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/how-to-monitor-data-drift#what-is-data-drift", "anchor_text": "data drift"}, {"url": "https://en.wikipedia.org/wiki/Graphics_processing_unit", "anchor_text": "GPU"}, {"url": "https://en.wikipedia.org/wiki/Nvidia_Jetson", "anchor_text": "Nvidia Jetson series"}, {"url": "https://stackoverflow.com/questions/14794460/how-does-the-arm-architecture-differ-from-x86", "anchor_text": "ARM architecture instead of x86"}, {"url": "https://shahadarsh.com/2020/06/19/challenges-deploying-machine-learning-models-to-production/", "anchor_text": "my website"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ded3f9009cb3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mlops?source=post_page-----ded3f9009cb3---------------mlops-----------------", "anchor_text": "Mlops"}, {"url": "https://medium.com/tag/devops4ml?source=post_page-----ded3f9009cb3---------------devops4ml-----------------", "anchor_text": "Devops4ml"}, {"url": "https://medium.com/tag/devops?source=post_page-----ded3f9009cb3---------------devops-----------------", "anchor_text": "DevOps"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ded3f9009cb3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fded3f9009cb3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&user=Adarsh+Shah&userId=4a718c031f75&source=-----ded3f9009cb3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fded3f9009cb3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&user=Adarsh+Shah&userId=4a718c031f75&source=-----ded3f9009cb3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fded3f9009cb3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fded3f9009cb3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ded3f9009cb3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ded3f9009cb3--------------------------------", "anchor_text": ""}, {"url": "https://shahadarsh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://shahadarsh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adarsh Shah"}, {"url": "https://shahadarsh.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "http://shahadarsh.com", "anchor_text": "shahadarsh.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4a718c031f75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&user=Adarsh+Shah&userId=4a718c031f75&source=post_page-4a718c031f75--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe3e4b1390763&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchallenges-deploying-machine-learning-models-to-production-ded3f9009cb3&newsletterV3=4a718c031f75&newsletterV3Id=e3e4b1390763&user=Adarsh+Shah&userId=4a718c031f75&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}