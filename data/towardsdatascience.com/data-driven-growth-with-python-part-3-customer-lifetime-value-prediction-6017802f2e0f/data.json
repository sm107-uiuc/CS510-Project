{"url": "https://towardsdatascience.com/data-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f", "time": 1682996052.751115, "path": "towardsdatascience.com/data-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f/", "webpage": {"metadata": {"title": "Customer Lifetime Value Prediction | by Bar\u0131\u015f Karaman | Towards Data Science", "h1": "Customer Lifetime Value Prediction", "description": "LTV prediction with XGBoost Multi-classification"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-b-testing-design-execution-6cf9e27c6559", "anchor_text": "9- A/B Testing Design and Execution", "paragraph_index": 2}, {"url": "https://www.kaggle.com/learn/python?source=post_page---------------------------", "anchor_text": "Python", "paragraph_index": 3}, {"url": "https://www.kaggle.com/learn/pandas?source=post_page---------------------------", "anchor_text": "Pandas", "paragraph_index": 3}, {"url": "https://jupyter.readthedocs.io/en/latest/install.html?source=post_page---------------------------", "anchor_text": "upyter Notebook", "paragraph_index": 5}, {"url": "https://www.python.org/downloads/?source=post_page---------------------------", "anchor_text": "ython", "paragraph_index": 5}, {"url": "https://medium.com/@karamanbk/data-driven-growth-with-python-part-2-customer-segmentation-5c019d150444", "anchor_text": "previous article", "paragraph_index": 6}, {"url": "https://www.kaggle.com/vijayuv/onlineretail", "anchor_text": "online retail dataset", "paragraph_index": 12}, {"url": "https://medium.com/@karamanbk/data-driven-growth-with-python-part-2-customer-segmentation-5c019d150444", "anchor_text": "previous article", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/churn-prediction-3a4a36c2129a", "anchor_text": "Part 4", "paragraph_index": 43}, {"url": "https://gist.github.com/karamanbk/29983fdf5572a838f53163a6010b14f9", "anchor_text": "here", "paragraph_index": 44}, {"url": "https://app.growthmentor.com/mentors/baris-karaman", "anchor_text": "here", "paragraph_index": 45}], "all_paragraphs": ["This series of articles was designed to explain how to use Python in a simplistic way to fuel your company\u2019s growth by applying the predictive approach to all your actions. It will be a combination of programming, data analysis, and machine learning.", "I will cover all the topics in the following nine articles:", "9- A/B Testing Design and Execution", "Articles will have their own code snippets to make you easily apply them. If you are super new to programming, you can have a good introduction for Python and Pandas (a famous library that we will use on everything) here. But still without a coding introduction, you can learn the concepts, how to use your data and start generating value out of it:", "Sometimes you gotta run before you can walk \u2014 Tony Stark", "As a pre-requisite, be sure Jupyter Notebook and Python are installed on your computer. The code snippets will run on Jupyter Notebook only.", "In the previous article, we segmented our customers and found out who are the best ones. Now it\u2019s time to measure one of the most important metric we should closely track: Customer Lifetime Value.", "We invest in customers (acquisition costs, offline ads, promotions, discounts & etc.) to generate revenue and be profitable. Naturally, these actions make some customers super valuable in terms of lifetime value but there are always some customers who pull down the profitability. We need to identify these behavior patterns, segment customers and act accordingly.", "Calculating Lifetime Value is the easy part. First we need to select a time window. It can be anything like 3, 6, 12, 24 months. By the equation below, we can have Lifetime Value for each customer in that specific time window:", "Lifetime Value: Total Gross Revenue - Total Cost", "This equation now gives us the historical lifetime value. If we see some customers having very high negative lifetime value historically, it could be too late to take an action. At this point, we need to predict the future with machine learning:", "We are going to build a simple machine learning model that predicts our customers lifetime value.", "We will continue using our online retail dataset for this example as well. Let\u2019s identify our path to glory:", "Deciding the time frame really depends on your industry, business model, strategy and more. For some industries, 1 year is a very long period while for the others it is very short. In our example, we will go ahead with 6 months.", "RFM scores for each customer ID (which we calculated in the previous article) are the perfect candidates for feature set. To implement it correctly, we need to split our dataset. We will take 3 months of data, calculate RFM and use it for predicting next 6 months. So we need to create two dataframes first and append RFM scores to them.", "We have created our RFM scoring and now our feature set looks like below:", "I won\u2019t go over the details of RFM scoring as I would be repeating Part 2.", "Since our feature set is ready, let\u2019s calculate 6 months LTV for each customer which we are going to use for training our model.", "There is no cost specified in the dataset. That\u2019s why Revenue becomes our LTV directly.", "This code snippet calculates the LTV and plot its histogram:", "Histogram clearly shows we have customers with negative LTV. We have some outliers too. Filtering out the outliers makes sense to have a proper machine learning model.", "Ok, next step. We will merge our 3 months and 6 months dataframes to see correlations between LTV and the feature set we have.", "The code below merges our feature set and LTV data and plots LTV vs overall RFM score:", "Positive correlation is quite visible here. High RFM score means high LTV.", "Before building the machine learning model, we need to identify what is the type of this machine learning problem. LTV itself is a regression problem. A machine learning model can predict the $ value of the LTV. But here, we want LTV segments. Because it makes it more actionable and easy to communicate with other people. By applying K-means clustering, we can identify our existing LTV groups and build segments on top of it.", "Considering business part of this analysis, we need to treat customers differently based on their predicted LTV. For this example, we will apply clustering and have 3 segments (number of segments really depends on your business dynamics and goals):", "We are going to apply K-means clustering to decide segments and observe their characteristics:", "We have finished LTV clustering and here are the characteristics of each clusters:", "2 is the best with average 8.2k LTV whereas 0 is the worst with 396.", "There are few more step before training the machine learning model:", "The code below does it all for us:", "Let\u2019s start with the first line. get_dummies() method converts categorical columns to 0\u20131 notations. See what it exactly does with the example:", "This was our dataset before get_dummies(). We have one categorical column which is Segment. What happens after applying get_dummies():", "Segment column is gone but we have new numerical ones which represent it. We have converted it to 3 different columns with 0 and 1 and made it usable for our machine learning model.", "Lines related to correlation make us have the data below:", "We see that 3 months Revenue, Frequency and RFM scores will be helpful for our machine learning models.", "Since we have the training and test sets we can build our model.", "We used a quite strong ML library called XGBoost to do the classification for us. It has become a multi classification model since we had 3 groups (clusters). Let\u2019s look at the initial results:", "Accuracy shows 84% on the test set. Looks really good. Or does it?", "First we need to check our benchmark. Biggest cluster we have is cluster 0 which is 76.5% of the total base. If we blindly say, every customer belongs to cluster 0, then our accuracy would be 76.5%.", "84% vs 76.5% tell us that our machine learning model is a useful one but needs some improvement for sure. We should find out where the model is failing.", "We can identify that by looking at classification report:", "Precision and recall are acceptable for 0. As an example, for cluster 0 (Low LTV), if model tells us this customer belongs to cluster 0, 90 out of 100 will be correct (precision). And the model successfully identifies 93% of actual cluster 0 customers (recall). We really need to improve the model for other clusters. For example, we barely detect 56% of Mid LTV customers. Possible actions to improve those points:", "Great! Now we have a machine learning model which predicts the future LTV segments of our customers. We can easily adapt our actions based on that. For example, we definitely do not want to lose customers with high LTV. So we will focus on Churn Prediction in Part 4.", "You can find the jupyter notebook for this part here.", "Need help growing your company? Book a free session with me here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6017802f2e0f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@karamanbk?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@karamanbk?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": "Bar\u0131\u015f Karaman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd48af1458440&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&user=Bar%C4%B1%C5%9F+Karaman&userId=d48af1458440&source=post_page-d48af1458440----6017802f2e0f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6017802f2e0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6017802f2e0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/data-driven-growth", "anchor_text": "Data Driven Growth with Python"}, {"url": "https://towardsdatascience.com/data-driven-growth-with-python-part-1-know-your-metrics-812781e66a5b?source=post_page---------------------------", "anchor_text": "Know Your Metrics"}, {"url": "https://towardsdatascience.com/data-driven-growth-with-python-part-2-customer-segmentation-5c019d150444?source=post_page---------------------------", "anchor_text": "Customer Segmentation"}, {"url": "https://towardsdatascience.com/churn-prediction-3a4a36c2129a?source=post_page---------------------------", "anchor_text": "Churn Prediction"}, {"url": "https://towardsdatascience.com/predicting-next-purchase-day-15fae5548027?source=post_page---------------------------", "anchor_text": "5- Predicting Next Purchase Day"}, {"url": "https://towardsdatascience.com/predicting-sales-611cb5a252de?source=post_page---------------------------", "anchor_text": "6- Predicting Sales"}, {"url": "https://towardsdatascience.com/market-response-models-baf9f9913298", "anchor_text": "7- Market Response Models"}, {"url": "https://towardsdatascience.com/uplift-modeling-e38f96b1ef60", "anchor_text": "8- Uplift Modeling"}, {"url": "https://towardsdatascience.com/a-b-testing-design-execution-6cf9e27c6559", "anchor_text": "9- A/B Testing Design and Execution"}, {"url": "https://www.kaggle.com/learn/python?source=post_page---------------------------", "anchor_text": "Python"}, {"url": "https://www.kaggle.com/learn/pandas?source=post_page---------------------------", "anchor_text": "Pandas"}, {"url": "https://jupyter.readthedocs.io/en/latest/install.html?source=post_page---------------------------", "anchor_text": "upyter Notebook"}, {"url": "https://www.python.org/downloads/?source=post_page---------------------------", "anchor_text": "ython"}, {"url": "https://medium.com/@karamanbk/data-driven-growth-with-python-part-2-customer-segmentation-5c019d150444", "anchor_text": "previous article"}, {"url": "https://www.kaggle.com/vijayuv/onlineretail", "anchor_text": "online retail dataset"}, {"url": "https://medium.com/@karamanbk/data-driven-growth-with-python-part-2-customer-segmentation-5c019d150444", "anchor_text": "previous article"}, {"url": "https://towardsdatascience.com/churn-prediction-3a4a36c2129a", "anchor_text": "Part 4"}, {"url": "https://gist.github.com/karamanbk/29983fdf5572a838f53163a6010b14f9", "anchor_text": "here"}, {"url": "https://app.growthmentor.com/mentors/baris-karaman", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6017802f2e0f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6017802f2e0f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----6017802f2e0f---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/entrepreneurship?source=post_page-----6017802f2e0f---------------entrepreneurship-----------------", "anchor_text": "Entrepreneurship"}, {"url": "https://medium.com/tag/data-driven-growth?source=post_page-----6017802f2e0f---------------data_driven_growth-----------------", "anchor_text": "Data Driven Growth"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6017802f2e0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&user=Bar%C4%B1%C5%9F+Karaman&userId=d48af1458440&source=-----6017802f2e0f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6017802f2e0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&user=Bar%C4%B1%C5%9F+Karaman&userId=d48af1458440&source=-----6017802f2e0f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6017802f2e0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6017802f2e0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6017802f2e0f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6017802f2e0f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6017802f2e0f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6017802f2e0f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6017802f2e0f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@karamanbk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@karamanbk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bar\u0131\u015f Karaman"}, {"url": "https://medium.com/@karamanbk/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.3K Followers"}, {"url": "https://www.linkedin.com/in/karamanbaris", "anchor_text": "https://www.linkedin.com/in/karamanbaris"}, {"url": "https://app.growthmentor.com/baris-karaman", "anchor_text": "https://app.growthmentor.com/baris-karaman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd48af1458440&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&user=Bar%C4%B1%C5%9F+Karaman&userId=d48af1458440&source=post_page-d48af1458440--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc6ea78ac919d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f&newsletterV3=d48af1458440&newsletterV3Id=c6ea78ac919d&user=Bar%C4%B1%C5%9F+Karaman&userId=d48af1458440&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}