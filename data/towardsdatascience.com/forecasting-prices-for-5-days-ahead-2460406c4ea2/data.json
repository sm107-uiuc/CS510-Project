{"url": "https://towardsdatascience.com/forecasting-prices-for-5-days-ahead-2460406c4ea2", "time": 1682997448.5460758, "path": "towardsdatascience.com/forecasting-prices-for-5-days-ahead-2460406c4ea2/", "webpage": {"metadata": {"title": "Forecasting Prices for Many Days Ahead | by Leandro Rabelo | Towards Data Science", "h1": "Forecasting Prices for Many Days Ahead", "description": "Within a company, there are several risk factors to be considered and managed. For instance, price changes where the manager has to decide the best moment to sell; product demand forecast to improve\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average", "anchor_text": "ARIMA", "paragraph_index": 3}, {"url": "https://www.cepea.esalq.usp.br/br/indicador/acucar.aspx", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://github.com/leandrovrabelo/tsmodels/blob/master/notebooks/english/Creating%20a%20Price%20Forecast%20for%205%20days%20Ahead.ipynb", "anchor_text": "GitHub", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/basic-principles-to-create-a-time-series-forecast-6ae002d177a4?source=friends_link&sk=15a1d49ec9542c21f90eebe660b1455c", "anchor_text": "Basic Principles to Create a Time Series Forecast", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Autocorrelation", "anchor_text": "autocorrelation", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Dickey%E2%80%93Fuller_test", "anchor_text": "Dickey Fuller", "paragraph_index": 9}, {"url": "https://www.linkedin.com/in/leandro-rabelo-08722824/", "anchor_text": "LinkedIn", "paragraph_index": 33}], "all_paragraphs": ["Within a company, there are several risk factors to be considered and managed. For instance, price changes where the manager has to decide the best moment to sell; product demand forecast to improve the inventory management. Another important factor to evaluate is forecasts about recurrent expenses since expressive values can impact the company\u2019s working capital.", "Usually, the forecasts on prices, demand, expenses, etc. are created taking into account the manager\u2019s domain knowledge as well as essential information on the specific subject that influences decision making.", "When predictive models are used, the data is separated between training and test set, the coefficients are generated in the training data and they are usually tested step by step in the test set. Thus, only one period is forecasted, then it updates with real values and so on until the end of the test set.", "For this post an ARIMA model will be created, where the coefficients obtained in the training set will be tested in a slightly different way. 5 consecutive days will be forecasted and the series will be updated with real data (5 days in a row) and again, new forecasts will be created for 5 periods until the test data is over.", "This kind of approach is interesting for those who want to create forecast models with several periods ahead, since it can easily be used to compare the forecasted extrapolations with real data, thus, verify what are the main characteristics of the model and what are the points that can be improved.", "The main purpose of the model is to forecast the daily price for the next 5 days for 50kg bags of Crystal Sugar informed by Esalq, the data can be downloaded here (please, download the data from the Brazilian site, the English version doesn\u2019t have the prices in Brazilian Reais (BRL), and the Jupyter Notebook with all codes can be found on my GitHub.", "From now on, we will use the following steps extracted from my post: Basic Principles to Create a Time Series Forecast. (In case you are not yet familiar with the basis for creating these forecasts, I highly recommend you read it):", "We have a price history of approximately 16 years and I will reserve the last 250 working days (approx 1 year) to test the model. There will be 50 comparatives of 5 days each, between the forecasts and current values. Note that all previous data will be used to train the model:", "In order to create a time series forecast, it\u2019s necessary that the series is stationary. So, it has to have the following relatively constant conditions: mean, variance and autocorrelation.", "Below I will use the function to plot the series, its distribution, autocorrelation, partial autocorrelation. Also, the Dickey Fuller statistical test will be used to check the stationarity:", "To verify if the values on the training data are stationary, we will use the P value of 5% as a basis, if the P-value of this test is less than 5% we may consider the series as stationary:", "As we analyze the graphics, a slight upward trend is noticed on the price, the distribution graph shows that the data doesn\u2019t follow a Gaussian normality, and the characteristics of the autocorrelation show significant correlations on all lags (this is a sign of a series with some trend) and finally the statistical values informs that the P value was 8.7%.", "Thus, this series does not meet the criteria established to be considered stationary.", "I will make the first difference in order to cancel the trend and remain only on the day-to-day movements:", "The Dickey Fuller test returned zero on the P value, which means that the series became stationary. In addition to that, in the price graph the trend has disappeared and prices are relatively stable.", "In the autocorrelation graph the values gradually decrease, different from the graph without a first difference.", "The partial autocorrelation falls more abruptly, showing that the first three values have more impact on the current values. Apparently, there\u2019s no significant seasonal correlation to be considered in the predictions.", "Along these lines, we may consider an auto regressive model with the first 3 lags in a differenced series, so we will use this following terminology for the model: ARIMA (3, 1,0)", "Initially, the model will be created based on the training data, thus the coefficients for the 3 auto correlated lags will be generated and will serve to test the extrapolation of 5 consecutive days in the test set.", "There are several ways to make extrapolations for the future, the main ones are:", "We will use the last model in this example, in this case we will forecast the next 5 days, compare with real data, add the latter to the model in order to make a new extrapolation, and later we will calculate the error of the model and analyze relevant facts of the forecast.", "Now that the model has been trained, let\u2019s compare the real data with the forecasted ones in the following graph:", "In the training set, the model manages to capture the main moments of the market. The only time in which the forecast can not capture the movement is when there are greater variations. Analyzing the error, the RMSE was BRL 4.967/bag.", "After training the model, we can obtain the multiplication coefficients of the differenced values and also the constant of the model, these values will serve as a basis for extrapolating the forecasts for the next 5 days.", "The next step is to use these multiplication coefficients to test the extrapolations in the test set. To better visualize, a function that separates each five-day forecast was used to be compared with the real data. Although we can see, in the chart bellow, that the main characteristic of this kind of forecast is that it follows the latest trend being negotiated. There is still room for improvement, since the model itself is not able to forecast possible changes in trends.", "Analyzing the RMSE on the test set we had:", "The next part will be to analyze the error with more details:", "The average error for each step will be analyzed separately. Usually, the tendency is that the error, in this case the RMSE, increases according to the extrapolated periods due to uncertainties:", "As predicted, at each step the RMSE increases, this is due to the uncertainties regarding the future and also that the forecasts starting from the second step are made based on forecasted values and not real ones.", "Here are some ideas that can help to improve the accuracy of the model:", "Creating forecasts with several periods ahead with simple models, or even Artificial Intelligence techniques are undoubtedly a tool of extreme importance.", "Faced with an increasingly competitive market, creating a model with a good accuracy can be a differential for the company, because it can capture possible market movements that may be essential in the decision making of the administrator.", "Models like this can be used as an important tool to create cash flows, manage production and inventory, as well as identify market opportunities.", "I hope you liked this post! Please don\u2019t hesitate to contact me if you have question or need more information. Here is the link to connect with me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Into Time Series, Data Science and Machine Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2460406c4ea2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@leandrovrabelo2?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@leandrovrabelo2?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": "Leandro Rabelo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6d252678d6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&user=Leandro+Rabelo&userId=b6d252678d6c&source=post_page-b6d252678d6c----2460406c4ea2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2460406c4ea2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2460406c4ea2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average", "anchor_text": "ARIMA"}, {"url": "https://www.cepea.esalq.usp.br/br/indicador/acucar.aspx", "anchor_text": "here"}, {"url": "https://github.com/leandrovrabelo/tsmodels/blob/master/notebooks/english/Creating%20a%20Price%20Forecast%20for%205%20days%20Ahead.ipynb", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/basic-principles-to-create-a-time-series-forecast-6ae002d177a4?source=friends_link&sk=15a1d49ec9542c21f90eebe660b1455c", "anchor_text": "Basic Principles to Create a Time Series Forecast"}, {"url": "https://en.wikipedia.org/wiki/Autocorrelation", "anchor_text": "autocorrelation"}, {"url": "https://en.wikipedia.org/wiki/Dickey%E2%80%93Fuller_test", "anchor_text": "Dickey Fuller"}, {"url": "https://www.linkedin.com/in/leandro-rabelo-08722824/", "anchor_text": "LinkedIn"}, {"url": "https://machinelearningmastery.com/multi-step-time-series-forecasting-with-machine-learning-models-for-household-electricity-consumption/", "anchor_text": "Multi-step Time Series Forecasting with Machine Learning for Electricity UsageGiven the rise of smart electricity meters and the wide adoption of electricity generation technology like solar\u2026machinelearningmastery.com"}, {"url": "https://machinelearningmastery.com/multi-step-time-series-forecasting/", "anchor_text": "4 Strategies for Multi-Step Time Series ForecastingTime series forecasting is typically discussed where only a one-step prediction is required. What about when you need\u2026machinelearningmastery.com"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----2460406c4ea2---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----2460406c4ea2---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2460406c4ea2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----2460406c4ea2---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2460406c4ea2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&user=Leandro+Rabelo&userId=b6d252678d6c&source=-----2460406c4ea2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2460406c4ea2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&user=Leandro+Rabelo&userId=b6d252678d6c&source=-----2460406c4ea2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2460406c4ea2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2460406c4ea2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2460406c4ea2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2460406c4ea2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2460406c4ea2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2460406c4ea2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2460406c4ea2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@leandrovrabelo2?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@leandrovrabelo2?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Leandro Rabelo"}, {"url": "https://medium.com/@leandrovrabelo2/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "380 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6d252678d6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&user=Leandro+Rabelo&userId=b6d252678d6c&source=post_page-b6d252678d6c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F97c8f5ad5b0b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-prices-for-5-days-ahead-2460406c4ea2&newsletterV3=b6d252678d6c&newsletterV3Id=97c8f5ad5b0b&user=Leandro+Rabelo&userId=b6d252678d6c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}