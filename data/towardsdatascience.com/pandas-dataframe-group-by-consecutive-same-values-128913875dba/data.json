{"url": "https://towardsdatascience.com/pandas-dataframe-group-by-consecutive-same-values-128913875dba", "time": 1683010403.053213, "path": "towardsdatascience.com/pandas-dataframe-group-by-consecutive-same-values-128913875dba/", "webpage": {"metadata": {"title": "Pandas DataFrame Group by Consecutive Same Values | by Christopher Tao | Towards Data Science", "h1": "Pandas DataFrame Group by Consecutive Same Values", "description": "Python Pandas DataFrame group by consecutive same/unchanged values. Data Analytics, Data Analysis and Data Science. Data Scientists must know."}, "outgoing_paragraph_urls": [], "all_paragraphs": ["It is very common that we want to segment a Pandas DataFrame by consecutive values. However, dealing with consecutive values is almost always not easy in any circumstances such as SQL, so does Pandas. Also, standard SQL provides a bunch of window functions to facilitate this kind of manipulation, but there are not too many window functions handy in Pandas. Fortunately, there are many workarounds in Python and sometimes make it even easier than classic window functions.", "In this article, I\u2019ll demonstrate how to group Pandas DataFrame by consecutive same values that repeat one or multiple times.", "If you are still not quite sure what is the problem we\u2019re trying to solve, don\u2019t worry, you will understand by the sample data that is generated as follows:", "In the screenshot, the green lines split the groups that we expected.", "In this example, it is actually very easy to group these values. Just simple groupby('v').", "However, it is actually assuming that the value v must be monotonically increasing.", "What if the value column is not monotonically increasing?", "In this new example, we added the 13th row which has its value v == 3 again. If we simply groupby('v'), the 13th row will be put in the same group as the 2nd, 3rd and 4th rows, which is not what we want.", "In other words, the 13th row should be in a separated group, because it is not consecutive.", "The basic idea is to create such a column that can be grouped by. It must have the same values for the consecutive original values, but different values when the original value changes. We can use cumsum(). Here are the intuitive steps.", "Here is a sample DataFrame created for intuition purposes only.", "Why does it work? If you focus on each group:", "I know the intuition looks complicated, but once you understand those, it is very easy to use this approach as follows.", "Very importantly, the 13th row is grouped separately with the 2nd, 3rd and 4th row, which is exactly what we expected.", "Therefore, this approach will be able to group the consecutive values regardless of whether the values are repeated later on or not, as long as it is not consecutive, another group will be created.", "Indeed, I wouldn\u2019t say that Pandas provides many useful window functions. However, Pandas in Python is a typical \u201cprogramming language\u201d not like SQL. So, it provides a lot more possibilities and sometimes can solve problems in even simpler ways.", "If you feel my articles are helpful, please consider joining Medium Membership to support me and thousands of other writers! (Click the link above)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F128913875dba&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----128913875dba--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----128913875dba--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://qiuyujx.medium.com/?source=post_page-----128913875dba--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=post_page-----128913875dba--------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308----128913875dba---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F128913875dba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F128913875dba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/MichaelGaida-652234/", "anchor_text": "MichaelGaida"}, {"url": "https://pixabay.com/photos/stadium-sit-auditorium-grandstand-1750794/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/Anemone123-2637160/", "anchor_text": "Anemone123"}, {"url": "https://pixabay.com/photos/question-question-mark-survey-2736480/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/qimono-1962238/", "anchor_text": "qimono"}, {"url": "https://pixabay.com/photos/light-bulbs-chosen-bulb-light-1875384/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/rubylia-2153926/", "anchor_text": "rubylia"}, {"url": "https://pixabay.com/photos/hand-rubik-cube-puzzle-game-2208491/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/Free-Photos-242387/", "anchor_text": "Free-Photos"}, {"url": "https://pixabay.com/photos/macbook-notebook-home-office-336704/", "anchor_text": "Pixabay"}, {"url": "https://medium.com/@qiuyujx/membership", "anchor_text": "Join Medium with my referral link \u2014 Christopher TaoAs a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://medium.com/tag/python?source=post_page-----128913875dba---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----128913875dba---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----128913875dba---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----128913875dba---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----128913875dba---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F128913875dba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&user=Christopher+Tao&userId=b8176fabf308&source=-----128913875dba---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F128913875dba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&user=Christopher+Tao&userId=b8176fabf308&source=-----128913875dba---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F128913875dba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----128913875dba--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F128913875dba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----128913875dba---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----128913875dba--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----128913875dba--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----128913875dba--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----128913875dba--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----128913875dba--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----128913875dba--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----128913875dba--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----128913875dba--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://qiuyujx.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8.7K Followers"}, {"url": "https://www.linkedin.com/in/christopher-tao-5717a274/", "anchor_text": "https://www.linkedin.com/in/christopher-tao-5717a274/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d2af94a683f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-same-values-128913875dba&newsletterV3=b8176fabf308&newsletterV3Id=1d2af94a683f&user=Christopher+Tao&userId=b8176fabf308&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}