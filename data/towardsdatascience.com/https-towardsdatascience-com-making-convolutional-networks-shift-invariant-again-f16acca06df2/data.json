{"url": "https://towardsdatascience.com/https-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2", "time": 1683000925.792629, "path": "towardsdatascience.com/https-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2/", "webpage": {"metadata": {"title": "Making Convolutional Networks Shift-Invariant Again | by Kayo Yin | Towards Data Science", "h1": "Making Convolutional Networks Shift-Invariant Again", "description": "What\u2019s wrong with modern convolutional networks and how can we fix them? An overview, discussion and application of the recent April 2019 paper."}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1904.11486", "anchor_text": "\u201cMaking Convolutional Networks Shift-Invariant Again\u201d", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/latest-winning-techniques-for-kaggle-image-classification-with-limited-data-5259e7736327", "anchor_text": "image classification on greyscale images", "paragraph_index": 16}, {"url": "http://kayoyin.github.io/blog", "anchor_text": "kayoyin.github.io/blog", "paragraph_index": 21}], "all_paragraphs": ["In April 2019, a new computer vision paper appeared, titled \u201cMaking Convolutional Networks Shift-Invariant Again\u201d. Why are modern convolutional networks not shift-invariant anymore, what does this mean, and how do we make them shift-invariant again?", "Most modern convolutional networks are not robust against small shifts or translations. For instance, the network outputs can change drastically depending on the input position.", "Though convolutions are shift-equivariant and pooling builds up shift-invariance, striding ignores the Nyquist sampling theorem and aliases, which breaks shift equivariance. Striding can be seen during max-pooling and strided convolutions.", "Sampling theorem: A bandlimited continuous-time signal can be sampled and perfectly reconstructed from its samples if the waveform is sampled over twice as fast as it\u2019s highest frequency component.", "In signal processing, blurring is used before subsampling as means of anti-aliasing. In deep learning, this method was eventually replaced by max-pooling when the latter demonstrated better performance empirically.", "Existing work propose various methods to add anti-aliasing capabilities to downsampling, such as by extracting features densely, by softly gating between max and average pooling or with convolutional kernel networks. However, these methods are either computationally expensive, does not fully utilize the anti-aliasing capability of average pooling, or demonstrate lower accuracy. Also, most existing work consider max-pooling and average pooling as two separate, incompatible downsampling strategies.", "The paper attempts to reconcile classic anti-aliasing with max-pooling. First, notice that the max-pooling operation is equivalent to taking the max in a dense fashion, and subsampling from this intermediate feature map. The first operation, dense evaluation, actually does not alias at all; the problem lies in the subsampling operation. Therefore, we can add a blur filter before subsampling to reduce aliasing. Blurring and subsampling are evaluated together as BlurPool.", "Anti-aliasing can be similarly applied to other convolutional networks. For strided convolution, we can simply add a BlurPool layer after the convolution and activation. Average pooling is equivalent to blurred downsampling with a box filter, so replacing it with BlurPool that employs a stronger filter can provide better shift-equivariance. BlurPool is tested with the following blur filters: Rectangle-2 [1,1], Triangle-3 [1,2,1] and Binomial-5 [1, 4, 6, 4, 1].", "The new subsampling strategies are tested on image classification and generation, across different computer vision architectures. To evaluate anti-aliasing performance, three shift-invariance/equivariance metrics are proposed:", "First, by considering convolutional networks as feature extractors where each layer is a feature map. Then, one metric is internal feature distance, which is the cosine distance between the shifted output of the feature map, and the output of the feature map with the shifted input.", "Next, we may evaluate classification consistency by checking how often the model predicts the same class for two different shifts from the same image.", "For image generation, we can evaluate generation stability by testing if a shift in the input image generates an output that is the shifted version of the output from the original image.", "By computing the internal feature distance throughout the layers of the VGG network for various horizontal and vertical shifts, we observe that the anti-aliased network maintains better shift-equivariance, and the resulting output is more shift-variant. Unlike the baseline network, there is no considerable deviation from perfect shift-equivariance in downsampling layers.", "For image classification, adding low-pass filters increases classification consistency by ResNet50, where strong filters increase stability even more. Moreover, absolute classification accuracy is also improved with the addition of these filters, without adding learnable parameters. Indeed, low-pass filtering can serve as effective regularization.", "For image generation, low-pass filters are added to strided-convolution layers of the U-Net architecture. PSNR between generated images with inputs with and without shifts also increases, meaning the outputs are more similar.", "Furthermore, this anti-aliasing method also improves stability to other perturbations such as noise. It also decreases mean error rate for classification on corrupted images. Antialiasing thus helps in obtaining a more robust and generalizable network for various architectures and tasks.", "I tried the model myself by fine-tuning a pre-trained anti-aliased Resnet18 model for image classification on greyscale images with under 4 000 training data. Initially, this task is challenging because the model tends to overfit on scarce training data. Anti-aliasing indeed helps the model generalize, and testing accuracy increased from 0.95865 to 0.97115.", "The method proposed by this paper is remarkable because it increases performance without adding any learnable parameters. Having shift-invariant convolution networks means we no longer require shifting data augmentation. Both help keep computation time short and generalize better in computer vision tasks.", "The initial problem lies where images may seem similar visually, but actually have a large distance between them. Shifted images are precisely a common example of such a phenomenon. Let us remind ourselves that good convolutional networks should cater to human vision. Images that look the same to us should also be so for machines. Shift-invariant networks thus better emulate human perception, as features extracted by the network have better shift-equivariance, and shifted images are more often considered to be the same.", "Classical signal processing practices blurring for anti-aliasing, but it has disappeared in modern convolutional networks in an aim to optimize performance. With this paper's results demonstrating adding anti-aliasing to current convolutional networks improves both shift-equivariance and task performance, it is perhaps time to bring back blurring filters and make convolutional networks shift-invariant again!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student at UC Berkeley researching AI. Now writing at kayoyin.github.io/blog"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff16acca06df2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f16acca06df2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f16acca06df2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kayo.yin?source=post_page-----f16acca06df2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kayo.yin?source=post_page-----f16acca06df2--------------------------------", "anchor_text": "Kayo Yin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fee0d7547aae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&user=Kayo+Yin&userId=ee0d7547aae1&source=post_page-ee0d7547aae1----f16acca06df2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff16acca06df2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff16acca06df2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://istock.com/sarhange1", "anchor_text": "istock.com/sarhange1"}, {"url": "https://arxiv.org/abs/1904.11486", "anchor_text": "\u201cMaking Convolutional Networks Shift-Invariant Again\u201d"}, {"url": "https://icml.cc/media/Slides/icml/2019/seasideball(12-14-00)-12-15-05-4561-making_convolut.pdf", "anchor_text": "The two sets of images look identical to us, but not to the convolutional network!"}, {"url": "https://towardsdatascience.com/latest-winning-techniques-for-kaggle-image-classification-with-limited-data-5259e7736327", "anchor_text": "image classification on greyscale images"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f16acca06df2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----f16acca06df2---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----f16acca06df2---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f16acca06df2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----f16acca06df2---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff16acca06df2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&user=Kayo+Yin&userId=ee0d7547aae1&source=-----f16acca06df2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff16acca06df2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&user=Kayo+Yin&userId=ee0d7547aae1&source=-----f16acca06df2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff16acca06df2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f16acca06df2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff16acca06df2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f16acca06df2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f16acca06df2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f16acca06df2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f16acca06df2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f16acca06df2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f16acca06df2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f16acca06df2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f16acca06df2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f16acca06df2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kayo.yin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kayo.yin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kayo Yin"}, {"url": "https://medium.com/@kayo.yin/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "538 Followers"}, {"url": "http://kayoyin.github.io/blog", "anchor_text": "kayoyin.github.io/blog"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fee0d7547aae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&user=Kayo+Yin&userId=ee0d7547aae1&source=post_page-ee0d7547aae1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F97e53eb796c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-making-convolutional-networks-shift-invariant-again-f16acca06df2&newsletterV3=ee0d7547aae1&newsletterV3Id=97e53eb796c&user=Kayo+Yin&userId=ee0d7547aae1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}