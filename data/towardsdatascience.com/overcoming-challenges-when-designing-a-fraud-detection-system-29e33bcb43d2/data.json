{"url": "https://towardsdatascience.com/overcoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2", "time": 1682995496.946341, "path": "towardsdatascience.com/overcoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2/", "webpage": {"metadata": {"title": "Overcoming challenges when designing a fraud detection system | by Juan De Dios Santos | Towards Data Science", "h1": "Overcoming challenges when designing a fraud detection system", "description": "Designing a fraud detection system is a challenging task. In this article I explain how choosing the right model and metric can improve our prediction systems."}, "outgoing_paragraph_urls": [{"url": "https://juandes.com", "anchor_text": "https://juandes.com", "paragraph_index": 14}], "all_paragraphs": ["The recent advances in the field AI have opened the doors to a plethora of smart and personalized methods of fraud detection. What once was an area that required a numerous amount of manual labor, is now one of the many that have experienced the progress of machine learning. Notwithstanding, it is important to note that this technology, like any other, is not perfect and susceptible to problems, and with so individuals, enterprises, and services offering solutions based on predictive techniques to detect fraudulent transactions, we have to take a step back and consider the possible challenges that might arise.", "I believe it is safe to say that most of the transactions are non-fraudulent. While this is excellent, of course, it creates the most significant and prevalent issue in the area of fraud detection: imbalanced data. Data is the most critical component of a machine learning predictive model, and an imbalanced dataset \u2014 which in this case is a dataset mostly made of non-fraudulent records \u2014 might result in a prediction system that won\u2019t be able to learn about the fraudulent transactions properly. In such a case, the straightforward solution would be to obtain more data; however, in practice, this is either expensive, time-consuming or borderline impossible. Fortunately for us, some procedures and algorithms help with the problem of an imbalanced dataset.", "The technique of over-sampling and under-sampling allow us to modify the class distribution of a dataset. As the name implies, over-sampling is a procedure used to create synthetic data that resembles the original dataset, while the goal of under-sampling is the opposite, removal of data; It is important to note that in practice, over-sampling is more common than under-sampling, that\u2019s why you have probably heard more about the former than the latter.", "The most popular over-sampling algorithm is Synthetic Minority Over-sampling Technique or SMOTE. SMOTE is an algorithm that relies on the concept of nearest neighbors to create its synthetic data. For example, in the image below we have an imbalanced dataset made of 12 observations and two continuous features, x and y. Of these 12 observations, ten belong to the class X, and the remaining two to Y. What SMOTE do is selecting a sample from the under-represented data, and for each point, it computes its K nearest neighbors \u2014 which for the sake of simplicity, let\u2019s assume its K=1. Then, it takes the vector that is between the data point and its nearest neighbor, and multiplies it by a random value between 0 and 1, resulting in a new vector \u201ca.\u201d This vector is our new synthetic data point.", "The following gist shows how to perform SMOTE in R.", "A second concept I\u2019d like to bring to the table is the choice of the predictive system. At first, we might think that a supervised learning system that classifies an action into fraud or not would be the most appropriate approach for this kind of problem. While this might sound attractive, it is important to note that sometimes this is not enough and that other areas such as anomaly detection and unsupervised learning could help to find those noisy and anomalous points that might represent fraud.", "Anomaly detection is the field of data mining that deals with the discovery of abnormal and rare events \u2014 also known as outliers \u2014 that diverges from what it is considered to be normal. At a basic level, these detection approaches are more statistically intensive, as they deal more closely to the topic of distributions and how much a data point varied from it. For example, equations such as the upper and lower inner fence, defined as UF = Q3 + (1.5 * IQR) and LF = Q1 \u2014 (1.5 * IQR), where IQR is the interquartile range, is one of the many techniques used to create a barrier that divides the data into what is considered normal and what is considered an outlier.", "Let\u2019s explain this with a realistic albeit silly example. Imagine there\u2019s this guy, John, and John is an early bird who regularly wakes up around 5:30 am (a real champ), however, last night while John was celebrating his 32th birthday, he had a little way too much fun and woke up the next morning at 6 am (and felt terrible about it). This \u201c6 am\u201d represents an anomaly in our dataset.", "The following graph represents John\u2019s last ten wake up times, and we can see that the last one seems to be out of place. Correctly, we could say that this point falls far from the distribution of the other nine times; the three sigma or standard deviations rule, a rule with applications for detecting outlier, shows this. Without the 10th time, the mean and standard deviation would be 318.89 and 2.09 (if we compute the time as minutes after 12). However, the 10th time (6 am, or 420), is way beyond the range of the mean plus three times the standard deviation (318.89 + (2.09 * 3) = 325.16), indicating that time is indeed an anomaly.", "Unsupervised learning, particularly clustering, can also be used to detect anomalous and noisy content in a dataset. This kind of machine learning algorithms works under the assumption that similar observations tend to be group under the same clusters, while the noisy ones, won\u2019t. Going back to John, and his fantastic sleeping pattern, if we cluster his data using k-means with k=2 we can observe how the anomalous point falls into a cluster of its own.", "Lastly, the choice of performance metric plays a significant role at the time of training our system. A standard score like accuracy, won\u2019t be of much use if the dataset is imbalanced. For example, suppose that only 2% of the content of the test dataset, are actual fraudulent transactions. If the model classifies all of those cases are non-fraudulent, the accuracy would be 98%; a good number, but insignificant in this case. Some metrics that would be more appropriate for this use case are precision, recall, and Cohen\u2019s Kappa coefficient. Moreover, the type of error \u2014 false positives, or false negative \u2014 that we are optimizing for is also of great importance. There will be cases in which we should favor a higher false positive ratio in exchange for a lower false negative score and the other way around.", "The demand to combat fraud, scam and spam activities will always be there. Even with all the recent advances, and breakthroughs in the area of AI, there will be some difficulties to be encountered during our problem-solving quests. In this article, I talked about three of these difficulties: the lack of a balanced dataset, the choice of predictive system and the selection of an appropriate evaluation metric, and offered some pointers and options to consider with the goal of improving the quality of our predictions and detections.", "Appendix with the code used to generate the images are available on my GitHub.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data storyteller, Trust and Safety Software Engineer, and fan of quantifying my life. Also, I like Pokemon. https://juandes.com, @jdiossantos."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F29e33bcb43d2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@juandes?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": "Juan De Dios Santos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9998a144da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=post_page-9b9998a144da----29e33bcb43d2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29e33bcb43d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29e33bcb43d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/Hans-2/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=375639", "anchor_text": "Hans Braxmeier"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=375639", "anchor_text": "Pixabay"}, {"url": "https://github.com/juandes/fraud-challenges-appendix", "anchor_text": "juandes/fraud-challenges-appendixContribute to juandes/fraud-challenges-appendix development by creating an account on GitHub.github.com"}, {"url": "https://twitter.com/jdiossantos", "anchor_text": "Juan De Dios Santos (@jdiossantos) | TwitterThe latest Tweets from Juan De Dios Santos (@jdiossantos). Machine Learning/Data Engineer. Also, Pokemon Master, and\u2026twitter.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----29e33bcb43d2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----29e33bcb43d2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/fraud-detection?source=post_page-----29e33bcb43d2---------------fraud_detection-----------------", "anchor_text": "Fraud Detection"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----29e33bcb43d2---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----29e33bcb43d2---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29e33bcb43d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=-----29e33bcb43d2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29e33bcb43d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=-----29e33bcb43d2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29e33bcb43d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F29e33bcb43d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----29e33bcb43d2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----29e33bcb43d2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Juan De Dios Santos"}, {"url": "https://medium.com/@juandes/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "882 Followers"}, {"url": "https://juandes.com", "anchor_text": "https://juandes.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9998a144da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=post_page-9b9998a144da--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8e4ad12e7160&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fovercoming-challenges-when-designing-a-fraud-detection-system-29e33bcb43d2&newsletterV3=9b9998a144da&newsletterV3Id=8e4ad12e7160&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}