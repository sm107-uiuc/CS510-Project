{"url": "https://towardsdatascience.com/create-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f", "time": 1683016897.0251, "path": "towardsdatascience.com/create-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f/", "webpage": {"metadata": {"title": "Create a real-time text-in-image recognition Android app | by Maciej S. | Towards Data Science", "h1": "Create a real-time text-in-image recognition Android app", "description": "In what follows, I will talk about implementing a Google-lens-like real-time text-in-image recognition on Android, using CameraX and ML Kit. Hopefully, by the end of it, you will have learned how to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://developer.android.com/training/camerax", "anchor_text": "CameraX", "paragraph_index": 0}, {"url": "https://developers.google.com/ml-kit", "anchor_text": "ML Kit", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/maciejsurmacz/", "anchor_text": "https://www.linkedin.com/in/maciejsurmacz/", "paragraph_index": 44}], "all_paragraphs": ["In what follows, I will talk about implementing a Google-lens-like real-time text-in-image recognition on Android, using CameraX and ML Kit. Hopefully, by the end of it, you will have learned how to quickly put together something that resembles Google Lens and start to innovate (if you in fact do develop an app based on this tutorial, please share it in the comments! I promise I won\u2019t steal your idea, create a start-up around it, and become a billionaire when Facebook buys it 2 years from now). Enough of the sweet talk, let\u2019s get down to it.", "Gathering the necessary dependencies is always a good way to start. For this particular use case we will need:", "So go ahead and add the following dependencies to your module\u2019s build.gradle file:", "Dear developer from the future, note that by the time you\u2019re reading this, perhaps while commuting to work in your self-flying car, and the year is 2222, the most recent versions of the libraries might already be different and CameraX might have even reached a stable release by now, so keep an eye out for that.", "CameraX is a Jetpack support library, built to help you make camera app development easier", "It does indeed provide a set of nice APIs for interacting with the device\u2019s camera, making it a little bit more painless to develop software for all the different types of camera hardware across the notoriously fragmented Android landscape.", "As always, we will start with the exciting part: permissions.", "Open the AndroidManifest file and include the following lines, at the same level as the application tag:", "The first line ensures that the device has a camera- in this case, either front or back camera will do- otherwise, the user will not see your app in the Play Store.", "The next thing we will need is some kind of layout.", "For the sake of this article, I will assume your application has exactly one activity, which has only one purpose in life, namely to act as a camera preview. So, go ahead and open your activity\u2019s layout file and add the following view:", "(assuming ConstraintLayout as the root tag of your layout file)", "This, as you might have guessed (don\u2019t get too excited if you did, it wasn\u2019t that hard), is the view that will display the camera preview on the user\u2019s screen.", "For the sake of simplicity, let\u2019s lock the screen orientation in portrait mode. Find the activity tag inside of the AndroidManifest.xml file and add to it the screenOrientation attribute:", "Now that we have the hard part behind us, let\u2019s move on to the activity.", "We will start by adding an executor on which the camera image analyzer (more on this in just a sec, or two, depending on how fast you read) will run the processing code; add the following line on top of the activity:", "Let\u2019s also shut it down once it\u2019s no longer needed in the activity\u2019s onDestroy method:", "Naturally, before we can even start to think of using the camera, we need to request the permissions at runtime (duh).", "Add a companion object with the following values needed for requesting permissions as well as logging (I\u2019m really tempted to say put it at the bottom of the class but I can\u2019t tell you how to live your life):", "We will need two private functions:", "And what good are the functions if they\u2019re never called:", "Finally, let\u2019s process the user\u2019s choice:", "To keep things simple, we\u2019ll close the app in case the user doesn\u2019t grant us access to the camera- after all, without it, the app is useless.", "You might\u2019ve noticed, dear reader, that startCamera() function is nowhere to be found in our code yet. Don\u2019t worry, I haven\u2019t forgotten about it. Let\u2019s talk about something else first though.", "In order to do anything interesting with the images we are getting from the camera, that is unless you consider showing a camera preview interesting enough already, we need some way to process them. That\u2019s where the ImageAnalysis.Analyzer interface enters the scene.", "We will need a custom implementation of the said interface that will run image recognition, using the ML Kit, on each camera frame as they arrive. Go ahead and create the following class:", "Are we there yet? you might wonder.", "Not quite, we\u2019re going to add more code in a short while, be patient. For the time being, let\u2019s just mention that our TextReaderAnalyzer class will take a single parameter- a callback function that we will use to let the activity know we found some text in the image.", "We will now use an instance of the TextAnalyzer class to lazily create an ImageAnalysis object inside of our activity with the following code:", "onTextFound is the function that will be called whenever ML Kit finds new text in the image; let\u2019s just print it (I know, how exciting!):", "Remember the startCamera() function from earlier? Now we\u2019re finally ready to go back to it. Add the following functions that will start the camera, pass the TextReaderAnalyzer instance, and bind the camera to the activity\u2019s lifecycle:", "And so, our work here is done (in the activity, that is); next comes the part you\u2019ve all been waiting for: the ML Kit.", "ML Kit is a library from our friends at Google (hi, Google) allowing us to use all the super-duper cool machine learning models through simple APIs directly on the device; this includes computer vision-related tasks, such as face and object recognition as well NLP (natural language processing) APIs. In our example, we\u2019re going to be using, surprise, surprise, the text recognition API.", "Text recognition lets you process the text from an image as blocks (e.g. paragraphs), lines, and elements (singular words). The hierarchy is exactly what you\u2019d expect: text contains blocks, blocks contain lines, lines contain elements. You can access each of those through their parent, starting with the Text instance as a root. For our app, we\u2019re going to be interested in processing text elements (a.k.a. words).", "Let\u2019s give the analyze function in our TextReaderAnalyzer class an actual body:", "Note that image inside of imageProxy is experimental. For time being, we are only interested in doing validation of the image we receive, namely, make sure it\u2019s not null, and if that\u2019s the case, pass it to the ML Kit. Let\u2019s do that as well:", "InputImage.fromMediaImage method creates an input that is compatible with ML Kit out of the image we got from CameraX. Note the second parameter which specifies image rotation, in our case we need to rotate the image by 90 degrees.", "Now the good stuff: here we finally use the ML Kit to get a text from the image. The whole operation is asynchronous and we get either a result (visionText of type Text, which represents the entirety of the detected text and contains blocks, lines, and elements, as we discussed before) or an error if, well, an error occurred:", "Note how we close the ImageProxy after processing it- this way CameraX API knows that we\u2019re done with the current image and can deliver a new frame from the preview.", "All we need to do now is to iterate over each block, and each line, and each element in order to break down the detected text one word at a time; when a word is found, let\u2019s inform our callback in the activity about it:", "And that is pretty much it! You can now go ahead and use the newly acquired skill and create a multi-million company on your own! And when you finally do, please don\u2019t forget the blog post that got you started!", "Naturally, the code presented in this article is only scratching the surface- you can do many more things with the text-in-image detection, for instance, you could use the bounding box of the detected text (use text.boundingBox to get the position of the text on the screen) and create a whole array of augmented reality applications; you can take it in a slightly different direction and use other ML Kit APIs by simply modifying the text analyzer code accordingly. The sky is the limit!", "Thank you for your time if you got this far, hope you found the article useful- if you did, and are interested in more tutorials around this topic, leave a comment!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A software engineer with an Android focus because he can\u2019t afford an iPhone. https://www.linkedin.com/in/maciejsurmacz/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feac6d286050f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eac6d286050f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eac6d286050f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://maciejs.medium.com/?source=post_page-----eac6d286050f--------------------------------", "anchor_text": ""}, {"url": "https://maciejs.medium.com/?source=post_page-----eac6d286050f--------------------------------", "anchor_text": "Maciej S."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F30e1ab2fca81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&user=Maciej+S.&userId=30e1ab2fca81&source=post_page-30e1ab2fca81----eac6d286050f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feac6d286050f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feac6d286050f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nasa", "anchor_text": "NASA"}, {"url": "https://unsplash.com/@quinoal", "anchor_text": "Quino Al"}, {"url": "https://unsplash.com/@karlgroendal", "anchor_text": "Karl Groendal"}, {"url": "https://unsplash.com/@zane404", "anchor_text": "Zane Lee"}, {"url": "https://unsplash.com/", "anchor_text": "Upslash"}, {"url": "https://developer.android.com/training/camerax", "anchor_text": "CameraX"}, {"url": "https://developers.google.com/ml-kit", "anchor_text": "ML Kit"}, {"url": "https://medium.com/tag/android?source=post_page-----eac6d286050f---------------android-----------------", "anchor_text": "Android"}, {"url": "https://medium.com/tag/augmented-reality?source=post_page-----eac6d286050f---------------augmented_reality-----------------", "anchor_text": "Augmented Reality"}, {"url": "https://medium.com/tag/software-development?source=post_page-----eac6d286050f---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----eac6d286050f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----eac6d286050f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feac6d286050f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&user=Maciej+S.&userId=30e1ab2fca81&source=-----eac6d286050f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feac6d286050f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&user=Maciej+S.&userId=30e1ab2fca81&source=-----eac6d286050f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feac6d286050f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eac6d286050f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feac6d286050f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eac6d286050f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eac6d286050f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eac6d286050f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eac6d286050f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eac6d286050f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eac6d286050f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eac6d286050f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eac6d286050f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eac6d286050f--------------------------------", "anchor_text": ""}, {"url": "https://maciejs.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://maciejs.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maciej S."}, {"url": "https://maciejs.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "20 Followers"}, {"url": "https://www.linkedin.com/in/maciejsurmacz/", "anchor_text": "https://www.linkedin.com/in/maciejsurmacz/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F30e1ab2fca81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&user=Maciej+S.&userId=30e1ab2fca81&source=post_page-30e1ab2fca81--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe86cfdfe432&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreate-a-google-lens-like-real-time-text-in-image-recognition-android-app-using-camerax-and-ml-kit-eac6d286050f&newsletterV3=30e1ab2fca81&newsletterV3Id=e86cfdfe432&user=Maciej+S.&userId=30e1ab2fca81&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}