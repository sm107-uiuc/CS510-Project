{"url": "https://towardsdatascience.com/how-i-customarily-bin-data-with-pandas-9303c9e4d946", "time": 1683015479.702231, "path": "towardsdatascience.com/how-i-customarily-bin-data-with-pandas-9303c9e4d946/", "webpage": {"metadata": {"title": "Pandas qcut and cut: A Beginner's Guide | Towards Data Science", "h1": "How I customarily bin data with Pandas", "description": "Master the when and how of Pandas qcut and cut. Learn about their differences and their usage in real-life setting"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BexTuychiev/medium_stories/tree/master/qcut_cut", "anchor_text": "this", "paragraph_index": 6}, {"url": "https://exoplanets.nasa.gov/exoplanet-catalog", "anchor_text": "the Exoplanet Catalog", "paragraph_index": 8}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.qcut.html", "anchor_text": "documentation", "paragraph_index": 16}, {"url": "https://www.sharpsightlabs.com/blog/numpy-linspace/", "anchor_text": "article", "paragraph_index": 39}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.cut.html", "anchor_text": "documentation", "paragraph_index": 46}, {"url": "https://pbpython.com/pandas-qcut-cut.html", "anchor_text": "article", "paragraph_index": 46}, {"url": "https://www.linkedin.com/in/bextuychiev/", "anchor_text": "https://www.linkedin.com/in/bextuychiev/", "paragraph_index": 49}], "all_paragraphs": ["That is the reaction beginners often get when they look at the output of some hard pandas function. It always baffles me how lots of tutorials and courses introduce such functions in a single sentence and move on to other topics in a heartbeat. Even if you read their documentation from top to bottom, it is gonna be more than a minute, guaranteed.", "As a beginner, I was always so frustrated when I was in such situations. One time, while doing a nano degree at Udacity, I was learning about Matplotlib\u2019s heatmaps. If you know, Matplotlib cannot create annotations for heatmaps automatically like Seaborn, so you had to create them by hand. To do that you would useqcut or cut (which are the topic of this article) to bin your data into categories and I was completely new to these functions.", "The instructor, in a single sentence, briefly \u2018explained\u2019 the functions and a link to the documentation appeared on the screen\ud83e\udd26\u200d\u2642\ufe0f. He even fast-forwarded through the parts where he was typing out the syntax.", "Lately, I have been writing a little series explaining the hardest functions of pandas in the hopes that other people won\u2019t face the same difficulties. This is part four and it is about binning numeric data using qcut and cut.", "Get the best and latest ML and AI papers chosen and summarized by a powerful AI \u2014 Alpha Signal:", "\u2218 Motivation \u2218 Setup and basic exploration \u2218 Interval Notation Refresher \u2218 Pandas qcut() \u2218 Pandas cut()", "The notebook used in the article can be downloaded from this GitHub repo.", "For the sample data, I will be using a built-in planets dataset of seaborn:", "planets dataset was downloaded from the Exoplanet Catalog of NASA and contains data about planets outside of our solar system. The three columns that are of interest are orbital_period, mass and distance:", "To get the most out of this article and understand some of the language I will be using, here is a gentle refresher on interval notation:", "To understand how qcut() works, let's start with histograms:", "Histograms automatically divide an array or list of numbers into several bins, each containing different number of observations. In seaborn, it is possible to control the number of bins:", "Histograms are the first examples of binning data you might have seen. Here is another example by using the describe() function of pandas:", "By default, describe() divides the numerical columns into 4 buckets (bins) - (min, 25th), (25th, median), (median, 75th), (75th, max) and display the bin edges. You can also pass custom percentiles for the function:", "Those are all examples of binning data. But if you noticed, in all the above examples, we could not really control the bins. We just chose the number of bins and that\u2019s it. Besides, you cannot really take those bins out of the context of their specific functions.", "Now, here is a question: How can you store the bin that each observation belongs to in a new column or to perform some operations for later? That is where qcut() and cut() comes in.", "First, let\u2019s explore the qcut() function. It works on any numerical array-like objects such as lists, numpy.array, or pandas.Series (dataframe column) and divides them into bins (buckets). The documentation states that it is formally known as Quantile-based discretization function.", "If you see this output for the first time, it can be pretty intimidating. But bear with me and you will master the function in no time.", "The first parameter of the function is the column to bin. The next required parameter is q which stands for quantiles. qcut() divides the data into percentile bins rather than constructing each bin with numeric edges.", "Let\u2019s explore different parts of the output individually. When we set q to 4, we told pandas to create 4 intervals or bins and let it figure out placing the values itself.", "As you see, the values for min, max, median, 25th, 75th percentiles are all the same.", "Now, the main part: if you look at the actual results, each row or index is placed into one of the four bins. pandas, by default, gives the literal numerical bin names to each observation. To have a better image of the situation, let's store the output into a new column:", "After storing, we have a better bird\u2019s eye view of the dataframe. You can verify that each distance value is placed into a correct interval. I also introduced a new parameter precision which lets us specify the number of decimal points to keep.", "However, the new column is still not in its best form. What would be ideal is if could give specific labels for each interval. This will boost the readability of our data.", "To achieve this, we need to create a list of labels to pass into the labels parameter of qcut():", "Much better! But, still we have not covered the defining point of qcut(). Let's call the value_counts() function on the newest column and see what happens:", "If there are not many extreme values in the distribution, the number of values in each bin will be super close to each other. If you are familiar with statistics, this makes sense because I already said that qcut() defines the bin edges as percentiles of the distribution.", "Note that this does not mean the sizes of bins are the same. If you subtract the left edges of bins from the right you will get different results. For example, let\u2019s divide the mass into 5 bins and get the width of each bin:", "Setting retbins (stands for return bins) to True returns an additional numpy.ndarray containing the bin edges of our cut. I used a loop to display the width of each bin to verify my above point.", "For the sake of simplicity for the next sections, I will drop the new columns:", "After discussing qcut(), you are now able to understand differences between cut().", "qcut() divided our data so that the number of values in each bin are roughly the same but the bin ranges were different. A lot of the concepts in the first section apply here too.", "The main difference is that cut() uses actual numeric bin edges and by default, it divides the distribution into bins that have equal size. Just the opposite of qcut(). Let's see an example first:", "We have divided the mass column into three different categories. Same as before, I will store the results back into the data frame and call value_counts() on it:", "Also, let\u2019s see the range of each bin:", "As you see, this time the width of bins are roughly the same and we have different number of observations in each bin.", "The real power of cut comes into play when we want to define custom ranges for the bins. Often, with real data, it is the case that you don't want to let pandas automatically define the edges for you. For example, if you work for a telephone company, you might want to categorize your customers based on the overall duration of engagement with your services. You might give customers with longer engagement a top priority and sort the rest accordingly.", "Let\u2019s see an example of custom binning for the mass. We will create 4 intervals and give them custom labels:", "This example clearly shows the flexibility offered by cut. The bins parameter can accept 3 choices:", "Often, defining the custom bin ranges in a list can be tricky. Therefore, it is better to use numpy.arange or numpy.linspace functions. Both create a sequence of evenly spaced numbers that can be passed as bin ranges for cut. You can learn more about these functions in this helpful article.", "In the first line of the above snippet, we are creating a numpy.ndarray with 5 elements. So, the cut will create one less number of intervals for the distance.", "A general rule of thumb is to use simple lists for fewer bins but use numpy functions for many intervals.", "You can basically get the same intervals using pandas.interval_range. This function, rather than a list, returns IntervalIndex objects which can be customized even further:", "Yes, it is basically the same thing but there is an additional parameter which makes this function very useful:", "The closed parameter accepts 4 strings to control the interval edges:", "A downside to using the interval_range is that you cannot use labels with it in cut.", "There are also some nuances regarding the parameters, so definitely check out the documentation for the nitty-gritty details. Also, here is a similar article comparing cut and qcut from Practical Business Python.", "Read more articles related to the topic:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "BEXGBoost | DataCamp Instructor |\ud83e\udd47Top 10 AI/ML Writer on Medium | Kaggle Master | https://www.linkedin.com/in/bextuychiev/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9303c9e4d946&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ibexorigin.medium.com/?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": ""}, {"url": "https://ibexorigin.medium.com/?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": "Bex T."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39db050c2ac2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&user=Bex+T.&userId=39db050c2ac2&source=post_page-39db050c2ac2----9303c9e4d946---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9303c9e4d946&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9303c9e4d946&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@steve_j?utm_source=medium&utm_medium=referral", "anchor_text": "Steve Johnson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://ibexorigin.medium.com/membership", "anchor_text": "Join Medium with my referral link - BEXGBoostGet exclusive access to all my \u26a1premium\u26a1 content and all over Medium without limits. Support my work by buying me a\u2026ibexorigin.medium.com"}, {"url": "https://alphasignal.ai/?referrer=Bex", "anchor_text": "Alpha Signal | The Best of Machine Learning. Summarized by AI.Stay in the loop without spending countless hours browsing for the next breakthrough; our algorithm identifies the\u2026alphasignal.ai"}, {"url": "https://github.com/BexTuychiev/medium_stories/tree/master/qcut_cut", "anchor_text": "this"}, {"url": "https://exoplanets.nasa.gov/exoplanet-catalog", "anchor_text": "the Exoplanet Catalog"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.qcut.html", "anchor_text": "documentation"}, {"url": "https://www.sharpsightlabs.com/blog/numpy-linspace/", "anchor_text": "article"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.cut.html", "anchor_text": "documentation"}, {"url": "https://pbpython.com/pandas-qcut-cut.html", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92", "anchor_text": "Meet the hardest functions of Pandas, Part IMaster the when and how of pivot_table(), stack(), unstack()towardsdatascience.com"}, {"url": "https://towardsdatascience.com/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b", "anchor_text": "Meet the hardest functions of Pandas, Part IIMaster the when and how of crosstab()towardsdatascience.com"}, {"url": "https://towardsdatascience.com/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6", "anchor_text": "Meet the hardest functions of Pandas, Part IIIShape tables like JELLY with Pandas pivot() and melt()towardsdatascience.com"}, {"url": "https://towardsdatascience.com/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98", "anchor_text": "From Kagglers: Best Project Setup for DS and MLA collection of best practices from top Kagglers for project successtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/ever-wanted-progress-bars-in-jupyter-bdb3988d9cfc", "anchor_text": "Ever wanted Progress Bars in Jupyter?Sanity check for your hours long loops (and a little visual style)towardsdatascience.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9303c9e4d946---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9303c9e4d946---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9303c9e4d946---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----9303c9e4d946---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----9303c9e4d946---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9303c9e4d946&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&user=Bex+T.&userId=39db050c2ac2&source=-----9303c9e4d946---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9303c9e4d946&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&user=Bex+T.&userId=39db050c2ac2&source=-----9303c9e4d946---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9303c9e4d946&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9303c9e4d946&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9303c9e4d946---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9303c9e4d946--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9303c9e4d946--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9303c9e4d946--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9303c9e4d946--------------------------------", "anchor_text": ""}, {"url": "https://ibexorigin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ibexorigin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bex T."}, {"url": "https://ibexorigin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "16.4K Followers"}, {"url": "https://www.linkedin.com/in/bextuychiev/", "anchor_text": "https://www.linkedin.com/in/bextuychiev/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39db050c2ac2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&user=Bex+T.&userId=39db050c2ac2&source=post_page-39db050c2ac2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F22cea38b90f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-customarily-bin-data-with-pandas-9303c9e4d946&newsletterV3=39db050c2ac2&newsletterV3Id=22cea38b90f3&user=Bex+T.&userId=39db050c2ac2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}