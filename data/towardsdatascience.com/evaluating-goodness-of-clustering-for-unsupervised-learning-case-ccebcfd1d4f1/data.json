{"url": "https://towardsdatascience.com/evaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1", "time": 1683017330.6430888, "path": "towardsdatascience.com/evaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1/", "webpage": {"metadata": {"title": "Evaluating goodness of clustering for unsupervised learning case | by Rahul Khandelwal | Towards Data Science", "h1": "Evaluating goodness of clustering for unsupervised learning case", "description": "Clustering is a commonly used unsupervised machine learning technique that allows us to find patterns within data without having an explicit target variable. In simple terms, grouping unlabelled data\u2026"}, "outgoing_paragraph_urls": [{"url": "http://archive.ics.uci.edu/ml/datasets/Wholesale+customers", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/evaluation-metrics-for-classification-problems-in-machine-learning-d9f9c7313190", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://github.com/rahulkhandelwal396/kmeans-evaluation", "anchor_text": "link", "paragraph_index": 40}], "all_paragraphs": ["Clustering is a commonly used unsupervised machine learning technique that allows us to find patterns within data without having an explicit target variable. In simple terms, grouping unlabelled data is called Clustering. Clustering analysis uses similarity metrics to group data points that are close to each other and separate the ones which are farther apart. It is a widely used technique for market segmentation, pattern recognition, and image processing.", "While there are many metrics, like classification accuracy, which one can use to evaluate a labeled data problem, for a clustering problem we have to understand how well the data is grouped into different clusters by the algorithm. This is different since we do not have the true labels of the data.", "In this article, I am going to apply the K-means clustering algorithm to retail data to separate the data into different clusters. I will also try to assess the performance of the algorithm by inferring the optimal value of the number of clusters from multiple evaluation techniques.", "The data for this analysis was obtained from the UCI Machine Learning Repository website. It contains data regarding the clients of a wholesale distributor.", "The data for the following analysis can be found here.", "Calling the .info() method on the dataframe:", "We can see that there are no null values in the data and all the features have datatype int.", "The above plot tells us that there is a high correlation between the following pairs of variables:", "For this analysis, since we are only looking at clustering, I will not be removing any of the features here. In most cases, however, one of the above pairs of a variable should be dropped to remove multicollinearity in the data for building ML models on the data.", "From the data, we can see that the categorical columns are [\u2018Channel\u2019,\u2018Region\u2019]. Since these variables are nominal, they were converted to indicator variables using pandas.get_dummies method.", "From the above plot, we can see that there is a fair distribution between these variables.", "Let us now focus on the algorithm and evaluating its performance.", "K- means is one of the most popular and the simplest clustering algorithms available today which can be used to solve both supervised and unsupervised machine learning problems.", "In a nutshell, here\u2019s how it works: The algorithm starts with a value of K. It then assigns each point to a cluster closest to it. It then calculates the cluster centroid and then re-assigns each point to the new cluster. The cluster centroids are calculated again and re-assignment happens again. This process is repeated till the error reaches a particular threshold value. There are many online resources one can use to dive deeper into understanding the working of this algorithm.", "Let us now talk about how to evaluate the performance of the algorithm:", "If the target variable is known, the following methods can be used to evaluate the performance of the algorithm:", "To read more about these metrics, refer to the article here. This is beyond the scope of this article.", "However, if the target variable is not known, we do not know the true labels of the clusters of data. In such a case, whenever an algorithm tries to find clusters within the data, it tries to classify each point to cluster such that each cluster is as homogenous as possible and different clusters are as far as possible from each other. To evaluate the performance of the algorithm in such a case, we make use of these methods:", "The Elbow method uses a plot between the average of the sum of the intra-cluster sum of squares of distances between the respective cluster centroids and the cluster points and the number of clusters (or K). To determine the optimal number of clusters, we have to select such a value of K at the \u2018elbow\u2019 point or the point after which the error starts decreasing linearly. The curve can either go up or down, but if there is a strong inflection point, it is a good indication that the underlying model fits best at that point with regard to the number of clusters.", "The elbow method does not work well if the data is not very clustered intrinsically.", "By default, the distortion score is computed. Other metrics can also be used, such as silhouette score, which will be discussed below and calinski_harabasz score. The calinski_harabasz score computes the ratio of dispersion between and within clusters and therefore incorporates information about how far apart the clusters are from each other as well. Higher the score, the better the performance.", "Taking the sum of squared distances as the metric, we get the following elbow plot for our data:", "Here, we cannot see a very distinct elbow point. One might infer the optimal value of K to be 5, 6, or 7.", "Taking calinski_harbasz score as the metric, we get the following elbow plot for our data:", "From this plot, we can see that the optimal value of K is 6. The plot is drawn using Yellowbrick\u2019s KElbowVisualizer method.", "While calinski_harbasz score is fast to compute, it is generally higher for convex clusters than other types of clusters such as density clusters.", "Convex and non-convex clusters (Additional info)", "In Euclidean space, an object is convex if, for every pair of points within the object, every point on the straight line segment that joins them is also within the object.", "K-Means clustering performs well only for a convex set of clusters and not for non-convex sets.", "In simple terms, the K-means clustering algorithm performs well when clusters are spherical. If they have a complicated geometrical shape, it does a poor job classifying data points into their respective clusters.", "The silhouette score also tells us how good the clustering algorithm performs. The below formula tells us how to calculate the silhouette score for one data point. The overall silhouette score is calculated by taking the mean.", "b(i) represents the average distance of point i to all the points in the nearest cluster.", "a(i) represents the average distance of point i to all the other points in its own cluster.", "The silhouette score varies between +1 and -1, +1 being the best score and -1 being the worst. 0 indicates an overlapping cluster while negative values indicate that the point is assigned to the wrong cluster.", "Silhouette analysis on our data: (The red line marks the silhouette score)", "Silhouette plots for n_clusters 3 to 8:", "From all the above plots, we can see that seeing the visualization of clustered data tells us that data is not present in a very clustered manner in the data already, which is making it difficult for the algorithm to select the optimal number of clusters. Perhaps this is why we could not get a clear K value from the dispersion elbow plot.", "To summarize the above plots, this is a plot calculating the silhouette_score for different values of n_clusters.", "From this plot, we can see that we get the highest value of the silhouette score is 0.482 for K=6.", "In the above article, we performed clustering on our data and evaluated the quality of our clustering fit using the elbow method and silhouette analysis. From both the methods, we obtained a value of K=6 as the optimal number of clusters for separating our data. Since the data is not very separable in the feature space, the elbow method utilizing dispersion as the metric did not give a clear inflection point. But, using the calinski_harbasz score and silhouette analysis, we were able to find the optimal value of K.", "Here is the link to the GitHub repository of this project: link.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fccebcfd1d4f1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rahulkhandelwal.medium.com/?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": ""}, {"url": "https://rahulkhandelwal.medium.com/?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": "Rahul Khandelwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F42b04d527af5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&user=Rahul+Khandelwal&userId=42b04d527af5&source=post_page-42b04d527af5----ccebcfd1d4f1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fccebcfd1d4f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fccebcfd1d4f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@franki?utm_source=medium&utm_medium=referral", "anchor_text": "Franki Chamaki"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://archive.ics.uci.edu/ml/datasets/Wholesale+customers", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/evaluation-metrics-for-classification-problems-in-machine-learning-d9f9c7313190", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Convex_set", "anchor_text": "Source"}, {"url": "https://en.wikipedia.org/wiki/Convex_set", "anchor_text": "Source"}, {"url": "https://github.com/rahulkhandelwal396/kmeans-evaluation", "anchor_text": "link"}, {"url": "https://en.wikipedia.org/wiki/Davies\u2013Bouldin_index", "anchor_text": "Davies-Bouldin Index"}, {"url": "https://simple.wikipedia.org/wiki/Dunn_index", "anchor_text": "Dunn index"}, {"url": "https://medium.com/tag/clustering?source=post_page-----ccebcfd1d4f1---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/elbow-method?source=post_page-----ccebcfd1d4f1---------------elbow_method-----------------", "anchor_text": "Elbow Method"}, {"url": "https://medium.com/tag/silhouette-score?source=post_page-----ccebcfd1d4f1---------------silhouette_score-----------------", "anchor_text": "Silhouette Score"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ccebcfd1d4f1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----ccebcfd1d4f1---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fccebcfd1d4f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&user=Rahul+Khandelwal&userId=42b04d527af5&source=-----ccebcfd1d4f1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fccebcfd1d4f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&user=Rahul+Khandelwal&userId=42b04d527af5&source=-----ccebcfd1d4f1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fccebcfd1d4f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fccebcfd1d4f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ccebcfd1d4f1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ccebcfd1d4f1--------------------------------", "anchor_text": ""}, {"url": "https://rahulkhandelwal.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rahulkhandelwal.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Khandelwal"}, {"url": "https://rahulkhandelwal.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "96 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F42b04d527af5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&user=Rahul+Khandelwal&userId=42b04d527af5&source=post_page-42b04d527af5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc86cb72668f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fevaluating-goodness-of-clustering-for-unsupervised-learning-case-ccebcfd1d4f1&newsletterV3=42b04d527af5&newsletterV3Id=c86cb72668f3&user=Rahul+Khandelwal&userId=42b04d527af5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}