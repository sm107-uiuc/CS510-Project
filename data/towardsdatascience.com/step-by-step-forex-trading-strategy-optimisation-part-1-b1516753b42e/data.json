{"url": "https://towardsdatascience.com/step-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e", "time": 1683015545.829052, "path": "towardsdatascience.com/step-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e/", "webpage": {"metadata": {"title": "How to Save a Losing Trading Strategy? | Towards Data Science", "h1": "How to Save a Losing Trading Strategy? (Part 1)", "description": "Step by step tutorial on how we can save a seemingly hopeless trading strategy"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://amzn.to/3jAIcbF", "anchor_text": "Trading Systems 2nd edition: A new approach to system development and portfolio optimisation (2nd ed.)", "paragraph_index": 29}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "The shear number of FX trading gurus online these days are blinding my YouTube recommendations. Is it that easy to get a Lamborghini in gold? In this blog, I am going to go through how I have optimised a good old moving average crossover strategy, which is definitely not working in my case, and try to make it a profitable strategy. We will start by creating our trading system, getting the data that we need, defining our entry logic, evaluating the performances, before we start optimising our strategy. Without further ado, let\u2019s dive into it; and surely my Lambo will be on its way to my garage before I notice (except that I don\u2019t even have a garage)", "Disclaimer: I am not currently trading with this strategy, nor is this blog a financial advice. Please use it at your own risk.", "Trading system, a very fancy and complicated-sounding word, is actually nothing more than a set of precise rules that can automatically defines entry and exit logic, all without any human discretionary efforts. Because of the precise nature of the rule sets, systematic testing can be reliably tested with historical datasets, aka backtesting. By observing statistically representative and repeating behaviours in the past, we would then be able to estimate the confidence level for a systematic trading strategy to be profitable.", "A trading system often consists of a number of components:", "Trading system can theoretically be developed on any sort of markets or fluid commodities with an intrinsic monetary value. In this blog post, we are going to use GBP.USD as our underlying asset. We have taken roughly 6 years of 30-minute-tick data from Jan-2014 until Sep-2020 from the OANDA v20 API. The process is literally as simple as (1) create a practice account at OANDA, (2) generate an access token here (and of course store it safely), and (3) follow the instructions from Vladimir here. Alternatively, you can also obtain the data from backtrader, which I am looking to cover in another blog post.", "Now that we have our data sorted, it\u2019s time to work on our strategy. This time we are going to use a moving average crossover. But to spice things up, instead of using just a simple moving average (SMA), we are going to use triangular moving average (TMA). It is quite well known that SMA are very vulnerable to outliers. TMA on the other hand are smoother trend lines. While having a smoother moving average would increase the lag between price movement and signals, it also minimise the risk of false breakout as a trend would be better confirmed before the entry signal hits. So, how do we calculate this TMA? A n-period TMA is actually just the average of the past n n-period SMA. Sounds like a tongue-twister, but let me throw in some mathematical formula to draw the picture out:", "In other words, there are a couple of key differences between TMA and SMA:", "Let\u2019s create two TMA series for our 30-minute dataset with periods 3 and 30 respectively. For now, we can randomly pick the periods and will optimise them step by step until we have reached the optima.", "It\u2019s often a good idea that we start with simple trading logic, and slowly increase the complexity. In this way, we can understand the behaviour and potential of our trading strategy better before we overfit our trading strategy. To start with, let define only the entry signals and exit when an opposite signal is being generated:", "The intuition behind not entering at the bar of crossover is to test the trend by letting retrace closer to the slower TMA series and potentially screen out false breakout and only trade with long-term trends. As illustrated in the chart above, there was a Long setup in the morning of 3rd Jan 2014 that never get triggered as the Long entry price was reached. The false breakout was quickly followed by a down trend, where a Short setup was triggered when the price dips below the crossover bar Low price.", "With an initial strategy formulated, let take a look at the performance. We will be using the data from 1st Jan 2014 until 31st Dec 2019 for evaluation (i.e. in-sample data), and keep the almighty wonderful year 2020 for the walk-forward analysis (out-of-sample data)once we have finished optimising the strategy. It is important that we do keep a walk forward set from our backtesting to avoid overfitting and enhance the robustness of our final strategy. If instead we have all the data in the in-sample dataset, we are optimising our strategy for time for every single trend change in our entire dataset. While this can provide amazing evaluation result, this is by no means realistic as the exact pattern won\u2019t be repeated. This significant deterioration in strategy performance in future unknown data is called overfitting.", "If we apply our initial trading strategy to our in-sample dataset, assuming that we trade 1 lot of GBP.USD for every entry (i.e. 100,000 unit of the currency), we will end up with the following figures:", "At the first glance, it looks like the trading strategy might already be quite viable. However, if we pay more attention at the underwater chart, which shows us how far down in percentage are we from our peak equity, we can notice that the strategy has a relatively long recovery cycle, with the largest one spanning 2.5 years. Imagine being in the negatives and not recovering for over 2 years, surely that does not sound like the most fun roller coaster ride. If we then look into some of the trading figures in the table, there seems to be more insights for our diagnosis:", "Now that we have our initial diagnosis, it\u2019s time to drizzle in some sauce of reality, aka commission and slippage. These are basically, brokerage\u2019s pocket money and compensation for network latency respectively. If we pay a total of three pips of fees (0.5 for commission and 2.5 for slippage), then a previously $50 profit trade would become a mere $20 profit, but hey, $20 is $20! Jokes aside, let\u2019s take a look at our more realistic equity curve, underwater chart and other summary statistics.", "To be honest, the numbers look dreadful. However, don\u2019t be too harsh on yourself (myself), if the market is so easy to beat, Buffet would not be such a legend. Plus, we have only chosen two arbitrary input parameters without any stop loss nor take profit.", "In order to save our poor strategy, we must first find a more viable set of parameters for the TMAs. In the following figure, we have re-ran the backtest with different combination of Fast TMA period and Slow TMA period. It looks like the strategy would actually be profitable if we have our Fast TMA with period 1, and Slow TMA with period over 50.", "With the rough region of optimal parameters identified, let\u2019s do a finer grid search. From the figure below, it looks like the strategy has its best performance when Fast TMA is of period 1 and when Slow TMA is of period 62. But hold on, the best performance for in-sample data may not imply the best for our out-of-sample data. When it comes to optimising a strategy, it\u2019s always better to have a stabler one, than one that may be overfit for our in-sample data. Murray Ruggiero, an experienced trading system develop once said:", "If you don\u2019t like the neighbouring numbers, you\u2019ve got a problem, because odds are, you will wind up with the results of the neighbouring set of parameters.", "So instead of choosing Slow TMA period to be 62, we will go for 65, where the neighbouring parameters have similar profits.", "With the parameters sorted, our strategy is in profit again even after considering 3 pips of slippage and fees as shown in the figures below:", "That is a very big improvement, from red to green. Looking at the numbers, we can see that by increasing the number of periods for Slow TMA, the average number of bars for winning positions has increased by over 50%, which aligns with the intuition of having a slower Slow TMA for capturing a longer trend. We can also see that our risk to reward ratio has increased from 2.11 to 3.88. Another highlight would be the decrease in our maximum drawdown percentage, from 40% down to about 14%. However, our strategy is still nowhere near tradeable with its super long maximum drawdown period of 1,167 days.", "As FX market works around the clock, there are different players at different time of the day, from APAC, to Europe, then to the Americas, and back to APAC. This brings up the question of when would it be the best to enter the GBP.USD market. It is quite well known that most of the volume for this pair comes from Europe the Americas. If we can find an optimal time filter for entry signal, we may be able to ride the trends driven by these big volumes. Let\u2019s take a look at how our strategy performs if we apply a 4 hour window filter for the entry signal. (e.g. 09:30 implies only allowing entry signals from 09:30 until 13:30)", "Again, although entry signal from 05:00 GMT to 09:00 GMT is giving us the best performance for the in-sample data, we would rather go for a more stable choice. In this case, our selection will be 13:00\u201317:00, where neighbouring parameters are showing similar profits.", "By restricting entries to be from 13:00 GMT to 17:00 GMT, we have reduced our maximum drawdown percentage to about 10%, and the drawdown period to about 980 days. Looking closer at the numbers, we can see that the entry restriction is helping us with the long entries, where the average net profit increase from -8 USD per lot to +22 USD per lot, all while compromising the short performance. This may imply that we would need to develop another strategy for optimising the short performance.", "In this blog, we have gone through how we can develop a simple TMA crossover trading strategy that may look profitable on paper until we factor in a total of 3 pips of commissions and slippage. By optimising TMA parameters and entry time window, we have then save the apparently dreadful strategy and make it profitable again. Here are some of the high level results:", "By optimising our seemingly hopeless strategy, we have managed to:", "That being said, this strategy is still far from being ready for deployment. With still over 2.5 years of drawdown period, and an total profit of 18.57% over 6 years, we still have a lot of room for improvement. In the future parts of this series, we will continue to improve this strategy in a number of areas:", "The thoughts and views expressed in this report are mine alone and do not necessarily reflect the views of my firm. This report is intended to be educational in nature and should not be construed as individual investment advice nor as a recommendation to buy, sell, or hold any security or to adopt any investment strategy.", "Tomasini, E., & Jaekle, U. (2019). Trading Systems 2nd edition: A new approach to system development and portfolio optimisation (2nd ed.). Harriman House.", "Thanks for joining me in my very first Medium blog. Let me know what you think in the comments, and how this article can be improved. It will also be very much appreciated if you get the books through the embed affiliate links to support the series. For the time being, stay strong and keep believing that our Lambo is around the corner; we will continue the journey in the next part of the blog.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Learn from your own mistakes today makes you a better person tomorrow."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb1516753b42e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1516753b42e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1516753b42e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://louis-chan.medium.com/?source=post_page-----b1516753b42e--------------------------------", "anchor_text": ""}, {"url": "https://louis-chan.medium.com/?source=post_page-----b1516753b42e--------------------------------", "anchor_text": "Louis Chan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6d585e26760a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&user=Louis+Chan&userId=6d585e26760a&source=post_page-6d585e26760a----b1516753b42e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1516753b42e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1516753b42e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@davidvondiemar?utm_source=medium&utm_medium=referral", "anchor_text": "David von Diemar"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://9gag.com/gag/aExGAnx", "anchor_text": "9GAG"}, {"url": "https://www.investing.com/", "anchor_text": "https://www.investing.com/"}, {"url": "https://medium.com/datadriveninvestor/how-to-save-a-losing-trading-strategy-part-2-8d4f713068eb", "anchor_text": "How to Save a Losing Trading Strategy (Part 2)Step-by-step tutorial to improve a trading strategy via risk managementmedium.com"}, {"url": "https://amzn.to/35EDncj", "anchor_text": "Market Beaters"}, {"url": "https://amzn.to/3jAIcbF", "anchor_text": "Trading Systems 2nd edition: A new approach to system development and portfolio optimisation (2nd ed.)"}, {"url": "https://medium.com/tag/algorithmic-trading?source=post_page-----b1516753b42e---------------algorithmic_trading-----------------", "anchor_text": "Algorithmic Trading"}, {"url": "https://medium.com/tag/trading?source=post_page-----b1516753b42e---------------trading-----------------", "anchor_text": "Trading"}, {"url": "https://medium.com/tag/forex?source=post_page-----b1516753b42e---------------forex-----------------", "anchor_text": "Forex"}, {"url": "https://medium.com/tag/day-trading?source=post_page-----b1516753b42e---------------day_trading-----------------", "anchor_text": "Day Trading"}, {"url": "https://medium.com/tag/finance?source=post_page-----b1516753b42e---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1516753b42e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&user=Louis+Chan&userId=6d585e26760a&source=-----b1516753b42e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1516753b42e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&user=Louis+Chan&userId=6d585e26760a&source=-----b1516753b42e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1516753b42e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1516753b42e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb1516753b42e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b1516753b42e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1516753b42e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b1516753b42e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b1516753b42e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b1516753b42e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b1516753b42e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b1516753b42e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b1516753b42e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b1516753b42e--------------------------------", "anchor_text": ""}, {"url": "https://louis-chan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://louis-chan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Louis Chan"}, {"url": "https://louis-chan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "487 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6d585e26760a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&user=Louis+Chan&userId=6d585e26760a&source=post_page-6d585e26760a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcce7b4f8b91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstep-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e&newsletterV3=6d585e26760a&newsletterV3Id=cce7b4f8b91&user=Louis+Chan&userId=6d585e26760a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}