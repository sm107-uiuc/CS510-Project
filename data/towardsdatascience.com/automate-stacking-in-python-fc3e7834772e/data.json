{"url": "https://towardsdatascience.com/automate-stacking-in-python-fc3e7834772e", "time": 1682994597.308882, "path": "towardsdatascience.com/automate-stacking-in-python-fc3e7834772e/", "webpage": {"metadata": {"title": "Automate Stacking In Python. How to Boost Your Performance While\u2026 | by Lukas Frei | Towards Data Science", "h1": "Automate Stacking In Python", "description": "This article describes the utilization of the package vecstacks to automate workflows in stacking to improve machine learning performance and workflow"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/wine", "anchor_text": "Wine Data Set", "paragraph_index": 16}, {"url": "http://www.anp.ai", "anchor_text": "www.anp.ai", "paragraph_index": 18}], "all_paragraphs": ["Utilizing stacking (stacked generalizations) is a very hot topic when it comes to pushing your machine learning algorithm to new heights. For instance, most if not all winning Kaggle submissions nowadays make use of some form of stacking or a variation of it. First introduced in the 1992 paper Stacked Generalization by David Wolpert, their main purpose is to reduce the generalization error. According to Wolpert, they can be understood \u201cas a more sophisticated version of cross-validation\u201d. While Wolpert himself noted at the time that large parts of stacked generalizations are \u201cblack art\u201d, it seems that building larger and larger stacked generalizations win over smaller stacked generalizations. However, as these models keep increasing in size, they also increase in complexity. Automating the process of building different architectures would significantly simplify this process. The remainder of this article will deal with the package vecstack I recently came across that is attempting just this.", "The main idea behind the structure of a stacked generalization is to use one or more first level models, make predictions using these models and then use these predictions as features to fit one or more second level models on top. To avoid overfitting, cross-validation is usually used to predict the OOF (out-of-fold) part of the training set. There are two different variants available in this package but I\u2019m going to describe \u2018Variant A\u2019 in this paragraph. To get the final predictions in this variant, we take the mean or mode of all of our predictions. The whole process can be visualized using this GIF from vecstacks\u2019 documentation:", "After having taken a look at the documentation, it was time to try using the package myself and see how it works. To do so, I decided to use the wine data set available on the UCI Machine Learning Repository. The problem statement for this data set is to use the 13 features, which all represent different aspects of the wine, to predict from which of three cultivars in Italy the wine was derived.", "To get started, let\u2019s first import the packages we are going to need for our project:", "Now we are ready to import our data and take a look at it to gain a better understanding of what it looks like:", "Running the code chunk above gives us:", "Note that I used .sample() instead if .head() to avoid being potentially misled by assuming the entire data set has the structure of the first five rows. Luckily, this data set does not have any missing values, so we can easily use it to test our package right away without any of the usually required data cleaning and preparation.", "Following this, we are going to separate the response from the input variables and perform an 80:20 train-test-split following the example on vecstacks\u2019 documentation.", "We are getting closer to the interesting part. Remember the GIF from earlier? It is time now to define a few first level models for our stacked generalization. This step definitely deserves its own article but for purposes of simplicity, we are going to use three models: A KNN-Classifier, a Random Forest Classifier and an XGBoost Classifier.", "These parameters were not tuned prior to setting them as the purpose of this article is testing the package. If you were to optimize performance, you should not just copy and paste these.", "Taking the next part of code from the documentation, we are essentially performing the GIF\u2019s first part using first level models to make predictions:", "The stacking function takes several inputs:", "Doing so, we get the following output:", "Again, referring to the GIF, all that\u2019s left to do now is fit the second level model(s) of our choice on our predictions to make our final predictions. In our case, we are going to use an XGBoost Classifier. This step is not significantly different from a regular fit-and-predict in sklearn except for the fact that instead of using X_train to train our model, we are using our predictions S_train.", "Using vecstacks\u2019 stacking automation, we\u2019ve managed to predict the correct wine cultivar with an accuracy of approximately 97.2%! As you can see, the API does not collide with the sklearn API and could, therefore, provide a helpful tool when trying to speed up your stacking workflow.", "As always, if you have any feedback or found mistakes, please don\u2019t hesitate to reach out to me.", "[3] M. Forina et al, Wine Data Set (1991), UCI Machine Learning Repository", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CEO and Co-Founder at Anpai. Visit us at www.anp.ai"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffc3e7834772e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lukaskfrei?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lukaskfrei?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": "Lukas Frei"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5164378fc848&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&user=Lukas+Frei&userId=5164378fc848&source=post_page-5164378fc848----fc3e7834772e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc3e7834772e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc3e7834772e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://giphy.com/gifs/funny-food-hRsayJrDAx8WY", "anchor_text": "https://giphy.com/gifs/funny-food-hRsayJrDAx8WY"}, {"url": "https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data'", "anchor_text": "https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data'"}, {"url": "https://www.researchgate.net/publication/222467943_Stacked_Generalization", "anchor_text": "Stacked Generalization"}, {"url": "https://github.com/vecxoz/vecstack", "anchor_text": "Vecstack"}, {"url": "https://archive.ics.uci.edu/ml/datasets/wine", "anchor_text": "Wine Data Set"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fc3e7834772e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fc3e7834772e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fc3e7834772e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fc3e7834772e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----fc3e7834772e---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc3e7834772e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&user=Lukas+Frei&userId=5164378fc848&source=-----fc3e7834772e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc3e7834772e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&user=Lukas+Frei&userId=5164378fc848&source=-----fc3e7834772e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc3e7834772e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffc3e7834772e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fc3e7834772e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fc3e7834772e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fc3e7834772e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fc3e7834772e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fc3e7834772e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lukaskfrei?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lukaskfrei?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lukas Frei"}, {"url": "https://medium.com/@lukaskfrei/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.8K Followers"}, {"url": "http://www.anp.ai", "anchor_text": "www.anp.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5164378fc848&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&user=Lukas+Frei&userId=5164378fc848&source=post_page-5164378fc848--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa6ce63f711f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomate-stacking-in-python-fc3e7834772e&newsletterV3=5164378fc848&newsletterV3Id=a6ce63f711f1&user=Lukas+Frei&userId=5164378fc848&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}