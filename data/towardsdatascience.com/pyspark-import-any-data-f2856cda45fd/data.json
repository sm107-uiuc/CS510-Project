{"url": "https://towardsdatascience.com/pyspark-import-any-data-f2856cda45fd", "time": 1683000807.629576, "path": "towardsdatascience.com/pyspark-import-any-data-f2856cda45fd/", "webpage": {"metadata": {"title": "Pyspark \u2013 Import any data. A brief guide to import data with Spark | by Alexandre Wrg | Towards Data Science", "h1": "Pyspark \u2013 Import any data", "description": "With this article, I will start a series of short tutorials on Pyspark, from data pre-processing to modeling. The first will deal with the import and export of any type of data, CSV , text file\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/AlexWarembourg/Medium", "anchor_text": "https://github.com/AlexWarembourg/Medium", "paragraph_index": 11}], "all_paragraphs": ["With this article, I will start a series of short tutorials on Pyspark, from data pre-processing to modeling. The first will deal with the import and export of any type of data, CSV , text file, Avro, Json \u2026etc. I work on a virtual machine on google cloud platform data comes from a bucket on cloud storage. Let\u2019s import them.", "Spark has an integrated function to read csv it is very simple as:", "The data is loaded with the right number of columns and there does not seem to be any problem in the data, however the header is not fixed. We need to set header = True parameters.", "and parameters like sep to specify a separator or inferSchema to infer the type of data, let\u2019s look at the schema by the way.", "Our dataframe has all types of data set in string, let\u2019s try to infer the schema.", "We can specify our Schema manualy", "In the case of an Avro we need to call an external databricks package to read them.", "In the same way spark has a built-in function", "you can also read textfile as rdd", "To export data you have to adapt to what you want to output if you write in parquet, avro or any partition files there is no problem. If we want to write in CSV we must group the partitions scattered on the different workers to write our CSV file", "By using coalesce(1) or repartition(1) all the partitions of the dataframe are combined in a single block.", "We saw how to import our file and write it now. Let\u2019s go to my next article to learn how to filter our dataframe. Thanks. You can find the code here : https://github.com/AlexWarembourg/Medium", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist at Auchan Retail Data"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff2856cda45fd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alexandrewrg?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexandrewrg?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": "Alexandre Wrg"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5f80e627a47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&user=Alexandre+Wrg&userId=a5f80e627a47&source=post_page-a5f80e627a47----f2856cda45fd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff2856cda45fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff2856cda45fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://upload.wikimedia.org/wikipedia/commons/f/f3/Apache_Spark_logo.svg", "anchor_text": "https://upload.wikimedia.org/wikipedia/commons/f/f3/Apache_Spark_logo.svg"}, {"url": "https://github.com/AlexWarembourg/Medium", "anchor_text": "https://github.com/AlexWarembourg/Medium"}, {"url": "https://medium.com/tag/big-data?source=post_page-----f2856cda45fd---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/spark?source=post_page-----f2856cda45fd---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f2856cda45fd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----f2856cda45fd---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----f2856cda45fd---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff2856cda45fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&user=Alexandre+Wrg&userId=a5f80e627a47&source=-----f2856cda45fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff2856cda45fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&user=Alexandre+Wrg&userId=a5f80e627a47&source=-----f2856cda45fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff2856cda45fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff2856cda45fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f2856cda45fd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f2856cda45fd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f2856cda45fd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f2856cda45fd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f2856cda45fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexandrewrg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexandrewrg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexandre Wrg"}, {"url": "https://medium.com/@alexandrewrg/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "354 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5f80e627a47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&user=Alexandre+Wrg&userId=a5f80e627a47&source=post_page-a5f80e627a47--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7c3751d086ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-import-any-data-f2856cda45fd&newsletterV3=a5f80e627a47&newsletterV3Id=7c3751d086ca&user=Alexandre+Wrg&userId=a5f80e627a47&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}