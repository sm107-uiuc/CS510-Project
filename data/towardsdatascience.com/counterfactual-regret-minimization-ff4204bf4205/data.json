{"url": "https://towardsdatascience.com/counterfactual-regret-minimization-ff4204bf4205", "time": 1683018317.022324, "path": "towardsdatascience.com/counterfactual-regret-minimization-ff4204bf4205/", "webpage": {"metadata": {"title": "Counterfactual Regret Minimization | by Ziad SALLOUM | Towards Data Science", "h1": "Counterfactual Regret Minimization", "description": "The notion of \u201cregret\u201d is introduced in the article \u201cIntroduction to Regret in Reinforcement Learning\u201d. However, it considers scenarios or games composed of a single step or action. Certainly, this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/introduction-to-regret-in-reinforcement-learning-f5b4a28953cd", "anchor_text": "Introduction to Regret in Reinforcement Learning", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Tic-tac-toe", "anchor_text": "tic-tac-toe", "paragraph_index": 5}, {"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com", "paragraph_index": 27}, {"url": "https://towardsdatascience.com/introduction-to-regret-in-reinforcement-learning-f5b4a28953cd", "anchor_text": "Introduction to Regret in Reinforcement Learning", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/introduction-to-fictitious-play-12a8bc4ed1bb", "anchor_text": "Introduction to Fictitious Play", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/fictitious-self-play-30b76e30ec6a", "anchor_text": "Fictitious Self Play", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/neural-fictitious-self-play-800612b4a53f", "anchor_text": "Neural Fictitious Self-Play", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/neural-fictitious-self-play-in-practice-132836b69bf5", "anchor_text": "Neural Fictitious Self-Play in Practice", "paragraph_index": 28}], "all_paragraphs": ["\u201cWe should regret our mistakes and learn from them, but never carry them forward into the future with us.\u201d", "Learning from regrets is what Counter Factual Minimization is all about.", "The notion of \u201cregret\u201d is introduced in the article \u201cIntroduction to Regret in Reinforcement Learning\u201d. However, it considers scenarios or games composed of a single step or action. Certainly, this is not realistic enough, because most scenarios, in reality, are composed of multiple steps.", "It is clear that in every aspect of life, each decision might have a long term impact, and its effect might not be apparent on the spot, but later on.", "Counter Factual Regret Minimisation, is a method that deals with scenarios composed of multiple steps, and how to detect errors (thus estimating regret) at every step.", "This article provides a general overview of the CFR algorithm and a working example of a tic-tac-toe game.", "As we said, most of the time games or scenarios are multi-step.So it is important to be able to know what is the regret of not taking a certain action at each step.", "After each turn, each player assesses the situation and the value of the state she is in. The assessment takes into consideration whether there is a possibility of winning, losing, etc\u2026", "Similarly to Value State in MDP, each node of the game in CFR has a value, called counterfactual. The bottom line is the average of future rewards weighed by their probabilities of really occurring.", "The image above shows a node directly leading to three other nodes, each one with a different probability (.3, .2, .5). Each of the destination nodes has a value (3, 5, 2). The value of the parent node will be equal to the sum of each of the child node multiplied by its probability of happening:3*.3 + 5*.2 + 2*.5 = 2.9", "Recursively the parent node communicates its value to its parent multiplied by the probability of happening.", "Since we have computed the value of each node, let\u2019s compute the regret of not taking each action. We define regret by the value of the child minus the value of the parent. A quick computation will give us these results:3 - 2.9 = .15 - 2.9 = 2.12 - 2.9 = -.9", "As seen the action that is regretted the most is the second one (that leads to 5)In other words, this action should be more probable than the others. So the probabilities will be recomputed to reflect this fact.The probabilities (also called strategies) will be computed as follows:Strategy(i) = Regret(i)/sum of positive regretsSum of positive regrets is 2.1 + .1 = 2.2The strategy of negative regrets is given a value of zero.Strategy1 = .1 / 2.2 = .05Strategy2 = 2.1 / 2.2 = .95Strategy3 = 0", "With these new strategies, we compute the new value of the parent node as seen in the image below.", "So far we have established the value and the regret for each node, however, there is a catch!The value of each node will be used by its parent combined with the probability that that node will be reached.But this is not the case for the regret. Considering that the regret (in our example) of the middle action is 5\u20132.9 = 2.1, we still don\u2019t know that this node will be reached and this regret will be computed?!", "So the regret should also be multiplied by the probability of reaching its appropriate node.", "Assuming that the probability of reaching the node in our example is .2, then the regret of that node will be 2.1 * .2 = 0.42", "Important. This will not change the values of the computed strategies because we are multiplying all its components by the same (reaching) probability, on the current iteration (more on that below).", "Cumulative ComputationsAs you most probably already know, all AI/Machine Learning algorithms are based on iterative computations. Thousands or even millions of iterations are done to reach acceptable results of behavior.", "CFR is no exception! The CFR tree is computed many times, and on each iteration, the regret and the strategies are updated.", "The regret is computed cumulatively for each node and each action, then the strategy is derived from these regret values.", "Suppose for node n, there are 2 actions a1, a2. Since the tree will be iterated N times, on each iteration, on node n, we have a new value for regret and the reaching probability.", "The strategies are computed as usual:", "When computing CFR for a two-player zero-sum game, there are some important details to be aware of.", "The code shared in Google Colab is an implementation of CFR of the Tic-Tac-Toe game.To use it, you should first create a copy of your own, set the iterations that you want, train it by running the first cell, then start playing by running the second cell.", "Important! the training time is exponentially proportional to the number of iterations.1 iteration takes approx 30sec10 iterations take approx 5min100 iterations take approx 30min1000 iterations take approx 4h30min", "It is advisable to train with 1 iteration first then play against the algorithm, then train it with 10 or 100 iterations then play and see the difference.", "Update: If you are looking to learn and practice Reinforcement Learning you might be interested in http://rl-lab.com", "Introduction to Regret in Reinforcement LearningIntroduction to Fictitious PlayFictitious Self PlayNeural Fictitious Self-PlayNeural Fictitious Self-Play in Practice", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fff4204bf4205&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zsalloum.medium.com/?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2----ff4204bf4205---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff4204bf4205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff4204bf4205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@brett_jordan?utm_source=medium&utm_medium=referral", "anchor_text": "Brett Jordan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/introduction-to-regret-in-reinforcement-learning-f5b4a28953cd", "anchor_text": "Introduction to Regret in Reinforcement Learning"}, {"url": "https://en.wikipedia.org/wiki/Tic-tac-toe", "anchor_text": "tic-tac-toe"}, {"url": "https://colab.research.google.com/drive/1SYNxGdR7UmoxbxY-NSpVsKywLX7YwQMN?usp=sharing", "anchor_text": "Google ColaboratoryEdit descriptioncolab.research.google.com"}, {"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com"}, {"url": "https://towardsdatascience.com/introduction-to-regret-in-reinforcement-learning-f5b4a28953cd", "anchor_text": "Introduction to Regret in Reinforcement Learning"}, {"url": "https://towardsdatascience.com/introduction-to-fictitious-play-12a8bc4ed1bb", "anchor_text": "Introduction to Fictitious Play"}, {"url": "https://towardsdatascience.com/fictitious-self-play-30b76e30ec6a", "anchor_text": "Fictitious Self Play"}, {"url": "https://towardsdatascience.com/neural-fictitious-self-play-800612b4a53f", "anchor_text": "Neural Fictitious Self-Play"}, {"url": "https://towardsdatascience.com/neural-fictitious-self-play-in-practice-132836b69bf5", "anchor_text": "Neural Fictitious Self-Play in Practice"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----ff4204bf4205---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/counterfactual?source=post_page-----ff4204bf4205---------------counterfactual-----------------", "anchor_text": "Counterfactual"}, {"url": "https://medium.com/tag/regret-minimisation?source=post_page-----ff4204bf4205---------------regret_minimisation-----------------", "anchor_text": "Regret Minimisation"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ff4204bf4205---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-intelligence?source=post_page-----ff4204bf4205---------------machine_intelligence-----------------", "anchor_text": "Machine Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff4204bf4205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----ff4204bf4205---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff4204bf4205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----ff4204bf4205---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff4204bf4205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fff4204bf4205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ff4204bf4205---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ff4204bf4205--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ff4204bf4205--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ff4204bf4205--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ff4204bf4205--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://zsalloum.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "845 Followers"}, {"url": "https://rl-lab.com", "anchor_text": "https://rl-lab.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F408fc441c93b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounterfactual-regret-minimization-ff4204bf4205&newsletterV3=1f2b933522e2&newsletterV3Id=408fc441c93b&user=Ziad+SALLOUM&userId=1f2b933522e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}