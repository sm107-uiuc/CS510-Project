{"url": "https://towardsdatascience.com/election-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9", "time": 1683015916.9858801, "path": "towardsdatascience.com/election-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9/", "webpage": {"metadata": {"title": "Election Special: Train a GPT-2 to generate Donald Trump Speeches | by Priya Dwivedi | Towards Data Science", "h1": "Election Special: Train a GPT-2 to generate Donald Trump Speeches", "description": "In this second blog focused on the US 2020 election, we train a GPT-2 model on Donald Trump's speeches. With minimal training, the GPT-2 model successfully replicates his style and starts writing in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://openai.com/blog/better-language-models/", "anchor_text": "GPT-2 model", "paragraph_index": 1}, {"url": "https://huggingface.co/transformers/model_doc/gpt2.html", "anchor_text": "HuggingFace repo\u2019s", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/election-special-detect-fake-news-using-transformers-3e38d0c5b5c7", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://deeplearninganalytics.org/", "anchor_text": "Deep Learning Analytics", "paragraph_index": 3}, {"url": "https://www.kaggle.com/christianlillelund/donald-trumps-rallies", "anchor_text": "Kaggle data set", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/train-a-gpt-2-transformer-to-write-harry-potter-books-edf8b2e3f3db", "anchor_text": "blog", "paragraph_index": 9}, {"url": "https://deeplearninganalytics.org/", "anchor_text": "Deep Learning Analytics", "paragraph_index": 20}, {"url": "https://deeplearninganalytics.org/contact-us/", "anchor_text": "here", "paragraph_index": 20}], "all_paragraphs": ["In this second blog focused on the US 2020 election, we train a GPT-2 model on Donald Trump's speeches. With minimal training, the GPT-2 model successfully replicates his style and starts writing in his style. See sample Donald Trump speech generated by GPT-2. It does sound like him!", "GPT-2 model was released by Open AI last year. It is a language model that has been trained on 40GB of internet text. This model can be fine-tuned on any text sample to tweak its generation style based on the input text. In this blog, we use the HuggingFace repo\u2019s implementation of GPT-2 and look at how you can tune it to write speeches for DT.", "We also wrote an election special blog on using the T5 model to detect fake news. Check it out here.", "At Deep Learning Analytics, we are very passionate about using data science and machine learning to solve real-world problems. Please reach out to us to discuss an NLP project with us.", "For this blog, we have used the Kaggle data set \u2014 Donald Trump\u2019s Rallies. This data set has 35 speeches from him. Half of the speeches are from late last year and the rest are from this year. The latest speeches are from his rallies in Salem, Fayetteville, and Henderson in September 2020.", "Before we start training a language model on this data, we need to get the data in the format required for GPT-2. GPT-2 needs data to be passed in sentence by sentence.", "As part of our data preprocessing we do the following:", "The code snippet for doing this is below. The NLTK library is used to sentence tokenize the speech into sentences.", "The train and Val sentence lists are written into text files. The GPT-2 model will use these text files for training.", "GPT-2 is a language model that can be fine-tuned on many downstream tasks including language modeling, summarization, etc. To learn more about language modeling, please read this blog from me.", "To fine-tune your model, first clone the latest hugging face transformers repo.", "The language model fine-tuning script is under examples/language-modeling. Start training using the following command:", "Besides these, we have the batch size and num epochs.", "I am able to train GPT-2 small with the above configs on GTX-1080 Ti in about 20 minutes. The trained model has a perplexity score of 14 on the validation set. This is not bad. I think if you have more compute, you can try a longer block size and GPT-2 medium model to further improve the perplexity score.", "To test the trained model, we navigate to the examples/text-generation folder in transformers repo. To generate text we need to pass the path to the trained model. We can also pass a prompt to give direction to the generation. Command to run generation is below.", "The model I fine-tuned generated the following fun snippets.", "As can be seen, GPT-2 learns that democrats prefer open immigration and free healthcare.", "Here GPT-2 is replicating his self-applauding style \u2014 \u201cWe love this guy.\u201d, \u201cWell, it\u2019s true. I\u2019ll never be able to compete with you, Donald Trump.\u201d", "It was fun and easy to fine-tune the GPT2 model on Donald Trump\u2019s speeches. It is encouraging to see that with very little training, the model is able to replicate the style and key words in DT\u2019s vocabulary.", "I hope you give the code a try and train your own models. Please share your experience in the comments below.", "At Deep Learning Analytics, we are extremely passionate about using Machine Learning to solve real-world problems. We have helped many businesses deploy innovative AI-based solutions. Contact us through our website here if you see an opportunity to collaborate.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb66fc3aa92b9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438----b66fc3aa92b9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb66fc3aa92b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb66fc3aa92b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/ls8Kc0P9hAA", "anchor_text": "https://unsplash.com/photos/ls8Kc0P9hAA"}, {"url": "https://openai.com/blog/better-language-models/", "anchor_text": "GPT-2 model"}, {"url": "https://huggingface.co/transformers/model_doc/gpt2.html", "anchor_text": "HuggingFace repo\u2019s"}, {"url": "https://towardsdatascience.com/election-special-detect-fake-news-using-transformers-3e38d0c5b5c7", "anchor_text": "here"}, {"url": "https://deeplearninganalytics.org/", "anchor_text": "Deep Learning Analytics"}, {"url": "https://www.kaggle.com/christianlillelund/donald-trumps-rallies", "anchor_text": "Kaggle data set"}, {"url": "https://media.giphy.com/media/g0Kzu8bTbGPPEH0hSm/giphy.gif", "anchor_text": "https://media.giphy.com/media/g0Kzu8bTbGPPEH0hSm/giphy.gif"}, {"url": "https://towardsdatascience.com/train-a-gpt-2-transformer-to-write-harry-potter-books-edf8b2e3f3db", "anchor_text": "blog"}, {"url": "https://github.com/huggingface/transformers", "anchor_text": "https://github.com/huggingface/transformers"}, {"url": "https://deeplearninganalytics.org/", "anchor_text": "Deep Learning Analytics"}, {"url": "https://deeplearninganalytics.org/contact-us/", "anchor_text": "here"}, {"url": "https://openai.com/blog/better-language-models/", "anchor_text": "Open AI GPT-2"}, {"url": "https://huggingface.co/transformers/model_doc/t5.html", "anchor_text": "Huggingface Transformers"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b66fc3aa92b9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/election-2020?source=post_page-----b66fc3aa92b9---------------election_2020-----------------", "anchor_text": "Election 2020"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b66fc3aa92b9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----b66fc3aa92b9---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b66fc3aa92b9---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb66fc3aa92b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&user=Priya+Dwivedi&userId=b040ce924438&source=-----b66fc3aa92b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb66fc3aa92b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&user=Priya+Dwivedi&userId=b040ce924438&source=-----b66fc3aa92b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb66fc3aa92b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb66fc3aa92b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b66fc3aa92b9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b66fc3aa92b9--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://priya-dwivedi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.1K Followers"}, {"url": "http://www.deeplearninganalytics.org/", "anchor_text": "http://www.deeplearninganalytics.org/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F373349a3bfb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felection-special-train-a-gpt-2-to-generate-donald-trump-speeches-b66fc3aa92b9&newsletterV3=b040ce924438&newsletterV3Id=373349a3bfb7&user=Priya+Dwivedi&userId=b040ce924438&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}