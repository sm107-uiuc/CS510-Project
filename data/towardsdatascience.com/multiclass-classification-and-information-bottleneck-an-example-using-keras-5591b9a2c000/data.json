{"url": "https://towardsdatascience.com/multiclass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000", "time": 1683013335.8344152, "path": "towardsdatascience.com/multiclass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000/", "webpage": {"metadata": {"title": "Multiclass Classification and Information Bottleneck \u2014 An example using Keras | by Rakshit Raj | Towards Data Science", "h1": "Multiclass Classification and Information Bottleneck \u2014 An example using Keras", "description": "Multiclass Classification is the classification of samples in more than two classes. Classifying samples into precisely two categories is colloquially referred to as Binary Classification. This piece\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.manning.com/books/deep-learning-with-python", "anchor_text": "Deep Learning with Python by Francois Chollet", "paragraph_index": 47}, {"url": "https://github.com/rakshitraj/fchollet/", "anchor_text": "implementation", "paragraph_index": 48}, {"url": "https://github.com/rakshitraj/", "anchor_text": "GitHub", "paragraph_index": 48}], "all_paragraphs": ["Multiclass Classification is the classification of samples in more than two classes. Classifying samples into precisely two categories is colloquially referred to as Binary Classification.", "This piece will design a neural network to classify newsreels from the Reuters dataset, published by Reuters in 1986, into forty-six mutually exclusive classes using the Python library Keras. This problem is a typical example of a single-label, multiclass classification problem.", "Neural networks are comprised of many layers. Each layer performs some transformation on the data mapping input to the output of the network. However, it is crucial to note that these layers do not generate any additional data and work solely on the data that they receive from the preceding layers.", "If, say, a layer drops some relevant data, that information becomes inaccessible to all subsequent layers. This information is permanently lost and cannot be retrieved. The layer that drops this information now acts as a bottleneck, stifling the increase of the model\u2019s accuracy and performance, thus acting as an information bottleneck.", "We shall see this in action later on.", "The Reuters dataset is a set of short newswires sorted into 46 mutually exclusive topics. Reuters published it in 1986. This dataset is used widely for text classification. There are 46 topics, where some topics are represented more than others. However, each topic contains at least ten examples in the training set.", "The Reuters dataset comes preloaded with Keras and contains 8,982 training examples and 2,246 testing examples.", "Load data from the pre-packaged module in Keras. We will limit the data to 10,000 of the most frequently occurring words. To do this, we pass num_words=10000 argument to the load_data function.", "We\u2019ll perform some good-old-fashioned EDA on our dataset. Doing so will give us a general idea of the breadth and scope of our data.", "Let\u2019s go ahead and decode a story. Decoding helps us get the gist of the organization and encoding of the data.", "We cannot feed integer sequences to the neural network; therefore, we will vectorize each sequence and convert it into tensors. We do this by One-Hot Encoding each sequence.", "We have 10,000 unique elements in our training and testing data. Vectorizing our input data will result in two 2D tensors; a training Input tensor of shape (8982, 10000) and a test input tensor of shape (2246, 10000).", "The Labels for this problem include 46 different classes. The labels are represented as integers in the range 1 to 46. To vectorize the labels, we could either,", "We will go ahead with One-Hot Encoding of the label data. This will give us tensors, whose second axis has 46 dimensions. This can be done easily using the to_categorical function in Keras.", "For greater clarity, we will do it manually.", "The other way to perform One-Hot categorical encoding_of the labels is to use the built-in function, as shown in the Gist above. For clarity, here it is again:", "The problem of topic classification (single-label multiclass classification_) is similar to _Binary Classification of text fields. Both problems follow a similar approach towards handling and pre-processing of data. The pedagogy of implementing neural network remains unchanged. However, there is a new constraint: the number of classes just went from 2 to 46. The dimensionality of the output space is much higher.", "Therefore, each layer will have to deal with more data, which presents the genuine possibility of an information bottleneck.", "Given a multiclass classification problem, the amount of processing that we need to perform on the data dramatically increases as compared to a Binary Classification problem.", "In a stack of Dense layers, like the ones we use, each layer can only access information present in the output of the previous layer. If a layer drops relevant information, that information is permanently inaccessible for all subsequent layers. Information, once lost, can never be recovered by later layers. In cases like multiclass classification_, where data is limited and crucial, every layer could become an information bottleneck.", "If a layer drops relevant information, it is potentially an information bottleneck.", "Such layers could easily bottleneck the performance of our network. To ensure that crucial data is not discarded, we will use layers with a greater number of hidden units, i.e., Larger layers. For comparison, we use layers with 16 hidden units Dense(16) in the two-class classification example of Sentiment analysis of IMDB Reviews. In this case, where the output dimension is 46, we will use layers with 64 hidden units, Dense(64).", "We will define our network with two fully-connected ReLU activated layers with 64 hidden units each. The third and last layer will be Dense layer of size 46. This layer will use a softmax activation and will output a 46-dimensional vector. Every dimension will be the probability of the input belonging to that class.", "For our network, we will use the optimizer rmsprop, _loss function_, categorical_crossentropy, and will monitor the accuracy (_metrics_) of the model.", "Initially, we will train our models for 20 epochs in mini-batches of 512 samples. We will also pass our validation set to the fit method.", "Calling the fit method returns a History object. This object contains a member history which stores all data about the training process, including the values of observable or monitored quantities as the epochs proceed. We will save this object since the information it holds will help us to determine the fine-tuning better to apply to the training step.", "At the end of the training, we have attained a training accuracy of 95% and validation accuracy of 80.9%", "Now that we have trained our network, we will observe its performance metrics stored in the History object.", "Calling the fit method returns a History object. This object has an attribute history which is a dictionary containing four entries: one per monitored metric.", "at the end of each epoch.", "Let\u2019s use Matplotlib to plot Training and validation losses and Training and Validation Accuracy side by side.", "We observe that minimum validation loss and maximum validation Accuracy is achieved at around 9\u201310 epochs. After that, we observe two trends:", "This implies that the model is getting better at classifying the sentiment of the training data, but making consistently worse predictions when it encounters new, previously unseen data, which is the hallmark of overfitting. After the 10th epoch, the model begins to fit too closely to the training data.", "To address overfitting, we will reduce the number of epochs to 9. These results may vary depending on your machine and due to the very nature of the random assignment of weights that may differ from one model to model.", "In our case, we will stop training after nine epochs.", "Now that we know that excessive epochs are causing our model to overfit, we will limit the number of epochs and retrain our model from scratch.", "Our approach results in an efficiency of ~80%", "If this were a balanced dataset, a random attribution of labels would, using simple probability, result in 50% accuracy. But since this dataset is not balanced, the accuracy of a random classifier might be on the lesser side.", "A random classifier doles out labels to samples randomly. To put it in perspective, a random classifier is how the chimp at your local zoo would classify these newsreels.", "Considering that the random baseline is about 19%, our model with an accuracy of ~80% performs quite well.", "This time we introduce an information bottleneck in our model. One of our layers will drop data, and we will see its effect on the model performance as a drop in its accuracy.", "In the presence of a bottleneck, the testing accuracy drops 10%", "At this point, you will have successfully classified newsreels from the Reuters Dataset under their respective topics. You will also have seen how layers with an inadequate number of hidden units wreak havoc on your model\u2019s performance by killing precious data.", "The effect of information bottleneck is clearly visible as a sizeable reduction in prediction accuracy.", "I recommend that you work along with the article. You can solve most Multiclass classification problems using a similar strategy. If you did solve it, try fiddling the design and parameters of the network and its layers. Doing so will help you better understand the attributes and architecture of the model you chose.", "I discuss a single topic in additional detail in each of my articles. In this one, we explored the information bottleneck. An exhaustive explanation of any particular topic is never in the scope of my writing; however, you will find ample quick asides.", "I assume that the reader is not a total novice in the field of machine learning. More of my work that precedes and build up to this article is linked below;", "For more, please check out the book I swear by\u200a\u2014 Deep Learning with Python by Francois Chollet.", "Feel free to check out this article\u2019s implementation and more of my work on GitHub.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5591b9a2c000&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rakshitr.medium.com/?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": ""}, {"url": "https://rakshitr.medium.com/?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": "Rakshit Raj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4fcac7ae4c77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&user=Rakshit+Raj&userId=4fcac7ae4c77&source=post_page-4fcac7ae4c77----5591b9a2c000---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5591b9a2c000&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5591b9a2c000&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@freegraphictoday?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "AbsolutVision"}, {"url": "https://unsplash.com/s/photos/news?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "http://github.com/rakshitraj", "anchor_text": "rakshitraj"}, {"url": "https://gist.github.com/rakshitraj", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/binary-classification-of-imdb-movie-reviews-648342bc70dd", "anchor_text": "Binary Classification of IMDB Movie ReviewsUse Keras to classify reviews based on sentiment.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/solve-the-mnist-image-classification-problem-9a2865bcf52a", "anchor_text": "Solve the MNIST Image Classification ProblemThe \u2018hello world!\u2019 of Deep Learning and Keras in under 10 minutestowardsdatascience.com"}, {"url": "https://www.manning.com/books/deep-learning-with-python", "anchor_text": "Deep Learning with Python by Francois Chollet"}, {"url": "https://github.com/rakshitraj/fchollet/", "anchor_text": "implementation"}, {"url": "https://github.com/rakshitraj/", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----5591b9a2c000---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5591b9a2c000---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----5591b9a2c000---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----5591b9a2c000---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/python?source=post_page-----5591b9a2c000---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5591b9a2c000&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&user=Rakshit+Raj&userId=4fcac7ae4c77&source=-----5591b9a2c000---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5591b9a2c000&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&user=Rakshit+Raj&userId=4fcac7ae4c77&source=-----5591b9a2c000---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5591b9a2c000&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5591b9a2c000&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5591b9a2c000---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5591b9a2c000--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5591b9a2c000--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5591b9a2c000--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5591b9a2c000--------------------------------", "anchor_text": ""}, {"url": "https://rakshitr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rakshitr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rakshit Raj"}, {"url": "https://rakshitr.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://www.rakshitraj.com/", "anchor_text": "https://www.rakshitraj.com/"}, {"url": "https://www.linkedin.com/in/rakshitraj/", "anchor_text": "https://www.linkedin.com/in/rakshitraj/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4fcac7ae4c77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&user=Rakshit+Raj&userId=4fcac7ae4c77&source=post_page-4fcac7ae4c77--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdcb5db85dd6f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulticlass-classification-and-information-bottleneck-an-example-using-keras-5591b9a2c000&newsletterV3=4fcac7ae4c77&newsletterV3Id=dcb5db85dd6f&user=Rakshit+Raj&userId=4fcac7ae4c77&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}