{"url": "https://towardsdatascience.com/exploring-densenets-from-paper-to-keras-dcc01725488b", "time": 1683005093.085531, "path": "towardsdatascience.com/exploring-densenets-from-paper-to-keras-dcc01725488b/", "webpage": {"metadata": {"title": "Exploring DenseNets: From Paper To Keras | by Shubham Panchal | Towards Data Science", "h1": "Exploring DenseNets: From Paper To Keras", "description": "DenseNets are used widely for image classification tasks, segmentation, image reconstruction and so on. You\u2019ll probably see them in the tf.keras.applications module if you\u2019 re a seasoned TF\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNets", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNets", "paragraph_index": 9}, {"url": "https://colab.research.google.com/drive/1v2p228o-_PRtecU0vYUXuGlG_VierqcP#scrollTo=wbkXMkrTgXiF&forceEdit=true&sandboxMode=true", "anchor_text": "Colab notebook", "paragraph_index": 25}], "all_paragraphs": ["DenseNets are used widely for image classification tasks, segmentation, image reconstruction and so on. You\u2019ll probably see them in the tf.keras.applications module if you\u2019 re a seasoned TF developer. What are DenseNets? Is there something really dense in them? Come let\u2019s explore!", "You can view the TF implementation in this notebook,", "Absolutely, DenseNets are densely connected convolutional neural networks. We\u2019ll understand this point by comparing a regular CNN ( which you\u2019ll see in most online blogs ) and a Dense Block ( the building blocks of the DenseNet! ).", "The rectangles represent the convolution layers, the red lines denote the connection or the flow of information.", "Notice the convolution layer 3 in both the networks above. In the first network, the 3rd layer receives information from the previous layer i.e the 2nd layer. This seems normal.", "Take a look at the 2nd network. This is what a Dense Block does. The 3rd convolution layer in the 2nd network is receiving information from all the previous layers. It receives 3 inputs namely,", "See, we are getting the outputs of all the previous layers ( layer no. 1 and 2 ) as well as the inputs. That\u2019s the difference between our regular CNNs and Dense Blocks. Every layer in a Dense Block is connected with every succeeding layer in the block. A block is just a fancy name for a group of layers with dense connections.", "Alongside Dense Blocks, we have so-called Transition Layers. They basically downsample the feature maps. These layers perform a 1 \u00d7 1 convolution along with 2 \u00d7 2 average pooling.", "The idea turned out to be a wonderful trick. Each layer, in our traditional CNNs, gets to know only about the feature map which it received from the previous layer. The poor convolution layer knows nothing about the inputs of the network. It learns only on the previous inputs.", "On the other hand, every layer in a Dense Block is receiving inputs or information from all the layers. In simpler words, the information is available to the whole network on a global scale. This is even mentioned in the amazing paper of DenseNets,", "\u201cBesides better parameter ef\ufb01ciency, one big advantage of DenseNets is their improved \ufb02ow of information and gradients throughout the network, which makes them easy to train.\u201d", "\u201cTo further improve the information \ufb02ow between layers we propose a different connectivity pattern: we introduce direct connections from any layer to all subsequent layers.\u201d", "We may also include Bottleneck layers to enhance computational efficiency. Due to the concatenation of many inputs, we have a large number of feature maps that may slow down the training. So, we perform a 1 \u00d7 1 Convolution on the inputs to tackle this problem.", "Another method to tackle the above-mentioned problem is to use a compression rate. It is chosen from the interval ( 0, 1 ] and decides the number of feature maps a transition layer will produce. If \u03b8 is the compression factor and m is the number of the input feature maps then the transition layers produce p feature maps given by,", "We can indeed understand the concept of dense connectivity with some Math! Don\u2019t worry, it simple to understand. Consider an input image x\u2080 which is given to our Dense Block.", "H is a composite function which consists of three operations: Batch Normalization \u2192 ReLU \u2192 Convolution", "We de\ufb01ne H(\u00b7) as a composite function of three consecutive operations: batch normalization (BN), followed by a recti\ufb01ed linear unit (ReLU) and a 3\u00d73 convolution (Conv).", "The output of the first layer ( x\u2081), will be produced by,", "In general for a regular CNN ( not DenseNets ), the l th output will be produced by the input of the l -1 th layer.", "For a DenseNet, as we discussed earlier, a layer receives inputs from the previous layers. It will look like,", "That\u2019s the mathematical expression for a DenseBlock.", "We were all eagerly waiting for this, right? I\u2019ll insist you follow the Colab notebook to have a look at the implementation of DenseNets. First, we implement the H function which we discussed earlier.", "Now, the Dense Block is implemented. We will call the H() method, concatenate the conv_outputs with the inputs which are the previous outputs? This will all happen in a loop,", "We\u2019ll now assemble all the Dense Blocks together and connect them with Transition layers,", "And finally, we make a beautiful tf.keras.models.Model() ,", "The training and evaluation are included in the Colab notebook. Congrats, you\u2019ve implemented a DenseNet from scratch!", "The idea of DenseNets is pretty impressive. Make sure you read about ResNets too. Go through the paper where you\u2019ll know more about the training details. Thanks for reading.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "\ud83d\ude07 Loves Android and ML, \ud83d\udca1 answering your thought-provoking questions in ML intuitively, \ud83d\udc68\u200d\ud83c\udf93 aspiring ML researcher"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdcc01725488b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dcc01725488b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dcc01725488b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://equipintelligence.medium.com/?source=post_page-----dcc01725488b--------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=post_page-----dcc01725488b--------------------------------", "anchor_text": "Shubham Panchal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd45a9465f044&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&user=Shubham+Panchal&userId=d45a9465f044&source=post_page-d45a9465f044----dcc01725488b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdcc01725488b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdcc01725488b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alinnnaaaa?utm_source=medium&utm_medium=referral", "anchor_text": "Alina Grubnyak"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNets"}, {"url": "https://colab.research.google.com/drive/1v2p228o-_PRtecU0vYUXuGlG_VierqcP#scrollTo=wbkXMkrTgXiF&forceEdit=true&sandboxMode=true", "anchor_text": "Google ColaboratoryEdit descriptioncolab.research.google.com"}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNets"}, {"url": "https://colab.research.google.com/drive/1v2p228o-_PRtecU0vYUXuGlG_VierqcP#scrollTo=wbkXMkrTgXiF&forceEdit=true&sandboxMode=true", "anchor_text": "Colab notebook"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----dcc01725488b---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dcc01725488b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----dcc01725488b---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/python?source=post_page-----dcc01725488b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----dcc01725488b---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdcc01725488b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&user=Shubham+Panchal&userId=d45a9465f044&source=-----dcc01725488b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdcc01725488b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&user=Shubham+Panchal&userId=d45a9465f044&source=-----dcc01725488b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdcc01725488b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dcc01725488b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdcc01725488b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dcc01725488b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dcc01725488b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dcc01725488b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dcc01725488b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dcc01725488b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dcc01725488b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dcc01725488b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dcc01725488b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dcc01725488b--------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shubham Panchal"}, {"url": "https://equipintelligence.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd45a9465f044&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&user=Shubham+Panchal&userId=d45a9465f044&source=post_page-d45a9465f044--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F55bcc27ba160&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-densenets-from-paper-to-keras-dcc01725488b&newsletterV3=d45a9465f044&newsletterV3Id=55bcc27ba160&user=Shubham+Panchal&userId=d45a9465f044&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}