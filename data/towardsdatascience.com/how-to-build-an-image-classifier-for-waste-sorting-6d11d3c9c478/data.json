{"url": "https://towardsdatascience.com/how-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478", "time": 1682995555.403247, "path": "towardsdatascience.com/how-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478/", "webpage": {"metadata": {"title": "How to build an image classifier for waste sorting | by Collin Ching | Towards Data Science", "h1": "How to build an image classifier for waste sorting", "description": "Recycling contamination occurs when waste is incorrectly disposed of \u2014 like recycling a pizza box with oil on it (compost). Or when waste is correctly disposed of but incorrectly prepared \u2014 like\u2026"}, "outgoing_paragraph_urls": [{"url": "http://mediaroom.wm.com/the-battle-against-recycling-contamination-is-everyones-battle/", "anchor_text": "huge problem", "paragraph_index": 1}, {"url": "https://github.com/garythung/trashnet/blob/master/data/dataset-resized.zip", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/collindching/Waste-Sorter", "anchor_text": "the notebook.", "paragraph_index": 2}, {"url": "https://nbviewer.jupyter.org/github/collindching/Waste-Sorter/blob/master/Waste%20sorter.ipynb", "anchor_text": "notebook", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/convolutional-neural-networks-for-beginners-practical-guide-with-python-and-keras-dc688ea90dca", "anchor_text": "convolutional neural network (CNN)", "paragraph_index": 11}, {"url": "http://www.image-net.org/", "anchor_text": "ImageNet database", "paragraph_index": 11}, {"url": "http://teleported.in/posts/decoding-resnet-architecture/", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://www.jeremyjordan.me/nn-learning-rate/", "anchor_text": "post", "paragraph_index": 16}, {"url": "https://docs.fast.ai/basic_train.html#Learner.get_preds", "anchor_text": "documentation", "paragraph_index": 23}, {"url": "https://docs.fast.ai/basic_data.html#DatasetType", "anchor_text": "DataSet", "paragraph_index": 24}, {"url": "http://cs229.stanford.edu/proj2016/poster/ThungYang-ClassificationOfTrashForRecyclabilityStatus-poster.pdf", "anchor_text": "a test accuracy of 63%", "paragraph_index": 34}, {"url": "https://github.com/collindching/Waste-Sorter", "anchor_text": "Here\u2019s", "paragraph_index": 37}, {"url": "https://blog.usejournal.com/if-i-can-you-can-and-you-should-a470d7aea89d", "anchor_text": "blog post", "paragraph_index": 38}, {"url": "https://fivethirtyeight.com/features/the-era-of-easy-recycling-may-be-coming-to-an-end/", "anchor_text": "post", "paragraph_index": 38}], "all_paragraphs": ["Recycling contamination occurs when waste is incorrectly disposed of \u2014 like recycling a pizza box with oil on it (compost). Or when waste is correctly disposed of but incorrectly prepared \u2014 like recycling unrinsed jam jars.", "Contamination is a huge problem in the recycling industry that can be mitigated with automated waste sorting. Just for kicks, I thought I\u2019d try my hand at prototyping an image classifier to classify trash and recyclables \u2014 this classifier could have applications in an optical sorting system.", "I\u2019ll train a convolutional neural network to classify an image as either cardboard, glass, metal, paper, plastic, or trash with the fastai library (built on PyTorch). I used an image dataset collected manually by Gary Thung and Mindy Yang. If you\u2019re following along, download their dataset here, then move it to the same directory as the notebook. (Note: you\u2019ll want to use a GPU to speed up training.)", "First, we need to extract the contents of \u201cdataset-resized.zip\u201d.", "Once unzipped, the dataset-resized folder has six subfolders:", "Now that we\u2019ve extracted the data, I\u2019m going to split images up into train, validation, and test image folders with a 50\u201325\u201325 split. I defined some functions that helped me to quickly build it which you can check out in the notebook.", "Next, I\u2019m going to create a bunch of destination folders according to the ImageNet directory convention. This means it will have an outer folder (I called it data) with three subfolders: train, validation, and test. Within each of those folders, there is a folder named cardboard, glass, metal, paper, plastic, and trash. I\u2019ll skip over that code as well because it\u2019s mundane; just know that this is the organization of my image dataset.", "ImageDataBunch.from_folder() specifies that we\u2019ll be extracting our training, validation, and testing data from folders in an ImageNet structure.", "The batch size bs is how many images you\u2019ll train at a time. Choose a smaller batch size if your computer has less memory.", "You can use get_transforms() function to augment your data.", "Here\u2019s an example of what the data looks like:", "A residual neural network is a convolutional neural network (CNN) with lots of layers. In particular, resnet34 is a CNN with 34 layers that\u2019s been pretrained on the ImageNet database. A pretrained CNN will perform better on new image classification tasks because it has already learned some visual features and can transfer that knowledge over (hence transfer learning).", "Since they\u2019re capable of describing more complexity, deep neural networks should theoretically perform better than shallow networks on training data. In reality, though, deep neural networks tend to perform empirically worse than shallow ones.", "Resnets were created to circumvent this glitch using a hack called shortcut connections. If some nodes in a layer have suboptimal values, you can adjust weights and bias; if a node is optimal (its residual is 0), why not leave it alone? Adjustments are only made to nodes on an as-needed basis (when there\u2019s non-zero residuals).", "When adjustments are needed, shortcut connections apply the identity function to pass information to subsequent layers. This shortens the neural network when possible and allows resnets to have deep architectures and behave more like shallow neural networks. The 34 in resnet34 just refers to the number of layers.", "Anand Saha gives a great more in-depth explanation here.", "I\u2019m going to find a learning rate for gradient descent to make sure that my neural network converges reasonably quickly without missing the optimal error. For a refresher on the learning rate, check out Jeremy Jordan\u2019s post on choosing a learning rate.", "The learning rate finder suggests a learning rate of 5.13e-03. With this, we can train the model.", "I ran my model for 20 epochs. What\u2019s cool about this fitting method is that the learning rate decreases with each epoch, allowing us to get closer and closer to the optimum. At 8.6%, the validation error looks super good\u2026 let\u2019s see how it performs on the test data though.", "First, we can take a look at which images were most incorrectly classified.", "The images here that the recycler performed poorly on were actually degraded. It looks the photos received too much exposure or something so this actually isn\u2019t a fault with the model!", "This model often confused plastic for glass and confused metal for glass. The list of most confused images is below.", "To see how this mode really performs, we need to make predictions on test data. First, I\u2019ll make predictions on the test data using the learner.get_preds() method.", "Note: learner.predict() only predicts on a single image, while learner.get_preds() predicts on a set of images. I highly recommend reading the documentation to learn more about predict() and get_preds().", "The ds_type argument in get_preds(ds_type) takes a DataSet argument. Example values are DataSet.Train, DataSet.Valid, and DataSet.Test. I mention this because I made the mistake of passing in actual data (learn.data.test_ds) which gave me the wrong output and took embarrassingly long to debug.", "Don\u2019t make this mistake! Don\u2019t pass in data \u2014 pass in the dataset type!", "These are the predicted probabilities for each image. This tensor has 365 rows \u2014 one for each image \u2014 and 6 columns \u2014 one for each material category.", "Now I\u2019m going to convert the probabilities in the tensor above to a vector of predicted class names.", "These are the predicted labels of all the images! Let\u2019s check if the first image is actually glass.", "Next, I\u2019ll get the actual labels from the test dataset.", "It looks the first five predictions match up!", "How does this model perform overall? We can use a confusion matrix to find out.", "I\u2019m going to make this matrix a little bit prettier:", "Again, the model seems to have confused metal for glass and plastic for glass. With more time, I\u2019m sure further investigation could help reduce these mistakes.", "I ended up achieving an accuracy of 92.1% on the test data which is pretty great \u2014 the original creators of the TrashNet dataset achieved a test accuracy of 63% with a support vector machine on a 70\u201330 test-train split (they trained a neural network as well for a test accuracy of 27%).", "If I had more time, I\u2019d go back and reduce classification error for glass in particular. I\u2019d also delete photos from the dataset that are overexposed since those images are just bad data.", "This was just a quick and dirty mini-project to show that it\u2019s pretty quick to train an image classification model, but it pretty amazing how quickly you can create a state-of-the-art model by using the fastai library. If you have an application you\u2019re interested in but don\u2019t think you have the machine learning chops, this should be encouraging for you.", "Here\u2019s the Github repo for this project.", "Thanks to James Dellinger for this blog post about classifying bluejays. For more information about recycling, check out this FiveThirtyEight post.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist || Read, think, apply"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6d11d3c9c478&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@collindching?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@collindching?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": "Collin Ching"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd0c8fae38c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&user=Collin+Ching&userId=cd0c8fae38c&source=post_page-cd0c8fae38c----6d11d3c9c478---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d11d3c9c478&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d11d3c9c478&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://mediaroom.wm.com/the-battle-against-recycling-contamination-is-everyones-battle/", "anchor_text": "huge problem"}, {"url": "https://github.com/garythung/trashnet/blob/master/data/dataset-resized.zip", "anchor_text": "here"}, {"url": "https://github.com/collindching/Waste-Sorter", "anchor_text": "the notebook."}, {"url": "https://nbviewer.jupyter.org/github/collindching/Waste-Sorter/blob/master/Waste%20sorter.ipynb", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/convolutional-neural-networks-for-beginners-practical-guide-with-python-and-keras-dc688ea90dca", "anchor_text": "convolutional neural network (CNN)"}, {"url": "http://www.image-net.org/", "anchor_text": "ImageNet database"}, {"url": "http://teleported.in/posts/decoding-resnet-architecture/", "anchor_text": "here"}, {"url": "https://www.jeremyjordan.me/nn-learning-rate/", "anchor_text": "post"}, {"url": "https://docs.fast.ai/basic_train.html#Learner.get_preds", "anchor_text": "documentation"}, {"url": "https://docs.fast.ai/basic_data.html#DatasetType", "anchor_text": "DataSet"}, {"url": "http://cs229.stanford.edu/proj2016/poster/ThungYang-ClassificationOfTrashForRecyclabilityStatus-poster.pdf", "anchor_text": "a test accuracy of 63%"}, {"url": "https://github.com/collindching/Waste-Sorter", "anchor_text": "Here\u2019s"}, {"url": "https://blog.usejournal.com/if-i-can-you-can-and-you-should-a470d7aea89d", "anchor_text": "blog post"}, {"url": "https://fivethirtyeight.com/features/the-era-of-easy-recycling-may-be-coming-to-an-end/", "anchor_text": "post"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6d11d3c9c478---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----6d11d3c9c478---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/recycling?source=post_page-----6d11d3c9c478---------------recycling-----------------", "anchor_text": "Recycling"}, {"url": "https://medium.com/tag/python?source=post_page-----6d11d3c9c478---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6d11d3c9c478---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d11d3c9c478&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&user=Collin+Ching&userId=cd0c8fae38c&source=-----6d11d3c9c478---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d11d3c9c478&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&user=Collin+Ching&userId=cd0c8fae38c&source=-----6d11d3c9c478---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d11d3c9c478&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6d11d3c9c478&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6d11d3c9c478---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6d11d3c9c478--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@collindching?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@collindching?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Collin Ching"}, {"url": "https://medium.com/@collindching/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "243 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd0c8fae38c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&user=Collin+Ching&userId=cd0c8fae38c&source=post_page-cd0c8fae38c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F78c14637d659&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-classifier-for-waste-sorting-6d11d3c9c478&newsletterV3=cd0c8fae38c&newsletterV3Id=78c14637d659&user=Collin+Ching&userId=cd0c8fae38c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}