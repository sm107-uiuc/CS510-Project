{"url": "https://towardsdatascience.com/facial-re-identification-using-siamese-nets-d36df39da7c0", "time": 1683003631.199334, "path": "towardsdatascience.com/facial-re-identification-using-siamese-nets-d36df39da7c0/", "webpage": {"metadata": {"title": "Facial Re-ID with Siamese Networks | Towards Data Science", "h1": "Facial Re-Identification Using Siamese Nets", "description": "Facial re-identification (FRID) is the problem of verifying the ID of a person based on their face. For example, a governmental agency could eradicate the use of ID cards and simply use a FRID system\u2026"}, "outgoing_paragraph_urls": [{"url": "http://vis-www.cs.umass.edu/lfw/", "anchor_text": "http://vis-www.cs.umass.edu/lfw/", "paragraph_index": 22}, {"url": "https://megapixels.cc/duke_mtmc/", "anchor_text": "https://megapixels.cc/duke_mtmc/", "paragraph_index": 23}], "all_paragraphs": ["Facial re-identification (FRID) is the problem of verifying the ID of a person based on their face. For example, a governmental agency could eradicate the use of ID cards and simply use a FRID system to handle attendance, without worrying about a stranger stealing someone\u2019s ID to enter the system.", "The crux of this problem is a classification problem, where the model has to classify an image of a face as a person in the database. Because of this, it may be tempting to use the many state of the art image classifiers with nearly 100 percent test accuracy. Case closed right? Just fine tune the ResNet50 or even the ResNet101 model to classify the name of the person from the image of a face. Well, there are some fundamental questions that arise when doing this:", "All of these questions can be answered by a new style of model: Siamese Networks.", "Lets first begin by introducing Siamese Networks. A majority of Deep Learning advances have occurred when people apply human intuition into the Deep Learning model, such as when the Residual Block was first used in the ResNet, or when style based losses became more popular as people tried harder to try and incorporate human abstraction into computers. Siamese Networks are another one of these advances that are heavily dependant on human intuition about how a computer should solve the problem.", "The core intuition behind Siamese Networks is to try and learn a representation of the face. This representation is similar to the information humans store in their minds about the characteristics of the face, such as the size of the facial features, color of skin, eye color, etc. A human can understand that if it sees another face with similar features, then there is a high chance that the new face belongs to the same person. On the other hand, if the human sees that the new face does not match that of the faces it has previously seen, then the human again makes a representation of the new face to store in its memory.", "This is exactly how Siamese Networks function. A function transforms the input image of the face into a vector which contains a representation of the face\u2019s features. We then want this vector to be similar to that of the same face, and very different from the vector of a different face.", "In a nutshell, the model learns how to extract the important features of a face which allows it to be distinguished from other faces. Once the feature mapping is obtained, it can be compared to the feature mappings of other faces in a database to be matched.", "The most important part of any neural network is how it is training. Training is the way a large, seemingly useless function is tuned to complete its task. Siamese Networks were originally trained in pairs, similar to the use case of the model. The distance between two vectors of the same face was maximized, and the distance between two vectors of different faces was minimized.", "This approach however, complicated the training process and was also inefficient in terms of computational requirements. Training this Contrastive Loss, as it is called, meant that for each training sample, the model would have to compute four vectors and then perform two sets of model optimization for each pair of images. Another issue that arose was that training samples would be highly disbalanced since there would be a much smaller amount of pairs available in which the faces were the same, and a larger amount of pairs in which the faces were different.", "To decrease the computational requirements of Contrastive Loss, and also to partially solve the data issue, Triplet Loss was created. Triplet loss works in four steps:", "The following equation shows the mathematical representation of Triplet Loss, along with some important subtleties.", "The first difference between the loss described above and the equation is the addition of the Max() function between the difference and 0.0. This is to make sure that the loss function doesn\u2019t drop beneath zero.", "The second, more important difference is the addition of a margin, denoted by m. This margin makes sure that the model doesn\u2019t learn to output the same vector for all faces, regardless of whether the faces match. Notice that if the distance between the anchor and positive is equal to the distance between the anchor and negative, the loss will be minimized to zero if there wasn\u2019t a margin term.", "For the implementation in this blog post we will use tensorflow==2.1 and a gpu if available, since the training of such a network is a heavy computation. I will be training my model on a Nvidia GTX 1080 TI, so I will be using tensorflow-gpu==2.1 and CUDA==10.2.", "Since the development of powerful feature extractor networks, there is often little need to design a custom convolutional neural network from scratch, for almost every situation. We will use the industry standard of the ResNet50 model to extract our features. Because of this, the only addition needed is to devise a custom loss function in the tf.Keras API to train our model with.", "There are two different methods to incorporate a custom loss functions in tf.Keras: creating a function that computes the loss to be passed to the model.compile() method, or to create a loss layer and use the Layer.add_loss() method.", "The only difference between the two methods of creating custom loss functions is that in the first one, the loss function must be in the format of loss_fn(y_true, y_pred), while the second method can have any format.", "Since Triplet Loss cannot be formulated in a y_true, y_pred format, the second method will be used.", "In the above code, triplet_loss is the loss function which takes in the anchor, positive, and negative images. The annotation of @tf.function simply causes the function to be graphed using tf.Autograph and allows for faster computations.", "The TripletLoss layer inherits from the tf.keras.layers.Layer, and the triplet loss function is added to the layer\u2019s losses using the add_loss method. The layer then returns the inputs without changing them.", "Using the add_loss method not only adds the loss tensor to the losses of the layer, but when training a model using model.fit(), all of the layer losses are also automatically optimized as well, which allows us to compile the model without any overall loss function in the following code:", "The code above shows the complete code for the model and how it was trained.", "Training the model on the LFW (Labeled Faces in the Wild) database at http://vis-www.cs.umass.edu/lfw/, the model was able to correctly \u201cpredict\u201d matching faces with 90 percent accuracy, and was able to tell if two faces were different with 95 percent accuracy.", "There have been multiple papers that have been released in the past few years making significant improvements over the vanilla Triplet Loss, and on much harder datasets such as Duke MTMC at https://megapixels.cc/duke_mtmc/.", "In the next few posts I will be breaking down recent advancements in Re-Identification.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd36df39da7c0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tekotan?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tekotan?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": "Tanish Baranwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6fc73fd2b560&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&user=Tanish+Baranwal&userId=6fc73fd2b560&source=post_page-6fc73fd2b560----d36df39da7c0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd36df39da7c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd36df39da7c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://papers.nips.cc/paper/769-signature-verification-using-a-siamese-time-delay-neural-network.pdf", "anchor_text": "Signature Verification using a \u201cSiamese\u201d Time Delay Neural Network"}, {"url": "http://vis-www.cs.umass.edu/lfw/", "anchor_text": "http://vis-www.cs.umass.edu/lfw/"}, {"url": "https://megapixels.cc/duke_mtmc/", "anchor_text": "https://megapixels.cc/duke_mtmc/"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----d36df39da7c0---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/facial-recognition?source=post_page-----d36df39da7c0---------------facial_recognition-----------------", "anchor_text": "Facial Recognition"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d36df39da7c0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/siamese-networks?source=post_page-----d36df39da7c0---------------siamese_networks-----------------", "anchor_text": "Siamese Networks"}, {"url": "https://medium.com/tag/keras?source=post_page-----d36df39da7c0---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd36df39da7c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&user=Tanish+Baranwal&userId=6fc73fd2b560&source=-----d36df39da7c0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd36df39da7c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&user=Tanish+Baranwal&userId=6fc73fd2b560&source=-----d36df39da7c0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd36df39da7c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd36df39da7c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d36df39da7c0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d36df39da7c0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d36df39da7c0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d36df39da7c0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d36df39da7c0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tekotan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tekotan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tanish Baranwal"}, {"url": "https://medium.com/@tekotan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "30 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6fc73fd2b560&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&user=Tanish+Baranwal&userId=6fc73fd2b560&source=post_page-6fc73fd2b560--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9a093f18f5b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-re-identification-using-siamese-nets-d36df39da7c0&newsletterV3=6fc73fd2b560&newsletterV3Id=9a093f18f5b8&user=Tanish+Baranwal&userId=6fc73fd2b560&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}