{"url": "https://towardsdatascience.com/mastering-classification-with-scikit-learn-2cc0cffe33e3", "time": 1683017849.531021, "path": "towardsdatascience.com/mastering-classification-with-scikit-learn-2cc0cffe33e3/", "webpage": {"metadata": {"title": "Mastering Classification with Scikit-learn | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Mastering Classification with Scikit-learn", "description": "Scikit-learn is a powerful machine learning library in python. It provides many tools for classification, regression and clustering tasks. In this post we will discuss some popular tools for building\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/sanjanavoona1043/bank-churn", "anchor_text": "here.", "paragraph_index": 1}, {"url": "https://stackoverflow.com/users/5025009/seralouk", "anchor_text": "seralouk", "paragraph_index": 7}, {"url": "https://stackoverflow.com/questions/61792153/confusion-matrix-values-in-the-wrong-box", "anchor_text": "StackOverflow", "paragraph_index": 7}, {"url": "https://tonester524.medium.com/", "anchor_text": "Tony Yiu\u2019s", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "Understanding Random Forests", "paragraph_index": 15}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html", "anchor_text": "documentation", "paragraph_index": 16}, {"url": "https://scikit-learn.org/stable/modules/svm.html", "anchor_text": "documentation", "paragraph_index": 22}, {"url": "https://www.amazon.com/dp/B08N38XW2Q/ref=sr_1_1?dchild=1&keywords=sadrach+python&qid=1604966500&s=books&sr=1-1", "anchor_text": "Python for Data Science and Machine Learning: Python Programming, Pandas and Scikit-learn Tutorials for Beginners", "paragraph_index": 26}, {"url": "https://github.com/spierre91/medium_code/blob/master/machine_learning/getting_started_with_sklearn.py", "anchor_text": "GitHub", "paragraph_index": 26}], "all_paragraphs": ["Scikit-learn is a powerful machine learning library in python. It provides many tools for classification, regression and clustering tasks. In this post we will discuss some popular tools for building classification models using scikit-learn.", "For our purposes we will be working with the Bank Churn Modeling data set. The data can be found here.", "To start, let\u2019s import the Pandas library, relax display limits and print the first five rows of data:", "Let\u2019s consider the task of building a classification model for predicting whether a customer will churn (stop using a service or product). For simplicity, let\u2019s use \u2018CreditScore\u2019, \u2018Age\u2019, \u2018Tenure\u2019 and \u2018NumOfProducts\u2019 to predict churn (\u2018Exited\u2019):", "Let\u2019s also split our data from training and testing:", "Let\u2019s begin by building a simple logistic regression model. Let\u2019s import the logistic regression module from scikit-learn:", "Next we will define a model object, fit our model and make predictions on our test data:", "And we can evaluate our model using a confusion matrix. We can do so with a snippet of code borrowed from seralouk on StackOverflow:", "We see that our model is really good at predicting negative cases (people who don\u2019t churn) but performs poorly when it comes to predicting actually churners. Let\u2019s inspect the number of churners and non-churners using the Counter() method from the collections module:", "We see this data has significant imbalance in labels. One way to remedy this is to balance the training data. Instead of using \u2018train_test_split\u2019 we can sample using the Pandas sample method on our original dataframe to generate training and test sets:", "We can now balance the training data while leaving the distribution in labels in the test set untouched:", "Now if we train our model and predict on the test set we get:", "This looks much better. Before we will look at how to train additional classification models like random forests and support vector machine (SVM) let\u2019s define a function that allows us to choose between training a logistic regression, random forest and a SVM model:", "Now let\u2019s call our function with \u2018logistic_regression\u2019:", "And when we run our script we should reproduce the same confusion matrix.", "Now let\u2019s call our function with \u2018random_forests\u2019. If you are unfamiliar with Random Forests I recommend Tony Yiu\u2019s article Understanding Random Forests:", "This can be further improved with hyper parameter tuning. We can use the following function to search for the best hyper parameters. We will use the RandomizedSearchCV module from sklearn.model_selection to search for hyper parameters. (If you want to learn more about random forest parameters I recommend reading the documentation). Within our function let\u2019s define a grid of search values:", "Now let\u2019s import RandomizedSearchCV, initialize a model object, pass the model into a RandomizedSearchCV object, fit our model and find the best parameters. We will randomly select 5 iterations and choose the best parameters using 3 fold cross validation (n_iter = 5, cv = 3):", "Let\u2019s call our function and store the return value in a new variable:", "We should see a series of CV tests being run:", "We\u2019ll also update our \u2018train_model\u2019 function so that it takes the random forest parameters as input:", "Now let\u2019s call \u2018train_model\u2019 with the random forest parameters and run our script:", "We see that performance improves upon optimizing the random forest hyper parameters. Now let\u2019s do the same for support vector machines (documentation). First let\u2019s define our SVM grid search function and find the best SVM classifier:", "Next, let\u2019s modify our \u2018train_model\u2019 function so that it takes SVM parameters:", "Now we can call \u2018train_model\u2019 with the SVM parameters and run our script:", "I\u2019ll stop here but I encourage you to play around with the data and code yourself.", "To summarize, in this post we discussed how to build classification models using the python machine learning library scikit-learn. First we showed how to build a logistic regression model. We also showed how to improve performance by balancing the training data. Next we discussed how to train a random forest model and perform a hyper parameter search to optimize performance. Finally, we repeated this process for a support vector machine classifier. If you are interested learning about the basics of python programming, data manipulation with Pandas, and machine learning in python check out Python for Data Science and Machine Learning: Python Programming, Pandas and Scikit-learn Tutorials for Beginners. I hope you found this post useful/interesting. The code from this post is available on GitHub. Thank you for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2cc0cffe33e3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----2cc0cffe33e3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2cc0cffe33e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2cc0cffe33e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@steve", "anchor_text": "Steve Johnson"}, {"url": "https://www.pexels.com/photo/person-s-index-finger-977246/", "anchor_text": "Pexels"}, {"url": "https://www.kaggle.com/sanjanavoona1043/bank-churn", "anchor_text": "here."}, {"url": "https://stackoverflow.com/users/5025009/seralouk", "anchor_text": "seralouk"}, {"url": "https://stackoverflow.com/questions/61792153/confusion-matrix-values-in-the-wrong-box", "anchor_text": "StackOverflow"}, {"url": "https://tonester524.medium.com/", "anchor_text": "Tony Yiu\u2019s"}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "Understanding Random Forests"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html", "anchor_text": "documentation"}, {"url": "https://scikit-learn.org/stable/modules/svm.html", "anchor_text": "documentation"}, {"url": "https://www.amazon.com/dp/B08N38XW2Q/ref=sr_1_1?dchild=1&keywords=sadrach+python&qid=1604966500&s=books&sr=1-1", "anchor_text": "Python for Data Science and Machine Learning: Python Programming, Pandas and Scikit-learn Tutorials for Beginners"}, {"url": "https://github.com/spierre91/medium_code/blob/master/machine_learning/getting_started_with_sklearn.py", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/python?source=post_page-----2cc0cffe33e3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2cc0cffe33e3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2cc0cffe33e3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----2cc0cffe33e3---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/software-development?source=post_page-----2cc0cffe33e3---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2cc0cffe33e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----2cc0cffe33e3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2cc0cffe33e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----2cc0cffe33e3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2cc0cffe33e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2cc0cffe33e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2cc0cffe33e3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2cc0cffe33e3--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-classification-with-scikit-learn-2cc0cffe33e3&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}