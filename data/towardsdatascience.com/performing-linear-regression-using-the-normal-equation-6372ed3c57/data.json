{"url": "https://towardsdatascience.com/performing-linear-regression-using-the-normal-equation-6372ed3c57", "time": 1683005765.155303, "path": "towardsdatascience.com/performing-linear-regression-using-the-normal-equation-6372ed3c57/", "webpage": {"metadata": {"title": "Performing Linear Regression Using the Normal Equation | by Robert Kwiatkowski | Towards Data Science", "h1": "Performing Linear Regression Using the Normal Equation", "description": "Linear regression is one of the most important and popular predictive techniques in data analysis. It\u2019s also one of the oldest - famous C.F. Gauss at the beginning of 19th-century was using it in the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pdf.sciencedirectassets.com/272588/1-s2.0-S0315086000X00924/1-s2.0-0315086078900484/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBEaCXVzLWVhc3QtMSJHMEUCIAsOEP%2F1sSIWIeF%2F6CwrfGh%2BlB5KwpnYoIo9PeIIWFHTAiEAlul3yGHjCujxjd7KA8wGh7mvSllMMogRYPIw4zjCakgqtAMIKhADGgwwNTkwMDM1NDY4NjUiDKjaLpg523wIk%2FG3qiqRAz48MCatTvdzM05b%2FZQLRQhWFMac%2FWcsgJsl%2BLpJ1PXgYwcSnNghM%2BEY1FX0Ci04KPYKui%2FpRrR3aMZElSNiG4B%2BtGnVYHFj9cyegKNGF%2Fz5vfExEMAF%2FOCzuzX5YycxfT21M2hJ8w%2FMXLTKC5h6x6B8AJMR4hoWgY%2BX%2F4Kw6wi7p6I6VKwct5HpVJNFiLf62iv1DnhHr%2BzTqFdsxroXUwPDdqhXf%2FzJdoLjEZT%2Fm54lPfwSGYcV2t562vona1X4ON%2BSYil3f0Jryi9S8acSMi5OWC3rOc1RzLAgyQV1ZZu19qIul1TcQE98Dfs2mMkl5ZnjGat74LPqhUfJGDCdda3NfJGsDqDInxypwTNp3tZSsB06yDLmco%2Fe6La72XfCR2Hw23jsWwJ14Fm7TXcuGgbIUwJnh3v0VDhYryKqnExzkUAiKU90%2F3osj%2BNbiv22yesc0EpdF8eWuC03A%2F0gcTp0ZnVgUcgdm9MCQNWqxG%2B1PrIpk%2Bmpcoe3JlvUzbPq9SKqcBfX85MB7uLuv0cTY1joMJD9xfQFOusB2QUvNz1jPBa1sJpy1svCMOcuiIecmmwKPhK63GZk5Hrql8yqljM8GwjDnQbHdHKE7myXHQ1ed8p1SFY3z33fmeBNFP8FJYWazx5uvROT%2Bvr%2F%2FxYihKrD0Uq94OKKj8Md15nBfPNPPAR1%2FKVc%2FA1KOMMZFE6O5n%2FUusrgdjI49FK1VXSC0%2BEZVP4T%2Br5J6XBy2%2FI3zFAG8naDcfGlRnLEPrs9xArh9%2BM0IrDBzL9TmiAZZjyClro9HqvSXbNoiIUZNG2PyMb7EPUcyYWfGPK53JXghaEHxq1M0VTvwdcyk%2Bu2nXFuaFjF6xEtzQ%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20200411T084216Z&X-Amz-SignedHeaders=host&X-Amz-Expires=300&X-Amz-Credential=ASIAQ3PHCVTYZFJNGYP2%2F20200411%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=abea966bf094475819460d2447b2359e4857bfd3854da4847858ed20d8cc1a3b&hash=0c749a880b6447cc77c79d67424054946c5378226b9a1fcd8b297247f20ccc1a&host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&pii=0315086078900484&tid=spdf-2b79ef26-8802-40be-b77c-68e62710c1bd&sid=302a062b1697c04efe7a2a55044c31815227gxrqb&type=client", "anchor_text": "more", "paragraph_index": 0}, {"url": "https://www.youtube.com/watch?v=fNk_zzaMoSs&list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab", "anchor_text": "YouTube series", "paragraph_index": 6}, {"url": "https://numpy.org/", "anchor_text": "Numpy", "paragraph_index": 21}, {"url": "https://numpy.org/doc/stable/reference/routines.linalg.html?highlight=linalg#module-numpy.linalg", "anchor_text": "numpy.linalg", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Computational_complexity", "anchor_text": "numerical complexity", "paragraph_index": 25}, {"url": "https://en.wikipedia.org/wiki/Big_O_notation", "anchor_text": "big O notation", "paragraph_index": 25}, {"url": "http://www.linkedin.com/in/robertkwiatkowski01", "anchor_text": "www.linkedin.com/in/robertkwiatkowski01", "paragraph_index": 28}], "all_paragraphs": ["Linear regression is one of the most important and popular predictive techniques in data analysis. It\u2019s also one of the oldest - famous C.F. Gauss at the beginning of 19th-century was using it in the astronomy for calculation of orbits (more).", "Its objective is to fit the best line (or a hyper-/plane) to the set of given points (observations) by calculating regression function parameters that minimize specific cost function (error), e.g. mean squared error (MSE).", "As a reminder, below there is a linear regression equation in the expanded form.", "In a vectorized form it looks like that:", "where \u03b8 is a vector of parameters weights.", "Usually finding the best model parameters is performed by running some kind of optimization algorithm (e.g. gradient descent) to minimize a cost function. However, it is possible to obtain values (weights) of these parameters by solving an algebraic equation called the normal equation as well. It is defined as below.", "In this article, we will perform linear regression for a very basic case so we can avoid lengthy hand calculations. By the way, if you think you need to refresh your linear algebra skills, there are many good resources on the Internet (e.g. YouTube series I recommend).", "In this example, there are only three points (observations) with only one variable (X\u2081). On the graph, they look like below.", "In this case, the linear regression equation has a form of:", "Features (X) and labels (y) are:", "Note that we add a default bias term of 1 \u2014 it will be updated during our calculations. Not adding this term will lead to a wrong solution.", "Step 1: Transposition of matrix X", "This is a relatively simple task \u2014 rows become new columns.", "Step 2: Multiplication on the transposed matrix and matrix X", "Step 3: Inversion of a resultant matrix", "To inverse a simple 2x2 matrix we can use the formula:", "Note: for bigger matrices (bigger than 3X3) inverting them becomes a much more cumbersome task and usually, the algorithmic approach is used \u2014 like Gaussian elimination. This is important to remember!", "Step 4: Multiplication of the inverted matrix with X transposed", "Step 5: Final multiplication to obtain the vector of best parameters", "Finally our linear regression equations takes form of:", "Plotting this line onto a previous graph looks like below.", "The same calculations can be implemented in Python using Numpy library which contains a set of linear algebra functions in numpy.linalg collection.", "Now we can define new features we would like to predict values for.", "By implementing equation 2 we obtain the predicted values.", "As you see it\u2018s pretty easy to use the normal equation and to implement it in Python \u2014 it\u2019s only one line of code. So why it\u2019s not commonly used?", "The problem is in its numerical complexity. Solving this equation requires inverting a matrix and this is a computationally expensive operation \u2014 depending on the implementation, in a big O notation it is O(n\u00b3) or slightly less. This means is scales up horribly, practically meaning that when you double number of features, the computational times increases by 2\u00b3 = 8 times. There is also some chance that the result of step 2 is not invertible at all \u2014 causing big troubles. These are the reasons why in practice this approach is uncommon.", "On the bright side, this approach is calculated just in one step and you don\u2019t have to choose the learning rate parameter. Additionally, it terms of memory usage this approach is linear O(m) meaning it stores huge datasets effectively if they only fit into your computer\u2019s memory.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer with a background in the Aerospace Industry www.linkedin.com/in/robertkwiatkowski01"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6372ed3c57&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6372ed3c57--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6372ed3c57--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://robertkwiatkowski01.medium.com/?source=post_page-----6372ed3c57--------------------------------", "anchor_text": ""}, {"url": "https://robertkwiatkowski01.medium.com/?source=post_page-----6372ed3c57--------------------------------", "anchor_text": "Robert Kwiatkowski"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9f55d2ee5cad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&user=Robert+Kwiatkowski&userId=9f55d2ee5cad&source=post_page-9f55d2ee5cad----6372ed3c57---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6372ed3c57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6372ed3c57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@antoine1003?utm_source=medium&utm_medium=referral", "anchor_text": "Antoine Dautry"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://pdf.sciencedirectassets.com/272588/1-s2.0-S0315086000X00924/1-s2.0-0315086078900484/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBEaCXVzLWVhc3QtMSJHMEUCIAsOEP%2F1sSIWIeF%2F6CwrfGh%2BlB5KwpnYoIo9PeIIWFHTAiEAlul3yGHjCujxjd7KA8wGh7mvSllMMogRYPIw4zjCakgqtAMIKhADGgwwNTkwMDM1NDY4NjUiDKjaLpg523wIk%2FG3qiqRAz48MCatTvdzM05b%2FZQLRQhWFMac%2FWcsgJsl%2BLpJ1PXgYwcSnNghM%2BEY1FX0Ci04KPYKui%2FpRrR3aMZElSNiG4B%2BtGnVYHFj9cyegKNGF%2Fz5vfExEMAF%2FOCzuzX5YycxfT21M2hJ8w%2FMXLTKC5h6x6B8AJMR4hoWgY%2BX%2F4Kw6wi7p6I6VKwct5HpVJNFiLf62iv1DnhHr%2BzTqFdsxroXUwPDdqhXf%2FzJdoLjEZT%2Fm54lPfwSGYcV2t562vona1X4ON%2BSYil3f0Jryi9S8acSMi5OWC3rOc1RzLAgyQV1ZZu19qIul1TcQE98Dfs2mMkl5ZnjGat74LPqhUfJGDCdda3NfJGsDqDInxypwTNp3tZSsB06yDLmco%2Fe6La72XfCR2Hw23jsWwJ14Fm7TXcuGgbIUwJnh3v0VDhYryKqnExzkUAiKU90%2F3osj%2BNbiv22yesc0EpdF8eWuC03A%2F0gcTp0ZnVgUcgdm9MCQNWqxG%2B1PrIpk%2Bmpcoe3JlvUzbPq9SKqcBfX85MB7uLuv0cTY1joMJD9xfQFOusB2QUvNz1jPBa1sJpy1svCMOcuiIecmmwKPhK63GZk5Hrql8yqljM8GwjDnQbHdHKE7myXHQ1ed8p1SFY3z33fmeBNFP8FJYWazx5uvROT%2Bvr%2F%2FxYihKrD0Uq94OKKj8Md15nBfPNPPAR1%2FKVc%2FA1KOMMZFE6O5n%2FUusrgdjI49FK1VXSC0%2BEZVP4T%2Br5J6XBy2%2FI3zFAG8naDcfGlRnLEPrs9xArh9%2BM0IrDBzL9TmiAZZjyClro9HqvSXbNoiIUZNG2PyMb7EPUcyYWfGPK53JXghaEHxq1M0VTvwdcyk%2Bu2nXFuaFjF6xEtzQ%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20200411T084216Z&X-Amz-SignedHeaders=host&X-Amz-Expires=300&X-Amz-Credential=ASIAQ3PHCVTYZFJNGYP2%2F20200411%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=abea966bf094475819460d2447b2359e4857bfd3854da4847858ed20d8cc1a3b&hash=0c749a880b6447cc77c79d67424054946c5378226b9a1fcd8b297247f20ccc1a&host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&pii=0315086078900484&tid=spdf-2b79ef26-8802-40be-b77c-68e62710c1bd&sid=302a062b1697c04efe7a2a55044c31815227gxrqb&type=client", "anchor_text": "more"}, {"url": "https://www.youtube.com/watch?v=fNk_zzaMoSs&list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab", "anchor_text": "YouTube series"}, {"url": "https://numpy.org/", "anchor_text": "Numpy"}, {"url": "https://numpy.org/doc/stable/reference/routines.linalg.html?highlight=linalg#module-numpy.linalg", "anchor_text": "numpy.linalg"}, {"url": "https://en.wikipedia.org/wiki/Computational_complexity", "anchor_text": "numerical complexity"}, {"url": "https://en.wikipedia.org/wiki/Big_O_notation", "anchor_text": "big O notation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6372ed3c57---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----6372ed3c57---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/linear-algebra?source=post_page-----6372ed3c57---------------linear_algebra-----------------", "anchor_text": "Linear Algebra"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----6372ed3c57---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6372ed3c57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&user=Robert+Kwiatkowski&userId=9f55d2ee5cad&source=-----6372ed3c57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6372ed3c57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&user=Robert+Kwiatkowski&userId=9f55d2ee5cad&source=-----6372ed3c57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6372ed3c57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6372ed3c57--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6372ed3c57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6372ed3c57---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6372ed3c57--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6372ed3c57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6372ed3c57--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6372ed3c57--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6372ed3c57--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6372ed3c57--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6372ed3c57--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6372ed3c57--------------------------------", "anchor_text": ""}, {"url": "https://robertkwiatkowski01.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://robertkwiatkowski01.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Robert Kwiatkowski"}, {"url": "https://robertkwiatkowski01.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "354 Followers"}, {"url": "http://www.linkedin.com/in/robertkwiatkowski01", "anchor_text": "www.linkedin.com/in/robertkwiatkowski01"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9f55d2ee5cad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&user=Robert+Kwiatkowski&userId=9f55d2ee5cad&source=post_page-9f55d2ee5cad--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb0073e6c029d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-linear-regression-using-the-normal-equation-6372ed3c57&newsletterV3=9f55d2ee5cad&newsletterV3Id=b0073e6c029d&user=Robert+Kwiatkowski&userId=9f55d2ee5cad&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}