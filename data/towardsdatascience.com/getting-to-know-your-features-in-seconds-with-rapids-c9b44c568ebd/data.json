{"url": "https://towardsdatascience.com/getting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd", "time": 1683016418.555594, "path": "towardsdatascience.com/getting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd/", "webpage": {"metadata": {"title": "Getting To Know Your Features In Seconds With RAPIDS | by Louise Ferbach | Towards Data Science", "h1": "Getting To Know Your Features In Seconds With RAPIDS", "description": "This blog post intends to present the feature selection notebook I recently published in the ongoing Mechanisms of Action Kaggle competition. Exploratory data analysis, and especially getting an idea\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/louise2001/rapids-feature-importance-is-all-you-need", "anchor_text": "feature selection notebook", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/lish-moa", "anchor_text": "Mechanisms of Action", "paragraph_index": 0}, {"url": "https://developer.nvidia.com/rapids", "anchor_text": "RAPIDS", "paragraph_index": 4}, {"url": "https://www.kaggle.com/louise2001/moa-feat-importance-rapids", "anchor_text": "here", "paragraph_index": 9}], "all_paragraphs": ["This blog post intends to present the feature selection notebook I recently published in the ongoing Mechanisms of Action Kaggle competition.", "Exploratory data analysis, and especially getting an idea of features importance, is a crucial step when confronted with a data science problem. However, this step can often be trying if your database is huge, with numerous interconnexions, making the analysis costly in computing time.", "GPUs are great at improving computing time\u2026 if you can use them ! Indeed, their use is often dedicated to training neural networks, thanks to powerful frameworks (Tensorflow or Pytorch are the most famous) that have enabled millions of developers to unleash their incredible powers.", "However, if you have some dirty preprocessing to get done with pandas or scikit-learn, that can be quite heavy if your data is big, since these packages do not feature any parameter helping you run them on GPUs. To sum things up, you won\u2019t be able to get the most out of your GPU at this stage.", "RAPIDS is a suite of packages developed by Nvidia AI, that intends to execute end-to-end data science and analytics pipelines entirely on GPUs.", "The goal of this notebook is to perform univariate regressions of each target on every feature in the MoA competition, namely 872 x 206 = 179632 logistic models to estimate separately.", "The good news ? This is possible within minutes with RAPIDS !", "You can note that I never import neither pandas (replaced by cudf) nor scikit-learn (replaced by cuml).", "This notebook will be a tutorial, aiming at helping you get familiar with the use of the libraries. At the end, you\u2019ll be able to select, among your features, those which appear to be the most crucial in predicting your targets. That will enable you to build robust, medium-sized models with better interpretability.", "If you want to skip the processing and jump to the results, you can directly take a look at the results here.", "First, I import all the necessary packages, and load the data.", "You can notice that cuDF is the exact equivalent of pandas except that it does everything on GPU : the data is directly read to the GPU with read_csv, you can also try any commonplace operation on dataframes, the functions and syntaxes are similar, as you can tell from my use of the merge method.", "This function is conceived to return a feature importance metric.", "Initially, I report the binary cross-entropy loss of univariate logistic regressions performed, for each target, on every feature (I have nearly 180k of them to do in total). Univariate analyses are a raw, but quite reliable and widely-used method for estimating a feature importance on a given target. It enables you to isolate its solo explainability power for a given model.", "You can notice that the cuML classes (here LogisticRegression), functions (here log_loss) and methods (here fit or predict_proba) also are exact equivalent of their sklearn counterparts which you are probably used to.", "However, I have to scale the outputs (for comparison purposes between targets that could be more or less difficult to predict, leveraging the average loss on features) and invert values order to gain better interpretability : indeed, you would expect a feature importance to be decreasing in the loss of estimating a given target on this feature. For this step, I use the cuML MinMaxScaler preprocessing class that works just as in sklearn.", "Calculating a feature\u2019s average importance on all targets is important to get a global view of how crucial it can be on your overall model.", "However, I\u2019m not sure you should rely entirely on this indicator when discriminating between features to keep and features to dismiss : indeed, a given feature could have a very high explainability power on one specific target, and be irrelevant on all others, therefore even though it would receive a low average importance score, keeping it would be decisive in final model quality for that target. We will aim at keeping the features that either have a high average explainability power on all targets (mean importance threshold), or which are particularly relevant for some of them (maximal importance threshold). Feel free to play with the thresholds !", "You will probably have noticed the small to_pandas() method I applied to my data : as it is stored on GPU, for plotting purposes only I need to convert it to cpu. That is the equivalent of the to_cpu() you perform on PyTorch at the end of the cuda computing procedure, for example.", "Further data analysis, based on feature selection operated with the chosen thresholds, leads to the following conclusions :", "This is a quite reassuring observation on our analysis.", "To get a global overview, we can just compare heatmaps of scaled feature importance by target on the two subsets, the features that fulfill both criterias and the ones that don\u2019t fulfill any. It becomes visible immediately that the first graph is much lighter \u2014 the solo importances are higher.", "You can now rely on your selected features and use them for building a lighter model, easier to run, and much more interpretable as well !", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc9b44c568ebd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lsferbach.medium.com/?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": ""}, {"url": "https://lsferbach.medium.com/?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": "Louise Ferbach"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39aab5779509&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&user=Louise+Ferbach&userId=39aab5779509&source=post_page-39aab5779509----c9b44c568ebd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9b44c568ebd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9b44c568ebd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lastly?utm_source=medium&utm_medium=referral", "anchor_text": "Tyler Lastovich"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/louise2001/rapids-feature-importance-is-all-you-need", "anchor_text": "feature selection notebook"}, {"url": "https://www.kaggle.com/c/lish-moa", "anchor_text": "Mechanisms of Action"}, {"url": "https://developer.nvidia.com/rapids", "anchor_text": "RAPIDS"}, {"url": "https://www.kaggle.com/louise2001/moa-feat-importance-rapids", "anchor_text": "here"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----c9b44c568ebd---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----c9b44c568ebd---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c9b44c568ebd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c9b44c568ebd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/model-building?source=post_page-----c9b44c568ebd---------------model_building-----------------", "anchor_text": "Model Building"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9b44c568ebd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&user=Louise+Ferbach&userId=39aab5779509&source=-----c9b44c568ebd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9b44c568ebd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&user=Louise+Ferbach&userId=39aab5779509&source=-----c9b44c568ebd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9b44c568ebd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc9b44c568ebd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c9b44c568ebd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c9b44c568ebd--------------------------------", "anchor_text": ""}, {"url": "https://lsferbach.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lsferbach.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Louise Ferbach"}, {"url": "https://lsferbach.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39aab5779509&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&user=Louise+Ferbach&userId=39aab5779509&source=post_page-39aab5779509--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff5b56db37d61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-to-know-your-features-in-seconds-with-rapids-c9b44c568ebd&newsletterV3=39aab5779509&newsletterV3Id=f5b56db37d61&user=Louise+Ferbach&userId=39aab5779509&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}