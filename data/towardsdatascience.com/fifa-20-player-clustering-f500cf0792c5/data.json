{"url": "https://towardsdatascience.com/fifa-20-player-clustering-f500cf0792c5", "time": 1683013241.902074, "path": "towardsdatascience.com/fifa-20-player-clustering-f500cf0792c5/", "webpage": {"metadata": {"title": "Machine Learning on FIFA 20. Data exploration on the video game FIFA\u2026 | by Erick Daniel Rodriguez V. | Towards Data Science", "h1": "Machine Learning on FIFA 20", "description": "FIFA is a football simulation game, released each year by Electronic Arts Inc, the main characters of the video game, of course, the football players. Players on the video game are intended to be as\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/stefanoleone992/fifa-20-complete-player-dataset?select=players_20.csv", "anchor_text": "Kaggle", "paragraph_index": 2}, {"url": "https://sofifa.com", "anchor_text": "sofifa", "paragraph_index": 2}, {"url": "http://cs229.stanford.edu/notes/cs229-notes3.pdf", "anchor_text": "notes", "paragraph_index": 45}, {"url": "https://web.stanford.edu/~jurafsky/slp3/5.pdf", "anchor_text": "here", "paragraph_index": 50}, {"url": "http://linkedin.com/in/danielrovilla/", "anchor_text": "linkedin.com/in/danielrovilla/", "paragraph_index": 65}], "all_paragraphs": ["FIFA is a football simulation game, released each year by Electronic Arts Inc, the main characters of the video game, of course, the football players. Players on the video game are intended to be as close as the real ones, both physically and in skills. This set of skills determine the position they play on the field. Of course, you want a killer striker and a wall as a goalkeeper!", "If you are a football fan, you most likely know the position each player has on your favorite team. Can a machine learn the different player\u2019s position according to their skills?", "Data was downloaded from Kaggle, which was scraped from the publicly available website sofifa.", "The first step is to download the data and take a first look at some of the information of the players.", "Now let\u2019s take a look at the players that will make a club pay \u201ctop dollar\u201d.", "These two players are definitely expensive, but which clubs spend on average the most? In order to show this, players where grouped by club, then the mean was taken from columns \u201cvalue_eur\u201d and \u201cwage_eur\u201d.", "Let\u2019s take a look at the top 10 clubs with the most valuable players and top 10 clubs which pay the highest wages.", "Now let\u2019s have a look at the clubs with the top players.", "Note: This doesn\u2019t necessarily translate into a plot of best teams, since some clubs may have more substitute or reserve players than others, nonetheless, an interesting output.", "The country with more leagues on FIFA 20 is England, no surprise they have the most number of players in the game.", "The histograms below show some interesting insights:", "Histograms above are divided by player positions, we can take a look at the general distribution of the \u201cOverall\u201d score.", "If we take a look at player positions, we notice players have one position, others have two and some even three!", "For the scope of this project, positions will be grouped in four categories:", "Correctly grouping players in these categories is an important step before making any model. Let\u2019s take for example the player \u201c41\u201d, this player has three positions:", "If we select just the first position for each player, this \u201c41\u201d player would be considered as an \u201cAttacker\u201d, however, he also plays in two other positions, both as a \u201cMidfielder\u201d. So a better approach would be to consider this player a midfielder. To make this possible the following function was created and applied to the \u2018player_positions\u2019 column.", "A new DataFrame is created which will have only the useful columns, these are shown below with the number of null values.", "We have 0 null values in our DataFrame so we can proceed.", "The data values will be assigned accordingly, predictors (X) and target (y), then it will be split into train and test.", "Although the standardization of the data is an important pre-process, this will be executed in combination with each machine learning model and cross-validation through Pipeline to avoid leakage.", "So what are these terms? Here is a brief explanation of each:", "When information from outside the training dataset is used to create the model.", "Data standardization is the process of rescaling one or more attributes so that they have a mean value of 0 and a standard deviation of 1.", "According to scikit-learn documentation: Sequentially apply a list of transforms and a final estimator. Intermediate steps of the pipeline must be \u2018transforms\u2019, that is, they must implement fit and transform methods. The final estimator only needs to implement fit.", "The purpose of the pipeline is to assemble several steps that can be cross-validated together while setting different parameters.", "Splitting the data into train and test is necessary for supervised learning, however, the results of the model will be based on this only partition. A solution to this problem is a procedure called k-fold cross-validation, where data is divided in k smaller sets. The training data will be k-1 folds, the remaining fold will be used for validation, average of the validation results across the k-folds will be the performance measure.", "This procedure could be computationally expensive, but it helps to avoid overfitting or selection bias.", "Before jumping into different machine learning models to classify players position, let\u2019s see the correlation matrix between player attributes.", "By looking at this heat map, we can assume that models should easily identify Goalkeepers, let\u2019s find out how they perform.", "Note: There will be a brief explanation of each classification algorithm, a deeper approach of each is out of the scope of this story. The presented explanation should be enough to understand the displayed code.", "An object is classified by a plurality vote of its neighbors, with the object being assigned to the class most common among its k nearest neighbors. If k = 1, then the object is simply assigned to the class of that single nearest neighbor.", "The image below shows an example of how the algorithm works. The green dot is the test object. If k = 3 it will be classified as a red triangle since there are two red triangle against one blue square (circle area). If k = 5 it will now be classified as a blue square, since these \u201cneighbors\u201d now have the majority (dashed circle area).", "The following code combines what we\u2019ve read so far:", "The result is the cross-validated mean with the corresponding best parameter. Now we can fit the model and make a prediction.", "A useful tool to visualize the performance of an algorithm is the confusion matrix. This two dimension table shows the labeling of the players. The normalized shows the classification as percentage and the unnormalized as number of players. For instance:", "And so on for each position.", "Structure in which each internal node represents a \u201ctest\u201d on an attribute, each branch represents the outcome of the test, and each leaf node represents a class label. Composition of DTC:", "Note: For our data, decision nodes will be the predictors, branches will be \u201c\u2264 X\u201d and the leaf nodes will be the player position. For example, \u201cskill_dribbling\u201d \u2264 55.0 \u2192 Defender.", "Again, we use pipeline to get the best parameters for the algorithm.", "Can we be sure these are the best parameters? The code below shows a demonstration on the \u201cbehind the scenes\u201d of how the best parameters are obtained in each GridSearchCV.", "As we can see, out of the 24 different possibilities, (8, 'gini') has the best score (0.858638...). Now that we have the best parameters we can fit the model.", "Take a look at the respective confusion matrixes.", "This algorithm is based on the idea of finding a hyperplane that best divides the data. The goal is to find a hyperplane with the greatest possible margin (distance) between an observation (support vector) and the hyperplane, giving a greater chance of correctly identifying new data. If the number of input features is two, then the hyperplane is just a line, if the number of input features is three, then the hyperplane becomes a two-dimensional plane. It becomes difficult to imagine when the number of features exceeds three. The idea is that the data will continue to be mapped into higher and higher dimensions until a hyperplane can be formed to segregate it.", "The multi-class problem is broken down to multiple binary classification cases, which is also called one-vs-one. Which splits the dataset into one dataset for each class versus every other class.", "Each binary classification model may predict one class label and the model with the most predictions or votes is predicted by the one-vs-one strategy.", "Note: To get a better grasp of the algorithm, notes by Andrew Ng are fantastic.", "Once again, the best parameters are obtained and the model is fitted.", "This model is used to predict a binary outcome given a set of features (predictors). The classifier output (target) can be 1 or 0. We are looking for the probability that an observation is part of the class (1) or not (0).", "In a nutshell, it takes the features, multiplies each by a weight, sums them, and passes the sum through a sigmoid function to generate a probability and assign a class. The weights (vector w and bias b) are learned from a labeled training set via a loss function (cross-entropy loss).", "Our data has more than two targets, so we use the multinomial logistic regression which uses a generalization of the sigmoid, called the softmax function.", "Note: Again, this is a very simplistic approach of the algorithm, find more here.", "Same old, same old, use pipeline to get the best parameters and fit the model.", "Note: The parameter multi_class is set by default to \u201cauto\u201d which will select \u2018\u201cmultinomial\u201d if data isn\u2019t binary. If \u201cmultinomial\u201d is selected, the softmax function is used to find the predicted probability of each class to assign the target.", "As expected, all different models could easily identify Goalkeepers, the majority of skills they have seem to be negatively correlated with the rest, and strongly correlated within each other.", "We\u2019ve seen the different confusion matrixes, let\u2019s take a final look at some of the main classification metrics. These are obtained through classification_report and accuracy_score from the sklearn.metrics library. For simplicity, all reports are placed together in one image.", "SVM seems to be the most accurate algorithm to determine players position. However, there are other important metrics. Placing an Attacker as a Defender may not be the end of the world, but certainly, it won\u2019t perform as good. Let\u2019s take a look at what these useful metrics bring to the table.", "How close is the predicted value to the actual target.", "Fraction of relevant instances among the retrieved instances. (Diagonal values from the normalized confusion matrixes).How many selected items are relevant?", "Fraction of the total amount of relevant instances that were actually retrieved.How many relevant items are selected?", "Harmonic mean of precision and recall.", "There are several supervised algorithms, this story showed a glance at some of them. A correct pre-process of the data along with the correct selection of parameters is crucial for every algorithm.", "When it comes to choosing which algorithm performed better it\u2019s important to remember:", "Another important metric which sometimes is overlooked is time! Yes, you want an accurate model, but some models take more time for a small gain in accuracy. To exemplify, SVM had a 0.95% better accuracy score than Logistic Regression, however, finding the best parameters for LogReg was 6.6 times faster than SVM (both originally designed for binary classification).", "In some scenarios 1% could be a significant difference yet sometimes it may just be okay to lose that percent to get a faster result. Choosing the best algorithm depends on the attributes of your data.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Finance guy making his way into ML. Let\u2019s connect linkedin.com/in/danielrovilla/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff500cf0792c5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@daniel.rovilla?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel.rovilla?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": "Erick Daniel Rodriguez V."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4de2e1da85fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&user=Erick+Daniel+Rodriguez+V.&userId=4de2e1da85fa&source=post_page-4de2e1da85fa----f500cf0792c5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff500cf0792c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff500cf0792c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jeshoots?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "JESHOOTS.COM"}, {"url": "https://unsplash.com/s/photos/fifa?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/stefanoleone992/fifa-20-complete-player-dataset?select=players_20.csv", "anchor_text": "Kaggle"}, {"url": "https://sofifa.com", "anchor_text": "sofifa"}, {"url": "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/K-fold_cross_validation_EN.svg/250px-K-fold_cross_validation_EN.svg.png", "anchor_text": "Wikipedia"}, {"url": "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e7/KnnClassification.svg/220px-KnnClassification.svg.png", "anchor_text": "Wikipedia"}, {"url": "https://www.mathworks.com/help/stats/support-vector-machines-for-binary-classification.html", "anchor_text": "MathWorks"}, {"url": "http://cs229.stanford.edu/notes/cs229-notes3.pdf", "anchor_text": "notes"}, {"url": "https://web.stanford.edu/~jurafsky/slp3/5.pdf", "anchor_text": "here"}, {"url": "http://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html", "anchor_text": "Scikit-learn: Machine Learning in Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f500cf0792c5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/supervised-learning?source=post_page-----f500cf0792c5---------------supervised_learning-----------------", "anchor_text": "Supervised Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----f500cf0792c5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/fifa-20?source=post_page-----f500cf0792c5---------------fifa_20-----------------", "anchor_text": "Fifa 20"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----f500cf0792c5---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff500cf0792c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&user=Erick+Daniel+Rodriguez+V.&userId=4de2e1da85fa&source=-----f500cf0792c5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff500cf0792c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&user=Erick+Daniel+Rodriguez+V.&userId=4de2e1da85fa&source=-----f500cf0792c5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff500cf0792c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff500cf0792c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f500cf0792c5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f500cf0792c5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f500cf0792c5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f500cf0792c5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f500cf0792c5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel.rovilla?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel.rovilla?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Erick Daniel Rodriguez V."}, {"url": "https://medium.com/@daniel.rovilla/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3 Followers"}, {"url": "http://linkedin.com/in/danielrovilla/", "anchor_text": "linkedin.com/in/danielrovilla/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4de2e1da85fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&user=Erick+Daniel+Rodriguez+V.&userId=4de2e1da85fa&source=post_page-4de2e1da85fa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F4de2e1da85fa%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-20-player-clustering-f500cf0792c5&user=Erick+Daniel+Rodriguez+V.&userId=4de2e1da85fa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}