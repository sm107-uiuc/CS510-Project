{"url": "https://towardsdatascience.com/keras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8", "time": 1683002521.724072, "path": "towardsdatascience.com/keras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8/", "webpage": {"metadata": {"title": "Keras and R: Predicting Blood Glucose Levels with the Sequential Model | by Michael Grogan | Towards Data Science", "h1": "Keras and R: Predicting Blood Glucose Levels with the Sequential Model", "description": "With the advent of TensorFlow 2.0, Keras is now the default API for this version. Keras is used to build neural networks for deep learning purposes. As such, Keras is a highly useful tool for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/uciml/pima-indians-diabetes-database", "anchor_text": "Pima Indians Diabetes dataset", "paragraph_index": 3}, {"url": "https://medium.com/fintechexplained/what-are-hidden-layers-4f54f7328263", "anchor_text": "Farhad Malik", "paragraph_index": 28}, {"url": "https://www.michael-grogan.com/", "anchor_text": "michael-grogan.com", "paragraph_index": 47}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 50}], "all_paragraphs": ["With the advent of TensorFlow 2.0, Keras is now the default API for this version. Keras is used to build neural networks for deep learning purposes. As such, Keras is a highly useful tool for conducting analysis of large datasets.", "However, did you realise that the Keras API can also be run in R?", "In this example, Keras is used to generate a neural network \u2014 with the aim of solving a regression problem in R.", "Specifically, the Pima Indians Diabetes dataset is used in order to predict blood glucose levels for patients using the relevant features.", "In this regard, this article provides an overview of:", "The Pima Indians Diabetes dataset is partitioned into three separate datasets for this example.", "Training and validation: pima-indians-diabetes1.csv. 80% of the original dataset is split from the full dataset. In turn, 70% of this dataset is used for training the model, and the remaining 30% is used for validating the predictions.", "Test: pima-indians-diabetes2.csv and pima-indians-diabetes3.csv. The remaining 20% of the original dataset is used as unseen data, to determine whether the predictions being yielded by the model would perform well when dealing with completely new data. pima-indians-diabetes2 contains the features (or independent variables), while pima-indians-diabetes3 contains the dependent variable (blood glucose levels).", "The purpose of feature selection is to determine those features that have the most influence on the dependent variable.", "In our example, there are eight features \u2014 some will be more important than others in determining blood glucose levels.", "The two feature selection methods used here are:", "Correlation plots allow us to visually determine:", "If certain features are highly correlated with blood glucose levels, then this is an indication that these features are important in predicting the same. Features with low correlation are indicated to be insignificant.", "However, features that are highly correlated with each other would indicate that some of these features are redundant (since they are in effect attempting to explain the same thing).", "Here is the first correlation plot:", "We can see that the Insulin and Outcome variables are particularly correlated with the Glucose variable, while there is also correlation between Age and Pregnancies and Insulin and Skin Thickness.", "However, we can go into more detail and obtain specific correlation coefficients for each feature:", "The purpose of a multiple linear regression is to:", "Here are the results for the linear regression:", "At the 5% level, Outcome, Age, Insulin and Skin Thickness are deemed significant. Other features are deemed insignificant at the 5% level.", "It is not deemed necessary to run a formal test for multicollinearity in this instance, as the correlation plots indicate features that are highly correlated with each other.", "However, heteroscedasticity (uneven variance across standard errors) could be present, e.g. due to differing age across patients. In order to test this, the Breusch-Pagan test is run \u2014 with a p-value below 0.05 indicating the presence of heteroscedasticity.", "As heteroscedasticity is indicated to be present, a robust regression is run \u2014 specifically using Huber weights. The purpose of this is to place less value on the outliers present in the dataset.", "On 590 degrees of freedom, the two-tailed t critical value is as follows:", "When the t statistic > t critical value, the null hypothesis is rejected. In this regard, Outcome, Age, BMI, Insulin, and Skin Thickness have an absolute t-value greater than the critical value.", "Taking the findings of both the correlation plots and multiple linear regression into account, Outcome, Age, Insulin and Skin Thickness are selected as the relevant features for the analysis.", "Now that the relevant features have been selected, the neural network can be constructed. Before doing so:", "Now, the Sequential model is defined. The four input features (Outcome, Age, Insulin, Skin Thickness) are included in the input layer with 9 neurons defined in the layer. One hidden layer with 60 neurons is defined, and a linear output layer with 1 neuron is defined.", "As explained in this article by Farhad Malik, the number of neurons in each layer is configured as follows:", "Number of features in the training set + 1", "In this case, as there were 8 features in the training set to begin with, 9 input neurons are defined accordingly.", "A factor of 1 is set in this case, the purpose of the factor being to prevent overfitting. A factor can take a value between 1 and 10. With 9 neurons in the input layer, 1 neuron in the output layer and 599 observations in the training set, the hidden layer is assigned 60 neurons.", "The model is now trained over 30 epochs, and evaluated based on its loss and mean absolute error. Given that the dependent variable is interval, the mean squared error is used to determine the deviation between the predictions and actual values.", "The predicted and actual values are scaled back to their original formats:", "Here is a plot of the loss and mean absolute error:", "The model yields a loss of just above 2% and a mean absolute error of just above 13%.", "The MLmetrics library can also be used to calculate the MAPE (mean absolute percentage error).", "The MAPE for the validation set comes in at 18%. Increasing the number of hidden layers in the model did not improve MAPE and it was therefore decided to keep one hidden layer in the model configuration.", "Even though the model has shown strong predictive power, our work is not done yet.", "While the model has performed well on the validation data, we now need to assess whether the model will also perform well on completely unseen data.", "The feature variables are loaded from pima-indians-diabetes2, and max0min normalization is invoked once again:", "Using the predict function in R, predictions are generated for the Glucose variable:", "The predicted values are then compared to the actual values in pima-indians-diabetes3:", "Now, the mean absolute percentage error is calculated using the test values:", "A mean percentage error of 17% is calculated:", "It is observed that while the mean percentage error is slightly higher than that calculated using the training and validation data, the model still performs well in predicting blood glucose levels across unseen observations on the test set.", "In this example, we have seen:", "Many thanks for your time! You can also find more of my data science content at michael-grogan.com.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F596efe89a6b8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----596efe89a6b8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F596efe89a6b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F596efe89a6b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/uciml/pima-indians-diabetes-database", "anchor_text": "Pima Indians Diabetes dataset"}, {"url": "https://medium.com/fintechexplained/what-are-hidden-layers-4f54f7328263", "anchor_text": "Farhad Malik"}, {"url": "https://www.michael-grogan.com/", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----596efe89a6b8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----596efe89a6b8---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----596efe89a6b8---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/r?source=post_page-----596efe89a6b8---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/data-science?source=post_page-----596efe89a6b8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F596efe89a6b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&user=Michael+Grogan&userId=eec017a8b178&source=-----596efe89a6b8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F596efe89a6b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&user=Michael+Grogan&userId=eec017a8b178&source=-----596efe89a6b8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F596efe89a6b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F596efe89a6b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----596efe89a6b8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----596efe89a6b8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----596efe89a6b8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----596efe89a6b8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----596efe89a6b8--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}