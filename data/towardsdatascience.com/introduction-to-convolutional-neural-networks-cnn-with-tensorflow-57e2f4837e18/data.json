{"url": "https://towardsdatascience.com/introduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18", "time": 1682995625.169585, "path": "towardsdatascience.com/introduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18/", "webpage": {"metadata": {"title": "Introduction to Convolutional Neural Networks (CNN) with TensorFlow | by Marco Peixeiro | Towards Data Science", "h1": "Introduction to Convolutional Neural Networks (CNN) with TensorFlow", "description": "Recent advances in deep learning have made computer vision applications leap forward: from unlocking our mobile phone with our face, to safer self-driving cars. Convolutional neural networks (CNN)\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "earlier post", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "backpropagation", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/the-complete-tensorflow-tutorial-for-newbies-dc3acc1310f8", "anchor_text": "previous project", "paragraph_index": 39}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/4.Convolutional%20Neural%20Networks/1.Foundations%20of%20Convolutional%20Neural%20Networks/ConvNet%20in%20TensorFlow.ipynb", "anchor_text": "here", "paragraph_index": 40}], "all_paragraphs": ["Recent advances in deep learning have made computer vision applications leap forward: from unlocking our mobile phone with our face, to safer self-driving cars.", "Convolutional neural networks (CNN) are the architecture behind computer vision applications. In this post, you will learn about the foundations of CNNs and computer vision such as the convolution operation, padding, strided convolutions and pooling layers. Then, we will use TensorFlow to build a CNN for image recognition.", "For hands-on video tutorials on machine learning, deep learning, and artificial intelligence, checkout my YouTube channel.", "The convolution operation is the building block of a convolutional neural network as the name suggests it.", "Now, in the field of computer vision, an image can be expressed as a matrix of RGB values. This concept was actually introduced in an earlier post.", "To complete the convolution operation, we need an image and a filter.", "Therefore, let\u2019s consider the 6x6 matrix below as a part of an image:", "And the filter will be the following matrix:", "Then, the convolution involves superimposing the filter onto the image matrix, adding the product of the values from the filter and and the values from the image matrix, which will generate a 4x4 convoluted layer.", "This is very hard to put in words, but here is a nice animation that explains the convolution:", "Performing this on the image matrix above and using the filter defined above, you should get the following resulting matrix:", "How do you interpret the output layer?", "Well, considering that each value is indicative of color, or how dark a pixel is (positive value means light, negative value means dark), then you can interpret the output layer as:", "Therefore, it seems that this particular filter is responsible to detect vertical edges in images!", "This is a natural question, as you might realize that there is an infinite number of possible filters you can apply to an image.", "It turns out that the exact values in your filter matrix can be trainable parameters based on the model\u2019s objective. Therefore, you can either choose a filter that has worked for your specific application, or you can use backpropagation to determine the best values for your filter that will yield the best outcome.", "Previously, we have seen that a 3x3 filter convoluted with a 6x6 image, will result in 4x4 matrix. This is because there are 4x4 possible positions for the filter to fit in a 6x6 image.", "Therefore, after each convolution step, the image shrinks, meaning that only a finite number of convolution can be performed until the image cannot be shrunken anymore. Furthermore, pixels situated in the corner of the image are only used once, and this results in loss of information for the neural network.", "In order to solve both problems stated above, padding is used. Padding consists in adding a border around the input image as shown below:", "As you can see, the added border is usually filled with zeros. Now, the corner pixel of the image will be used many times to calculate the output, effectively preventing loss of information. Also, it allows us to keep the input matrix shape in the output.", "Considering our 6x6 input image, if we add a padding of 1, we get a 8x8 matrix. Applying a 3x3 filter, this will result in a 6x6 output.", "A simple equation can help us figure out the shape of the output:", "Padding is not always required. However, when padding is used, it is usually for the output to have the same size as the input image. This yields two types of convolutions.", "When no padding is applied, this is called a \u201cvalid convolution\u201d. Otherwise, it is termed \u201csame convolution\u201d. To determine the padding size required to keep the dimensions of the input image, simply equate the formula above to n. After solving for p, you should get:", "You might have noticed that f should be odd in order for the padding to be a whole number. Hence, it is a convention in the field of computer visions to have odd filters.", "Previously, we have seen a convolution with a stride of 1. This means that the filter was moving horizontally and vertically by 1 pixel.", "A strided convolution is when the stride is greater than 1. In the animation below, the stride is 2:", "Now, taking into account the stride, the formula to calculate the shape of the output matrix is:", "As a convention, if the formula above does not yield a whole number, then we round down to the nearest integer.", "Pooling layers are another way to reduce the size of the image interpretation in order to speed up computation, and it makes the detected features more robust.", "Pooling is best explained with an image. Below is an example of max pooling:", "As you can see, we chose a 2x2 filter with a stride of 2. This is equivalent to dividing the input into 4 identical squares, we then take the maximum value of each square, and use it in the output.", "Average pooling can also be performed, but it less popular than max pooling.", "You can think of pooling as a way to prevent overfitting, since we are removing some features from the input image.", "We now have a strong foundational knowledge of convolutional neural networks. However, why do deep learning practitioners use them?", "Unlike fully connected layers, convolutional layers have a much smaller set of parameters to learn. This is due to:", "Parameter sharing refers to the fact that one feature detector, such as vertical edges detector, will be useful in many parts of the image. Then, the sparsity of connections refers to the fact that only a few features are related to a certain output value.", "Considering the above example of max pooling, the top left value for the output depends solely on the top left 2x2 square from the input image.", "Therefore, we can train on smaller datasets and greatly reduce the number of parameters to learn, making CNNs a great tool for computer vision tasks.", "Enough with the theory, let\u2019s code a CNN for hand signs recognition. We revisit a previous project to see if a CNN will perform better.", "As always, the full notebook is available here.", "After importing the required libraries and assets, we load the data and preprocess the images:", "Then, we create placeholders for the features and the target:", "We then initialize our parameters using Xavier initialization:", "Now, we define the forward propagation step, which is really the architecture of our CNN. We will use a simply 3-layer network with 2 convolutional layers and a final fully-connected layer:", "Finally, we define a function that will compute the cost:", "Now, we combine all the functions above into a single CNN network. We will use mini-batch gradient descent for training:", "Great! Now, we can run our model and see how it performs:", "In my case, I trained the CNN on a laptop using only CPU, and I got a pretty bad result. If you train the CNN on a desktop with a better CPU and GPU, you will surely get better results than I did.", "Congratulations! You now have a very good knowledge about CNNs and the field of computer vision. Although there is much more to learn, the more advanced techniques use the concepts introduced here as building blocks.", "In the next post, I will introduce residual networks with Keras!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior data scientist | Author | Instructor. I write hands-on articles with a focus on practical skills."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F57e2f4837e18&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd----57e2f4837e18---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F57e2f4837e18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F57e2f4837e18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@stephtcook?utm_source=medium&utm_medium=referral", "anchor_text": "Stephanie Cook"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel"}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "earlier post"}, {"url": "https://www.coursera.org/learn/convolutional-neural-networks/lecture/4Trod/edge-detection-example", "anchor_text": "Source"}, {"url": "https://www.coursera.org/learn/convolutional-neural-networks/lecture/4Trod/edge-detection-example", "anchor_text": "Source"}, {"url": "https://www.coursera.org/learn/convolutional-neural-networks/lecture/4Trod/edge-detection-example", "anchor_text": "Source"}, {"url": "https://www.coursera.org/learn/convolutional-neural-networks/lecture/4Trod/edge-detection-example", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "backpropagation"}, {"url": "https://towardsdatascience.com/the-complete-tensorflow-tutorial-for-newbies-dc3acc1310f8", "anchor_text": "previous project"}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/4.Convolutional%20Neural%20Networks/1.Foundations%20of%20Convolutional%20Neural%20Networks/ConvNet%20in%20TensorFlow.ipynb", "anchor_text": "here"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "deeplearning.ai"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----57e2f4837e18---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----57e2f4837e18---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----57e2f4837e18---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----57e2f4837e18---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----57e2f4837e18---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F57e2f4837e18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----57e2f4837e18---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F57e2f4837e18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----57e2f4837e18---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F57e2f4837e18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F57e2f4837e18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----57e2f4837e18---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----57e2f4837e18--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----57e2f4837e18--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----57e2f4837e18--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----57e2f4837e18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/@marcopeixeiro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9835bccb3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-convolutional-neural-networks-cnn-with-tensorflow-57e2f4837e18&newsletterV3=741c1c8fcfbd&newsletterV3Id=9835bccb3d51&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/time-series-forecasting-in-python-book", "anchor_text": "Time Series Forecasting in Python2022"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}