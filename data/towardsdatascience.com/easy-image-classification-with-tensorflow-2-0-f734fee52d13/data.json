{"url": "https://towardsdatascience.com/easy-image-classification-with-tensorflow-2-0-f734fee52d13", "time": 1682995601.0129979, "path": "towardsdatascience.com/easy-image-classification-with-tensorflow-2-0-f734fee52d13/", "webpage": {"metadata": {"title": "Easy Image Classification with TensorFlow 2.0 | by Cameron Cruz | Towards Data Science", "h1": "Easy Image Classification with TensorFlow 2.0", "description": "At the TensorFlow Dev Summit 2019, Google introduced the alpha version of TensorFlow 2.0. Historically, TensorFlow is considered the \u201cindustrial lathe\u201d of machine learning frameworks: a powerful tool\u2026"}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com", "anchor_text": "Google Colaboratory", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/aerial-cactus-identification", "anchor_text": "Aerial Cactus Identification", "paragraph_index": 5}, {"url": "https://github.com/cameroncruz/notebooks/blob/master/Easy_Image_Classification_with_TF_2.ipynb", "anchor_text": "full notebook here", "paragraph_index": 6}, {"url": "https://github.com/cameroncruz/notebooks/blob/master/Easy_Image_Classification_with_TF_2.ipynb", "anchor_text": "see the notebook here", "paragraph_index": 19}, {"url": "https://www.tensorflow.org/alpha/tutorials/images/transfer_learning", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://www.tensorflow.org/alpha/tutorials/images/transfer_learning", "anchor_text": "Transfer Learning Using Pretrained ConvNets", "paragraph_index": 21}], "all_paragraphs": ["At the TensorFlow Dev Summit 2019, Google introduced the alpha version of TensorFlow 2.0. Historically, TensorFlow is considered the \u201cindustrial lathe\u201d of machine learning frameworks: a powerful tool with intimidating complexity and a steep learning curve. If you\u2019ve used TensorFlow 1.x in the past, you know what I\u2019m talking about. This 2.0 release represents a concerted effort to improve the usability, clarity and flexibility of TensorFlow. Here are some highlights:", "As a result, TensorFlow 2.0 is more Pythonic and less daunting to learn, while retaining the lower-level customization and complexity if you need it. Let\u2019s get started with TensorFlow 2.0 by exploring how to apply its high-level APIs in a classic image classification setting.", "Google Colaboratory makes it really easy to setup Python notebooks in the cloud. With free access to a GPU for up to 12 hours at a time, Colab has quickly become my go-to platform for performing machine learning experiments.", "Let\u2019s install the TensorFlow 2.0 alpha release (GPU version) on a Colab notebook via pip.", "You should be good to go! If you run into issues, double check that your Colab runtime has \u201cGPU\u201d as the runtime accelerator in Edit>Notebook settings.", "Let\u2019s use the dataset from the Aerial Cactus Identification competition on Kaggle. Our task is to build a classifier capable of determining whether an aerial image contains a columnar cactus or not. This dataset is a modified version of the Cactus Aerial Photos dataset [1](Kaggle resized each image to 32x32 pixels).", "For example code on downloading/unzipping datasets from Kaggle, see the full notebook here.", "Let\u2019s load the image file paths and their corresponding labels into lists using pandas, then create a train-validation split of 90\u201310 using sklearn.model_selection.", "Now that we have image filenames and labels split into training and validation sets, we can create respective tf.data.Dataset objects.", "However, our dataset still contains just the image filenames, not the actual images. We need to define a function that can load the images from file and perform any necessary preprocessing. While we\u2019re at it, let\u2019s shuffle and batch the datasets, too.", "Transfer learning speeds up training by enabling us to reuse existing pre-trained image classification models, only retraining the top layer of the network that determines the classes an image can belong to [2].", "Let\u2019s use TensorFlow 2.0\u2019s high-level Keras API to quickly build our image classification model. For transfer learning, we can use a pre-trained MobileNetV2 model as the feature detector. MobileNetV2 is the second iteration of MobileNet released by Google with the goal of being smaller and more lightweight than models like ResNet and Inception for running on mobile devices [3]. Let\u2019s load the MobileNetV2 model pre-trained on ImageNet without the top layer, freeze its weights, and add a new classification head.", "Note that it is recommended to use TensorFlow optimizers to train tf.keras models. In TensorFlow 2.0, the optimizers in the former tf.train and tf.keras.optimizers APIs have been unified under tf.keras.optimizers , where the original tf.keras optimizers have been replaced with upgraded TensorFlow optimizers [4]. Thus, applying TensorFlow optimizers is now a simpler and more consistent experience, fully supporting usage with the tf.keras API and not sacrificing performance.", "The tf.keras API in TensorFlow 2.0 now has full support for the tf.data API, so we can easily use our tf.data.Dataset objects when training the model [5]. Again, training is executed eagerly by default now without sacrificing the performance benefits of graph-based execution.", "After 30 epochs, the model\u2019s validation accuracy increases from around 0.63 to 0.94.", "Let\u2019s try to improve the accuracy of our model even further. When we applied transfer learning, we only trained the new classification head of the model, freezing the weights from MobileNetV2. If we didn\u2019t freeze those weights initially, the model would \u201cforget\u201d all the knowledge it started with since the new classification head was randomly initialized [2]. However, now that we\u2019ve trained the classification head first, we can unfreeze layers in the pre-trained model to fine-tune on this particular dataset.", "After an additional 30 epochs of fine-tuning, the model achieved a validation accuracy of 0.986. Based on the accuracy and loss graphs, more epochs may result in even greater improvements.", "In this article, we looked at how TensorFlow 2.0's focus on usability, clarity and flexibility makes it much less daunting to get started with TensorFlow for machine learning experiments. Eager execution and improved high-level APIs abstract away much of TensorFlow\u2019s usual complexity, making it much easier to quickly implement and run a quintessential image classification experiment.", "At the time of writing, this is just the alpha release of TensorFlow 2.0, with a final release expected sometime later this year. Already, it\u2019s apparent that the TensorFlow team is forging a significantly more intuitive iteration of TensorFlow. This is likely to improve the productivity of machine learning engineers across the board, reducing the usual amount of complexity while retaining lower-level control for those that need it. In addition, while TensorFlow was already a popular choice among machine learning experts, the smoother learning curve makes it a more attractive option for beginners as well.", "Let me know what you think of TensorFlow 2.0 so far in the comments! Also, if you\u2019re interested in the full code for this tutorial, see the notebook here. If you have any questions, don\u2019t hesitate to ask in the comments section, too.", "This tutorial is inspired from the Transfer Learning Using Pretrained ConvNets on TensorFlow.org. To read the original tutorial, see here.", "[2] Transfer Learning Using Pretrained ConvNets (2019), TensorFlow.org", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Stanford \u201820, specializing in AI on edge devices. Currently ML/SWE Solutions Engineer at Mineral, the computational agriculture moonshot @ X."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff734fee52d13&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f734fee52d13--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f734fee52d13--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cameroncruzin?source=post_page-----f734fee52d13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cameroncruzin?source=post_page-----f734fee52d13--------------------------------", "anchor_text": "Cameron Cruz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa0310dea18ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&user=Cameron+Cruz&userId=a0310dea18ff&source=post_page-a0310dea18ff----f734fee52d13---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff734fee52d13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff734fee52d13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.tensorflow.org/community/roadmap", "anchor_text": "And more"}, {"url": "https://colab.research.google.com", "anchor_text": "Google Colaboratory"}, {"url": "https://www.kaggle.com/c/aerial-cactus-identification", "anchor_text": "Aerial Cactus Identification"}, {"url": "https://github.com/cameroncruz/notebooks/blob/master/Easy_Image_Classification_with_TF_2.ipynb", "anchor_text": "full notebook here"}, {"url": "https://github.com/cameroncruz/notebooks/blob/master/Easy_Image_Classification_with_TF_2.ipynb", "anchor_text": "see the notebook here"}, {"url": "https://www.tensorflow.org/alpha/tutorials/images/transfer_learning", "anchor_text": "here"}, {"url": "https://www.kaggle.com/irvingvasquez/cactus-aerial-photos", "anchor_text": "Cactus Aerial Photos"}, {"url": "https://www.tensorflow.org/alpha/tutorials/images/transfer_learning", "anchor_text": "Transfer Learning Using Pretrained ConvNets"}, {"url": "https://arxiv.org/pdf/1801.04381.pdf", "anchor_text": "MobileNetV2: Inverted Residuals and Linear Bottlenecks"}, {"url": "https://github.com/tensorflow/community/blob/master/rfcs/20181016-optimizer-unification.md", "anchor_text": "TensorFlow 2.0: Optimizer Unification"}, {"url": "https://www.tensorflow.org/community/roadmap", "anchor_text": "Roadmap"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f734fee52d13---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----f734fee52d13---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----f734fee52d13---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----f734fee52d13---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----f734fee52d13---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff734fee52d13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&user=Cameron+Cruz&userId=a0310dea18ff&source=-----f734fee52d13---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff734fee52d13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&user=Cameron+Cruz&userId=a0310dea18ff&source=-----f734fee52d13---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff734fee52d13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f734fee52d13--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff734fee52d13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f734fee52d13---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f734fee52d13--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f734fee52d13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f734fee52d13--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f734fee52d13--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f734fee52d13--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f734fee52d13--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f734fee52d13--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f734fee52d13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cameroncruzin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cameroncruzin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cameron Cruz"}, {"url": "https://medium.com/@cameroncruzin/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa0310dea18ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&user=Cameron+Cruz&userId=a0310dea18ff&source=post_page-a0310dea18ff--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fa0310dea18ff%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-image-classification-with-tensorflow-2-0-f734fee52d13&user=Cameron+Cruz&userId=a0310dea18ff&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}