{"url": "https://towardsdatascience.com/data-maps-datasets-can-be-distilled-too-1991c3c260d6", "time": 1683014819.504597, "path": "towardsdatascience.com/data-maps-datasets-can-be-distilled-too-1991c3c260d6/", "webpage": {"metadata": {"title": "Data Maps: Datasets Can Be Distilled Too | by Elior Cohen | Towards Data Science", "h1": "Data Maps: Datasets Can Be Distilled Too", "description": "Links: Paper: Dataset Cartography: Mapping and Diagnosing Datasets with Training Dynamics Notebook: https://github.com/eliorc/Medium/blob/master/datamaps.ipynb A week ago I came across an\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/2009.10795", "anchor_text": "Dataset Cartography: Mapping and Diagnosing Datasets with Training Dynamics", "paragraph_index": 0}, {"url": "https://github.com/eliorc/tavolo", "anchor_text": "", "paragraph_index": 15}, {"url": "https://github.com/eliorc/tavolo", "anchor_text": "tavolo", "paragraph_index": 15}, {"url": "https://github.com/eliorc/Medium/blob/master/datamaps.ipynb", "anchor_text": "Github", "paragraph_index": 16}, {"url": "https://huggingface.co/transformers/model_doc/distilbert.html", "anchor_text": "DistillBERT model", "paragraph_index": 17}, {"url": "https://www.tensorflow.org/datasets/catalog/glue#glueqnli", "anchor_text": "QNLI dataset", "paragraph_index": 17}, {"url": "https://github.com/eliorc/Medium/blob/master/datamaps.ipynb", "anchor_text": "notebook", "paragraph_index": 18}], "all_paragraphs": ["A week ago I came across an interesting paper in one of my workplace\u2019s slack channels. Don\u2019t get me wrong, I skim-read through lots of papers, but some really get my attention to go ahead and try them out.The paper I\u2019m writing about here is the Dataset Cartography: Mapping and Diagnosing Datasets with Training Dynamics. What I found interesting about this paper is that it challenges the common approach of \u201cthe more the merrier\u201d when it comes to training data, and shifts the focus from the quantity of the data to the quality of the data.In this post, I\u2019ll go over the paper, and finish up with a TensorFlow implementation.", "The article innovates by presenting methods to calculate training dynamics (named confidence, variability and correctness), for each sample in the training dataset. Using these we can diagnose our dataset with the aim of distilling the dataset to a smaller sub-set with little to no in-distribution* performance loss and better out-of-distribution* performance \u2014 which means better generalization.This method is agnostic to the type of data, but specific to classifiers optimized by stochastic gradient based methods (basically any classification neural network).", "The article continues to explore training dynamics as uncertainty measures and using training dynamics for detecting mislabeled samples. I won\u2019t talk about these two sections in this article.", "*In-distribution \u2014 Train/test data are taken from the same distribution*Out-of-distribution \u2014 Train and test come from different distributions", "The paper presents the 3 metrics named confidence, variability and correctness which are all calculated for each sample in the training set.These metrics, are being gathered while training a model in the following manner.After each epoch, a full pass over the training set is made, without gradient updates, and the probabilities for the true label for each samples are saved.Then, once training is over, for each sample we\u2019ll have a vector of size E (number of epochs).", "Confidence is defined as the mean true label probability across epochs:", "Variability is defined as the standard deviation of the true label probability across epochs:", "Correctness is the most intuitive metric and is defined as the fraction of times a sample was labeled correctly across epochs. This metric can be thought of the accuracy of a sample across epochs.", "Once we\u2019ve gathered these metrics for each sample, we can plot a \u201cdata map\u201d.Plotting a data map, the authors segment samples into three groups, easy-to-learn samples are samples with low variability and high confidence. hard-to-learn samples are samples with low variability and low confidence and lastly, ambiguous are samples of high variability.", "Once the data map is ready, the authors set up the experiments in the following way. Choose a model and create a data map for its training set. Then create 7 different datasets:", "Once the different splits are ready, they train the same model on the different training set, while evaluating on the same sets. Below are the results of RoBERTA-large on the WinoGrande dataset (train and validation) as the in-distribution (ID) dataset, and the WSC dataset as out-of-distribution (OOD) dataset. They also compare to other related works:", "The performance gain is not very large, but take into account that it shows that you can achieve the same ID performance and even better OOD performance using 33% of the data \u2014 this can be very significant when dealing with very large datasets (someone said GPT-3?) and offers a method for distilling a dataset to a smaller size.Moreover these experiments reveal the properties of ambiguous samples, which by themselves lead to better generalization and same ID performance in 33% of the training cost.", "The authors continue with another set of experiments, testing how much ambiguous is enough. Since in the previous section we saw that ambiguous samples are the ones that most contribute to OOD performance while maintaining ID performance the natural question is \u201chow low can we go\u201d with the fraction of ambiguous samples from the training set.", "The authors try different percentage of ambiguous ranging from 50% to 1% and observe the performance on the ID and OOD sets. They conclude too little ambiguous samples, and the model does not converge.To cope with that, they try to swap some of the ambiguous samples with easy-to-learn samples and observe that these swaps, building training sets with mostly ambiguous and some easy-to-learn samples, yield convergence and performance. They go on to conclude that while the role of ambiguous samples is important for generalization, including some easy-to-learn samples is important for convergence.The results:", "From my point of view, I\u2019ll start by saying that it was very interesting to discover a new source of information which I never dealt with before \u2014 training dynamics. Practically, the notion of ambiguous samples and creating models with better generalization is basically what practical ML is all about, so although not as \u201csexy\u201d concept as an article about a novel exotic architecture, I think that this work and works that will be based on it are very important. The trend of bigger and bigger datasets will only continue, as we are always advancing in the data we collect. The ability to build high-quality datasets will become more crucial with time. Lastly, having another tool for building models that generalize better is very relevant and important and what makes it more interesting, is that this tool is about the data, and not only the model.", "As I found this article interesting, I had to try it for myself. As some of my readers might already know, whatever module I build for TensorFlow and I believe would be useful across different data science application, I keep in my tested and documented PyPI package \u2014 tavolo.", "For experimenting with data maps, in tavolo I created a callback that calculates all the metrics needed for creating data maps. You can see the full notebook in my Github, usage is quite simple.", "In my experiment, I took a DistillBERT model and applied it on the QNLI dataset.The usage of the callback and training dynamics calculation in quite simple:", "Running this code on the QNLI dataset with the DistillBERT model, resulted in the following data map (taken from the notebook)", "That\u2019s it :) I hope you enjoyed reading and have learnt something new \u270c\ufe0f", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1991c3c260d6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@eliorcohen?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eliorcohen?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": "Elior Cohen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F286fb8aea313&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&user=Elior+Cohen&userId=286fb8aea313&source=post_page-286fb8aea313----1991c3c260d6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1991c3c260d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1991c3c260d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/2009.10795", "anchor_text": "Dataset Cartography: Mapping and Diagnosing Datasets with Training Dynamics"}, {"url": "https://arxiv.org/pdf/2009.10795.pdf", "anchor_text": "Dataset Cartography: Mapping and Diagnosing Datasets with Training Dynamics"}, {"url": "https://github.com/eliorc/Medium/blob/master/datamaps.ipynb", "anchor_text": "https://github.com/eliorc/Medium/blob/master/datamaps.ipynb"}, {"url": "https://arxiv.org/abs/2009.10795", "anchor_text": "Dataset Cartography: Mapping and Diagnosing Datasets with Training Dynamics"}, {"url": "https://github.com/eliorc/tavolo", "anchor_text": ""}, {"url": "https://github.com/eliorc/tavolo", "anchor_text": "tavolo"}, {"url": "https://github.com/eliorc/Medium/blob/master/datamaps.ipynb", "anchor_text": "Github"}, {"url": "https://huggingface.co/transformers/model_doc/distilbert.html", "anchor_text": "DistillBERT model"}, {"url": "https://www.tensorflow.org/datasets/catalog/glue#glueqnli", "anchor_text": "QNLI dataset"}, {"url": "https://github.com/eliorc/Medium/blob/master/datamaps.ipynb", "anchor_text": "notebook"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1991c3c260d6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1991c3c260d6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----1991c3c260d6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/dataset?source=post_page-----1991c3c260d6---------------dataset-----------------", "anchor_text": "Dataset"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1991c3c260d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&user=Elior+Cohen&userId=286fb8aea313&source=-----1991c3c260d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1991c3c260d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&user=Elior+Cohen&userId=286fb8aea313&source=-----1991c3c260d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1991c3c260d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1991c3c260d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1991c3c260d6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1991c3c260d6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1991c3c260d6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1991c3c260d6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1991c3c260d6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eliorcohen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eliorcohen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Elior Cohen"}, {"url": "https://medium.com/@eliorcohen/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F286fb8aea313&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&user=Elior+Cohen&userId=286fb8aea313&source=post_page-286fb8aea313--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a997e9c544&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-maps-datasets-can-be-distilled-too-1991c3c260d6&newsletterV3=286fb8aea313&newsletterV3Id=56a997e9c544&user=Elior+Cohen&userId=286fb8aea313&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}