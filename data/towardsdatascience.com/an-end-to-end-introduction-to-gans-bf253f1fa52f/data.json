{"url": "https://towardsdatascience.com/an-end-to-end-introduction-to-gans-bf253f1fa52f", "time": 1682996677.994703, "path": "towardsdatascience.com/an-end-to-end-introduction-to-gans-bf253f1fa52f/", "webpage": {"metadata": {"title": "An End to End Introduction to GANs | by Rahul Agarwal | Towards Data Science", "h1": "An End to End Introduction to GANs", "description": "I bet most of us have seen a lot of AI-generated people faces in recent times, be it in papers or blogs. We have reached a stage where it is becoming increasingly difficult to distinguish between\u2026"}, "outgoing_paragraph_urls": [{"url": "https://amzn.to/32FMOWF", "anchor_text": "GANs", "paragraph_index": 3}, {"url": "https://github.com/MLWhiz/data_science_blogs/tree/master/GAN_Project", "anchor_text": "Github Repository", "paragraph_index": 7}, {"url": "https://colab.research.google.com/drive/1Mxbfn0BUW4BlgEPc-minaE_M0_PaYIIX", "anchor_text": "Google Colab", "paragraph_index": 7}, {"url": "https://arxiv.org/pdf/1511.06434.pdf", "anchor_text": "UNSUPERVISED REPRESENTATION LEARNING WITH DEEP CONVOLUTIONAL GENERATIVE ADVERSARIAL NETWORKS", "paragraph_index": 9}, {"url": "https://colab.research.google.com/drive/1Mxbfn0BUW4BlgEPc-minaE_M0_PaYIIX#scrollTo=pqPNyVnSqru1", "anchor_text": "Colab", "paragraph_index": 63}, {"url": "https://amzn.to/32FMOWF", "anchor_text": "GAN", "paragraph_index": 66}, {"url": "https://coursera.pxf.io/b3rQ7m", "anchor_text": "Sequence Models", "paragraph_index": 70}, {"url": "https://coursera.pxf.io/7mKnnY", "anchor_text": "Deep Learning Specialization", "paragraph_index": 70}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium", "paragraph_index": 71}, {"url": "http://eepurl.com/dbQnuX", "anchor_text": "blog", "paragraph_index": 71}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz", "paragraph_index": 71}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 73}], "all_paragraphs": ["I bet most of us have seen a lot of AI-generated people faces in recent times, be it in papers or blogs. We have reached a stage where it is becoming increasingly difficult to distinguish between actual human faces and faces that are generated by Artificial Intelligence.", "In this post, I will help the reader to understand how they can create and build such applications on their own.", "I will try to keep this post as intuitive as possible for starters while not dumbing it down too much.", "This post is about understanding how GANs work.", "I will work on creating our own anime characters using anime characters dataset.", "The DC-GAN flavor of GANs which I will use here is widely applicable not only to generate Faces or new anime characters; it can also be used to create modern fashion styles, for general content creation and sometimes for data augmentation purposes as well.", "As per my view, GANs will change the way video games and special effects are generated. The approach could create realistic textures or characters on demand.", "You can find the full code for this chapter in the Github Repository. I have also uploaded the code to Google Colab so that you can try it yourself.", "As always before we get into the coding, it helps to delve a little bit into the theory.", "The main idea of DC-GAN\u2019s stemmed from the paper UNSUPERVISED REPRESENTATION LEARNING WITH DEEP CONVOLUTIONAL GENERATIVE ADVERSARIAL NETWORKS written in 2016 by Alec Radford, Luke Metz, and Soumith Chintala.", "Although I am going to explain the paper in the next few sections, do take a look at it. It is an excellent paper.", "Typically, GANs employ two dueling neural networks to train a computer to learn the nature of a data set well enough to generate convincing fakes.", "We can think of this as two systems where one Neural Network works to generate fakes (Generator), and another neural network (Discriminator) tries to classify which image is a fake.", "As both generator and discriminator networks do this repetitively, the networks eventually get better at their respective tasks.", "Think of this as simple as swordplay. Two noobs start sparring with each other. After a while, both become better at swordplay.", "Or you could think of this as a robber(generator) and a policeman(Discriminator). After a lot of thefts, the robber becomes better at thieving while the policeman gets better at catching the robber. In an ideal world.", "The Losses in these neural networks are primarily a function of how the other network performs:", "In the training phase, we train our Discriminator and Generator networks sequentially intending to improve both the Discriminator and Generator performance.", "The objective is to end up with weights that help Generators to generate realistic looking images. In the end, we can use the Generator Neural network to generate fake images from Random Noise.", "One of the main problems we face with GANs is that the training is not very stable. Thus we have to come up with a Generator architecture that solves our problem and also results in stable training.", "The preceding diagram is taken from the paper, which explains the DC-GAN generator architecture. It might look a little bit confusing.", "Essentially we can think of a generator Neural Network as a black box which takes as input a 100 sized normally generated vector of numbers and gives us an image:", "How do we get such an architecture?", "In the below architecture, we use a dense layer of size 4x4x1024 to create a dense vector out of this 100-d vector. Then, we reshape this dense vector in the shape of an image of 4x4 with 1024 filters, as shown in the following figure:", "We don\u2019t have to worry about any weights right now as the network itself will learn those while training.", "Once we have the 1024 4x4 maps, we do upsampling using a series of Transposed convolutions, which after each operation doubles the size of the image and halves the number of maps. In the last step, though we don\u2019t half the number of maps but reduce it to 3 channels/maps only for each RGB channel since we need three channels for the output image.", "In most simple terms, transpose convolutions provide us with a way to upsample images. While in the convolution operation we try to go from a 4x4 image to a 2x2 image, in Transpose convolutions, we convolve from 2x2 to 4x4 as shown in the following figure:", "Q: We know that Un-pooling is popularly used for upsampling input feature maps in the convolutional neural network (CNN). Why don\u2019t we use Un-pooling?", "It is because un-pooling does not involve any learning. However, transposed convolution is learnable, and that is why we prefer transposed convolutions to un-pooling. Their parameters can be learned by the generator as we will see in some time.", "Now, as we have understood the generator architecture, here is the discriminator as a black box.", "In practice, it contains a series of convolutional layers and a dense layer at the end to predict if an image is fake or not as shown in the following figure:", "Takes an image as input and predicts if it is real/fake. Every image conv net ever.", "The first thing we want to do is to look at some of the images in the dataset. The following are the python commands to visualize some of the images from the dataset:", "The resultant output is as follows:", "We get to see the sizes of the images and the images themselves.", "We also need functions to preprocess the images to a standard size of 64x64x3, in this particular case, before proceeding further with our training.", "We will also need to normalize the image pixels before we use it to train our GAN. You can see the code it is well commented.", "As you will see, we will be using the preceding defined functions in the training part of our code.", "This is the part where we define our DCGAN. We will be defining our noise generator function, Generator architecture, and Discriminator architecture.", "The following code block is a helper function to create a noise vector of predefined length for a Generator. It will generate the noise which we want to convert to an image using our generator architecture.", "The Generator is the most crucial part of the GAN.", "Here, I create a generator by adding some transposed convolution layers to upsample the noise vector to an image.", "As you will notice, this generator architecture is not the same as given in the Original DC-GAN paper.", "I needed to make some architectural changes to fit our data better, so I added a convolution layer in the middle and removed all dense layers from the generator architecture, making it fully convolutional.", "I also use a lot of Batchnorm layers with a momentum of 0.5 and leaky ReLU activation. I use Adam optimizer with \u03b2=0.5. The following code block is the function I will use to create the generator:", "You can plot the final generator model:", "Here is the discriminator architecture where I use a series of convolutional layers and a dense layer at the end to predict if an image is fake or not.", "Here is the architecture of the discriminator:", "Understanding how the training works in GAN is essential. And maybe a little interesting too.", "I start by creating our discriminator and generator using the functions defined in the previous section:", "The generator and discriminator are then combined to create the final GAN.", "This is the architecture of our whole GAN:", "This is the main region where we need to understand how the blocks we have created until now assemble and work together to work as one.", "Don\u2019t worry, I will try to break the above code step by step here. The main steps in every training iteration are:", "Step 1: Sample a batch of normalized images from the dataset directory", "Step2: Generate noise for input to the generator", "Step3: Generate images using random noise using the generator.", "Step 4: Train discriminator using generator images(Fake images) and real normalized images(Real Images) and their noisy labels.", "Step 5: Train the GAN using noise as X and 1's(noisy) as Y while keeping discriminator as untrainable.", "We repeat the steps using the for loop to end up with a good discriminator and generator.", "The final output image looks like the following. As we can see, the GAN can generate pretty good images for our content editor friends to work with.", "They might be a little crude for your liking, but still, this project was a starter for our GAN journey.", "Here is the graph generated for the losses. We can see that the GAN Loss is decreasing on average and the variance is decreasing too as we do more steps. One might want to train for even more iterations to get better results.", "You can see the output and running code in Colab:", "Given below is the code to generate some images at different training steps. As we can see, as the number of steps increases the images are getting better.", "Given below is the result of the GAN at different time steps:", "In this post, we learned about the basics of GANs. We also learned about the Generator and Discriminator architecture for DC-GANs, and we built a simple DC-GAN to generate anime images from scratch.", "This model is not very good at generating fake images, yet we get to understand the basics of GANs with this project, and we are fired up to build more exciting and complex GANs as we go forward.", "The DC-GAN flavor of GANs is widely applicable not only to generate Faces or new anime characters, but it can also be used to generate new fashion styles, for general content creation and sometimes for data augmentation purposes as well.", "We can now conjure up realistic textures or characters on demand if we have the training data at hand, and that is no small feat.", "If you want to know more about deep learning applications and use cases, take a look at the Sequence Models course in the Deep Learning Specialization by Andrew NG. Andrew is a great instructor, and this course is great too.", "I am going to be writing more of such posts in the future too. Let me know what you think about the series. Follow me up at Medium or Subscribe to my blog to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter @mlwhiz.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbf253f1fa52f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----bf253f1fa52f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbf253f1fa52f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbf253f1fa52f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://amzn.to/32FMOWF", "anchor_text": "GANs"}, {"url": "https://github.com/MLWhiz/data_science_blogs/tree/master/GAN_Project", "anchor_text": "Github Repository"}, {"url": "https://colab.research.google.com/drive/1Mxbfn0BUW4BlgEPc-minaE_M0_PaYIIX", "anchor_text": "Google Colab"}, {"url": "https://arxiv.org/pdf/1511.06434.pdf", "anchor_text": "UNSUPERVISED REPRESENTATION LEARNING WITH DEEP CONVOLUTIONAL GENERATIVE ADVERSARIAL NETWORKS"}, {"url": "https://colab.research.google.com/drive/1Mxbfn0BUW4BlgEPc-minaE_M0_PaYIIX#scrollTo=pqPNyVnSqru1", "anchor_text": "Colab"}, {"url": "https://amzn.to/32FMOWF", "anchor_text": "GAN"}, {"url": "https://coursera.pxf.io/b3rQ7m", "anchor_text": "Sequence Models"}, {"url": "https://coursera.pxf.io/7mKnnY", "anchor_text": "Deep Learning Specialization"}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium"}, {"url": "http://eepurl.com/dbQnuX", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bf253f1fa52f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----bf253f1fa52f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bf253f1fa52f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----bf253f1fa52f---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----bf253f1fa52f---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbf253f1fa52f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----bf253f1fa52f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbf253f1fa52f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----bf253f1fa52f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbf253f1fa52f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbf253f1fa52f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bf253f1fa52f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bf253f1fa52f--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-introduction-to-gans-bf253f1fa52f&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}