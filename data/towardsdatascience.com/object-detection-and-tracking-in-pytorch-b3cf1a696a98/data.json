{"url": "https://towardsdatascience.com/object-detection-and-tracking-in-pytorch-b3cf1a696a98", "time": 1682994143.424962, "path": "towardsdatascience.com/object-detection-and-tracking-in-pytorch-b3cf1a696a98/", "webpage": {"metadata": {"title": "Object detection and tracking in PyTorch | by Chris Fotache | Towards Data Science", "h1": "Object detection and tracking in PyTorch", "description": "In my previous story, I went over how to train an image classifier in PyTorch, with your own images, and then use it for image recognition. Now I\u2019ll show you how to use a pre-trained classifier to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-to-train-an-image-classifier-in-pytorch-and-use-it-to-perform-basic-inference-on-single-images-99465a1e9bf5", "anchor_text": "image classifier in PyTorch", "paragraph_index": 0}, {"url": "https://pjreddie.com/yolo/", "anchor_text": "read that here", "paragraph_index": 2}, {"url": "https://github.com/eriklindernoren/PyTorch-YOLOv3", "anchor_text": "Erik Lindernoren", "paragraph_index": 3}, {"url": "https://pjreddie.com/media/files/papers/YOLOv3.pdf", "anchor_text": "Joseph Redmon and Ali Farhadi\u2019s paper", "paragraph_index": 3}, {"url": "https://github.com/cfotache/pytorch_objectdetecttrack", "anchor_text": "Github repo", "paragraph_index": 3}, {"url": "https://github.com/pjreddie/darknet", "anchor_text": "Darknet", "paragraph_index": 4}, {"url": "https://github.com/cfotache/pytorch_objectdetecttrack", "anchor_text": "download the notebook", "paragraph_index": 8}, {"url": "https://arxiv.org/pdf/1602.00763.pdf", "anchor_text": "SORT (Simple Online and Realtime Tracking)", "paragraph_index": 10}, {"url": "https://github.com/abewley/sort", "anchor_text": "Python implementation", "paragraph_index": 10}, {"url": "https://github.com/cfotache/pytorch_objectdetecttrack", "anchor_text": "Github", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/training-yolo-for-object-detection-in-pytorch-with-your-custom-dataset-the-simple-way-1aa6f56cf7d9", "anchor_text": "Training Yolo for Object Detection on a Custom Dataset", "paragraph_index": 15}, {"url": "http://www.cynet.ai", "anchor_text": "CYNET.ai", "paragraph_index": 16}, {"url": "http://CYNET.ai", "anchor_text": "CYNET.ai", "paragraph_index": 18}], "all_paragraphs": ["In my previous story, I went over how to train an image classifier in PyTorch, with your own images, and then use it for image recognition. Now I\u2019ll show you how to use a pre-trained classifier to detect multiple objects in an image, and later track them across a video.", "What\u2019s the difference between image classification (recognition) and object detection? In classification, you identify what\u2019s the main object in the image and the entire image is classified by a single class. In detection, multiple objects are identified in the image, classified, and a location is also determined (as a bounding box).", "There are several algorithms for object detection, with YOLO and SSD among the most popular. For this story, I\u2019ll use YOLOv3. I won\u2019t get into the technical details of how YOLO (You Only Look Once) works \u2014 you can read that here \u2014 but focus instead of how to use it in your own application.", "So let\u2019s jump into the code! The Yolo detection code here is based on Erik Lindernoren\u2019s implementation of Joseph Redmon and Ali Farhadi\u2019s paper. The code snippets below are from a Jupyter Notebook you can find in my Github repo. Before you run this, you\u2019ll need to run the download_weights.sh script in the config folder to download the Yolo weights file. We start by importing the required modules:", "Then we load the pre-trained configuration and weights, as well as the class names of the COCO dataset on which the Darknet model was trained. As always in PyTorch, don\u2019t forget to set the model in eval mode after loading.", "There are also a few pre-defined values above: The image size (416px squares), confidence threshold and the non-maximum suppression threshold.", "Below is the basic function that will return detections for a specified image. Note that it requires a Pillow image as input. Most of the code deals with resizing the image to a 416px square while maintaining its aspect ratio and padding the overflow. The actual detection is in the last 4 lines.", "Finally, let\u2019s put it together by loading an image, getting the detections, and then displaying it with the bounding boxes around detected objects. Again, most of the code here deals with scaling and padding the image, as well as getting different colors for each detected class.", "You can put together these code fragments to run the code, or download the notebook from my Github. Here are a few examples of object detection in images:", "So now you know how to detect different objects in an image. The visualization might be pretty cool when you do it frame by frame in a video and you see those tracking boxes moving around. But if there are multiple objects in those video frames, how do you know if an object in one frame is the same as one in a previous frame? That\u2019s called object tracking, and uses multiple detections to identify a specific object over time.", "There are several algorithms that do it, and I decided to use SORT, which is very easy to use and pretty fast. SORT (Simple Online and Realtime Tracking) is a 2017 paper by Alex Bewley, Zongyuan Ge, Lionel Ott, Fabio Ramos, Ben Upcroft which proposes using a Kalman filter to predict the track of previously identified objects, and match them with new detections. Author Alex Bewley also wrote a versatile Python implementation that I\u2019m gonna use for this story. Make sure you download the Sort version from my Github repo since I had to make a few small changes to integrate it in my project.", "Now on to the code, the first 3 code segments will be the same as in the single image detection, since they deal with getting the YOLO detections on a single frame. The difference comes in the final part where for each detection we call the Update function of the Sort object in order to get references to the objects in the image. So instead of the regular detections from the previous example (which include the coordinates of the bounding box and a class prediction), we\u2019ll get tracked objects which, besides the parameters above, also include an object ID. Then we display the almost the same way, but adding that ID and using different colors so you can easily see the objects across the video frames.", "I also used OpenCV to read the video and display the video frames. Note that the Jupyter notebook is quite slow in processing the video. You can use it for testing and simple visualizations, but I also provided a standalone Python script that will read the source video, and output a copy with the tracked objects. Playing an OpenCV video in a notebook is not easy, so you can keep this code for other experiments.", "After you play with the notebook, you can use the regular Python script both for live processing (you can take input from a camera) and to save videos. Here\u2019s a sample of videos I generated with this program.", "And that\u2019s it, you can now try on your own to detect multiple objects in images and to track those objects across video frames.", "If you want to detect and track your own objects on a custom image dataset, you can read my next story about Training Yolo for Object Detection on a Custom Dataset.", "Chris Fotache is an AI researcher with CYNET.ai based in New Jersey. He covers topics related to artificial intelligence in our life, Python programming, machine learning, computer vision, natural language processing and more.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI researcher at CYNET.ai, writing about artificial intelligence, Python programming, machine learning, computer vision, robotics, natural language processing"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb3cf1a696a98&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://chrisfotache.medium.com/?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": ""}, {"url": "https://chrisfotache.medium.com/?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": "Chris Fotache"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F66c5402b8ebc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&user=Chris+Fotache&userId=66c5402b8ebc&source=post_page-66c5402b8ebc----b3cf1a696a98---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3cf1a696a98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3cf1a696a98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/how-to-train-an-image-classifier-in-pytorch-and-use-it-to-perform-basic-inference-on-single-images-99465a1e9bf5", "anchor_text": "image classifier in PyTorch"}, {"url": "https://pjreddie.com/yolo/", "anchor_text": "read that here"}, {"url": "https://github.com/eriklindernoren/PyTorch-YOLOv3", "anchor_text": "Erik Lindernoren"}, {"url": "https://pjreddie.com/media/files/papers/YOLOv3.pdf", "anchor_text": "Joseph Redmon and Ali Farhadi\u2019s paper"}, {"url": "https://github.com/cfotache/pytorch_objectdetecttrack", "anchor_text": "Github repo"}, {"url": "https://github.com/pjreddie/darknet", "anchor_text": "Darknet"}, {"url": "https://github.com/cfotache/pytorch_objectdetecttrack", "anchor_text": "download the notebook"}, {"url": "https://arxiv.org/pdf/1602.00763.pdf", "anchor_text": "SORT (Simple Online and Realtime Tracking)"}, {"url": "https://github.com/abewley/sort", "anchor_text": "Python implementation"}, {"url": "https://github.com/cfotache/pytorch_objectdetecttrack", "anchor_text": "Github"}, {"url": "https://towardsdatascience.com/training-yolo-for-object-detection-in-pytorch-with-your-custom-dataset-the-simple-way-1aa6f56cf7d9", "anchor_text": "Training Yolo for Object Detection on a Custom Dataset"}, {"url": "http://www.cynet.ai", "anchor_text": "CYNET.ai"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----b3cf1a696a98---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/python?source=post_page-----b3cf1a696a98---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----b3cf1a696a98---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----b3cf1a696a98---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b3cf1a696a98---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb3cf1a696a98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&user=Chris+Fotache&userId=66c5402b8ebc&source=-----b3cf1a696a98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb3cf1a696a98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&user=Chris+Fotache&userId=66c5402b8ebc&source=-----b3cf1a696a98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3cf1a696a98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb3cf1a696a98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b3cf1a696a98---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b3cf1a696a98--------------------------------", "anchor_text": ""}, {"url": "https://chrisfotache.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://chrisfotache.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chris Fotache"}, {"url": "https://chrisfotache.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "524 Followers"}, {"url": "http://CYNET.ai", "anchor_text": "CYNET.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F66c5402b8ebc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&user=Chris+Fotache&userId=66c5402b8ebc&source=post_page-66c5402b8ebc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8aead7a76a4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-and-tracking-in-pytorch-b3cf1a696a98&newsletterV3=66c5402b8ebc&newsletterV3Id=8aead7a76a4f&user=Chris+Fotache&userId=66c5402b8ebc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}