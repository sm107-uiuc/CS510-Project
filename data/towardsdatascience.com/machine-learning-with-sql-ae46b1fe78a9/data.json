{"url": "https://towardsdatascience.com/machine-learning-with-sql-ae46b1fe78a9", "time": 1683000973.8456519, "path": "towardsdatascience.com/machine-learning-with-sql-ae46b1fe78a9/", "webpage": {"metadata": {"title": "Machine Learning with SQL. This post is about Machine Learning\u2026 | by Andrej Baranovskij | Towards Data Science", "h1": "Machine Learning with SQL", "description": "It is good to know how to build/run Machine Learning with SQL in database. This is where data lives, with no additional cost we can run insights and build ML models."}, "outgoing_paragraph_urls": [{"url": "https://www.oracle.com/cloud/free/", "anchor_text": "Oracle Cloud Free Tier", "paragraph_index": 1}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.names", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/tree/master/oracleml", "anchor_text": "GitHub", "paragraph_index": 7}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/tree/master/oracleml", "anchor_text": "repo", "paragraph_index": 22}], "all_paragraphs": ["Python (and soon JavaScript with TensorFlow.js) is a dominant language for Machine Learning. What about SQL? There is a way to build/run Machine Learning models in SQL. There could be a benefit to run model training close to the database, where data stays. With SQL we can leverage strong data analysis out of the box and run algorithms without fetching data to the outside world (which could be an expensive operation in terms of performance, especially with large datasets). This post is to describe how to do Machine Learning in the database with SQL.", "I will be using Oracle autonomous DB running in Oracle Cloud Free Tier. Oracle DB comes with out of the box support for Machine Learning. Recently Oracle came up with Oracle Cloud Free Tier, which includes the database. This means we can run it for free, for production too.", "Once you are in Oracle Cloud console, go to Autonomous Data Warehouse, there you can create Always Free DB instance with ML functionality included:", "To be able to access ML environment, make sure to set up ML user. To do this, go to DB instance in Cloud console and select Service Console option:", "Then go to the administration section and select Manage Oracle ML Users option:", "There you can create a new user (with this user we will log in into Oracle ML notebook). This is DB user, it means DB schema with the same name will be created and we can login directly into DB with the same credentials:", "To be able to login directly through SQL Developer or another client (useful, when need to do data pre-processing), select DB Connection option and download client credentials:", "Connect to DB with SQL Developer and create table PIMA_INDIANS_DIABETES (read more about Pima Indians Diabetes dataset here). Populate the table with data by running SQL script from my GitHub repo for this post:", "Let\u2019s open Oracle ML notebook. Go back to Oracle Cloud console for Autonomous Data Warehouse and select Development section. Under this section, click on Oracle ML SQL Notebooks:", "In the next step, it will ask for username/password. Here you should provide the same ML user info you created in few steps before (I\u2019m using user REDSAM):", "Oracle Machine Learning home page. Click on Notebooks, this will navigate to the form to create a new notebook:", "Create a new notebook \u2014 Pima Indians Diabetes:", "Go to notebook. Within notebook you can access the same DB schema, like the one you were connecting from DB client and uploading data. Technically you can build ML model directly from SQL client. Oracle ML notebook provides a better user experience though.", "In the first step, let\u2019s fetch data from the table, to make sure we can access DB schema and see the data:", "Next, create DB tables for test and train datasets, you can fetch data directly into these tables from the main table:", "Before running the training and building model, it is recommended to clean up previously trained model, if any:", "Here we train the model, using a decision tree algorithm. Point to the table with training data and run PL/SQL function \u2014 CREATE_MODEL, the model will be built behind the scenes for you:", "Model metadata is stored in generated DB tables:", "Add the prediction column to the test table, this is where prediction results will be stored:", "Run prediction function with the trained model, results will be stored in the prediction column:", "We can calculate prediction accuracy, by comparing the predicted value with actual value in test dataset:", "Confusion matrix \u2014 this helps to understand model quality quickly:", "Oracle Machine Learning SQL notebook and data are available on my GitHub repo.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae46b1fe78a9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andrejusb.medium.com/?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b----ae46b1fe78a9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae46b1fe78a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae46b1fe78a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.oracle.com/cloud/free/", "anchor_text": "Oracle Cloud Free Tier"}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.names", "anchor_text": "here"}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/tree/master/oracleml", "anchor_text": "GitHub"}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/tree/master/oracleml", "anchor_text": "repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ae46b1fe78a9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/sql?source=post_page-----ae46b1fe78a9---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/database?source=post_page-----ae46b1fe78a9---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----ae46b1fe78a9---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/tag/infrastructure?source=post_page-----ae46b1fe78a9---------------infrastructure-----------------", "anchor_text": "Infrastructure"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae46b1fe78a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----ae46b1fe78a9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae46b1fe78a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----ae46b1fe78a9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae46b1fe78a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae46b1fe78a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae46b1fe78a9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae46b1fe78a9--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://andrejusb.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://github.com/katanaml", "anchor_text": "https://github.com/katanaml"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd22cc5338107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-sql-ae46b1fe78a9&newsletterV3=bbd1211c851b&newsletterV3Id=d22cc5338107&user=Andrej+Baranovskij&userId=bbd1211c851b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}