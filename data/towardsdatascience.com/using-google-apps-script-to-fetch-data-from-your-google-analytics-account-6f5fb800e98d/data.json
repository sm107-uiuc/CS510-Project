{"url": "https://towardsdatascience.com/using-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d", "time": 1682993363.457799, "path": "towardsdatascience.com/using-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d/", "webpage": {"metadata": {"title": "Using Google Apps Script to fetch data from your Google Analytics account | by Dimitris Vogiatzis | Towards Data Science", "h1": "Using Google Apps Script to fetch data from your Google Analytics account", "description": "Google Analytics needs no introduction. Definitely the most popular web analytics service on the Internet, helping businesses to collect and analyze data and use them to grow and enhance their\u2026"}, "outgoing_paragraph_urls": [{"url": "https://support.google.com/analytics/answer/1033013?hl=en", "anchor_text": "custom report", "paragraph_index": 0}, {"url": "https://developers.google.com/apps-script/", "anchor_text": "Google Apps Script", "paragraph_index": 2}, {"url": "https://ga-dev-tools.appspot.com/query-explorer/", "anchor_text": "Query Explorer", "paragraph_index": 6}, {"url": "https://developers.google.com/analytics/devguides/reporting/core/v3/reference", "anchor_text": "For a complete reference to these arguments you can check out the documentation here.", "paragraph_index": 9}, {"url": "https://www.amplifyd.co.uk/", "anchor_text": "drop us a line", "paragraph_index": 17}], "all_paragraphs": ["Google Analytics needs no introduction. Definitely the most popular web analytics service on the Internet, helping businesses to collect and analyze data and use them to grow and enhance their services or products. The most common way to access Google Analytics data is through the main dashboard and predefined reports. In order to manipulate the data and extract more valuable insights, you can create a standard or custom report to present the data you need and then export them usually to a spreadsheet. The way to do this is by using the export capability (PDF, Google Sheets, Excel or CSV format) offered in the GA console and then import the file to Google Spreadsheets or any other spreadsheet software.", "But what if you need to do this for multiple files or do it periodically during a time period (e.g to generate periodic reports). It\u2019s a pain isn\u2019t it? Well, Google Apps Scripts to the rescue! \ud83d\udcaa\ud83d\udcaa", "So, what is Google Apps Script? Google Apps Script is a JavaScript cloud scripting language that provides easy ways to automate tasks across G-Suite products and third party services and build web applications. In simple words, using JavaScript we can increase the power of our favourite and already powerful Google Apps like Spreadsheets, Docs, Calendar, Mail etc. In our case we will focus on the integration between Google Spreadsheets and Google Apps Scripts. To access the Script Editor, where we can build our application, we can create a new spreadsheet, and from the top menu we can click at Tools > Script Editor.", "The above option will open a new tab with the Script Editor Console. Using this console we can build our application, create script files, connect resources etc. In our case we will use Google Analytics API as a resource to fetch the data we need. To enable the connection between Google Spreadsheets and Google Analytics API we must follow the below steps:", "5. Don\u2019t hurry up to close the window yet. In order to gain full access we must also enable our service of choice in the Google API Console. If we click the link provided we will be redirected directly to the GCP console and by searching \u201cAnalytics API\u201d on the top search bar we will find our service of choice.", "6. Click Enable and you are good to go! \ud83d\udc4f", "When dealing with data and reports, the top priority is our data to be consistent and trustworthy. It takes a long to build someone\u2019s trust on your data but just a minute to lose it. Our best friend in this process is a very useful tool by Google called Query Explorer. Query Explorer helps us play with Google Analytics data by querying with various parameters and test the responses. We can choose the Account \u2014 Property \u2014 View we want to query the data and just add the parameters (start-date, end-date, metrics, dimensions, filters, segments e.t.c). We can then download the data in TSV format (tab-delimited file), or save the direct API Query URI to this report. Querying the data through Google Apps Script is a way to simulate Query Explorer data and personally I always have the Query Explorer open in a tab to validate the queries.", "Enough talk. Let\u2019s dive into action. After we created our project and enabled the Analytics API, the next step is to actually build the script to fetch the data we need. We will need 2 tabs constantly within a click away.", "In order to query the data from Google Analytics we need the below function. The function takes 5 arguments as an input and returns a report as an output.", "*Note: For a complete reference to these arguments you can check out the documentation here.", "The core command from the above script that we should care the most is:", "This is the command that actually query the data from Google Analytics and returns the report. All the other part of the snippet is just for handling any possible error.", "So in our use case we are going to fetch some core metrics like pageviews, avg. time on page and bounce rate for the top 5 pages of our website and write it on a sheet of our spreadsheet. To do this you need to copy the below script and paste it into the Apps Script Console.", "*Note: You need to specify your own values for the name of the sheet (not the Spreadsheet), the table id to query from (you can get that from Query Explorer by selecting Account \u2014 Property \u2014 View) and the start and end date of the query.", "After you pasted the above script and added your own parameters, choose Run > Run function > main. Authenticate if needed and voil\u00e0! Your data are available on the spreadsheet. In the first column we see the page and the next three columns are Pageviews, Average Time On Page and Bounce Rate respectively as we declared them in our \u2018metrics\u2019 array.", "In this little post we\u2019ve seen a simple way to query data from Google Analytics and write it in Google Spreadsheets using Apps Scripts. Of course the power of Apps Scripts is limitless and can do much more than fetch simple data. Get your hands dirty and as you get more and more comfortable to use Apps Script you will realise how much more you can achieve and how many tasks and reports you can automate.", "P.S: The guide is updated to match recent changes.", "If you need help or looking into optimizing your tracking and analytics setup drop us a line! We support clients of all fields and sizes with great success and we\u2019re able to demonstrate high quality results. Our procedure and experience ensure that you\u2019ll be able to find, track, test and analyze all the important parts and have a holistic view of your business performance.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech Lead; Passionate about Data and Analytics; Curious about everything."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6f5fb800e98d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dvogiatzis.medium.com/?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": ""}, {"url": "https://dvogiatzis.medium.com/?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": "Dimitris Vogiatzis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d6080978141&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&user=Dimitris+Vogiatzis&userId=9d6080978141&source=post_page-9d6080978141----6f5fb800e98d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f5fb800e98d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f5fb800e98d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mjessier?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Myriam Jessier"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://support.google.com/analytics/answer/1033013?hl=en", "anchor_text": "custom report"}, {"url": "https://developers.google.com/apps-script/", "anchor_text": "Google Apps Script"}, {"url": "https://ga-dev-tools.appspot.com/query-explorer/", "anchor_text": "Query Explorer"}, {"url": "https://ga-dev-tools.appspot.com/query-explorer/", "anchor_text": "Query Explorer"}, {"url": "https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app", "anchor_text": "Google Apps Script Spreadsheet reference"}, {"url": "https://developers.google.com/analytics/devguides/reporting/core/v3/reference", "anchor_text": "For a complete reference to these arguments you can check out the documentation here."}, {"url": "https://www.amplifyd.co.uk/", "anchor_text": "drop us a line"}, {"url": "https://medium.com/tag/analytics?source=post_page-----6f5fb800e98d---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/google-apps-script?source=post_page-----6f5fb800e98d---------------google_apps_script-----------------", "anchor_text": "Google Apps Script"}, {"url": "https://medium.com/tag/google-spreadsheets?source=post_page-----6f5fb800e98d---------------google_spreadsheets-----------------", "anchor_text": "Google Spreadsheets"}, {"url": "https://medium.com/tag/javascript?source=post_page-----6f5fb800e98d---------------javascript-----------------", "anchor_text": "JavaScript"}, {"url": "https://medium.com/tag/google-analytics?source=post_page-----6f5fb800e98d---------------google_analytics-----------------", "anchor_text": "Google Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6f5fb800e98d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&user=Dimitris+Vogiatzis&userId=9d6080978141&source=-----6f5fb800e98d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6f5fb800e98d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&user=Dimitris+Vogiatzis&userId=9d6080978141&source=-----6f5fb800e98d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f5fb800e98d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6f5fb800e98d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6f5fb800e98d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6f5fb800e98d--------------------------------", "anchor_text": ""}, {"url": "https://dvogiatzis.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dvogiatzis.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dimitris Vogiatzis"}, {"url": "https://dvogiatzis.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d6080978141&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&user=Dimitris+Vogiatzis&userId=9d6080978141&source=post_page-9d6080978141--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1a30e2498037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-google-apps-script-to-fetch-data-from-your-google-analytics-account-6f5fb800e98d&newsletterV3=9d6080978141&newsletterV3Id=1a30e2498037&user=Dimitris+Vogiatzis&userId=9d6080978141&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}