{"url": "https://towardsdatascience.com/deploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff", "time": 1682993953.3161469, "path": "towardsdatascience.com/deploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff/", "webpage": {"metadata": {"title": "Deploying a Keras Deep Learning Model as a Web Application in Python | by Will Koehrsen | Towards Data Science", "h1": "Deploying a Keras Deep Learning Model as a Web Application in Python", "description": "Building a cool machine learning project is one thing, but at the end of the day, you want other people to be able to see your hard work. Sure, you could put the whole project on GitHub, but how are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/p/ffd204f99470?source=user_profile---------6------------------", "anchor_text": "Recurrent Neural Networks by Example", "paragraph_index": 1}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks", "anchor_text": "available on GitHub", "paragraph_index": 5}, {"url": "https://blog.keras.io/building-a-simple-keras-deep-learning-rest-api.html", "anchor_text": "This article", "paragraph_index": 6}, {"url": "https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2", "anchor_text": "this article", "paragraph_index": 6}, {"url": "http://flask.pocoo.org", "anchor_text": "Flask", "paragraph_index": 8}, {"url": "https://wtforms.readthedocs.io/", "anchor_text": "wtforms", "paragraph_index": 11}, {"url": "http://jinja.pocoo.org/", "anchor_text": "Jinja templating library", "paragraph_index": 15}, {"url": "https://gist.github.com/eyesonlyhack/2f0b20f1e73aaf5e9b83f49415f3601a", "anchor_text": "based on this gist.", "paragraph_index": 21}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/deployment/utils.py", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2", "anchor_text": "app up on an AWS EC2 instance", "paragraph_index": 30}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/deployment/static/css/main.css", "anchor_text": "main.css", "paragraph_index": 31}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks/tree/master/models", "anchor_text": "pre-trained network", "paragraph_index": 31}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks", "anchor_text": "the code", "paragraph_index": 31}, {"url": "https://www.python.org/", "anchor_text": "Python", "paragraph_index": 32}, {"url": "http://twitter.com/@koehrsen_will", "anchor_text": "@koehrsen_will", "paragraph_index": 34}, {"url": "https://willk.online", "anchor_text": "willk.online.", "paragraph_index": 34}], "all_paragraphs": ["Building a cool machine learning project is one thing, but at the end of the day, you want other people to be able to see your hard work. Sure, you could put the whole project on GitHub, but how are your grandparents supposed to figure that out? No, what we want is to deploy our deep learning model as a web application accessible to anyone in the world.", "In this article, we\u2019ll see how to write a web application that takes a trained Keras recurrent neural network and allows users to generate new patent abstracts. This project builds on work from the Recurrent Neural Networks by Example article, but knowing how to create the RNN isn\u2019t necessary. We\u2019ll just treat it as a black box for now: we put in a starting sequence, and it outputs an entirely new patent abstract that we can display in the browser!", "Traditionally, data scientists develop the models and front end engineers show them to the world. In this project, we\u2019ll have to play both roles, and dive into web development (almost all in Python though).", "This project requires joining together numerous topics:", "The final result is a web application that allows users to generate entirely new patent abstracts with a trained recurrent neural network:", "The complete code for this project is available on GitHub.", "The goal was to get a web application up and running as quickly as possible. For that, I went with Flask, which allows us to write the app in Python. I don\u2019t like to mess with styling (which clearly shows) so almost all of the CSS is copied and pasted. This article by the Keras team was helpful for the basics and this article is a useful guide as well.", "Overall, this project adheres to my design principles: get a prototype up and running quickly \u2014 copying and pasting as much as required \u2014 and then iterate to make a better product.", "The quickest way to build a web app in Python is with Flask. To make our own app, we can use just the following:", "If you copy and paste this code and run it, you\u2019ll be able to view your own web app at localhost:50000. Of course, we want to do more than that, so we\u2019ll use a slightly more complicated function which basically does the same thing: handles requests from your browser and serves up some content as HTML. For our main page, we want to present the user with a form to enter some details.", "When our users arrive at the main page of the application, we\u2019ll show them a form with three parameters to select:", "To build a form in Python we\u2019ll use wtforms .The code to make the form is:", "This creates a form shown below (with styling from main.css):", "The validator in the code make sure the user enters the correct information. For example, we check all boxes are filled and that the diversity is between 0.5 and 5. These conditions must be met for the form to be accepted.", "The way we actually serve the form is with Flask is using templates.", "A template is a document with a basic framework that we need to fill in with details. For a Flask web application, we can use the Jinja templating library to pass Python code to an HTML document. For example, in our main function, we\u2019ll send the contents of the form to a template called index.html.", "When the user arrives on the home page, our app will serve up index.html with the details from form. The template is a simple html scaffolding where we refer to python variables with {{variable}} syntax.", "For each of the errors in the form (those entries that can\u2019t be validated) an error will flash. Other than that, this file will show the form as above.", "When the user enters information and hits submit (a POST request) if the information is correct, we want to divert the input to the appropriate function to make predictions with the trained RNN. This means modifying home() .", "Now, when the user hits submit and the information is correct, the input is sent either to generate_random_start or generate_from_seed depending on the input. These functions use the trained Keras model to generate a novel patent with a diversity and num_words specified by the user. The output of these functions in turn is sent to either of the templates random.html or seeded.html to be served as a web page.", "The model parameter is the trained Keras model which load in as follows:", "(The tf.get_default_graph() is a workaround based on this gist.)", "I won\u2019t show the entirety of the two util functions (here is the code), and all you need to understand is they take the trained Keras model along with the parameters and make predictions of a new patent abstract.", "These functions both return a Python string with formatted HTML. This string is sent to another template to be rendered as a web page. For example, the generate_random_start returns formatted html which goes into random.html:", "Here we are again using the Jinja template engine to display the formatted HTML. Since the Python string is already formatted as HTML, all we have to do is use {{input|safe}} (where input is the Python variable) to display it. We can then style this page in main.css as with the other html templates.", "The functiongenerate_random_start picks a random patent abstract as the starting sequence and makes predictions building from it. It then displays the starting sequence, RNN generated output, and the actual output:", "The functiongenerate_from_seed takes a user-supplied starting sequence and then builds off of it using the trained RNN. The output appears as follows:", "While the results are not always entirely on-point, they do show the recurrent neural network has learned the basics of English. It was trained to predict the next word from the previous 50 words and has picked up how to write a slightly-convincing patent abstract! Depending on the diversity of the predictions, the output might appear to be completely random or a loop.", "To run the app for yourself, all you need to do is download the repository, navigate to the deployment directory and type python run_keras_server.py . This will immediately make the web app available at localhost:10000.", "Depending on how your home WiFi is configured, you should be able to access the application from any computer on the network using your IP address.", "The web application running on your personal computer is great for sharing with friends and family. I\u2019d definitely not recommend opening this up to everyone on your home network though! For that, we\u2019ll want to set the app up on an AWS EC2 instance and serve it to the world (coming later) .", "To improve the app, we can alter the styling (through main.css ) and perhaps add more options, such as the ability to choose the pre-trained network. The great thing about personal projects is you can take them as far as you want. If you want to play around with the app, download the code and get started.", "In this article, we saw how to deploy a trained Keras deep learning model as a web application. This requires bringing together a number of different technologies including recurrent neural networks, web applications, templating, HTML, CSS, and of course Python.", "While this is only a basic application, it shows that you can start building web applications using deep learning with relatively little effort. There aren\u2019t many people who can say they\u2019ve deployed a deep learning model as a web application, but if you follow this article, count yourself among them!", "As always, I welcome feedback and constructive criticism. I can be reached on Twitter @koehrsen_will or through my personal website willk.online.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Cortex Intel, Data Science Communicator"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffc0f2354a7ff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://williamkoehrsen.medium.com/?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": ""}, {"url": "https://williamkoehrsen.medium.com/?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": "Will Koehrsen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2f299e30cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&user=Will+Koehrsen&userId=e2f299e30cb9&source=post_page-e2f299e30cb9----fc0f2354a7ff---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc0f2354a7ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc0f2354a7ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/photo/sky-landmark-clouds-space-88214/", "anchor_text": "Source"}, {"url": "https://medium.com/p/ffd204f99470?source=user_profile---------6------------------", "anchor_text": "Recurrent Neural Networks by Example"}, {"url": "http://flask.pocoo.org/", "anchor_text": "Flask:"}, {"url": "http://keras.io", "anchor_text": "Keras:"}, {"url": "http://jinja.pocoo.org/", "anchor_text": "Jinja"}, {"url": "https://www.w3schools.com/html/", "anchor_text": "HTML"}, {"url": "https://www.w3schools.com/html/html_css.asp", "anchor_text": "CSS"}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks", "anchor_text": "available on GitHub"}, {"url": "https://blog.keras.io/building-a-simple-keras-deep-learning-rest-api.html", "anchor_text": "This article"}, {"url": "https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2", "anchor_text": "this article"}, {"url": "http://flask.pocoo.org", "anchor_text": "Flask"}, {"url": "https://wtforms.readthedocs.io/", "anchor_text": "wtforms"}, {"url": "http://jinja.pocoo.org/", "anchor_text": "Jinja templating library"}, {"url": "https://gist.github.com/eyesonlyhack/2f0b20f1e73aaf5e9b83f49415f3601a", "anchor_text": "based on this gist."}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/deployment/utils.py", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2", "anchor_text": "app up on an AWS EC2 instance"}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/deployment/static/css/main.css", "anchor_text": "main.css"}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks/tree/master/models", "anchor_text": "pre-trained network"}, {"url": "https://github.com/WillKoehrsen/recurrent-neural-networks", "anchor_text": "the code"}, {"url": "https://www.python.org/", "anchor_text": "Python"}, {"url": "http://twitter.com/@koehrsen_will", "anchor_text": "@koehrsen_will"}, {"url": "https://willk.online", "anchor_text": "willk.online."}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fc0f2354a7ff---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fc0f2354a7ff---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fc0f2354a7ff---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/education?source=post_page-----fc0f2354a7ff---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/web-development?source=post_page-----fc0f2354a7ff---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc0f2354a7ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&user=Will+Koehrsen&userId=e2f299e30cb9&source=-----fc0f2354a7ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc0f2354a7ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&user=Will+Koehrsen&userId=e2f299e30cb9&source=-----fc0f2354a7ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc0f2354a7ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffc0f2354a7ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fc0f2354a7ff---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fc0f2354a7ff--------------------------------", "anchor_text": ""}, {"url": "https://williamkoehrsen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://williamkoehrsen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Will Koehrsen"}, {"url": "https://williamkoehrsen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "38K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2f299e30cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&user=Will+Koehrsen&userId=e2f299e30cb9&source=post_page-e2f299e30cb9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe7d4a87a913e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff&newsletterV3=e2f299e30cb9&newsletterV3Id=e7d4a87a913e&user=Will+Koehrsen&userId=e2f299e30cb9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}