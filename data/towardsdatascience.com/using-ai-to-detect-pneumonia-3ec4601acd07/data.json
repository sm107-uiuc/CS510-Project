{"url": "https://towardsdatascience.com/using-ai-to-detect-pneumonia-3ec4601acd07", "time": 1683011285.3141959, "path": "towardsdatascience.com/using-ai-to-detect-pneumonia-3ec4601acd07/", "webpage": {"metadata": {"title": "Image Classification: Using AI to Detect Pneumonia | by Samuel Mohebban | Towards Data Science", "h1": "Image Classification: Using AI to Detect Pneumonia", "description": "A tutorial on how to create a convolutional neural network that detects Pneumonia within an X-ray image"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/the-sports-scientist/using-ai-to-hack-your-fantasy-lineup-2fe022886769", "anchor_text": "my last blog", "paragraph_index": 0}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection", "anchor_text": "GitHub", "paragraph_index": 2}, {"url": "https://drive.google.com/file/d/1QM5NqLIFuYIwCjUwtl5jM24YVHs3L4Kb/view?usp=sharing", "anchor_text": "GoogleDrive", "paragraph_index": 3}, {"url": "https://drive.google.com/drive/folders/1XsUTrl65JuLQvQeoSGvxqPHvZCWb6tM7?usp=sharing", "anchor_text": "GoogleDrive", "paragraph_index": 5}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection", "anchor_text": "GitHub", "paragraph_index": 9}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection/blob/master/CNN.ipynb", "anchor_text": "code", "paragraph_index": 11}], "all_paragraphs": ["In my last blog, I showed you guys how to create a neural network that can predict an NBA player\u2019s performance on any given night. Although it was a very fun project, I was unable to test it on a regular-season due to COVID-19. Considering the global pandemic, I was really hesitant about starting a new project as this year can be considered an outlier in not just sports, but also for financial and sentiment analysis. With this problem, I started searching through Kaggle and came across a data set filled with X-ray images of both normal and non-normal lungs (Pneumonia). This intrigued me, so I continued searching for more databases and found more labeled photos. I was able to combine two datasets into a single folder (no duplicates), totaling to 6,000 images. Using these images, I will show you how to create a Convolutional Neural Network that can predict whether a person has Pneumonia with a ~98% accuracy (test set).", "Although we see images with color and shapes, in their most basic level they are lists of numbers, each number corresponding to an RGB value which is then processed by your computer to show you the image. Convolutional neural networks have gained traction in image processing because they are able to split the RGB array into (1x1), (2x2), or (3x3) pixels in order to learn patterns within an image", "**All the code shown below can be found on my GitHub***", "The dataset with the .csv was too large to upload to my GitHub, so instead, I made it public on my GoogleDrive.", "Because this is my first image classification project, understanding an architecture for properly splitting the data into test and train took me a few hours to grasp- especially since I gathered data from multiple sources. The approach I ended up taking was this:(1) I first created a CSV file with the paths and labels for each image (2) Split the train and test as I normally would, stratifying each group based on their labels, (3) Then I iterated through each image path and extracted its RGB values", "Grabbing each image and its RGB array can take a few minutes depending on the speed of your computer, so I pickled each sample to avoid doing this every time I wanted to train a new model (GoogleDrive).", "After saving the pickles, it is now time to move onto building the neural network. Below is a screenshot of the model architecture. ReLU activation function was used for every layer except the output layer. Sigmoid was used for the activation layer because the classification set is binary.", "I found sigmoid activation to be better for this model as it is more accurate for binary classification. If you were to tweak this model to predict the type of pneumonia (viral, fungal, etc.), then a softmax activation would be better for the output layer, and using categorical_crossentropy would be better than binary_crossentropy.", "Running the cell below in the same notebook with start the training process. early_stopping will prevent the model from overfitting while model checkpoint saves weights every time val_loss decreases.", "The model checkpoint parameter was able to stop the model at 30 epochs to prevent from overfitting further. Looking at the graph below, we see the train and test accuracy remained steady above 96%. However, one thing I learned is never to take accuracy at face value. To better investigate the model\u2019s performance, I plotted AUC, ROC, and decision boundary curves to determine how the model changes using different thresholds. Again, all the code for these graphs can be found on my GitHub.", "Before choosing a threshold, it is first important to understand the context of the problem you are trying to solve and how this can affect your desired outcome. In our case, we wish to classify Pneumonia when it is present. On the other hand, it is not so bad if we classify a normal lung as having pneumonia as long as we are detecting pneumonia more often than not. Deciding the decision threshold for this problem is choosing between the best that yields the lowest cost- which differs in every machine learning problem. Below, you can see the confusion matrix for the different thresholds .2, .5, and .6", "To test the model on outside data, I gathered 17 images from Google and used a probability threshold of .65. As you can see below, the model had a 100% True Positive rate and 56% True Negative rate. If you download the code in my repo, there is a folder where you can try a prediction yourself. All you have to do is download the image, name the file normal or non-normal to remember its label, then run the code.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Senior Machine Learning Engineer | BA George Washington University | MS Stevens Institute of Technology"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3ec4601acd07&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@HeeebsInc?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@HeeebsInc?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": "Samuel Mohebban"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcaf4b32fe258&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&user=Samuel+Mohebban&userId=caf4b32fe258&source=post_page-caf4b32fe258----3ec4601acd07---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3ec4601acd07&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3ec4601acd07&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.drbeen.com/blog/the-basics-of-chest-x-ray-interpretation/", "anchor_text": "Source"}, {"url": "https://medium.com/the-sports-scientist/using-ai-to-hack-your-fantasy-lineup-2fe022886769", "anchor_text": "my last blog"}, {"url": "https://www.kaggle.com/praveengovi/coronahack-chest-xraydataset", "anchor_text": "Kaggle"}, {"url": "https://github.com/HeeebsInc/covid-chestxray-dataset", "anchor_text": "GitHub"}, {"url": "https://drive.google.com/drive/folders/1XsUTrl65JuLQvQeoSGvxqPHvZCWb6tM7?usp=sharing", "anchor_text": "GoogleDrive"}, {"url": "https://www.mdpi.com/2076-3417/9/21/4500/htm", "anchor_text": "Van Hiep Phung, et. al"}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection", "anchor_text": "GitHub"}, {"url": "https://drive.google.com/file/d/1QM5NqLIFuYIwCjUwtl5jM24YVHs3L4Kb/view?usp=sharing", "anchor_text": "GoogleDrive"}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection/blob/master/Train_Test.ipynb", "anchor_text": "Train Test Split"}, {"url": "https://drive.google.com/drive/folders/1XsUTrl65JuLQvQeoSGvxqPHvZCWb6tM7?usp=sharing", "anchor_text": "GoogleDrive"}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection/blob/master/CNN.ipynb", "anchor_text": "CNN Model"}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection/blob/master/CNN.ipynb", "anchor_text": "Running the model"}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection", "anchor_text": "GitHub"}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection/blob/master/CNN.ipynb", "anchor_text": "code"}, {"url": "https://github.com/HeeebsInc/NN_Pneumonia_Detection/blob/master/CNN.ipynb", "anchor_text": "Predictions using images from Google"}, {"url": "https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/", "anchor_text": "SMOTE"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3ec4601acd07---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/medicine?source=post_page-----3ec4601acd07---------------medicine-----------------", "anchor_text": "Medicine"}, {"url": "https://medium.com/tag/aimedicalimaging?source=post_page-----3ec4601acd07---------------aimedicalimaging-----------------", "anchor_text": "Aimedicalimaging"}, {"url": "https://medium.com/tag/ai?source=post_page-----3ec4601acd07---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/python?source=post_page-----3ec4601acd07---------------python-----------------", "anchor_text": "Python"}, {"url": "http://creativecommons.org/licenses/by/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3ec4601acd07&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&user=Samuel+Mohebban&userId=caf4b32fe258&source=-----3ec4601acd07---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3ec4601acd07&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&user=Samuel+Mohebban&userId=caf4b32fe258&source=-----3ec4601acd07---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3ec4601acd07&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3ec4601acd07&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3ec4601acd07---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3ec4601acd07--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3ec4601acd07--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3ec4601acd07--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3ec4601acd07--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@HeeebsInc?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@HeeebsInc?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samuel Mohebban"}, {"url": "https://medium.com/@HeeebsInc/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "63 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcaf4b32fe258&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&user=Samuel+Mohebban&userId=caf4b32fe258&source=post_page-caf4b32fe258--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe57400756dca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-ai-to-detect-pneumonia-3ec4601acd07&newsletterV3=caf4b32fe258&newsletterV3Id=e57400756dca&user=Samuel+Mohebban&userId=caf4b32fe258&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}