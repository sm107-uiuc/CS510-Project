{"url": "https://towardsdatascience.com/day-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599", "time": 1683005636.836879, "path": "towardsdatascience.com/day-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599/", "webpage": {"metadata": {"title": "Day 101 of #NLP365: In-Depth Study Of RASA\u2019s DIET Architecture | by Ryan Ong | Towards Data Science", "h1": "Day 101 of #NLP365: In-Depth Study Of RASA\u2019s DIET Architecture", "description": "Hi everyone, my name is Ryan. I work as a Data Scientist in London. I am very passionate about Natural Language Processing (NLP) and I am currently working on project #NLP365 (+1), where I document\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ryanong.co.uk/natural-language-processing-365/", "anchor_text": "here", "paragraph_index": 0}, {"url": "http://jalammar.github.io/illustrated-transformer/", "anchor_text": "here", "paragraph_index": 8}, {"url": "http://www.ryanong.co.uk", "anchor_text": "www.ryanong.co.uk", "paragraph_index": 16}, {"url": "https://ryanocm.substack.com/", "anchor_text": "https://ryanocm.substack.com/", "paragraph_index": 16}], "all_paragraphs": ["Hi everyone, my name is Ryan. I work as a Data Scientist in London. I am very passionate about Natural Language Processing (NLP) and I am currently working on project #NLP365 (+1), where I document my NLP learning journey every single day in 2020. Feel free to check out what I have been learning over the last 100 days here.", "Today\u2019s post is covering the RASA\u2019s DIET architecture. I really like the RASA\u2019s DIET architecture and although I found the RASA\u2019s explanation videos to be very informative, I don\u2019t want to have to rewatch the entire video when revisiting the DIET architecture in the future so below are all my notes of the RASA\u2019s DIET :)", "DIET stands for Dual Intent and Entity Transformer. DIET is a multi-task transformer architecture that can perform both intent classification and entities recognition together. It is made of multiple components that allows us to have the flexibility to exchange different components. For example, we could experiment with using different word embeddings such as BERT and GloVe.", "A lot of the pre-trained language models are very heavy in the sense it requires large compute power and inference time is long and so despite their strong performance, they aren\u2019t design for conversational AI applications. DIET is different as it:", "First of all, what training data do we need to train the DIET model? The architecture requires the dataset to have the input text, label(s) of intent(s) and label(s) of entities.", "The architecture has many components and it has a total loss to optimise (minimise) that is made up of three losses:", "How\u2019s the input sentences link to the entity loss during training? Below are the layers linking the input sentences to the entity loss:", "The output of the two sub-pathways are merge together and feed into another FFNN. The output of the FFNN is a 256-dimension vector.", "The outputs of the individual token pathway are feed into a 2-layer transformer layer. Click here for a good article on transformers. Subsequently, the outputs of the transformer layer are feed into the conditional random field (CRF) layer. Inside the CRF, we have a FFNN that takes the output of the transformer layer and classify what entity is the output. For example, the word \u201cping\u201d has the entity of game_name. In between these FFNN, we have a transition matrix. The idea behind the transition matrix is to capture the situation where if there\u2019s a token that\u2019s an entity, its neighbouring tokens has a high probability to be an entity too. For each token, we have the label of the ground-truth entity and this can be used during training to train both our FFNN and the transition matrix (their weights).", "There is a special class token (__CLS__) in the DIET architecture figure above. The idea behind this special class token is that it would summarise the entire input sentence and derive a numerical representation that represents the whole input sentence. This special class token follows the same pathway as the individual tokens, however, the output of the pretrained embeddings and sparse features are slightly different:", "Since the class token is the summarisation of the entire input sentence, the class token should be able to predict the intent. The special class token will go through the individual token pathway, the transformer layer, and then through to the embedding layer. Concurrently, the ground-truth intent of the input sentence goes through the embedding layer. Similarity (and so intent loss) is being computed between the output of the two embedding layers.", "The addition of this mask token in the architecture is so that the model can also be train as a language model. A language model is where the model predicts the most suitable next token given a set of input tokens. During training, the model would randomly mask some words and it would be the objective of the algorithm to predict what\u2019s the original word that was being masked. The diagram below shows how this works. The mask token will passed through the transformer and into an embedding layer. Concurrently, the masked token (the word pong in the figure) goes through the individual token pathway and also into an embedding layer. A similarity function is computed between these two embeddings. One of the objectives of the model is to minimise the mask loss. The lower the mask loss, the better the model is in predicting the masked token.", "Two special note about all the FFNN in the architecture. Firstly, they are NOT fully connected. The FFNN has a dropout rate of around 80% from the beginning. This makes the FFNN more lightweight. Secondly, ALL the FFNN share the same weight. All the FFNN post sparse features share weights (W1) and all the FFNN post merging the output of the two paths share another set of weights (W2).", "Why are they using mask token and training a language model again when they are already using pre-trained models? To allow the model to adapt to the domain of the dataset. Especially in a chatbot or social media context, there are more misspelled words or slangs or commanding texts and so training a language model again would allow the model to capture these domain specific language.", "The architecture is designed to allow the model to learn a more general representation of our input sentences. During training, all the weights have to be optimised based on three different losses: entity, intent, and mask loss and as such, the model can\u2019t just learn a representation that heavily minimises one of the losses. In addition, the architecture is designed in such a way that you can switch on or off multiple components. The architecture is designed to handle intent and entity classification but if we just want the model to do intent classification, we can \u201cswitch\u201d off the entity and mask loss and just focuses on optimising the intent loss during training. I thoroughly enjoy learning about the RASA\u2019s DIET model and the next step is to experiment with the RASA library.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD CS Student @ Imperial College London | www.ryanong.co.uk | Subscribe to my Second Brain newsletter @ https://ryanocm.substack.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3cdc10601599&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3cdc10601599--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3cdc10601599--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ryan.m.ong?source=post_page-----3cdc10601599--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.m.ong?source=post_page-----3cdc10601599--------------------------------", "anchor_text": "Ryan Ong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97c118547987&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&user=Ryan+Ong&userId=97c118547987&source=post_page-97c118547987----3cdc10601599---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3cdc10601599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3cdc10601599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/towards-data-science/inside-ai/home", "anchor_text": "Inside AI"}, {"url": "https://towardsdatascience.com/tagged/nlp365", "anchor_text": "NLP365"}, {"url": "https://ryanong.co.uk/natural-language-processing-365/", "anchor_text": "here"}, {"url": "http://jalammar.github.io/illustrated-transformer/", "anchor_text": "here"}, {"url": "https://blog.rasa.com/introducing-dual-intent-and-entity-transformer-diet-state-of-the-art-performance-on-a-lightweight-architecture/", "anchor_text": "https://blog.rasa.com/introducing-dual-intent-and-entity-transformer-diet-state-of-the-art-performance-on-a-lightweight-architecture/"}, {"url": "https://www.youtube.com/watch?v=vWStcJDuOUk&list=PL75e0qA87dlG-za8eLI6t0_Pbxafk-cxb", "anchor_text": "https://www.youtube.com/watch?v=vWStcJDuOUk&list=PL75e0qA87dlG-za8eLI6t0_Pbxafk-cxb"}, {"url": "https://www.youtube.com/watch?v=KUGGuJ0aTL8&list=PL75e0qA87dlG-za8eLI6t0_Pbxafk-cxb&index=3", "anchor_text": "https://www.youtube.com/watch?v=KUGGuJ0aTL8&list=PL75e0qA87dlG-za8eLI6t0_Pbxafk-cxb&index=3"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3cdc10601599---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----3cdc10601599---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3cdc10601599---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/nlp365?source=post_page-----3cdc10601599---------------nlp365-----------------", "anchor_text": "Nlp365"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3cdc10601599---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3cdc10601599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&user=Ryan+Ong&userId=97c118547987&source=-----3cdc10601599---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3cdc10601599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&user=Ryan+Ong&userId=97c118547987&source=-----3cdc10601599---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3cdc10601599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3cdc10601599--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3cdc10601599&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3cdc10601599---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3cdc10601599--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3cdc10601599--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3cdc10601599--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3cdc10601599--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3cdc10601599--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3cdc10601599--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3cdc10601599--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3cdc10601599--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.m.ong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.m.ong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ryan Ong"}, {"url": "https://medium.com/@ryan.m.ong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "287 Followers"}, {"url": "http://www.ryanong.co.uk", "anchor_text": "www.ryanong.co.uk"}, {"url": "https://ryanocm.substack.com/", "anchor_text": "https://ryanocm.substack.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97c118547987&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&user=Ryan+Ong&userId=97c118547987&source=post_page-97c118547987--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F17ccb3997267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fday-101-of-nlp365-in-depth-study-of-rasas-diet-architecture-3cdc10601599&newsletterV3=97c118547987&newsletterV3Id=17ccb3997267&user=Ryan+Ong&userId=97c118547987&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}