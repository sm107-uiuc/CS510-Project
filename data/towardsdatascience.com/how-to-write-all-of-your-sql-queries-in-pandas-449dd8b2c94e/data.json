{"url": "https://towardsdatascience.com/how-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e", "time": 1683016492.253075, "path": "towardsdatascience.com/how-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e/", "webpage": {"metadata": {"title": "How to Write All of Your SQL Queries in Pandas | by Terence Shin | Towards Data Science", "h1": "How to Write All of Your SQL Queries in Pandas", "description": "What makes SQL so amazing is that it\u2019s so easy to learn \u2014 the reason why it\u2019s so easy to learn is that the code syntax is so intuitive. Pandas on the other hand isn\u2019t so intuitive, especially if you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://stackoverflow.com/questions/30530663/how-to-select-distinct-across-multiple-data-frame-columns-in-pandas", "anchor_text": ".drop_duplicates()", "paragraph_index": 7}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rename.html", "anchor_text": ".rename()", "paragraph_index": 8}, {"url": "https://stackoverflow.com/questions/19913659/pandas-conditional-creation-of-a-series-dataframe-column", "anchor_text": "check out this article", "paragraph_index": 10}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": ".merge()", "paragraph_index": 11}, {"url": "https://stackoverflow.com/questions/36684013/extract-column-value-based-on-another-column-pandas-dataframe", "anchor_text": "link", "paragraph_index": 13}, {"url": "https://stackoverflow.com/questions/17071871/how-to-select-rows-from-a-dataframe-based-on-column-values", "anchor_text": "link", "paragraph_index": 14}, {"url": "https://stackoverflow.com/questions/11350770/select-by-partial-string-from-a-pandas-dataframe", "anchor_text": ".str.contains()", "paragraph_index": 15}, {"url": "https://stackoverflow.com/questions/32616261/filtering-pandas-dataframe-rows-by-contains-str", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://stackoverflow.com/questions/11350770/select-by-partial-string-from-a-pandas-dataframe", "anchor_text": ".isin()", "paragraph_index": 16}, {"url": "https://stackoverflow.com/questions/41825978/sorting-columns-and-selecting-top-n-rows-in-each-group-pandas-dataframe", "anchor_text": ".sort_values()", "paragraph_index": 17}, {"url": "https://stackoverflow.com/questions/38309729/count-unique-values-with-pandas-per-groups", "anchor_text": "here for more info", "paragraph_index": 20}, {"url": "https://www.linkedin.com/in/terenceshin/", "anchor_text": "https://www.linkedin.com/in/terenceshin/", "paragraph_index": 26}], "all_paragraphs": ["What makes SQL so amazing is that it\u2019s so easy to learn \u2014 the reason why it\u2019s so easy to learn is that the code syntax is so intuitive.", "Pandas on the other hand isn\u2019t so intuitive, especially if you started out with SQL first like I did.", "Personally, what I found really helpful was thinking about how I would manipulate my data in SQL, and then replicate it in Pandas. And so, if you\u2019re trying to be more proficient in Pandas, I highly recommend that you take this approach as well.", "Thus, this article serves as a cheatsheet, dictionary, a guide, whatever you want to call it so that you can refer to this when using Pandas.", "And with that said, let\u2019s dive into it!", "If you want to select an entire table, simply call the name of the table:", "If you want to select specific columns from a table, list the columns that you want in double brackets:", "Simply use .drop_duplicates() to get distinct values:", "If you want to rename a column, use .rename():", "For the equivalent of SELECT CASE WHEN, you can use np.select() where you first specify your choices and the values for each choice.", "If you want to include multiple conditions per choice, check out this article.", "Simply use .merge() to join tables, You can specify whether you want it to be a LEFT, RIGHT, INNER, or OUTER join using the \u201chow\u201d parameter.", "When filtering a DataFrame the same way you would use a WHERE clause in SQL, you simply need to define the criteria within square brackets:", "When you want to select a certain column from a table and filter it with a different column, follow the format below (if you want to read more about it, check out this link):", "If you want to filter by multiple criteria, simply wrap each condition in parenthesis and separate each condition using \u2018&\u2019. For more variations of this, check out this link.", "The equivalent of LIKE in SQL is .str.contains(). If you want to apply case insensitivity, simply add case=False in the parameters (see here).", "The equivalent of IN() in SQL is .isin().", "The equivalent of ORDER BY in SQL is .sort_values(). Use the \u2018ascending\u2019 parameter to specify whether you want to sort the values in ascending or descending order \u2014 the default is ascending just like SQL.", "If you want to ORDER BY multiple columns, list the columns in brackets, and specify the direction of ordering in the \u2018ascending\u2019 parameter in brackets as well. Make sure that you follow the respective order of the columns that you list.", "You\u2019ll notice a common pattern for aggregate functions.", "To replicate COUNT DISTINCT, simply use .groupby() and .nunique(). See here for more info:", "Hopefully, this serves as a useful guide when manipulating data with Pandas. Don\u2019t feel like you have to memorize all of this either! This is something that I constantly come back to when I work with Pandas.", "Eventually, with enough practice, you\u2019ll feel more comfortable with Pandas and will understand the underlying mechanics enough where you won\u2019t need to rely on cheat sheets like this one.", "As always, I wish you the best in your endeavors! :)", "Not sure what to read next? I\u2019ve picked another article for you:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science @ KOHO, Saturn Cloud | MSc, MBA | https://www.linkedin.com/in/terenceshin/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F449dd8b2c94e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://terenceshin.medium.com/?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": ""}, {"url": "https://terenceshin.medium.com/?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": "Terence Shin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F360a9d4d19ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&user=Terence+Shin&userId=360a9d4d19ab&source=post_page-360a9d4d19ab----449dd8b2c94e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F449dd8b2c94e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F449dd8b2c94e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@julilona?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ilona Froehlich"}, {"url": "https://unsplash.com/s/photos/pandas?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://stackoverflow.com/questions/30530663/how-to-select-distinct-across-multiple-data-frame-columns-in-pandas", "anchor_text": ".drop_duplicates()"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rename.html", "anchor_text": ".rename()"}, {"url": "https://stackoverflow.com/questions/19913659/pandas-conditional-creation-of-a-series-dataframe-column", "anchor_text": "check out this article"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": ".merge()"}, {"url": "https://stackoverflow.com/questions/12850345/how-do-i-combine-two-data-frames", "anchor_text": "pd.concat()"}, {"url": "https://stackoverflow.com/questions/36684013/extract-column-value-based-on-another-column-pandas-dataframe", "anchor_text": "link"}, {"url": "https://stackoverflow.com/questions/17071871/how-to-select-rows-from-a-dataframe-based-on-column-values", "anchor_text": "link"}, {"url": "https://stackoverflow.com/questions/11350770/select-by-partial-string-from-a-pandas-dataframe", "anchor_text": ".str.contains()"}, {"url": "https://stackoverflow.com/questions/32616261/filtering-pandas-dataframe-rows-by-contains-str", "anchor_text": "here"}, {"url": "https://stackoverflow.com/questions/11350770/select-by-partial-string-from-a-pandas-dataframe", "anchor_text": ".isin()"}, {"url": "https://stackoverflow.com/questions/41825978/sorting-columns-and-selecting-top-n-rows-in-each-group-pandas-dataframe", "anchor_text": ".sort_values()"}, {"url": "https://stackoverflow.com/questions/38309729/count-unique-values-with-pandas-per-groups", "anchor_text": "here for more info"}, {"url": "https://towardsdatascience.com/a-complete-pandas-glossary-for-data-science-a3bdd37febeb", "anchor_text": "A Complete Pandas Glossary for Data ScienceYour go-to resource to learn Pandas fundamentalstowardsdatascience.com"}, {"url": "https://medium.com/@terenceshin", "anchor_text": "follow me on Medium"}, {"url": "https://www.kaggle.com/terenceshin", "anchor_text": "Kaggle"}, {"url": "https://www.linkedin.com/in/terenceshin/", "anchor_text": "LinkedIn"}, {"url": "http://want%20to%20collaborate/?", "anchor_text": "website"}, {"url": "https://medium.com/tag/data-science?source=post_page-----449dd8b2c94e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----449dd8b2c94e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----449dd8b2c94e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data?source=post_page-----449dd8b2c94e---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/education?source=post_page-----449dd8b2c94e---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F449dd8b2c94e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&user=Terence+Shin&userId=360a9d4d19ab&source=-----449dd8b2c94e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F449dd8b2c94e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&user=Terence+Shin&userId=360a9d4d19ab&source=-----449dd8b2c94e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F449dd8b2c94e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F449dd8b2c94e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----449dd8b2c94e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----449dd8b2c94e--------------------------------", "anchor_text": ""}, {"url": "https://terenceshin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://terenceshin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terence Shin"}, {"url": "https://terenceshin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "120K Followers"}, {"url": "https://www.linkedin.com/in/terenceshin/", "anchor_text": "https://www.linkedin.com/in/terenceshin/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F360a9d4d19ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&user=Terence+Shin&userId=360a9d4d19ab&source=post_page-360a9d4d19ab--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa05efe3d278a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-write-all-of-your-sql-queries-in-pandas-449dd8b2c94e&newsletterV3=360a9d4d19ab&newsletterV3Id=a05efe3d278a&user=Terence+Shin&userId=360a9d4d19ab&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}