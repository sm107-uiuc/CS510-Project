{"url": "https://towardsdatascience.com/this-is-how-reinforcement-learning-works-5080b3a335d6", "time": 1683001169.977802, "path": "towardsdatascience.com/this-is-how-reinforcement-learning-works-5080b3a335d6/", "webpage": {"metadata": {"title": "This Is How Reinforcement Learning Works | by Michel Kana, Ph.D | Towards Data Science", "h1": "This Is How Reinforcement Learning Works", "description": "A step-by-step tutorial in Python and OpenAI Gym"}, "outgoing_paragraph_urls": [{"url": "https://www.theguardian.com/technology/2017/dec/07/alphazero-google-deepmind-ai-beats-champion-program-teaching-itself-to-play-four-hours", "anchor_text": "AlphaZero", "paragraph_index": 0}, {"url": "https://openai.com/blog/solving-rubiks-cube/", "anchor_text": "Dactyl", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/dont-ever-ignore-reinforcement-learning-again-4d026ee81371", "anchor_text": "our previous article", "paragraph_index": 4}, {"url": "https://gym.openai.com/envs/FrozenLake-v0/", "anchor_text": "OpenAI Frozen Lake", "paragraph_index": 6}, {"url": "https://towardsdatascience.com/dont-ever-ignore-reinforcement-learning-again-4d026ee81371", "anchor_text": "our previous article", "paragraph_index": 18}, {"url": "https://cs.stanford.edu/people/karpathy/reinforcejs/gridworld_dp.html", "anchor_text": "This post", "paragraph_index": 38}, {"url": "https://studywolf.wordpress.com/2013/07/01/reinforcement-learning-sarsa-vs-q-learning/", "anchor_text": "This post", "paragraph_index": 41}], "all_paragraphs": ["In late 2017 Google introduced AlphaZero, an AI system that taught itself from scratch how to master the games of chess, Go and shogi in four hours.", "The short training time was largely enough for AlphaZero to beat world champion chess programs.", "Recently, OpenAI demonstrated that Reinforcement Learning isn\u2019t just a tool for virtual tasks. Dactyl, its human-like robot hand has learned to solve a Rubik\u2019s cube on its own.", "Google AlphaZero and OpenAI Dactyl are Reinforcement Learning algorithms, given no domain knowledge except the rules of the game. Some AI experts believe this approach is the most viable strategy for achieving human or superhuman Artificial General Intelligence (AGI).", "In our previous article, we introduced the building blocks of Reinforcement Learning.", "Now we will dive deeper into the mechanisms used by AI agents to teach themselves how to take the right flow of actions for achieving a globally rewarding objective.", "Let\u2019s consider OpenAI Frozen Lake, a simple environment, where the agent controls the movement of a character in a grid world. Some tiles of the grid are walkable, and others lead to the agent falling into the water. The agent is rewarded for finding a walkable path to a goal tile.", "Even for such fairly simple environments, we can have a variety of policies. The agent can always move forward for example, or choose an action randomly or try to go around obstacles by checking whether that previous forward action failed, or even funnily spin around to entertain.", "The intuitive definition of policy is that it is some set of rules that controls the agent\u2019s behavior. Different policies can give us different return, which makes it important to find a good policy.", "Formally, policy is defined as the probability distribution over actions for every possible state:", "An optimal policy \ud835\uded1* is one that maximizes the expected value function V:", "The value function V(s) is the expected long-term return with discount for state s, as opposed to the short-term reward. The value function represents how good is a state for an agent to be in. It is equal to expected total reward for an agent starting from that state. In other words, the total reward of the one-step rewards for taking action a in state s and is defined via V(\ud835\udc60).", "The value function depends on the policy by which the agent picks actions to perform. Learning the optimal policy requires us to use the so-called Bellman equation.", "Let\u2019s introduce the Bellman equation intuitively by considering the example below. The agent can perform either the action 1, 2, \u2026 or N. This would bring the agent to a future state S1, S2, \u2026 or SN. The agent would get the reward r1, r2, \u2026 or rN accordingly. The expected long-term reward for each future state would be V1, V2, \u2026 or VN.", "If the agent takes the action a=i, while being in state S0, then the expected long-term reward or value for state S0 is given by the equation below, where \u03b3 is a constant.", "The optimal policy would help the agent to choose the best possibleaction. In order to do so, the agent needs to calculate the resulting values for every possible action a=1, 2, \u2026, N and choose the maximum possible outcome.", "The above equation is called deterministic Bellman equation. It can become a stochastic equation if, for a given action, the agent can reach more than one future state with different probabilities. This situation is illustrated below.", "The resulting stochastic Bellman equation for this general case is given as follows.", "We provide an implementation of the Bellman equation to choose the best possible action at a given state s. The function calculates the resulting values for every action and choose the maximum possible outcome. You will need to load the necessary prerequisite libraries as described in our previous article.", "In the previous section, we explained how to find the best action that provides the maximal long-term value. If we can do this for all states, we will obtain the value function. We will also know which action to perform at each state (optimal policy). This algorithm is called value iteration.", "The value iteration algorithm randomly selects an initial value function. It then calculates a new improved value function in an iterative process, until it reaches an optimal value function. Finally, it derives the optimal policy from that optimal value function.", "In a 4x4 Frozen Lake environment, the value iteration algorithm loops over all 16 states and 4 possible actions to explore rewards of a given action and calculates the maximum possible action/reward and stores it in the vector V[s]. The algorithm iterates until V[s] is not significantly improving anymore.", "The optimal policy P is then to take every time the action to go state with the highest V value.", "The function below implements the value iteration algorithm on a 4x4 Frozen Lake environment.", "The resulting array above illustrates how the value iteration function successfully computed the long-term reward for each of the 16 states. The algorithm took 7 iterations.", "The states representing a hole (H) have value 0, while those representing frozen tiles (F) have higher values, especially if these are on a promising path toward the goal G.", "The function below provides a visual of the results using a heatmap. Arrows show the flow of actions providing the best total reward using the optimal policy P.", "Below we run the value iteration algorithm on a 8x8 Frozen Lake environment.", "In the previous section, we presented the value iteration algorithm and illustrated how an agent would walk through a frozen lake with holes to reach the goal.", "In policy iteration algorithms, we start with a random policy instead of a random value function. Then we find the value function of that policy. Next, we find a new (improved) policy based on the previous value function. After multiple iterations, this will lead to an optimal policy.", "The function below implements the policy iteration algorithm.", "As we can observe, both algorithms produce the same result. While value iteration algorithm keeps improving the value function at each iteration until the value function converges, the policy improvement theorem assures us that the policies found by the policy iteration algorithm are better than the original random policy.", "Both approaches achieve the same goal, policy iteration being more computationally efficient.", "Both value and policy iteration algorithms rely on the hyper-parameter \u03b3 (gamma), which defines the learning rate during value or policy update.", "Here we try different gamma values and discuss what the impact of gamma is on the training.", "The plots show how values increases as gamma increases. Different values of gamma (0\u201310) produce different policies. Lower gamma values will put more weight on short-term rewards, whereas higher gamma values will put more weight towards long-term gains.", "The best gamma depends on the domain of the task. In the Frozen Lake context, it does not make sense to look for short term gains (e.g. negative reward caused by falling in the hole is actually less valuable than the same penalty received later, after a long way without falling). We rather want to look as far ahead as we can.", "In this article we provided hands-on techniques how to implement value iteration and policy iteration algorithms for finding the optimal policy in Reinforcement Learning.", "This post from Andrej Kaparthy provides further insights about these techniques.", "Both value and policy iteration algorithms work when the agent knows sufficient details about the environment model. Learning or providing a transition model can be hard in several scenarios such as autonomous driving, medical treatments or stock trading. Model-free approaches are more appropriate in such situations. We did not cover them in this article.", "Q-learning is a model-free learning that is used when the agent does not know the environment model but has to discover the policy by trial and error making use of its history of interaction with the environment.", "State\u2013action\u2013reward\u2013state\u2013action (SARSA) is another algorithm where the agent interacts with the environment and updates the policy based on actions taken. This post will give additional interesting insights about model-free algorithms.", "Are you still hungry? Check my most comprehensive and easiest introduction to Deep Learning below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Husband & Dad. Mental health advocate. Top Medium Writer. 20 years in IT. AI Expert @Harvard. Empowering human-centered organizations with high-tech."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5080b3a335d6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://michel-kana.medium.com/?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": "Michel Kana, Ph.D"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb0b01fe20d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=post_page-cb0b01fe20d2----5080b3a335d6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5080b3a335d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5080b3a335d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.theguardian.com/technology/2017/dec/07/alphazero-google-deepmind-ai-beats-champion-program-teaching-itself-to-play-four-hours", "anchor_text": "AlphaZero"}, {"url": "https://openai.com/blog/solving-rubiks-cube/", "anchor_text": "Dactyl"}, {"url": "https://towardsdatascience.com/dont-ever-ignore-reinforcement-learning-again-4d026ee81371", "anchor_text": "our previous article"}, {"url": "https://towardsdatascience.com/dont-ever-ignore-reinforcement-learning-again-4d026ee81371", "anchor_text": "Don\u2019t Ever Ignore Reinforcement Learning AgainSupervised or unsupervised learning is not everything. Everyone knows that. Get started with OpenAI Gym.towardsdatascience.com"}, {"url": "https://gym.openai.com/envs/FrozenLake-v0/", "anchor_text": "OpenAI Frozen Lake"}, {"url": "https://towardsdatascience.com/dont-ever-ignore-reinforcement-learning-again-4d026ee81371", "anchor_text": "our previous article"}, {"url": "https://cs.stanford.edu/people/karpathy/reinforcejs/gridworld_dp.html", "anchor_text": "This post"}, {"url": "https://studywolf.wordpress.com/2013/07/01/reinforcement-learning-sarsa-vs-q-learning/", "anchor_text": "This post"}, {"url": "https://towardsdatascience.com/why-deep-learning-works-289f17cab01a", "anchor_text": "Why Deep Learning Works: solving a farmer\u2019s problemIn the beginning was the neuron: a gentle review of gradient descent, backpropagation, regression, autoencoder, CNNs\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5080b3a335d6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5080b3a335d6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----5080b3a335d6---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----5080b3a335d6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----5080b3a335d6---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5080b3a335d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=-----5080b3a335d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5080b3a335d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=-----5080b3a335d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5080b3a335d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5080b3a335d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5080b3a335d6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5080b3a335d6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5080b3a335d6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5080b3a335d6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5080b3a335d6--------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michel Kana, Ph.D"}, {"url": "https://michel-kana.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb0b01fe20d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=post_page-cb0b01fe20d2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F69e95067d2a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-how-reinforcement-learning-works-5080b3a335d6&newsletterV3=cb0b01fe20d2&newsletterV3Id=69e95067d2a1&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}