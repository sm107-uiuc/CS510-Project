{"url": "https://towardsdatascience.com/predictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4", "time": 1683002759.934183, "path": "towardsdatascience.com/predictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4/", "webpage": {"metadata": {"title": "Predictive Modelers\u2019 Guide To Choosing The Best Fit Regression Model for Beginners | by Freeman Goja | Towards Data Science", "h1": "Predictive Modelers\u2019 Guide To Choosing The Best Fit Regression Model for Beginners", "description": "When looking for the best fit model for prediction, finding the right algorithm has always proven to be the difference between the success and failure of the entire project. For newbies to machine\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/frex1/Regression-Model", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://github.com/frex1/Regression-Model", "anchor_text": "here", "paragraph_index": 34}], "all_paragraphs": ["When looking for the best fit model for prediction, finding the right algorithm has always proven to be the difference between the success and failure of the entire project. For newbies to machine learning like I was and every other machine learning expert once was, finding the best fit model could be very confusing and that is usually not only because of low-level coding ability but mainly due to poor understanding and application of the concepts and the tendency to easily fall for the wrong metrics.", "In this article, am going to walk through the concepts and step by step guide to building the best fit model in 3 major steps to solve any regression problem. It is assumed that you are at least aware of the concepts of these models so I will be focusing more on their applications. We shall be comparing the performance of the following machine learning algorithms:", "Metrics: First, let\u2019s start with the metrics because the metrics chosen to evaluate the model are very important. R-Squared (R\u00b2), Adjusted R-Squared (Adj R\u00b2), Mean Square Errors (MSE) and Root Mean Squared Errors (RMSE) are very popular metrics for regressors.", "R\u00b2 Regression Score or Coefficient of determinant is an intuitive statistical scale that measures the proportion of the change in a dependent variable that\u2019s explained by an independent variable(s) in a regression model. A constant model that always predicts the expected value of y regardless of the input features would get a R\u00b2 value of 0 while a perfect fit model has R\u00b2 of 1.0. R\u00b2 value can be negative for a model that performs arbitrarily worse. Generally, R\u00b2 is a measure of the relative fit of a model. This metric, however, has a pitfall that is worthy of note here as R\u00b2 score tends to always increase with additional features without necessarily improving the model\u2019s fit. To overcome this drawback, another metric, Adjusted R\u00b2 which is interpreted as the proportion of total variance that is explained by the model made up of all the independent variables is preferred. Adjusted R\u00b2 takes into consideration the degrees of freedom. It increases when the addition of more features to the model improves the model\u2019s fit and decreases otherwise.", "The Mean Square Errors (MSE) is a measure of the closeness of a regression line to a set of points. It measures the distances called errors or variance of the residuals from the points to the regression line and squares them to remove any negative signs. The Root Mean Squared Errors (RMSE) takes the square root of MSE and indicates the absolute fit of the model to the data\u2013how close the observed data points are to the model\u2019s predicted values. RMSE is relatively easier to interpret in that it comes in the same unit as the response variable. Lower values of RMSE mean that the regression line is close to the data points, indicating a better fit. RMSE is a good measure of how accurately the model predicts the response, and it is the most important criterion for fit if the main purpose of the model is prediction.", "Having established the basic concepts, let\u2019s start getting our hands dirty. I have chosen to suppress the warnings so as to avoid them appearing in the output and making it messy. Word of caution when hiding all warnings is that you must be sure your code is free from errors.", "To make the code look more professional, I find importing all required libraries in one place as a nice way to start.", "1. Set directory and import relevant libraries", "Import data, explore, pre-process and prepare it for modelling.", "Explore the data to learn about its dimensions, data types, basic statistics etc. Depending on the dataset, categorical variables and missing values may have to be handled. In this example, there are no null values as can be seen above but I had to encode the categorical values in cd, multi and ads.", "Another important thing to check is outliers. The way you prepare a dataset with outliers for modelling is different from the one without outliers as you will see later on with scaling. Here, you can see outliers in price and hd in the figure above. While price outliers would not be a concern because it is the target feature,the presence of outliers in predictors like hd, in this case, would affect the model\u2019s performance. Detecting outliers and choosing the appropriate scaling method to minimize their effect would ultimately improve performance. You can find the full code and dataset in my Github repository here.", "Since we are dealing with regression, it is important to see the correlation between the predictors and the target variable. This can be achieved with the use of the correlation heatmap and matrix as shown below.", "From the correlation matrix, we can see that there is varying extent to which the independent variables are correlated with the target. Lower correlation means weak linear relationship but there may be a strong non-linear relationship so, we can\u2019t pass any judgement at this level, let the algorithm work for us.", "Talking about scaling, there\u2019s a wide range of scalers in sklearn including MinMaxScaler, StandardScaler, RobustScaler, minmax_scale, MaxAbsScaler, Normalizer, QuantileTransformer and PowerTransformer. I compared the commonly used ones in this article to find the most suitable. Feel free to add more or choose according to your requirements. The program below visualizes before scaling and the three chosen types.", "MinMaxScaler: As you can see from the second figure above, it re-scales all feature values in the range [0, 1]. However, it is very sensitive to the presence of outliers.", "StandardScaler: This scaler disregards the mean and scales the data to unit variance. However, outliers influence both mean and standard deviation. Therefore, StandardScaler like MinMax scaler doesn\u2019t guarantee balanced feature scales in the presence of outliers.", "RobustScaler: Unlike the first two, RobustScaler is based on percentiles and hence not easily influenced by outliers.", "PowerTransformer: Applies a power transformation to each feature to make the data more Gaussian-like.", "MaxAbScaler: Similar to MinMaxScaler but used on positive-only data and also suffers from the presence of large outliers.", "QuantileTransformer: Matches a Gaussian distribution instead of a uniform distribution and introduces saturation artifacts for extreme values.", "The ultimate choice depends on either domain knowledge of the dataset or trial and error. From the figure above, it can be seen that only RobustScaler returned a nice distribution with outliers outside the bulk of the distribution and therefore, it is the obvious choice needed for optimum performance.", "3. Train the Model and Make Predictions", "Now let\u2019s split the dataset and import the appropriate modelling libraries.", "Before building the models, I want each model to perform at its best so it\u2019s important to do feature selection for Linear Regression and tune the hyper-parameters for XGBoost, AdaBoost, Decision Tree, Random Forests, KNN and SVM to find the best parameters to use in the models.", "Linear Regression: When building a Linear Regression model, there\u2019s no need to include unnecessary features that do not contribute reasonably to the change in the target variable. With backward elimination, you can deselect features that have p_values > 0.05 which is interpreted as a failure to explain the change in the target other than chance. The following code returns only the selected features with p_values < 0.05.", "Tuning hyperparameters is one key method of optimizing the performance of hyper-parametric models as shown below.", "XGBoost: The common hyper-parameters to tune here include; learning_rate, max_depth and n_estimators.", "KNN: When we have features with values at different scales, it is very important to standardize them to the same range so that the algorithm does not weigh greater values, higher and consider smaller values as the lower values, regardless of the unit of the values. This is crucial for distance-based algorithms such as KNN. We found earlier that RobustScaler was the most suitable scaler for this dataset so we shall be using it here for scaling.", "The common hyperparameters to tune here are n_neighbors and p.", "SVM: Similarly, scaling is important for SVM. The hyper-parameters to tune here are gamma, C and kernel.", "Having selected the best features and tuned the hyper-parameters, it\u2019s time to build optimized models using those parameters. This ensures that each model performs at its best on the dataset. Below is a demonstration of the use of the values we have found.", "Done with the dirty work now let\u2019s look at the results.", "As expected, the Adjusted R\u00b2 score is slightly lower than the R\u00b2 score for each model and if we evaluate based on this metric, the best fit model would be XGBoost with the highest Adjusted R\u00b2 score and the worst would be AdaBoost with the least R\u00b2 score. However, recall that this metric is only a relative measure of fitness so, we must look at the RMSE values. In this case, XGBoost and AdaBoost have the lowest and highest RMSE values respectively and the rest models are in the exact same order as their Adjusted R\u00b2 scores. This further confirms that the best fit model for this dataset is XGBoost and the worst fit model is AdaBoost. Note, this doesn\u2019t always happen so, be careful. Generally, when you have a model with the highest Adjusted R\u00b2 and high RMSE, you would be better off with the one that has moderate Adjusted R\u00b2 and low RMSE as the latter is the absolute measure of fit.", "Looking at the plots of predicted vs actual prices, you can also see that the data points in XGBoost are closer to each other and farther apart in AdaBoost.", "Thank you for stopping by and I hope you enjoyed this article and found it helpful. You can find the full code and dataset on GitHub here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F707120e502b4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----707120e502b4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----707120e502b4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@freemangoja?source=post_page-----707120e502b4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@freemangoja?source=post_page-----707120e502b4--------------------------------", "anchor_text": "Freeman Goja"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2ead28c9f72&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&user=Freeman+Goja&userId=e2ead28c9f72&source=post_page-e2ead28c9f72----707120e502b4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F707120e502b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F707120e502b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/frex1/Regression-Model", "anchor_text": "here"}, {"url": "https://github.com/frex1/Regression-Model", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----707120e502b4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/regression?source=post_page-----707120e502b4---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/predictive-modeling?source=post_page-----707120e502b4---------------predictive_modeling-----------------", "anchor_text": "Predictive Modeling"}, {"url": "https://medium.com/tag/data-science?source=post_page-----707120e502b4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/model?source=post_page-----707120e502b4---------------model-----------------", "anchor_text": "Model"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F707120e502b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&user=Freeman+Goja&userId=e2ead28c9f72&source=-----707120e502b4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F707120e502b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&user=Freeman+Goja&userId=e2ead28c9f72&source=-----707120e502b4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F707120e502b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----707120e502b4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F707120e502b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----707120e502b4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----707120e502b4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----707120e502b4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----707120e502b4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----707120e502b4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----707120e502b4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----707120e502b4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----707120e502b4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----707120e502b4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@freemangoja?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@freemangoja?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Freeman Goja"}, {"url": "https://medium.com/@freemangoja/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "46 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2ead28c9f72&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&user=Freeman+Goja&userId=e2ead28c9f72&source=post_page-e2ead28c9f72--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe3ca755d2b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-modellers-guide-to-choosing-the-best-fit-regression-model-707120e502b4&newsletterV3=e2ead28c9f72&newsletterV3Id=e3ca755d2b4d&user=Freeman+Goja&userId=e2ead28c9f72&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}