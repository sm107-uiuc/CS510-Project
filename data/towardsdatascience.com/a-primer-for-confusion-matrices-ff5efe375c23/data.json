{"url": "https://towardsdatascience.com/a-primer-for-confusion-matrices-ff5efe375c23", "time": 1683009537.793164, "path": "towardsdatascience.com/a-primer-for-confusion-matrices-ff5efe375c23/", "webpage": {"metadata": {"title": "A Primer for Interpreting Confusion Matrices | by Hamilton Chang | Towards Data Science", "h1": "A Primer for Interpreting Confusion Matrices", "description": "In my last post, I talked about the Confusion Matrix and its importance in helping us determine the accuracy of our models. This week we\u2019ll take a look at the basic structure of Confusion Matrices\u2026"}, "outgoing_paragraph_urls": [{"url": "http://shorturl.at/aBGY5", "anchor_text": "shorturl.at/aBGY5", "paragraph_index": 22}], "all_paragraphs": ["In my last post, I talked about the Confusion Matrix and its importance in helping us determine the accuracy of our models. This week we\u2019ll take a look at the basic structure of Confusion Matrices and how they help us determine the accuracy of our models.", "As I mentioned in my last post, Confusion Matrixes are credited to Karl Pearson back in 1904, although for him it was the contingency table. They have been popular for statistical classification and machine learning and enable us to visually represent the performance of our classifier. A confusion matrix is a type of contingency table that measures the rate of True Positives, False Positives, True Negatives, and False Negatives. Here\u2019s what a simple one looks like:", "Doesn\u2019t seem very fancy, does it? Well, it\u2019s not, but it's chockfull of useful information that tells us how well our machine learning models have performed in classifying\u2026if there is a cat or not. Truly useful stuff. So how do we interpret this data? Well, let\u2019s look at what each of the categories means for us.", "Above, you see the true meaning behind each category. Where Positive Predicted and Positive Actual meet, we have a True Positive. Where Negative Predicted and Negative Actual meet, we have a True Negative. This means that in the former, a Cat was predicted, and the image itself was of a Cat. In the latter, the image was identified as Not Cat, and the actual image itself was Not Cat. Thanks to our day to day interactions with medicine and some bad medical TV, many people are aware of the term \u201cFalse Positive.\u201d For those in a bit of confusion, it means in this context, that our machine predicted Cat based on an image that was actually Not Cat. False Negative means that an image that was a Cat was predicted as Not Cat. Here\u2019s what that looks like for one pass through:", "Now that we understand these categories, we can look back at our initial confusion matrix, the numbers make a great deal more sense. Our confusion Matrix is telling us that of this initial run, 5 Cat pictures were accurately classified, 10 were incorrectly classified, 4 Not Cat pictures were classified incorrectly as Cat, and 6 Not Cat pictures were correctly classified as Not Cat. This would suggest our model is not yet very good at identifying images of cats.", "Now, as you may be aware, some mathematicians can\u2019t just very well leave alone. Here we have a nice easy to read confusion matrix that tells us how well our model performed. But easy to read and interpretability can fall by the wayside for the sake of brevity. After all, if we are to give a presentation on our model, we can\u2019t just show confusion matrix after confusion matrix. Some people just want those hard numbers to determine success. Thus comes our metrics for determining the success of our confusion matrices.", "Enter our 4 testing metrics: Accuracy, Precision, Recall and F1. I\u2019m not going to go into too much detail here, but I will list out what each one does.", "Accuracy: Accuracy can be simply calculated with the following formula:Accuracy = (True Positives + True Negatives/Total Predictions) * 100%It\u2019s a simple measurement, but its not alway the best one. To put it in perspective, Accuracy measures Correct Cat + Correct No Cat divided total number of images used.", "Precision: Precision expresses the proportion of the predictions our model says were Positives that were actually Positives, and can be calculated via this formula:Precision = (True Positives)/(True Positives + False Positives)To put this in perspective, Precision measures of the images identified as Cat, how many were actually Cat?", "Recall: Recall tests the ability of our model to find correct predictions out of total positive predictions. It is calculated using this formula:Recall = (True Positives)/(True Positives + False Negatives)To put this in perspective, Recall measures of the images that are actually Cat, how many were accurately predicted as Cat?", "F1 Score: F1 score is the weighted average of Precision and Recall and takes False Positives and False Negatives into account. This can make it more effective than accuracy, especially when we have imbalanced classes or multiple classes. Here\u2019s the formula:F1 = 2*((Precision * Recall)/(Recall + Precision))The idea behind F1 score is to balance the concerns behind Precision and Recall. Since both are relevant metrics, F1 gives us the ability to consolidate both scores.", "So now that we know some confusion matrix basics and how to measure them, let\u2019s use this knowledge to poke around at a real life confusion matrix. I\u2019m going to be using some of my old confusion matrices from my whiskey project because I\u2019m too lazy to dig up older ones or make a new one. It's going to be a bit more complicated, but bear with me because I\u2019m going to try to make it simple to understand.", "Observe the confusion matrix for our KNN classifier. It has done an excellent job in classifying scotch whiskies. This particular classification is unique in many ways. First of all, it is multi-class, in that there are many countries for whiskey. Second, there is a major class imbalance that we compensate for using our training dummies. But at the end of the day, there are still a lot of whiskies and flavor profiles for scotch tend to be all over the place.", "As you can see in the classification report, this model has a pretty good precision score with Scotch, and a damn near impossibly good precision score with bourbon. Now if we remember our Precision definition, we recall that Precision is all about the ratio of predicted vs actual. We can see, moving down the Scotch column, that while KNN got 140 out of 164 scotches correct, it also included 4 bourbons, 5 Canadian, 6 Irish, 4 Japanese and 17 world whiskies into the Scotch category. If we do the math on that, this gives us that Precision score of .80.", "For Recall, KNN got 140 out of 164 scotches correct, but this time we are moving across the matrix to account for false negatives! We can see that the KNN classifier thought that 23 Scotches were Canadian and 1 Scotch was Irish. If we do the math on them, we get our .82 score. Naturally, since F1 is the average of those two, we know that our F1score is going to be .81.", "Now if we were looking to classify scotches, this model would be GREAT. Unfortunately, as we move further down the list of countries, we see some pretty dismal scores. It is usually here, that a data scientist would evaluate their goals in building these models. KNN seems pretty freaking good at classifying scotches, but if I wanted to just classify scotches, why would I bother making these other country classes? No, based on the distribution of True Positives and False Negatives combined with the metrics we\u2019ve calculated, KNN is not a great whiskey classifier.", "Some of you may have seen the multi-class confusion matrix and thought, how do you even read that? Where are the True Positives, the True Negatives, or even the False Positives?? Well, even though we\u2019re not labeling everything, we just have to remember everything\u2019s relative position. Let's take a look at a sample confusion matrix, shall we?", "Here\u2019s a Confusion Matrix representing the classification of Cats, Dogs, and Mice. If we wanted to calculate the Precision or Recall of our model\u2019s ability to classify cats, we would organize our Confusion Matrix through the following groups.", "The Green box represents True Positives. Cat Predicted and Cat Actual. The Red Box represents the True Negatives, these have nothing to do with Cat Predicted or Cat Actual, so we know the images were correctly predicted as Not CatThe Blue Box represents the False Positives. Actual Dog or Mice but Classified as Cats. The Purple Box Represents False Negatives. Actual Cats that are Classified as Dogs or Mice.", "Knowing these, we can then begin our Accuracy, Precision, Recall, and F1 scores calculations. The same shifting and separation can be done for Dogs and Mice to calculate their scores.", "I hope you all found this brief introduction to confusion matrices helpful. When I first started out using Machine Learning, I found them to be a bit\u2026confusing for lack of a better word. Knowing the ins and outs and learning to interpret them will help you understand what\u2019s happening in your models, and in turn will help you become a better data scientist.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, Financial Planner. Trying to educate and make information accessible to EVERYONE. Let\u2019s Connect! shorturl.at/aBGY5"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fff5efe375c23&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hammychang.medium.com/?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": ""}, {"url": "https://hammychang.medium.com/?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": "Hamilton Chang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ab754b22f04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&user=Hamilton+Chang&userId=4ab754b22f04&source=post_page-4ab754b22f04----ff5efe375c23---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff5efe375c23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff5efe375c23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@hngstrm?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Henry & Co."}, {"url": "https://towardsdatascience.com/s/photos/confusion-matrix?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/confusion-matrix?source=post_page-----ff5efe375c23---------------confusion_matrix-----------------", "anchor_text": "Confusion Matrix"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ff5efe375c23---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-science-training?source=post_page-----ff5efe375c23---------------data_science_training-----------------", "anchor_text": "Data Science Training"}, {"url": "https://medium.com/tag/classification-metrics?source=post_page-----ff5efe375c23---------------classification_metrics-----------------", "anchor_text": "Classification Metrics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff5efe375c23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&user=Hamilton+Chang&userId=4ab754b22f04&source=-----ff5efe375c23---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff5efe375c23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&user=Hamilton+Chang&userId=4ab754b22f04&source=-----ff5efe375c23---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff5efe375c23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fff5efe375c23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ff5efe375c23---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ff5efe375c23--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ff5efe375c23--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ff5efe375c23--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ff5efe375c23--------------------------------", "anchor_text": ""}, {"url": "https://hammychang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hammychang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hamilton Chang"}, {"url": "https://hammychang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "219 Followers"}, {"url": "http://shorturl.at/aBGY5", "anchor_text": "shorturl.at/aBGY5"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ab754b22f04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&user=Hamilton+Chang&userId=4ab754b22f04&source=post_page-4ab754b22f04--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2ed0d50247b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-for-confusion-matrices-ff5efe375c23&newsletterV3=4ab754b22f04&newsletterV3Id=2ed0d50247b6&user=Hamilton+Chang&userId=4ab754b22f04&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}