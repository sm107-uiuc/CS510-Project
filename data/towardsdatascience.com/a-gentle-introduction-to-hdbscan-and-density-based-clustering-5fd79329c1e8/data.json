{"url": "https://towardsdatascience.com/a-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8", "time": 1683010542.4937038, "path": "towardsdatascience.com/a-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8/", "webpage": {"metadata": {"title": "A gentle introduction to HDBSCAN and density-based clustering | by Pepe Berba | Towards Data Science", "h1": "A gentle introduction to HDBSCAN and density-based clustering", "description": "\u201cHierarchical Density-based Spatial Clustering of Applications with Noise\u201d (What a mouthful\u2026), HDBSCAN, is one of my go-to clustering algorithms. It\u2019s a method that I feel everyone should include in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pberba.github.io/stats/2020/01/17/hdbscan/", "anchor_text": "my previous blog post", "paragraph_index": 1}, {"url": "https://github.com/lmcinnes/hdbscan/blob/master/notebooks/clusterable_data.npy", "anchor_text": "data set", "paragraph_index": 3}, {"url": "https://pberba.github.io/stats/2020/01/17/hdbscan/", "anchor_text": "check out blog post", "paragraph_index": 29}], "all_paragraphs": ["\u201cHierarchical Density-based Spatial Clustering of Applications with Noise\u201d (What a mouthful\u2026), HDBSCAN, is one of my go-to clustering algorithms. It\u2019s a method that I feel everyone should include in their data science toolbox.", "I\u2019ve written about this in my previous blog post, where I try to explain HDBSCAN in as much depth as I could. This time I am taking the opposite approach: I will try to explain the main ideas HDBSCAN and density-based clustering as succinctly as I can.", "I think (and I hope) that this primer on HDBSCAN would be friendlier for beginners and new-comers in data science.", "Let\u2019s start with a sample data set.", "If you visually try to identify the clusters, you might identify 6 clusters.", "Even when provided with the correct number of clusters, K-means clearly gives bad results. Some of the clusters we identified above are separated into two or more clusters. HDBSCAN, on the other hand, gives us the expected clusters.", "Unlike K-means, density-based methods work well even when the data isn\u2019t clean and the clusters are weirdly shaped.", "How does HDBSCAN do this? At a high level, we can simplify the process of density-based clustering into these steps:", "We need some method to estimate the density around certain points. One common way to do this is by using \u201ccore distance.\u201d This is the distance of a point to its K-th nearest neighbor.", "Points in denser regions would have smaller core distances while points in sparser regions would have larger core distances. Core distance is what makes these methods \u201cdensity-based\u201d.", "Given the core distances, we can derive an estimate of the density by getting the inverse of it. With these estimates, we can get an idea of what the density landscape looks like.", "If we plot these densities, we can see that the mountains of this density landscape correspond to the different clusters of the data.", "One way to select clusters is to pick a global threshold. By getting the points with densities above the threshold, and grouping these points together, we get our clusters.", "Think of this illustration below as a cross-section of the surface plot above.", "Imagine islands on the ocean, where the sea level is the threshold and the different islands are your clusters. The land below the sea level is noise. As the sea level goes down, new islands appear and some islands combine to form bigger islands.", "Here are several clusters that result as we lower the sea level.", "This approach is close to what DBSCAN does. Although simple, this requires us to find the proper threshold to get meaningful clusters.", "If you set the threshold too high, too many points are considered noise and you have under grouping. If you set it too low, you might over group the points, and everything is just one cluster.", "With the global threshold method, you might have a hard time when the clusters have varying densities. If we use just one threshold in the example below, we either over-group the blue and yellow clusters or we fail to include the entire red cluster.", "You might be tempted to think that each peak in the density should be one cluster, however, this will not always be optimal.", "Look at the image below. On the left, there should be 3 clusters, and on the right, there should be 2 clusters.", "HDBSCAN first builds a hierarchy to figure out which peaks end up merging together and in what order, and then for each cluster it asks, is it better to keep this cluster or split it up into its subclusters? In the image above, should we pick the blue and yellow regions or the green region only?", "Given the density landscape, you can think of each mountain is one cluster. We have to decide whether or not two peaks are part of the same mountain. Are there two mountains, or just one mountain with two peaks?", "Below are examples that illustrate this point", "If you use the sklearn\u2019s HDBSCAN, you can plot the cluster hierarchy.", "To choose, we look at which one \u201cpersists\u201d more. Do we see the peaks more together or apart? Cluster stability (persistence) is represented by the areas of the different colored regions in the hierarchy plot. We use cluster stability to answer our mountain question.", "When the two peaks are actually two mountains, the sum of the volume of the two peaks is larger than the volume of their base. When the peaks are just features of a single mountain, then the volume of the base would be larger than the sum of the peaks\u2019 volume.", "Using this heuristic, HDBSCAN is able to decide whether or not to subdivide a cluster to its subclusters. By doing so, it automatically chooses which clusters to extract.", "I hope this gives you the gist how DBSCAN/HDBSCAN works and what makes these methods \u201cdensity based\u201d. Other methods such as OPTICS or DeBaCl use similar concepts but differ in the way they choose the regions.", "If you want to know more about the statistical motivation for HDBSCAN, implementation details of how points are combined together, or how HDBSCAN builds the hierarchy you can check out blog post where I go into much more detail.", "Technical Note: The estimated densities plotted here isn\u2019t just 1 / core_distance. I had to apply some transformation to the data to make it more visually appealing.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Stats, security, and cryptography | Cloud Security | GMON, CCSK | Masters student in data science"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5fd79329c1e8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@pberba?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pberba?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": "Pepe Berba"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdc355a36c19a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&user=Pepe+Berba&userId=dc355a36c19a&source=post_page-dc355a36c19a----5fd79329c1e8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5fd79329c1e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5fd79329c1e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pberba.github.io/stats/2020/01/17/hdbscan/", "anchor_text": "my previous blog post"}, {"url": "https://github.com/lmcinnes/hdbscan/blob/master/notebooks/clusterable_data.npy", "anchor_text": "data set"}, {"url": "https://pberba.github.io/stats/2020/01/17/hdbscan/", "anchor_text": "check out blog post"}, {"url": "https://pberba.github.io/stats/2020/01/17/hdbscan/", "anchor_text": "Understanding HDBSCAN and Density-Based ClusteringHDBSCAN is a clustering algorithm developed by Campello, Moulavi, and Sander [8]. It stands for \" Hierarchical\u2026pberba.github.io"}, {"url": "https://hdbscan.readthedocs.io/en/latest/how_hdbscan_works.html", "anchor_text": "How HDBSCAN Works - hdbscan 0.8.1 documentationHDBSCAN is a clustering algorithm developed by Campello, Moulavi, and Sander. It extends DBSCAN by converting it into a\u2026hdbscan.readthedocs.io"}, {"url": "https://arxiv.org/abs/1705.07321", "anchor_text": "Accelerated Hierarchical Density ClusteringWe present an accelerated algorithm for hierarchical density based clustering. Our new algorithm improves upon\u2026arxiv.org"}, {"url": "https://unsplash.com/photos/sL0xKYbb04w", "anchor_text": "Photo by Markos Mant"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5fd79329c1e8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/statistics?source=post_page-----5fd79329c1e8---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/clustering?source=post_page-----5fd79329c1e8---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5fd79329c1e8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/math?source=post_page-----5fd79329c1e8---------------math-----------------", "anchor_text": "Math"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5fd79329c1e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&user=Pepe+Berba&userId=dc355a36c19a&source=-----5fd79329c1e8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5fd79329c1e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&user=Pepe+Berba&userId=dc355a36c19a&source=-----5fd79329c1e8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5fd79329c1e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5fd79329c1e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5fd79329c1e8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5fd79329c1e8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pberba?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pberba?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pepe Berba"}, {"url": "https://medium.com/@pberba/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "294 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdc355a36c19a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&user=Pepe+Berba&userId=dc355a36c19a&source=post_page-dc355a36c19a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd712a5263bbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-hdbscan-and-density-based-clustering-5fd79329c1e8&newsletterV3=dc355a36c19a&newsletterV3Id=d712a5263bbc&user=Pepe+Berba&userId=dc355a36c19a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}