{"url": "https://towardsdatascience.com/how-to-choose-the-best-model-cf74bf8015d8", "time": 1683017960.0889652, "path": "towardsdatascience.com/how-to-choose-the-best-model-cf74bf8015d8/", "webpage": {"metadata": {"title": "How to choose the best model. Do not choose, use them all! | by Vincent Margot | Towards Data Science", "h1": "How to choose the best model", "description": "With this advertising title, I would like to draw your attention to a common problem in machine learning (ML): the choice of the good model. I will not describe all the statistical methods that have\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.advestis.com/", "anchor_text": "Advestis", "paragraph_index": 21}, {"url": "http://pierre.gaillard.me/doc/theseGaillard.pdf", "anchor_text": "Contributions to online robust aggregation: work on the approximation error and on probabilistic forecasting. Applications to forecasting for energy markets", "paragraph_index": 22}], "all_paragraphs": ["With this advertising title, I would like to draw your attention to a common problem in machine learning (ML): the choice of the good model. I will not describe all the statistical methods that have been developed for model selection. For the most curious readers I suggest the reading of [3]. In this article I would like to talk about less known methods: the theory of aggregation of experts.", "When I talk to other data scientists, most of them have never heard of it. Therefore, I decided to write this article to shortly describe these methods. It is based on the book \u201cPrediction, Learning and Games\u201d [1], which is nicknamed \u201cThe Red Bible\u201d and the introduction of the thesis of Pierre Gaillard [2].", "Initially, the theory of aggregation of experts has been developed to make sequential predictions of a variable y at different times t. For this purpose, we assume that at each time t we have a group of K experts who make predictions. The idea is to aggregate the predictions sequentially to produce an aggregated prediction \u0177.", "One of the most important points is that it is not necessary to know the procedure by which these predictions are made. They could be generated by machine learning algorithms or be expert advice or even predictions from your fortune-teller, whatever.", "To create \u0177, we perform a convex combination (i.e. a weighted sum where the sum of the weights equals 1) of the experts\u2019 predictions. Once the true value of y is known, we adjust the weights of the individual experts according to the difference between their prediction and the true value of y. The worse the prediction, the lower the weight. Thus, the more an expert is wrong, the less important it will be in the aggregated prediction. And so on until you decide to renew your expert group.", "Depending on what you compare your aggregated model to, you will use different strategies to update the experts\u2019 weights. In fact, there are different goals in the theory of aggregation of experts: to make an aggregated model competitive with the best experts in your group (model selection (MS) problem), to make an aggregated model competitive with the best convex combination of your experts (convex combination (CC) problem), or even to make an aggregated model competitive with the best sequential convex combination of your experts.", "In the following, I need to introduce some mathematical formalism to present the main aggregation strategy: exponentially weighted aggregation. So if you are allergic to mathematical formulas, go directly to the conclusion and share this article with your data scientists team.", "To evaluate the performance of a prediction we need a measure. In the theory of aggregation of experts it is called the loss function, denoted \u2113. It is a positive function which takes two arguments. The first one is a prediction and the second one is a realization. This function is assumed to be convex on its first argument. For example, we have the convex square loss \u2113(x, y) := (x-y)\u00b2. We can describe the sequential prediction with expert advices with the following steps:", "The main objective of a statistician is to minimize the cumulated loss of the aggregated prediction. It is defined by", "We can decompose the formula of the cumulated loss as follows", "Thus, we obtain the classical decomposition in ML. The right term is named cumulated regret. It reflects the regret of not knowing the best expert in advance. So, to minimize the cumulated loss, we have to control the cumulated regret.", "The exponentially weighted aggregation strategy (presented below) guarantees an average cumulated regret of the order of", "We can prove that this bound is optimal, but is not the purpose of this article. I refer the most curious among you to Chapter 2.2 of [1].", "As mentioned in the introduction the aggregated prediction is a convex combination of the experts\u2019 predictions. For each date t we have", "And the weights are sequentially computed following the formula", "where \u03b7 > 0 is called the learning rate. To calibrate this parameter we use the fact that if the loss is convex on its first argument and is valued in [a, b] then the cumulated regret of this strategy is uniformly bounded by", "Hence, this bound is minimal for", "You could tell me that in practice we do not know the parameters T, a and b. And it is true. However, the expert aggregation theory has been developed to be used in practice. Therefore, there are always techniques to get around this kind of difficulty. If you want to read more about the calibration of \u03b7 we refer to Chapter 2.3 of [1].", "The theory of aggregation of experts is an amazing theory, and it is driven by practice. It allows the aggregation of multiple forecasting models to get the most out of each one. For example, EDF (France\u2019s main electricity generation and distribution company) uses more than forty models to predict the electricity consumption of the French people. One of the main advantages is that by aggregating experts, very different models can be used simultaneously without having to worry about how they were created. Therefore, very general models can be combined with very specialized models. It\u2019s the best of both worlds.", "Right now, the theory of aggregation of experts is not very well known. But I think it\u2019s a very interesting approach today, where the number of algorithms is multiplying and the selection depends more and more on time-changing parameters. The best model of today may not be the best model of tomorrow and vice versa.", "Therefore, from now on, do not choose, use them all!", "Advestis is a European Contract Research Organization (CRO) with a deep understanding and practice of statistics, and interpretable machine learning techniques. The expertise of Advestis covers the modeling of complex systems and predictive analysis for temporal phenomena.", "[2] P.Gaillard, Contributions to online robust aggregation: work on the approximation error and on probabilistic forecasting. Applications to forecasting for energy markets (2015), Universit\u00e9 Paris-Sud 11.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcf74bf8015d8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vmargot.medium.com/?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": ""}, {"url": "https://vmargot.medium.com/?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": "Vincent Margot"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff30b2fa2a77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&user=Vincent+Margot&userId=f30b2fa2a77&source=post_page-f30b2fa2a77----cf74bf8015d8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf74bf8015d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf74bf8015d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/qimono-1962238/", "anchor_text": "quimono"}, {"url": "https://pixabay.com/", "anchor_text": "Pixabay"}, {"url": "https://www.advestis.com/", "anchor_text": "Advestis"}, {"url": "https://www.linkedin.com/company/advestis/", "anchor_text": "https://www.linkedin.com/company/advestis/"}, {"url": "https://www.researchgate.net/profile/Gabor_Lugosi/publication/220690817_Prediction_Learning_and_Games/links/0912f50eae7fc7be04000000.pdf", "anchor_text": "Prediction, learning, and games"}, {"url": "http://pierre.gaillard.me/doc/theseGaillard.pdf", "anchor_text": "Contributions to online robust aggregation: work on the approximation error and on probabilistic forecasting. Applications to forecasting for energy markets"}, {"url": "https://www.researchgate.net/profile/Pascal_Massart/publication/245759642_Concentration_Inequalities_and_Model_Selection/links/540ee8990cf2df04e758a212/Concentration-Inequalities-and-Model-Selection.pdf", "anchor_text": "Concentration inequalities and model selection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cf74bf8015d8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cf74bf8015d8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf74bf8015d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&user=Vincent+Margot&userId=f30b2fa2a77&source=-----cf74bf8015d8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf74bf8015d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&user=Vincent+Margot&userId=f30b2fa2a77&source=-----cf74bf8015d8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf74bf8015d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcf74bf8015d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cf74bf8015d8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cf74bf8015d8--------------------------------", "anchor_text": ""}, {"url": "https://vmargot.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vmargot.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vincent Margot"}, {"url": "https://vmargot.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff30b2fa2a77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&user=Vincent+Margot&userId=f30b2fa2a77&source=post_page-f30b2fa2a77--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F59d8a7654776&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-choose-the-best-model-cf74bf8015d8&newsletterV3=f30b2fa2a77&newsletterV3Id=59d8a7654776&user=Vincent+Margot&userId=f30b2fa2a77&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}