{"url": "https://towardsdatascience.com/object-detection-using-gluoncv-b7940670ba54", "time": 1683007436.604275, "path": "towardsdatascience.com/object-detection-using-gluoncv-b7940670ba54/", "webpage": {"metadata": {"title": "Object Detection using GluonCV. In this article, we will walk through\u2026 | by Ramesh Paudel, Ph.D. | Towards Data Science", "h1": "Object Detection using GluonCV", "description": "We will use the following image for object detection. The image has a few obvious objects. In the foreground, we have a dog that\u2019s just in front of a bike. And in the background, we have a tree and a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/image-classification-using-gluoncv-f6ae5401d6ae", "anchor_text": "next article", "paragraph_index": 25}, {"url": "https://medium.com/@rmesfrmpkr/membership", "anchor_text": "here", "paragraph_index": 26}], "all_paragraphs": ["We will start by importing the required libraries. We\u2019ll need to import MXNet, GluonCV, and Pyplot.", "We will use the following image for object detection. The image has a few obvious objects. In the foreground, we have a dog that\u2019s just in front of a bike. And in the background, we have a tree and a car. We\u2019d like a model to detect these objects.", "So let\u2019s load the image using imread().", "As seen above, the image has a data layout of HWC. Our image has a height of 576 pixels with a width of 768 pixels. And it\u2019s a colored image with three channels. So let\u2019s transform our image into the required format.", "CV provides a function that applies all of the necessary preprocessing steps for the yolo network. We call yolo.transform_test with our image and also provide the short length of the output image with the short parameter. Our input mage was landscape where the height is smaller than the width. Using this function, the height will be resized to 512 pixels while maintaining the aspect ratio of the image.", "The transform test function returns two objects. Our first object is the transformed image that is ready to be given to the network. Our second object is just a resized version of the image, and we use this image for plotting our results.", "The resized image is a batch of a single image. This is in NCHW format instead of NHWC format and an array of 32-bit floats instead of 8-bit integers. Finally, the returned resize image is a normalized image.", "We can plot the resized CHW image.", "We can see the effect of the resize. Our short edge is now 512 pixels instead of 576 while the width remains one-third times longer than the height.", "We can use the get_model() function to load our pretrained model from the CV model zoo. We\u2019ll use the yolo3 network with a darknet53 backbone that has been trained on the coco dataset.", "Don\u2019t forget to set the pretrained argument to true.", "We can call network just like a function once again. Give network and image and a prediction will be returned. When using detection models, we can expect three MXNet ndarrays to be returned. We can loop through the tuple and print out the shape of these arrays.", "Notice how the shape of each of these arrays starts with a 1, 100. This is because our model can predict up to 100 objects in a single image. So for the first array, with a shape of 1, 100, 1 which means that we have 1 image, 100 potential objects, and 1 class index per object.", "And for the last array, with shape 1, 100, 4, we have 1 image, 100 potential objects. And 4 values for each object to define its bounding box.", "Since we\u2019re only performing object detection on one image, we can remove the additional batch dimension for all of the arrays and then unpack the tuple. We will give each array its own variable.", "Let\u2019s take a closer look at the object class_indexes. Although our model can potentially detect 100 objects per image, let\u2019s just take a look at the class indexes for the first ten objects.", "Our first detected object has a predicted class of 16, and we see more objects with classes 1, 7, 2, 13 and 0. After this, we have a number of objects with a class index of -1.", "-1 is a special class index that is used to indicate there is no detected object.", "Therefore, we have six detected objects in total, with the remaining 94 potential objects being padded with -1 values. We can use classes properties of the network to look up for the class labels. A top object was class 16 and while looking at the class label we can see that dog has the index 16.", "Similar to the object class_indexes, we can get the associated object class probability. We can interpret this as our confidence that the class index is correct.", "If we use a confidence threshold of 50%, we can see that three objects have been detected. Our model is very confident in two of its detections, with probability scores in the high 90s. These could be the two foreground objects. We\u2019ll see -1 again. We don\u2019t have a confidence score for padded objects.", "Four values are used to define the bounding box of each object. The coordinates for the top-left corner, and the bottom-right corner of the bounding box are given which is four values in total.", "Instead of interpreting the bounding boxes from a table let us do the visualization. CV comes with a bounding box plot function. We can provide the resized image (chw_image) from earlier. And also each of the network outputs. Optionally, we can provide the class labels to add annotations to our plot.", "The pre-trained network has done a good job of detecting objects in the image. It successfully detected a dog, a bike and a truck (with 50% confidence interval). The pre-trained network missed the tree in the background because it was pretrained on coco and coco doesn\u2019t have an object class for trees.", "In conclusion, we started by preprocessing the input image. We then loaded an object detection model from the model Zoo and used it to generate a prediction. And finally, we interpreted the network outputs and visualized the detected object.", "In the next article, we will discuss image classification problem using GluonCV.", "Be a Medium member here and support independent writing for $5/month and get full access to every story on Medium.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Graph Analytics | Data Science | Novice Blogger | Chelsea FC"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb7940670ba54&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b7940670ba54--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b7940670ba54--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rmesfrmpkr?source=post_page-----b7940670ba54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rmesfrmpkr?source=post_page-----b7940670ba54--------------------------------", "anchor_text": "Ramesh Paudel, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F596dafbd7ece&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&user=Ramesh+Paudel%2C+Ph.D.&userId=596dafbd7ece&source=post_page-596dafbd7ece----b7940670ba54---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb7940670ba54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb7940670ba54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/image-classification-using-gluoncv-f6ae5401d6ae", "anchor_text": "next article"}, {"url": "https://medium.com/@rmesfrmpkr/membership", "anchor_text": "here"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----b7940670ba54---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/gluoncv?source=post_page-----b7940670ba54---------------gluoncv-----------------", "anchor_text": "Gluoncv"}, {"url": "https://medium.com/tag/mxnet?source=post_page-----b7940670ba54---------------mxnet-----------------", "anchor_text": "Mxnet"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b7940670ba54---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb7940670ba54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&user=Ramesh+Paudel%2C+Ph.D.&userId=596dafbd7ece&source=-----b7940670ba54---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb7940670ba54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&user=Ramesh+Paudel%2C+Ph.D.&userId=596dafbd7ece&source=-----b7940670ba54---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb7940670ba54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b7940670ba54--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb7940670ba54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b7940670ba54---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b7940670ba54--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b7940670ba54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b7940670ba54--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b7940670ba54--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b7940670ba54--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b7940670ba54--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b7940670ba54--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b7940670ba54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rmesfrmpkr?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rmesfrmpkr?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ramesh Paudel, Ph.D."}, {"url": "https://medium.com/@rmesfrmpkr/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "531 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F596dafbd7ece&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&user=Ramesh+Paudel%2C+Ph.D.&userId=596dafbd7ece&source=post_page-596dafbd7ece--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdad894a77d07&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-gluoncv-b7940670ba54&newsletterV3=596dafbd7ece&newsletterV3Id=dad894a77d07&user=Ramesh+Paudel%2C+Ph.D.&userId=596dafbd7ece&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}