{"url": "https://towardsdatascience.com/develop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849", "time": 1683015605.852969, "path": "towardsdatascience.com/develop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849/", "webpage": {"metadata": {"title": "Develop an Image-to-Image Translation Model to Capture Local Interactions in Mechanical Networks (GAN) | by Adrien Saremi | Towards Data Science", "h1": "Develop an Image-to-Image Translation Model to Capture Local Interactions in Mechanical Networks (GAN)", "description": "Metamaterials are materials whose mechanical properties rely on their structure, which grants them modes of deformation that are not found in conventional systems. A popular model for metamaterials\u2026"}, "outgoing_paragraph_urls": [{"url": "https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/", "anchor_text": "article", "paragraph_index": 3}, {"url": "https://github.com/adriensaremi/Springboard/blob/master/Capstone_2%20-%20GAN%20and%20Mechanical%20Networks%20/image2image.ipynb", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://github.com/adriensaremi/Springboard/tree/master/Capstone_2%20-%20GAN%20and%20Mechanical%20Networks%20", "anchor_text": "my Github repository", "paragraph_index": 12}, {"url": "https://github.com/adriensaremi/Springboard/tree/master/Capstone_2%20-%20GAN%20and%20Mechanical%20Networks%20", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/", "anchor_text": "How to Develop a Pix2Pix GAN for Image-to-Image Translation", "paragraph_index": 20}], "all_paragraphs": ["Metamaterials are materials whose mechanical properties rely on their structure, which grants them modes of deformation that are not found in conventional systems. A popular model for metamaterials consist of building blocks connected to one another via mechanical linkages, which defines the structure of the material. These are called mechanical networks. Two mechanical networks differ from one another depending on:", "In other words, both position and connectivity of the blocks are critical to know in order to classify the system and grasp its mechanical properties. Often enough, mechanical networks are visually described by a lattice representation: points (also known as sites) represent the building blocks, and are connected by bonds (a.k.a edges). A typical mechanical network often considered in the research community is the Kagome system, drawn below.", "In some instances, specially when dealing with microscopic metamaterials, a user/researcher will deal with images of the building blocks only (the points), the connecting bonds being too small to be detected and yet still present and contributing to the mechanical properties of the system. This project is intended to use deep learning and neural networks to automatically draw the bond connections on images that contain the points only.", "To that end, we will use Dr. Jason Brownless\u2019 article on how to develop a Generative Adversarial Network (GAN) that serves as an image-to-image algorithm. By only training on 90 of images of three different mechanical networks \u2014 Kagome, triangular and square lattices \u2014 the model successfully draws connecting bonds on images of unseen systems. While the results are pretty astonishing, the architecture of the model is equally fascinating to learn about.", "The data used to train/test/validate the model consists of images generated by Mathematica, a program often used in the research and academic communities. Each image provided actually consists of a pair of images, respectively the same system (i.e. the points are identically spatially distributed) with and without the bonds. We then select 30 randomly generated Kagome lattices, along with 30 more square and 30 more triangular lattices:", "The code used here is obviously written Python and relies principally on the package Keras (along with the usual suspects numpy and matplotlib) to build and train the multiple neural networks. The notebook (which can be found here) is written via Google Colab which allows us to take advantage of Google\u2019s GPU services.", "The GAN\u2019s architecture consists of two main models that train together in an adversarial manner \u2014 the discriminator and the generator \u2014 along with other features that bind and train them together", "The discriminator is a deep Convolutional Neural Network (CNN) that takes an image shape and performs conditional-image classification. In summary, it takes the source image (without bonds) and the target image (with bonds) and classifies if the target is the real translation of the source. Prior to be fed to the network, the two images are concatenated into a single one.", "The deep CNN consists of 6 layers, each one of them downsizing the output image of the previous layer, to output a score which serves as the classification metric.", "The generator follows a U-net architecture and consists of three sections: the encoder (contraction), the bottleneck and the decoder (expansion).", "The Generative Adversarial Network (GAN) is a composite model which consists of both discriminator and generator at once. While the generator updates its weights via the discriminator, the discriminator isn\u2019t trained and updates its weights \u201con its own\u201d. The key feature is that the weights update for the discriminator needs to be slow compared to the generator, so the generator learns rapidly to draw the bonds.", "Each training step consists of using the composite model along with \u201creal\u201d images from the training data and \u201cfake\u201d generated images from the generator. The idea is that a combination of real target and fake generated images, respectively classified as 1 and 0, will help the generator build a model that converges faster toward a solution.", "There are many tunable parameters and complex designs at stake in this model. To keep this article simple and readable, I purposefully omit to mention the complexity of the code, but invite the reader to checkout my Github repository for more details.", "We train the model on 90 images, split in 3 batches, meaning there are 30 images drawn at random in each batch per epoch. We choose to train the model on 500 epochs, meaning there is a total of 500 x 30 = 15,000 iterative steps. While training the model on a local machine would likely take up to a day, Google GPU\u2019s quicken the process to less than 2 hours! Through the iterative process, we display what generated images of samples drawn at random from the training dataset look like:", "Testing the model against its own training set is a poor choice to check for its performance, but it gives us an idea on how well the generating feature is carried out. Therefore, we need to also display how the model performs on unseen data:", "Originally, my goal was to build the model against the Kagome class only. I then decided to expand the range of applications of the model to include square and triangular lattices:", "Very importantly, in addition to drawing the bonds, the 2nd model also maintains the position of the points on the generated figures, a critical property which must remain invariant, since the position of these points dictate the mechanical properties of the system (as mentioned above).", "By training on 90 pairs of images only, the model can take unseen images of partially complete mechanical networks and plot the proper bond connectivity, a critical feature to understand the mechanics of the system. In doing so, the model does not change the fundamental properties of the material(the position of the points/blocks) and provides additional information for the researcher. Excitingly enough, the model is able to distinguish and carry out its image-to-image translation feature on not just one, but three mechanical systems: Kagome, square and triangular lattices.", "While this is a satisfying result, many things can be done to improve the model\u2019s performance. In particular, we can:", "Again, code, slides and reports can be found here. All images (unless indicated otherwise) were made by the author. I\u2019d like to particularly thank my mentor at Springboard, Lucas Allen, for his guidance through this project. I also would like to thank Dr. Brownlee for his multiple online tutorials in helping developers build Machine Learning models.", "[1] J. Brownlee, How to Develop a Pix2Pix GAN for Image-to-Image Translation (2020), Machine Learning Mystery", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9c2f45230849&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c2f45230849--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c2f45230849--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://adriensaremi.medium.com/?source=post_page-----9c2f45230849--------------------------------", "anchor_text": ""}, {"url": "https://adriensaremi.medium.com/?source=post_page-----9c2f45230849--------------------------------", "anchor_text": "Adrien Saremi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd7127d8d0116&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&user=Adrien+Saremi&userId=d7127d8d0116&source=post_page-d7127d8d0116----9c2f45230849---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c2f45230849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c2f45230849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/", "anchor_text": "article"}, {"url": "https://github.com/adriensaremi/Springboard/blob/master/Capstone_2%20-%20GAN%20and%20Mechanical%20Networks%20/image2image.ipynb", "anchor_text": "here"}, {"url": "https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/", "anchor_text": "Machine Learning Mastery"}, {"url": "https://github.com/adriensaremi/Springboard/tree/master/Capstone_2%20-%20GAN%20and%20Mechanical%20Networks%20", "anchor_text": "my Github repository"}, {"url": "https://github.com/adriensaremi/Springboard/tree/master/Capstone_2%20-%20GAN%20and%20Mechanical%20Networks%20", "anchor_text": "here"}, {"url": "https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/", "anchor_text": "How to Develop a Pix2Pix GAN for Image-to-Image Translation"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9c2f45230849---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----9c2f45230849---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----9c2f45230849---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/generative-adversarial?source=post_page-----9c2f45230849---------------generative_adversarial-----------------", "anchor_text": "Generative Adversarial"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----9c2f45230849---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c2f45230849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&user=Adrien+Saremi&userId=d7127d8d0116&source=-----9c2f45230849---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c2f45230849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&user=Adrien+Saremi&userId=d7127d8d0116&source=-----9c2f45230849---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c2f45230849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c2f45230849--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9c2f45230849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9c2f45230849---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c2f45230849--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9c2f45230849--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9c2f45230849--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9c2f45230849--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9c2f45230849--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9c2f45230849--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9c2f45230849--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9c2f45230849--------------------------------", "anchor_text": ""}, {"url": "https://adriensaremi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://adriensaremi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adrien Saremi"}, {"url": "https://adriensaremi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd7127d8d0116&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&user=Adrien+Saremi&userId=d7127d8d0116&source=post_page-d7127d8d0116--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fd7127d8d0116%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-a-image-to-image-translation-model-to-capture-local-interactions-in-mechanical-networks-9c2f45230849&user=Adrien+Saremi&userId=d7127d8d0116&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}