{"url": "https://towardsdatascience.com/5-things-you-are-doing-wrong-in-pycaret-e01981575d2a", "time": 1683015891.150856, "path": "towardsdatascience.com/5-things-you-are-doing-wrong-in-pycaret-e01981575d2a/", "webpage": {"metadata": {"title": "5 things you are doing wrong in PyCaret | by Moez Ali | Towards Data Science", "h1": "5 things you are doing wrong in PyCaret", "description": "PyCaret is an open-source, low-code machine learning library in Python that automates machine learning workflows."}, "outgoing_paragraph_urls": [{"url": "https://github.com/stanfordmlgroup/ngboost", "anchor_text": "ngboost", "paragraph_index": 6}, {"url": "https://www.github.com/pycaret/pycaret/", "anchor_text": "GitHub repo", "paragraph_index": 19}, {"url": "https://www.linkedin.com/company/pycaret/", "anchor_text": "LinkedIn", "paragraph_index": 20}, {"url": "https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g", "anchor_text": "Youtube", "paragraph_index": 20}, {"url": "https://github.com/pycaret/pycaret/releases", "anchor_text": "release notes", "paragraph_index": 21}, {"url": "https://towardsdatascience.com/pycaret-2-2-is-here-whats-new-ad7612ca63b", "anchor_text": "announcement", "paragraph_index": 21}], "all_paragraphs": ["PyCaret is an open-source, low-code machine learning library in Python that automates machine learning workflows. It is an end-to-end machine learning and model management tool that speeds up the machine learning experiment cycle and makes you more productive.", "In comparison with the other open-source machine learning libraries, PyCaret is an alternate low-code library that can be used to replace hundreds of lines of code with few words only. This makes experiments exponentially fast and efficient.", "When we had released version 1.0 of PyCaret in Apr 2020, compare_models function was comparing all the models in the library to return the averaged cross-validated performance metrics. Based on which you would use create_model to train the best performing model and get the trained model output that you can use for predictions.", "This behavior was later changed in version 2.0. compare_models now returns the best model based on the n_select parameter which by default is set to 1 which means that it will return the best model (by default).", "By changing the default n_select parameter to 3, you can get a list of top 3 models. For example:", "The returned objects are trained models, you really don\u2019t need to call create_model again to train them. You can use these models to generate diagnostic plots or to even use them for predictions, if you would like. For example:", "We recieve a lot of requests to include non scikit-learn models in the model library. Many people don\u2019t realize that you are not limited to the default models only. create_model function also accepts untrained model object in addition to the ID\u2019s of models available in the model library. As long as your object is compatible with scikit-learn fit/predict API, it will work just fine. For example, here we have trained and evaluated NGBClassifier from ngboost library by simply importing untrained NGBClassifier:", "You can also pass the untrained models in the include parameter of the compare_models and it will just work normally.", "Notice that include parameters include ID\u2019s for three untrained model from the model library i.e. Logistic Regression, Decision Tree and K Neighbors and one untrained object from ngboost library. Also, notice that the index represents the position of the model entered in the include parameter.", "All training functions (create_model, tune_model, ensemble_model, etc.) in PyCaret displays a score grid but it doesn\u2019t return the score grid. Hence you cannot store the score grid in an object like pandas.DataFrame. However, there is a function called pull that allows you to do that. For example:", "This will also work for holdout score grid when you use predict_model function.", "Now that you can access metrics as pandas.DataFrame, you can do wonders. For example, you can create a loop to train a model with different parameters and create a comparison table with this simple code:", "Another common confusion is that all the preprocessing is happening behind the scenes and is not accessible to users. As such, you cannot audit what happens when you ran the setup function. This is not True.", "There are two functions in PyCaret get_config and set_config that allows you to access and change everything in the background, from your training set to the random state of your model. You can check the documentation of get_config function by simply calling help(get_config) to see which variables are accessible to you:", "You can access the variable by calling it inside the get_config function. For example to access X_train transformed dataset, you will write this:", "You can use the set_config function to change the environment variables. With what you know so far about pull, get_config, and set_config function, you can create some pretty sophisticated workflows. For example, you can resample holdout set N times to evaluate averaged performance metrics instead of relying on one holdout set:", "If you are not logging your experiments, you should start logging them now. Whether you want to use MLFlow backend server or not, you should still log all your experiments. When you perform any experiment, you generate a lot of meta data which is impossible to keep track of manually.", "PyCaret\u2019s logging functionality will generate a nice, light-weight, easy to understand excel spreadsheet when you use get_logs function. For example:", "In this very short experiment we have generated over 3,000 meta data points (metrics, hyperparameters, runtime, etc.). Imagine how you would have manually kept track of these datapoints? Perhaps, it\u2019s not practically possible. Fortunately, PyCaret provides a simple way to do it. Simply set log_experiment to True in the setup function.", "There is no limit to what you can achieve using the lightweight workflow automation library in Python. If you find this useful, please do not forget to give us \u2b50\ufe0f on our GitHub repo.", "To hear more about PyCaret follow us on LinkedIn and Youtube.", "To learn more about all the updates in PyCaret 2.2, please see the release notes or read this announcement.", "Click on the links below to see the documentation and working examples.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, Founder & Creator of PyCaret"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe01981575d2a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e01981575d2a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e01981575d2a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://moez-62905.medium.com/?source=post_page-----e01981575d2a--------------------------------", "anchor_text": ""}, {"url": "https://moez-62905.medium.com/?source=post_page-----e01981575d2a--------------------------------", "anchor_text": "Moez Ali"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffba05660b60f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&user=Moez+Ali&userId=fba05660b60f&source=post_page-fba05660b60f----e01981575d2a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe01981575d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe01981575d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@benwhitephotography?utm_source=medium&utm_medium=referral", "anchor_text": "Ben White"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.pycaret.org", "anchor_text": "https://www.pycaret.org"}, {"url": "https://pycaret.readthedocs.io/en/latest/", "anchor_text": "https://pycaret.readthedocs.io/en/latest/"}, {"url": "https://www.github.com/pycaret/pycaret", "anchor_text": "https://www.github.com/pycaret/pycaret"}, {"url": "https://github.com/stanfordmlgroup/ngboost", "anchor_text": "ngboost"}, {"url": "https://www.github.com/pycaret/pycaret/", "anchor_text": "GitHub repo"}, {"url": "https://www.linkedin.com/company/pycaret/", "anchor_text": "LinkedIn"}, {"url": "https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g", "anchor_text": "Youtube"}, {"url": "https://github.com/pycaret/pycaret/releases", "anchor_text": "release notes"}, {"url": "https://towardsdatascience.com/pycaret-2-2-is-here-whats-new-ad7612ca63b", "anchor_text": "announcement"}, {"url": "https://www.pycaret.org/guide", "anchor_text": "User Guide"}, {"url": "https://pycaret.readthedocs.io/en/latest/", "anchor_text": "Documentation"}, {"url": "https://github.com/pycaret/pycaret/tree/master/tutorials", "anchor_text": "Official Tutorials"}, {"url": "https://github.com/pycaret/pycaret/tree/master/examples", "anchor_text": "Example Notebooks"}, {"url": "https://github.com/pycaret/pycaret/tree/master/resources", "anchor_text": "Other Resources"}, {"url": "https://pycaret.readthedocs.io/en/latest/api/classification.html", "anchor_text": "Classification"}, {"url": "https://pycaret.readthedocs.io/en/latest/api/regression.html", "anchor_text": "Regression"}, {"url": "https://pycaret.readthedocs.io/en/latest/api/clustering.html", "anchor_text": "Clustering"}, {"url": "https://pycaret.readthedocs.io/en/latest/api/anomaly.html", "anchor_text": "Anomaly Detection"}, {"url": "https://pycaret.readthedocs.io/en/latest/api/nlp.html", "anchor_text": "Natural Language Processing"}, {"url": "https://pycaret.readthedocs.io/en/latest/api/arules.html", "anchor_text": "Association Rule Mining"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e01981575d2a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e01981575d2a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e01981575d2a---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----e01981575d2a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----e01981575d2a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe01981575d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&user=Moez+Ali&userId=fba05660b60f&source=-----e01981575d2a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe01981575d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&user=Moez+Ali&userId=fba05660b60f&source=-----e01981575d2a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe01981575d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e01981575d2a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe01981575d2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e01981575d2a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e01981575d2a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e01981575d2a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e01981575d2a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e01981575d2a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e01981575d2a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e01981575d2a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e01981575d2a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e01981575d2a--------------------------------", "anchor_text": ""}, {"url": "https://moez-62905.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://moez-62905.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Moez Ali"}, {"url": "https://moez-62905.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffba05660b60f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&user=Moez+Ali&userId=fba05660b60f&source=post_page-fba05660b60f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdbee44d305c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-things-you-are-doing-wrong-in-pycaret-e01981575d2a&newsletterV3=fba05660b60f&newsletterV3Id=dbee44d305c0&user=Moez+Ali&userId=fba05660b60f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}