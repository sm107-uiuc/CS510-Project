{"url": "https://towardsdatascience.com/a-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50", "time": 1682992967.7976298, "path": "towardsdatascience.com/a-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50/", "webpage": {"metadata": {"title": "A Simple Approach To Building a Recommendation System | by Molly Ruby | Towards Data Science", "h1": "A Simple Approach To Building a Recommendation System", "description": "To understand the power of recommendation systems, it is easiest to focus on Netflix, whose state of the art recommendation system keeps us in front of our TVs for hours. However, recommenders are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/olistbr/brazilian-ecommerce", "anchor_text": "sales transaction data", "paragraph_index": 2}, {"url": "https://surprise.readthedocs.io/en/stable/", "anchor_text": "Surprise", "paragraph_index": 3}, {"url": "https://www.scipy.org/scikits.html", "anchor_text": "scikit", "paragraph_index": 3}, {"url": "https://github.com/mollyliebeskind/Olist_Ecommerce_Recommendation_Engine", "anchor_text": "here.", "paragraph_index": 4}, {"url": "https://surprise.readthedocs.io/en/stable/prediction_algorithms_package.html", "anchor_text": "11 different prediction algorithms", "paragraph_index": 8}, {"url": "https://www.statisticshowto.datasciencecentral.com/rmse/", "anchor_text": "root mean squared error", "paragraph_index": 10}, {"url": "https://github.com/mollyliebeskind/Olist_Ecommerce_Recommendation_Engine", "anchor_text": "github", "paragraph_index": 19}], "all_paragraphs": ["To understand the power of recommendation systems, it is easiest to focus on Netflix, whose state of the art recommendation system keeps us in front of our TVs for hours. However, recommenders are extremely diverse, playing a role in cross-selling products, identifying employee candidates who have similar skill sets, and finding customers who will respond to promotional messaging. And these examples only just scratch the surface of how recommendations systems can be used.", "Although recommenders can be very complex, there are two simple approaches that act as a good starting point.", "This post will focus on developing a collaborative filtering recommendation system using sales transaction data released by the Brazillian e-commerce company, Olist.", "To build the recommender, we will use Surprise, a Python scikit package built for collaborative filtering.", "The first step is to load in the packages we\u2019ll need and the dataset. The dataset is made up of 8 tables but for the purposes of this demonstration, I have already joined tables and isolated the columns we need. The full code is here.", "As often happens with real-world data, this dataset is not perfectly constructed for creating a collaborative recommendation system. A big challenge here is that almost 90% of the users are first-time customers which means that we don\u2019t have previous ratings from them to identify products that like. Instead, we will separate the dataset into repeat and first time users and feed only the repeat customers into the collaborative filtering model. For first-time customers, we can still provide recommendations but they will be more generic, focused on item popularity and the user\u2019s location.", "In order to leverage surprise\u2019s built in user-ratings matrix conversion, we will need to supply a dataframe that contains a user id column, an item id column, and a rating column.", "From here, Surprise will help us generate a user-ratings matrix where each user id is a row and each product the company offers is a column. This will have the same impact as creating a Pandas pivot table. We will divide that dataframe into a train and test set with an 80/20 partition.", "Surprise offers 11 different prediction algorithms including variations of KNN and dimensionality reduction techniques such as SVD and NMF. For this demonstration, we will test out a few of the most common techniques.", "Using a 5-fold validation, we will compare the results of the following models.", "There are two ways to assess model performance. Qualitatively, you can look at a given user and determine if the recommendation makes sense given other products they like. For example, if someone likes horror movies and doesn\u2019t like romantic comedies, The Shining would be a good recommendation relative to Love Actually. For this dataset, we do not have information about each product, only a product id so we will use a quantitative measure, root mean squared error. A combination of the two methods is ideal, though a quantitive measure is much more realistic in production.", "Based on the above, we determine that SVD has the lowest rmse and is the model we will move forward with tuning.", "The surprise package offers an option to tune parameters using GridSearchCV. We will provide GridSearchCV with a dictionary of parameters and the rmse will be calculated and compared for every combination of the parameters.", "Leveraging the parameters above, we then run the model on the full train set without cross validation and obtain accuracy scores against the test set.", "The .test attribute outputs predictions that contain the user id, item id, the users actual rating, the models estimated rating, and indicator that the prediction was possible to make. In addition to looking at the model_rmse output from our final, trained model, we will look at the distribution of the absolute errors across all predictions. To do this, we will package the predictions output into a dataframe and add on a column that indicates error for each prediction. We will then visualize the results by plotting a histogram of the errors.", "In the plots below, we see that although the error on the full dataset was 1.0, when a user gave a product a rating higher than 3, the model made much better predictions and the error was only 0.8. In contrast, when a user gave a product a rating of 3 or below, the error was significantly higher at 1.5. This is a good result because to provide good recommendations, we care much more about accurately predicting the products that a user likes and rates above 3.", "The model can then be packaged using the dump module, which is a wrapper around Pickle. For this example, the collaborative filtering recommendation is just a part of the overall system. It pairs with a recommendation based on overall top selling products and top performers in each geographic region.", "To become familiar with the process, Surprise has some great built-in datasets and the documentation thoroughly explains different cross-validation approaches, similarity metrics, and prediction algorithms.", "At the moment, Surprise is not capable of handling implicit ratings, performing content filtering, or generating a hybrid recommender. However, for a beginner, Surprise is a simple and straightforward package for collaborative filtering.", "You can find all code from this example on github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd0f4de1a1f50&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@molly.ruby?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@molly.ruby?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": "Molly Ruby"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7a38f8e9fb80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&user=Molly+Ruby&userId=7a38f8e9fb80&source=post_page-7a38f8e9fb80----d0f4de1a1f50---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0f4de1a1f50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0f4de1a1f50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pandora.com/about/mgp", "anchor_text": "Pandora\u2018s music genome project"}, {"url": "https://www.kaggle.com/olistbr/brazilian-ecommerce", "anchor_text": "sales transaction data"}, {"url": "https://surprise.readthedocs.io/en/stable/", "anchor_text": "Surprise"}, {"url": "https://www.scipy.org/scikits.html", "anchor_text": "scikit"}, {"url": "https://github.com/mollyliebeskind/Olist_Ecommerce_Recommendation_Engine", "anchor_text": "here."}, {"url": "https://surprise.readthedocs.io/en/stable/prediction_algorithms_package.html", "anchor_text": "11 different prediction algorithms"}, {"url": "https://sifter.org/~simon/journal/20061211.html", "anchor_text": "Simon Funk"}, {"url": "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.113.6458&rep=rep1&type=pdf", "anchor_text": "algorithm"}, {"url": "https://www.statisticshowto.datasciencecentral.com/rmse/", "anchor_text": "root mean squared error"}, {"url": "https://github.com/mollyliebeskind/Olist_Ecommerce_Recommendation_Engine", "anchor_text": "github"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d0f4de1a1f50---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----d0f4de1a1f50---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/collaborative-filtering?source=post_page-----d0f4de1a1f50---------------collaborative_filtering-----------------", "anchor_text": "Collaborative Filtering"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d0f4de1a1f50---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----d0f4de1a1f50---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0f4de1a1f50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&user=Molly+Ruby&userId=7a38f8e9fb80&source=-----d0f4de1a1f50---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0f4de1a1f50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&user=Molly+Ruby&userId=7a38f8e9fb80&source=-----d0f4de1a1f50---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0f4de1a1f50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd0f4de1a1f50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d0f4de1a1f50---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d0f4de1a1f50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@molly.ruby?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@molly.ruby?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Molly Ruby"}, {"url": "https://medium.com/@molly.ruby/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7a38f8e9fb80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&user=Molly+Ruby&userId=7a38f8e9fb80&source=post_page-7a38f8e9fb80--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F23ca99469bed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-approach-to-building-a-recommendation-system-d0f4de1a1f50&newsletterV3=7a38f8e9fb80&newsletterV3Id=23ca99469bed&user=Molly+Ruby&userId=7a38f8e9fb80&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}