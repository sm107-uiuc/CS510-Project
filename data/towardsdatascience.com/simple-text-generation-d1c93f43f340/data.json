{"url": "https://towardsdatascience.com/simple-text-generation-d1c93f43f340", "time": 1683001761.952495, "path": "towardsdatascience.com/simple-text-generation-d1c93f43f340/", "webpage": {"metadata": {"title": "Simple Text Generation. How to teach a machine to \u201cspeak\u201d | by Jeremy Chow | Towards Data Science", "h1": "Simple Text Generation", "description": "In this article, I\u2019ll briefly go over a simple way to code and train a text generation model in Python using Keras and Tensorflow. Our goal is to train a model to emulate the speaking style of the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/jeremyrchow/text-generation-kaggle", "anchor_text": "Github link", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/spooky-author-identification", "anchor_text": "7009 sentences from Edgar Allen Poe horror stories", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Softmax_function", "anchor_text": "softmax activation function", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/building-a-growth-focused-game-recommender-for-twitch-streamers-7389e3868f2e", "anchor_text": "Growth Oriented Recommender System For Streamers", "paragraph_index": 19}], "all_paragraphs": ["If you\u2019d like to see the entire code, here is the Github link.", "In this article, I\u2019ll briefly go over a simple way to code and train a text generation model in Python using Keras and Tensorflow. Our goal is to train a model to emulate the speaking style of the text it is trained on. In this case, our data set is 7009 sentences from Edgar Allen Poe horror stories.", "The first step to training any NLP model is the tokenization of words. Here we use the Keras Tokenizer, which does the following:", "Tokenization is necessary for preparing data for embedding layer (see model architecture section below)", "Setting up training data using sliding windows. We are using a fairly rudimentary strategy of using the previous 19 words to predict the 20th word. These numbers were not selected with any concrete reasoning in mind and can definitely be tinkered with to improve.", "An embedding layer is a key layer to any sort of deep learning model that seeks to understand words. What an embedding layer does from a mathematical standpoint is take a vector from a higher dimensional space (tens of thousands or more, the original size of our vocab) to a lower dimensional space (the amount of vectors we want to represent our data in, typically 100\u2013300 in models like Word2Vec, Fasttext).", "However, it does this in such a way that words with similar meanings have similar mathematical values and exist in spaces that correspond to their meaning. Mathematical operations can be performed on these vectors, for example, \u2018king\u2019 minus \u2018man\u2019 may equal \u2018royalty\u2019.", "I\u2019m not going to go into the specifics of LSTM\u2019s here, but there are plenty of good articles to check out how they work. Some things to note:", "3. Dense (regression) layer with ReLU activation", "The output of an LSTM is the \u201chidden layer\u201d. It is common to apply a dense layer following an LSTM to further capture linear relationships, but it is not explicitly necessary.", "4. Dense layer with Softmax activation", "This layer is necessary to convert the output of the above layers into the actual word probabilities across our entire vocabulary. It uses the softmax activation function, which is a function that converts all the input word probabilities from (-\u221e,\u221e ) to (0,1). This allows us to select or generate the most probable words.", "Once we have set up our model architecture, we can train it!", "(Note that we can use checkpoints to maintain our progress in case our training gets interrupted.)", "With training complete, we now have a model that can generate text. However, we need to give it a starting point. To do this, we write a function that takes a string input, tokenizes it, then pads it with zeroes so it fits into our 19 long prediction window.", "The following is the result given the input string listed. Note that we didn\u2019t train our model with any punctuation, so sentence divisions are left up for interpretation by the reader.", "While it doesn\u2019t make the most sense, it actually seems readable and has the correct word types in the right places. Given a larger set of training data, this approach and model can be used to generate much more understandable text (most likely with some parameter tweaking, of course).", "To quantify performance, you can implement a typical train test split with the original data and rate predictions on the cosine similarity between predictions and target.", "That\u2019s all for today, thanks for reading. If you want to see more, here are some other machine learning projects I\u2019ve done that you can read about:", "Growth Oriented Recommender System For Streamers", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist passionate about using machine learning to impact business decisions and discover meaningful insights."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd1c93f43f340&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jeremyrchow?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jeremyrchow?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": "Jeremy Chow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcaf26ba3661a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&user=Jeremy+Chow&userId=caf26ba3661a&source=post_page-caf26ba3661a----d1c93f43f340---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1c93f43f340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1c93f43f340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/3YnT86K0CdE", "anchor_text": "Kaitlin Dowis"}, {"url": "https://github.com/jeremyrchow/text-generation-kaggle", "anchor_text": "Github link"}, {"url": "https://www.kaggle.com/c/spooky-author-identification", "anchor_text": "7009 sentences from Edgar Allen Poe horror stories"}, {"url": "https://arxiv.org/abs/1303.5778", "anchor_text": "these folks at Cornell"}, {"url": "https://en.wikipedia.org/wiki/Softmax_function", "anchor_text": "softmax activation function"}, {"url": "https://towardsdatascience.com/quantifying-chatroom-toxicity-e755dd2f9ccf", "anchor_text": "Quantifying Chatroom Toxicity"}, {"url": "https://towardsdatascience.com/building-a-growth-focused-game-recommender-for-twitch-streamers-7389e3868f2e", "anchor_text": "Growth Oriented Recommender System For Streamers"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d1c93f43f340---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d1c93f43f340---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d1c93f43f340---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d1c93f43f340---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----d1c93f43f340---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1c93f43f340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&user=Jeremy+Chow&userId=caf26ba3661a&source=-----d1c93f43f340---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1c93f43f340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&user=Jeremy+Chow&userId=caf26ba3661a&source=-----d1c93f43f340---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1c93f43f340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd1c93f43f340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d1c93f43f340---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d1c93f43f340--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d1c93f43f340--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d1c93f43f340--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d1c93f43f340--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jeremyrchow?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jeremyrchow?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeremy Chow"}, {"url": "https://medium.com/@jeremyrchow/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "300 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcaf26ba3661a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&user=Jeremy+Chow&userId=caf26ba3661a&source=post_page-caf26ba3661a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5950ea45395a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimple-text-generation-d1c93f43f340&newsletterV3=caf26ba3661a&newsletterV3Id=5950ea45395a&user=Jeremy+Chow&userId=caf26ba3661a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}