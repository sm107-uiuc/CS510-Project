{"url": "https://towardsdatascience.com/how-to-retrieve-historical-tick-data-from-polygon-71512f224b67", "time": 1683009964.7447119, "path": "towardsdatascience.com/how-to-retrieve-historical-tick-data-from-polygon-71512f224b67/", "webpage": {"metadata": {"title": "Polygon.io Review \u2014 Retrieving Historical Tick Data | by Mario Emmanuel | Towards Data Science", "h1": "Polygon.io Review \u2014 Retrieving Historical Tick Data", "description": "During last months one of my main objectives and one of the most time-consuming tasks has been to extract edges from tick data for Intraday operations. Within this context, a quality data feed\u2026"}, "outgoing_paragraph_urls": [{"url": "https://polygon.io/blog/understanding-the-sips/", "anchor_text": "this Blog entry", "paragraph_index": 5}, {"url": "https://polygon.io/docs/#get_v2_ticks_stocks_nbbo__ticker___date__anchor", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://ieee.shortcm.li/OP8dFS", "anchor_text": "https://ieee.shortcm.li/OP8dFS", "paragraph_index": 32}], "all_paragraphs": ["During last months one of my main objectives and one of the most time-consuming tasks has been to extract edges from tick data for Intraday operations.", "Within this context, a quality data feed becomes extremely important. I have started to use Polygon.io to get tick data from SPY as I want to test a set of discretionary strategies I have been learning during the last months. The strategies are intended to be operated on Futures but I want to evaluate if they work with other assets/instruments such as the SPY ETF and Forex instruments.", "This article covers the retrieval of historical data via their REST API. I will also briefly cover the size of the data involved.", "The first thing you need to understand is that tick data usually involves two separate data feeds. One covers the top of book, including best bid and best ask values and the other one covers the actual trades. In equities (SPY is an ETF, but ETFs are traded as equities), there are different exchanges where trade can take place. That means that there is not a central point where the trades take place. The US has currently 13 listed exchanges. Not all assets are traded in every exchange, but they are neither traded in just one. There are also dark pools and private exchanges, where Institutional players can cross orders and large brokers can also cross orders among customers.", "That means that the simplified view of a single, unified, continuous and unique stream of quotes and trades does not exist in the real world.", "All market information is consolidated by SIPs (Securities Information Processors), which are regulated entities that consolidate and provide a unified data feed on equities. They define a clear and deterministic set of rules on how trades are consolidated. The two operating SIPs in the US are The Consolidated Tape Association (CTA) and the Unlisted Trading Privileges (UTP). Those SIPs consolidate NYSE and NASDAQ listed symbols respectively. Pretty good information on how they work can be found in this Blog entry.", "While this information is not important for a retail trader (very few people understands how all this mumbo jumbo works), there is a couple of important takeaways to know:", "The situation is the same for the Depth of Book, but I will not cover that because at this moment I am not analysing Depth of book in any of my strategies.", "In order to get historic quotes, use /v2/ticks/stocks/nbbo/{ticker}/{date} request", "Historical data can be retrieved from Polygon via their REST API interface. The server will submit a maximum of 50,000 records for each request. While 50,000 records for OHLC daily data represents more than 200 years of stock market history, it is just a small fraction of the daily data volume for tick data.", "Basic date and ticker parameters are included as part of the URL:", "After a long (and often painful) work with timezones, I have concluded that an easy and consistent way is to store and process all your market data in ET. It is widely used as reference timezone for market data (sometimes even for European assets/instruments) and it is also the iconic time reference for financial markets (NYSE RTH opening is an observed daily event for everyone). This does not apply to crypto data, because it operates 24x7 and you will face issues when switching from daylight saving to non-daylight saving. In that case, it is recommended to use GMT.", "The API is fully documented here, but I highlight/comment on the following parameters. Notice that these are specified as HTTP GET parameters and not as part of the URL.", "As we have the limit of the 50,000 items, it is needed to perform pagination. To perform pagination we will simply use the timestamp parameter. The algorithm is pretty simple: if we are receiving 50,000 items we assume that an additional request is required, we specify the latest received timestamp as a parameter in the next request. We do that until the last request receives less than 50,000 items. That means that there are no more requests to be done.", "Three specific details must be taken into consideration:", "An alternative would be to add a 1 nanoseconds to the timestamp request for successive requests; this would theoretically avoid the need for duplicates in subsequent requests. As I am not 100% sure that two records can be received for the same nanosecond epoch timestamp, I have decided not to follow that path, as the previous one can handle that scenario of multiple records for the same timestamp.", "The very same algorithm is used both for Quotes and Trades (and could be coded in a separate shared method/routine).", "In order to get historic trades, use /v2/ticks/stocks/trades/{ticker}/{date} request", "As already mentioned, historical trades can be retrieved similarly. The same conditions and parameters apply.", "Historical trades shall be almost always stored and processed locally to avoid overhead. Higher timeframes can be requested on-demand, but requesting months of historical tick data on-demand on every backtesting iteration is simply not practical.", "I always try to store an easy to read and easy to parse file with raw data, using ASCII text files if possible. In this example, we create two files (quotes and trades).", "The data is stored as one JSON object per line which can be easily parsed (notice that it is also inefficient in terms of storage and performance). It uses around 450Mb per day, which is around 100Gb of data per year. If you are storing many assets, one key factor would be to pay attention to integer compression algorithms. Using proprietary and optimised databases will save space, although as a trade-off it has a cost in terms of development and debugging effort and an increase in operational complexity. I still like to have a plain backup of readable data, even if I further transform the data to a more performance-friendly format.", "We can also notice the amount of data that every trading day involves:", "SPY has an outstanding figure of 3 millions of quote ticks and more than 400K trade ticks in a single day.", "In order to use the data in any backtesting or custom tool, further processing is likely required, but as mentioned at the beginning of the article, storing data in simple ASCII readable data is useful as a permanent backup. This will simplify development and conversion time and will decouple data historical provider from our analysis toolchain.", "A simple but efficient way of improving this would be to compress both archives. In such case we get:", "By just using the standard gzip tool we get just 64Mb/day, which requires around 16Gb per year. A much more friendly storage size that can be easily fulfilled without special resources.", "Compression and decompression take time, so this shall be used only as a permanent data backup.", "A basic version of the source code to retrieve historical quotes (both quotes & trades) is included as reference below. Notice that the code is beta and not optimised, it is intended to show a use case in Java that clarifies how to access historical tick data. It can be easily ported to other languages.", "The data is retrieved in JSON format, which is a format that makes debugging easy. The tradeoff is that that JSON is far from being an efficient format. For a historical data retrieval API, this is in my opinion not relevant, especially if data is retrieved in batch mode for backtesting purposes. In that scenario, the simplicity and maintainability provided by JSON are clear advantages.", "For this particular implementation, I have used simple-json v1.1.1 as a companion library to parse JSON. This library is no longer maintained in its version 1, but it is a fully working library, extremely simple to use and lightweight.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Consultant, retail trader & lifelong learner | Linkedin https://ieee.shortcm.li/OP8dFS"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F71512f224b67&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----71512f224b67--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----71512f224b67--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@m.emmanuel?source=post_page-----71512f224b67--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.emmanuel?source=post_page-----71512f224b67--------------------------------", "anchor_text": "Mario Emmanuel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7728df51142e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&user=Mario+Emmanuel&userId=7728df51142e&source=post_page-7728df51142e----71512f224b67---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71512f224b67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71512f224b67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://polygon.io/blog/understanding-the-sips/", "anchor_text": "this Blog entry"}, {"url": "https://polygon.io/docs/#get_v2_ticks_stocks_nbbo__ticker___date__anchor", "anchor_text": "here"}, {"url": "http://twitter.com/almaz", "anchor_text": "@almaz"}, {"url": "http://twitter.com/almaz", "anchor_text": "user@almaz"}, {"url": "http://twitter.com/almaz", "anchor_text": "@almaz"}, {"url": "https://medium.com/tag/trading?source=post_page-----71512f224b67---------------trading-----------------", "anchor_text": "Trading"}, {"url": "https://medium.com/tag/money?source=post_page-----71512f224b67---------------money-----------------", "anchor_text": "Money"}, {"url": "https://medium.com/tag/data-science?source=post_page-----71512f224b67---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----71512f224b67---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/finance?source=post_page-----71512f224b67---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F71512f224b67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&user=Mario+Emmanuel&userId=7728df51142e&source=-----71512f224b67---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F71512f224b67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&user=Mario+Emmanuel&userId=7728df51142e&source=-----71512f224b67---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71512f224b67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----71512f224b67--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F71512f224b67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----71512f224b67---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----71512f224b67--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----71512f224b67--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----71512f224b67--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----71512f224b67--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----71512f224b67--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----71512f224b67--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----71512f224b67--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----71512f224b67--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.emmanuel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.emmanuel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mario Emmanuel"}, {"url": "https://medium.com/@m.emmanuel/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "977 Followers"}, {"url": "https://ieee.shortcm.li/OP8dFS", "anchor_text": "https://ieee.shortcm.li/OP8dFS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7728df51142e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&user=Mario+Emmanuel&userId=7728df51142e&source=post_page-7728df51142e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffd67658cd0f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-retrieve-historical-tick-data-from-polygon-71512f224b67&newsletterV3=7728df51142e&newsletterV3Id=fd67658cd0f9&user=Mario+Emmanuel&userId=7728df51142e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}