{"url": "https://towardsdatascience.com/multi-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6", "time": 1683017815.046638, "path": "towardsdatascience.com/multi-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6/", "webpage": {"metadata": {"title": "Multi-Output Model with TensorFlow Keras Functional API | by Andrej Baranovskij | Towards Data Science", "h1": "Multi-Output Model with TensorFlow Keras Functional API", "description": "When implementing a slightly more complex use case with machine learning, very likely you may face the situation, when you would need multiple models for the same dataset. Take for example Boston\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/boston-housing", "anchor_text": "Boston housing dataset", "paragraph_index": 0}], "all_paragraphs": ["When implementing a slightly more complex use case with machine learning, very likely you may face the situation, when you would need multiple models for the same dataset. Take for example Boston housing dataset. This dataset comes with various features and there is one target attribute \u2014 Price. We would use a single output model to predict Price. However, if in addition, we would decide to predict Pupil-Teacher Ratio by Town, we would have two outputs. The simplest option would be to create two separate models based on the same dataset to predict two variables. This would be manageable, but what if in a real scenario we would have 100 outputs. It could be a pain to manage all these separate models. Instead, it is more productive to create a single model with multiple outputs.", "My goal was to create a simple and reproducible example, which would act as a blueprint for your own implementation. An example is based on Boston housing dataset and the model implements two outputs \u2014 Price and Ptratio (Pupil-Teacher Ratio by Town).", "I\u2019m using Boston housing dataset from sklearn.datasets, this way it is easy to run notebook in Google Colab, no need to upload data separately:", "You can load the dataset and assign it to the local variable:", "For convenience, we can wrap it with Pandas dataframe:", "We should assign feature names for the dataframe columns:", "Price feature will be added to dataframe as well:", "There are 506 rows and 14 columns/features in this dataset. Price feature is described by 13 other features, in addition with choose Ptratio to be output target.", "We split data into training, test, and validation sets. Random state = 1 is used, to make sure the data is split always in the same way, to generate reproducible training results:", "There are two helper functions defined, to normalize data and process output targets. We select Price and Ptration features as targets, remove them from the dataframe:", "Next, we call the helper function to extract output targets and build stats to be used for data normalization:", "Train, test, and validation datasets are normalized using helper function:", "Here we come to the core part of this example \u2014 the function where the model is built. Look at the last line of the function, where the Model is defined. We are using an array for the outputs variable, which is assigned with two output layers. The first output layer structure is based on a single Dense layer, while the second output layer is constructed with two Dense layers. You are free to adjust and create any configuration, intermediate layers can be merged and split, this is the beauty of Keras functional API:", "The model should be compiled with loss and metrics for each of the outputs:", "Then we train the model with training and test datasets:", "When evaluating the model, we can print the loss and rmse for both outputs. Variables are returned in sequential order, in the same order as training output targets were specified:", "I don\u2019t have a goal in this example to achieve the best possible accuracy for the model, my focus is on the model structure. You may tune hyperparameters to improve accuracy.", "Predict function call returns results for both outputs, in the same sequential order:", "We can plot predicted results vs actual values for both outputs:", "We can save the model for reuse:", "To make sure the saved model works, we can restore it:", "Run predict function from the restored model. If there are no errors and results are returned, it means we are good:", "The goal of this post is to provide a simple and clean ML model with multiple outputs, running on Keras functional API. I believe handling multiple outputs in a single model can improve code quality and simplify model maintenance. Hopefully, you will find this example useful in your own implementations.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F875dd89aa7c6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andrejusb.medium.com/?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b----875dd89aa7c6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F875dd89aa7c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F875dd89aa7c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/boston-housing", "anchor_text": "Boston housing dataset"}, {"url": "https://github.com/katanaml/sample-apps/tree/master/04", "anchor_text": "GitHub"}, {"url": "https://colab.research.google.com/drive/1sZqFWkWTmv-htvL7OwiFMHX022Gy0Syf", "anchor_text": "Colab"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----875dd89aa7c6---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----875dd89aa7c6---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/python?source=post_page-----875dd89aa7c6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/api?source=post_page-----875dd89aa7c6---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F875dd89aa7c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----875dd89aa7c6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F875dd89aa7c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----875dd89aa7c6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F875dd89aa7c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F875dd89aa7c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----875dd89aa7c6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----875dd89aa7c6--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://andrejusb.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://github.com/katanaml", "anchor_text": "https://github.com/katanaml"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd22cc5338107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-output-model-with-tensorflow-keras-functional-api-875dd89aa7c6&newsletterV3=bbd1211c851b&newsletterV3Id=d22cc5338107&user=Andrej+Baranovskij&userId=bbd1211c851b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}