{"url": "https://towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2", "time": 1682995027.9762611, "path": "towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2/", "webpage": {"metadata": {"title": "How neuroscientists analyze data from transparent fish brains : part 2, clustering neural data. | by Laetitia LALLA | Towards Data Science", "h1": "How neuroscientists analyze data from transparent fish brains : part 2, clustering neural data.", "description": "In the first post (which you can read here), I described how neuroscientists could pre-process brain images from transparent fish brain into an exploitable data set : a 2D matrix [neurons x time]\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://lvdmaaten.github.io/tsne/", "anchor_text": "t-Distributed Stochastic Neighbor Embedding", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-means", "paragraph_index": 13}, {"url": "https://towardsdatascience.com/the-5-clustering-algorithms-data-scientists-need-to-know-a36d136ef68", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://towardsdatascience.com/the-5-clustering-algorithms-data-scientists-need-to-know-a36d136ef68", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/want-clusters-how-many-will-you-have-8737f4ba9bf2", "anchor_text": "this", "paragraph_index": 14}, {"url": "https://www.cell.com/current-biology/fulltext/S0960-9822(14)00016-5#secsectitle0025", "anchor_text": "this", "paragraph_index": 15}, {"url": "https://yaksilab.com/", "anchor_text": "Yaksi lab", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93", "anchor_text": "as I described in my first post", "paragraph_index": 15}], "all_paragraphs": ["In the first post (which you can read here), I described how neuroscientists could pre-process brain images from transparent fish brain into an exploitable data set : a 2D matrix [neurons x time] representing the activity of each neuron at each time point.", "In this post, we are gonna see how this data can be used to answer this question : can I group together neurons that have a similar activity profile ? Finding ensembles of neurons with the same activity is an extremely important question for neuroscientists, since groups of synchronous neurons could underlie \u201cbuilding blocks\u201d in the circuitry of the brain region.", "The first step is to normalise the activity of each neuron to substract the background activity. A baseline activity value, called F0, is determined : for example, it can be the average activity during the first 3 min of the recording. The normalisation is done by removing F0, then dividing by F0: (F \u2014 F0)/F0. The final result is thus expressed in \u0394F/F0 (shorten to \u201cDFF\u201d) : this adimensional value reprents an increase or decrease of activity, expressed in percentage, compared to the baseline. For example,", "(Note : F stands for \u201cfluoresence\u201d, since neural activity is indirectly measured by the intensity of a fluorescent light emitted by the neuron when it becomes active.)", "Once the data is normalised, it is ready for clustering. The goal is to group neurons together, so \u2014 for N neurons recorded in T timestamps \u2014 there will be N data points in a T-dimension-space. For visualisation, let\u2019s plot in a 3D space a dataset of 6 neurons during 3 time stamps :", "In fact, neurons are not recorded over 3 time steps only\u2026 The real number can be around 50000 frames (for example : 45 minutes of recording at 20Hz => 54000 recorded frames), so this plot should have 50000 dimensions\u2026", "But then, I hear you saying \u201c50000 dimensions, that\u2019s a lot ! Do I really have to keep them all ? I\u2019m sure all the dimensions are not THAT useful anyway\u201d. And you would be right : imagine that for a while, nothing happens in the brain ? (That\u2019s not physiologically likely in a healthy brain, but let\u2019s pretend). Or that at some point, ALL the neurons are suddenly super active : that could be possible, but that would not be very informative if our goal is to group neurons in several clusters\u2026 So, before clustering, we can reduce the very high dimensionality of our data set with PCA (Principal Component Analysis).", "Dimensionality reduction has been described in many posts, so i\u2019ll keep it short here. Let\u2019s look at a simple 2D dataset displayed below in the figure a): the ages and heights of a dozen of people. We can see in b) that there is a general \u201ctrend\u201d that the data follow, represented by the arrow. If we project the data points on that arrow (as in c), we still have a decent idea regarding the spread of the data. This \u201ctrend\u201d is the first Principal Component (PC). In the panel d), we can choose to represent our data in only one dimension, instead of two. We reduced the number of dimension but we still capture important information about the data set.", "The goal of PCA is to compute the Principal Components based on the \u201coriginal\u201d components of the dataset (here, the age and height). Helped by the schematics above, you may have noticed that the arrow captures the direction where the variance of the dataset is maximized or, in simpler words, that the 2 points that were the most far away in the original space (in a) are still the most far away in the PCs space (in d). The rationale behind the PCA is thus to find the dimensions where the variance in the dataset is maximal.", "(Remark : this is a completely different rationale for the tSNE \u2014 t-Distributed Stochastic Neighbor Embedding \u2014 which is also a dimensionality reduction technique widely used in Neuroscience for the visualization of high-dimensional datasets. That will be described in a next post !)", "One way to do this is to compute the covariance matrix of your data set and to diagonalize it. Thus, you find a new space where the covariance matrix is diagonal : the eigenvectors are the Principal Components and the eigenvalues quantify the percentage of variance explained by each Principal Component. With PCA, the Principal Components are thus orthogonal.", "Since the Principal Components are obtained by a combination of the original components, they do not necessarily \u201cmean\u201d anything relevant regarding the data. In my example, the value along the first PC would be the square root of the age squared plus the height squared\u2026 This combination allows us to keep only one dimension.", "In our neural dataset, the first dimension is the number of neurons (several hundreds). With PCA, we can reduce the second dimension from ~50000 (times frames) to 10 (Principal Components).", "Once the data is normalised and the second dimension is reduced, we can use a simple and well-known algorithm for clustering : K-means. Again, many TDS posts are already devoted to this algorithm (you can watch an animation here). Hence, I will just briefly comment the famous scheme from Bishop\u2019s book. In the following 2D data set, I want to make 2 groups :", "(Remark : As discussed here, the number of clusters K has to be chosen by the user. With simple datasets, this may be done by visual inspection. But with high-dimensional datasets, choosing the right K can be tricky. Several methods exist to help you find an appropriate K as described in this post.)", "Using PCA and K-means, neuroscientists can group together neurons with similar activity. Let\u2019s look at an example from this study by the Yaksi lab in Norway. The researchers investigated the sense of smell in the zebrafish and how odors are processed in the brain. They imaged the habenula (a brain region thought to integrate information from the sensory areas) and detected the neurons as I described in my first post.", "In the first part of the experiment, the researchers did nothing specific, but some neurons were active anyway. This is called \u201cspontaneous activity\u201d. The scientists performed a PCA and a K-means (asking for K=6) and grouped the neurons in 6 clusters based on their activity in time. The first thing we can see is that the spontaneous activity is not random, and that neurons with similar activity are spatially close ! The following figure shows the activity profile of the neurons, grouped in clusters, and the position of each neuron in the habenula : neurons represented by the same color belong to the same cluster.", "In the second part of the experiment, the researchers delivered an odor to the fish through the water (times of the delivery indicated by the arrows in the following picture). Again, they performed a PCA and a K-means with K=6 and noticed that the clusters during odor delivery were very similar to the ones during spontaneous acitivity.", "Hence, the neurons that are synchronous spontaneously are also most likely to be synchronous during odor processing ! It is like some neurons were already \u201cpre-wired\u201d together, making them more likely to respond to an odor in a similar fashion.", "How is spontaneous activity organized in the brain ? What does that imply for information processing ? Those are excellent questions that animates many neuroscientists !", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "(Neural) data scientist, Post-doc in Neurosciences in Trondheim, Norway. Loves Nature \ud83c\udfd5\ufe0f, Travels \ud83c\udfde\ufe0f, Science \ud83d\udc69\u200d\ud83d\udd2c and the brain"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc1b974a146e2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@laetitialalla?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laetitialalla?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": "Laetitia LALLA"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd23d1fd23a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=post_page-fd23d1fd23a0----c1b974a146e2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1b974a146e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1b974a146e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93", "anchor_text": "here"}, {"url": "https://www.cell.com/pictureshow/neural-mapping", "anchor_text": "here"}, {"url": "https://lvdmaaten.github.io/tsne/", "anchor_text": "t-Distributed Stochastic Neighbor Embedding"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-means"}, {"url": "https://towardsdatascience.com/the-5-clustering-algorithms-data-scientists-need-to-know-a36d136ef68", "anchor_text": "here"}, {"url": "https://www.springer.com/fr/book/9780387310732", "anchor_text": "Pattern recognition and machine learning"}, {"url": "https://towardsdatascience.com/the-5-clustering-algorithms-data-scientists-need-to-know-a36d136ef68", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/want-clusters-how-many-will-you-have-8737f4ba9bf2", "anchor_text": "this"}, {"url": "https://www.cell.com/current-biology/fulltext/S0960-9822(14)00016-5#secsectitle0025", "anchor_text": "this"}, {"url": "https://yaksilab.com/", "anchor_text": "Yaksi lab"}, {"url": "https://towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93", "anchor_text": "as I described in my first post"}, {"url": "https://www.cell.com/current-biology/fulltext/S0960-9822(14)00016-5#figures", "anchor_text": "here"}, {"url": "https://www.cell.com/current-biology/fulltext/S0960-9822(14)00016-5#figures", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c1b974a146e2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pca?source=post_page-----c1b974a146e2---------------pca-----------------", "anchor_text": "Pca"}, {"url": "https://medium.com/tag/clustering?source=post_page-----c1b974a146e2---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c1b974a146e2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----c1b974a146e2---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc1b974a146e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=-----c1b974a146e2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc1b974a146e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=-----c1b974a146e2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1b974a146e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc1b974a146e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c1b974a146e2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c1b974a146e2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c1b974a146e2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c1b974a146e2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c1b974a146e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laetitialalla?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laetitialalla?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Laetitia LALLA"}, {"url": "https://medium.com/@laetitialalla/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "66 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd23d1fd23a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=post_page-fd23d1fd23a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ffd23d1fd23a0%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-2-clustering-neural-data-c1b974a146e2&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}