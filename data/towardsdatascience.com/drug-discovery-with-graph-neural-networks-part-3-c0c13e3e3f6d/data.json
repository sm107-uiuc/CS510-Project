{"url": "https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d", "time": 1683013129.2498088, "path": "towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d/", "webpage": {"metadata": {"title": "Drug Discovery with Graph Neural Networks \u2014 part 3 | by Kacper Kubara | Towards Data Science", "h1": "Drug Discovery with Graph Neural Networks \u2014 part 3", "description": "Explanations Techniques help us understand the model\u2019s behaviour. For example, explanation methods are used to visualize certain parts of the image or to see how it reacts to a certain input. It is a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/towards-explainable-graph-neural-networks-45f5e3912dd0", "anchor_text": "my previous article", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/towards-explainable-graph-neural-networks-45f5e3912dd0", "anchor_text": "my article", "paragraph_index": 7}, {"url": "https://github.com/RexYing/gnn-model-explainer", "anchor_text": "You can find the GNNExplainer repository here.", "paragraph_index": 8}, {"url": "https://github.com/KacperKubara/ml-cookbook/blob/master/drug_discovery_with_gnns/gnn_explainer_setup.md", "anchor_text": "Link to the installation instructions with my personal notes.", "paragraph_index": 9}, {"url": "https://docs.conda.io/en/latest/miniconda.html", "anchor_text": "have conda installed", "paragraph_index": 12}, {"url": "https://github.com/RexYing/gnn-model-explainer/blob/master/INSTALLATION.md", "anchor_text": "Github", "paragraph_index": 12}, {"url": "https://gist.github.com/KacperKubara/d8f3d729e90499871541267ac426921c", "anchor_text": "my gist", "paragraph_index": 17}, {"url": "https://pytorch-geometric.readthedocs.io/en/latest/_modules/torch_geometric/nn/models/gnn_explainer.html", "anchor_text": "PyTorch Geometric package", "paragraph_index": 23}, {"url": "http://www.linkedin.com/in/kacperkubara", "anchor_text": "www.linkedin.com/in/kacperkubara", "paragraph_index": 28}], "all_paragraphs": ["Explanations Techniques help us understand the model\u2019s behaviour. For example, explanation methods are used to visualize certain parts of the image or to see how it reacts to a certain input. It is a well-established field of machine learning that has many different techniques which can be applied to deep learning (e.g. class activation maps, gradient attribution) and to other machine learning algorithms (e.g. LIME).", "However, there have been only a few attempts to create explanation methods for graph neural networks (GNNs). Most of the \u201creuse\u201d methods that were developed in deep learning and try to apply them in the graph domain.", "If you would like to learn more about state-of-the-art research on explainable GNNs, I would highly recommend looking over my previous article. Here, I will keep the theory short and focus on how to use the existing GNN explanation package, GNNExplainer.", "Deep learning models can have millions of parameters and they often appear to us as a black box [1]. It is hard to say how the model will react to new data and why it makes certain predictions given a specific input.", "With the explanation methods, we hope to develop trust in the model. They provide additional insights from the model which makes it more transparent and explainable. By developing trust in the model, we can safely deploy the model for wider use.", "Unfortunately, the research on explanation methods for GNNs is quite new so there are not many ready-to-use tools and research papers. One of the first works on this topic was done by Duvenaud et al. in [2]. He managed to create a gradient-attribution method that highlights certain molecular substructures that trigger the predictions. For example, their method can highlight molecules substructures that make the molecule toxic or soluble in water.", "Fortunately, researchers from Stanford University developed a model-agnostic GNN explanation method, GNNExplainer [3]. In the remainder of the article, we will explore how to use their tool.", "If you don\u2019t have time to read the whole paper on the GNNExplainer implementation, but you still would like to get an intuitive understanding of how it works, have a look at my article.", "You can find the GNNExplainer repository here.", "Link to the installation instructions with my personal notes.", "The GNNExplainer is de facto the first model-agnostic open-source tool that can be used for GNN explanations. The researchers from Stanford University made a great job creating this tool for common use but it contains few bugs and is rather quite difficult to setup. In this guide, I will discuss some problems that I\u2019ve faced during the installation and guide you on how to create GNN explanations as on the GIF above.", "Please note: my setup is Windows OS with the CUDA enabled GPU. The installation instructions might not work for a different setup. I will, however, try to point out the steps that you might have to adjust to make it work for other OS requirements. If you are just curious how this package works and you don\u2019t have time to install it, please skip this instruction.", "To install the GNNExplainer, a prerequisite is to have conda installed. The installation instructions for their repository are also available on Github. They didn\u2019t work for my setup and also had few mistakes, so I spend some time adjusting the installation instructions for my needs. The working instructions for my setup are below. If you have a different OS, you might need to change the cudatoolkit version, or install Pytorch without the CUDA support.", "The authors provided a GNN model and few graph datasets as an example. It is a good starting point to test if everything works correctly and to understand the package a bit more.", "Once the package is installed, run:", "This will train the provided GNN model on the example syn2 data. It might even take half an hour so prepare yourself! Syn2 is a synthetic dataset created by authors and called \u201cRandom BA graph with community features\u201d. The ground truth for the GNNExplainer model is a \u201chouse-like\u201d structure (look at the GIF above). This is a set of nodes that GNNExplainer will try to find.", "To run the GNNExplainer with the model trained on the Syn2 dataset, run:", "This will create an explanation file which can be then visualized using the Jupyter notebook. I did encounter an error while running it. There is a problem with saving the accuracy/loss figures at the end of the script. The required explanations are computed before that step so the issue is not crucial. If you want to still fix this issue and save the plots, replace the explain.py file with my gist that modifies the save paths. They will be located in the log/ folder.", "The authors provide us with two notebooks to visualize the results. They\u2019re pretty much the same, but the interactive notebook contains additional interactive examples for the explanations.", "Before you launch a chosen notebook from the notebooks/ folder, you have to make one more adjustment. Go to log/ folder and move all of the files starting with masked_ to the syn2_base_h20_020_explain/ folder. This will ensure that we don\u2019t have to change any paths in the notebook code.", "The notebook is quite straightforward and you just need to run all cells to generate the plots. For the syn2 dataset, they should look similarly to the one below:", "You can use potentially use this software to run it with Tox21, Mutagenicity, or custom graph datasets. In order to do that, have a look at the original repository instructions.", "I managed to train the GNN model on Tox21 dataset. However, it seems like there are bugs in the software and the model is not saved after the training which makes it impossible to run the explainer. Hopefully, they will fix it soon.", "The GNNExplainer is also a part of the PyTorch Geometric package. However, it supports only node explanations and it doesn\u2019t have the visualizations utilities supplied by the original package. Anyway, it\u2019s still might be worth looking into it.", "Thank you for reading the article, I hope it was useful for you!", "I am an MSc Artificial Intelligence student at the University of Amsterdam. In my spare time, you can find me fiddling with data or debugging my deep learning model (I swear it worked!). I also like hiking :)", "Here are my social media profiles, if you want to stay in touch with my latest articles and other useful content:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MSc in Artificial Intelligence at the University of Amsterdam | www.linkedin.com/in/kacperkubara"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc0c13e3e3f6d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kacperkubara?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": "Kacper Kubara"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fada6808c0b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&user=Kacper+Kubara&userId=ada6808c0b73&source=post_page-ada6808c0b73----c0c13e3e3f6d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0c13e3e3f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0c13e3e3f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-1-1011713185eb", "anchor_text": "Drug Discovery with Graph Neural Networks \u2014 part 1"}, {"url": "https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4", "anchor_text": "Drug Discovery with Graph Neural Networks \u2014 part 2"}, {"url": "https://towardsdatascience.com/towards-explainable-graph-neural-networks-45f5e3912dd0", "anchor_text": "Towards Explainable Graph Neural Networks"}, {"url": "https://medium.com/me/stats/post/625f4c5fb8cd", "anchor_text": "Feature Extraction for Graphs"}, {"url": "https://towardsdatascience.com/towards-explainable-graph-neural-networks-45f5e3912dd0", "anchor_text": "Towards Explainable Graph Neural Networks"}, {"url": "https://towardsdatascience.com/machine-learning-tasks-on-graphs-7bc8f175119a", "anchor_text": "Machine Learning Tasks on Graphs"}, {"url": "http://cnnlocalization.csail.mit.edu/", "anchor_text": "[Source]"}, {"url": "https://towardsdatascience.com/towards-explainable-graph-neural-networks-45f5e3912dd0", "anchor_text": "my previous article"}, {"url": "https://arxiv.org/abs/1509.09292", "anchor_text": "[Source]"}, {"url": "https://towardsdatascience.com/towards-explainable-graph-neural-networks-45f5e3912dd0", "anchor_text": "my article"}, {"url": "https://github.com/RexYing/gnn-model-explainer", "anchor_text": "You can find the GNNExplainer repository here."}, {"url": "https://github.com/KacperKubara/ml-cookbook/blob/master/drug_discovery_with_gnns/gnn_explainer_setup.md", "anchor_text": "Link to the installation instructions with my personal notes."}, {"url": "https://docs.conda.io/en/latest/miniconda.html", "anchor_text": "have conda installed"}, {"url": "https://github.com/RexYing/gnn-model-explainer/blob/master/INSTALLATION.md", "anchor_text": "Github"}, {"url": "https://gist.github.com/KacperKubara/d8f3d729e90499871541267ac426921c", "anchor_text": "my gist"}, {"url": "https://pytorch-geometric.readthedocs.io/en/latest/_modules/torch_geometric/nn/models/gnn_explainer.html", "anchor_text": "PyTorch Geometric package"}, {"url": "https://medium.com/@kacperkubara", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/kacperkubara/", "anchor_text": "Linkedin"}, {"url": "https://github.com/KacperKubara", "anchor_text": "Github"}, {"url": "https://kacperkubara.com/", "anchor_text": "Personal Website"}, {"url": "https://arxiv.org/pdf/1803.07517.pdf", "anchor_text": "https://arxiv.org/pdf/1803.07517.pdf"}, {"url": "https://arxiv.org/abs/1509.09292", "anchor_text": "https://arxiv.org/abs/1509.09292"}, {"url": "https://arxiv.org/abs/1903.03894", "anchor_text": "https://arxiv.org/abs/1903.03894"}, {"url": "https://medium.com/tag/graph-neural-networks?source=post_page-----c0c13e3e3f6d---------------graph_neural_networks-----------------", "anchor_text": "Graph Neural Networks"}, {"url": "https://medium.com/tag/gnnexplainer?source=post_page-----c0c13e3e3f6d---------------gnnexplainer-----------------", "anchor_text": "Gnnexplainer"}, {"url": "https://medium.com/tag/cheminformatics?source=post_page-----c0c13e3e3f6d---------------cheminformatics-----------------", "anchor_text": "Cheminformatics"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c0c13e3e3f6d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----c0c13e3e3f6d---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc0c13e3e3f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&user=Kacper+Kubara&userId=ada6808c0b73&source=-----c0c13e3e3f6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc0c13e3e3f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&user=Kacper+Kubara&userId=ada6808c0b73&source=-----c0c13e3e3f6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0c13e3e3f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc0c13e3e3f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c0c13e3e3f6d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c0c13e3e3f6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kacperkubara?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kacper Kubara"}, {"url": "https://medium.com/@kacperkubara/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "622 Followers"}, {"url": "http://www.linkedin.com/in/kacperkubara", "anchor_text": "www.linkedin.com/in/kacperkubara"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fada6808c0b73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&user=Kacper+Kubara&userId=ada6808c0b73&source=post_page-ada6808c0b73--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F378c2694fea3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdrug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d&newsletterV3=ada6808c0b73&newsletterV3Id=378c2694fea3&user=Kacper+Kubara&userId=ada6808c0b73&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}