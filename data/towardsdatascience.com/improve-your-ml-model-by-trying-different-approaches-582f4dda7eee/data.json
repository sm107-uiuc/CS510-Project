{"url": "https://towardsdatascience.com/improve-your-ml-model-by-trying-different-approaches-582f4dda7eee", "time": 1683001379.415354, "path": "towardsdatascience.com/improve-your-ml-model-by-trying-different-approaches-582f4dda7eee/", "webpage": {"metadata": {"title": "Improve your ML model by trying different approaches | by Karan Bhanot | Towards Data Science", "h1": "Improve your ML model by trying different approaches", "description": "In this article, we\u2019ll take a look at the recent project I completed where I predicted the prices of used cars based on a number of factors. I found the dataset on Kaggle. This project is special as\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/avikasliwal/used-cars-price-prediction", "anchor_text": "Kaggle", "paragraph_index": 0}], "all_paragraphs": ["In this article, we\u2019ll take a look at the recent project I completed where I predicted the prices of used cars based on a number of factors. I found the dataset on Kaggle.", "This project is special as I tried many different things and then finalized on the notebook that is included as part of the repository. I\u2019ll explain each and every step I thought and how it turned out to be. The repository with the code is below:", "Here\u2019s the crux of the article:", "If you still want the complete details, keep reading!", "I\u2019ll import datetime library to work with the Year column. The numpy and pandas libraries help me work with the dataset. matplotlib and seaborn help in plotting which I didn\u2019t do much in this project. Finally, I import a number of things from sklearn especially metrics and models.", "The original Kaggle dataset had two files: train-data.csv and test-data.csv. However, the final output labels for the file test-data.csv were not given and hence, I would never be able to test my model. Thus, I decided to just work with the train-data.csv and rename it as dataset.csv inside the data folder.", "I then split the dataset into 70% training and 30% testing data.", "I output the training data information to see what the data looks like. We find that some columns like Mileage, Engine, Power and Seats have a few null values while New_Price has majority of its values missing. To get a better essence of what each column really represents, we can take a look at the Kaggle dashboard that has the data description.", "The dataset is now loaded and we know what each column means. It\u2019s now time to do some exploratory analysis. Note that I will always work with training part and then transform the test part based on the training part only.", "Here, we\u2019ll explore each of the columns above and discuss their relevance.", "The first column in the dataset is unnamed. It is actually just an index for each row and thus, we can safely remove this column.", "The Name column defines the name of each car. I thought the car name might not have a huge impact but the manufacturer of the car can. For example, if generally people find Maruti to produce reliable cars, their resale values should be higher. Thus, I decided to extract the Manufacturer from each Name. The first word of each Name is the manufacturer.", "Let\u2019s also plot and see the count of each cars based on the manufacturer.", "As we can see in the plot above, Maruti has the maximum number of cars and Lamborghini has the least number of cars in the whole training data. Also, I don\u2019t need the Name column so I dropped it.", "I initially tried to use Location but it lead to many one hot columns without contributing much towards the prediction help. This means that location of selling has almost negligible effect on the final resale price of a car. Thus, I decided to drop this column.", "I initially kept Year as it is to define the make of the model. But later did I realize that rather than the year, it\u2019s how old the car is that has an effect on the resale value. Thus, taking cues from Kaggle, I decided to replace Year with the age of the car by subtracting the year from current year.", "All these columns are categorical columns. Thus, I\u2019ll create dummy columns for each of these columns and use it for prediction.", "The data output shows the high values that exist in the column. We should scale the data as well else columns like Kilometers_Driven can have a much stronger effect on prediction than other columns.", "Mileage defines the mileage of the car. However, the mileage units vary based on the type of engine e.g. some are per Kg while some are per L. But for this case, we\u2019ll consider them equivalent and just extract the numbers from this column.", "As we checked before, the Mileage column had some missing values so let\u2019s check them and update the null values with the mean of the column.", "The Engine values are defined in CC so I need to remove CC from the data. Similarly, Power has bhp, so I\u2019ll remove bhp from it. Also, as there are missing values in all three, I\u2019ll again replace them with the mean as I did for Mileage.", "I use pd.to_numeric() as handles null values and does not produce errors when converting from string to numerical (int or float).", "Most of the values in the column are missing. I initially decided to fill them up. I would fill the mean value based on the manufacturer. For example, for Ford, I\u2019d take all values that are present, take their mean and then replace all null values of New_Price for Ford with that mean. However, this still left out a few null values. I would then fill these null values with mean of all the values in the column. The same was repeated for test data as well.", "However, this approach wasn\u2019t really successful. I tried to run the Random Forest Regressor on it and the results were very small r2_score values. Next, I decided that I would simply drop the column and the r2_score values improved significantly.", "Here, I\u2019ll create dummy columns using pd.get_dummies for all categorical variables.", "However, it is quite possible that due to lack of all types in test data, there may be missing columns. Let\u2019s understand it with an example. For example in the column Transmission, the training data includes Manual and Automatic so the dummies would be like Transmission_Manual and Transmission_Automatic. But what if the test data has only Manual value and no Automatic one. In such a case, dummies would only lead to Transmission_Manual. This will leave the test dataset one column short in comparison to training data and the prediction won\u2019t work. To handle this, we create columns in test data that are missing and fill them with zero. Finally, we order the test data just like train data.", "I\u2019ll create a Linear Regression and a Random Forest model to train on the data and compare the r2_score values to select the best pick.", "I get the r2_score for Linear Regression as 0.70 and for Random Forest as 0.88. Thus, Random Forest performed really well on the test data.", "In this article, we saw how to approach a machine learning problem in real life and how we might tweak features based on their relevance and the information they give out.", "Please feel free to share your thoughts and ideas. I\u2019d love to hear from you!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data science and Machine learning enthusiast. Technical Writer. Passionate Computer Science Engineer."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F582f4dda7eee&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bhanotkaran22?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanotkaran22?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": "Karan Bhanot"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F10df94b13417&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&user=Karan+Bhanot&userId=10df94b13417&source=post_page-10df94b13417----582f4dda7eee---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F582f4dda7eee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F582f4dda7eee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jentheodore?utm_source=medium&utm_medium=referral", "anchor_text": "Jen Theodore"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/avikasliwal/used-cars-price-prediction", "anchor_text": "Kaggle"}, {"url": "https://github.com/kb22/Used-Car-Price-Prediction", "anchor_text": "kb22/Used-Car-Price-PredictionYou can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or\u2026github.com"}, {"url": "https://towardsdatascience.com/how-i-used-python-and-r-to-analyze-and-predict-medical-appointment-show-ups-cd290cd3fad0", "anchor_text": "How I used Python and R to analyze and predict Medical Appointment show ups!A world where R and Python live togethertowardsdatascience.com"}, {"url": "https://towardsdatascience.com/seaborn-lets-make-plotting-fun-4951b89a0c07", "anchor_text": "Seaborn \u2014 Let\u2019s make plotting funIntroduction to Seaborn library in Pythontowardsdatascience.com"}, {"url": "https://towardsdatascience.com/using-deep-learning-to-save-lives-by-ensuring-drivers-attention-e9ab39c03d07", "anchor_text": "Using Deep learning to save lives by ensuring driver\u2019s attentionConvolutional Neural Networks in real lifetowardsdatascience.com"}, {"url": "https://towardsdatascience.com/plotting-business-locations-on-maps-using-multiple-plotting-libraries-in-python-45a00ea770af", "anchor_text": "Plotting business locations on maps using multiple Plotting libraries in PythonComparing Map Plotting librariestowardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----582f4dda7eee---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----582f4dda7eee---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----582f4dda7eee---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/productivity?source=post_page-----582f4dda7eee---------------productivity-----------------", "anchor_text": "Productivity"}, {"url": "https://medium.com/tag/data?source=post_page-----582f4dda7eee---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F582f4dda7eee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&user=Karan+Bhanot&userId=10df94b13417&source=-----582f4dda7eee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F582f4dda7eee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&user=Karan+Bhanot&userId=10df94b13417&source=-----582f4dda7eee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F582f4dda7eee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F582f4dda7eee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----582f4dda7eee---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----582f4dda7eee--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----582f4dda7eee--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----582f4dda7eee--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----582f4dda7eee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanotkaran22?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanotkaran22?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Karan Bhanot"}, {"url": "https://medium.com/@bhanotkaran22/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F10df94b13417&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&user=Karan+Bhanot&userId=10df94b13417&source=post_page-10df94b13417--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb37e4ce06e02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimprove-your-ml-model-by-trying-different-approaches-582f4dda7eee&newsletterV3=10df94b13417&newsletterV3Id=b37e4ce06e02&user=Karan+Bhanot&userId=10df94b13417&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}