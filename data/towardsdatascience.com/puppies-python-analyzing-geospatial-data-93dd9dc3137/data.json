{"url": "https://towardsdatascience.com/puppies-python-analyzing-geospatial-data-93dd9dc3137", "time": 1683001854.638535, "path": "towardsdatascience.com/puppies-python-analyzing-geospatial-data-93dd9dc3137/", "webpage": {"metadata": {"title": "Puppies & Python: Analyzing Geospatial Data | by Allison Stafford | Towards Data Science", "h1": "Puppies & Python: Analyzing Geospatial Data", "description": "When I started my first project rooted in geospatial data, I did not realize the level of challenge I was taking on \u2014 not quite biting off more than I could chew, but definitely a mouthful for where\u2026"}, "outgoing_paragraph_urls": [{"url": "http://geopandas.org/", "anchor_text": "geopandas", "paragraph_index": 2}, {"url": "http://geopandas.org/install.html", "anchor_text": "their directions", "paragraph_index": 3}, {"url": "https://data.seattle.gov/Community/Seattle-Pet-Licenses/jguv-t9rb", "anchor_text": "pet licenses", "paragraph_index": 5}, {"url": "http://data-seattlecitygis.opendata.arcgis.com/datasets/83fc2e72903343aabff6de8cb445b81c_2", "anchor_text": "zip codes", "paragraph_index": 5}, {"url": "http://data-seattlecitygis.opendata.arcgis.com/datasets/municipal-boundaries", "anchor_text": "boundaries", "paragraph_index": 5}, {"url": "http://data-seattlecitygis.opendata.arcgis.com/datasets/city-of-seattle-shoreline", "anchor_text": "shoreline", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Shapefile", "anchor_text": "article", "paragraph_index": 8}, {"url": "https://shapely.readthedocs.io/en/stable/manual.html", "anchor_text": "shapely", "paragraph_index": 15}, {"url": "http://geopandas.org/", "anchor_text": "geopandas", "paragraph_index": 15}, {"url": "https://shapely.readthedocs.io/en/stable/manual.html#object.contains", "anchor_text": "contains()", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/SuperValu_(United_States)", "anchor_text": "Supervalue", "paragraph_index": 35}, {"url": "https://www.google.com/maps/@47.5101408,-122.2903633,1106m/data=!3m1!1e3", "anchor_text": "check it out yourself", "paragraph_index": 35}, {"url": "https://github.com/allisonhonold/geospatial_data_blog", "anchor_text": "here", "paragraph_index": 41}, {"url": "https://medium.com/u/60c1c7acc358?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "Shahid Nawaz Khan", "paragraph_index": 42}], "all_paragraphs": ["So you\u2019re interested in data that has a geospatial component? Cool! Me too!", "When I started my first project rooted in geospatial data, I did not realize the level of challenge I was taking on \u2014 not quite biting off more than I could chew, but definitely a mouthful for where I was at the time.", "My quick google search lead me, and probably you, straight to geopandas.", "I had a lot of package conflicts with the geopandas installation originally, including numpy and pretty much everything I had in my project environment. I then followed their directions and installed geopandas first thing in a new environment on the conda-forge channel. Worked like a charm!", "In your new environment, you\u2019ll also need to conda install descartes and matplotlib to get the full functionality.", "In today\u2019s example, I am doing some research for my next move: where can I find the highest density of pets in Seattle? I want to ogle all the pets as I walk, skip, and yog around my future neighborhood. For this, I downloaded files from the City of Seattle\u2019s Open Data on pet licenses and shape data on the zip codes, municipal boundaries, and shoreline (so we can see the outline of Seattle we know and love).", "When I downloaded and unzipped my first shapefile, I only moved the .shp file into my directory, thinking, \u201cmaybe these other files work with different programs.\u201d But no.", "Even though whatever package you\u2019re using to read shape files will likely only require a single .shp file path, they need the whole file set in that same directory in order to work:", "Sometimes there are other files too. Check out this article for more info. Now, instead of worrying too much about which I want or need, I just unzip the set in my target directory. Then you know you\u2019ll have whatever good stuff your data source provided.", "Also note: all the files must have the same filename, with the only difference being the extension/suffix. So if you like to change file names to remove spaces, capital letters, etc (just a recovering perfectionist thing?), make sure that you change the names for ALL of the files that came in the package, and watch out for typos.", "When you\u2019re thinking about a shapefile, always add that trailing s \u2014 shapefiles.", "In the search for max pet density, it was just a couple lines of code to get me started with the shapes in GeoDataFrames:", "Note here that seattle_shp is a shapely Polygon and calling it in a Jupyter notebook displays an image of the shape. Alternatively, waterfront is a GeoDataFrame \u2014 so you can visualize it with waterfront.plot(). Keeping track of object types will save you headaches and time! Or at least is a good place to start when something isn\u2019t working as you expected.", "First off, I noticed that the zip code file on Seattle Open Data actually has the shape files for zip codes in several Washington counties. I needed to whittle down the zip codes to only those in Seattle. I quickly realized that the zip code boundaries in the Seattle area do not align with the city boundaries.", "Here\u2019s where geopandas\u2019s wrapping of all those other packages, including shapely, comes in handy (even if it makes it a struggle to install).", "In order to combine data from different sources and get exactly the data you want, I have found the shapely functions to be extremely useful. Conveniently, they work great on GeoDataFrames, computing on each line and with a single line of code (just call geo_df.shapely_function()). Some of the shapely functions are described in the geopandas docs, but geopandas does not include documentation on all the shapely functions. I was pleasantly surprised when the additional functions described in the shapely docs, but not in geopandas worked as well, especially intersection!", "object.within(other) \u2014 Returns True if the object\u2019s boundary and interior intersect only with the interior of the other (not its boundary or exterior). This applies to all types and is the inverse of contains().*", "So I tried it out. Here, zip_codes_gdf.within(seattle_shp) returns a series of True and False, one for each record in the GeoDataFrame. This series, used with .loc creates a new GeoDataFrame containing only the records (zip codes and their shapes) that are wholly within Seattle.", "Next, I plotted my result, along with the Seattle outline and waterfront.", "Zip codes that cross into other cities beyond Seattle were excluded from this selection process using the within() function. This function would be great if the zip codes lined up with the city boundaries. Unfortunately, this is not the case, so I continued my search for a better zip code selection function.", "object.intersects(other) \u2014 Returns True if the boundary or interior of the object intersect in any way with those of the other. In other words, geometric objects intersect if they have any boundary or interior point in common.*", "Now we\u2019re on the right track, with all of Seattle represented. Now I want to take out all that area outside the city limits. If I calculate the pet density using the number of pets registered in Seattle city limits and the whole (Seattle and non-Seattle) land area for these trans-border zip codes, this will under-represent the pet density in these Seattle neighborhoods.", "So I looked for another shapely function.", "object.intersection(other) \u2014 Returns a representation of the intersection of this object with the other geometric object.*", "In other words, it returns a shape of the area where the two objects overlap.", "I\u2019m not yet sure what\u2019s going on with all the pink in this map, but this is starting to look good! With the zip codes trimmed to the area within Seattle, as far as mapping goes, I\u2019m ready to get rid of the Seattle outline marking the center of Hood Canal, or wherever Seattle technically ends, in favor of the waterway and zip code outlines.", "With the map shapes prepped, I\u2019m ready to put that pet data to use!", "First, I added the new intersection geometries determined in the last step to my GeoDataFrame. Note: Geopandas always plots the \u201cgeometry\u201d column by default to plot your shape or complete shape-based calculations like those used above. You can use geo_object.set_geometry(\u2018column_name') to switch which column geopandas will use as the geometry of interest. In this case, I decided to start afresh with a new, paired down GeoDataFrame instead \u2014 just the Seattle zip codes with their intersection geometry and area.", "To this, I added the pet counts and pet density, using just the intersection area to calculate the density.", "To color the map based on the column 'pet_density', set the column to the column name in the call to plot. This kind of map, colored based on a data value, is called a choropleth (vocab I wish I knew before\u2026 googling for help works better with more precise key words\u2026)", "Ugh! All the zip codes look the same!", "Then, I noticed that two zip codes (98146, 98168) had a much larger pet density, even though they weren\u2019t visible at my map\u2019s scale.", "To investigate these locations more closely, I mapped them on the city streets using folium:", "Looking at these two zip codes:", "The first one is a single block in Downtown Seattle, next to the library, that does contain a high rise condo complex. I\u2019m not sure why this block has its own zip code, but oh well. I can believe that there are 35 pets registered here.", "The second one is more of a mystery. This tiny section of the much larger zip code is an industrial area near the Boeing Field Airport. There is a Supervalue, but no visible housing on Google Maps satellite view (yes, I attempted to stalk these 35 pets\u2014 feel free to check it out yourself. For now, my working assumption is these are emotional support animals for the Supervalue workers.)", "Upon further investigation, zip code 98168 has some areas in unincorporated King County, where the addresses might be labeled \u201cSeattle\u201d, but are not technically within Seattle city limits. I wonder if some non-Seattle resident pet owners in this unincorporated area registered their pets with the city, not realizing that they are technically not city residents. You would think that the city wouldn\u2019t take registrations for non-city addresses\u2026 it remains a mystery.", "Anyways, I chose to drop these two zip codes so that the larger zip codes\u2019 pet densities are easier to distinguish. I also added in the legend, with the assist of the geopandas docs.", "So now I have a good idea of the most and least desirable neighborhoods for pet watching! I do have some lingering questions: What if we normalize for population density? What type of pets are we talking about \u2014 would this map look different for cats/dogs/goats/pigs (yes goats and pigs are registered with the city!)? But these questions will have to wait for another day\u2026coming soon to a data science blog near you.", "Parting tip: use plt.savefig('fig_name.png') to save your image before displaying the figure to avoid saving a blank canvas. For example, all in one jupyter notebook cell:", "You\u2019ll still get the image displayed and saved.", "You can see the full code on my GitHub repo here.", "Updated: added installation of descartes and matplotlib. Thank you for noticing Shahid Nawaz Khan!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist with a background in business, education, and environmental science."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F93dd9dc3137&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@allison.stafford?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allison.stafford?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "Allison Stafford"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87b1f621568d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&user=Allison+Stafford&userId=87b1f621568d&source=post_page-87b1f621568d----93dd9dc3137---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93dd9dc3137&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93dd9dc3137&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.flickr.com/photos/14798455@N06/7808358384", "anchor_text": "Flickr"}, {"url": "http://geopandas.org/", "anchor_text": "geopandas"}, {"url": "http://geopandas.org/install.html", "anchor_text": "their directions"}, {"url": "https://data.seattle.gov/Community/Seattle-Pet-Licenses/jguv-t9rb", "anchor_text": "pet licenses"}, {"url": "http://data-seattlecitygis.opendata.arcgis.com/datasets/83fc2e72903343aabff6de8cb445b81c_2", "anchor_text": "zip codes"}, {"url": "http://data-seattlecitygis.opendata.arcgis.com/datasets/municipal-boundaries", "anchor_text": "boundaries"}, {"url": "http://data-seattlecitygis.opendata.arcgis.com/datasets/city-of-seattle-shoreline", "anchor_text": "shoreline"}, {"url": "https://commons.wikimedia.org/wiki/File:Photo_Feb_01,_9_31_50_AM.jpg", "anchor_text": "wikimedia commons"}, {"url": "https://en.wikipedia.org/wiki/Shapefile", "anchor_text": "article"}, {"url": "https://shapely.readthedocs.io/en/stable/manual.html", "anchor_text": "shapely"}, {"url": "http://geopandas.org/", "anchor_text": "geopandas"}, {"url": "https://shapely.readthedocs.io/en/stable/manual.html#object.contains", "anchor_text": "contains()"}, {"url": "http://creativecommons.org/publicdomain/zero/1.0/", "anchor_text": "CC0 Public Domain"}, {"url": "https://www.publicdomainpictures.net/en/view-image.php?image=35428&picture=sad-dog", "anchor_text": "PublicDomainPictures"}, {"url": "https://en.wikipedia.org/wiki/SuperValu_(United_States)", "anchor_text": "Supervalue"}, {"url": "https://www.google.com/maps/@47.5101408,-122.2903633,1106m/data=!3m1!1e3", "anchor_text": "check it out yourself"}, {"url": "https://www.linkedin.com/in/kevinhonold/", "anchor_text": "Kevin Honold"}, {"url": "http://geopandas.org/mapping.html", "anchor_text": "http://geopandas.org/mapping.html"}, {"url": "https://www.linkedin.com/in/kevinhonold/", "anchor_text": "Kevin Honold"}, {"url": "https://github.com/allisonhonold/geospatial_data_blog", "anchor_text": "here"}, {"url": "https://medium.com/u/60c1c7acc358?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "Shahid Nawaz Khan"}, {"url": "https://medium.com/tag/data-science?source=post_page-----93dd9dc3137---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----93dd9dc3137---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/choropleth-map?source=post_page-----93dd9dc3137---------------choropleth_map-----------------", "anchor_text": "Choropleth Map"}, {"url": "https://medium.com/tag/geopandas?source=post_page-----93dd9dc3137---------------geopandas-----------------", "anchor_text": "Geopandas"}, {"url": "https://medium.com/tag/shapefile?source=post_page-----93dd9dc3137---------------shapefile-----------------", "anchor_text": "Shapefile"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F93dd9dc3137&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&user=Allison+Stafford&userId=87b1f621568d&source=-----93dd9dc3137---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F93dd9dc3137&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&user=Allison+Stafford&userId=87b1f621568d&source=-----93dd9dc3137---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93dd9dc3137&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F93dd9dc3137&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----93dd9dc3137---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----93dd9dc3137--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----93dd9dc3137--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----93dd9dc3137--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allison.stafford?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allison.stafford?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Allison Stafford"}, {"url": "https://medium.com/@allison.stafford/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "386 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87b1f621568d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&user=Allison+Stafford&userId=87b1f621568d&source=post_page-87b1f621568d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb4bbbb8c248&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpuppies-python-analyzing-geospatial-data-93dd9dc3137&newsletterV3=87b1f621568d&newsletterV3Id=b4bbbb8c248&user=Allison+Stafford&userId=87b1f621568d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}