{"url": "https://towardsdatascience.com/predicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e", "time": 1683012480.1938791, "path": "towardsdatascience.com/predicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e/", "webpage": {"metadata": {"title": "Predicting the Music Mood of a Song with Deep Learning. | by Crist\u00f3bal Veas | Towards Data Science", "h1": "Predicting the Music Mood of a Song with Deep Learning.", "description": "Music is a powerful language to express our feelings and in many cases is used as a therapy to deal with tough moments in our lives. Emotions and moods can be easily reflected in music, when we are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/cristobalvch/Spotify-Machine-Learning", "anchor_text": "Click Here", "paragraph_index": 2}, {"url": "https://github.com/cristobalvch/Spotify-Playlists/blob/master/data/data_moods.csv", "anchor_text": "Click Here", "paragraph_index": 6}, {"url": "https://github.com/cristobalvch/Spotify-Machine-Learning/blob/master/helpers.py", "anchor_text": "click here", "paragraph_index": 24}, {"url": "https://developer.spotify.com/dashboard/", "anchor_text": "click here", "paragraph_index": 24}, {"url": "https://www.youtube.com/watch?reload=9&v=0C58ttB2-Qg", "anchor_text": "with a little help from", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/crvch/", "anchor_text": "https://www.linkedin.com/in/crvch/", "paragraph_index": 33}], "all_paragraphs": ["Music is a powerful language to express our feelings and in many cases is used as a therapy to deal with tough moments in our lives. Emotions and moods can be easily reflected in music, when we are doing sports, we tend to listen to energetic music, similarly when we are anxious or tired a nice relaxed song can help us to calm down. That\u2019s why I try to figure out how classification models could help to determinate which is the mood of a specific track.", "In this article, I will expose and explain how I could achieve this idea using a Multi-Class Neural Network for Classification and a cool Dataset provided from Spotify. So with no more talk, let\u2019s start working!!.", "*Full code, scripts, notebooks and data on my Github Repository (Click Here)", "Spotify uses a series of different features to classify tracks. I copy/paste the information from the Spotify Webpage.", "To obtain the data I had to create a series of functions using the Spotipy Library. This library helps to automate the Spotify services downloading more technical information (explaining above) about playlists, songs, artist music, etc. For the main purpose of this article, I\u2019ll not mention how I obtained the data, but I\u2019ll explain what the data consists of.", "As you may know, Classification problems use labeled data, so I had to create these labels. I decided to create 4 categories to label the tracks, these categories are \u201cEnergetic\u201d, \u201dCalm\u201d, \u201cHappy\u201d and \u201cSad\u201d. I choose these categories based on the following article, who explains what is the best way of classifying music by mood.", "Then I searched on Spotify some playlists with different music tracks based on these 4 labels (200 tracks per label) and finally, I concatenated all these tracks into the main data frame labeled by each mood. You can look this dataset on my GitHub repository (Click Here)", "The main data have 800 rows and 18 columns, but for information reduction purposes I decided to use the features of Length, Danceability, Acousticness, Energy, Instrumentalness, Liveness, Valence, Loudness, Speechiness and Tempo because they have more influence to classify the tracks.", "I grouped the data frame by labels calculating the mean of the tracks\u2019 features. I obtained the following result:", "Doing this simple analysis I quickly noticed that the most popular songs are Happy, Sad songs tend to have a long length, Energetic songs are most fast in tempo, and Calm songs tends to be acousticness.", "To normalize the features I used MinMaxScaler to scale the values between a range of [0,1] and preserving the shape of the original distribution. I also encoded the 4 labels because Neural Networks uses numerical values to train and test. Finally, I split the data by 80% for training and 20% for testing.", "The code I used to process the data:", "The labels are encoded as follows:", "To build the model I used the library Keras, this library is designed to enable fast experimentation with Deep Neural Networks, focused on being user-friendly. My main goal is to classify tracks in the 4 categories of moods (Calm, Energetic, Happy and Sad) so my model consists of a Multi-Class Neural Network with an input of 10 Features, 1 Layer with 8 nodes, and 4 outputs with the output Layer. I also need to use a Classifier as an Estimator, in this case, the Classifier is KerasClassifier, which takes as an argument a function that I created previously with the Neural Network model defined. The activation Function corresponds to a Rectified Linear Unit (Relu), the Loss function is a Logistic Function and Adam Gradient Descent Algorithm is the optimizer.", "The code I used to build the Neural Network:", "Using K-Fold Cross Validation I evaluated the estimator using the train data. The number of splits is K=10 shuffling all the values.", "The code I used to evaluate the model:", "The Accuracy of the model is the average of the accuracy of each fold, in this case, the Accuracy was 72.75%.", "It\u2019s time to train the model! So let\u2019s go code:", "It\u2019s important to mention that the model was trained with 640 samples (80% of the main data).", "Some of the output of the last epochs when the model was training.", "Finally to evaluate the accuracy of the model I plotted a Confusion Matrix using Seaborn Library and Matplotlib. I also calculated the accuracy score provided by Sklearn Library.", "With a Final Accuracy score of 76% and taking a look at the Confusion Matrix, I noticed my model is good classifying Calm and Sad songs, but it\u2019s having some issues dealing with Energetic and Happy songs. I could modify some parameters like the batch size, epochs, or maybe aggregate or delete some track features to train my model and thus help to improve the accuracy of the model.", "I want to show how to predict the mood of a song that may you are lazy to listen completely but you want to know if the song will make you dance or cry.", "I have on my Github Repository (click here) a script called helpers.py, to use it you just need to create an app for developers on Spotify (click here for more info) and obtain a Client_id, Client_secret, and Redirect URL. Using this script, you can download the features required to predict the mood of any song with a little help from this Multi-Class Classification Model. ( That\u2019s right, like The Beatles Song).", "First, we need to obtain the Spotify URI of any song provided by the Spotify App. For instance, I will like to predict the mood of \u201cBlinding Lights by The Weekend\u201d.", "Spotify URI of Blinding Lights : spotify:track:0VjIjW4GlUZAMYd2vXMi3b", "Then I will pass the Spotify URI of the song into a function I defined called predict_mood. This function takes the Id of the song as an argument and includes inside the Neural Network model created", "The code of the predict_mood function is:", "Spotify URI of Blinding Lights is \u201cspotify:track:0VjIjW4GlUZAMYd2vXMi3b\u201d but the predict_mood function takes the Id, so I just need to take the code after \u201cspotify:track\u201d: in this case, the Id is 0VjIjW4GlUZAMYd2vXMi3b.", "And the result display that Blinding Lights by the Weeknd have an Energetic Mood. Pretty accurate don\u2019t you think so?.", "Deep Learning Algorithms are a lot of fun to implement ideas or projects related to things you like. In my case, I like music a lot, so I could use this knowledge to create cool ways helping me to automate a task that can take a long time to perform it. I also could learn more about this amazing world of Data Science and my tendencies to music tastes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist and nerd guy https://www.linkedin.com/in/crvch/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc3ac2b45229e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cristobal-veas-ch.medium.com/?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": ""}, {"url": "https://cristobal-veas-ch.medium.com/?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": "Crist\u00f3bal Veas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8dd32d601b4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&user=Crist%C3%B3bal+Veas&userId=8dd32d601b4b&source=post_page-8dd32d601b4b----c3ac2b45229e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3ac2b45229e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3ac2b45229e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@soberanes?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Uriel Soberanes"}, {"url": "https://unsplash.com/s/photos/music-mood?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/cristobalvch/Spotify-Machine-Learning", "anchor_text": "Click Here"}, {"url": "https://spotipy.readthedocs.io/en/2.13.0/", "anchor_text": "click here"}, {"url": "https://developer.spotify.com/", "anchor_text": "click here"}, {"url": "https://sites.tufts.edu/eeseniordesignhandbook/2015/music-mood-classification/", "anchor_text": "Music Mood ClassificationThe article will cover the analysis of music using various DSP and music theory techniques involving rhythm, harmony\u2026sites.tufts.edu"}, {"url": "https://github.com/cristobalvch/Spotify-Playlists/blob/master/data/data_moods.csv", "anchor_text": "Click Here"}, {"url": "https://github.com/cristobalvch/Spotify-Machine-Learning/blob/master/helpers.py", "anchor_text": "click here"}, {"url": "https://developer.spotify.com/dashboard/", "anchor_text": "click here"}, {"url": "https://www.youtube.com/watch?reload=9&v=0C58ttB2-Qg", "anchor_text": "with a little help from"}, {"url": "https://medium.com/@cristobal.veas.ch/una-forma-genial-para-buscar-y-analizar-arriendos-de-departamentos-en-la-web-e20727390a8c", "anchor_text": "Una Forma Genial para Buscar y Analizar Arriendos de Departamentos en la Web"}, {"url": "https://towardsdatascience.com/clustering-music-to-create-your-personal-playlists-on-spotify-using-python-and-k-means-a39c4158589a", "anchor_text": "Clustering Music to Create your Playlists on Spotify Using Python and R"}, {"url": "https://medium.com/@cristobal.veas.ch/una-forma-interactiva-para-buscar-y-analizar-ofertas-de-trabajo-en-la-web-ef9327b0a8d3", "anchor_text": "Una Forma Interactiva para Buscar y Analizar Ofertas de Trabajo en la Web."}, {"url": "https://medium.com/datadriveninvestor/automating-playlists-on-spotify-from-the-music-folders-of-your-computer-c79060eadab2", "anchor_text": "Automating Playlists on Spotify From the Music Folders of your Computer"}, {"url": "https://towardsdatascience.com/cross-validation-explained-evaluating-estimator-performance-e51e5430ff85", "anchor_text": "https://towardsdatascience.com/cross-validation-explained-evaluating-estimator-performance-e51e5430ff85"}, {"url": "https://towardsdatascience.com/clustering-music-to-create-your-personal-playlists-on-spotify-using-python-and-k-means-a39c4158589a", "anchor_text": "https://towardsdatascience.com/clustering-music-to-create-your-personal-playlists-on-spotify-using-python-and-k-means-a39c4158589a"}, {"url": "https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/", "anchor_text": "https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----c3ac2b45229e---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c3ac2b45229e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/spotify?source=post_page-----c3ac2b45229e---------------spotify-----------------", "anchor_text": "Spotify"}, {"url": "https://medium.com/tag/python?source=post_page-----c3ac2b45229e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3ac2b45229e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&user=Crist%C3%B3bal+Veas&userId=8dd32d601b4b&source=-----c3ac2b45229e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3ac2b45229e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&user=Crist%C3%B3bal+Veas&userId=8dd32d601b4b&source=-----c3ac2b45229e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3ac2b45229e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc3ac2b45229e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c3ac2b45229e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c3ac2b45229e--------------------------------", "anchor_text": ""}, {"url": "https://cristobal-veas-ch.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cristobal-veas-ch.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Crist\u00f3bal Veas"}, {"url": "https://cristobal-veas-ch.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "100 Followers"}, {"url": "https://www.linkedin.com/in/crvch/", "anchor_text": "https://www.linkedin.com/in/crvch/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8dd32d601b4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&user=Crist%C3%B3bal+Veas&userId=8dd32d601b4b&source=post_page-8dd32d601b4b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fefbf77d3d693&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-music-mood-of-a-song-with-deep-learning-c3ac2b45229e&newsletterV3=8dd32d601b4b&newsletterV3Id=efbf77d3d693&user=Crist%C3%B3bal+Veas&userId=8dd32d601b4b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}