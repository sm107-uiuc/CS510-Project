{"url": "https://towardsdatascience.com/shap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9", "time": 1683016183.487325, "path": "towardsdatascience.com/shap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9/", "webpage": {"metadata": {"title": "SHAP: How to Interpret Machine Learning Models With Python | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "SHAP: How to Interpret Machine Learning Models With Python", "description": "Nobody likes a black-box model. With sophisticated algorithms and a fair amount of data preparation, building good models is easy, but what\u2019s going on inside? That\u2019s where Explainable AI and SHAP\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/slundberg/shap)", "anchor_text": "https://github.com/slundberg/shap)", "paragraph_index": 6}, {"url": "https://www.kaggle.com/piyushagni5/white-wine-quality", "anchor_text": "Wine quality dataset", "paragraph_index": 10}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 31}, {"url": "https://betterdatascience.com/shap/", "anchor_text": "https://betterdatascience.com", "paragraph_index": 32}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 34}], "all_paragraphs": ["Nobody likes a black-box model. With sophisticated algorithms and a fair amount of data preparation, building good models is easy, but what\u2019s going on inside? That\u2019s where Explainable AI and SHAP come into place.", "Don\u2019t feel like reading? Check out my video on the topic:", "Today you\u2019ll learn how to explain machine learning models to the general population. We\u2019ll use three different plots for interpretation \u2014 one for a single prediction, one for a single variable, and one for the entire dataset.", "After reading this article, you shouldn\u2019t have any problems interpreting predictions of the machine learning model and the importance of each predictor.", "The article is structured as follows:", "Let\u2019s take a look at an official statement from the creators:", "SHAP (SHapley Additive exPlanations) is a game-theoretic approach to explain the output of any machine learning model. It connects optimal credit allocation with local explanations using the classic Shapley values from game theory and their related extensions. (source: https://github.com/slundberg/shap)", "It\u2019s a lot of fancy words, but here\u2019s the only thing you should know \u2014 SHAP helps us interpret machine learning models with Shapely values.", "But what are Shapely values? Put simply, they are measures of contributions each predictor (feature) has in a machine learning model. This is the least fancy definition on the web, guaranteed, but I reckon it\u2019s easy enough to understand.", "Let\u2019s start training our model next so that we can begin with the interpretation ASAP.", "To interpret a machine learning model, we first need a model \u2014 so let\u2019s create one based on the Wine quality dataset. Here\u2019s how to load it into Python:", "There\u2019s no need for data cleaning \u2014 all data types are numeric, and there are no missing data. The train/test split is the next step. The column quality is the target variable, and it can be either good or bad. To get the same split, please set the value of random_state to 42:", "And now we\u2019re ready to train the model. XGBoost classifier will do the job, so make sure to install it first (pip install xgboost). Once again, the value of random_state is set to 42 for reproducibility:", "Out of the box, we have an accuracy of 80% (score). Now we have all we need to start interpreting the model. We\u2019ll do that in the next section.", "To explain the model through SHAP, we first need to install the library. You can do it by executing pip install shap from the Terminal. We can then import it, make an explainer based on the XGBoost model, and finally calculate the SHAP values:", "And we are ready to go!", "Let\u2019s start small and simple. With SHAP, we can generate explanations for a single prediction. The SHAP plot shows features that contribute to pushing the output from the base value (average model output) to the actual predicted value.", "Red color indicates features that are pushing the prediction higher, and blue color indicates just the opposite.", "Let\u2019s take a look at an interpretation chart for a wine that was classified as bad:", "This is a classification dataset, so don\u2019t worry too much about the f(x) value. Only the residual sugar attribute pushed this instance towards a good wine quality, but it wasn\u2019t enough, as we can see.", "Next, let\u2019s take a look at the interpretation chart for a good wine:", "A whole another story here. You now know how to interpret a single prediction, so let\u2019s spice things up just a bit and see how to interpret a single feature\u2019s effect on the model output.", "To understand the effect a single feature has on the model output, we can plot a SHAP value of that feature vs. the value of the feature for all instances in the dataset.", "The chart below shows the change in wine quality as the alcohol value changes. Vertical dispersions at a single value show interaction effects with other features. SHAP automatically selects another feature for coloring to make these interactions easier to see:", "Let\u2019s now examine the entire dataset to determine which features are most important for the model and how they contribute to the predictions.", "We can visualize the importance of the features and their impact on the prediction by plotting summary charts. The one below sorts features by the sum of SHAP value magnitudes over all samples. It also uses SHAP values to show the distribution of the impacts each feature has.", "The color represents the feature value \u2014 red indicating high and blue indicating low. Let\u2019s take a look at the plot next:", "You now know just enough to get started interpreting your own models. Let\u2019s wrap things up in the next section.", "Interpreting machine learning models can seem complicated at first, but libraries like SHAP make everything as easy as a function call. We even don\u2019t have to worry about data visualization, as there are built-in functions for that.", "This article should serve you as a basis for more advanced interpretation visualizations and provide you with just enough information for further learning.", "What are your thoughts on SHAP? Please let me know in the comment section below.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Originally published at https://betterdatascience.com on November 9, 2020.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2323f5af4be9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----2323f5af4be9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2323f5af4be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2323f5af4be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pawel_czerwinski?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Pawe\u0142 Czerwi\u0144ski"}, {"url": "https://unsplash.com/s/photos/abstract?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/slundberg/shap)", "anchor_text": "https://github.com/slundberg/shap)"}, {"url": "https://www.kaggle.com/piyushagni5/white-wine-quality", "anchor_text": "Wine quality dataset"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://betterdatascience.com/shap/", "anchor_text": "https://betterdatascience.com"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----2323f5af4be9---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2323f5af4be9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2323f5af4be9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----2323f5af4be9---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----2323f5af4be9---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2323f5af4be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----2323f5af4be9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2323f5af4be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----2323f5af4be9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2323f5af4be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2323f5af4be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2323f5af4be9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2323f5af4be9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2323f5af4be9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2323f5af4be9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2323f5af4be9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fshap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}