{"url": "https://towardsdatascience.com/portable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9", "time": 1682996800.258382, "path": "towardsdatascience.com/portable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9/", "webpage": {"metadata": {"title": "Portable Computer Vision: TensorFlow 2.0 on a Raspberry Pi | by Leigh Johnson | Towards Data Science", "h1": "Portable Computer Vision: TensorFlow 2.0 on a Raspberry Pi", "description": "For roughly $100 USD, you can add deep learning to an embedded system or your next internet-of-things project. Are you just getting started with machine/deep learning, TensorFlow, or Raspberry Pi\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.raspberrypi.org/", "anchor_text": "Raspberry Pi", "paragraph_index": 4}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow", "paragraph_index": 5}, {"url": "https://www.tensorflow.org/lite", "anchor_text": "TensorFlow Lite", "paragraph_index": 6}, {"url": "https://ai.googleblog.com/2018/04/mobilenetv2-next-generation-of-on.html", "anchor_text": "MobileNetV2", "paragraph_index": 8}, {"url": "https://cloud.google.com/edge-tpu/", "anchor_text": "Edge TPU", "paragraph_index": 9}, {"url": "https://www.arrow.com/en/products/3275/adafruit-industries", "anchor_text": "Pi Camera Pack", "paragraph_index": 10}, {"url": "https://coral.withgoogle.com/products/accelerator/", "anchor_text": "Link", "paragraph_index": 11}, {"url": "https://twitter.com/grepLeigh", "anchor_text": "@grepLeigh", "paragraph_index": 18}, {"url": "https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up/2", "anchor_text": "Setting up your Raspberry Pi", "paragraph_index": 19}, {"url": "https://docs.ansible.com/", "anchor_text": "Ansible", "paragraph_index": 28}, {"url": "https://gist.github.com/leigh-johnson/14541749afbd8e4471b85699ddd0c9f5", "anchor_text": "Click for a gist", "paragraph_index": 56}, {"url": "http://image-net.org/explore", "anchor_text": "image-net.org", "paragraph_index": 57}, {"url": "https://www.bitsy.ai/", "anchor_text": "Sign up for my newsletter", "paragraph_index": 59}, {"url": "https://www.bitsy.ai/automate-bounding-box-annotation-with-tensorflow-and-automl/", "anchor_text": "automating away the pains of bounding-box annotation", "paragraph_index": 60}, {"url": "https://www.printnanny.ai/", "anchor_text": "https://www.printnanny.ai/", "paragraph_index": 62}, {"url": "https://bitsy.ai/", "anchor_text": "https://bitsy.ai/", "paragraph_index": 62}], "all_paragraphs": ["For roughly $100 USD, you can add deep learning to an embedded system or your next internet-of-things project.", "Are you just getting started with machine/deep learning, TensorFlow, or Raspberry Pi? Perfect, this blog series is for you!", "In this series, I will show you how to:", "The first post in this series (you\u2019re reading it now!) will walk you through build materials, installation, and deploying MobileNetV2 to your Raspberry Pi.", "Raspberry Pi \u2014 a small, affordable computer popular with educators, hardware hobbyists, and roboticists. \ud83e\udd16", "TensorFlow \u2014 an open-source platform for machine learning.", "TensorFlow Lite \u2014 a lightweight library for deploying TensorFlow models on mobile and embedded devices.", "Convolutional Neural Network \u2014 a type of deep-learning model well-suited for image classification and object detection applications.", "MobileNetV2 \u2014 a state-of-the-art image recognition model optimized for performance on modest mobile phone processors.", "Edge TPU \u2014 a tensor processing unit (TPU) is an integrated circuit for accelerating computations performed by TensorFlow. The Edge TPU was developed with a small footprint, for mobile and embedded devices \u201cat the edge\u201d", "If you\u2019re just getting started with Raspberry Pi, I recommend the Pi Camera Pack ($90) by Arrow. It includes everything you need begin immediately:", "You can compile TensorFlow Lite models to run on Coral\u2019s USB Accelerator (Link), for quicker model predictions.", "Real-time applications benefit significantly from this speed-up. An example would be the decision-making module of an autonomous self-driving robot.", "Some applications can tolerate a higher prediction speed and might not require TPU acceleration. For example, you would not need TPU acceleration to build a smart doggie door that unlocks for your pooch (but keeps raccoons out).", "If you\u2019re just getting started, skip buying this component.", "Are you not sure if you need the USB Accelerator? The MobileNet benchmarks below might help you decide. The measurements below depict inference speed (in ms) \u2014 lower speeds are better!", "If you already have a Raspberry Pi or some components laying around, the starter kit might include items you don\u2019t need.", "Here are the parts I used for my own builds (approximately $250 / unit).", "I would love to hear about your own build list! \u2764\ufe0f Tweet me @grepLeigh or comment below.", "If you purchased an SD card pre-loaded with NOOBS, I recommend walking through this overview first: Setting up your Raspberry Pi", "rpi-vision is a set of tools that makes it easier for you to:", "2. On your primary computer, create a new virtual environment, then install the rpi-vision package.", "3. Verify you can SSH into your Raspberry Pi before proceeding.", "If you\u2019re using the default Raspbian image, your Pi\u2019s hostname will beraspberrypi.local", "rpi-vision uses Ansible to manage deployments and tasks on your Raspberry Pi. Ansible is a framework for automating the configuration of computers.", "Create 2 configuration files required by Ansible:", "If you\u2019re using a custom hostname for your Pi, replace raspberrypi.local.", "If you\u2019re using a custom hostname for your Pi, replace raspberrypi.local.", "You\u2019ll see the output of an Ansible playbook. Ansible is a framework for automating the configuration of computers.", "A quick summary of what\u2019s being installed on your Pi:", "You can inspect the tasks run on your Raspberry Pi by opening playbooks/bootstrap-rpi.yml", "While the installation is running, read through the next section to learn how CNNS work and why they are useful for computer vision tasks.", "CNNs are the key technology powering self-driving cars and image search engines. The technology is common for computer vision, but can also be applied to any problem with a hierarchical pattern in the data, where a complex pattern can be assembled from simpler patterns.", "In the late 1950s and 1960s, David H. Hubel and Torton Wielson performed experiments on cats and monkeys to better understand the visual cortex.", "They demonstrated neurons in the striate cortex respond to stimuli in a limited visual field, which they called a receptive field.", "They noted concentric overlapping responses, where complex patterns were combinations of lower-level patterns.", "Their findings also revealed specialization, where some neurons would only respond to a specific shape or pattern.", "In the 1980s, inspired by Hubel and Wielson, Kunihiko Fukushima published on the neocognitron, a neural network capable of learning patterns with geometrical similarity.", "The neocogitron has two key properties:", "The neocogitron model is the inspiration for modern convolutional neural networks.", "The input layer is fed into convolutional layers, which transform regions of the input using a filter.", "The filter is also referred to as a kernel.", "For each position in the input matrix, the convolution operation performs matrix multiplication on each element.", "The resulting matrix is summed and stored in a feature map.", "The operation is repeated for each position in the input matrix.", "The input layer of a CNN is usually a 3D data structure with height, width, and channel (RGB or greyscale values).", "The deeper we go in the feature map stack, the sparser each map layer becomes. That means the filters detect fewer features.", "The first few layers of the feature map stack detect simple edges and shapes, and look similar to the input image. As we go deeper into a feature map stack, features become more abstract to the human eye. Deeper feature layers encode classification data, like \u201ccat face\u201d or \u201ccat ear\u201d.", "Your dependency installation is probably done by now. To forge ahead, skip to Part 8 - Deploy Pre-trained Model MobileNetV2.", "If you plan on training a custom classifier or want to read more about convolutional neural networks, start here:", "2. Start a new tmux session", "3. Split the tmux session vertically by pressing control+b, then \u201c", "4. Start an fbcp process, which will copy framebuffer from the PiCamera to the TFT display via SPI interface. Leave this process running.", "5. Switch tmux panes by pressing control+b, then o.", "6. Activate the virtual environment installed in earlier, in Part 6.", "7. Start a mobilenetv2 agent process. The agent will take roughly 60 seconds to initialize.", "You\u2019ll see a summary of the model\u2019s base, and then the agent will print inferences until stopped. Click for a gist of what you should see.", "This demo uses weights for ImageNet classifiers, which you can look up at image-net.org.", "Congratulations, you just deployed an image classification model to your Raspberry Pi! \u2728", "Looking for more hands-on examples of Machine Learning for Raspberry Pi and other small device? Sign up for my newsletter!", "I publish examples of real-world ML applications (with full source code) and nifty tricks like automating away the pains of bounding-box annotation.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Building automation/monitoring for 3D printers: https://www.printnanny.ai/ | Applied ML and Edge ML: https://bitsy.ai/ | Google Developer Expert."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F84e318798ce9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----84e318798ce9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----84e318798ce9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://grepleigh.medium.com/?source=post_page-----84e318798ce9--------------------------------", "anchor_text": ""}, {"url": "https://grepleigh.medium.com/?source=post_page-----84e318798ce9--------------------------------", "anchor_text": "Leigh Johnson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbcd055ed4f5b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&user=Leigh+Johnson&userId=bcd055ed4f5b&source=post_page-bcd055ed4f5b----84e318798ce9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84e318798ce9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84e318798ce9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.raspberrypi.org/", "anchor_text": "Raspberry Pi"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://www.tensorflow.org/lite", "anchor_text": "TensorFlow Lite"}, {"url": "https://ai.googleblog.com/2018/04/mobilenetv2-next-generation-of-on.html", "anchor_text": "MobileNetV2"}, {"url": "https://ai.googleblog.com/2018/04/mobilenetv2-next-generation-of-on.html", "anchor_text": "MobileNetV2: The Next Generation of On-Device Computer Vision Networks"}, {"url": "https://cloud.google.com/edge-tpu/", "anchor_text": "Edge TPU"}, {"url": "https://cloud.google.com/edge-tpu/)", "anchor_text": "Google"}, {"url": "https://www.arrow.com/en/products/3275/adafruit-industries", "anchor_text": "Pi Camera Pack"}, {"url": "https://coral.withgoogle.com/products/accelerator/", "anchor_text": "Link"}, {"url": "https://blog.hackster.io/@aallan", "anchor_text": "Alasdair Allan"}, {"url": "https://blog.hackster.io/benchmarking-tensorflow-and-tensorflow-lite-on-the-raspberry-pi-43f51b796796", "anchor_text": "Benchmarking TensorFlow and TensorFlow Lite on the Raspberry Pi"}, {"url": "https://coral.withgoogle.com/products/accelerator", "anchor_text": "link"}, {"url": "https://www.adafruit.com/product/2718", "anchor_text": "link"}, {"url": "http://www.adafruit.com/product/3187", "anchor_text": "link"}, {"url": "https://www.adafruit.com/product/1434", "anchor_text": "link"}, {"url": "https://www.adafruit.com/product/1731", "anchor_text": "link"}, {"url": "https://twitter.com/grepLeigh", "anchor_text": "@grepLeigh"}, {"url": "https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up/2", "anchor_text": "Setting up your Raspberry Pi"}, {"url": "https://projects.raspberrypi.org/en/projects/raspberry-pi-using/4", "anchor_text": "doc"}, {"url": "https://www.raspberrypi.org/documentation/remote-access/ssh/", "anchor_text": "doc"}, {"url": "https://docs.ansible.com/", "anchor_text": "Ansible"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1357023/pdf/jphysiol01301-0020.pdf", "anchor_text": "SINGLE UNIT ACTIVITY IN STRIATE CORTEX OF UNRESTRAINED CATS"}, {"url": "https://www.cs.princeton.edu/courses/archive/spr08/cos598B/Readings/Fukushima1980.pdf", "anchor_text": "Neocognitron: A Self-organizing Neural Network Model for a Mechanism of Pattern Recognition Unaffected by Shift in Position"}, {"url": "https://towardsdatascience.com/applied-deep-learning-part-4-convolutional-neural-networks-584bc134c1e2", "anchor_text": "Applied Deep Learning \u2014 Part 4: Convolutional Neural Networks"}, {"url": "https://towardsdatascience.com/applied-deep-learning-part-4-convolutional-neural-networks-584bc134c1e2", "anchor_text": "Applied Deep Learning \u2014 Part 4: Convolutional Neural Networks"}, {"url": "https://towardsdatascience.com/applied-deep-learning-part-4-convolutional-neural-networks-584bc134c1e2", "anchor_text": "Applied Deep Learning \u2014 Part 4: Convolutional Neural Networks"}, {"url": "https://www.amazon.com/Hands-Machine-Learning-Scikit-Learn-TensorFlow/dp/1491962291", "anchor_text": "Hands on Machine Learning with Scikit-learn and TensorFlow"}, {"url": "https://www.amazon.com/Deep-Learning-Python-Francois-Chollet/dp/1617294438/", "anchor_text": "Deep Learning with Python"}, {"url": "https://gist.github.com/leigh-johnson/14541749afbd8e4471b85699ddd0c9f5", "anchor_text": "Click for a gist"}, {"url": "http://image-net.org/explore", "anchor_text": "image-net.org"}, {"url": "https://www.bitsy.ai/", "anchor_text": "Sign up for my newsletter"}, {"url": "https://www.bitsy.ai/automate-bounding-box-annotation-with-tensorflow-and-automl/", "anchor_text": "automating away the pains of bounding-box annotation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----84e318798ce9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/raspberry-pi?source=post_page-----84e318798ce9---------------raspberry_pi-----------------", "anchor_text": "Raspberry Pi"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----84e318798ce9---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----84e318798ce9---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/makers?source=post_page-----84e318798ce9---------------makers-----------------", "anchor_text": "Makers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F84e318798ce9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&user=Leigh+Johnson&userId=bcd055ed4f5b&source=-----84e318798ce9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F84e318798ce9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&user=Leigh+Johnson&userId=bcd055ed4f5b&source=-----84e318798ce9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84e318798ce9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----84e318798ce9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F84e318798ce9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----84e318798ce9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----84e318798ce9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----84e318798ce9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----84e318798ce9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----84e318798ce9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----84e318798ce9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----84e318798ce9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----84e318798ce9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----84e318798ce9--------------------------------", "anchor_text": ""}, {"url": "https://grepleigh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://grepleigh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Leigh Johnson"}, {"url": "https://grepleigh.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "449 Followers"}, {"url": "https://www.printnanny.ai/", "anchor_text": "https://www.printnanny.ai/"}, {"url": "https://bitsy.ai/", "anchor_text": "https://bitsy.ai/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbcd055ed4f5b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&user=Leigh+Johnson&userId=bcd055ed4f5b&source=post_page-bcd055ed4f5b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F43e32d5c18d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fportable-computer-vision-tensorflow-2-0-on-a-raspberry-pi-part-1-of-2-84e318798ce9&newsletterV3=bcd055ed4f5b&newsletterV3Id=43e32d5c18d0&user=Leigh+Johnson&userId=bcd055ed4f5b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}