{"url": "https://towardsdatascience.com/your-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48", "time": 1683009447.2454588, "path": "towardsdatascience.com/your-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48/", "webpage": {"metadata": {"title": "Your processor is trying to predict the future long before you start with AI | by Caio Carneloz | Towards Data Science", "h1": "Your processor is trying to predict the future long before you start with AI", "description": "If you have ever studied computer architecture, you probably know the basic steps the hardware takes to execute a certain routine. If you don\u2019t, here is a brief explanation about this process [1]\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.elsevier.com/books/computer-organization-and-design-mips-edition/patterson/978-0-12-407726-3", "anchor_text": "[1]", "paragraph_index": 0}, {"url": "https://patentimages.storage.googleapis.com/83/4c/27/df5557ed2268ab/US6571331.pdf", "anchor_text": "[2]", "paragraph_index": 5}, {"url": "http://www.eecs.umich.edu/techreports/cse/1997/CSE-TR-337-97.pdf", "anchor_text": "[3]", "paragraph_index": 7}, {"url": "https://www.elsevier.com/books/computer-organization-and-design-mips-edition/patterson/978-0-12-407726-3", "anchor_text": "[1]", "paragraph_index": 8}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1002/cpe.4666", "anchor_text": "[4]", "paragraph_index": 10}, {"url": "https://medium.com/u/2a6e065054e5?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "Harshal Parekh", "paragraph_index": 11}, {"url": "https://www.researchgate.net/publication/324166804_A_Survey_of_Techniques_for_Dynamic_Branch_Prediction", "anchor_text": "survey", "paragraph_index": 17}, {"url": "https://www.elsevier.com/books/computer-organization-and-design-mips-edition/patterson/978-0-12-407726-3", "anchor_text": "Computer Organization and Design: The Hardware/Software Interface", "paragraph_index": 19}, {"url": "http://www.eecs.umich.edu/techreports/cse/1997/CSE-TR-337-97.pdf", "anchor_text": "Classification-directed branch predictor design", "paragraph_index": 20}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1002/cpe.4666", "anchor_text": "A survey of techniques for dynamic branch prediction", "paragraph_index": 21}], "all_paragraphs": ["If you have ever studied computer architecture, you probably know the basic steps the hardware takes to execute a certain routine. If you don\u2019t, here is a brief explanation about this process [1]:", "The first step is to have the high-level code translated to assembly language. The compiler is responsible for doing this. After that, the assembler will translate the assembly language into binary instructions. So, if your code has the following sentence in some high-level language:", "The assembler will translate to something like this:", "From this point, the processor executes the following steps:", "This sequence is repeated all the time while the processor is operating and each step takes one clock cycle. The execution depends on decoding which depends on fetching. However, fetching doesn\u2019t depend on decode which doesn\u2019t depend on execution, so once the fetching of a certain instruction is done, the next instruction can be fetched already. The same goes for the others, that\u2019s the processor pipeline (as the following picture shows).", "To talk about predictions, we first need to talk about conditional jumps (or conditional branches). A conditional branch instruction is a jump to a new address that may or may not occur depending on a specific condition [2]. Translating to the high-level languages, it is basically an if-then-else clause:", "If the condition is satisfied, the code will continue its normal execution. If the condition is not satisfied, the code will jump all lines inside the if block to execute all lines inside the else block. This is one example of conditional branching. For\u2019s and while\u2019s are conditional branches too, since conditions define if the code will be repeated or go straight. The point about conditional branches is: the condition result needs to be calculated at execution time.", "That means when a conditional branch instruction comes up in the pipeline, the processor will only know if the branch needs to be taken after calculating the condition result, that is, after the execution stage. Thus, the processor doesn\u2019t know if the following instruction will be executed or a jump to another instruction will occur. This kind of dependency implies a pipeline bubble [3].", "A pipeline bubble, as the image above shows, is a kind of delay on the processor\u2019s pipeline in order to solve some dependency (or hazard, in the computer architecture language) [1]. The grey blocks represent idle time. Considering that the first instruction of the image above is the conditional branch, the next instruction is fetched only after the conditional branch instruction finishes its execution step, to make sure that the next instruction to be executed will be the right one. So if you give it some thought, this isn\u2019t sustainable in terms of performance. That\u2019s where predictions come in.", "What choice the processor have if it doesn\u2019t wait until the calculation of the conditional branches? Well, guessing or predicting the condition result could be a good choice\u2026 and it is. The process of predicting the condition result instead of blocking the processor has been used for decades and it is called \u201cbranch prediction\u201d.", "The fact that they have been used for a long time does not imply that they are perfect, there is always room for improvement. Experiments using real processors revealed that reducing mispredictions by 50% improved the performance of the processor by 13% [4]. However, designing a branch predictor (BP) covers not only accuracy but a lot of other tradeoffs, such as the area used in the processor chip, energy consumption, and many others.", "Harshal Parekh wrote a nice story not just explaining how it works but showing its impacts in a real situation. I really recommend reading:", "Like most prediction models, the branch prediction is usually based on the past behavior of conditional branches. The most simple branch prediction algorithm could be defined using a flag that indicates if the last branch was taken or not, and the algorithm will always guess that what happened last time will also happen next time. Thus, the flag needs to assume an initial value (1 for yes, 0 for no). If the guessing is correct, the flag will keep its value. If it doesn\u2019t, the flag changes its value. An example can be given in the following situation.", "After running a certain routine, a given branch b got the following behavior:", "On the first three iterations, the branch wasn\u2019t taken, on the following two, they were. The next four also wasn\u2019t taken, and the last one was. Considering that our branch predictor starts with the flag as 0, the accuracy will be 70%. The image below represents each iteration with a red arrow, followed by the current flag value and a symbol representing if the branch behavior was predicted correctly.", "The first misprediction will be on the fourth iteration because the last one was 0 (and the fourth is 1). This way, the flag now changes its value to 1. Since the branch will be taken on the following iteration, the prediction will be correct, however, on the sixth iteration, the branch is not taken again, so another miss prediction occurs. Now, the flag becomes 0 again and correctly predicts the next three iterations and then misses on the last iteration. In the end, we got 7 correct predictions and 3 mispredictions.", "Obviously this is not the way processors do branch prediction nowadays. There is a bunch of other techniques that give much better results. You can look for some of them in this paper written by Sparsh Mittal.", "It is quite easy to wonder if this kind of problem could be solved by artificial intelligence algorithms, and the answer is yes, they can. Since a long time ago, indeed. An example of a branch predictor that uses this kind of approach is the perceptron predictor, also addressed in the Sparsh Mittal survey. Due to recent advances in the field of artificial intelligence, the combination of these two areas is probably a hot trend inside the buildings of major tech companies such as Intel and AMD, and we can expect much more to come.", "So if you enjoy computer architecture and artificial intelligence, this is the research area that you can use all your knowledge in order to improve even more the processors that we have today.", "[1] Patterson, David A., and John L. Hennessy. Computer Organization and Design: The Hardware/Software Interface (2013). Paperback, Morgan Kaufmann Publishers.", "[3] Chang, Po-Yung. Classification-directed branch predictor design (1997). Doctoral dissertation, University of Michigan.", "[4] Mittal, Sparsh. A survey of techniques for dynamic branch prediction (2019). Concurrency and Computation: Practice and Experience 31.1.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "M.S. in Computer Science | Squad Lead at Luizalabs | Professor"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F892beeaf6a48&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@caiocarneloz?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@caiocarneloz?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "Caio Carneloz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cdefd20831e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&user=Caio+Carneloz&userId=9cdefd20831e&source=post_page-9cdefd20831e----892beeaf6a48---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F892beeaf6a48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F892beeaf6a48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@vladimir__film", "anchor_text": "Vladimir Malyutin"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://www.elsevier.com/books/computer-organization-and-design-mips-edition/patterson/978-0-12-407726-3", "anchor_text": "[1]"}, {"url": "https://en.wikipedia.org/wiki/User:Cburnett", "anchor_text": "Colin M.L. Burnett"}, {"url": "https://commons.wikimedia.org/wiki/File:Pipeline,_4_stage.svg", "anchor_text": "Wikimedia Commons"}, {"url": "https://patentimages.storage.googleapis.com/83/4c/27/df5557ed2268ab/US6571331.pdf", "anchor_text": "[2]"}, {"url": "http://www.eecs.umich.edu/techreports/cse/1997/CSE-TR-337-97.pdf", "anchor_text": "[3]"}, {"url": "https://www.researchgate.net/profile/Erhu_Hao", "anchor_text": "Erhu Hao"}, {"url": "https://www.researchgate.net/figure/Pipeline-bubble-a-single-issue-processor-with-four-pipeline-stages_fig1_2744762", "anchor_text": "ResearchGate"}, {"url": "https://www.elsevier.com/books/computer-organization-and-design-mips-edition/patterson/978-0-12-407726-3", "anchor_text": "[1]"}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1002/cpe.4666", "anchor_text": "[4]"}, {"url": "https://medium.com/u/2a6e065054e5?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "Harshal Parekh"}, {"url": "https://medium.com/swlh/branch-prediction-everything-you-need-to-know-da13ce05787e", "anchor_text": "Branch Prediction \u2014 Everything you need to know.In computer science, predication is an architectural feature that provides an alternative to conditional transfer of\u2026medium.com"}, {"url": "https://www.researchgate.net/publication/324166804_A_Survey_of_Techniques_for_Dynamic_Branch_Prediction", "anchor_text": "survey"}, {"url": "https://www.elsevier.com/books/computer-organization-and-design-mips-edition/patterson/978-0-12-407726-3", "anchor_text": "Computer Organization and Design: The Hardware/Software Interface"}, {"url": "https://patentimages.storage.googleapis.com/83/4c/27/df5557ed2268ab/US6571331.pdf", "anchor_text": "Static branch prediction mechanism for conditional branch instructions"}, {"url": "http://www.eecs.umich.edu/techreports/cse/1997/CSE-TR-337-97.pdf", "anchor_text": "Classification-directed branch predictor design"}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1002/cpe.4666", "anchor_text": "A survey of techniques for dynamic branch prediction"}, {"url": "https://medium.com/tag/technology?source=post_page-----892beeaf6a48---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----892beeaf6a48---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----892beeaf6a48---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----892beeaf6a48---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----892beeaf6a48---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F892beeaf6a48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&user=Caio+Carneloz&userId=9cdefd20831e&source=-----892beeaf6a48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F892beeaf6a48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&user=Caio+Carneloz&userId=9cdefd20831e&source=-----892beeaf6a48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F892beeaf6a48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F892beeaf6a48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----892beeaf6a48---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----892beeaf6a48--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----892beeaf6a48--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----892beeaf6a48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@caiocarneloz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@caiocarneloz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Caio Carneloz"}, {"url": "https://medium.com/@caiocarneloz/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "44 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cdefd20831e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&user=Caio+Carneloz&userId=9cdefd20831e&source=post_page-9cdefd20831e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4e6be0e790d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyour-processor-is-trying-to-predict-the-future-long-before-you-start-with-ai-892beeaf6a48&newsletterV3=9cdefd20831e&newsletterV3Id=4e6be0e790d6&user=Caio+Carneloz&userId=9cdefd20831e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}