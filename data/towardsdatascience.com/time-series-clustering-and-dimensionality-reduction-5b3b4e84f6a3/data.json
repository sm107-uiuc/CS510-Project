{"url": "https://towardsdatascience.com/time-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3", "time": 1682997411.136065, "path": "towardsdatascience.com/time-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3/", "webpage": {"metadata": {"title": "Time Series Clustering and Dimensionality Reduction | by Marco Cerliani | Towards Data Science", "h1": "Time Series Clustering and Dimensionality Reduction", "description": "Time Series must be handled with care by data scientists. This kind of data contains intrinsic information about temporal dependency. it\u2019s our work to extract these golden resources, where it is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Dataset+for+ADL+Recognition+with+Wrist-worn+Accelerometer", "anchor_text": "Public Dataset of Accelerometer Data for Human Motion Primitives Detection", "paragraph_index": 3}, {"url": "https://www.tylervigen.com/spurious-correlations", "anchor_text": "OVERSTIMATED and ABUSED", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test", "anchor_text": "Kolmogorov Smirnov statistic", "paragraph_index": 16}], "all_paragraphs": ["Time Series must be handled with care by data scientists. This kind of data contains intrinsic information about temporal dependency. it\u2019s our work to extract these golden resources, where it is possible and useful, in order to help our model to perform the best.", "With Time Series I see confusion when we face a problem of dimensionality reduction or clustering. We are used to think about these tasks in more classical domains, while they remain a tab\u00f9 when we deal with Time Series.", "In this post, I try to clarify these topics developing an interesting solution where I work with multidimensional Series coming from different individuals. Our purpose is to cluster them in an unsupervised way making use of deep learning, being wary of correlations, and pointing a useful technique that every data scientist must know!", "I got the data from UCI Machine Learning repository; I selected the Public Dataset of Accelerometer Data for Human Motion Primitives Detection. These data are a public collection of labeled accelerometer data recordings to be used for the creation and validation of acceleration models of human motion primitives.", "Different types of activities are tracked, i.e. drinking, eating, climbing and so on. For a particular activity of a specific individual measured, we have 3 different sensor series at disposal: X-axis (pointing toward the hand), Y-axis (pointing toward the left), Z-axis (perpendicular to the plane of the hand).", "I figure myself in this situation because it allows to carry out our initial problems of clustering (multiple individuals) and dimensionality reduction (multiple series for every individual) all in one single case.", "Below I plot 2 examples of data at our disposal coming from a male and female individuals. In total, we have 20 individuals with the same measurement length.", "Firstly, our attack plan provides to resolve the problem of multidimensionality. We want to summarize all the information stored in sensor data all in one significative series. This latest step will enable us to easy cluster our individuals in groups.", "There is a great variety of techniques which enable to reduce dimensionality in data, but our attention focused on Deep Learning algorithms. A neural network structure will permit us to handle easily our initial data: I remember you that we have 20 individuals and for every individual, we have 3 positional series of movements of length 170 (pythonic speaking we have an array of dimensions 20x170x3). The classical PCA based methods don\u2019t permit us to carry out this kind of problem, so we built our handmade Autoencoder in Keras which takes care of our infamous original data structure.", "Above I\u2019ve shown the architecture I\u2019ve used: the TimeDistributed layer permits to deal with 3D data where the dimension of the index one will be considered to be the temporal dimension. For our experiment, we use the first 10 individuals to train our Autoencoder and utilize the rest to compute error reconstructions with the relative predictions. Don\u2019t forget to standardize your data before to feed your Autoencoder! In our case, I\u2019ve standardized the data for every person by single observation (by rows).", "Our final reconstruction errors look like similar to this one below, where we have points near zeros when we are confident and we are able the detect the activity of this selected person; while we have high value when our model doesn\u2019t learn enough and it has not so much confidence to reconstruct the walking activity.", "At this point, we have at disposal manageable objects (with dimension 175x1 for 20 individuals) and we are ready to proceed with clustering. Technically speaking, we operate hierarchical clustering on reconstruction errors of our test individuals. In order to catch important relationships among these series, we try two different instruments to assemble our clusters.", "At the first stage, our choice involved the adoption of the Pearson Correlation index. Unfortunately, this measure is very OVERSTIMATED and ABUSED in statistics and machine learning fields, but we want to give it a chance\u2026", "After obtaining the correlation matrix, we operate directly on it performing the hierarchical clustering. We apply a high threshold (99% of the highest pairwise distance between sensor series) to form our flat clusters. This will result in the creation of high-level groups, small in number, but which give us a first impressive overview of our test data.", "Looking at color intensities of the correlation matrix (on which we\u2019ve just operated clustering procedures), we can\u2019t see obvious group patterns. On the right, the cut (black line) of the dendrogram, after some initial \u2018uncertainty\u2019, doesn\u2019t create rational groups. Male and female are mixed together without logic!", "The Pearson Correlation index confirms again its unreliability, we have to go another way\u2026", "Recently, I\u2019ve read about Kolmogorov Smirnov statistic and this has produced a double effect to me: it has reminded me of the university and it has stolen my attention for its adaptability. This statistic, with the relative p-value, is used to measure the difference in distribution among two samples. I think that our clustering task is a good field of application for this killer instrument.", "Compute this statistic is very easy with python and, in order to use it in our case, we only have to create the Kolmogorov Smirnov Matrix (equivalent to the Correlation Matrix) and reproduce the same steps we\u2019ve done above.", "Now, looking at the color intensity of our matrix (on which we\u2019ve just operated clustering procedures), we can observe the presence of a pattern among females and males. As clearly visible in the dendrogram on the right, our hierarchical procedure has created two sensible groups, where men are all separated from women. The \u2018uncertainty\u2019, at the beginning of clusters building, is also disappeared.", "This is the result we want, which confirms the importance of the presence of Kolmogorov Smirnov statistic in the arsenal of every data scientist.", "In this post, we\u2019ve solved simultaneously a problem of dimensionality reduction and clustering for time series data. We\u2019ve utilized an Autoencoder to summarize (in form of reconstruction errors) the relevant characteristics of the accelerometers. With our one-dimensional series, we\u2019ve carried out a clustering partition among individuals. The most satisfying results come from the combination of Kolmogorov Smirnov statistic and hierarchical clustering, confirming again that Pearson Correlation must be handled with caution.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5b3b4e84f6a3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----5b3b4e84f6a3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b3b4e84f6a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b3b4e84f6a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@igorcferreira?utm_source=medium&utm_medium=referral", "anchor_text": "Igor Ferreira"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Dataset+for+ADL+Recognition+with+Wrist-worn+Accelerometer", "anchor_text": "Public Dataset of Accelerometer Data for Human Motion Primitives Detection"}, {"url": "https://www.tylervigen.com/spurious-correlations", "anchor_text": "OVERSTIMATED and ABUSED"}, {"url": "https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test", "anchor_text": "Kolmogorov Smirnov statistic"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook?source=post_page---------------------------", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/?source=post_page---------------------------", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5b3b4e84f6a3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5b3b4e84f6a3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/clustering?source=post_page-----5b3b4e84f6a3---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----5b3b4e84f6a3---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----5b3b4e84f6a3---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5b3b4e84f6a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&user=Marco+Cerliani&userId=c843902314c7&source=-----5b3b4e84f6a3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5b3b4e84f6a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&user=Marco+Cerliani&userId=c843902314c7&source=-----5b3b4e84f6a3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b3b4e84f6a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5b3b4e84f6a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5b3b4e84f6a3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5b3b4e84f6a3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-clustering-and-dimensionality-reduction-5b3b4e84f6a3&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}