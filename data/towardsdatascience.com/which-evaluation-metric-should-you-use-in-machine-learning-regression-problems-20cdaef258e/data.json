{"url": "https://towardsdatascience.com/which-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e", "time": 1683012035.916252, "path": "towardsdatascience.com/which-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e/", "webpage": {"metadata": {"title": "Which Evaluation Metric Should You Use in Machine Learning Regression Problems? | by Jeff Hale | Towards Data Science", "h1": "Which Evaluation Metric Should You Use in Machine Learning Regression Problems?", "description": "If you\u2019re like me, you might have used R-Squared (R\u00b2), Root Mean Squared Error (RMSE), and Mean Absolute Error (MAE )evaluation metrics in your regression problems without giving them a lot of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/scikit-learn/scikit-learn/blob/fd237278e/sklearn/metrics/_regression.py#L494", "anchor_text": "scikit-learn", "paragraph_index": 10}, {"url": "https://stats.stackexchange.com/a/12991/198892", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://github.com/discdiver/r2_rmse_mae", "anchor_text": "this Jupyter notebook", "paragraph_index": 18}, {"url": "https://en.wikipedia.org/wiki/Coefficient_of_determination#Adjusted_R2", "anchor_text": "Adjusted R\u00b2", "paragraph_index": 24}, {"url": "https://www.statsmodels.org/stable/index.html", "anchor_text": "Statsmodels", "paragraph_index": 26}, {"url": "https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.RegressionResults.rsquared_adj.html#statsmodels.regression.linear_model.RegressionResults.rsquared_adj", "anchor_text": "does", "paragraph_index": 26}, {"url": "https://towardsdatascience.com/which-python-data-science-package-should-i-use-when-e98c701364c", "anchor_text": "here", "paragraph_index": 26}, {"url": "https://medium.com/human-in-a-machine-world/mae-and-rmse-which-metric-is-better-e60ac3bde13d", "anchor_text": "this excellent article", "paragraph_index": 39}, {"url": "https://medium.com/u/5086e44692d2?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "JJ", "paragraph_index": 39}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_absolute_error.html", "anchor_text": "scikit-learn", "paragraph_index": 46}, {"url": "https://twitter.com/discdiver", "anchor_text": "Twitter", "paragraph_index": 60}, {"url": "https://memorablepython.com", "anchor_text": "Python", "paragraph_index": 63}, {"url": "https://memorablesql.com", "anchor_text": "SQL", "paragraph_index": 63}, {"url": "https://memorabledocker.com", "anchor_text": "Docker", "paragraph_index": 63}, {"url": "https://dataawesome.com", "anchor_text": "mailing list of awesome data science resources", "paragraph_index": 63}, {"url": "https://medium.com/@jeffhale", "anchor_text": "here", "paragraph_index": 63}, {"url": "https://dataawesome.com", "anchor_text": "https://dataawesome.com", "paragraph_index": 65}], "all_paragraphs": ["If you\u2019re like me, you might have used R-Squared (R\u00b2), Root Mean Squared Error (RMSE), and Mean Absolute Error (MAE )evaluation metrics in your regression problems without giving them a lot of thought. \ud83e\udd14", "Although all of them are common metrics, it\u2019s not obvious which one to use when. After writing this article I have a new favorite and a new plan for reporting them going forward. \ud83d\ude00", "I\u2019ll share those conclusions with you in a bit. First, we\u2019ll dig into each metric. You\u2019ll learn the pros and cons of each for model selection and reporting. Let\u2019s get to it! \ud83d\ude80", "R\u00b2 represents the proportion of variance explained by your model.", "R\u00b2 is a relative metric, so you can use it to compare with other models trained on the same data. And you can use it to get a rough a feel for how well a model performs, in general.", "Disclaimer: This article isn\u2019t a review of machine learning methods, but make sure you use different data for training, validation, and testing. You always want to hold out some data that your model has not seen to evaluate its performance. Also, it\u2019s a good idea to look at plot of your model\u2019s predictions vs. the actual values to see how well your model fit the data.", "Let\u2019s see how R\u00b2 is computed. Onward! \u27a1\ufe0f", "Here is one way to formulate R\u00b2.", "SSE is the sum of squared errors; the sum of the squared differences between the actual values and predicted values.", "SST is the total sum of squares (shown sometimes as TSS); the sum of the squared differences between the actual values and the mean of the actual values.", "Here\u2019s what the code looks like \u2014adapted from scikit-learn, the primary Python machine learning library.", "1 - the numerator/denominator is the R\u00b2. \ud83c\udf89", "R\u00b2 is the default metric for scikit-learn regression problems. If you want to use it explicitly you can import it and then use it like this:", "A model that explains no variance would have an R\u00b2 of 0. A model with an R\u00b2 of 1 would explain all of the variance. Higher scores are better.", "However, if your R\u00b2 is 1 on your test set you are probably leaking information or the problem is fairly simple for your model to learn. \ud83d\udc4d", "In some fields, such as the social sciences, there are lots of factors that influence human behavior. Say you have a model with just a few independent variables that results in an R\u00b2 close to .5. Your model is able to account for half of the variance in your data, and that\u2019s quite good. \ud83d\ude00", "It is possible to have an R\u00b2 that is negative. Negative scores occur when the predictions the model makes fit that data worse than the mean of the output values. Predicting the mean each time is a null model. See more here.", "Say you have the following small toy test dataset:", "All code is available on GitHub in this Jupyter notebook.", "Here\u2019s a plot of the actual and predicted y values.", "The R\u00b2 of the model is 0.71. The model is accounting for 71% of the variance in the data. That\u2019s not too shabby, although we\u2019d like more test data. \ud83d\ude00", "As another example, let\u2019s say the true values for y are [55, 2, 3]. The mean is 20. Predicting 20 for each y value results in an R\u00b2 of 0.", "A model that predicts [1 , 2, 2] for the true values above results in an R\u00b2 of -0.59. Bottom line, you can do far worse than the null model! In fact, you can predict infinitely worse, resulting in an infinitely low R\u00b2. \ud83d\ude32", "As a brief aside, let\u2019s look at the Adjusted R\u00b2 and machine learning vs. statistics.", "The Adjusted R\u00b2 accounts for the addition of more predictor variables (features).", "Adjusted R\u00b2 will only increase with a new predictor variable when that variable improves the model performance more than would be expect by chance. Adjusted R\u00b2 helps you focus on using the most parsimonious model possible. \ud83d\ude09", "The Adjusted R\u00b2 is more common in statistical inference than in machine learning. Scikit-learn, the primary Python library for machine learning, doesn\u2019t even have an Adjusted R\u00b2 metric. Statsmodels, the primary statistical library for Python does. If you want to learn more about when to use which Python library for data science, I wrote a guide here.", "You can compute the Adjusted R2 if you know the number of feature columns (p) and the number of observations (n). Here\u2019s the code:", "n-1 is the degrees of freedom. Whenever you hear that term, you know you are in statistics land. In machine learning we generally care most about predictive ability, so R\u00b2 is favored over Adjusted R\u00b2.", "Another note on statistics vs. machine learning: our focus is on machine learning, so prediction rather than causality. R\u00b2 \u2014 and the other metrics that we\u2019ll see, don\u2019t say anything about causality by themselves.", "R\u00b2 tells you how much variance your model accounts for. It\u2019s handy because the R\u00b2 for any regression problem will immediately provide some (limited) understanding of how well the model is performing. \ud83d\ude00", "R\u00b2 is a relative metric. Let\u2019s see a few absolute metrics now.", "RMSE is a very common evaluation metric. It can range between 0 and infinity. Lower values are better. To keep this straight, remember that it has error in the name and you want errors to be low. \u261d\ufe0f", "The RMSE can be formulated like this:", "We saw SSE in the R\u00b2 score metric. It\u2019s the sum of squared errors; the sum of the squared differences between the actual values and predicted values.", "Here\u2019s how to get the RMSE with a function in scikit-learn:", "You can use the squared=False argument as of scikit-learn version 0.22.0. Prior to that you had to take the square root yourself like this: np.sqrt(mean_squared_error(y_actual, y_predicted). \u261d\ufe0f", "Use RMSE if you want to:", "You could use the Mean Squared Error (MSE) with no Root, but then the units are not as easily comprehensible. Just take the square root of the MSE and you\u2019ve got the RMSE. \ud83d\udc4d", "In this excellent article JJ points out some issues with RMSE. Namely, that \u201cRMSE does not necessarily increase with the variance of the errors. RMSE increases with the variance of the frequency distribution of error magnitudes.\u201d", "Also, the RMSE is not so easily interpreted. The units might look familiar, but you are squaring differences. You can\u2019t just say that an RMSE of 10 means you are off by 10 units on average, although that\u2019s kind of how most folks think of the result. At least, it\u2019s how I used to. \ud83d\ude09", "Turning to our example dataset again:", "The RMSE is 0.48. The mean of the actual y values is 2.2. Together, that information tells us that the model is probably somewhere between great and terrible. It\u2019s hard to do too much with this RMSE statistic without more context. \ud83d\ude10", "RMSE is an imperfect statistic for evaluation, but it\u2019s very common. If you care a lot about penalizing large errors, it\u2019s not a bad choice. It\u2019s a great choice for a loss metric when hyperparameter tuning or batch training a deep neural network.", "Mean Absolute Error (MAE) is the average of the absolute value of the errors.", "Let\u2019s get right to math equation:", "Here\u2019s how to get the MAE with a scikit-learn function:", "The MAE is conceptually the easiest evaluation metric for regression problems. It answers the question, \u201cHow far were you off in your predictions, on average?\u201d", "The units make intuitive sense. Yes! \ud83c\udf89", "For example, say you are predicting house sale prices and the mean actual sale price in the test set is $500,000. An MAE of $10,000 means the model was off by an average of $10k in its predictions. That\u2019s not bad! \ud83d\ude00", "Unlike RMSE scores, bad predictions don\u2019t result in disproportionately high MAE scores.", "The MAE will always be closer to 0 than the RMSE (or the same).", "Note that computing the RMSE as an optimization metric for a model with a training loop is faster than computing MAE.", "Turning to our example dataset for a final time:", "The MAE is 0.37. The predictions were off from the mean of 2.2 by an average of 0.37. I can quickly understand that statement. \ud83d\ude00", "MAE is the simplest evaluation metric and most easily interpreted. It\u2019s a great metric to use if you don\u2019t want a few far off predictions to overwhelm a lot of close ones. It\u2019s a less good choice if you want to penalize predictions that were really far off the mark.", "So which metric should you use? In general, I suggest you report all three! \ud83d\ude80", "R\u00b2 gives people evaluating the performance an at-a-glance understanding of how well your model performs. It\u2019s definitely worth report it.", "RMSE is less intuitive to understand, but extremely common. It penalizes really bad predictions. It also make a great loss metric for a model to optimize because it can be computed quickly. It merits reporting.", "I came out of this article with new respect for MAE. It\u2019s straightforward to understand and treats all prediction errors proportionately. I would emphasize it in most regression problem evaluations.", "Disagree? Let me know on Twitter. \ud83d\udc4d", "If you want to learn about metrics for classification problems, I wrote about them here.", "I hope you enjoyed this guide to popular Python data science packages. If you did, please share it on your favorite social media so other folks can find it, too. \ud83d\ude00", "I write about Python, SQL, Docker, and other tech topics. If any of that\u2019s of interest to you, sign up for my mailing list of awesome data science resources and read more to help you grow your skills here. \ud83d\udc4d", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about data science. Join my Data Awesome mailing list to stay on top of the latest data tools and tips: https://dataawesome.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F20cdaef258e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----20cdaef258e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jeffhale.medium.com/?source=post_page-----20cdaef258e--------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "Jeff Hale"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F451599b1142a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&user=Jeff+Hale&userId=451599b1142a&source=post_page-451599b1142a----20cdaef258e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F20cdaef258e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F20cdaef258e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/scikit-learn/scikit-learn/blob/fd237278e/sklearn/metrics/_regression.py#L494", "anchor_text": "scikit-learn"}, {"url": "https://stats.stackexchange.com/a/12991/198892", "anchor_text": "here"}, {"url": "https://github.com/discdiver/r2_rmse_mae", "anchor_text": "this Jupyter notebook"}, {"url": "https://en.wikipedia.org/wiki/Coefficient_of_determination#Adjusted_R2", "anchor_text": "Adjusted R\u00b2"}, {"url": "https://www.statsmodels.org/stable/index.html", "anchor_text": "Statsmodels"}, {"url": "https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.RegressionResults.rsquared_adj.html#statsmodels.regression.linear_model.RegressionResults.rsquared_adj", "anchor_text": "does"}, {"url": "https://towardsdatascience.com/which-python-data-science-package-should-i-use-when-e98c701364c", "anchor_text": "here"}, {"url": "https://medium.com/human-in-a-machine-world/mae-and-rmse-which-metric-is-better-e60ac3bde13d", "anchor_text": "this excellent article"}, {"url": "https://medium.com/u/5086e44692d2?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "JJ"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_absolute_error.html", "anchor_text": "scikit-learn"}, {"url": "https://twitter.com/discdiver", "anchor_text": "Twitter"}, {"url": "https://memorablepython.com", "anchor_text": "Python"}, {"url": "https://memorablesql.com", "anchor_text": "SQL"}, {"url": "https://memorabledocker.com", "anchor_text": "Docker"}, {"url": "https://dataawesome.com", "anchor_text": "mailing list of awesome data science resources"}, {"url": "https://medium.com/@jeffhale", "anchor_text": "here"}, {"url": "https://www.dataawesome.com", "anchor_text": ""}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----20cdaef258e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----20cdaef258e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----20cdaef258e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/technology?source=post_page-----20cdaef258e---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----20cdaef258e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F20cdaef258e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&user=Jeff+Hale&userId=451599b1142a&source=-----20cdaef258e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F20cdaef258e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&user=Jeff+Hale&userId=451599b1142a&source=-----20cdaef258e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F20cdaef258e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F20cdaef258e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----20cdaef258e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----20cdaef258e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----20cdaef258e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----20cdaef258e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----20cdaef258e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----20cdaef258e--------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeff Hale"}, {"url": "https://jeffhale.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "18K Followers"}, {"url": "https://dataawesome.com", "anchor_text": "https://dataawesome.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F451599b1142a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&user=Jeff+Hale&userId=451599b1142a&source=post_page-451599b1142a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe7ae6804f27a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhich-evaluation-metric-should-you-use-in-machine-learning-regression-problems-20cdaef258e&newsletterV3=451599b1142a&newsletterV3Id=e7ae6804f27a&user=Jeff+Hale&userId=451599b1142a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}