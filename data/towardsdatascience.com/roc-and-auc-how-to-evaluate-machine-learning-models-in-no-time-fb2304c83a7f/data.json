{"url": "https://towardsdatascience.com/roc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f", "time": 1683017464.641203, "path": "towardsdatascience.com/roc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f/", "webpage": {"metadata": {"title": "ROC and AUC \u2014 How to Evaluate Machine Learning Models in No Time | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "ROC and AUC \u2014 How to Evaluate Machine Learning Models in No Time", "description": "Model selection should be easy. And it is \u2014 if you know how to calculate and interpret ROC curves and AUC scores. That\u2019s what you\u2019ll learn in this article \u2014 in 10 minutes if you\u2019re coding along. In 5\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/piyushagni5/white-wine-quality", "anchor_text": "White wine quality dataset", "paragraph_index": 15}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 27}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 29}], "all_paragraphs": ["Model selection should be easy. And it is \u2014 if you know how to calculate and interpret ROC curves and AUC scores. That\u2019s what you\u2019ll learn in this article \u2014 in 10 minutes if you\u2019re coding along. In 5 if you aren\u2019t.", "You can use ROC (Receiver Operating Characteristic) curves to evaluate different thresholds for classification machine learning problems. In a nutshell, ROC curve visualizes a confusion matrix for every threshold.", "Every time you train a classification model, you can access prediction probabilities. If a probability is greater than 0.5, the instance is classified as positive. Here, 0.5 is the decision threshold. You can adjust it to reduce the number of false positives or false negatives.", "ROC curve shows a False positive rate on the X-axis. This metric informs you about the proportion of negative class classified as positive (Read: COVID negative classified as COVID positive).", "On the Y-axis, it shows a True positive rate. This metric is sometimes called Recall or Sensitivity, so keep that in mind. It informs you about the positive class proportion that was correctly classified (Read: COVID positive and classified as COVID positive).", "Refer to the following image for a refresher in the confusion matrix and TPR/FPR calculation:", "AUC represents the area under the ROC curve. Higher the AUC, the better the model at correctly classifying instances. Ideally, the ROC curve should extend to the top left corner. The AUC score would be 1 in that scenario.", "Let\u2019s go over a couple of examples. Below you\u2019ll see random data drawn from a normal distribution. Means and variances differ to represent centers for different classes (positive and negative).", "For a great model, the distributions are entirely separated:", "You can see that this yields an AUC score of 1, indicating that the model classifies every instance correctly.", "Can AUC be 0? Yes \u2014 it means the model is reciprocating the classes. In other words, it\u2019s predicting positive classes and negative and vice versa. Take a look at the image below:", "Can you think of a quick way of turning a 0% accurate model into a 100% one? Let\u2019 me know in the comment section below.", "Finally, there\u2019s a scenario when AUC is 0.5. It means the model is useless. Just think about it, you ask a model whether someone is positive or negative, and it tells you: well, maybe it\u2019s positive, maybe it\u2019s negative (50:50). That\u2019s useless for binary classification tasks.", "Here\u2019s how the ROC curve looks like when AUC is 0.5:", "Now you know the theory. Let\u2019s connect it with practice next.", "You\u2019ll use the White wine quality dataset for the practical part. Here\u2019s how to load it with Python:", "The first couple of rows look like this:", "Initially, this is not a binary classification dataset, but you can convert it to one. Let\u2019s say the wine is Good if the quality is 7 or above, and Bad otherwise:", "There\u2019s your binary classification dataset. Let\u2019s visualize the counts of good and bad wines next. Here\u2019s the code:", "And there\u2019s nothing more to do with regards to preparation. You can make a train/test split next:", "Great! The snippet below shows you how to train logistic regression, decision tree, random forests, and extreme gradient boosting models. It also shows you how to grab probabilities for the positive class. It will come in handy later:", "You can visualize the ROC curves and calculate the AUC now. The only requirement is to remap the Good and Bad class names to 1 and 0, respectively.", "The following code snippet visualizes the ROC curve for the four trained models and shows their AUC score on the legend:", "No perfect models here, but all of them are far away from the baseline (unusable model). The random forest algorithm is the best, with a 0.93 AUC score. That\u2019s amazing for the preparation and feature engineering we did.", "In a nutshell, you can use ROC curves and AUC scores to choose the best machine learning model for your dataset. Image 7 shows you how easy it is to interpret the ROC curves, even when there are multiple curves on the same chart.", "If you need a completely automated solution, look only at the AUC and select the model with the highest score.", "What\u2019s your approach to model selection? Let me know in the comment section.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffb2304c83a7f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----fb2304c83a7f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb2304c83a7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb2304c83a7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@priscilladupreez?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Priscilla Du Preez"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/piyushagni5/white-wine-quality", "anchor_text": "White wine quality dataset"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----fb2304c83a7f---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fb2304c83a7f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fb2304c83a7f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----fb2304c83a7f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fb2304c83a7f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb2304c83a7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----fb2304c83a7f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb2304c83a7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----fb2304c83a7f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb2304c83a7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffb2304c83a7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fb2304c83a7f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fb2304c83a7f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Froc-and-auc-how-to-evaluate-machine-learning-models-in-no-time-fb2304c83a7f&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}