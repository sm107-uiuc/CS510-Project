{"url": "https://towardsdatascience.com/winning-the-price-is-right-with-ai-b77e6ade44e3", "time": 1683000688.613502, "path": "towardsdatascience.com/winning-the-price-is-right-with-ai-b77e6ade44e3/", "webpage": {"metadata": {"title": "Winning The Price is Right with AI | by Nelson Griffiths | Towards Data Science", "h1": "Winning The Price is Right with AI", "description": "In machine learning, I feel like cost functions are an oft overlooked part of the problem solving process. Many data scientists get excited about using a new model or tuning the hyper-parameters just\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/PromptCloudHQ/toy-products-on-amazon", "anchor_text": "Amazon Toy Dataset", "paragraph_index": 9}, {"url": "https://github.com/ngriffiths13/custom_loss/blob/master/notebooks/data_cleaning.ipynb", "anchor_text": "this notebook here", "paragraph_index": 9}, {"url": "https://lightgbm.readthedocs.io/en/latest/", "anchor_text": "Microsoft\u2019s LightGBM", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html", "anchor_text": "scikit-learn also supports it.", "paragraph_index": 23}], "all_paragraphs": ["In machine learning, I feel like cost functions are an oft overlooked part of the problem solving process. Many data scientists get excited about using a new model or tuning the hyper-parameters just right to get the best performance possible. We generally tend to choose one of the common cost functions, such as mean squared error, and move on to training without a second thought. I would argue though, that spending time thinking about and understanding what a cost function means and how it impacts the performance of a model can have a significant impact on the outcome of a project. So, in order to explore this idea further, I played a modified version of the popular game show The Price is Right. In this experiment of mine, I looked at how different cost functions impact model performance, including how I could write my own functions that were more specific to the problem I wanted to solve to improve the results even further.", "Note: This next section is an overview of how I see cost functions fitting into the overall problem solving process. If you are just interested in the code or experiments feel free to jump to the next section.", "This is not intended to be an introduction to cost functions and assumes some prior knowledge of both cost functions and gradient descent. With that said, I do want to give a quick overview of cost functions and then dive into their impact in the problem solving process.", "Let\u2019s look at a basic example of simple linear regression to review cost functions. In linear regression, we attempt to solve the problem of finding the best model coefficients to draw a line that fits the data. In machine learning, this is generally done by gradient descent. Gradient descent is the process by which a coefficient slowly moves down a cost curve until it finds a place where the cost function is minimized. Enter the importance of a cost function.", "A cost function directs the model in how it should weigh different variables when making predictions. It acts as a guide to help the model learn the correct way to fit the data. So you can imagine that this might be really important. If a model is given a poor cost function, it will not learn to make good predictions and will not be useful.", "One way I have found valuable to think about cost functions is to look at them as a reflection of the overall goal of a model. Whatever mathematical function that is being chosen to be minimized through gradient descent should be in line with what we want the model to do as much as possible. Let\u2019s look at the game show The Price is Right as an example. The goal of this game is to predict the price of an item as closely as possible without guessing over the actual price. So how can a cost function reflect this? We want our cost function to tell our model to make predictions without over-shooting the truth. Seems pretty self-explanatory, right? So why doesn\u2019t every data scientist always write a custom loss function for every different problem they solve?", "In reality, I don\u2019t think it is practical to try and write a unique cost function for every problem you are trying to solve. There is a reason that certain cost functions have been made popular for certain tasks. It is because they generally do a very good job solving certain types of problems. Many of these functions have been made very easy to implement in popular frameworks such as scikit-learn. Because of this, in many cases it doesn\u2019t make sense to spend the time to write a custom function that may take longer to minimize and not improve your results. This is not to say that it is not worth still taking the time to think through your problem and which cost function makes the most sense (I think this is an invaluable part of the problem solving process). But in reality, you can usually find a cost function that will help solve your problem without taking the time to write your own.", "Given the caveats above, there are still times when you may think through your problem and find that you could create your own cost function that will provide better results. The point of this article is to show you the impact that understanding your problem enough to write your own cost function can have on your project outcomes. Now with the stage set, its time to dive into The Price is Right.", "If you are not familiar with the game show The Price is Right, the game is pretty simple. Four contestants come to the front to compete with each other. They are shown and item and all have to guess how much it costs. The contestant that guesses closest to the actual price without going over the price wins and moves onto the next round. So the obvious question most rational people would ask is this: \u201cCan I build a machine learning model to help me win in the first round of The Price is Right?\u201d", "To train a model to help me win The Price is Right I used data from the Amazon Toy Dataset which is available on Kaggle. Before jumping into my experiments, I did some data cleaning and used some basic NLP to create features to predict the prices of the toys in the data. If you are interested in seeing exactly how I did it you can check out this notebook here. My final data frame looked like this:", "For this experiment I decided to use Microsoft\u2019s LightGBM. It is an extremely popular model and currently one of my favorites. It also allows for some easy ways to set up cost functions and evaluation. As for the cost functions, I decided to test 5 different variations. I used 2 baselines, the MAE and MSE functions already implemented by LightGBM. Then I wrote 3 custom functions to test also. I tuned the hyper-parameters of the model to the MAE and kept them the same for all model iterations with the same random state. So if anything, I attempted to give the baseline the advantage in my experiment.", "Next was the evaluation of the cost functions. I decided to evaluate several different aspects of model performance. The first I called total winnings. In an attempt to somewhat replicate The Price is Right, total winnings were calculated as follows: If the prediction was above the truth, winnings were equal to zero. If the prediction was below the truth, winnings were equal to the prediction. This type of evaluation gives more weight to items of higher value. Because of this, I also evaluated standardized winnings which were calculated as follows: If the prediction was above the truth, winnings were equal to zero. If the prediction was below the truth, winnings were equal to the prediction divided by the truth. This method gives equal weight to every item in the test set. In addition to these methods, I calculated the percentage of items over-predicted by each model. Below is the class I created to evaluate the models.", "LightGBM uses two different types of functions to train a model. The first is the one I spoke about above. It is the objective function. This is the function that calculates the gradient of the cost function to help the model learn. LightGBM is unique in that it uses both the first and second derivatives in its learning. You will see I have both below. The second type of function is an evaluation function. In this experiment we use an evaluation set and early stopping to train our models. The model uses the evaluation function to determine when a certain metric stops improving. When it hits this point, the model stops training to optimize that metric. For my experiment I wrote one objective function that I used with three different evaluation functions.", "For several of these functions, we use a penalty to push our model towards under-predicting. This is a concept that is also used in Lasso and Ridge regressions to assign coefficient weights effectively. In the experiment I look at several different penalty values and use the best one for each function. Let\u2019s take a quick look at these functions.", "overprediction_penalty_objective: This is our objective function. It is a simple variation from the MSE. We calculate the 1st and 2nd derivative of the MSE and multiply the loss by a penalty when the prediction is greater than the true value.", "overprediction_penalty_squared: This is our first evaluation function. It is also a variation of MSE with a penalty on over-predictions.", "overprediction_penalty_absolute: This is a variation of the MAE with a penalty on over-predictions.", "overprediction_penalty_pr: This is a unique evaluation function that I wrote specifically for this problem. In it I try to mimic the goal of our experiment by returning a loss equal to our prediction in order to coax our model into giving us the highest winnings possible.", "And here is a quick look at the helper function I wrote to run the experiments. You can see the hard-coded hyper-parameters that I used along with the early stopping and validation sets.", "For each cost function I looked at the best scores for both total winnings and standardized winnings. Here were the results for total winnings.", "From these results, we can see that our custom objective function paired with our problem specific evaluation function performed the best followed by our custom MSE evaluation function. It is also interesting to note that the cost functions performed best with different penalties. I will note that with each penalty this is not the order that the cost functions finished in. In some the problem specific evaluation won, in some the custom MSE won, and in one version the regular MAE won. This suggests that in most cases you will have to tinker with penalties and hyper-parameters to determine the best model. Now for the standardized winnings.", "With the standardized winnings, there was a (unsurprisingly) high correlation between the number of prices under-predicted and the winnings. But once again, I noticed that the order changed depending on the different penalties applied to the problem.", "The ability to write custom cost functions has come in handy for me several times. Sometimes it has been because of a specific problem that was better suited for something that wasn\u2019t already supported by a model. I have also had situations where my model was simply over-predicting way more than it was under-predicting and I wanted to balance it out. Regardless, I believe that it is something worth tinkering with and trying. It takes experimentation, as do many things in the realm of data science, but it has the potential to make an impact on the outcomes of your model.", "If you are interested in looking at other ways to write custom functions, scikit-learn also supports it. You can also write custom cost functions in both TensorFlow and PyTorch. I think that it is worth taking the time to understand cost functions and how they can change the performance of your models.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Branded Entertainment Network. Interested in Machine Learning, Exercise Science, and Finance."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb77e6ade44e3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nelsongriffiths123?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nelsongriffiths123?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": "Nelson Griffiths"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7278fd01858d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&user=Nelson+Griffiths&userId=7278fd01858d&source=post_page-7278fd01858d----b77e6ade44e3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb77e6ade44e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb77e6ade44e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/PromptCloudHQ/toy-products-on-amazon", "anchor_text": "Amazon Toy Dataset"}, {"url": "https://github.com/ngriffiths13/custom_loss/blob/master/notebooks/data_cleaning.ipynb", "anchor_text": "this notebook here"}, {"url": "https://lightgbm.readthedocs.io/en/latest/", "anchor_text": "Microsoft\u2019s LightGBM"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html", "anchor_text": "scikit-learn also supports it."}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b77e6ade44e3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/cost-function?source=post_page-----b77e6ade44e3---------------cost_function-----------------", "anchor_text": "Cost Function"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b77e6ade44e3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/lightgbm?source=post_page-----b77e6ade44e3---------------lightgbm-----------------", "anchor_text": "Lightgbm"}, {"url": "https://medium.com/tag/experiment?source=post_page-----b77e6ade44e3---------------experiment-----------------", "anchor_text": "Experiment"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb77e6ade44e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&user=Nelson+Griffiths&userId=7278fd01858d&source=-----b77e6ade44e3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb77e6ade44e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&user=Nelson+Griffiths&userId=7278fd01858d&source=-----b77e6ade44e3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb77e6ade44e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb77e6ade44e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b77e6ade44e3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b77e6ade44e3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nelsongriffiths123?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nelsongriffiths123?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nelson Griffiths"}, {"url": "https://medium.com/@nelsongriffiths123/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "308 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7278fd01858d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&user=Nelson+Griffiths&userId=7278fd01858d&source=post_page-7278fd01858d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbfa78ab0815d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwinning-the-price-is-right-with-ai-b77e6ade44e3&newsletterV3=7278fd01858d&newsletterV3Id=bfa78ab0815d&user=Nelson+Griffiths&userId=7278fd01858d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}