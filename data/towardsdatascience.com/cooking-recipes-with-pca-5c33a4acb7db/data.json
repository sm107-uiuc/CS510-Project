{"url": "https://towardsdatascience.com/cooking-recipes-with-pca-5c33a4acb7db", "time": 1682993550.439809, "path": "towardsdatascience.com/cooking-recipes-with-pca-5c33a4acb7db/", "webpage": {"metadata": {"title": "Cooking with Machine Learning: Dimension Reduction | by Diego Toledo | Towards Data Science", "h1": "Cooking with Machine Learning: Dimension Reduction", "description": "Recently I came across this cooking recipes data set in Kaggle, and it inspired me to combine 2 of my main interests in life. Food and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "Haven\u2019t you heard of the dimensionality curse?", "paragraph_index": 7}], "all_paragraphs": ["What makes this data set special is that it contains recipes from 20 different cuisines, 6714 different ingredients, but only 26648 samples. Some cuisines have way fewer recipes than others.", "This is way too many features for this amount of data. The first step before working with this data set, should be reducing its dimensions. And in this post I will show how to use PCA to reduce those 6714 ingredients into a latent space with only 700 dimensions. And as a bonus we will use this model as an anomaly detector.", "Here is how the data looks like:", "The most challenging aspect is that it is very sparse, here is the breakdown of ingredients per recipe:", "Another way to see it, is to check this variance histogram:", "And if we zoom a bit:", "Which means that in average, each row of 6714 features has only 10 features active. Way less than 1%. This should make things hard to split the data into a training and test set. Because of that, you are very likely to end up with recipes with completely different patterns in both sets. A good way to address this issue would be to k-fold the data, but not in this case. The data is too sparse, it would not improve much.", "For a sparse data set with so many features, a first step is usually to reduce the number of dimensions. Haven\u2019t you heard of the dimensionality curse?", "For this post I will be using a very popular method to reduce dimensions: PCA", "Time to get busy! Let\u2019s do some basic transformation on the data. The main idea here is that because we have qualitative data, we need to do something called one-hot-encoding. Long story short: 6714 ingredients -> 6714 columns. When one ingredient is present in a recipe, its column goes to 1. All the rest stays as a 0. In average only 10 of those columns will be \u2018active\u2019 in each row. This code will create the \u201ctransformer\u201d, that will get an ingredient and output its vector representation", "This code gives us an encoder that will get a ingredient (string) as input and output its vector representation. The final vector containing all the recipe\u2019s ingredients will be the result of a \u2018logical or\u2019 on every one of those ingredient vectors", "PCA is a very popular choice. It is used as a preprocessing tool before feeding the new reduced data set to be visualized with t-sne but also is the tool you may want to use to reduce your features before feeding into a machine learning algorithm.", "This is desirable because the more features you have, the more data you will need, and slower is the learning process. So, keeping things small will boost your performance.", "But before minimizing the data, you need to make one call: how small you want that? There is a tradeoff here, the smaller you go, more info you lose. You can measure that by using the same trained model you use to minimize the data, to later maximize back to the original size. After that you can compare the 2 samples and measure how different they are (remember, you lose info when you go down).", "So, let\u2019s just train a bunch of different models, and pick one with very few features but with a low reconstruction error.", "In the X axis we have the number of component vectors, while in the Y axis is the reconstruction error for the whole sample (using L2). Those results look good right? But let\u2019s dig deeper here. 700 seems to be a safe number to pick, there isn\u2019t much improvement around that area. It is already a huge improvement from 6714 features. Let\u2019s compare with some unseen data, the test set.", "Here we can see that PCA did a decent job in generalizing the structure of the data. The train mean square error ~= 0.000171% and the test mean square error ~= 0.0002431%. Not bad.", "We know from before that the data has in average 10 ingredients, standard deviation of 4.42. What if we create some \u2018random recipes\u2019 using that distribution (picking ingredients at random)? This can be achieved using a gaussian generator. If PCA learned anything, we should be seeing some major reconstruction errors.", "Let\u2019s see how the model does with this fake data.", "That was not the initial goal here, but looks like we got a nice model to detect anomaly recipes. If we set a threshold to 0.0004, and consider anything with a reconstruction error bigger than that an anomaly, we get the following matrix:", "We reduced this data set from 6714 features to only 700.", "We can conclude now that the model did learn something from the training set. We tried to trick the PCA model and we learned that some ingredients usually come together and some don\u2019t mix. You can also use this model as an anomaly detection, where the bad recipes are anomalies (you should not eat those!). Maybe as a follow up project I can try to take advantage of this \u2018learning\u2019.", "As you can see, there is a pattern among the different cuisines. We already have a model to detect anomaly recipes that do not fall in any of those patterns, how hard would it be to generate new recipes? Would it be possible to create new french food?", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5c33a4acb7db&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@diegotole?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@diegotole?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": "Diego Toledo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F38926471846b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&user=Diego+Toledo&userId=38926471846b&source=post_page-38926471846b----5c33a4acb7db---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c33a4acb7db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c33a4acb7db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/whats-cooking/data", "anchor_text": "data set"}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "Haven\u2019t you heard of the dimensionality curse?"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5c33a4acb7db---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pca?source=post_page-----5c33a4acb7db---------------pca-----------------", "anchor_text": "Pca"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----5c33a4acb7db---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----5c33a4acb7db---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/tag/scikit?source=post_page-----5c33a4acb7db---------------scikit-----------------", "anchor_text": "Scikit"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c33a4acb7db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&user=Diego+Toledo&userId=38926471846b&source=-----5c33a4acb7db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c33a4acb7db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&user=Diego+Toledo&userId=38926471846b&source=-----5c33a4acb7db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c33a4acb7db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5c33a4acb7db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5c33a4acb7db---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5c33a4acb7db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@diegotole?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@diegotole?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Diego Toledo"}, {"url": "https://medium.com/@diegotole/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "58 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F38926471846b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&user=Diego+Toledo&userId=38926471846b&source=post_page-38926471846b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4703d08d84e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcooking-recipes-with-pca-5c33a4acb7db&newsletterV3=38926471846b&newsletterV3Id=4703d08d84e6&user=Diego+Toledo&userId=38926471846b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}