{"url": "https://towardsdatascience.com/live-streaming-crypto-prices-in-excel-aaa41628bc53", "time": 1683015737.314759, "path": "towardsdatascience.com/live-streaming-crypto-prices-in-excel-aaa41628bc53/", "webpage": {"metadata": {"title": "Real Time Crypto Prices in Excel. Learn how to get real time ticking\u2026 | by Tony Roberts | Towards Data Science", "h1": "Real Time Crypto Prices in Excel", "description": "Trading crypto currencies can be an extremely interesting and rewarding activity. Exchanges often offer websockets APIs that can be used from Python and Excel."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://www.pyxll.com/?utm_souce=medium", "anchor_text": "PyXLL", "paragraph_index": 7}, {"url": "https://pypi.org/project/websockets/", "anchor_text": "websockets", "paragraph_index": 8}, {"url": "https://gist.github.com/tonyroberts/d5e9cc4bf6f512b2d3e2fd9097c088ac", "anchor_text": "XBTUSD", "paragraph_index": 9}, {"url": "https://www.pyxll.com?utm_source=medium", "anchor_text": "https://www.pyxll.com", "paragraph_index": 15}, {"url": "https://www.pyxll.com/docs/userguide/rtd.html?utm_source=medium", "anchor_text": "PyXLL\u2019s Real Time Data feature", "paragraph_index": 16}, {"url": "https://www.pyxll.com/docs/userguide/rtd.html?utm_source=medium", "anchor_text": "here", "paragraph_index": 16}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Trading crypto currencies can be an extremely interesting and rewarding activity. There are many different platforms and exchanges for trading that will offer API access to their data which allows the savvy trader to build their own tools around their own strategy and trading needs.", "Microsoft Excel is the go to choice for many traders because of the enormous potential it offers to create custom tools and dashboards to build market insights, test and experiment with data and ideas, and to monitor portfolio performance and keep track of positions.", "More serious technically minded traders will also want to use Python for data analysis and back testing trading strategies, or even building systematic or automated trading strategies.", "Most crypto exchanges offer a way to get data from their platforms programmatically via an API. This is what we would use to connect our Excel or Python based tools to the platform to fetch data and manage orders.", "In this article we\u2019ll use a BitMEX Python API to stream real time prices into Microsoft Excel.", "To stream real time BitMEX prices into Excel you will need the following:", "To begin with we\u2019ll write the Python code to fetch real time prices in Python and test that. Once that\u2019s working we\u2019ll call that Python code from Excel using PyXLL.", "To talk to the BitMEX API over websockets we\u2019ll need to Python \u201cwebsockets\u201d package. Open a Command Prompt and use the Python package manager \u201cpip\u201d to install the websockets package by running \u201cpip install websockets\u201d.", "The following Python code creates a websocket connection to the BitMEX API, subscribes to updates to the \u201cXBTUSD\u201d instrument, and then waits for messages back and prints them as they arrive. With this code we are now streaming live prices from BitMEX using Python!", "You can run this code by saving it to a file called \u201cbitmex.py\u201d and then running \u201cpython bitmex.py\u201d from a command prompt. For developing Python code you will find it easier to use a Python IDE such as IDLE (which comes as standard when you install Python) or PyCharm.", "The code above shows how to use the websockets package to connect to the BitMex API to receive price updates in Python. Before we can use this in Excel we\u2019ll refine it slightly so that we can \u201csubscribe\u201d to individual update events.", "Below we define a class \u201cBitMex\u201d with a \u201csubscribe\u201d method. Using this we can subscribe to individual updates. The BitMex class will handle routing the messages it receives from the websockets API to the relevant callbacks for each symbol and field that has been subscribed to.", "In the \u201cmain\u201d function above we create an instance of the \u201cBitMex\u201d class and subscribe to updates to the \u201clastPrice\u201d field on the \u201cXBTUSD\u201d instrument. Whenever a new \u201clastPrice\u201d event occurs the callback is called and the new price is printed.", "Now we have this BitMex class and the ability to subscribe to specific fields and symbols we will next expose this to Excel using PyXLL. This is what will enable us to get real time streaming data from BitMEX into Excel!", "To use the code we\u2019ve written above in Python we need to install the PyXLL Excel Add-in. You can find the installation instructions for this and download the add-in from https://www.pyxll.com.", "Once you\u2019ve installed PyXLL you can add your own Python modules to it by editing the pyxll.cfg config file. We will write a new Python module that uses PyXLL\u2019s Real Time Data feature, which you can read more about here.", "We write an RTD function with PyXLL by creating a new class that derives from the \u201cpyxll.RTD\u201d class, and then write a Python function to return that. The Python function is decorated using PyXLL\u2019s \u201c@xl_func\u201d decorator to expose it as an Excel function. The RTD class has a couple of methods, \u201cconnect\u201d and \u201cdisconnect\u201d that we use to subscribe and unsubscribe from the BitMex data as needed. When we receive new values we update the \u201cvalue\u201d property of the RTD object and that causes the value that we see in Excel to update.", "This new Python module is added to our PyXLL add-in by adding it to the \u201cmodules\u201d list in the pyxll.cfg config file. The folder containing this module, as well as the bitmex.py module we wrote earlier, also needs to be on the \u201cpythonpath\u201d so that Python can import them. The pythonpath can also be set in the pyxll.cfg config file.", "When we start Excel or reload the PyXLL add-in this new module will be loaded and the \u201cbitmex_rtd\u201d function will be available to us to call from Excel. If there are any problems, check the PyXLL log file to check what\u2019s gone wrong.", "In Excel now, we can call the new \u201cbitmex_rtd\u201d function in exactly the same way as another other Excel worksheet function. Because it\u2019s a real-time data function the value will continue to update every time an update to the requested field is received via the BitMEX websockets API.", "Many crypto platforms and exchanges offer API access in a similar way to BitMEX. We can use the same techniques shown above to access those prices in Python. PyXLL provides an elegant bridge between the Python code used to call these APIs and Excel.", "We\u2019re not just limited to getting data as shown above. Most of the platform APIs will also allow us to place orders via their API too. We can use that to build and integrate bespoke trading applications written in Python, but using Excel as our interface to those tools.", "The combination of Python and Excel gives us the best of both a modern and powerful programming language and keeping Excel as a flexible, intuitive front-end for us to work in.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Professional software developer living and working in London. Creator of the Excel add-ins PyXLL and Jinx."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faaa41628bc53&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://pyxll.medium.com/?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": ""}, {"url": "https://pyxll.medium.com/?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": "Tony Roberts"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb8b1793a383&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&user=Tony+Roberts&userId=cb8b1793a383&source=post_page-cb8b1793a383----aaa41628bc53---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaa41628bc53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaa41628bc53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://www.bitmex.com/", "anchor_text": "www.bitmex.com"}, {"url": "http://www.python.org", "anchor_text": "www.python.org"}, {"url": "https://www.pyxll.com?utm_source=medium", "anchor_text": "www.pyxll.com"}, {"url": "https://www.pyxll.com/?utm_souce=medium", "anchor_text": "PyXLL"}, {"url": "https://pypi.org/project/websockets/", "anchor_text": "websockets"}, {"url": "https://gist.github.com/tonyroberts/d5e9cc4bf6f512b2d3e2fd9097c088ac", "anchor_text": "XBTUSD"}, {"url": "https://www.pyxll.com?utm_source=medium", "anchor_text": "https://www.pyxll.com"}, {"url": "https://www.pyxll.com/docs/userguide/rtd.html?utm_source=medium", "anchor_text": "PyXLL\u2019s Real Time Data feature"}, {"url": "https://www.pyxll.com/docs/userguide/rtd.html?utm_source=medium", "anchor_text": "here"}, {"url": "https://www.pyxll.com?utm_source=medium", "anchor_text": "PyXLL, the Python Excel Add-in"}, {"url": "https://www.bitmex.com/app/wsAPI", "anchor_text": "BitMEX Websocket API"}, {"url": "https://websockets.readthedocs.io/en/stable/", "anchor_text": "Python Websockets Documentation"}, {"url": "https://github.com/pyxll/pyxll-examples/tree/master/bitmex", "anchor_text": "Python Code and Spreadsheet in GitHub"}, {"url": "https://www.youtube.com/watch?v=v2ig4w9GVlo", "anchor_text": "Real time crypto prices in Excel (YouTube)"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----aaa41628bc53---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/tag/excel?source=post_page-----aaa41628bc53---------------excel-----------------", "anchor_text": "Excel"}, {"url": "https://medium.com/tag/python?source=post_page-----aaa41628bc53---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/websocket?source=post_page-----aaa41628bc53---------------websocket-----------------", "anchor_text": "Websocket"}, {"url": "https://medium.com/tag/bitmex?source=post_page-----aaa41628bc53---------------bitmex-----------------", "anchor_text": "Bitmex"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faaa41628bc53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&user=Tony+Roberts&userId=cb8b1793a383&source=-----aaa41628bc53---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faaa41628bc53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&user=Tony+Roberts&userId=cb8b1793a383&source=-----aaa41628bc53---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaa41628bc53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faaa41628bc53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----aaa41628bc53---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----aaa41628bc53--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----aaa41628bc53--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----aaa41628bc53--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----aaa41628bc53--------------------------------", "anchor_text": ""}, {"url": "https://pyxll.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://pyxll.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tony Roberts"}, {"url": "https://pyxll.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "325 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb8b1793a383&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&user=Tony+Roberts&userId=cb8b1793a383&source=post_page-cb8b1793a383--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb5c61785bea5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-streaming-crypto-prices-in-excel-aaa41628bc53&newsletterV3=cb8b1793a383&newsletterV3Id=b5c61785bea5&user=Tony+Roberts&userId=cb8b1793a383&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}