{"url": "https://towardsdatascience.com/lowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35", "time": 1683017352.154786, "path": "towardsdatascience.com/lowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35/", "webpage": {"metadata": {"title": "LOWESS Regression in Python: How to Discover Clear Patterns in Your Data? | by Saul Dobilas | Towards Data Science", "h1": "LOWESS Regression in Python: How to Discover Clear Patterns in Your Data?", "description": "A detailed guide to using Locally Weighted Scatterplot Smoothing (LOWESS) algorithm in Python"}, "outgoing_paragraph_urls": [{"url": "https://solclover.com/subscribe", "anchor_text": "subscribe", "paragraph_index": 4}, {"url": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "anchor_text": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "paragraph_index": 22}, {"url": "https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html", "anchor_text": "scipy", "paragraph_index": 32}, {"url": "https://bit.ly/SaulD", "anchor_text": "https://bit.ly/SaulD", "paragraph_index": 40}, {"url": "https://bit.ly/SolClover", "anchor_text": "https://bit.ly/SolClover", "paragraph_index": 40}], "all_paragraphs": ["Machine Learning is making huge leaps forward, with an increasing number of algorithms enabling us to solve complex real-world problems.", "This story is part of a deep dive series explaining the mechanics of Machine Learning algorithms. In addition to giving you an understanding of how ML algorithms work, it also provides you with Python examples to build your own ML models.", "Locally Weighted Scatterplot Smoothing sits within the family of regression algorithms under the umbrella of Supervised Learning. This means that you need a set of labeled data with a numerical target variable to train your model.", "The below graph is interactive, so make sure to click on different categories to enlarge and reveal more\ud83d\udc47.", "If you enjoy Data Science and Machine Learning, please subscribe to get an email whenever I publish a new story.", "Since LOWESS is a non-parametric fitting technique, you do not need to assume that data follows any specific distribution. However, at the same time, non-parametric fitting means that at the end, you will not have a global equation for you to use to predict the values of new data points. Not to worry, though, as I provide a workaround to this issue in the Python section later in this story.", "Given the above advantages and disadvantages, LOWESS is often used to perform the following analysis:", "While writing this story, I have assumed that you are already familiar with the ordinary least squares (OLS) regression. Hence, in this section, I only intend to provide an intuitive explanation of how LOWESS splits up the data to perform linear regression on local sections of the data.", "If you would like a refresher on OLS regression, feel free to take a look at my linear regression story:", "Said that one important addition to LOWESS over OLS is that it applies weightings as you might have guessed from the algorithm\u2019s name \u2014 Locally Weighted Scatterplot Smoothing.", "Typically, the algorithm uses a tri-cube weight function (see below), although other functions can also be used.", "The weight function gives the most weight to the data points nearest to the point of estimation and the least weight to the data points that are furthest away. It is based on the idea that points near each other in the explanatory variable space are more likely to be related to each other in a simple way than points that are further apart.", "We will use an example to illustrate how LOWESS works. Let us start by creating a scatterplot where the data points follow a sine wave pattern, but they have some random noise added, making the pattern less obvious.", "After that, we perform a LOWESS regression analysis a couple of times using different hyperparameters and add LOWESS curves to the plot:", "As you can see, there is a lot of noise in the data, with the relationship between x and y being non-linear (periodic, in fact). Clearly, simple linear regression would not give us a meaningful result here since it can only produce a straight line (unlike LOWESS or polynomial regression).", "The first thing that LOWESS does is selects a subset of the data. We can control the size of the subsets by specifying the \u2018fraction\u2019 hyperparameter. The two lines that we plotted above have hyperparameter values of 2/3 and 1/5.", "Let\u2019s take the orange line as an example, with a default hyperparameter value of 2/3. This means that the LOWESS algorithm takes a subset of two-thirds of the entire data and performs a weighted linear least squares regression over the span of that data while moving by one point at a time and repeating the same process until it has gone through every single point.", "Starting from the very left and going right one point at a time, we can see how the orange line remains straight until x=-2.1. This is because the entire data ranges from -2\u03c0 to +2\u03c0 (-6.28 to +6.28) with an initial two-thirds window ranging from -6.28 to +2.1. Hence, only when the algorithm goes beyond -2.1 (midpoint between -6.28 and +2.1), it starts encountering new data points within its window, changing the curve's slope.", "If we now look at the red line (frac=1/5), we can see how narrowing the window to one-fifth of the data makes the algorithm more sensitive towards local trends. The featured gif image at the beginning of this story illustrates how this red line (frac=1/5) moves across the data performing weighted linear regression. This is the same process as described for the orange line (frac=2/3) except, the window the algorithm sees is narrower.", "While in this example, making the window smaller helped us get a better approximation of the sine wave, it is not always desirable to make a \u2018fraction\u2019 hyperparameter smaller. This largely depends on the data you are analyzing, as making a window smaller runs a risk of overfitting. You will see this in my next example, where 2/3 works much better than 1/5.", "Now that you have a general understating of how the algorithm works, it is time to have some fun and build a model in Python", "Let us start by importing the required libraries.", "Next, we download and ingest the data that we will use to build our LOWESS and linear regression models.(source: https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv)", "We will take \u2018X3 distance to the nearest MRT station\u2019 as our input (independent) variable and \u2018Y house price of unit area\u2019 as our output (dependent) variable and create a scatterplot to visualize the data.", "We can clearly see the relationship between x and y with the house price (per unit area) decreasing as the distance from the nearest MRT station increases.", "Since the relationship is somewhat linear, the question is whether LOWESS can give us a better approximation than simple linear regression. Let us find out by fitting the two models.", "With fitting done, let us draw simple linear regression and LOWESS lines on the graph.", "Visually we can see that LOWESS can fit the data better. This is because the price drop is steeper initially, which then starts to flatten out as the distance from the nearest MRT goes beyond 1000.", "Simple linear regression has only one slope parameter meaning that it has the same steepness of the curve throughout. Meanwhile, LOWESS can adjust the curve's steepness at various points, producing a better fit than that of simple linear regression.", "Let us now zoom in on the graph to see the difference between the two LOWESS models.", "We can clearly see that setting the fraction hyperparameter to 1/5 makes LOWESS a bit too sensitive to the local data fluctuations, giving us a model that is overfitting. This is the opposite of the sine wave example, emphasizing that we need to be careful with hyperparameters and ensure that we choose the best values for the given data.", "Unfortunately, the lowess algorithm from statsmodels does not provide us with a predict() method. Hence, we cannot use the model that we have built to give us y values for the new set of x values (i.e., data points that were not in the original data).", "Fortunately, we have a solution for that. We can use the interpolation method from the scipy library.", "First, we create a function using the interp1d method by passing x and y values from the LOWESS output. Then, we use that newly created function to take new x values and generate y values for them.", "Note, in the below code, we used a couple of different options for interpolation. Differences are explained in the code comments. One of them is drawing a line between the two nearest points and calculating a new y value for a given x value, and the other one simply taking the y value from the nearest available point.", "At the same time, we have set fill_value to \u2018extrapolate,\u2019 which means that if you pass an x value outside of the original range (like 6400 in the example below), you will still get a result based on the extrapolated line. Without it, the algorithm would return \u2018NaN.\u2019 However, be careful with extrapolation as you may not always get good results for values far outside the original data range.", "LOWESS is not something that you may want to use in all of your regression models as it follows a non-parametric approach and is quite computationally intensive. However, it is a good way to model a relationship between two variables that do not fit a predefined distribution and have a non-linear relationship.", "I hope you enjoyed this story and can use the code and explanations for your own data science projects. If you have any feedback or questions, feel free to reach out.", "If you have already spent your learning budget for this month, please remember me next time. My personalized link to join Medium is:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Demystifying Data Science and Machine Learning | Let\u2019s connect on LinkedIn \ud83e\udd1d https://bit.ly/SaulD | Join me on Medium \ud83e\udd13 https://bit.ly/SolClover"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff26e523d7a35&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@solclover", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://solclover.com/?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": ""}, {"url": "https://solclover.com/?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": "Saul Dobilas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff77accd417be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&user=Saul+Dobilas&userId=f77accd417be&source=post_page-f77accd417be----f26e523d7a35---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff26e523d7a35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff26e523d7a35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.com/", "anchor_text": "author"}, {"url": "https://solclover.com/subscribe", "anchor_text": "subscribe"}, {"url": "https://towardsdatascience.com/linear-regression-made-easy-how-does-it-work-and-how-to-use-it-in-python-be0799d2f159", "anchor_text": "Linear regression made easy. How does it work and how to use it in Python?All you need to know about building a Machine Learning model using the linear regression algorithm.towardsdatascience.com"}, {"url": "https://solclover.medium.com/", "anchor_text": "author."}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.com/membership", "anchor_text": ""}, {"url": "https://www.linkedin.com/in/saulius-dobilas/", "anchor_text": ""}, {"url": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "anchor_text": "House price data from Kaggle"}, {"url": "https://www.statsmodels.org/dev/generated/statsmodels.nonparametric.smoothers_lowess.lowess.html", "anchor_text": "statsmodels"}, {"url": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "anchor_text": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv"}, {"url": "https://www.kaggle.com/quantbruce/real-estate-price-prediction?select=Real+estate.csv", "anchor_text": "Kaggle"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://solclover.medium.com/", "anchor_text": "author"}, {"url": "https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html", "anchor_text": "scipy"}, {"url": "https://solclover.com/membership", "anchor_text": "Join Medium with my referral link - Saul DobilasAs a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026solclover.com"}, {"url": "https://towardsdatascience.com/mars-multivariate-adaptive-regression-splines-how-to-improve-on-linear-regression-e1e7a63c5eae", "anchor_text": "MARS: Multivariate Adaptive Regression Splines \u2014 How to Improve on Linear Regression?A visual explanation of the MARS algorithm with Python examples and comparison to linear regressiontowardsdatascience.com"}, {"url": "https://towardsdatascience.com/support-vector-regression-svr-one-of-the-most-flexible-yet-robust-prediction-algorithms-4d25fbdaca60", "anchor_text": "Support Vector Regression (SVR) \u2014 One of the Most Flexible Yet Robust Prediction AlgorithmsA visual explanation of SVR with Python implementation examplestowardsdatascience.com"}, {"url": "https://medium.com/tag/regression?source=post_page-----f26e523d7a35---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f26e523d7a35---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/smoothing-algorithm?source=post_page-----f26e523d7a35---------------smoothing_algorithm-----------------", "anchor_text": "Smoothing Algorithm"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f26e523d7a35---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----f26e523d7a35---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff26e523d7a35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&user=Saul+Dobilas&userId=f77accd417be&source=-----f26e523d7a35---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff26e523d7a35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&user=Saul+Dobilas&userId=f77accd417be&source=-----f26e523d7a35---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff26e523d7a35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff26e523d7a35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f26e523d7a35---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f26e523d7a35--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f26e523d7a35--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f26e523d7a35--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f26e523d7a35--------------------------------", "anchor_text": ""}, {"url": "https://solclover.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://solclover.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saul Dobilas"}, {"url": "https://solclover.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://bit.ly/SaulD", "anchor_text": "https://bit.ly/SaulD"}, {"url": "https://bit.ly/SolClover", "anchor_text": "https://bit.ly/SolClover"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff77accd417be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&user=Saul+Dobilas&userId=f77accd417be&source=post_page-f77accd417be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F35094ab887f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flowess-regression-in-python-how-to-discover-clear-patterns-in-your-data-f26e523d7a35&newsletterV3=f77accd417be&newsletterV3Id=35094ab887f3&user=Saul+Dobilas&userId=f77accd417be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}