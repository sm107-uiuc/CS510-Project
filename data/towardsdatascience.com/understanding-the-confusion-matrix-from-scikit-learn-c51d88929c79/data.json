{"url": "https://towardsdatascience.com/understanding-the-confusion-matrix-from-scikit-learn-c51d88929c79", "time": 1683018355.010422, "path": "towardsdatascience.com/understanding-the-confusion-matrix-from-scikit-learn-c51d88929c79/", "webpage": {"metadata": {"title": "Understanding Confusion Matrix sklearn (scikit learn), Machine Learning | Clear explanation | Towards Data Science", "h1": "Understanding the Confusion Matrix from Scikit learn", "description": "Clear representation of Actual labels and Predicted labels to understand True Positive, False Positive, True Negative, and False Negative from the output of confusion matrix from sklearn (Scikit learn) in python"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "confusion matrix representation", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html#sklearn.metrics.confusion_matrix", "anchor_text": "Scikit learn documentation says", "paragraph_index": 7}], "all_paragraphs": ["In one of my recent projects \u2014 a transaction monitoring system generates a lot of False Positive alerts (these alerts are then manually investigated by the investigation team). We were required to use machine learning to auto close those false alerts. Evaluation criteria for the machine learning model was a metric Negative Predicted Value that means out of total negative predictions by the model how many cases it has identified correctly.", "NPV = True Negative / (True Negative + False Negative)", "The cost of false-negative is extremely high because these are the cases where our model is saying they are not-fraudulent but in reality, they are fraudulent transactions.", "To get into action I would quickly display the confusion_matrix and below is the output from the jupyter notebook. My binary classification model is built with target = 1 (for fraud transactions) so target= 0 (for non fraud).", "Depending upon how you interpret the confusion matrix, you can either get an NPV of 90% or 76%. Because \u2014", "I referred to confusion matrix representation from Wikipedia.", "This image from Wikipedia shows that predicted labels are on the horizontal levels and actual labels are on the verticals levels. This implies,", "Scikit learn documentation says \u2014 Wikipedia and other references may use a different convention for axes.", "Oh Wait! documentation doesn\u2019t mention anything clear, isn\u2019t it? They say Wikipedia and other references may use a different convention for axes.", "What do you mean by \u201cmay use a different convention for axes\u201d? We have seen that if you use the wrong convention for axes your model evaluation metric may completely go off the track.", "If you read through the documentation and towards the bottom you will find this example", "Here, they have flattened the matrix output. On our example this implies that,", "Clearly understanding the structure of the confusion matrix is of utmost importance. Even though you can directly use the formula for most of the standard metrics like accuracy, precision, recall, etc. Many times you are required to compute the metrics like negative predictive value, false-positive rate, false-negative rate which are not available in the package out of the box.", "Now, if I ask you to pick the correct option for the confusion matrix that is the output of confusion_matrix. Which one would you pick?", "Would your answer be \u201cA\u201d because that\u2019s what Wikipedia says or would it be \u201cC\u201d because sklearn documentation says so?", "Consider these are your y_true and y_pred values.", "By looking at the given lists, we can calculate the following:", "For your classic Machine Learning Model for binary classification, mostly you would run the following code to get the confusion matrix.", "If we fill it back to the confusion matrix, we get the confusion matrix as below", "However, if you were to add a simple parameter \u201clabels\u201d.", "The correct representation of the default output of the confusion matrix from sklearn is below. Actual labels on the horizontal axes and Predicted labels on the vertical axes.", "2. By adding the labels parameter, you can get the following output", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "15 years in Data Science. I'm sharing valuable tips, ideas, and code snippets on Machine Learning & Deep Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc51d88929c79&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c51d88929c79--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c51d88929c79--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://samarthagrawal86.medium.com/?source=post_page-----c51d88929c79--------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=post_page-----c51d88929c79--------------------------------", "anchor_text": "Samarth Agrawal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c9c1e60de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&user=Samarth+Agrawal&userId=2c9c1e60de25&source=post_page-2c9c1e60de25----c51d88929c79---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc51d88929c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc51d88929c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "confusion matrix representation"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html#sklearn.metrics.confusion_matrix", "anchor_text": "Scikit learn documentation says"}, {"url": "https://samarthagrawal86.medium.com", "anchor_text": "follow me on medium"}, {"url": "https://www.linkedin.com/in/samarth-agrawal-2501/", "anchor_text": "Linkedin"}, {"url": "https://github.com/samarth-agrawal-86/data_scientist_toolkit", "anchor_text": "Github link"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c51d88929c79---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c51d88929c79---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-scientist?source=post_page-----c51d88929c79---------------data_scientist-----------------", "anchor_text": "Data Scientist"}, {"url": "https://medium.com/tag/analytics?source=post_page-----c51d88929c79---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/python?source=post_page-----c51d88929c79---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc51d88929c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&user=Samarth+Agrawal&userId=2c9c1e60de25&source=-----c51d88929c79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc51d88929c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&user=Samarth+Agrawal&userId=2c9c1e60de25&source=-----c51d88929c79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc51d88929c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c51d88929c79--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc51d88929c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c51d88929c79---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c51d88929c79--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c51d88929c79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c51d88929c79--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c51d88929c79--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c51d88929c79--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c51d88929c79--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c51d88929c79--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c51d88929c79--------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samarth Agrawal"}, {"url": "https://samarthagrawal86.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "491 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c9c1e60de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&user=Samarth+Agrawal&userId=2c9c1e60de25&source=post_page-2c9c1e60de25--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd946063b0300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-from-scikit-learn-c51d88929c79&newsletterV3=2c9c1e60de25&newsletterV3Id=d946063b0300&user=Samarth+Agrawal&userId=2c9c1e60de25&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}