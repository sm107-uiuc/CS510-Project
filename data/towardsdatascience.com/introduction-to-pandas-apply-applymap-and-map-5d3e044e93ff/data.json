{"url": "https://towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff", "time": 1683007087.2365172, "path": "towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff/", "webpage": {"metadata": {"title": "Introduction to Pandas apply, applymap and map | by B. Chen | Towards Data Science", "h1": "Introduction to Pandas apply, applymap and map", "description": "In Data Processing, it is often necessary to perform operations (such as statistical calculations, splitting, or substituting value) on a certain row or column to obtain new data. Writing a for-loop\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github", "paragraph_index": 29}], "all_paragraphs": ["In Data Processing, it is often necessary to perform operations (such as statistical calculations, splitting, or substituting value) on a certain row or column to obtain new data. Writing a for-loop to iterate through Pandas DataFrame and Series will do the job, but that doesn\u2019t seem like a good idea. The for-loop tends to have more lines of code, less code readability, and slower performance.", "Fortunately, there are already great methods that are built into Pandas to help you accomplish the goals! In this article, we will see how to perform operations using apply() and applymap(), and how to substitute value using map().", "First of all, you should be aware that DataFrame and Series will have some or all of these three methods, as follows:", "And the Pandas official API reference suggests that:", "Before we diving into the details, let\u2019s first create a DataFrame for demonstration.", "The Pandas apply() is used to apply a function along an axis of the DataFrame or on values of Series.", "Let\u2019s begin with a simple example, to sum each row and save the result to a new column \u201cD\u201d", "Do you really understand what just happened?", "Let me explain this process in a more intuitive way. The second parameter axis = 1 tells Pandas to use the row. So, the custom_sum is applied to each row and returns a new Series with the output of each row as value.", "With the understanding of the sum of each row, the sum of each column is just to use axis = 0 instead", "So far, we have been talking about apply() on a DataFrame. Similarly, apply() can be used on the values of Series. For example, multiply the column \u201cC\u201d by 2 and save the result to a new column \u201cD\u201d", "Notice that df[\u2018C\u2019] is used to select the column \u201cC\u201d and then call apply() with the only parameter multiply_by_2. We don\u2019t need to specify axis anymore because Series is a one-dimensional array. The return value is a Series and get assigned to the new column D by df[\u2018D\u2019].", "You can also use lambda expression with Pandas apply() function.", "The lambda equivalent for the sum of each row of a DataFrame:", "The lambda equivalent for the sum of each column of a DataFrame:", "And the lambda equivalent for multiply by 2 on a Series:", "result_type is a parameter in apply() set to 'expand', 'reduce', or 'broadcast' to get the desired type of result.", "In the above scenario if result_type is set to 'broadcast' then the output will be a DataFrame substituted by the custom_sum value.", "The result is broadcasted to the original shape of the frame, the original index and columns are retained.", "To understand result_type as 'expand' and 'reduce', we will first create a function that returns a list.", "Now apply this function across the DataFrame column with result_type as 'expand'", "The output is a new DataFrame with column names 0 and 1.", "In order to append this to the existing DataFrame, the result has to be kept in a variable so the column names can be accessed by res.columns.", "Next, apply the function across the DataFrame column with result_type as 'reduce' . result_type='reduce' is just opposite of 'expand' and returns a Series if possible rather than expanding list-like results.", "applymap() is only available in DataFrame and used for element-wise operation across the whole DataFrame. It has been optimized and some cases work much faster than apply() , but it\u2019s good to compare it with apply() before going for any heavier operation.", "For example: to output a DataFrame with number squared", "map() is only available in Series and used for substituting each value in a Series with another value. To understand how the map() works, we first create a Series.", "map() accepts a dict or a Series. Values that are not found in the dict are converted to NaN, unless the dict has a default value (e.g. defaultdict):", "To avoid applying the function to missing values (and keep them as NaN) na_action='ignore' can be used:", "More can be found from my Github", "That\u2019s about it. Thanks for reading.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5d3e044e93ff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----5d3e044e93ff---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d3e044e93ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d3e044e93ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html", "anchor_text": "apply()"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.applymap.html", "anchor_text": "applymap()"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.map.html?highlight=map#pandas.Series.map", "anchor_text": "map()"}, {"url": "https://towardsdatascience.com/pandas-concat-tricks-you-should-know-to-speed-up-your-data-analysis-cd3d4fdfe6dd", "anchor_text": "Pandas concat() tricks you should know"}, {"url": "https://towardsdatascience.com/how-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320", "anchor_text": "How to do a Custom Sort on Pandas DataFrame"}, {"url": "https://towardsdatascience.com/when-to-use-pandas-transform-function-df8861aa0dcf", "anchor_text": "When to use Pandas transform() function"}, {"url": "https://medium.com/@bindiatwork/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac", "anchor_text": "Using Pandas method chaining to improve code readability"}, {"url": "https://towardsdatascience.com/working-with-datetime-in-pandas-dataframe-663f7af6c587", "anchor_text": "Working with datetime in Pandas DataFrame"}, {"url": "https://towardsdatascience.com/working-with-missing-values-in-pandas-5da45d16e74", "anchor_text": "Working with missing values in Pandas"}, {"url": "https://medium.com/@bindiatwork/all-the-pandas-read-csv-you-should-know-to-speed-up-your-data-analysis-1e16fe1039f3", "anchor_text": "Pandas read_csv() tricks you should know"}, {"url": "https://towardsdatascience.com/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e", "anchor_text": "4 tricks you should know to parse date columns with Pandas read_csv()"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github"}, {"url": "https://medium.com/tag/pandas?source=post_page-----5d3e044e93ff---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----5d3e044e93ff---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/python?source=post_page-----5d3e044e93ff---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/python-programming?source=post_page-----5d3e044e93ff---------------python_programming-----------------", "anchor_text": "Python Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5d3e044e93ff---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d3e044e93ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&user=B.+Chen&userId=563d09da62a&source=-----5d3e044e93ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d3e044e93ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&user=B.+Chen&userId=563d09da62a&source=-----5d3e044e93ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d3e044e93ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5d3e044e93ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5d3e044e93ff---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5d3e044e93ff--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-pandas-apply-applymap-and-map-5d3e044e93ff&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}