{"url": "https://towardsdatascience.com/cracking-blackjack-part-1-31da28aeb4bb", "time": 1683010927.68297, "path": "towardsdatascience.com/cracking-blackjack-part-1-31da28aeb4bb/", "webpage": {"metadata": {"title": "Cracking Blackjack \u2014 Part 1. Setup + Simple Monte Carlo Simulations | by adithyasolai | Towards Data Science", "h1": "Cracking Blackjack \u2014 Part 1", "description": "I am writing this \u201cCracking Blackjack\u201d blog series as a way of consolidating the knowledge I have gained in the Reinforcement Learning space. I needed to combine the info of 30+ articles and blog\u2026"}, "outgoing_paragraph_urls": [{"url": "https://bicyclecards.com/how-to-play/blackjack/", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_1/Monte%20Carlo%20Blackjack%20Part%201.ipynb", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "Wikipedia", "paragraph_index": 12}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack", "anchor_text": "here", "paragraph_index": 35}], "all_paragraphs": ["I am writing this \u201cCracking Blackjack\u201d blog series as a way of consolidating the knowledge I have gained in the Reinforcement Learning space. I needed to combine the info of 30+ articles and blog posts when I was creating this Blackjack project, and I want to make it easier for the next person.", "I am by no means an expert on this stuff. Please feel free to reach out if you have any questions or concerns about the information I am about to present! My contact info is at the bottom.", "Blackjack is a card game played against a dealer. At the start of a round, both player and dealer are dealt 2 cards. The player can only see one of the dealer\u2019s cards. The goal of the game is to get the value of our cards as close to 21 as possible, without crossing 21. The value of each card is listed below.", "If the player has less than 21, they can choose to \u201chit\u201d and receive a random card from the deck. They can also choose to \u201cstand\u201d and keep the cards they have. If the player exceeds 21, they \u201cbust\u201d and automatically lose the round. If the player has exactly 21, they automatically win. Otherwise, the player wins if they are closer to 21 than the dealer.", "There are more granular rules to Blackjack, read them here.", "The purpose of this post is to show the dazzling power of even simple simulations in modeling the world around us. For any Reinforcement Learning endeavor, it is best to learn through simple games like Blackjack because they have only a few uncertainties to keep track of, clear reward and punishment rules, and a straightforward goal to aim for.", "Casino games like Blackjack are designed to statistically favor the \u201chouse,\u201d and I am interested in seeing if I can \u201ccrack\u201d that through Reinforcement Learning algorithms. For Blackjack, my goal is to derive a player policy that actually yields an advantage over the casino/dealer in the long run.", "A policy, in this context, is a playbook that tells the player (or our AI agent) exactly what decision to make in each possible situation. An AI agent is the abstract being that will be learning and updating its knowledge through our Reinforcement Learning algorithm.", "In our simplified model of Blackjack, we will only give the player two options: hit or stand. We will start our player with $1000, and assume they bet $100 each round. Here are the rewards/punishments for win/lose/tie:", "I suggest going through the code below at your own pace after reading this post. Skim through the code for now just to get some ideas about how to build a simulation environment that best suits your needs. Check out the full notebook here.", "The focus of the rest of this article will be playing with the player policy input to this simulation environment to see what insights we can gain.", "The crux of any Monte Carlo approach:", "\u201cUsing randomness to solve problems that might be deterministic in principle.\u201d \u2014 Wikipedia", "More simply, we will rely on the compute power of machines to approximate certain conclusions instead of precisely deriving those results through pencil and paper.", "For example, let\u2019s use a Monte Carlo approach to answer this simple question:", "\u201cIf I roll two 6-sided dice, what sum of the two dice is most likely?\u201d", "As taught in every statistics class, we can solve this using pencil and paper by creating a probability distribution of the possible sums, and seeing which has the largest probability of occurring.", "However, if we are too lazy to write that all out, we can code up a Monte Carlo simulation instead!", "In the code below, I roll two dice 100,000 times and plot the distribution of the sums I get from the 100,000 simulations.", "Voila! We clearly see from the distribution chart that 7 is the most likely sum when rolling 2 dice. The magic of compute power!", "The dice example above is a bit contrived \u2014 Monte Carlo methods are best used for problems that would require humans large amounts of time to try and solve by hand.", "Here is a more appropriate question for Monte Carlo simulations:", "\u201cIn Blackjack, what is the expected return per round if we stand when our hand \u2265 18, and hit otherwise?\u201d", "A query such as this would be too overwhelming for a human to solve.", "To answer this question, we will define our player policy as follows:", "Next, we will leverage compute power and the randomized nature of our Blackjack environment to run 100,000 rounds and calculate expected return:", "The results show that, on average, a player would lose $10 every round if they decided to use the Discrete Policy. We need to find a policy that yields better returns!", "The Discrete Policy is considered \u201cdiscrete\u201d because as soon as a condition is met (hand \u2265 18, for example), there is only one possible action that our player will take.", "When we design our Reinforcement Learning AI agent, however, we will want it to have the chance to explore other actions even if some criteria tells it to do something else. It is important for our AI agent to keep exploring in the early stages of the learning process because its policy for picking actions has been determined by too small of a sample size.", "Therefore, we need to get used to stochastic variables and policies that allow room for randomness when picking an action. Here is one we can try:", "The results show that, on average, a player would lose $18 every round if they decided to use the Stochastic Policy, which is $8 more than the Discrete Policy! Despite all the emphasis I put on the importance of stochastic policies in Reinforcement Learning, the Discrete Policy still won!", "Using our human intuition, we can understand why this happened. It is always better in the long run to keep hitting when hand < 18 and keep standing when hand \u2265 18. It is detrimental in the long run to add a 20% chance of doing a counter-intuitive action in either of these states.", "However, our AI agent will not be born with this intuition. Stochastic policies are fluid, and can be tweaked on the fly. This approach allows our AI agent to suffer through countless rounds of hitting when hand \u226518, and incrementally tweak its policy until it stands 100% of the time when hand \u2265 18.", "The upcoming installments of this series will strive to answer these questions:", "In my next post, we will be diving much deeper into fundamental Reinforcement Learning theory. Also, we will reconstruct our Blackjack environment within the standardized framework of OpenAI Gym. This will enable us to easily explore algorithms and tweak crucial factors.", "If you would like to look ahead, my entire Blackjack project can be found here.", "I would really appreciate feedback of any kind! I want to become a more consistent, effective content creator.", "Did you learn something? Was I hard to follow?", "Feel free to leave a comment below or email me at adithyasolai7@gmail.com!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Development Engineer I @ AWS"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F31da28aeb4bb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://adithyasolai.medium.com/?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": ""}, {"url": "https://adithyasolai.medium.com/?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": "adithyasolai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1677da1d199&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&user=adithyasolai&userId=1677da1d199&source=post_page-1677da1d199----31da28aeb4bb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31da28aeb4bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31da28aeb4bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/Cracking-Blackjack", "anchor_text": "Cracking Blackjack"}, {"url": "https://unsplash.com/photos/P787-xixGio", "anchor_text": "Unsplash"}, {"url": "https://bicyclecards.com/how-to-play/blackjack/", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_1/Monte%20Carlo%20Blackjack%20Part%201.ipynb", "anchor_text": "here"}, {"url": "https://bicyclecards.com/how-to-play/blackjack/", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "Wikipedia"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/tree/master/Monte%20Carlo%20on%20Dice%20Game", "anchor_text": "Image by Author"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_1/Monte%20Carlo%20Blackjack%20Part%201%20-%20Discrete%20Policy.ipynb", "anchor_text": "Image by Author"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_1/Monte%20Carlo%20Blackjack%20Part%201%20-%20Discrete%20Policy.ipynb", "anchor_text": "Image by Author"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_1/Monte%20Carlo%20Blackjack%20Part%201%20-%20Stochastic%20Policy.ipynb", "anchor_text": "Image by Author"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack", "anchor_text": "GitHub Repo for this project."}, {"url": "https://towardsdatascience.com/cracking-blackjack-part-2-75e32363e38?source=friends_link&sk=41bdbc0e16dddd80c172c7ddb039eb42", "anchor_text": "Part 2 here."}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----31da28aeb4bb---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/monte-carlo-method?source=post_page-----31da28aeb4bb---------------monte_carlo_method-----------------", "anchor_text": "Monte Carlo Method"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----31da28aeb4bb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----31da28aeb4bb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/cracking-blackjack?source=post_page-----31da28aeb4bb---------------cracking_blackjack-----------------", "anchor_text": "Cracking Blackjack"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F31da28aeb4bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&user=adithyasolai&userId=1677da1d199&source=-----31da28aeb4bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F31da28aeb4bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&user=adithyasolai&userId=1677da1d199&source=-----31da28aeb4bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31da28aeb4bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F31da28aeb4bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----31da28aeb4bb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----31da28aeb4bb--------------------------------", "anchor_text": ""}, {"url": "https://adithyasolai.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://adithyasolai.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "adithyasolai"}, {"url": "https://adithyasolai.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "42 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1677da1d199&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&user=adithyasolai&userId=1677da1d199&source=post_page-1677da1d199--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb229f7eeb2b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-1-31da28aeb4bb&newsletterV3=1677da1d199&newsletterV3Id=b229f7eeb2b7&user=adithyasolai&userId=1677da1d199&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}