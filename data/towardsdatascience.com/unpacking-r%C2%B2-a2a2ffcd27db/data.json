{"url": "https://towardsdatascience.com/unpacking-r%C2%B2-a2a2ffcd27db", "time": 1682999764.489194, "path": "towardsdatascience.com/unpacking-r%C2%B2-a2a2ffcd27db/", "webpage": {"metadata": {"title": "Unpacking R\u00b2. R\u00b2 is a popular statistic for\u2026 | by Maks Pazuniak | Towards Data Science", "h1": "Unpacking R\u00b2", "description": "Data science is an iterative process, which is especially true for new practitioners. We can spend weeks on a project, only to later discover a fundamental flaw in the analysis. This post explores a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/maks-p/restaurant_sales_forecasting", "anchor_text": "capstone project", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "Root Mean Square Error", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Mean_absolute_error", "anchor_text": "Mean Absolute Error", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Residual_sum_of_squares", "anchor_text": "Residual Sum of Squares", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Total_sum_of_squares", "anchor_text": "Total Sum of Squares", "paragraph_index": 13}, {"url": "http://www.stat.cmu.edu/~cshalizi/mreg/15/lectures/10/lecture-10.pdf", "anchor_text": "lecture notes", "paragraph_index": 18}], "all_paragraphs": ["Data science is an iterative process, which is especially true for new practitioners. We can spend weeks on a project, only to later discover a fundamental flaw in the analysis. This post explores a basic mistake I made on a project, and working through how it happened and why it matters.", "My capstone project was a predictive analytics tool that utilized historical sales data and weather data to forecast nightly and weekly sales for an award-winning restaurant in Brooklyn. Historical sales data were pulled directly from the restaurant\u2019s point of sale system (two separate systems that had to be aggregated, actually), and while the project was fairly straightforward, certain elements did present challenges. Holidays, closed days, outside seating that was only open on a seasonal basis and was subject to unexpected closures, room rental fees, inaccurate guest count data, and special events all had to be understood and handled appropriately.", "One decision that I had to make was how to deal with holidays / closed days, when sales were $0. I considered two options: (1) Include an encoded boolean \u201cClosed\u201d feature, or (2) Drop closed days entirely from the dataset (a 3rd option would have been to treat the days as outliers \u2014 more on this later). While I was experimenting with the two options, I noticed that regardless of which regression model I used, the R\u00b2 value varied significantly depending on how I treated the closed days.", "I ended up using the boolean \u201cClosed\u201d feature as it resulted in a higher R\u00b2 value, but that decision has never really sat well with me. The purpose of this post will be to revisit that decision and understand why my original decision was the incorrect one.", "To provide some context, the following graph shows nightly average sales in the restaurant\u2019s dining room, bar, and private dining room areas, excluding the outside area.", "The restaurant averaged indoor sales of $14,575, with a standard deviation of $1,832 over the period January 2017 through June 2019 (this is a particularly successful restaurant, I should note).", "The following table shows how three different evaluation metrics differed between the two options for handling closed days \u2014 in addition to R\u00b2, Root Mean Square Error (RMSE) and Mean Absolute Error (MAE):", "So, while RMSE & MAE stayed fairly consistent, R\u00b2 dropped significantly when I dropped the observations with closed days. Why is this? Time to unpack R\u00b2 and better understand what\u2019s happening.", "Before we move on, it\u2019s instructive to look at the residuals under both scenarios \u2014 this will provide some intuition into what is happening here:", "Residuals with an Encoded, Boolean Closed Feature:", "Residuals when Closed Days are Dropped:", "R\u00b2 represents the proportion of the total variation in a dependent variable (the target variable, in this case, sales) that is explained by the variation in the independent variables (our feature variables, such as day-of-week, month, sales trend, and temperature).", "One of the simplest expressions for R\u00b2 in a modeling context is the following:", "The Residual Sum of Squares is the summation of the squared errors \u2014 the differences between an actual data point and the data point predicted by an estimation model. The Total Sum of Squares represents the sum of the deviation of each target observation from the mean of all target observations.", "The code to calculate R\u00b2 looks like the following (y_hat is the predicted target variable \u2014 this particular code block calculates the test set\u2019s R\u00b2):", "We\u2019re beginning to see why including the closed days was a mistake, but let\u2019s take the next step in the calculation to really understand it:", "Look at the difference in the denominator! The RSS is actually lower when the closed days are dropped, which should indicate a higher R\u00b2, but the denominator (TSS) is significantly lower, leading to a higher RSS / TSS ratio (and thus lower R\u00b2).", "Since I included the data points from closed days and specifically excluded them from my outlier adjustment, for each of the 12 closed data points in the dataset the R\u00b2 formula is subtracting $0 from $14,575 (the mean for the entire dataset \u2014 in practice the train R\u00b2 is using the training mean and the test R\u00b2 is using the test mean), and then squaring the result ($14,575\u00b2 is $212,430,625!). This an entirely artificially constructed variance that is unnecessary to include, but does have the side benefit of boosting my R\u00b2 value. A closed day does not represent natural variance \u2014 we know why sales are $0 on those days and can actually predict $0 sales for them with 100% accuracy. They should have been dropped.", "My first mistake was improperly treating closed days \u2014 it would have made more sense to drop them from the dataset. And as I dug into R\u00b2, I also realized that Root Mean Squared Error or Mean Absolute Error would have been better model evaluation metrics for this particular application (and by the time you read this, my project will reflect as much). If you really want to dive into why R\u00b2 is a flawed metric for a lot of reasons please see these lecture notes from Cosma Shalizi at Carnegie Mellon.", "This exercise also further illustrates the importance of properly handling outliers \u2014 a lot of the statistical assumptions that machine learning is built on simply don\u2019t work if you aren\u2019t properly account for them. These closed days were effectively outliers \u2014 engineering a feature for them was the wrong approach.", "Lastly, and most importantly and obviously, this is why understanding statistics and the underlying math is so important for Data Science. This was a simple mistake on my part, and theoretically a forgivable one given that I\u2019m just starting out in the field, but also highly instructive. Nobody is an expert overnight, and when something doesn\u2019t look right, you can learn a lot from digging into why, and not just assuming that your model knows best.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa2a2ffcd27db&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maks_p?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maks_p?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": "Maks Pazuniak"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffad42e2d78db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&user=Maks+Pazuniak&userId=fad42e2d78db&source=post_page-fad42e2d78db----a2a2ffcd27db---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa2a2ffcd27db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa2a2ffcd27db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/maks-p/restaurant_sales_forecasting", "anchor_text": "capstone project"}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "Root Mean Square Error"}, {"url": "https://en.wikipedia.org/wiki/Mean_absolute_error", "anchor_text": "Mean Absolute Error"}, {"url": "https://en.wikipedia.org/wiki/Residual_sum_of_squares", "anchor_text": "Residual Sum of Squares"}, {"url": "https://en.wikipedia.org/wiki/Total_sum_of_squares", "anchor_text": "Total Sum of Squares"}, {"url": "http://www.stat.cmu.edu/~cshalizi/mreg/15/lectures/10/lecture-10.pdf", "anchor_text": "lecture notes"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a2a2ffcd27db---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a2a2ffcd27db---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----a2a2ffcd27db---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/xgboost?source=post_page-----a2a2ffcd27db---------------xgboost-----------------", "anchor_text": "Xgboost"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----a2a2ffcd27db---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa2a2ffcd27db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%25C2%25B2-a2a2ffcd27db&user=Maks+Pazuniak&userId=fad42e2d78db&source=-----a2a2ffcd27db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa2a2ffcd27db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%25C2%25B2-a2a2ffcd27db&user=Maks+Pazuniak&userId=fad42e2d78db&source=-----a2a2ffcd27db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa2a2ffcd27db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa2a2ffcd27db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a2a2ffcd27db---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a2a2ffcd27db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maks_p?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maks_p?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maks Pazuniak"}, {"url": "https://medium.com/@maks_p/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "63 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffad42e2d78db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&user=Maks+Pazuniak&userId=fad42e2d78db&source=post_page-fad42e2d78db--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd530987e6713&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funpacking-r%C2%B2-a2a2ffcd27db&newsletterV3=fad42e2d78db&newsletterV3Id=d530987e6713&user=Maks+Pazuniak&userId=fad42e2d78db&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}