{"url": "https://towardsdatascience.com/data-augmentation-in-medical-images-95c774e6eaae", "time": 1683015035.667605, "path": "towardsdatascience.com/data-augmentation-in-medical-images-95c774e6eaae/", "webpage": {"metadata": {"title": "Data Augmentation in Medical Images | by Cody Glickman, PhD | Towards Data Science", "h1": "Data Augmentation in Medical Images", "description": "The popularization of machine learning has changed our world in wonderful ways. Some notable applications of machine learning allow us to do the previously unthinkable, like determining if an image\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/sfikas/medical-imaging-datasets", "anchor_text": "Giorgos Sfikas\u2019 GitHub", "paragraph_index": 1}, {"url": "https://neptune.ai/blog/data-augmentation-in-python", "anchor_text": "Neptune.ai", "paragraph_index": 1}, {"url": "https://www.deeplearning.ai/", "anchor_text": "deeplearning.ai", "paragraph_index": 5}, {"url": "https://github.com/Datadolittle/augmentation", "anchor_text": "GitHub", "paragraph_index": 5}, {"url": "https://nihcc.app.box.com/v/ChestXray-NIHCC/folder/36938765345", "anchor_text": "NIH Clinical Center Chest X-Ray database", "paragraph_index": 5}, {"url": "https://python-pillow.org/", "anchor_text": "PIL", "paragraph_index": 6}, {"url": "https://github.com/mdbloice/Augmentor", "anchor_text": "Augmentor", "paragraph_index": 6}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator", "anchor_text": "ImageDataGenerator", "paragraph_index": 6}, {"url": "https://github.com/Datadolittle/augmentation", "anchor_text": "GitHub", "paragraph_index": 8}, {"url": "https://nihcc.app.box.com/v/ChestXray-NIHCC/folder/37178474737", "anchor_text": "NIH Clinical Center Chest X-Ray", "paragraph_index": 8}, {"url": "https://nihcc.app.box.com/v/ChestXray-NIHCC/folder/36938765345", "anchor_text": "Data_Entry_2017_v2020.csv", "paragraph_index": 8}, {"url": "https://anaconda.org/conda-forge/keras", "anchor_text": "keras", "paragraph_index": 8}, {"url": "https://anaconda.org/conda-forge/keras-preprocessing", "anchor_text": "keras-preprocessing", "paragraph_index": 8}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNet121 architecture", "paragraph_index": 18}, {"url": "https://github.com/Datadolittle/augmentation", "anchor_text": "GitHub", "paragraph_index": 23}, {"url": "https://github.com/sfikas/medical-imaging-datasets", "anchor_text": "Giorgos Sfikas\u2019 GitHub", "paragraph_index": 23}, {"url": "https://codyglickman.com/", "anchor_text": "Cody Glickman", "paragraph_index": 23}, {"url": "https://www.linkedin.com/in/codyglickman/", "anchor_text": "LinkedIn", "paragraph_index": 23}, {"url": "https://codyglickman.com/", "anchor_text": "https://codyglickman.com/", "paragraph_index": 25}], "all_paragraphs": ["The popularization of machine learning has changed our world in wonderful ways. Some notable applications of machine learning allow us to do the previously unthinkable, like determining if an image is a hot dog or not a hot dog.", "The ease to develop image recognition and classification applications has been streamlined in the last few years with the release of open source neural network frameworks like TensorFlow and PyTorch. Usage of these neural network frameworks is predicated on the availability of labeled training data, which has become more accessible within cloud infrastructures. Neural networks require large amounts of data to properly weight the functions between layers. However, in fields like medical imaging, large amounts of labeled training data are not always available. For those interested in medical imaging data, a great resource can be found at Giorgos Sfikas\u2019 GitHub. A great resource for a general overview of data augmentation techniques and tools can be found on Neptune.ai.", "How can you effectively train a neural network to classify medical images with limited training data. One answer is to augment the labeled data you already have and feed the transformed images into your model. Augmentation serves two purposes. First, additional labeled training data from augmentation in theory will improve your image classification model accuracy [WARNING!!! can lead to overfitting]. Second, the transformations will allow the model to train on orientation variations. Possibly providing the model flexibility when encountering subtle variation shifts in testing or real world data.", "Below is the accuracy of a model trained both with and without data augmentation. I will go into more details about these results later in the article.", "A decent improvement on a small training set. I used only 2GB of 40GB of total data to train the model. Data augmentation reminds me of semi-supervised learning in that you are creating new labeled data to train a model. Data augmentation is also similar to oversampling techniques. For those interested in learning more about semi-supervised methods check out the article below by Andre Ye.", "Data augmentation is most commonly applied to images. There exists two themes of data augmentation. The first is image transformation and the second is synthetic image creation. For the purpose of this article, I will focus primarily on image transformations with an application in medical imaging using python. Parts of the code used in this demo are adapted from the AI for Medical Diagnosis course by deeplearning.ai. The code repository can be found on GitHub and the data used for the modeling can be obtained from the NIH Clinical Center Chest X-Ray database.", "Image manipulation in python can be performed with multiple libraries. PIL and Augmentor are two examples of libraries that can operate directly on images. Augmentor also includes a pipelining function to operate over several images at once. For the purposes of this article, I utilize ImageDataGenerator apart of keras_preprocessing. Types of image augmentations include rotation, cropping, zooming, color range changes, grayscaling, and flipping. Augmentor, also includes a random noise subsection creator for object detection models. When performing any type of data augmentation, it is important to keep in mind the output of your model and if augmentation would affect the resulting classification. For example, in X-ray data the heart is typically on the right of the image, however the image below shows a horizontal flip augmentation inadvertently creates a medical condition call situs inversus.", "For the purposes of this article, I used three levels of data augmentation. First, I ran a model without any augmented images. Next, I used a basic color normalizing augmentation. Finally, I created a model using complex augmentations like zooming, rotating, and cropping images as shown in the example below.", "The full code can be found on the article GitHub. The data for this tutorial can be found from the NIH Clinical Center Chest X-Ray database. In this example, I only utilize the data from images_001.tar.gz, which unzips to about 5K images (~2GB). Also, I downloaded the image labels as Data_Entry_2017_v2020.csv. The libraries used to perform data augmentation require keras and keras-preprocessing. I installed these packages using conda.", "When creating the models, I ran into the following error:", "Solution: Add tensorflow before keras import call as seen below", "To assign labels to the x-ray images, I needed to binarize a the condition column in the metadata. There are 15 unique conditions in this study:", "Patients can have more than one condition in an x-ray. I used scikit-learn to munge the data into the appropriate format with binary values for the 14 conditions excluding the \u2018No Finding\u2019 category.", "I added the paths to the corresponding x-ray image as a new column in the multicolumn binarized dataframe.", "Next, to test the modeling performance, I split the data into training (80%) and testing (20%) groups. The figure below shows the frequency of the classes in the training dataset.", "ImageDataGenerator is capable of processing images into a generator object to avoid loading all the image transformations into memory. ImageDataGenerator is also able to create a generator directly from a pandas dataframe. I built the generator with the code below:", "To change the amount of augmentation, change the value assigned to the image_generator by adjusting the variables called within ImageDataGenerator. To call this generator, use the following line:", "I also built a generator for the testing data.", "I used a DenseNet121 architecture with weights from imagenet to pre-train the model.", "The model predictions were visualized using AUC curves. The AUC values for each iteration was saved into the table below:", "I created an AUC curve for each condition and augmentation status.", "The table summarizing the performance of the models using augmentation is shown below again:", "In this article, I introduced the concept of data augmentation as well as demonstrated its relative performance improvement in a small multiclass recognition task. Data augmentation is a useful tool to expand the amount of available labeled data for deep learning models. I described some types of data augmentation and introduced potential pitfalls to augmenting without considering the classification orientation. In this dataset, the complex augmentation performs poorly at defining hernias in chest x-rays. Hernias are typically found in the tissue near the bottom of the abdomen. With the complex augmentation, I may be altering the model\u2019s ability to distinguish a hernia from the surrounding tissue due to the color adjustment or the rotation.", "The modeling is only utilizing a small subset of the total available data. The advantages of data augmentation may be more pronounce with more than 4000 training images (24000 in the complex augmentation). The code for this article can be found on GitHub. Again, for those interested in medical imaging datasets, a great resource can be found at Giorgos Sfikas\u2019 GitHub. My name is Cody Glickman and I can be found on LinkedIn. Be sure to check out some of my other articles below:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Currently a biological data scientist blogging about side projects and things learned through brute force. https://codyglickman.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F95c774e6eaae&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://glickmancody.medium.com/?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": ""}, {"url": "https://glickmancody.medium.com/?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": "Cody Glickman, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe4a3fd2f53a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&user=Cody+Glickman%2C+PhD&userId=e4a3fd2f53a4&source=post_page-e4a3fd2f53a4----95c774e6eaae---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95c774e6eaae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95c774e6eaae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://unsplash.com/@cdc?utm_source=medium&utm_medium=referral", "anchor_text": "CDC"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/sfikas/medical-imaging-datasets", "anchor_text": "Giorgos Sfikas\u2019 GitHub"}, {"url": "https://neptune.ai/blog/data-augmentation-in-python", "anchor_text": "Neptune.ai"}, {"url": "https://towardsdatascience.com/supervised-learning-but-a-lot-better-semi-supervised-learning-a42dff534781", "anchor_text": "Supervised Learning, But A Lot Better: Semi-Supervised LearningWhy Semi-Supervised Learning is the Future of MLtowardsdatascience.com"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "deeplearning.ai"}, {"url": "https://github.com/Datadolittle/augmentation", "anchor_text": "GitHub"}, {"url": "https://nihcc.app.box.com/v/ChestXray-NIHCC/folder/36938765345", "anchor_text": "NIH Clinical Center Chest X-Ray database"}, {"url": "https://python-pillow.org/", "anchor_text": "PIL"}, {"url": "https://github.com/mdbloice/Augmentor", "anchor_text": "Augmentor"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator", "anchor_text": "ImageDataGenerator"}, {"url": "https://github.com/Datadolittle/augmentation", "anchor_text": "GitHub"}, {"url": "https://nihcc.app.box.com/v/ChestXray-NIHCC/folder/37178474737", "anchor_text": "NIH Clinical Center Chest X-Ray"}, {"url": "https://nihcc.app.box.com/v/ChestXray-NIHCC/folder/36938765345", "anchor_text": "Data_Entry_2017_v2020.csv"}, {"url": "https://anaconda.org/conda-forge/keras", "anchor_text": "keras"}, {"url": "https://anaconda.org/conda-forge/keras-preprocessing", "anchor_text": "keras-preprocessing"}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNet121 architecture"}, {"url": "https://github.com/Datadolittle/augmentation", "anchor_text": "GitHub"}, {"url": "https://github.com/sfikas/medical-imaging-datasets", "anchor_text": "Giorgos Sfikas\u2019 GitHub"}, {"url": "https://codyglickman.com/", "anchor_text": "Cody Glickman"}, {"url": "https://www.linkedin.com/in/codyglickman/", "anchor_text": "LinkedIn"}, {"url": "https://towardsdatascience.com/creating-photo-mosaics-using-python-49100e87efc", "anchor_text": "Creating Photo Mosaics Using PythonA step-by-step tutorial to make your own beautiful imagestowardsdatascience.com"}, {"url": "https://towardsdatascience.com/to-beard-or-not-to-beard-that-is-the-question-b46864d7e003", "anchor_text": "To Beard, or not to Beard, That is the QuestionAge Classification using Deep Learning on photos with and sans beardtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/what-or-why-in-machine-learning-e2a73da528c8", "anchor_text": "What or Why in Machine LearningA comprehensive guide to interpreting models using Pythontowardsdatascience.com"}, {"url": "https://medium.com/tag/python?source=post_page-----95c774e6eaae---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-augmentation?source=post_page-----95c774e6eaae---------------data_augmentation-----------------", "anchor_text": "Data Augmentation"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----95c774e6eaae---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----95c774e6eaae---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----95c774e6eaae---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95c774e6eaae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&user=Cody+Glickman%2C+PhD&userId=e4a3fd2f53a4&source=-----95c774e6eaae---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95c774e6eaae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&user=Cody+Glickman%2C+PhD&userId=e4a3fd2f53a4&source=-----95c774e6eaae---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95c774e6eaae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F95c774e6eaae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----95c774e6eaae---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----95c774e6eaae--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----95c774e6eaae--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----95c774e6eaae--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----95c774e6eaae--------------------------------", "anchor_text": ""}, {"url": "https://glickmancody.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://glickmancody.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cody Glickman, PhD"}, {"url": "https://glickmancody.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "276 Followers"}, {"url": "https://codyglickman.com/", "anchor_text": "https://codyglickman.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe4a3fd2f53a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&user=Cody+Glickman%2C+PhD&userId=e4a3fd2f53a4&source=post_page-e4a3fd2f53a4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffc309c19c340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-in-medical-images-95c774e6eaae&newsletterV3=e4a3fd2f53a4&newsletterV3Id=fc309c19c340&user=Cody+Glickman%2C+PhD&userId=e4a3fd2f53a4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}