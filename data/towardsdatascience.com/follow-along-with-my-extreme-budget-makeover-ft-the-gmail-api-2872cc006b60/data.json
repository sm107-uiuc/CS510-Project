{"url": "https://towardsdatascience.com/follow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60", "time": 1683010573.379916, "path": "towardsdatascience.com/follow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60/", "webpage": {"metadata": {"title": "Follow Along With My Extreme Budget Makeover (ft. the Gmail API) | by Jennifer Kim | Towards Data Science", "h1": "Follow Along With My Extreme Budget Makeover (ft. the Gmail API)", "description": "2020 is the year of improvement \u2014 for the self, for the government and the institutions that be, and for spending habits. My method of budgeting has embraced this theme and has honed itself from a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-i-diyd-my-budget-using-python-for-selenium-and-beautiful-soup-4d2edc5c519", "anchor_text": "Selenium and Beautiful Soup", "paragraph_index": 0}, {"url": "https://github.com/jenniferrkim/budget_gmailapi", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://developers.google.com/gmail/api/quickstart/python", "anchor_text": "Python Quickstart", "paragraph_index": 5}, {"url": "https://developers.google.com/gmail/api/v1/reference/users/messages/list", "anchor_text": "list", "paragraph_index": 7}, {"url": "https://developers.google.com/gmail/api/v1/reference/users/messages/list", "anchor_text": "method", "paragraph_index": 7}, {"url": "https://support.google.com/mail/answer/7190?hl=en", "anchor_text": "Gmail search box", "paragraph_index": 7}, {"url": "https://developers.google.com/gmail/api/v1/reference/users/messages/get", "anchor_text": "get", "paragraph_index": 9}, {"url": "https://developers.google.com/gmail/api/v1/reference/users/messages/get", "anchor_text": "method", "paragraph_index": 9}, {"url": "https://www.youtube.com/watch?v=YIALlhlyqO4", "anchor_text": "juicy", "paragraph_index": 11}, {"url": "https://dateutil.readthedocs.io/en/stable/parser.html", "anchor_text": "parser.parse", "paragraph_index": 13}, {"url": "https://pypi.org/project/money-parser/", "anchor_text": "price_str", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/how-i-diyd-my-budget-using-python-for-selenium-and-beautiful-soup-4d2edc5c519", "anchor_text": "Selenium and Beautiful Soup", "paragraph_index": 18}, {"url": "https://erikrood.com/Posts/py_gsheets.html", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://github.com/jenniferrkim/budget_gmailapi", "anchor_text": "here", "paragraph_index": 22}], "all_paragraphs": ["2020 is the year of improvement \u2014 for the self, for the government and the institutions that be, and for spending habits. My method of budgeting has embraced this theme and has honed itself from a semi-acceptable process (using Selenium and Beautiful Soup) to one that is refined and seamless (using the Gmail API).", "I first stumbled upon the idea of using Gmail when I noticed I received an email every time I completed a transaction with Venmo. These emails included all the information I needed for my budget \u2014 the date, the merchant, and the amount. I investigated the Gmail API to see if I could parse out this information and insert it into Google Sheets. This was a surprisingly pain-free process, and I found I could get similar transaction emails with each of my credit cards by turning on email notifications for any transactions over $0.00.", "Unlike my previous method with Selenium and Beautiful Soup, using the Gmail API provides greater security and access to historical data. The API only requires one authentication step, and does not need a plain text password on your local machine. You can also retrieve any past transaction in your inbox, as long as the email format has not changed. I then used the Google Sheets API to upload all these retrieved transactions for easy viewing, categorization, and aggregation. These substantial benefits make for a better user experience than before.", "Follow along with me to create your own end to end method for getting a hold of your spending habits this year.", "The full code can be found at my Github here. I\u2019m happy to help if you want to build your own budgeting tool \u2014 reach me at jenniferrkim7@gmail.com.", "We first need authentication for access to all our emails. Gmail API\u2019s Python Quickstart (also available in other languages) makes it easy as it provides a sample complete with authentication to make your first request. Since we will only be using this script on our local machine, this method of authentication as shown below is more than sufficient for this project.", "Now that we are authenticated, it is time to make the requests.", "The list method returns an id and threadId of the emails we retrieve, which can later be passed into the get method to obtain the email\u2019s text. We can have the method return only the emails we\u2019re interested in thanks to the query parameter. Here, we pass in an argument in the same query format as the Gmail search box. Since each bank institution\u2019s emails are formatted differently, we can create a function to return a different query based on choice of bank.", "We use the following code snippet from the docs to look through multiple pages of responses.", "The get method returns additional information about a specific email given an id from the list method.", "As seen above, the get method has a format parameter, where we can choose between \u2018full\u2019, \u2018metadata\u2019, \u2018minimal\u2019, and \u2018raw\u2019 as the format of our messages. We first must determine whether we can get the data we need from the snippet that is returned from the format \u2018metadata,\u2019 which contains the subject and first few lines of the email. If the information we need is not in this snippet, we can choose between the formats \u2018full\u2019 or \u2018raw,\u2019 which returns the full email message as a base64url encoded string. I chose to go with \u2018raw.\u2019", "Now that we have our messages, it is time to extract the juicy information.", "The transaction information we require is the date, merchant, and amount. The transaction notification emails from Bank of America and Venmo include all three in the message returned from the format \u2018metadata.\u2019", "Unfortunately, it is not easy to see where the information is as each of these messages is a big, messy dictionary. We must read through the dictionary to see which key value pairs we need. The date is likely nested within the keys \u2018payload\u2019 and \u2018headers,\u2019 and we can extract the date value using parser.parse.", "The rest of the information is likely contained in the value for the key \u2018snippet.\u2019 We can use the money-parser package\u2019s price_str function to find the amount of the transaction, and locate the merchant by identifying key words we know indicate where the merchant info / description lies.", "As we extract the date, merchant, and amount from each message, we can add each piece of information into their respective lists to put into a dataframe after the extraction is complete.", "On a credit card statement, money returned to us is indicated as a negative balance, the opposite of a spending transaction. On Venmo, however, whether we\u2019re the payer or payee, the amount is always positive. To keep our spending numbers accurate, we must multiply the amount of the instances when we\u2019re being paid by -1. To see the code, refer to line 21 in parse_venmo.py above.", "When our information is not in the value for the key \u2018snippet,\u2019 we need the full email message data, retrieved using the format \u2018raw.\u2019 Since the string returned by this format is a base64url string, it must be decoded before it can be read (line 9). Once decoded, the information we need can be extracted in the same way as the merchant in the metadata snippet \u2014 by parsing the string based on the location of key words.", "Sometimes, life throws you for a loop. Other times, Barclays does. The emails Barclays sends only contains the date and amount of the transaction \u2014 with no merchant. There\u2019s really nothing we can do about this, and we may want to get the information directly from the bank\u2019s website using tools like Selenium and Beautiful Soup.", "Google Sheets provides an accessible foundation to create a decent budget interface, an example of which is above. We can use the Google Sheets API via pygsheets to send all our transaction information to a sheet in our budget file. The method below is from Erik Rood\u2019s post here. After a manual categorization of our transactions in a column in Sheets, we can calculate the total in each spending category with a \u2018sum if\u2019 formula.", "For an easy execution, we can add all our functions above to a main function that kicks off the entire transaction aggregation process according to our choice of financial institution (including a choice for \u2018all\u2019).", "We now have a script that sources our spending data just as well as Mint (if not better than, thanks to the inclusion of Venmo). We can even build the interface to be as customized as we want with the power of Google Sheets. With this newfound power, we can hopefully continue to build good financial habits for 2020 and beyond.", "The full code can be found at my Github here. I\u2019m happy to help if you want to build your own budgeting tool \u2014 reach me at jenniferrkim7@gmail.com.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "newly ex-student sharing post-grad dabbles. alum @ nyu"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2872cc006b60&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2872cc006b60--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2872cc006b60--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jennifer.kim7?source=post_page-----2872cc006b60--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jennifer.kim7?source=post_page-----2872cc006b60--------------------------------", "anchor_text": "Jennifer Kim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F365eb23e93d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&user=Jennifer+Kim&userId=365eb23e93d8&source=post_page-365eb23e93d8----2872cc006b60---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2872cc006b60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2872cc006b60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@blankerwahnsinn?utm_source=medium&utm_medium=referral", "anchor_text": "Fabian Blank"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/how-i-diyd-my-budget-using-python-for-selenium-and-beautiful-soup-4d2edc5c519", "anchor_text": "Selenium and Beautiful Soup"}, {"url": "https://github.com/jenniferrkim/budget_gmailapi", "anchor_text": "here"}, {"url": "https://developers.google.com/gmail/api/quickstart/python", "anchor_text": "Python Quickstart"}, {"url": "https://developers.google.com/gmail/api/v1/reference/users/messages/list", "anchor_text": "list"}, {"url": "https://developers.google.com/gmail/api/v1/reference/users/messages/list", "anchor_text": "method"}, {"url": "https://support.google.com/mail/answer/7190?hl=en", "anchor_text": "Gmail search box"}, {"url": "https://developers.google.com/gmail/api/v1/reference/users/messages/get", "anchor_text": "get"}, {"url": "https://developers.google.com/gmail/api/v1/reference/users/messages/get", "anchor_text": "method"}, {"url": "https://www.youtube.com/watch?v=YIALlhlyqO4", "anchor_text": "juicy"}, {"url": "https://dateutil.readthedocs.io/en/stable/parser.html", "anchor_text": "parser.parse"}, {"url": "https://pypi.org/project/money-parser/", "anchor_text": "price_str"}, {"url": "https://towardsdatascience.com/how-i-diyd-my-budget-using-python-for-selenium-and-beautiful-soup-4d2edc5c519", "anchor_text": "Selenium and Beautiful Soup"}, {"url": "https://erikrood.com/Posts/py_gsheets.html", "anchor_text": "here"}, {"url": "https://github.com/jenniferrkim/budget_gmailapi", "anchor_text": "here"}, {"url": "https://medium.com/tag/personal-finance?source=post_page-----2872cc006b60---------------personal_finance-----------------", "anchor_text": "Personal Finance"}, {"url": "https://medium.com/tag/python?source=post_page-----2872cc006b60---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----2872cc006b60---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/budgeting?source=post_page-----2872cc006b60---------------budgeting-----------------", "anchor_text": "Budgeting"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----2872cc006b60---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2872cc006b60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&user=Jennifer+Kim&userId=365eb23e93d8&source=-----2872cc006b60---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2872cc006b60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&user=Jennifer+Kim&userId=365eb23e93d8&source=-----2872cc006b60---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2872cc006b60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2872cc006b60--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2872cc006b60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2872cc006b60---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2872cc006b60--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2872cc006b60--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2872cc006b60--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2872cc006b60--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2872cc006b60--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2872cc006b60--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2872cc006b60--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2872cc006b60--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jennifer.kim7?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jennifer.kim7?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jennifer Kim"}, {"url": "https://medium.com/@jennifer.kim7/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "52 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F365eb23e93d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&user=Jennifer+Kim&userId=365eb23e93d8&source=post_page-365eb23e93d8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2de7d3423284&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffollow-along-with-my-extreme-budget-makeover-ft-the-gmail-api-2872cc006b60&newsletterV3=365eb23e93d8&newsletterV3Id=2de7d3423284&user=Jennifer+Kim&userId=365eb23e93d8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}