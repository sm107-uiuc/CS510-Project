{"url": "https://towardsdatascience.com/creating-abstract-art-with-stylegan2-ada-ea3676396ffb", "time": 1683018358.538116, "path": "towardsdatascience.com/creating-abstract-art-with-stylegan2-ada-ea3676396ffb/", "webpage": {"metadata": {"title": "Creating Abstract Art with StyleGAN2 ADA | Towards Data Science", "h1": "Creating Abstract Art with StyleGAN2 ADA", "description": "How I used Adaptive Discriminator Augmentation and Learning Transfer to generate improved abstract paintings with AI."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/machineray-using-ai-to-create-abstract-art-39829438076a", "anchor_text": "MachineRay", "paragraph_index": 0}, {"url": "https://github.com/robgon-art/MachineRay/blob/master/scrape-wikiart-by-artist.py", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/robgon-art/stylegan2-ada", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://colab.research.google.com/github/robgon-art/MachineRay2/blob/main/StyleGAN2_ADA_Augmentation_Test.ipynb", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://medium.com/swlh/training-gans-with-limited-data-22a7c8ffce78", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/graduating-in-gans-going-from-understanding-generative-adversarial-networks-to-running-your-own-39804c283399", "anchor_text": "here", "paragraph_index": 21}, {"url": "https://www.kaggle.com/arnaud58/landscape-pictures", "anchor_text": "here", "paragraph_index": 28}, {"url": "https://colab.research.google.com/github/robgon-art/MachineRay2/blob/main/MachineRay2_Image_Generation.ipynb", "anchor_text": "here", "paragraph_index": 42}, {"url": "https://www.kaggle.com/robgonsalves/abstract-paintings", "anchor_text": "here", "paragraph_index": 45}, {"url": "https://github.com/robgon-art/MachineRay2", "anchor_text": "GitHub", "paragraph_index": 45}, {"url": "https://creativecommons.org/licenses/by-nc-sa/4.0/", "anchor_text": "CC BY-NC-SA license", "paragraph_index": 45}], "all_paragraphs": ["Back in August 2020, I created a project called MachineRay that uses Nvidia\u2019s StyleGAN2 to create new abstract artwork based on early 20th century paintings that are in the public domain. Since then, Nvidia has released a new version of their AI model, StyleGAN2 ADA, that is designed to yield better results when generating images from a limited dataset [1]. (I\u2019m not sure why they didn't call it StyleGAN3, but I\u2019ll refer to the new model as SG2A to save a few characters). In this article, I\u2019ll show you how I used SG2A to create better looking abstract paintings.", "Similar to the original Machine Ray, I am using abstract paintings that are in the public domain as my source images to train the SG2A system. I then change the aspect ratio as part of the post-processing. This diagram shows the flow through the system.", "Everything starts with the 850 images I scraped from WikiArt.org using a custom script. The images are pre-processed and fed into the Discriminator Network as the \u201creal\u201d images. A set of 512 random numbers are chosen and fed into the Style Mapper and Generator Networks to create the \u201cfake\u201d images. Both the real and fake images are modified with Adaptive Discriminator Augmentation, the key innovation in SG2A. I\u2019ll discuss this further down in the article. The job of the Discriminator Network is to determine if the input is real or fake. The result is fed back into the three networks to train them. When the training is done, I post-process the output of the Generator Network to get the final images.", "I\u2019ll go through each step in more detail in the sections below.", "I use a Python script to gather images from WikiArt.org that are labeled as being \u201cabstract\u201d and are in the public domain, i.e. created before 1925. The images are from the likes of Mondrian, Kandinsky, Klee, etc. The source code to gather the images is here. Here is a sample of the source paintings.", "Here are the steps I use for pre-processing the images:", "Here is a sample of pre-processed images.", "One of the major improvements in SG2A is dynamically changing the amount of image augmentation during training.", "Image augmentation has been around for a while. The concept is fairly simple. If you don\u2019t have enough images to train a GAN, it can lead to poor performance, like overfitting, underfitting, or the dreaded \u201cmodel collapse\u201d, where the generator repeats the same output image. A remedy for these problems is image augmentation, where you can apply transformations like rotation, scaling, translation, color adjustments, etc., to create additional images for the training set.", "A downside to image augmentation is that the transformations can \u201cleak\u201d into the generated images which may not be desirable. For example, if you are generating human faces, you could use 90\u00b0 rotation to augment the training data, but you may not want the generated faces to be rotated. Nvidia found that augmentations can be designed to be non-leaking on the condition that they are skipped with a non-zero probability. So if most of the images being fed into the discriminator are not rotated for augmentation, the generator will learn to not create images that are rotated [1].", "\u2026the training implicitly undoes the corruptions and finds the correct distribution, as long as the corruption process is represented by an invertible transformation of probability distributions over the data space. We call such augmentation operators non-leaking. \u2014 Tero Karras, et al.", "The new version of StyleGAN has a feature called Adaptive Discriminator Augmentation (ADA) that performs non-leaking image augmentations during training. A new hyperparameter, p, in the range of 0 to 1, determines how much and how often augmentations are to be applied to both the real images and the fake images during training.", "Here is a sample of augmentations with different values for p.", "You can see how the sample images show more variety with spatial and color changes as p increases from 0.0 to 1.0. (Note that SG2A does not show the augmentation done to the real images during training. So I added the functionality to do this in my fork of the code, here. You can run a test in the Google Colab, here.)", "The value p starts at 0 when training begins, and then increases or decreases if the system senses that there is overfitting or underfitting during training.", "The heuristic used in the system is based on the sign (positive or negative) of the output of the discriminator during the processing of a batch of generated images. If there are more positive output values than negative, then the trend is towards real images, which is an indication of overfitting. If there are more negative values than positive then the trend is towards fake images, which is an indication of underfitting. The value p is adjusted up or down accordingly after the batch \u2014 up for overfitting and down for underfitting.", "A target value for p can be set, i.e. 0.7, so there is always a non-zero probability that the augmentations can be skipped, which avoids leaking.", "You can read more about Adaptive Discriminator Augmentation in Mayank Agarwal\u2019s post here.", "I trained the system using Google Colab. It took about four days to run. The system has an Nvidia Tesla V100 GPU which can run up to 14 teraFLOPS (14 trillion floating-point operations per second). So it took about 4.6 exaFLOPS to train (about 4.6 quintillion floating-point operations). That\u2019s a lot of math.", "Here\u2019s the shell command I used to kick things off.", "Setting the aug parameter to ada enables the Adaptive Discriminator Augmentation to kick in when needed. Setting the target parameter to 0.7 prevents p from going over 0.7, which maximizes the dynamic augmentation without leaking any further augmentation into the final images.", "Here\u2019s a graph of the training results over time. I am using the Fr\u00e9chet Inception Distance (FID) as a metric for image quality and diversity, where a lower score is better [2]. You can read about the FID score in Cecelia Shao\u2019s post here.", "You can see how StyleGAN2 ADA outperforms the original StyleGAN2 for the same number of iterations. The FID score for SG2A bottomed out at just over 100 after about 300 iterations. Here are some samples of the results.", "The GAN seems to produce a nice variety of abstract paintings with interesting compositions with varied color schemes. But there is room for improvement.", "It may not be intuitive, but it\u2019s possible to improve the quality of the paintings by first training the GAN on a different, larger set of images, and then further train the model using the abstract paintings. This technique is called Transfer Learning. It was first described as a technique for training NNs in 1976 [3].", "Transfer Learning is technique that uses a pre-trained neural network trained for Task 1 for achieving shorter training time in learning Task 2. [4] \u2014 Stevo Bozinovski", "I remember learning in my Art History 101 class that many abstract painters started by painting figurative subjects, like people and landscapes. For example here are sequences of paintings by Mondrian, Klee, and Kandinsky that show their progressions from landscape to abstract art.", "I wanted to see if I could transfer the learning from creating landscape photos to perhaps improve its ability to create abstract paintings.", "As an experiment, I trained SG2A on 4,800 photographs of landscape photos from Flickr that are in the public domain. The dataset, by Arnaud Rougetet, is available on Kaggle, here.", "Here is a sample of the photos from Flickr. Note that I resized the photos to be 1,024 x 1,024 pixels each.", "I trained the SG2A system using another Google Colab to create new landscape images. It also took about four days to run the training. Here\u2019s the shell command I used.", "The command is almost the same as the one I used to train using the abstract paintings. The only differences are the paths to the landscape folders on Google Drive. Here\u2019s a graph that shows the FID scores of the training of landscapes (the green line).", "The score for the generated landscapes is much better than the abstract paintings. You can see that it bottomed out around 25 after about 150 iterations. The reason the landscapes have a better score than the abstract paintings is probably due to the larger training set \u2014 4,800 landscapes and only 850 abstract paintings.", "Here are some generated landscape photos that were created after four days of training SG2A.", "These look pretty good. The horizons are a bit distorted and the clouds seem somewhat fantastical, but they could otherwise pass as real landscape photos. Now let\u2019s see if this learning can help with creating abstract art.", "The next step of the experiment was retraining SG2A to create abstract art starting with the model previously trained on landscapes. Here\u2019s a flow diagram that shows the process.", "After the GAN was trained to create landscapes, it was further trained to create abstract paintings using prior knowledge of the landscapes. I trained the system using a third Google Colab. Here\u2019s the shell command I used.", "I am training using abstract paintings, but the resume option starts the training with the GAN trained with landscapes. It took about four days to run the final training. Here is a graph of the FID scores. The new results are in blue.", "You can see that Transfer Learning helped improve the scores. The FID numbers for the latest training run settle in around 85, which is better than the previous run with a score of about 105. Here are some sample images that benefitted from the Transfer Learning.", "It may be subtle, but the images created with the model with Transfer Learning appear to be more refined, pleasing compositions. Please check out the appendix below for a gallery of samples.", "Once the GAN is trained, images can be generated using this command line.", "This will generate four images using random seeds 1, 2, 3, and 4. The truncation parameter, trunc, will determine how much variation there will be in the images. I found that the default of 0.5 is too low, and 1.5 gives much more variety.", "A Google Colab for generating images with a variety of aspect ratios is available here. It generates 21 images and lets you choose one to see at high resolution. Here is a sample of images.", "Additional work might include training on paintings of landscapes instead of photos for the Transfer Learning. This may help the GAN pick up on a painterly look to apply to abstract paintings.", "I would like to thank Jennifer Lim, Oliver Strimpel, Mahsa Mesgaran, and Vahid Khorasani for their help and feedback on this project.", "The 850 abstract paintings I collected can be found on Kaggle here. All source code for this project is available on GitHub. The sources are released under the CC BY-NC-SA license.", "[3] Bozinovskim S., and Fulgosi, A., \u201cThe influence of pattern similarity and transfer learning upon training of a base perceptron B2.\u201d Proceedings of Symposium Informatica, 3\u2013121\u20135, 1976", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Robert A. Gonsalves is an artist, inventor, and engineer in the Boston area who researches and writes about the creative uses of AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fea3676396ffb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://robgon.medium.com/?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": "Robert A. Gonsalves"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc97e6c73c13c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=post_page-c97e6c73c13c----ea3676396ffb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea3676396ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea3676396ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/machineray-using-ai-to-create-abstract-art-39829438076a", "anchor_text": "MachineRay"}, {"url": "https://github.com/robgon-art/MachineRay/blob/master/scrape-wikiart-by-artist.py", "anchor_text": "here"}, {"url": "https://github.com/robgon-art/MachineRay/blob/master/remove_frames.py", "anchor_text": "here"}, {"url": "https://github.com/robgon-art/stylegan2-ada", "anchor_text": "here"}, {"url": "https://colab.research.google.com/github/robgon-art/MachineRay2/blob/main/StyleGAN2_ADA_Augmentation_Test.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/swlh/training-gans-with-limited-data-22a7c8ffce78", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/graduating-in-gans-going-from-understanding-generative-adversarial-networks-to-running-your-own-39804c283399", "anchor_text": "here"}, {"url": "https://www.kaggle.com/arnaud58/landscape-pictures", "anchor_text": "here"}, {"url": "https://colab.research.google.com/github/robgon-art/MachineRay2/blob/main/MachineRay2_Image_Generation.ipynb", "anchor_text": "here"}, {"url": "https://www.kaggle.com/robgonsalves/abstract-paintings", "anchor_text": "here"}, {"url": "https://github.com/robgon-art/MachineRay2", "anchor_text": "GitHub"}, {"url": "https://creativecommons.org/licenses/by-nc-sa/4.0/", "anchor_text": "CC BY-NC-SA license"}, {"url": "https://arxiv.org/pdf/2006.06676.pdf", "anchor_text": "https://arxiv.org/pdf/2006.06676.pdf"}, {"url": "http://www.kr.tuwien.ac.at/staff/eiter/et-archive/cdtr9464.pdf", "anchor_text": "http://www.kr.tuwien.ac.at/staff/eiter/et-archive/cdtr9464.pdf"}, {"url": "http://www.informatica.si/index.php/informatica/article/view/2828", "anchor_text": "http://www.informatica.si/index.php/informatica/article/view/2828"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ea3676396ffb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ea3676396ffb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/abstract-art?source=post_page-----ea3676396ffb---------------abstract_art-----------------", "anchor_text": "Abstract Art"}, {"url": "https://medium.com/tag/generative-adversarial?source=post_page-----ea3676396ffb---------------generative_adversarial-----------------", "anchor_text": "Generative Adversarial"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----ea3676396ffb---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://creativecommons.org/licenses/by-nc-sa/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea3676396ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=-----ea3676396ffb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea3676396ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=-----ea3676396ffb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea3676396ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fea3676396ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ea3676396ffb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ea3676396ffb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ea3676396ffb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ea3676396ffb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ea3676396ffb--------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Robert A. Gonsalves"}, {"url": "https://robgon.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc97e6c73c13c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=post_page-c97e6c73c13c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F886e4a42bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-abstract-art-with-stylegan2-ada-ea3676396ffb&newsletterV3=c97e6c73c13c&newsletterV3Id=886e4a42bf8&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}