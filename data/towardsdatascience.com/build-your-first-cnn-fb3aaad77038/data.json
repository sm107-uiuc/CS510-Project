{"url": "https://towardsdatascience.com/build-your-first-cnn-fb3aaad77038", "time": 1683004676.515341, "path": "towardsdatascience.com/build-your-first-cnn-fb3aaad77038/", "webpage": {"metadata": {"title": "Build your first CNN. A better approach to build a\u2026 | by Prateek Gulati | Towards Data Science", "h1": "Build your first CNN", "description": "Convolutional Neural Networks (CNN) are a type of Deep Neural Network that are efficient in image recognition and classification. They accept an image as input, extract features from it through\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/prateeksworld/", "anchor_text": "https://www.linkedin.com/in/prateeksworld/", "paragraph_index": 24}], "all_paragraphs": ["Convolutional Neural Networks (CNN) are a type of Deep Neural Network that are efficient in image recognition and classification. They accept an image as input, extract features from it through kernels and predict the desired output. The preprocessing of data is minimal in a CNN and they can self-learn to recognize the important features from different images. Almost all of the state of art networks in object detection, object recognition, facial identification, autonomous driving, etc. utilize a CNN in some manner.", "There are plenty of tutorials available online on building a CNN from scratch. Though most of them do offer high accuracy, they ignore the substantial use of memory and parameters. When it comes to deploying models in the industry, building a network is not only about achieving the target accuracy, but also engaging in optimizing memory consumption.In this article, we are going to learn how to build an optimized CNN for object recognition.To keep the expectations right, let\u2019s set a goal:", "1. Achieve 99.4 % validation accuracy2. Number of total parameters of the model should be less than 15k3. Maximum number of epochs = 20", "To achieve this goal, we will split our plan of action into 4 iterations. First, we will focus on building a model that achieves the target accuracy. Then we will drastically decrease the parameters while maintaining the architecture. This reduction in the parameters can lead to some drop in accuracy. To compensate for the drop, we will optimize the model to meet our target. To make sure our model is somewhat consistent in each iteration, let\u2019s add a condition of restricting the modifications between each iteration to three.Before we begin designing our network, there are a few terminologies we should be familiar with \u2014", "A Kernel is a randomly allocated weight matrix that is traversed and convolved over the image. One kernel extracts a single feature from the image.", "The output of a convolution layer can be considered as a set of Channels. For instance, 1 Greyscale Image (NxN) \u2192 convolution with 64 kernels (3x3) \u2192 64 channels ((N-2)x(N-2))", "Receptive Field is a region in the sensory periphery within which stimuli can influence the electrical activity of sensory cells. In CNN, this is the part of the image that is perceived by a single cell of a channel/kernel.", "The model architecture of a CNN is designed by keeping the focus on the receptive field. Generally, the receptive field of a model by the end of the network is similar to the size of the object.", "A block that contains multiple convolutional layers (3x3). In each subsequent layers, the number of kernels/filers are generally increased to make sure all the important feature are extracted from the image.", "Each convolution layer has an activation function (preferably ReLU, as it is light on parameters which makes it easy for backpropagation to rectify the weights) which adds a non-linearity to the network.", "This block has a pointwise (1x1) convolution to reduce the number of channels and a maxPool layer to decrease the spatial dimension or channel size. The key role of this block is to filter out the irrelevant features and limit the number of parameters.", "Now let\u2019s proceed with designing of the network", "The first thing to consider while laying out the architecture is the receptive field. Towards the end of the model, the receptive field should be equal to the size of the object. Complete architecture is designed around this concept. Pairs of convolution block and transition block are added to acquire the required receptive field.", "Note: A transition block has a pooling layer which causes loss of information. Towards the end of the network, the size of the channel is small and the information is critical. Hence, a transition block is avoided towards the end of the network.", "After the last convolution block, we flatten the output and use a softmax activation which provides a probability like distribution.", "In this particular problem, the first transition block is added sooner in the network as the background is predominantly white and doesn\u2019t hold much information and most of the information lies within the center. So it\u2019s convenient to use the first maxPool early in the network.", "Our goal is to achieve 99.40% accuracy in less than 15k parameters. In this section, the primary focus would be reducing the number of kernels/filers in each convolution so that the total parameters are less than 15k without much compromise with accuracy (which will be recovered by optimization techniques in the later steps).", "1. Reducing filters in 3x3 convolution layers2. Reducing filters in 1x1 convolution layers Even though drastically reducing the parameters in all the layers, the total parameters still cross 15k. 3. Adding a partial transition block exactly in the middle of the first transition block and the output layer. This partial transition block will include only a 1x1 convolution, but no maxPool. The third step ensures that only important features are carried ahead in the network and avoids the loss of information that could have possibly occurred due to maxPool.", "Since we have dropped a major chunk of parameters, we need to employ some optimization techniques to ensure our model doesn\u2019t compromise with accuracy.", "1. Add Batch normalization layers. This helps in normalizing the data and restricting the scale change later in the network. This fixes the means and variances of layer inputs which helps in faster convergence and improved gradient flow.2. Choosing an appropriate Learning Rate Selecting an LR that works best for the network (based on experiments)3. A validation checkpoint The accuracy vs epoch graph is not strictly increasing. Accuracy keeps on oscillating, hence one cannot rely on the last epoch to give the best result. So, a validation checkpoint is added that calculates accuracy on validation data after every epoch.", "Notice that the gap between training and validation accuracy widens with subsequent epochs. This shows that the model is overfitting. To address this, we will add a dropout\u00b2 layer after every 3x3 convolution.", "1. Add Dropout\u00b2Dropout\u00b2 randomly skips some connections and forces the network to learn from other parameters.2. Add an LR schedulerOnce the accuracy saturates, the learning rate needs to be reduced so that the model can converge to a more optimal minima and eventually lead to increased accuracy.3. Increase Batch sizeA large batch size helps in faster training of the model. Note: the batch size should not be extremely large. This may lead to the loss function getting stuck in sub-optimal local minima.", "We have already achieved our goal. Now, let\u2019s try to push our model parameters to less than 8k parameters by further reducing the number of kernels in each layer without compromising with accuracy.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Exploring realms of Deep Learning | Data Scientist | Software Engineer II at Dell | LinkedIn: https://www.linkedin.com/in/prateeksworld/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffb3aaad77038&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@prateeks_world?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prateeks_world?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": "Prateek Gulati"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F67afa97f53d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&user=Prateek+Gulati&userId=67afa97f53d9&source=post_page-67afa97f53d9----fb3aaad77038---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb3aaad77038&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb3aaad77038&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colab.research.google.com/drive/1IJwulhX4WNWKUXVArwIJk_fuCXv-2zUN", "anchor_text": "Colab Notebook"}, {"url": "https://colab.research.google.com/drive/1vS2UPSF6kIxHjGcJnqlTqltn3uD5X6jm", "anchor_text": "Colab Notebook"}, {"url": "https://colab.research.google.com/drive/1Vuj54Tx26tBIJXyiDpa3Mrm2ORzVpUMw", "anchor_text": "Colab Notebook"}, {"url": "https://colab.research.google.com/drive/165lEq_jXsBIaOZnYHbNPreH0fBaJu8yB", "anchor_text": "Colab Notebook"}, {"url": "https://colab.research.google.com/drive/1TeL7ueHTRB34ofw41dehvHA_xkdX0Cpj", "anchor_text": "Colab Notebook"}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "\u201cMNIST handwritten digit database, Yann LeCun, Corinna Cortes and Chris Burges\u201d"}, {"url": "http://jmlr.org/papers/volume15/srivastava14a/srivastava14a.pdf", "anchor_text": "Dropout: A Simple Way to Prevent Neural Networks from Overfitting. Journal of Machine Learning Research"}, {"url": "https://medium.com/tag/cnn?source=post_page-----fb3aaad77038---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/tag/convolutional-neural-net?source=post_page-----fb3aaad77038---------------convolutional_neural_net-----------------", "anchor_text": "Convolutional Neural Net"}, {"url": "https://medium.com/tag/mnist?source=post_page-----fb3aaad77038---------------mnist-----------------", "anchor_text": "Mnist"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fb3aaad77038---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----fb3aaad77038---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb3aaad77038&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&user=Prateek+Gulati&userId=67afa97f53d9&source=-----fb3aaad77038---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb3aaad77038&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&user=Prateek+Gulati&userId=67afa97f53d9&source=-----fb3aaad77038---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb3aaad77038&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffb3aaad77038&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fb3aaad77038---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fb3aaad77038--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fb3aaad77038--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fb3aaad77038--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fb3aaad77038--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prateeks_world?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prateeks_world?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Prateek Gulati"}, {"url": "https://medium.com/@prateeks_world/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "https://www.linkedin.com/in/prateeksworld/", "anchor_text": "https://www.linkedin.com/in/prateeksworld/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F67afa97f53d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&user=Prateek+Gulati&userId=67afa97f53d9&source=post_page-67afa97f53d9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F67afa97f53d9%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-cnn-fb3aaad77038&user=Prateek+Gulati&userId=67afa97f53d9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}