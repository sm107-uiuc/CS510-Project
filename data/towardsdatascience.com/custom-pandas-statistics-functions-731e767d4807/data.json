{"url": "https://towardsdatascience.com/custom-pandas-statistics-functions-731e767d4807", "time": 1683016137.988109, "path": "towardsdatascience.com/custom-pandas-statistics-functions-731e767d4807/", "webpage": {"metadata": {"title": "Custom Pandas Statistics Functions | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Custom Pandas Statistics Functions", "description": "Pandas is a useful python library that can be used for a variety of data tasks including statistical analysis, data imputation, data wrangling and much more. In this post, we will go over three\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.amazon.com/dp/B08N38XW2Q/ref=sr_1_1?dchild=1&keywords=sadrach+python&qid=1604966500&s=books&sr=1-1", "anchor_text": "Python for Data Science and Machine Learning: Python Programming, Pandas and Scikit-learn Tutorials for Beginners", "paragraph_index": 17}, {"url": "https://github.com/spierre91/medium_code/blob/master/pandas_tutorials/pandas_custom_functions.py", "anchor_text": "GitHub", "paragraph_index": 17}], "all_paragraphs": ["Pandas is a useful python library that can be used for a variety of data tasks including statistical analysis, data imputation, data wrangling and much more. In this post, we will go over three useful custom functions that allow us to generate statistics from data.", "For our purposes, we will be working with the Wines Reviews data set which can be found here.", "To start, let\u2019s import the pandas and numpy packages:", "Next, let\u2019s set the maximum number of display columns and rows to \u2018None\u2019:", "Now, let\u2019s read in our data:", "Next we will print the first five rows of data to get an idea of the column types and their values (column results are truncated):", "An interesting function we can consider is one that generates the average value for a numerical column for a given category in a categorical column. This function will take a categorical column name, a categorical value for that categorical column, and a numerical column name:", "Within the function we need to filter the dataframe for that categorical value and take the mean of the numerical values for that category:", "Finally, we can use python \u201cf-strings\u201d to print the result:", "Now, let\u2019s call the function with the categorical column \u2018country\u2019, the country value \u2018Italy\u2019, and the numerical column \u2018price\u2019:", "We can also call the function with the category \u2018variety\u2019, the variety value \u2018Pinot Noir\u2019 and the numerical column \u2018price\u2019:", "Another function we can consider is one that generates the mean of a numerical column for each categorical value in a categorical column. We can use the Pandas \u2018groupby\u2019 method to achieve this:", "If we call our function with \u2018country\u2019 and \u2018price\u2019, we will print the mean price for each country (the results are truncated for clarity):", "For a sanity check, we see that we get that same mean price for Italy as we did in the previous function. We can also apply this function to wine variety and price (the results are truncated for clarity):", "The last function we will discuss is one that generates the mode of a categorical column for each value of another categorical column. We can use the Pandas \u2018groupby\u2019 method to achieve this as well:", "Let\u2019s find the mode wine variety for each country. This will tell us the most frequently appearing wine variety for each country:", "I\u2019ll stop here but feel free to play around with the code and data yourself.", "To summarize, in this post we discussed how to define three custom functions using Pandas to generate statistical insights from data. First, we showed how to define a function that calculates the mean of a numerical column given a categorical column and category value. We then showed how to use the \u2018groupby\u2019 method to generate the mean value for a numerical column for each category in a categorical column. Finally, we showed how to generate the mode of a categorical column for each value of another categorical column. If you are interested in learning more about data manipulation with pandas, machine learning or even just some of the basics of python programming check out Python for Data Science and Machine Learning: Python Programming, Pandas and Scikit-learn Tutorials for Beginners. I hope you found this post useful/interesting. The code in this post is available on GitHub. Thank you for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F731e767d4807&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----731e767d4807--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----731e767d4807--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----731e767d4807--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----731e767d4807--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----731e767d4807---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F731e767d4807&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F731e767d4807&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@pixabay", "anchor_text": "Pixabay"}, {"url": "https://www.pexels.com/photo/books-business-computer-connection-459654/", "anchor_text": "Pexels"}, {"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "here"}, {"url": "https://www.amazon.com/dp/B08N38XW2Q/ref=sr_1_1?dchild=1&keywords=sadrach+python&qid=1604966500&s=books&sr=1-1", "anchor_text": "Python for Data Science and Machine Learning: Python Programming, Pandas and Scikit-learn Tutorials for Beginners"}, {"url": "https://github.com/spierre91/medium_code/blob/master/pandas_tutorials/pandas_custom_functions.py", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/python?source=post_page-----731e767d4807---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----731e767d4807---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----731e767d4807---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/statistics?source=post_page-----731e767d4807---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/software-development?source=post_page-----731e767d4807---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F731e767d4807&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----731e767d4807---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F731e767d4807&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----731e767d4807---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F731e767d4807&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----731e767d4807--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F731e767d4807&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----731e767d4807---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----731e767d4807--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----731e767d4807--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----731e767d4807--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----731e767d4807--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----731e767d4807--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----731e767d4807--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----731e767d4807--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----731e767d4807--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-pandas-statistics-functions-731e767d4807&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}