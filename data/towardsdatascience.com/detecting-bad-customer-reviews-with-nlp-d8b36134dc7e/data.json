{"url": "https://towardsdatascience.com/detecting-bad-customer-reviews-with-nlp-d8b36134dc7e", "time": 1682994272.832525, "path": "towardsdatascience.com/detecting-bad-customer-reviews-with-nlp-d8b36134dc7e/", "webpage": {"metadata": {"title": "Detecting bad customer reviews with NLP | by Jonathan Oheix | Towards Data Science", "h1": "Detecting bad customer reviews with NLP", "description": "Sentiment analysis is part of the Natural Language Processing (NLP) techniques that consists in extracting emotions related to some raw texts. This is usually used on social media posts and customer\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/jonathanoheix/", "anchor_text": "https://www.linkedin.com/in/jonathanoheix/", "paragraph_index": 41}], "all_paragraphs": ["Sentiment analysis is part of the Natural Language Processing (NLP) techniques that consists in extracting emotions related to some raw texts. This is usually used on social media posts and customer reviews in order to automatically understand if some users are positive or negative and why. The goal of this study is to show how sentiment analysis can be performed using python. Here are some of the main libraries we will use:", "We will use here some hotel reviews data. Each observation consists in one customer review for one hotel. Each customer review is composed of a textual feedback of the customer\u2019s experience at the hotel and an overall rating. The data can be found here:", "For each textual review, we want to predict if it corresponds to a good review (the customer is happy) or to a bad one (the customer is not satisfied). The reviews overall ratings can range from 2.5/10 to 10/10. In order to simplify the problem we will split those into two categories:", "The challenge here is to be able to predict this information using only the raw textual data from the review. Let\u2019s get it started!", "We first start by loading the raw data. Each textual reviews is splitted into a positive part and a negative part. We group them together in order to start with only raw text data and no other information.", "We sample the data in order to speed up computations.", "If the user doesn\u2019t leave any negative feedback comment, this will appear as \u201cNo Negative\u201d in our data. This is the same for the positive comments with the default value \u201cNo Positive\u201d. We have to remove those parts from our texts.", "The next step consists in cleaning the text data with various operations:", "To clean textual data, we call our custom \u2018clean_text\u2019 function that performs several transformations:", "Now that we have cleaned our data, we can do some feature engineering for our modelization part.", "We first start by adding sentiment analysis features because we can guess that customers reviews are highly linked to how they felt about their stay at the hotel. We use Vader, which is a part of the NLTK module designed for sentiment analysis. Vader uses a lexicon of words to find which ones are positives or negatives. It also takes into account the context of the sentences to determine the sentiment scores. For each text, Vader returns 4 values:", "We will integrate those 4 values as features in our dataset.", "Next, we add some simple metrics for every text:", "The next step consist in extracting vector representations for every review. The module Gensim creates a numerical vector representation of every word in the corpus by using the contexts in which they appear (Word2Vec). This is performed using shallow neural networks. What\u2019s interesting is that similar words will have similar representation vectors.", "Each text can also be transformed into numerical vectors using the word vectors (Doc2Vec). Same texts will also have similar representations and that is why we can use those vectors as training features.", "We first have to train a Doc2Vec model by feeding in our text data. By applying this model on our reviews, we can get those representation vectors.", "Finally we add the TF-IDF (Term Frequency \u2014 Inverse Document Frequency) values for every word and every document.", "But why not simply counting how many times each word appears in every document? The problem with this method is that it doesn\u2019t take into account the relative importance of words in the texts. A word that appears in almost every text would not likely bring useful information for analysis. On the contrary, rare words may have a lot more of meanings.", "The TF-IDF metric solves this problem:", "We add TF-IDF columns for every word that appear in at least 10 different texts to filter some of them and reduce the size of the final output.", "In order to have a better understanding of our data, let\u2019s explore it a little:", "Our dataset is highly imbalanced because less than 5% of our reviews are considered as negative ones. This information will be very useful for the modelling part.", "Now let\u2019s print some wordclouds to have a glimpse at what kind of words apear in our reviews:", "Most of the words are indeed related to the hotels: room, staff, breakfast, etc. Some words are more related to the customer experience with the hotel stay: perfect, loved, expensive, dislike, etc.", "The most positive reviews indeed correspond to some good feedbacks.", "Some errors can be found among the most negative reviews: Vader sometimes interpret \u2018no\u2019 or \u2018nothing\u2019 as negative words whereas they are sometimes used to say that there were no problems with the hotel. Fortunately, most of the reviews are indeed bad ones.", "The above graph shows the distribution of the reviews sentiments among good reviews and bad ones. We can see that good reviews are for most of them considered as very positive by Vader. On the contrary, bad reviews tend to have lower compound sentiment scores.", "This shows us that previously computed sentiment features will be very important in our modelling part.", "We first choose which features we want to use to train our model. Then we split our data into two parts:", "We will next use a Random Forest (RF) classifier for our predictions.", "The most important features are indeed the ones that come from the previous sentiment analysis. The vector representations of the texts also have a lot of importance in our training. Some words appear to have a fairly good importance as well.", "The ROC (Receiver Operating Characteristic) curve is usually a good graph to summarize the quality of our classifier. The higher the curve is above the diagonal baseline, the better the predictions. Although the AUC ROC (Area Under the Curve ROC) is very good, we should not use here the ROC curve to assess the quality of our model.", "Why? First let us remind the False Positive Rate formula, which corresponds to the x axis of the ROC curve: FPR (False Positive Rate) = # False Positives / # Negatives.", "Here the # Negatives corresponds to our number of good reviews which is very high because our dataset is imbalanced. This means that even with some False Positives, our FPR will tend to stay very low. Our model will be able to make a lot of false positives predictions and still have a low false positive rate, while increasing the true positive rate and therefore artificially increasing the AUC ROC metric.", "A better metric in this imbalanced situation is the AUC PR (Area Under the Curve Precision Recall), or also called AP (Average Precision).", "We can see that the precision decreases when we increase the recall. This shows us that we have to choose a prediction thresold adapted to our needs. If our goal is to have a high recall, we should set a low prediction thresold that will allow us to detect most of the observations of the positive class, but with a low precision. On the contrary, if we want to be really confident about our predictions but don\u2019t mind about not finding all the positive observations, we should set a high thresold that will get us a high precision and a low recall.", "In order to know if our model performs better than another classifier, we can simply use the AP metric. To assess the quality of our model, we can compare it to a simple decision baseline. Let\u2019s take a random classifier as a baseline here that would predict half of the time 1 and half of the time 0 for the label.", "Such a classifier would have a precision of 4.3%, which corresponds to the proportion of positive observations. For every recall value the precision would stay the same, and this would lead us to an AP of 0.043. The AP of our model is approximately 0.35, which is more than 8 times higher than the AP of the random method. This means that our model has a good predictive power.", "It is completely possible to use only raw text as input for making predictions. The most important thing is to be able to extract the relevant features from this raw source of data. This kind of data can often come as a good complementary source in data science projects in order to extract more learning features and increase the predictive power of the models.", "Here is the link to the original Jupyter notebook on Github:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist with 4 years of experience in various fields. https://www.linkedin.com/in/jonathanoheix/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd8b36134dc7e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jo879344?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jo879344?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": "Jonathan Oheix"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2e8e06482696&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&user=Jonathan+Oheix&userId=2e8e06482696&source=post_page-2e8e06482696----d8b36134dc7e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8b36134dc7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8b36134dc7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@thoughtcatalog?utm_source=medium&utm_medium=referral", "anchor_text": "Thought Catalog"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/jiashenliu/515k-hotel-reviews-data-in-europe", "anchor_text": "https://www.kaggle.com/jiashenliu/515k-hotel-reviews-data-in-europe"}, {"url": "https://github.com/jonathanoheix/Sentiment-analysis-with-hotel-reviews", "anchor_text": "jonathanoheix/Sentiment-analysis-with-hotel-reviewsSentiment analysis and text classification with Python - jonathanoheix/Sentiment-analysis-with-hotel-reviewsgithub.com"}, {"url": "https://www.kaggle.com/jonathanoheix/sentiment-analysis-with-hotel-reviews/", "anchor_text": "Sentiment analysis with hotel reviews | Kagglewww.kaggle.com"}, {"url": "https://www.linkedin.com/in/jonathanoheix/", "anchor_text": "https://www.linkedin.com/in/jonathanoheix/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d8b36134dc7e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----d8b36134dc7e---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----d8b36134dc7e---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d8b36134dc7e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/text-mining?source=post_page-----d8b36134dc7e---------------text_mining-----------------", "anchor_text": "Text Mining"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd8b36134dc7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&user=Jonathan+Oheix&userId=2e8e06482696&source=-----d8b36134dc7e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd8b36134dc7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&user=Jonathan+Oheix&userId=2e8e06482696&source=-----d8b36134dc7e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8b36134dc7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd8b36134dc7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d8b36134dc7e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d8b36134dc7e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jo879344?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jo879344?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jonathan Oheix"}, {"url": "https://medium.com/@jo879344/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "253 Followers"}, {"url": "https://www.linkedin.com/in/jonathanoheix/", "anchor_text": "https://www.linkedin.com/in/jonathanoheix/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2e8e06482696&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&user=Jonathan+Oheix&userId=2e8e06482696&source=post_page-2e8e06482696--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa627ef796d52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-bad-customer-reviews-with-nlp-d8b36134dc7e&newsletterV3=2e8e06482696&newsletterV3Id=a627ef796d52&user=Jonathan+Oheix&userId=2e8e06482696&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}