{"url": "https://towardsdatascience.com/finding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370", "time": 1682993831.1033258, "path": "towardsdatascience.com/finding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370/", "webpage": {"metadata": {"title": "Finding Similar Quora Questions with BOW, TFIDF and Xgboost | by Susan Li | Towards Data Science", "h1": "Finding Similar Quora Questions with BOW, TFIDF and Xgboost", "description": "Quora is a question-and-answer website where questions are asked, answered, edited, and organized by its community of users in the form of opinions. In September 2018, Quora reported hitting 300\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Quora", "anchor_text": "Quora is a question-and-answer website where questions are asked, answered, edited, and organized by its community of users in the form of opinions", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Natural_language_processing", "anchor_text": "NLP", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Bag-of-words_model", "anchor_text": "BOW", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "TF-IDF", "paragraph_index": 3}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle", "paragraph_index": 4}, {"url": "https://blog.insightdatascience.com/always-start-with-a-stupid-model-no-exceptions-3a22314b9aaa", "anchor_text": "If we find that the performance it provides is not sufficient, then inspecting what the simple model is struggling with can help us choose a next approach", "paragraph_index": 4}, {"url": "https://www.kaggle.com/c/quora-question-pairs/data", "anchor_text": "The Quora duplicate questions public dataset", "paragraph_index": 5}, {"url": "https://www.kaggle.com/currie32/the-importance-of-cleaning-text", "anchor_text": "https://www.kaggle.com/currie32/the-importance-of-cleaning-text", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/multi-class-text-classification-with-scikit-learn-12f1e60e0a9f", "anchor_text": "classifying single texts", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "The tf\u2013idf", "paragraph_index": 13}, {"url": "https://medium.com/@actsusanli/finding-similar-quora-questions-with-word2vec-and-xgboost-1a19ad272c0d", "anchor_text": "word2vec and Xgboost model", "paragraph_index": 18}, {"url": "https://medium.com/@actsusanli/finding-similar-quora-questions-with-word2vec-and-xgboost-1a19ad272c0d", "anchor_text": "the next article", "paragraph_index": 18}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/BOW_TFIDF_Xgboost_update.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 19}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/BOW_TFIDF_Xgboost_update.ipynb", "anchor_text": "Github", "paragraph_index": 19}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/", "paragraph_index": 21}], "all_paragraphs": ["Quora is a question-and-answer website where questions are asked, answered, edited, and organized by its community of users in the form of opinions.", "In September 2018, Quora reported hitting 300 million monthly users. With over 300 million people visit Quora every month, it\u2019s no surprise that many people ask duplicated questions, that is, questions that have same intent. For example, questions like \u201cHow can I be a good geologist?\u201d and \u201cWhat should I do to be a great geologist?\u201d are duplicate questions because they all have the same intent and should be answered once and once only.", "Quora tries very hard to eliminate duplicate questions, but NLP is a very hard problem. With so many ways to describe one and the same meaning, just look at the examples above. Quora users have provided great help that merged similar questions like so:", "In this post, we will develop a machine learning and NLP system to classify whether question pairs are duplicates or not and we start from a model that is BOW or TF-IDF with Xgboost.", "BOW and TF-IDF are two of the most common methods people use in information retrieval. Generally speaking, SVMs and Naive Bayes are more common for classification problem, however, because their accuracy is dependent of the training data, Xgboost provided the best accuracy in this particular data set. XGBoost is a gradient boosting framework that has become massively popular, especially in the Kaggle community. Therefore, I decided to use this model as a baseline model, because it is simple to set up, easy to understand and has a reasonable chance of providing decent results. Our baseline model will allow us to get a quick performance benchmark. If we find that the performance it provides is not sufficient, then inspecting what the simple model is struggling with can help us choose a next approach.", "The Quora duplicate questions public dataset contains over 400K pairs of Quora questions. In our experiments we split the data randomly into 70% of train examples and 30% of test examples.", "The classes are not perfectly balanced, but it is not bad, we are not going to balance them.", "Before cleaning the text, we preview a few question pairs to determine how to clean them.", "You may have noticed that we have off a lot work to do in terms of text cleaning. After some inspections, a few tries and ideas from https://www.kaggle.com/currie32/the-importance-of-cleaning-text, I decided to clean the text as follows:", "After cleaning text, we preview those question pairs again.", "We are well experienced in classifying single texts for some time \u2014 but the ability to accurately model the relationships between texts is relative new. Here I use Panda's concatfunction to concatenate two text objects features from question1 and question2 into one. The scipy.sparse.hstackis used to stack sparse matrices horizontally (column wise).", "This following strategy (CountVectorizer) is called the Bag of Words. Documents are described by word occurrences while completely ignoring the relative position information of the words in the document. It tokenizes the documents and counts the occurrences of token and return them as a sparse matrix.", "The Xgboost was used with the following parameters, selected based on the performance from the validation data:", "The tf\u2013idf is the product of two statistics, term frequency and inverse document frequency, it is one of the most popular term-weighting schemes today.", "we apply tf-idf normalization to a sparse matrix of occurrence counts, from word level, n-gram level and character level.", "A subtle point about feature engineering is that it requires knowing feature statistics that we most likely do not know in practice. In order to compute the tf-idf representation, we have to compute the inverse document frequencies based on the training data and use these statistics to scale both the training and test data. In scikit-learn, fitting the feature transformer on the training data amounts to collecting the relevant statistics. The fitted transformer can then be applied to the test data.", "Our highest validation score is 0.80, not bad at all for starters!", "So far our best Xgboost model is character level TF-IDF+Xgboost, the recall of duplicate questions, that is, the proportion of duplicate questions that our model is able to detect over the total amount of duplicate questions is 0.67. And this is crucial for the problem at hand, we want to detect and eliminate as many duplicate questions as possible.", "With this in mind, we will develop a word2vec and Xgboost model to see whether this result can be improved, which will be the next article.", "Jupyter notebook for this post can be found on Github. Happy weekend!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Changing the world, one post at a time. Sr Data Scientist, Toronto Canada. https://www.linkedin.com/in/susanli/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc54ad88d1370&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://actsusanli.medium.com/?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": "Susan Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a----c54ad88d1370---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc54ad88d1370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc54ad88d1370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Quora", "anchor_text": "Quora is a question-and-answer website where questions are asked, answered, edited, and organized by its community of users in the form of opinions"}, {"url": "https://en.wikipedia.org/wiki/Natural_language_processing", "anchor_text": "NLP"}, {"url": "https://en.wikipedia.org/wiki/Bag-of-words_model", "anchor_text": "BOW"}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "TF-IDF"}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle"}, {"url": "https://blog.insightdatascience.com/always-start-with-a-stupid-model-no-exceptions-3a22314b9aaa", "anchor_text": "If we find that the performance it provides is not sufficient, then inspecting what the simple model is struggling with can help us choose a next approach"}, {"url": "https://www.kaggle.com/c/quora-question-pairs/data", "anchor_text": "The Quora duplicate questions public dataset"}, {"url": "https://www.kaggle.com/currie32/the-importance-of-cleaning-text", "anchor_text": "https://www.kaggle.com/currie32/the-importance-of-cleaning-text"}, {"url": "https://towardsdatascience.com/multi-class-text-classification-with-scikit-learn-12f1e60e0a9f", "anchor_text": "classifying single texts"}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "The tf\u2013idf"}, {"url": "https://medium.com/@actsusanli/finding-similar-quora-questions-with-word2vec-and-xgboost-1a19ad272c0d", "anchor_text": "word2vec and Xgboost model"}, {"url": "https://medium.com/@actsusanli/finding-similar-quora-questions-with-word2vec-and-xgboost-1a19ad272c0d", "anchor_text": "the next article"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/BOW_TFIDF_Xgboost_update.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/BOW_TFIDF_Xgboost_update.ipynb", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c54ad88d1370---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----c54ad88d1370---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----c54ad88d1370---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/quora?source=post_page-----c54ad88d1370---------------quora-----------------", "anchor_text": "Quora"}, {"url": "https://medium.com/tag/text-mining?source=post_page-----c54ad88d1370---------------text_mining-----------------", "anchor_text": "Text Mining"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc54ad88d1370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&user=Susan+Li&userId=731d8566944a&source=-----c54ad88d1370---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc54ad88d1370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&user=Susan+Li&userId=731d8566944a&source=-----c54ad88d1370---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc54ad88d1370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc54ad88d1370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c54ad88d1370---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c54ad88d1370--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c54ad88d1370--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c54ad88d1370--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c54ad88d1370--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Susan Li"}, {"url": "https://actsusanli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27K Followers"}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f2b19329694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-similar-quora-questions-with-bow-tfidf-and-random-forest-c54ad88d1370&newsletterV3=731d8566944a&newsletterV3Id=1f2b19329694&user=Susan+Li&userId=731d8566944a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}