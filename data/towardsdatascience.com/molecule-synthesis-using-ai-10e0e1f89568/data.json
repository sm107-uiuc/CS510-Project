{"url": "https://towardsdatascience.com/molecule-synthesis-using-ai-10e0e1f89568", "time": 1683000603.30752, "path": "towardsdatascience.com/molecule-synthesis-using-ai-10e0e1f89568/", "webpage": {"metadata": {"title": "Molecule synthesis using AI. Step by step guide to use GAN in search\u2026 | by Neeraj jain | Towards Data Science", "h1": "Molecule synthesis using AI", "description": "Molecule synthesis is a process of constructing complex chemical molecules from simple precursors. This is the key to the development of next generation medicines, smart materials, pesticides and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://mlpds.mit.edu/", "anchor_text": "Machine Learning for Pharmaceutical Discovery and Synthesis Consortium", "paragraph_index": 2}, {"url": "https://medium.com/@MITIBMLab/can-ai-create-molecules-324c140981e6", "anchor_text": "Can AI Create molecules?", "paragraph_index": 2}, {"url": "https://medium.com/u/a0a8fdb128d4?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "MIT-IBM Watson AI Lab", "paragraph_index": 2}, {"url": "https://pubchem.ncbi.nlm.nih.gov/", "anchor_text": "PubChem", "paragraph_index": 3}, {"url": "https://github.com/neeraj-j/molecules", "anchor_text": "github", "paragraph_index": 3}, {"url": "https://arxiv.org/abs/1710.10196", "anchor_text": "PGAN", "paragraph_index": 4}, {"url": "https://github.com/facebookresearch/pytorch_GAN_zoo", "anchor_text": "pytorch_GAN_zoo", "paragraph_index": 4}, {"url": "https://drive.google.com/drive/folders/16Fetqo9rbWu_vKy6Tqy-Zmxpb_AKYbTy?usp=sharing", "anchor_text": "link", "paragraph_index": 11}, {"url": "https://arxiv.org/abs/1906.11613v1", "anchor_text": "paper", "paragraph_index": 11}, {"url": "https://hal.inria.fr/hal-01850447/document", "anchor_text": "paper", "paragraph_index": 15}, {"url": "https://arxiv.org/abs/1906.11661", "anchor_text": "Inspirational Adverserial Image generation", "paragraph_index": 16}, {"url": "https://arxiv.org/abs/1711.05772", "anchor_text": "LC GAN", "paragraph_index": 19}, {"url": "https://medium.com/u/a0a8fdb128d4?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "MIT-IBM Watson AI Lab", "paragraph_index": 19}], "all_paragraphs": ["Molecule synthesis is a process of constructing complex chemical molecules from simple precursors. This is the key to the development of next generation medicines, smart materials, pesticides and electronics. Hitherto molecule synthesis is a manual, costly, time consuming, multi-step process. It is guided mainly by chemical intuition and a sound knowledge of chemical reactions. Artificial Intelligence (AI) has potential to make any molecule at will, inexpensively and on a meaningful timescale that will unlock unimagined opportunities for future scientific advancement.", "Generative adversarial nets (GAN) is an AI model that consists of a \u2018Generator\u2019 and a \u2018Discriminator\u2019. Generator captures the training data distribution and generates samples from it. Discriminator estimates the probability of sample coming from the Generator rather than training data. This two-player game is played till the probability of discriminator making error is maximized.", "In this article, I will demonstrate how a GAN can be trained to generate molecular structures. This is the first step in automating molecule syntheses. Similar work is being done by Machine Learning for Pharmaceutical Discovery and Synthesis Consortium (Can AI Create molecules? by MIT-IBM Watson AI Lab). I am taking this example to accentuate the ease with which any individual can use AI to perform cutting edge research. The only limiting factor is imagination.", "The first step in any artificial intelligence (AI) project is data. There are multiple websites containing chemical database in various formats. PubChem contains a list of ~96M chemical compounds in SMILES notation. SMILES notation can be classified into functional groups and converted into molecular structure images using python rdkit library. Out of 52 functional groups, only Alcohol Aliphatic functional group was used to limit the scope of this work. First 50,000 compounds from Alcohol Aliphatic group were converted into images of size 128x128. The code to categorize and convert SMILES entries into images is available at github.", "Next step was to select the GAN model. After a few failed attempts, I selected Progressive GAN\u2019s (PGAN) pytorch implementation by facebook research (pytorch_GAN_zoo). Novelty of Progressive GAN is that it starts training with images at low resolution and add new layers that introduce higher-resolution details as the training progresses. According to its authors, these characteristics of PGAN makes it more stable and faster to train.", "First step in training was to clone the pytorch_GAN_zoo:", "The training process for PGAN is slightly different than other GANs. Before starting the training, data has to be resized into low resolution images. This is done by giving the following command:", "In this command, \u201cceleba\u201d is the name of pre-trainned dataset. pytorch_GAN_zoo has multiple dataset pre-trainned on this model. \u201cceleba\u201d dataset corresponds to images of 128x128 pixel, which is same as size of images used in this project. Unless user is a hyper-parameter wizard, it is advisable to adapt data to the hyper-parameters of the pre-trainned model rather than tuning hyper parameters according to data. After first run, hyper-parameters can be changed to fine tune the model. Following Table contains the pre-trainned model names and supported image sizes.", "Datasets.py will also generate a config file. This config file will contain 1) path to the resized images and the original images. 2) number of iterations per scale. \u2018Scale\u2019 is a concept that is unique to PGAN. Every scale is associated with number of layers in the model, iterations and image resolution. Max scale is calculated using following formula.", "In this formula constant 2 is added to max scale because the training layers start from resolution of 4x4. Datasets.py will resize images in steps of (64, 128, 512, 1024) until the image size of the data. \u201c$PATH_TO_IMAGES\u201d is the location of the training images. \u201cOUTPUT_DIR\u201d this is the location where resized images will be saved. \u201c-f\u201d option is to generate resized images before training starts. Once the resize images and config file is created, next step was to start training by giving the following command:", "In this command, \u201cPGAN\u201d refers to Progressive GAN. pytorch_GAN_zoo also support DCGAN. \u201dCONFIG_FILE\u201d is the path to config file generated by datasets.py. \u201cDATASET_NAME\u201d is the name of custom dataset. \u201cWEIGHTS_DIR\u201d is the location where weights will be stored. More options are defined in train.py. I had used \u201c \u2014 np_vis\u201d option to use numpy based visualization instead of installing \u201cvisdom\u201d package. I had also set \u201c-e\u201d and \u201c-s\u201d option to 2000.", "This training went on for 9 days on Tesla K80 based server. I stopped the training after 62000 iterations on last scale. Weights of the trained model can be downloaded using this link. One of the main reason GAN training takes long time is due to lack of transfer learning in generative models. Transfer learning reduces the data requirement and convergence time in discriminative models. There is a recent paper that propose to address this issue in GANs. One way of reducing training time is to use minimum sized images relevant to data.", "In PGAN, training layer starts from 4x4 resolution and goes up to image size of the dataset. For image size of 128, layers were added in the scale of 4,8,16,32,64,128. Plotting training time vs iterations clearly show how addition of new layer increased the training time exponentially at every scale.", "The video below shows training progress. Most of the refinement in generated images happened during last scale. This video was created by stitching evaluation images that were saved after every 2000 iterations.", "pytorch_GAN_zoo provides tools to evaluate the performance of the model on generated images. Most popular one is inception score. Inception score of generated images was calculated by giving following command.", "Sliced Wasserstein distance (SWD) is another method used to evaluate high-resolution GANs. laplacian SWD score was calculated by giving following command. More information about evaluating GAN performance is given in this paper.", "pytorch_GAN_zoo implements another tool, \u201cInspirational Adverserial Image generation\u201d. This tool takes an image as input and extracts an input vector using gradient decent. This input vector is used to generate new images that share characteristics of the input image. Inspirational generation is a two step process.", "In this command vgg16/vgg19 specify model to be used for input vector generation. Once the feature extractor was downloaded, following command was used to generate molecule structure based on", "Image below shows input and generated molecule structures. It is admirable how well ProGAN had learned input vector and generated pattern.", "The model trained above will generate random molecular structures. This work can be easily extended by using LC GAN to generate molecules with certain attributes by constraining the latent space of a Variational Autoencoder (VAE) with a separate GAN trained in latent space. This model can also be trained on 3D molecular structures. Output of this model can be fed to another model that can validate and predict the properties of the generated molecular structures. All these methods are currently being pursued by MIT-IBM Watson AI Lab.", "Due to open accessibility to information, data and resources any individual can pursue the research for new technologies.", "I am indebted to open source communities on whose work and knowledge this article depend. I thank Preeti Gupta, professor of Chemistry, for giving me crash course in functional group classification.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F10e0e1f89568&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nee-neer.medium.com/?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": ""}, {"url": "https://nee-neer.medium.com/?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "Neeraj jain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97014f1e61d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&user=Neeraj+jain&userId=97014f1e61d5&source=post_page-97014f1e61d5----10e0e1f89568---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F10e0e1f89568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F10e0e1f89568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://mlpds.mit.edu/", "anchor_text": "Machine Learning for Pharmaceutical Discovery and Synthesis Consortium"}, {"url": "https://medium.com/@MITIBMLab/can-ai-create-molecules-324c140981e6", "anchor_text": "Can AI Create molecules?"}, {"url": "https://medium.com/u/a0a8fdb128d4?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "MIT-IBM Watson AI Lab"}, {"url": "https://pubchem.ncbi.nlm.nih.gov/", "anchor_text": "PubChem"}, {"url": "https://github.com/neeraj-j/molecules", "anchor_text": "github"}, {"url": "https://arxiv.org/abs/1710.10196", "anchor_text": "PGAN"}, {"url": "https://github.com/facebookresearch/pytorch_GAN_zoo", "anchor_text": "pytorch_GAN_zoo"}, {"url": "https://github.com/facebookresearch/pytorch_GAN_zoo.git", "anchor_text": "https://github.com/facebookresearch/pytorch_GAN_zoo.git"}, {"url": "https://drive.google.com/drive/folders/16Fetqo9rbWu_vKy6Tqy-Zmxpb_AKYbTy?usp=sharing", "anchor_text": "link"}, {"url": "https://arxiv.org/abs/1906.11613v1", "anchor_text": "paper"}, {"url": "https://hal.inria.fr/hal-01850447/document", "anchor_text": "paper"}, {"url": "https://arxiv.org/abs/1906.11661", "anchor_text": "Inspirational Adverserial Image generation"}, {"url": "https://arxiv.org/abs/1711.05772", "anchor_text": "LC GAN"}, {"url": "https://medium.com/u/a0a8fdb128d4?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "MIT-IBM Watson AI Lab"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----10e0e1f89568---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/gans?source=post_page-----10e0e1f89568---------------gans-----------------", "anchor_text": "Gans"}, {"url": "https://medium.com/tag/molecule-synthesis?source=post_page-----10e0e1f89568---------------molecule_synthesis-----------------", "anchor_text": "Molecule Synthesis"}, {"url": "http://creativecommons.org/licenses/by/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F10e0e1f89568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&user=Neeraj+jain&userId=97014f1e61d5&source=-----10e0e1f89568---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F10e0e1f89568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&user=Neeraj+jain&userId=97014f1e61d5&source=-----10e0e1f89568---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F10e0e1f89568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F10e0e1f89568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----10e0e1f89568---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----10e0e1f89568--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----10e0e1f89568--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----10e0e1f89568--------------------------------", "anchor_text": ""}, {"url": "https://nee-neer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nee-neer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Neeraj jain"}, {"url": "https://nee-neer.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F97014f1e61d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&user=Neeraj+jain&userId=97014f1e61d5&source=post_page-97014f1e61d5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8ee6c72e0a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecule-synthesis-using-ai-10e0e1f89568&newsletterV3=97014f1e61d5&newsletterV3Id=8ee6c72e0a4&user=Neeraj+jain&userId=97014f1e61d5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}