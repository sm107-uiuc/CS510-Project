{"url": "https://towardsdatascience.com/dog-breed-identification-e3c6d6b4be84", "time": 1682994345.179967, "path": "towardsdatascience.com/dog-breed-identification-e3c6d6b4be84/", "webpage": {"metadata": {"title": "What Dog Breed is That?. Determining the breed of a dog using\u2026 | by Utkarsh Chawla | Towards Data Science", "h1": "What Dog Breed is That?", "description": "I participated in this playground kaggle competition where the goal was to create a classifier capable of determining a dog\u2019s breed from a photo. The dataset comprises 120 breeds of dog. The\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/dog-breed-identification", "anchor_text": "kaggle competition", "paragraph_index": 0}, {"url": "https://github.com/facebookresearch/ResNeXt", "anchor_text": "ResNeXt-50", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1506.01186", "anchor_text": "Cyclical Learning Rates for Training Neural Networks", "paragraph_index": 7}], "all_paragraphs": ["I participated in this playground kaggle competition where the goal was to create a classifier capable of determining a dog\u2019s breed from a photo. The dataset comprises 120 breeds of dog. The following graph shows that the number of dogs in each breed lies between 60 and 130.", "We will be using a pre-trained model built on the ResNeXt-50 network architecture. This model was trained on ImageNet Database comprising 1.2 million images distributed among 1000 classes.", "The most important thing one can do to improve a DL model is to give it more data. If you keep training your model for some time, it will start to overfit.", "Overfitting means that the model is learning to recognize the specific images in the training set rather than learning something general that can be transferred across to the validation set.If your training set loss is significantly lower than your validation set loss, the model is overfitting. It is unable to reproduce the high accuracy in the validation set and thus, it will perform equally as bad in the test set.", "One way to fix overfitting is effectively to feed more data to the model. We can collect more data, but another easier way is data augmentation. This refers to randomly changing the images in ways that shouldn\u2019t impact their interpretation such as flipping horizontally and vertically, zooming in and out, varying contrast and brightness, and many more.", "The learning rate determines how quickly or how slowly you want to update the weights (or parameters) with the help of gradient descent. Learning rate is one of the most difficult parameters to set because it significantly affects model performance.", "If the learning rate is too small, gradient descent can be very slow. On the other hand, if the learning rate is too large, gradient descent can overshoot the minimum. It may fail to converge, or even diverge.", "In order to find the optimal learning rate, we will use the technique developed by Leslie N. Smith in the 2015 paper Cyclical Learning Rates for Training Neural Networks.", "The idea is to keep increasing the learning rate exponentially until the loss stops decreasing.", "Initially, when the learning rate is small, the loss doesn\u2019t improve much. As the learning rate increases, the loss will improve considerably for a while until the rate becomes too large and the loss shoots up. This happens because as the learning rate becomes too large, we start diverging from the minima.", "We need to select a point on the graph with the fastest decrease in the loss. In this example, the loss function decreases fast when the learning rate is between 0.01 and 0.1.", "This is closely related to the idea of learning rate annealing", "As you get closer and closer to the spot with minimum loss, you should start decreasing the learning rate in order to get to exactly the right spot. This idea of decreasing the learning rate as you train is called learning rate annealing.", "The \u201chacky\u201d way to implement this would be step-wise annealing, that is to use a particular learning rate for a while and manually decrease it when the loss stops improving.A significantly better approach is to use a functional form. One half of a cosine curve seems to be a perfect fit. It maintains a high learning rate for a while and then drops down quickly when you get closer to the minima.", "SGDR comes into picture when we want to prevent getting stuck in local minima of a function. Getting stuck in a local minimal means that we are not in a very resilient part of the weight space due to which small changes in weights might lead to big changes in the loss. So the technique used in SGDR increases our model\u2019s ability to find the global minima of the function.", "The basic idea is to reset our learning rate after a certain number of iterations so that we can pop out of the local minima if we appear to be stuck. In practice, this has proved to be a significant improvement over the normal SGD.", "If the cycle length is too short, we are not giving SGD enough time to find the minima. we need a way to lengthen the time spent decreasing our learning rate. Instead of restarting after a certain number of iterations, we can lengthen the number of iterations in a multiplicative fashion.", "As mentioned earlier we are using a pre-trained model. This means that we are just adding some layers on top of the pre-trained model and training only the newly added layers known as the dense layers. This is a type of transfer learning.", "Transfer learning is the process of using the knowledge learned in one process/activity and applying it to a different task.", "We can improve our model by training on the convolution layers along with the dense layers. Although, we don\u2019t need to change the earlier convolution layers as much as the later dense layers. This is the foundation of differential learning rates.", "Differential learning rates means to have different learning rates for different parts of the network during our training. The idea is to divide the layers into various layer groups and set different learning rate for each group so that we get ideal results.", "Layers in red learn basic features like edges, shapes and the middle blue layers learn specific details with respect to the dataset on which it is trained.", "Given the above statement, it\u2019s not a good idea to change the learned weights on the initial layers too much because they are already good at what they are supposed to do (detecting the features like edges etc). Middle layers will have knowledge of the complex features that might help our task to some extent if we slightly modify them. So, we want to finetune them a little.", "Differential learning rates help us in this regard. We can now imagine a sample network into three layer groups (red, blue and green) and set different learning rates. The initial red layers will have small learning rate as we don\u2019t want to disturb them much, the middle blue layers will have learning rate higher than initial layers and the final green layers will be having the highest learning rate that\u2019s optimal.", "How less/more the learning rates for initial and middle layers depends on the data correlation between the pre-trained model and our required model. For example, if the task is to create a dog/cat classifier and our pre-trained model is already good at recognizing cats, then we can use learning rates of less magnitude. But if our task is to create some model on satellite imagery/medical imagery then we will have learning rates of slightly higher magnitude.", "During the testing phase, all our test images are automatically cropped to a square as they are passed through our model. The reason for this is kind of a minor technical detail, but GPU is not able to perform efficiently if you have different dimensions for images. This may be fixed in the future but for now, that is the state of the technology we have.This might lead to omitting of some very important characteristics of the image which are crucial for its accurate prediction.In Test Time Augmentation, we are going to take 4 data augmentations at random as well as the un-augmented original (center-cropped). We will then calculate predictions for all these images, take the average, and make that our final prediction. This ensures that we capture the whole picture within these 5 different squares.", "Using the above practices, I was able to achieve a 92.6% accuracy on the validation set i.e the pictures that the model had not seen before.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3c6d6b4be84&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@utkarshchawla691?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@utkarshchawla691?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": "Utkarsh Chawla"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fceca127ffa33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&user=Utkarsh+Chawla&userId=ceca127ffa33&source=post_page-ceca127ffa33----e3c6d6b4be84---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c6d6b4be84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c6d6b4be84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/dog-breed-identification", "anchor_text": "kaggle competition"}, {"url": "https://github.com/facebookresearch/ResNeXt", "anchor_text": "ResNeXt-50"}, {"url": "https://arxiv.org/abs/1506.01186", "anchor_text": "Cyclical Learning Rates for Training Neural Networks"}, {"url": "http://fast.ai", "anchor_text": "fast.ai"}, {"url": "https://medium.com/38th-street-studios/exploring-stochastic-gradient-descent-with-restarts-sgdr-fa206c38a74e", "anchor_text": "https://medium.com/38th-street-studios/exploring-stochastic-gradient-descent-with-restarts-sgdr-fa206c38a74e"}, {"url": "https://towardsdatascience.com/transfer-learning-using-differential-learning-rates-638455797f00", "anchor_text": "https://towardsdatascience.com/transfer-learning-using-differential-learning-rates-638455797f00"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e3c6d6b4be84---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e3c6d6b4be84---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e3c6d6b4be84---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----e3c6d6b4be84---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----e3c6d6b4be84---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3c6d6b4be84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&user=Utkarsh+Chawla&userId=ceca127ffa33&source=-----e3c6d6b4be84---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3c6d6b4be84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&user=Utkarsh+Chawla&userId=ceca127ffa33&source=-----e3c6d6b4be84---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c6d6b4be84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe3c6d6b4be84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e3c6d6b4be84---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e3c6d6b4be84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@utkarshchawla691?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@utkarshchawla691?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Utkarsh Chawla"}, {"url": "https://medium.com/@utkarshchawla691/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fceca127ffa33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&user=Utkarsh+Chawla&userId=ceca127ffa33&source=post_page-ceca127ffa33--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fceca127ffa33%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdog-breed-identification-e3c6d6b4be84&user=Utkarsh+Chawla&userId=ceca127ffa33&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}