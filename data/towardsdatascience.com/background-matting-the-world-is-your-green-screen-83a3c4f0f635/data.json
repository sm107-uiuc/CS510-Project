{"url": "https://towardsdatascience.com/background-matting-the-world-is-your-green-screen-83a3c4f0f635", "time": 1683005574.27563, "path": "towardsdatascience.com/background-matting-the-world-is-your-green-screen-83a3c4f0f635/", "webpage": {"metadata": {"title": "Background Matting: The World is Your Green Screen | by Vivek Jayaram | Towards Data Science", "h1": "Background Matting: The World is Your Green Screen", "description": "Do you wish that you could make professional quality videos without a full studio? Or that Zoom\u2019s virtual background function worked better during your video conferences? Our recently published paper\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/2004.00626", "anchor_text": "paper", "paragraph_index": 1}, {"url": "https://grail.cs.washington.edu/projects/background-matting/", "anchor_text": "project page", "paragraph_index": 2}, {"url": "https://github.com/senguptaumd/Background-Matting", "anchor_text": "codebase", "paragraph_index": 2}, {"url": "http://www.vivekjayaram.com", "anchor_text": "reach out to me", "paragraph_index": 27}, {"url": "https://homes.cs.washington.edu/~soumya91/", "anchor_text": "Soumyadip Sengupta", "paragraph_index": 27}, {"url": "https://arxiv.org/abs/1802.02611", "anchor_text": "Encoder-Decoder with Atrous Separable Convolution for Semantic Image Segmentation", "paragraph_index": 28}, {"url": "https://arxiv.org/abs/1909.09725", "anchor_text": "Context-Aware Image Matting for Simultaneous Foreground and Alpha Estimation", "paragraph_index": 29}], "all_paragraphs": ["Do you wish that you could make professional quality videos without a full studio? Or that Zoom\u2019s virtual background function worked better during your video conferences?", "Our recently published paper [1] in CVPR 2020 provides a new and easy method to replace your background for a wide variety of applications. You can do this at home in everyday settings, using a fixed or handheld camera. Our method is also state-of-the-art and gives outputs comparable to professional results. In this article we walk through the motivation, technical details, and usage tips for our method.", "You can also checkout out our project page and codebase.", "Matting is the process of separating an image into foreground and background so you can composite the foreground onto a new background. This is the key technique behind the green screen effect, and it is widely used in video production, graphics, and consumer apps. To model this problem, we represent every pixel in the captured image as a combination of foreground and background:", "Our problem is to solve for the foreground (F), background (B), and transparency (alpha) for every pixel given a captured image (C). Clearly this is highly undetermined, and since images have RGB channels, this requires solving 7 unknowns from 3 observed values.", "One possible approach is to use segmentation to separate foreground for compositing. Although segmentation has made huge strides in recent years, it does not solve the full matting equation. Segmentation assigns a binary (0,1) label to each pixel in order to represent foreground and background instead of solving for a continuous alpha value. The effects of this simplification are visible in the following example:", "The areas around the edge, particularly in the hair, have a true alpha value between 0 and 1. Therefore, the binary nature of segmentation creates a harsh boundary around the foreground, leaving visible artifacts. Solving for the partial transparency and foreground color allows much better compositing in the second frame.", "Because matting is a harder problem than segmentation, additional information is often used to solve this unconstrained problem, even when using deep learning.", "Many existing methods [3][4][5] use a trimap, or a hand-annotated map of known foreground, background, and unknown regions. Although this is possible to do for an image, annotating video is extremely time consuming and is not a feasible research direction for this problem.", "We choose instead to use a captured background as an estimate of the true background. This makes it easier to solve for the foreground and alpha value. We call it a \u201ccasually captured\u201d background because it can contain slight movements, color differences, slight shadows, or similar colors as the foreground.", "The figure above shows how we can easily provide a rough estimate of the true background. As the person leaves the scene, we capture the background behind them. The figure below shows what this looks like:", "Notice how this image is challenging because it has a very similar background and foreground color (particularly around the hair). It was also recorded with a handheld phone and contains slight background movements.", "\u201cWe call it a casually captured background because it can contain slight movements, color differences, slight shadows, or similar colors as the foreground.\u201d", "Although our method works with some background perturbations, it is still better when the background is constant and best in indoor settings. For example, it does not work in the presence of highly noticeable shadows cast by the subject, moving backgrounds (e.g. water, cars, trees), or large exposure changes.", "We also recommend capturing the background by having the person leave the scene at the end of the video, and pulling that frame from the continuous video. Many phones have different zoom and exposure settings when you switch from video mode to photo mode. You should also enable auto-exposure lock when filming with a phone.", "A summary of the capture tips:", "Another natural question is whether this is like background subtraction. Firstly, if it were easy to use any background for compositing, the movie industry would not be spending thousands of dollars on green screens all these years.", "In addition, background subtraction does not solve for partial alpha values, giving the same hard edge as segmentation. It also does not work well when there is a similar foreground and background color or any motions in the background.", "The network consists of a supervised step followed by an unsupervised refinement. We\u2019ll briefly summarize them here, but for full details you can always check out the paper.", "In order to first train the network, we use the Adobe Composition-1k dataset, which contains 450 carefully annotated ground truth alpha mattes. We train the network in a fully supervised way, with a per pixel loss on the output.", "Notice that we take several inputs, including the image, background, soft segmentation, and temporal motion information. Our novel Context Switching Block also ensures robustness to poor inputs.", "The problem with supervised learning is that the adobe dataset only contains 450 ground truth outputs, which is not nearly enough to train a good network. Obtaining more data is extremely difficult because it involves hand-annotating the alpha matte of an image.", "To solve this problem, we use a GAN refinement step. We take the output alpha matte from the supervised network and composite it on a new background. The discriminator then tries to tell if it is a real or fake image. In response, the generator learns to update the alpha matte so the resulting composite is as real as possible in order to fool the discriminator.", "The important part here is that we don\u2019t need any labelled training data. The discriminator was trained with thousands of real images, which are very easy to obtain.", "What\u2019s also useful about the GAN is that you can train the generator on your own images to improve results at test time. Suppose you run the network and the output is not very good. You can update the weights of the generator on that exact data in order to better fool the discriminator. This will overfit to your data, but will improve the results on the images you provided.", "Although the results we see are quite good, we are continuing to make this method more accurate and easy to use.", "In particular, we would like to make this method more robust to circumstances like background motions, camera movements, shadows, etc. We are also looking at ways to make this method work in real-time and with less computational resource power. This could enable a wide variety of use cases in areas like video streaming or mobile apps.", "If you have any questions feel free to reach out to me, Vivek Jayaram, or Soumyadip Sengupta", "[2] L.C. Chen, Y. Zhu, G. Papandreou, F. Schroff, and H. Adam, Encoder-Decoder with Atrous Separable Convolution for Semantic Image Segmentation (2018), ECCV 2018", "[4] Q. Hou and F. Liu. Context-Aware Image Matting for Simultaneous Foreground and Alpha Estimation (2019), ICCV 2019", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Deep Learning Researcher in Audio and Vision"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F83a3c4f0f635&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vivjay30?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vivjay30?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": "Vivek Jayaram"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5100a2b33473&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&user=Vivek+Jayaram&userId=5100a2b33473&source=post_page-5100a2b33473----83a3c4f0f635---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83a3c4f0f635&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83a3c4f0f635&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/2004.00626", "anchor_text": "paper"}, {"url": "https://grail.cs.washington.edu/projects/background-matting/", "anchor_text": "project page"}, {"url": "https://github.com/senguptaumd/Background-Matting", "anchor_text": "codebase"}, {"url": "http://www.vivekjayaram.com", "anchor_text": "reach out to me"}, {"url": "https://homes.cs.washington.edu/~soumya91/", "anchor_text": "Soumyadip Sengupta"}, {"url": "https://grail.cs.washington.edu/projects/background-matting/", "anchor_text": "Background Matting: The World is Your Green Screen"}, {"url": "https://arxiv.org/abs/1802.02611", "anchor_text": "Encoder-Decoder with Atrous Separable Convolution for Semantic Image Segmentation"}, {"url": "https://grail.cs.washington.edu/projects/digital-matting/papers/cvpr2001.pdf", "anchor_text": "A Bayesian Approach to Digital Matting"}, {"url": "https://arxiv.org/abs/1909.09725", "anchor_text": "Context-Aware Image Matting for Simultaneous Foreground and Alpha Estimation"}, {"url": "https://arxiv.org/abs/1908.00672", "anchor_text": "Indices Matter: Learning to Index for Deep Image Matting"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----83a3c4f0f635---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----83a3c4f0f635---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/video-production?source=post_page-----83a3c4f0f635---------------video_production-----------------", "anchor_text": "Video Production"}, {"url": "https://medium.com/tag/gans?source=post_page-----83a3c4f0f635---------------gans-----------------", "anchor_text": "Gans"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----83a3c4f0f635---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83a3c4f0f635&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&user=Vivek+Jayaram&userId=5100a2b33473&source=-----83a3c4f0f635---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83a3c4f0f635&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&user=Vivek+Jayaram&userId=5100a2b33473&source=-----83a3c4f0f635---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83a3c4f0f635&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F83a3c4f0f635&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----83a3c4f0f635---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----83a3c4f0f635--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vivjay30?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vivjay30?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vivek Jayaram"}, {"url": "https://medium.com/@vivjay30/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "80 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5100a2b33473&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&user=Vivek+Jayaram&userId=5100a2b33473&source=post_page-5100a2b33473--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5b5c1a513a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackground-matting-the-world-is-your-green-screen-83a3c4f0f635&newsletterV3=5100a2b33473&newsletterV3Id=5b5c1a513a0&user=Vivek+Jayaram&userId=5100a2b33473&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}