{"url": "https://towardsdatascience.com/creating-your-own-object-detector-ad69dda69c85", "time": 1682994881.0764952, "path": "towardsdatascience.com/creating-your-own-object-detector-ad69dda69c85/", "webpage": {"metadata": {"title": "Creating your own object detector | by Gilbert Tanner | Towards Data Science", "h1": "Creating your own object detector", "description": "Object detection is the craft of detecting instances of a certain class, like animals, humans and many more in an image or video. The Tensorflow Object Detection API makes it easy to detect objects\u2026"}, "outgoing_paragraph_urls": [{"url": "https://blog.tensorflow.org/2020/07/tensorflow-2-meets-object-detection-api.html", "anchor_text": "supports Tensorflow 2", "paragraph_index": 0}, {"url": "https://gilberttanner.com/blog/tensorflow-object-detection-with-tensorflow-2-creating-a-custom-model", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://gilberttanner.com/blog/live-object-detection", "anchor_text": "my last article", "paragraph_index": 2}, {"url": "https://github.com/datitran/raccoon_dataset", "anchor_text": "Dat Tran\u2019s raccoon detector", "paragraph_index": 20}, {"url": "https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf1_detection_zoo.md", "anchor_text": "this", "paragraph_index": 31}, {"url": "https://gilberttanner.com/blog/live-object-detection", "anchor_text": "my last Tensorflow object detection tutorial", "paragraph_index": 46}], "all_paragraphs": ["Update 27.07.2020: The Tensorflow Object Detection API now officially supports Tensorflow 2. You can find a Tensorflow 2 version of this article here.", "Object detection is the craft of detecting instances of a certain class, like animals, humans and many more in an image or video.", "The Tensorflow Object Detection API makes it easy to detect objects by using pretrained object detection models, as explained in my last article.", "In this article, we will go through the process of training your own object detector for whichever objects you like. I chose to create an object detector which can distinguish between four different microcontrollers.", "This article is based on a video I made.", "In this article, we will go over all the steps needed to create our object detector from gathering the data all the way to testing our newly created object detector.", "You can install the TensorFlow Object Detection API either with Python Package Installer (pip) or Docker, an open-source platform for deploying and managing containerized applications. For running the Tensorflow Object Detection API locally, Docker is recommended. If you aren\u2019t familiar with Docker though, it might be easier to install it using pip.", "First clone the master branch of the Tensorflow Models repository:", "Note: The *.proto designating all files does not work protobuf version 3.5 and higher. If you are using version 3.5, you have to go through each file individually. To make this easier, I created a python script that loops through a directory and converts all proto files one at a time.", "If everything installed correctly you should see something like:", "Before we can get started creating the object detector we need data, which we can use for training.", "To train a robust classifier, we need a lot of pictures which should differ a lot from each other. So they should have different backgrounds, random object, and varying lighting conditions.", "You can either take the pictures yourself or you can download them from the internet. For my microcontroller detector, I took about 25 pictures of each individual microcontroller and 25 pictures containing multiple microcontrollers.", "These images are pretty big because they have a high resolution so we want to transform them to a lower scale so the training process is faster.", "I wrote a little script that makes it easy to transform the resolution of images.", "To use the script we need to save it in the parent directory of the images as something like transform_image_resolution.py and then go into the command line and type:", "Now that we have our images we need to move about 80 percent of the images into the object_detection/images/train directory and the other 20 percent in the object_detection/images/test directory.", "In order to label our data, we need some kind of image labeling software. LabelImg is a great tool for labeling images. It\u2019s also freely available on Github and prebuilts can be downloaded easily.", "After downloading and opening LabelImg you can open the training and testing directory using the \u201cOpen Dir\u201d button.", "To create the bounding box the \u201cCreate RectBox\u201d button can be used. After creating the bounding box and annotating the image you need to click save. This process needs to be repeated for all images in the training and testing directory.", "With the images labeled, we need to create TFRecords that can be served as input data for training of the object detector. In order to create the TFRecords we will use two scripts from Dat Tran\u2019s raccoon detector. Namely the xml_to_csv.py and generate_tfrecord.py files.", "After downloading both scripts we can first of change the main method in the xml_to_csv file so we can transform the created xml files to csv correctly.", "Now we can transform our xml files to csvs by opening the command line and typing:", "These creates two files in the images directory. One called test_labels.csv and another one called train_labels.csv.", "Before we can transform the newly created files to TFRecords we need to change a few lines in the generate_tfrecords.py file.", "If you are using a different dataset you need to replace the class-names with your own.", "Now the TFRecords can be generated by typing:", "These two commands generate a train.record and a test.record file which can be used to train our object detector.", "The last thing we need to do before training is to create a label map and a training configuration file.", "The label map maps an id to a name. We will put it in a folder called training, which is located in the object_detection directory. The labelmap for my detector can be seen below.", "The id number of each item should match the id of specified in the generate_tfrecord.py file.", "Now we need to create a training configuration file. Because as my model of choice I will use faster_rcnn_inception, which just like a lot of other models can be downloaded from this page I will start with a sample config (faster_rcnn_inception_v2_pets.config), which can be found in the sample folder.", "First of I will copy the file into the training folder and then I will open it using a text editor in order to change a few lines in the config.", "Line 9: change the number of classes to number of objects you want to detect (4 in my case)", "Line 106: change fine_tune_checkpoint to the path of the model.ckpt file:", "Line 123: change input_path to the path of the train.records file:", "Line 135: change input_path to the path of the test.records file:", "Line 130: change num_example to the number of images in your test folder.", "To train the model we will use the train.py file, which is located in the object_detection/legacy folder. We will copy it into the object_detection folder and then we will open a command line and type:", "Update: Use the model_main file in the object_detection folder instead", "If everything was setup correctly the training should begin shortly.", "About every 5 minutes the current loss gets logged to Tensorboard. We can open Tensorboard by opening a second command line, navigating to the object_detection folder and typing:", "This will open a webpage at localhost:6006.", "You should train the model until it reaches a satisfying loss. The training process can then be terminated by pressing Ctrl+C.", "Now that we have a trained model we need to generate an inference graph, which can be used to run the model. For doing so we need to first of find out the highest saved step number. For this, we need to navigate to the training directory and look for the model.ckpt file with the biggest index.", "Then we can create the inference graph by typing the following command in the command line.", "In order to test our newly created object detector, we can use the code from my last Tensorflow object detection tutorial. We only need to replace the fourth code cell.", "Now we can run all the cells and we will see a new window with a camera stream opening.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fad69dda69c85&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gilberttanner?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gilberttanner?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": "Gilbert Tanner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb986eefd54ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&user=Gilbert+Tanner&userId=b986eefd54ba&source=post_page-b986eefd54ba----ad69dda69c85---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://blog.tensorflow.org/2020/07/tensorflow-2-meets-object-detection-api.html", "anchor_text": "supports Tensorflow 2"}, {"url": "https://gilberttanner.com/blog/tensorflow-object-detection-with-tensorflow-2-creating-a-custom-model", "anchor_text": "here"}, {"url": "https://gilberttanner.com/blog/live-object-detection", "anchor_text": "my last article"}, {"url": "https://github.com/tensorflow/models.git", "anchor_text": "https://github.com/tensorflow/models.git"}, {"url": "https://github.com/tzutalin/labelImg", "anchor_text": "LabelImg Github"}, {"url": "https://tzutalin.github.io/labelImg/", "anchor_text": "LabelImg download"}, {"url": "https://github.com/datitran/raccoon_dataset", "anchor_text": "Dat Tran\u2019s raccoon detector"}, {"url": "https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf1_detection_zoo.md", "anchor_text": "this"}, {"url": "https://gilberttanner.com/blog/live-object-detection", "anchor_text": "my last Tensorflow object detection tutorial"}, {"url": "https://medium.com/tag/python?source=post_page-----ad69dda69c85---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----ad69dda69c85---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ad69dda69c85---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ad69dda69c85---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ad69dda69c85---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad69dda69c85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&user=Gilbert+Tanner&userId=b986eefd54ba&source=-----ad69dda69c85---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad69dda69c85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&user=Gilbert+Tanner&userId=b986eefd54ba&source=-----ad69dda69c85---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fad69dda69c85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ad69dda69c85---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ad69dda69c85--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ad69dda69c85--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ad69dda69c85--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ad69dda69c85--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gilberttanner?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gilberttanner?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gilbert Tanner"}, {"url": "https://medium.com/@gilberttanner/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.6K Followers"}, {"url": "https://gilberttanner.com/", "anchor_text": "https://gilberttanner.com/"}, {"url": "https://www.youtube.com/c/GilbertTanner", "anchor_text": "https://www.youtube.com/c/GilbertTanner"}, {"url": "http://buymeacoff.ee/gilberttanner", "anchor_text": "buymeacoff.ee/gilberttanner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb986eefd54ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&user=Gilbert+Tanner&userId=b986eefd54ba&source=post_page-b986eefd54ba--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa3ff29165918&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-your-own-object-detector-ad69dda69c85&newsletterV3=b986eefd54ba&newsletterV3Id=a3ff29165918&user=Gilbert+Tanner&userId=b986eefd54ba&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}