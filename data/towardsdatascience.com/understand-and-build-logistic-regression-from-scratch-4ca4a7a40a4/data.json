{"url": "https://towardsdatascience.com/understand-and-build-logistic-regression-from-scratch-4ca4a7a40a4", "time": 1683007117.1171799, "path": "towardsdatascience.com/understand-and-build-logistic-regression-from-scratch-4ca4a7a40a4/", "webpage": {"metadata": {"title": "Logistic regression from scratch | Towards Data Science", "h1": "Logistic regression from scratch", "description": "Learn how logistic regression works and how to build it yourself in NumPy!"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In many ways, logistic regression models are one of the most simple machine learning classification tools in a data scientist\u2019s toolbox. Understanding how these work directly helps with our understanding of deep neural networks for classification tasks.", "Here, we\u2019ll cover the maths of the model, how to train it, and how to build it in Python using numpy.", "Let\u2019s first imagine we have a dataset like the one above where the yellow points correspond to class 0 and purple corresponds to class 1. In order to predict the class label, we need a model that will take the two data dimensions as inputs and predict a number between 0 and 1. Consider this to be the probability of the label given the data and the model parameters: \u0177 = p(y =1|X,w).", "Logistic regression models aim to fit a straight line (or plane/ hyperplane) between the two classes so that points on the line have a probability of 0.5 and points far away from the line either have a probability of 0 or 1 depending on which side of the line they lie on.", "So now we understand the concept, let\u2019s try to formalise it slightly.", "Our linear line/ plane/ hyperplane can be expressed as: x\u0302 = w\u1d40x + b where w is a vector of weights and b is a bias.", "\u201cThat\u2019s all very well, but how do I get a closed form for the probability assigned to a label?\u201d, I hear you ask.", "Well, all we need now is a way to map our linear model to a valid probability. This means the function must have the following properties:", "Here\u2019s where the sigmoid or logistic function comes into play. The graph of the sigmoid function is shown below along with its functional form. This means we have an expression for the probability that a point belongs to a particular class.", "So our whole model can be expressed as: \u0177 = \u03c3(w\u1d40x + b).", "We know that the model has the ability to output a probability for each of the two classes, but how do we choose the weights of the model (w,b)?", "To do this we need to define a cost function for the model and minimise that function with regards to the model\u2019s parameters.", "Choosing the cost function for our model is done to maximise the likelihood of the assigned class:", "This loss is also referred to as binary cross-entropy.", "So the good news is, we\u2019re nearly there! We now need to use gradient descent to optimise the parameters based on the cost function. This optimisation process is the most common way to train network-style machine learning models. It involves calculating the derivative of the cost function with respect to each of the model parameters - hence why it is important for the sigmoid function to be smooth and differentiable.", "For those of you who know a little calculus, you may know this as an application of the chain rule but thanks to Geoff Hinton [1], in the machine learning world, we call this backpropagation.", "Now that we have gradients with respect to the model weights, we can take small steps to decrease the cost function. \u03bc is referred to as the learning rate of the algorithm. If the learning rate is too small, it will take too long for the model to train and it may end up in local minima. If it\u2019s too large, then the training process may not converge at all or it may converge on a poor minimum.", "If we have a lot of data we can create mini-batches and take a step for each batch in the training data. Or we can take the easier option, and compute the cost function for the whole dataset and take a single gradient step per epoch. We repeat the process of calculating the cost, the gradients, and then updating the weights until the cost function converges.", "As we\u2019ve just seen, logistic regression fits a linear model to the data and passes the output to a sigmoid activation to predict the probability of each class.", "If we wanted to make a more complex mapping from the input dimensions to the output then we could add additional transformations before the logistic regression layer. To train the weights of those layers we can use the same principle of backpropagation to find the gradients of those weights and update them in exactly the same way we did before.", "So that\u2019s the theory but how can we put that into practice?", "Let\u2019s implement the forward pass to make predictions with the model.", "There are two particular things of note in the implementation:", "Firstly, instead of including a separate bias, we make a small simplification by adding an extra weight and appending 1s to the data in the feature dimension. This allows us to have a single vector of weights rather than having two. It is an exercise for the reader (because you\u2019ve already been reading too long) to check that the gradients are still correct after this simplification.", "Secondly, notice that there is no loop over the data points, instead the calculations are vectorised to improve performance. This is important in machine learning normally so that the power of GPUs can be utilized during training, but it's not necessary for this simpler model.", "Now let\u2019s define the cost function\u2026", "We can now wrap this up in a class with both a fit and predict method to mimic the sk-learn type API.", "Let\u2019s test it out! Taking the mock dataset shown at the start of this article, we are ready to test our model\u2026", "In this case, we\u2019ve visualised the decision boundary between the two classes. This can be found where the classifier predicts 0.5 probability. In other words, it\u2019s the line where w\u1d40x + b = 0. So our hard work looks like it\u2019s paid off, our model can correctly identify 0.89% of the data points and has the ability to express uncertainty when classifying points close to the decision boundary!", "If you\u2019ve made it this far then hopefully you have a better understanding of how logistic regression works, and why binary cross-entropy is just a different way to express the log-likelihood of the model\u2019s predictions.", "Training a logistic regression model allows us to dip a toe into the waters of backpropagation, which provides the foundation of understanding how more complex deep neural networks can be trained.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist trying to learn something new"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4ca4a7a40a4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alexanderbailey?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": "Alexander Bailey"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb3e72c9d461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&user=Alexander+Bailey&userId=db3e72c9d461&source=post_page-db3e72c9d461----4ca4a7a40a4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ca4a7a40a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ca4a7a40a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/Pexels-2286921/", "anchor_text": "Pexels"}, {"url": "https://pixabay.com/", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/derivative-of-the-sigmoid-function-536880cf918e", "anchor_text": "this"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4ca4a7a40a4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4ca4a7a40a4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/logistic-regression?source=post_page-----4ca4a7a40a4---------------logistic_regression-----------------", "anchor_text": "Logistic Regression"}, {"url": "https://medium.com/tag/numpy?source=post_page-----4ca4a7a40a4---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/python?source=post_page-----4ca4a7a40a4---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ca4a7a40a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&user=Alexander+Bailey&userId=db3e72c9d461&source=-----4ca4a7a40a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ca4a7a40a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&user=Alexander+Bailey&userId=db3e72c9d461&source=-----4ca4a7a40a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ca4a7a40a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4ca4a7a40a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4ca4a7a40a4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4ca4a7a40a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexanderbailey?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexander Bailey"}, {"url": "https://medium.com/@alexanderbailey/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "156 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb3e72c9d461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&user=Alexander+Bailey&userId=db3e72c9d461&source=post_page-db3e72c9d461--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff756d91c4fbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstand-and-build-logistic-regression-from-scratch-4ca4a7a40a4&newsletterV3=db3e72c9d461&newsletterV3Id=f756d91c4fbd&user=Alexander+Bailey&userId=db3e72c9d461&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}