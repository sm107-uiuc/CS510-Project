{"url": "https://towardsdatascience.com/how-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a", "time": 1683015692.06404, "path": "towardsdatascience.com/how-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a/", "webpage": {"metadata": {"title": "How to create a list of files, folders, and subfolders and then export as Excel | by Ji Wei Liew | Towards Data Science", "h1": "How to create a list of files, folders, and subfolders and then export as Excel", "description": "This request looks deceptively simple, but you can already imagine the n other modifications that may come once the first version of this list is done. Depending on the size of the folder, number of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.python.org/3.8/library/os.html#os.walk", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://stackoverflow.com/questions/13944387/why-use-os-path-join-over-string-concatenation", "anchor_text": "answer", "paragraph_index": 11}, {"url": "http://www.linkedin.com/in/ji-wei-liew", "anchor_text": "www.linkedin.com/in/ji-wei-liew", "paragraph_index": 21}], "all_paragraphs": ["Can you create a list of files, folders, and subfolders for our project folder?", "This request looks deceptively simple, but you can already imagine the n other modifications that may come once the first version of this list is done.", "Can you also list the files types and add hyperlinks to the file? And maybe add the file size while you\u2019re at it?", "Depending on the size of the folder, number of files and how nested it might be, you could have chosen to complete this task manually as adding new fields might be simple. Now, let\u2019s consider another request:", "I\u2019ve re-arranged some folders and renamed some files, can you update that list?", "Fret not, Python to the rescue!", "os.walk() is the main function that we\u2019ll be using to create a script to loop through the main folder and list all the subfolders and files. The link to the python documentation is here. Here\u2019s the main part of the code:", "Full code available at the end of story.", "path refers to the main folder path which we are interested. os.walk returns a tuple root, dir and files. We\u2019ll need only root and files for this.", "Temporary files start with a tilde ~ and it might not be meaningful to include these, hence the list comprehension has an if condition to exclude such files. Similarly, Thumbs.db is just a Thumbnail image file and explicitly excluded.", "paths is a list of paths which points to the specific file in each subfolder.", "os.walk documentation recommends to use os.path.join as opposed to string concatenation and here\u2019s a stackoverflow answer why that is recommended.", "exts is a list of extensions formed by using os.path.splitext() which returns a tuple of the filename without extension and the extension.", "[edited] Previously, I had gotten the extension by right-splitting rsplit the filenames. exts = [f.rsplit('.',1)[-1].lower() for f in files] This is not a good practice.", "filetypes is a list of file types and ext_desc is a function that maps each extension to to an appropriate name.", "The links to the files are added in a slightly different way.", "=HYPERLINK() is an Excel formula which creates a hyperlink when given a link location (can be webpage or file location) The second argument, link , is optional and serves to shorten the displayed text. The if condition len(p)<256 is a limitation in Excel, where links longer than 255 characters do not work.", "folders is a list of folders that tells us where each file is located. This is obtained by getting the directory name of the path using the os.path.dirname() method.", "[Edited] Previously, I had use folders = [p.rsplit('\\\\',1)[0] for path in paths] to get the folder. Once again, this is not a good practice.", "As each list comprehension is a column, all that is left is to build a dataframe and append to the original dataframe. The final dataframe can be written to Excel by usingdf.to_excel('some_filename.xlsx')", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Business consultant for banks, passionate about scripting and automating work using python. www.linkedin.com/in/ji-wei-liew"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6ce9eaa3867a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jiweiliew.medium.com/?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": ""}, {"url": "https://jiweiliew.medium.com/?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": "Ji Wei Liew"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf5390a70cc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=post_page-bf5390a70cc8----6ce9eaa3867a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ce9eaa3867a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ce9eaa3867a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pranavmadhu?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Pranav Madhu"}, {"url": "https://unsplash.com/s/photos/file-list?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://docs.python.org/3.8/library/os.html#os.walk", "anchor_text": "here"}, {"url": "https://stackoverflow.com/questions/13944387/why-use-os-path-join-over-string-concatenation", "anchor_text": "answer"}, {"url": "https://medium.com/tag/python-programming?source=post_page-----6ce9eaa3867a---------------python_programming-----------------", "anchor_text": "Python Programming"}, {"url": "https://medium.com/tag/pandas?source=post_page-----6ce9eaa3867a---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/tkinter?source=post_page-----6ce9eaa3867a---------------tkinter-----------------", "anchor_text": "Tkinter"}, {"url": "https://medium.com/tag/excel?source=post_page-----6ce9eaa3867a---------------excel-----------------", "anchor_text": "Excel"}, {"url": "https://medium.com/tag/automation?source=post_page-----6ce9eaa3867a---------------automation-----------------", "anchor_text": "Automation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6ce9eaa3867a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=-----6ce9eaa3867a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6ce9eaa3867a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=-----6ce9eaa3867a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ce9eaa3867a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6ce9eaa3867a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6ce9eaa3867a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6ce9eaa3867a--------------------------------", "anchor_text": ""}, {"url": "https://jiweiliew.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jiweiliew.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ji Wei Liew"}, {"url": "https://jiweiliew.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "86 Followers"}, {"url": "http://www.linkedin.com/in/ji-wei-liew", "anchor_text": "www.linkedin.com/in/ji-wei-liew"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf5390a70cc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=post_page-bf5390a70cc8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fde67d60b7022&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a&newsletterV3=bf5390a70cc8&newsletterV3Id=de67d60b7022&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}