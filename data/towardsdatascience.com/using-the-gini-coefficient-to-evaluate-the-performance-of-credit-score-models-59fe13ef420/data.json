{"url": "https://towardsdatascience.com/using-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420", "time": 1683002573.2819881, "path": "towardsdatascience.com/using-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420/", "webpage": {"metadata": {"title": "Using the Gini coefficient to evaluate the performance of credit score models | by Idan Schatz | Towards Data Science", "h1": "Using the Gini coefficient to evaluate the performance of credit score models", "description": "When a new credit score model is born, usually the first question that comes up is: \u201cwhat is its Gini?\u201d. To an outsider, it must sound like an odd referral to Disney\u2019s film Aladdin. But, Gini or the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/wendykan/lending-club-loan-data", "anchor_text": "Lending-club", "paragraph_index": 6}, {"url": "https://www.bis.org/publ/work834.htm", "anchor_text": "https://www.bis.org/publ/work834.htm", "paragraph_index": 46}], "all_paragraphs": ["When a new credit score model is born, usually the first question that comes up is: \u201cwhat is its Gini?\u201d. To an outsider, it must sound like an odd referral to Disney\u2019s film Aladdin. But, Gini or the Gini coefficient is one of the most popular metrics used by the financial industry for evaluating the performance of credit score models.", "The Gini coefficient is a metric that indicates the model\u2019s discriminatory power, namely, the effectiveness of the model in differentiating between \u201cbad\u201d borrowers, who will default in the future, and \u201cgood\u201d borrowers, who won\u2019t default in the future. This metric is often used to compare the quality of different models and evaluate their prediction power.", "Despite its commonality, some practitioners are not genuinely familiar with the mechanism beyond this Gini coefficient and mistakenly confuse it with a different metric with the same name. While many practitioners mistakenly associate the Gini coefficient with the summary of the Lorenz curve, Corrado Gini\u2019s measure of inequality[1], the Gini coefficient they are using is most of the time Somers\u2019 D, which is the summary of the CAP (Cumulative Accuracy Profile) curve.", "Somers\u2019 D is named after Robert H. Somers, who proposed it in 1962[2]. It is a measure of the ordinal relationship between two variables. In the context of credit score models, it measures the ordinal relationship between the models\u2019 predictions, in terms of PD (Probability of Default) or score, and the actual outcome \u2014 default or not default. If the model is useful, low scores (high PD) should be more associated with defaults than high scores (low PD).", "Somers\u2019 D takes on a value between (-1) and 1. (-1) being a perfect negative ordinal relationship and 1 a perfect ordinal relationship. In practice, a credit score model with Somers\u2019 D of 0.4 is deemed to be good. (Henceforth, I will be addressing Somers\u2019 D as the Gini coefficient)", "For the sake of minimalism, I won\u2019t describe the math involved in calculating the Gini coefficient. Instead, I will show three different ways to derive it.", "To demonstrate each of these methods, I will be using a sample credit score model which developed using logistic regression and data of 10,000 borrowers from Lending-club.", "Based on the models\u2019 predictions \u2014 estimated Probability of Default (PD), I scored each of the borrows from 1 to 1000; 1 represents the lowest PD and 1000 the highest PD.", "Extract the Gini coefficient from the CAP curve", "The CAP curve, in our context, is designed to capture the ordinal relation between score (PD) and default rate. If our model does a good job of discriminating between good and bad borrowers, we would expect to find more defaults at low scored borrowers than at high scored borrowers. The CAP curve captures this notion by aggregating the cumulative default rate when sampling borrowers from the lowest score to the highest score.", "To construct the CAP curve, all the model\u2019s population needs to be ordered by the predicted likelihood of default. Namely, the observation with the lowest score is first, and the observation with the highest score is last. Then, we sample the population from first to last, and after each sampling, we calculate the cumulative default rate. The x-axis of the CAP curve represents the portion of the population sampled, and the y-axis represents the corresponding cumulative default rate.", "If our model has perfect discriminatory power, we would expect to reach 100% of the cumulative default rate after sampling a portion of observations, which is equal to the default rate in our data (the green line in the chart below). E.g., if the default rate in our data is 16%, after sampling 16% of the observations, we would capture all the defaults in our data. On the contrary, if we use a random model, i.e., a model which randomly assigns scores in equal distribution, the cumulative default rate will always equal to the portion of observations sampled (the red line in the chart below).", "The Gini coefficient is defined as the ratio between the area within the model curve and the random model line (A) and the area between the perfect model curve and the random model line (A+B). Put it differently, the Gini coefficient is a ratio that represents how close our model to be a \u201cperfect model\u201d and how far it is from being a \u201crandom model.\u201d Thus, a \u201cperfect model\u201d would get a Gini coefficient of 1, and a \u201crandom model\u201d would get a Gini coefficient of 0.", "My model gained a low Gini coefficient of 0.26:", "Construct the Lorenz curve, extract Corrado Gini\u2019s measure, then derive the Gini coefficient", "The Lorenz curve is the inverse of the CAP curve; it is constructed using the same mechanism of sampling observations and aggregating the cumulative default rate, but the sampling is done in reverse order (from highest to lowest score). The Lorenz also has a diagonal line, which is equivalent to the \u2018CAP random model\u2019 line and is called \u201cthe Line of Equality\u201d (the red line in the chart below).", "Another difference between the two curves is the \u201cperfect model\u201d line. Since the Lorenz curve was designed to capture the distribution of wealth, the most discriminative outcome is a case where all the wealth of the population is concentrated in one observation. Namely, the line which is equivalent to the \u201cCAP perfect model\u201d line in the Lorenz curve is constructed from the two perpendicular lines, which are the x-axis and a vertical line, which evolved from the end of the x-axis at the value of 100% (the green line in the chart below). This line represents the case in which all the cumulative outcome is in the last sampled observation. The value of Corrado Gini\u2019s measure is defined as the ratio of the area between the model\u2019s curve and the \u201cLine of Equality\u201d to the area between the \u201cLine of Equality\u201d and the x-axis.", "However, when using the Lorenz curve to evaluate the discrimination power of a credit score model and assigning its y-axis to be the cumulative default rate, a problem emerges. Since the y-axis describes the aggregation of a binary outcome (1 or 0), a case where all the cumulative default rate concentrates in one observation doesn\u2019t exist. Put it differently, when evaluating a credit score model using the Lorenz curve, it is impossible to reach the \u201cPerfect model\u201d line. Consequently, an appropriate \u201cperfect model\u201d line for this kind of evaluation should be adjusted to the default rate in the population, as in the CAP curve.", "Hence, to adjust Corrado Gini\u2019s measure for credit score model evaluation, we need to deduct the unreachable area from its denominator.", "Finally, to derive the Gini coefficient from Corrado Gini\u2019s measure, we can use the following formula:", "My model gained Corrado Gini\u2019s measure of 0.22:", "The default rate in my sample is 16%, so the Gini coefficient of my model can be calculated as follows:", "Construct the ROC curve, extract the AUC, then derive the Gini coefficient", "The third method of calculating the Gini coefficient is through another popular curve: the ROC curve. The area under the ROC curve, which is usually called the AUC, is also a popular metric for evaluating and comparing the performance of credit score models. The ROC curve summarizes two ratios from the confusion matrix: the True Positive Ratio (TPR or Recall) and the False Positive Ratio (FPR).", "The confusion matrix summarizes, for a given threshold, the number of cases in which:", "For example, let\u2019s use the score of 850 as our threshold, i.e., borrows with a score below 850, are predicted to default, and borrowers with a score above 850 are predicted not to default.", "The True Positive Ratio (TPR) is defined as the number of defaulted borrowers in which our model caught over the total number of defaulted borrowers in our data. The False Positive Ratio (FPR) is calculated as the number of cases in which the model incorrectly predicted a default over the total number of non-default instances.", "The ROC curve is constructed by using confusion matrices that originated from thresholds between 1 to 1000 and driving their TPR and FPR. The y-axis of the ROC curve represents the TPR values, and the x-axis represents the FPR values. The AUC is the area between the curve and the x-axis.", "Surprisingly, as shown by Schechtman & Schechtman, 2016[3] there is a linear relationship between the AUC and the Gini coefficient. So, to derive the Gini coefficient from the AUC all you need to do is to use the following formula:", "Practitioners tend to disclose the AUC in addition to the Gini coefficient in their model validation report. However, since these metrics have a linear relation, the disclosure of these metrics together doesn\u2019t add any value to the evaluation of the model\u2019s quality.", "The AUC of my model is 0.63, hence the Gini coefficient is calculated like this:", "Drawbacks and pitfalls of the Gini coefficient", "Despite its commonality, the Gini coefficient has some drawbacks and pitfalls you should consider when using it to evaluate and compare credit score models. For the sake of minimalism, in this section, I\u2019ll describe a common pitfall when trying to derive the Gini coefficient and its main drawback.", "To illustrate these concepts I\u2019ll use a toy example: 15 borrowers, 2 \u201dbad\u201d and 13 \u201dgood\u201d, and scores that go from 1 (highest PD) to 10 (lowest PD).", "A common pitfall when trying to derive the Gini coefficient is identical scores. In most cases (especially when using large datasets), the credit score model will estimate the same score for different observations. This score duplication raises an issue when trying to derive the Gini coefficient using the CAP curve method. As mentioned above, the first step to derive the CAP curve is to sort the observations by their score, as in the following two examples:", "These two examples use the same borrowers with the same scores. The only difference between these two tables is the secondary level of ordering. In Example 1 when there is a case of identical scores (in score 5), the observations which defaulted come first. Example 2 is the other way around. This minor change can have a major effect on the value of the Gini coefficient, e.g. in this case, Example 1 has a Gini coefficient of 0.67, and Example 2 has a Gini coefficient of 0.38.", "To avoid this pitfall, I recommend doing a secondary sorting like in Example 1 or simply to derive the Gini coefficient using the AUC method mentioned above.", "The major disadvantage of the Gini coefficient comes from the fact that it is an ordinal metric, i.e., it captures the order of values while ignoring the distance between them. This characteristic of the Gini coefficient can sometimes mask poor model performances.", "When ordering the borrowers based on the score predicted by both of the models, we get the same \u201cDefault\u201d column. This indicates that these two models have the same Gini coefficient (0.85).", "When comparing the distributions of scores predicted by these two models we get the following charts:", "Both models have the same Gini coefficient. But, Model B was only able to separate the borrowers into three types: 1, 2 and 3, while Model A was able to capture all 10 levels of risk. This suggests that Model A is more sensitive than Model B to the different characteristics of the borrowers, and can differentiate better between different risk levels.", "To understand the importance of the feature above, assume that the owner of Model A and the owner of Model B decide to set a score which will be the threshold for their loan approval. I.e., the loan requests of borrowers with a score below or equal to the threshold, will be denied and the loan requests of borrowers with a score above the threshold, will be approved. Both model owners examined their model outcomes on the test sample and decide to use the score which captured 100% of the cumulative default rate as their threshold. Consequently, the owner of Model A sets the threshold to be 6 and the owner of Model B sets her threshold to be 2. By choosing these scores, the model owners got very different results:", "The owner of Model A rejected 8 \u201cgood\u201d borrowers and approved 5 while the owner of Model B rejected 12 \u201cgood\u201d borrowers and approved only 1. The threshold set by the owner of Model A yields FPR of 62%, and the threshold set by the owner of Model B yields FPR of 92%.", "Hence, the Gini coefficient inability to capture the model\u2019s effectiveness in differentiating between different levels of risk is a major drawback.", "In order to overcome this drawback, I recommend eyeball testing the distribution of the model predictions, as in Gambacorta, Huang, Qiu, & Wang, 2019[4], and using the Precision-Recall curve to evaluate the model\u2019s trade-off between capturing \u201cbad\u2019\u201d borrowers and mistakenly predict default of \u2018\u201cgood\u201d borrowers.", "[3] Schechtman, E., & Schechtman, G. (2016). The Relationship between Gini Methodology and the ROC curve (SSRN Scholarly Paper No. ID 2739245). Rochester, NY: Social Science Research Network.", "[4] Gambacorta, L., Huang, Y., Qiu, H., & Wang, J. (2019). How do machine learning and non-traditional data affect credit scoring? New evidence from a Chinese fintech firm. Retrieved from https://www.bis.org/publ/work834.htm", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I work with financial institutions on developing and validating credit score models at @Deloitte"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F59fe13ef420&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----59fe13ef420--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----59fe13ef420--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@124idans?source=post_page-----59fe13ef420--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@124idans?source=post_page-----59fe13ef420--------------------------------", "anchor_text": "Idan Schatz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fffa2e86f8616&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&user=Idan+Schatz&userId=ffa2e86f8616&source=post_page-ffa2e86f8616----59fe13ef420---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F59fe13ef420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F59fe13ef420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@cesiraalvarado?utm_source=medium&utm_medium=referral", "anchor_text": "Cesira Alvarado"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.fico.com/blogs/how-analytics-developers-can-game-model-results", "anchor_text": "FICO"}, {"url": "https://www.kaggle.com/wendykan/lending-club-loan-data", "anchor_text": "Lending-club"}, {"url": "http://www.jstor.org/stable/209040", "anchor_text": "www.jstor.org/stable/209040"}, {"url": "https://www.bis.org/publ/work834.htm", "anchor_text": "https://www.bis.org/publ/work834.htm"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----59fe13ef420---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/gini-coefficient?source=post_page-----59fe13ef420---------------gini_coefficient-----------------", "anchor_text": "Gini Coefficient"}, {"url": "https://medium.com/tag/data-science?source=post_page-----59fe13ef420---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/classification?source=post_page-----59fe13ef420---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/credit-scoring?source=post_page-----59fe13ef420---------------credit_scoring-----------------", "anchor_text": "Credit Scoring"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F59fe13ef420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&user=Idan+Schatz&userId=ffa2e86f8616&source=-----59fe13ef420---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F59fe13ef420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&user=Idan+Schatz&userId=ffa2e86f8616&source=-----59fe13ef420---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F59fe13ef420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----59fe13ef420--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F59fe13ef420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----59fe13ef420---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----59fe13ef420--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----59fe13ef420--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----59fe13ef420--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----59fe13ef420--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----59fe13ef420--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----59fe13ef420--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----59fe13ef420--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----59fe13ef420--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@124idans?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@124idans?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Idan Schatz"}, {"url": "https://medium.com/@124idans/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "80 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fffa2e86f8616&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&user=Idan+Schatz&userId=ffa2e86f8616&source=post_page-ffa2e86f8616--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffd8f88f48d1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-the-gini-coefficient-to-evaluate-the-performance-of-credit-score-models-59fe13ef420&newsletterV3=ffa2e86f8616&newsletterV3Id=fd8f88f48d1d&user=Idan+Schatz&userId=ffa2e86f8616&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}