{"url": "https://towardsdatascience.com/robosomm-chapter-4-the-effect-of-terroir-18168f0d08b9", "time": 1683000164.778084, "path": "towardsdatascience.com/robosomm-chapter-4-the-effect-of-terroir-18168f0d08b9/", "webpage": {"metadata": {"title": "The Effect of Terroir. Quantifying Components of Terroir and\u2026 | by Roald Schuring | Towards Data Science", "h1": "The Effect of Terroir", "description": "A central concept to the study of wine is terroir: the environmental factors that contribute towards how a wine tastes. There are a lot of myths about terroir in the wine community. Books have been\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.amazon.com/Terroir-Other-Myths-Winegrowing-Matthews/dp/0520276957", "anchor_text": "Books", "paragraph_index": 0}, {"url": "https://www.decanter.com/magazine/wine-terroir-soil-taste-405096/", "anchor_text": "scientists", "paragraph_index": 0}, {"url": "https://github.com/RoaldSchuring/studying_terroir/blob/master/Investigating%20Terroir.ipynb", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/robosomm-chapter-3-wine-embeddings-and-a-wine-recommender-9fc678f1041e?source=friends_link&sk=2823c32030f1f56594b8128167973130", "anchor_text": "previous chapter", "paragraph_index": 2}, {"url": "https://alexisperrier.com/datascience/2015/08/27/feature-importance-random-forests-gini-accuracy.html", "anchor_text": "feature importance", "paragraph_index": 13}, {"url": "https://www.stonestreetwines.com/how-does-altitude-affect-wine", "anchor_text": "conditions", "paragraph_index": 18}, {"url": "https://greatnorthwestwine.com/2013/09/28/rain-winemakers-grape-growers-must-wait/", "anchor_text": "rainfall during harvest", "paragraph_index": 21}, {"url": "http://www.omafra.gov.on.ca/english/crops/hort/news/hortmatt/2015/11hrt15a1.htm", "anchor_text": "higher CECSOL", "paragraph_index": 25}, {"url": "https://winefolly.com/review/introduction-soil-types-wine/", "anchor_text": "said", "paragraph_index": 27}, {"url": "https://en.wikipedia.org/wiki/Loess", "anchor_text": "loess", "paragraph_index": 27}], "all_paragraphs": ["A central concept to the study of wine is terroir: the environmental factors that contribute towards how a wine tastes. There are a lot of myths about terroir in the wine community. Books have been written about whether terroir is even a valid concept to begin with, and scientists have tried to unpack which components of terroir impact flavor, aromas and mouthfeel.", "In this article, we will use data science techniques to learn which components of terroir, if any, have an influence on the sensory profiles of wines. Check out the GitHub repository with all relevant code here.", "In a previous chapter of the RoboSomm series, we used the information contained in professional wine reviews to generate \u2018wine embeddings\u2019: vector representations of the flavor profiles of over 150,000 unique wines. We will now explore the extent to which these flavor profiles can be explained by the terroir attributes.", "Our 150,000+ wine dataset contains information on locations and vintages. We can use this information to bring in external data on a variety of different terroir-related attributes:", "Not all of the wine reviews in our dataset had available terroir data. This was especially true for weather. Additionally, for some of the wines in our dataset, the closest weather station was hundreds of kilometers away. Since this is unlikely to yield reliable weather data, any such instances with a distance of over 150km were dropped.", "After removing all observations with missing values for soil, weather or altitude, we are left with about 33,000 usable observations.", "For completeness, we enhanced our terroir dataset with two known attributes for each wine that likely have an impact on flavor profile: grape variety and age. This allows us to control for variations in flavor that seem to be related to these attributes, and study the true effects of terroir more closely.", "Now we are ready to build a model! The problem at hand is a multivariate regression problem: we want to use our terroir, varietal and age data to predict a 300-dimensional wine embedding vector. The high dimensionality of these wine embeddings is a challenge. We can use Principal Component Analysis (PCA) to compress our 300-dimensional output vectors into a lower dimensional space. It appears that 70% of the variation in our wine embeddings can be explained in 41 dimensions. As such, these 41-dimensional compressed wine embeddings will be the dependent variable in our multivariate regression problem. This is still a high number of dimensions, but is an improvement on the 300 dimensions we began with.", "We will build our model on 80% of the observations in our dataset, retaining 20% as our test set. The Random Forest Regressor in SciKit-Learn natively supports multi-output regression and is our model of choice.", "Even after hyperparameter tuning, our model only achieves an R-squared value of 36% on our test set. In other words: in our model, terroir, grape variety and age can explain for just over one-third of the variation in wine flavor profiles. Does this mean that the other two-thirds of the variation in wine taste is explained by other variables such as winemaking style?", "Well, probably not. The 36% is likely artificially low due to imperfections in gathering local weather, soil and altitude data. This % also rests on the assumption that we are able to fully explain a wine\u2019s flavor profile in our wine embeddings; which in turn are reliant on the assessments of professional sommeliers.", "Despite these caveats, it does appear that terroir is able to explain some of the variation in flavor profiles. But what components of terroir are the most impactful?", "We can use two techniques to assess feature importance: the terroir attributes that have the biggest impact on predicting wine embeddings.", "First up, we can calculate feature importance using the mean decrease impurity method.", "From the chart adjacent, we can see that age appears to have by far the greatest impact. This is followed by a few select grape varieties, with elevation also contributing significantly. The first soil attributes to appear are CECSOL_0 (Cation Exchange Capacity at 0cm depth) and SLTPPT_30 (Soil texture fraction silt at 30cm depth). The weather attributes that seem to matter most are precipitation in the third month of autumn (harvest?) and the average maximum temperature in the second summer month.", "As a reality check, we will use a second technique to assess feature importance: Shapley Values. Shapley Values are a concept from game theory that calculates each feature\u2019s marginal contribution to an overall prediction. We can aggregate this over all the observations in our training dataset to assess which features have the biggest impact.", "Once again, age seems to be the main contributor to flavor profile. CECSOL_0 and SLTPPT_30 again seem to be the soil factors that contribute most. The importance of elevation is highlighted, as well as the average maximum temperature in the second summer month.", "Armed with an idea of which terroir variables have the biggest effect on flavor profile, let\u2019s examine the ones with the greatest apparent impact more closely.", "Grapes cultivated at high altitudes are subject to unique conditions that low altitudes do not exhibit. More direct sunlight during the day causes grapes to develop thicker skins, which is said to contribute to higher concentration and tannins. Additionally, larger temperature swings between day and night allow these grapes to retain more of their natural acidity.", "To see how altitude establishes itself in terms of flavor profile, we can calculate the relative frequency of descriptors in low altitude (bottom quartile) wines vs. high altitude (top quartile) wines. The descriptors with the greatest difference in relative frequency for both categories can be summarized in a wordcloud:", "While we are not controlling for grape variety, age or any other terroir-related variables here, we can see some interesting differences between the profiles of low altitude vs. high altitude wines. High altitude wines seem to exhibit more rich, ripe and dense characteristics than low altitude wines. This is likely a product of the amount of sunlight that they receive. \u2018Firm\u2019 suggests high levels of tannins and/or acidity, which is consistent with prevailing beliefs about high-altitude wines. Conversely, low-altitude wines seem to reveal more red fruit and oak notes. Interestingly, these wines appear to be more herbal and earthy as well. This may be a product of the higher average temperatures the grapes are subject to.", "Winemakers famously worry about rainfall during harvest. If grapes soak up water, this has the potential to dilute the sugars and flavors in grapes. Water may also stick to the leaves and branches of the vines and inadvertently be processed with the harvested grapes. Excess rainfall during harvest may also raise pH values of the grapes, reducing the acidity of a wine. Once again, let\u2019s put these theories to the test by looking at our relative frequency descriptor wordclouds.", "The \u2018Low Autumn Rain\u2019 wordcloud paints a telling picture. These wines are associated with more concentration, richness and ripeness. Additionally, the presence of \u2018crisp\u2019 in the wordcloud on the left seems to indicate good levels of acidity. This appears to be consistent with prevailing theory on the effects of late-season precipitation.", "The average maximum daily temperature in the second month of summer appeared to have a significant impact on flavor profile. Traditionally, high temperatures have been associated with higher alcohol and lower acidity.", "In our dataset, low summer temperatures are associated with berry flavors such as cassis and blackberry. Sweetness and herbal characteristics also appear to be more prevalent in wines from grapes that were subject to lower average summer temperatures. High maximum average temperatures are more associated with cherry notes, and spice aromas such as star anise and clove.", "Cation Exchange Capacity (CECSOL) is a measure of a soil\u2019s ability to hold positively charged cations. Soil with higher CECSOL values typically has a higher clay content and a greater capacity to hold nutrients. Little theory exists about the effect of CECSOL values on wine flavors.", "The descriptors in the wordclouds are highly correlated with wine color. On the left, we see almost exclusively descriptor notes that are associated with white wines, while the wordcloud on the right contains mainly red wine descriptor notes. This makes it hard to pick out the sensory qualities that CECSOL is associated with. We can revisit this in future research, while controlling for grape variety.", "Grapes grown in soils with high levels of silt are said to yield smooth wines with lower levels of acidity. Silt is often associated with \u2018loess\u2019, a more general term that describes sediment formed by the accumulation of wind-blown dust. Wines from loess can produce wines with mineral characteristics.", "In our dataset, low levels of silt appear to be associated with drier, firmer and riper wines. \u2018Fresh\u2019, an indicator of higher levels of acidity, also appears to be linked with low levels of silt. This is in line with prevailing thinking about silt and wine. High levels of silt are associated with more savory wines that can be described as herbal or green.", "Modeling the impact of terroir on wine is a challenging exercise. The analysis in this post begins to uncover the facets of terroir that appear to have the greatest impact. Altitude, soil type, precipitation and temperature all play a part. Of these factors, altitude appeared to have the greatest impact. Although we have superficially started to identify descriptors that are related to these terroir, we have just started to peel the proverbial onion. The manifestation of terroir may be entirely different depending on factors such as age and grape variety. A good next step for this analysis will be to focus on the nuances of terroir while better controlling for such factors. There is still much to learn about wine and Mother Nature\u2026", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F18168f0d08b9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://roald-schuring.medium.com/?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": ""}, {"url": "https://roald-schuring.medium.com/?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": "Roald Schuring"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb7a017fe77d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&user=Roald+Schuring&userId=eb7a017fe77d&source=post_page-eb7a017fe77d----18168f0d08b9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F18168f0d08b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F18168f0d08b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/robosomm", "anchor_text": "RoboSomm"}, {"url": "https://www.amazon.com/Terroir-Other-Myths-Winegrowing-Matthews/dp/0520276957", "anchor_text": "Books"}, {"url": "https://www.decanter.com/magazine/wine-terroir-soil-taste-405096/", "anchor_text": "scientists"}, {"url": "https://github.com/RoaldSchuring/studying_terroir/blob/master/Investigating%20Terroir.ipynb", "anchor_text": "here"}, {"url": "https://grape1368.wordpress.com/2013/04/29/reign-of-terroir/", "anchor_text": "Reign of Terroir"}, {"url": "https://towardsdatascience.com/robosomm-chapter-3-wine-embeddings-and-a-wine-recommender-9fc678f1041e?source=friends_link&sk=2823c32030f1f56594b8128167973130", "anchor_text": "previous chapter"}, {"url": "https://rest.soilgrids.org/", "anchor_text": "SoilGrids API"}, {"url": "https://console.cloud.google.com/bigquery?p=bigquery-public-data&d=samples&t=gsod&page=table&_ga=2.35989664.-1222802223.1565057200&_gac=1.250923698.1565141557.EAIaIQobChMI77_Q0s7v4wIVjYCfCh2iiAvIEAAYASAAEgKFfvD_BwE", "anchor_text": "Google BigQuery"}, {"url": "https://developers.google.com/maps/documentation/elevation/start", "anchor_text": "Google Elevation API"}, {"url": "https://alexisperrier.com/datascience/2015/08/27/feature-importance-random-forests-gini-accuracy.html", "anchor_text": "feature importance"}, {"url": "https://www.stonestreetwines.com/how-does-altitude-affect-wine", "anchor_text": "conditions"}, {"url": "https://greatnorthwestwine.com/2013/09/28/rain-winemakers-grape-growers-must-wait/", "anchor_text": "rainfall during harvest"}, {"url": "http://www.omafra.gov.on.ca/english/crops/hort/news/hortmatt/2015/11hrt15a1.htm", "anchor_text": "higher CECSOL"}, {"url": "https://winefolly.com/review/introduction-soil-types-wine/", "anchor_text": "said"}, {"url": "https://en.wikipedia.org/wiki/Loess", "anchor_text": "loess"}, {"url": "https://medium.com/tag/wine?source=post_page-----18168f0d08b9---------------wine-----------------", "anchor_text": "Wine"}, {"url": "https://medium.com/tag/robosomm?source=post_page-----18168f0d08b9---------------robosomm-----------------", "anchor_text": "Robosomm"}, {"url": "https://medium.com/tag/data-science?source=post_page-----18168f0d08b9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/wine-tasting?source=post_page-----18168f0d08b9---------------wine_tasting-----------------", "anchor_text": "Wine Tasting"}, {"url": "https://medium.com/tag/terroir?source=post_page-----18168f0d08b9---------------terroir-----------------", "anchor_text": "Terroir"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F18168f0d08b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&user=Roald+Schuring&userId=eb7a017fe77d&source=-----18168f0d08b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F18168f0d08b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&user=Roald+Schuring&userId=eb7a017fe77d&source=-----18168f0d08b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F18168f0d08b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F18168f0d08b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----18168f0d08b9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----18168f0d08b9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----18168f0d08b9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----18168f0d08b9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----18168f0d08b9--------------------------------", "anchor_text": ""}, {"url": "https://roald-schuring.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://roald-schuring.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roald Schuring"}, {"url": "https://roald-schuring.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "81 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb7a017fe77d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&user=Roald+Schuring&userId=eb7a017fe77d&source=post_page-eb7a017fe77d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F853df658d335&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-4-the-effect-of-terroir-18168f0d08b9&newsletterV3=eb7a017fe77d&newsletterV3Id=853df658d335&user=Roald+Schuring&userId=eb7a017fe77d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}