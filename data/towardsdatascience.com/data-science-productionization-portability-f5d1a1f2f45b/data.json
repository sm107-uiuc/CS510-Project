{"url": "https://towardsdatascience.com/data-science-productionization-portability-f5d1a1f2f45b", "time": 1682995476.5438871, "path": "towardsdatascience.com/data-science-productionization-portability-f5d1a1f2f45b/", "webpage": {"metadata": {"title": "Data science productionization: portability | by Schaun Wheeler | Towards Data Science", "h1": "Data science productionization: portability", "description": "Portability decreases how long it takes to get value from your code by decreasing the amount of code you have to rewrite."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/data-is-a-stakeholder-31bfdb650af0", "anchor_text": "spent a few months developing several methods", "paragraph_index": 18}, {"url": "https://www.researchgate.net/publication/231849997_Positional_Accuracy_of_Assisted_GPS_Data_from_High-Sensitivity_GPS-enabled_Mobile_Phones", "anchor_text": "many phones will revert", "paragraph_index": 19}, {"url": "https://portal.enes.org/oasis/general-information/events/workshop-on-coupling-technologies-for-earth-system-modelling-today-and-tomorrow-1/talks/MDuda_mpas_meshes_framework.pdf", "anchor_text": "used by the Weather Company", "paragraph_index": 19}, {"url": "http://aampe.co", "anchor_text": "aampe.co", "paragraph_index": 27}], "all_paragraphs": ["This is the second part of a five-part series on data science productionization. I\u2019ll update the following list with links as the posts become available:", "The first step to productionizing data science is to make it portable. To explain what I mean, let\u2019s look at a simple example of code portability:", "The above code performs a simple task that is commonly found in text analysis: take a word, remove all white space on the ends, and lowercase all the characters; then examine each character of that word in order; if the character is in a list of \u201cstops\u201d, omit it; at the end, join all the remaining characters together so they are again one word. The example uses a specific word \u2014 \u2018abracadbra\u2019 \u2014 and you can see that the result contains only the characters \u2018rr\u2019, as all of the other letters were in our list of stops.", "Now look at the same code with a few changes:", "The new code takes the same input and produces the same output. But there are a few ways this code is preferable to the previous version:", "In short, the revised code can be used for any number of projects \u2014 even projects I never anticipated when I wrote the function. The original code can be used for the project for which I wrote it, and must be edited if I want to use it anywhere else. So the second code example is the more portable of the two.", "We can also make whole collections of code portable. There are several ways to do this:", "Packaging. Packaging is the process of taking a lot of code \u2014 multiple files and directories \u2014 and bundling them together for easy installation on other computers. Packaging systems for Python, for example, range from PyPi, which is widely used and relatively minimalist, to conda, which is growing in popularity due to the ways it makes installation easier and more robustly handles dependencies. Dependency management is one of the major reasons for packaging software \u2014 modular software is often built on top of other modular software, which means when you want to use one you need to have all installed. Keeping track of those dependencies through packaging makes code portable across users. Also code can perform quite differently depending on the dependencies with which it has been packaged. For example, the graph below shows the difference in number of images that can be processes per second using tensorflow:", "The code packages in Conda performs 4\u20138 times faster than the code packages in PyPi. That is due largely to a difference in packaged dependencies.", "Version control. Packaging makes for portability across users, while version control makes for portability across contributors. The most popular version control system is git. Git operates on a fork-modify-commit-merge model. In the image below, the top line is the \u201cmaster\u201d branch of the code, and the remaining lines are other branches created for different purposes.", "When you see code you want to use, you \u201cfork\u201d your own copy. You can mess that copy up as much as you want \u2014 the original will still be right where it was. When you make changes to the code on your local machine, you can commit it to your fork \u2014 your local code will reflect any changes you make, but your fork will only reflect changes you commit, while the original code will remain as it was originally. If your fork gets to the point that the owners of the original code find it useful and stable and generally something to be desired, you can merge your fork with the master branch, after which point that master will reflect all of the changes you committed to your fork. Version control allows the same basic collection of code to be worked on by many different people at the same time, enforces rules about what can become the \u201cofficial\u201d version of the code, and provides both an audit trail and a basis for disaster recovery, all by packaging code into separate branches and versions.", "Containerization. Sometimes it\u2019s not enough to package the code itself. Containerization systems like Docker take care of dependency management by not only listing your code\u2019s dependencies, but actually shipping those dependencies \u2014 system tools, other libraries, and settings \u2014 with the code. It\u2019s like packaging up your entire machine so it can be handed off to and unpacked by someone else.", "Workflow automation. Sometimes, your code itself doesn\u2019t need to be portable, but the processes that use that code do need to be. Tools like Airflow allow you to specify the timing and order in which various scripts run, and specify where and howthe outputs of that process should be stored.", "This is actually a huge part of data science productionization and it doesn\u2019t get enough attention \u2014 if you try to run every process from beginning to end each time you need it (or each time you need to update it), you\u2019ll either have to run a huge amount of processes in parallel, which can get expensive, or you have to run certain processes less often, which can run counter to your business needs. By chopping processes up into intermediate pieces and storing those mid-stream results, you save computation time by being able to point downstream processes to those products rather than to the scripts that produced them, and you get an audit trail for your data. And, like the rest of your code, you can pick up those automated workflows and move them to different servers or point them at different databases without having to re-write your whole process.", "Portability decreases the time it takes to get value from your code by decreasing the amount of code you have to rewrite when your goals change.", "Let me give one example from my own experience. This is Madison Square Garden in New York City \u2014 Penn Station is underneath:", "Here are two satellite images of the same location:", "The first satellite image shows all of the mobile-device location signals we got for a single day over Penn Station. The second image shows only those locations that were visited by over 100 unique mobile devices in that one day. At first, it seems unrealistic to have hundreds or even thousands of devices to show up in single 10-centimeter squares over just 24 hours \u2014 that\u2019s what the right-hand image shows \u2014 but it might actually make some sense. The middle of Madison Square Garden is over the main waiting area for the Long Island Railroad. People sit in dedicated places in waiting areas, they congregate around open electrical outlets, etc. In short, I can\u2019t say that those locations are obviously unrealistic. Even those locations running down the avenue next to the square hotel east of the station fit with what I know about taxi waiting patterns on that street.", "So I spent a few months developing several methods for differentiating artificial locations from simple busy locations. In many cases, the locations the methods flagged weren\u2019t surprising. For example, we already knew that the geographic center of the United States is used as a dumping ground for companies when they don\u2019t know where an ip address is located. The centers of states and postal codes seem to be used similarly. But other patterns were unexpected:", "The grid pattern on the left is typical of high-density areas: centers of urban environments, airports, amusement parks, and things like that. When high buildings of multiple conflicting signals make it difficult to get a good GPS reading, many phones will revert to an older, less-precise method of location reporting, resulting in gridding. The grid pattern on the right, on the other hand, isn\u2019t actually a grid \u2014 it\u2019s a hexagonal mesh used by the Weather Company to report forecasts. Weather apps tend to report locations in this pattern. We didn\u2019t know any of that originally \u2014 we discovered the patterns, and then had to do some research to try to discover the data-generating processes.", "We had an immediate business use for the pattern-recognition models we developed: we could flag problematic locations so we could ignore them. That way, our location reporting would be based only on locations we could trust. Because we made that process portable, we could easily ingest new sources of location data and apply our filters automatically \u2014 the process that worked for one dataset worked for another. Because we version-controlled out process, we could make adjustments to our filters \u2014 add in new processes or modify old ones \u2014 without breaking any of our downstream processes. And because we automated the workflow and dropped results from these filters into intermediary products that stored the full results, we could use those results for new purposes. For example:", "The above images show a bunch of alternative possible locations \u2014 ones not flagged by our filters \u2014 that could potentially be used in place of a single untrustworthy location. Without going into too much details about the specific implementation, you can see alternative locations aren\u2019t randomly scattered across the world. In fact, they\u2019re scattered more or less across a single small town. So we can replace a bad location with a bounding box that gives us a rough idea of where devices reporting that location actually are. We even developed a cost-benefit algorithm that gave us the best balance of minimizing bounding box size while maximizing the number of trustworthy location signals used. Often, we can reduce the bounding box size until it focuses on a single home rather than a single town, and still use most of the information we have about alternative locations.", "We made that cost-benefit-balancing process portable and soon found an unanticipated use for it:", "We\u2019re interested in understanding when people visit specific locations \u2014 in particular, store visitation is important to our clients. In the images above, the dots represent the centroids of individual stores within buildings. The red dot is the store we were targeting in this instance. We only get location signals when people view apps or websites where an ad is being served, and that doesn\u2019t always happen within the actual store. It may happen on the sidewalk outside, or in the parking lot. Also, GPS signals are inherently noisy, so a phone in one store may report some of its signals in the store next door. So we\u2019ve worked on a way to tell the probability that any particular tile of ground indicates visitation to a particular store.", "You can see all of the blue tiles of ground that we\u2019ve attached to the store, along with the score for that association. We needed to tell how many tiles we should attach to the store. We used the same cost-benefit-balancing algorithm we used before (the results of which you can see below the store images) to save weeks of work using an established process in new contexts.", "That, to my mind, is the main benefit of making data science processes portable: it drastically reduces the amount of time it takes to go from recognizing a problem to deploying a solution to the problem. In a world where deadlines matter, the best tool is often the tool you\u2019ve already built. At the very least, the tool you\u2019ve already built lets you get a solution out the door, which give you the time to look for ways to improve that solution.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-founder @ aampe.co. Anthropologist + Data Scientist."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff5d1a1f2f45b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@schaun.wheeler?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@schaun.wheeler?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": "Schaun Wheeler"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2d3762e7f110&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&user=Schaun+Wheeler&userId=2d3762e7f110&source=post_page-2d3762e7f110----f5d1a1f2f45b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff5d1a1f2f45b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff5d1a1f2f45b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/ds-productionization", "anchor_text": "DS Productionization"}, {"url": "https://towardsdatascience.com/what-does-it-mean-to-productionize-data-science-82e2e78f044c", "anchor_text": "What does it mean to \u201cproductionize\u201d data science?"}, {"url": "https://towardsdatascience.com/data-science-productionization-portability-f5d1a1f2f45b", "anchor_text": "Portability"}, {"url": "https://towardsdatascience.com/data-science-productionization-maintenance-af59ce6c958", "anchor_text": "Maintenance"}, {"url": "https://towardsdatascience.com/data-science-productionization-scale-1884ca4e969e", "anchor_text": "Scale"}, {"url": "https://towardsdatascience.com/data-science-productionization-trust-b37f10b8f426", "anchor_text": "Trust"}, {"url": "https://www.python.org/dev/peps/pep-0008/#constants", "anchor_text": "Python convention for flagging constants"}, {"url": "https://www.anaconda.com/tensorflow-in-anaconda/", "anchor_text": "https://www.anaconda.com/tensorflow-in-anaconda/"}, {"url": "https://br.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow", "anchor_text": "https://br.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow"}, {"url": "https://towardsdatascience.com/data-is-a-stakeholder-31bfdb650af0", "anchor_text": "spent a few months developing several methods"}, {"url": "https://www.researchgate.net/publication/231849997_Positional_Accuracy_of_Assisted_GPS_Data_from_High-Sensitivity_GPS-enabled_Mobile_Phones", "anchor_text": "many phones will revert"}, {"url": "https://portal.enes.org/oasis/general-information/events/workshop-on-coupling-technologies-for-earth-system-modelling-today-and-tomorrow-1/talks/MDuda_mpas_meshes_framework.pdf", "anchor_text": "used by the Weather Company"}, {"url": "https://medium.com/tag/git?source=post_page-----f5d1a1f2f45b---------------git-----------------", "anchor_text": "Git"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f5d1a1f2f45b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tech?source=post_page-----f5d1a1f2f45b---------------tech-----------------", "anchor_text": "Tech"}, {"url": "https://medium.com/tag/ds-productionization?source=post_page-----f5d1a1f2f45b---------------ds_productionization-----------------", "anchor_text": "Ds Productionization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff5d1a1f2f45b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&user=Schaun+Wheeler&userId=2d3762e7f110&source=-----f5d1a1f2f45b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff5d1a1f2f45b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&user=Schaun+Wheeler&userId=2d3762e7f110&source=-----f5d1a1f2f45b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff5d1a1f2f45b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff5d1a1f2f45b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f5d1a1f2f45b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f5d1a1f2f45b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@schaun.wheeler?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@schaun.wheeler?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Schaun Wheeler"}, {"url": "https://medium.com/@schaun.wheeler/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "894 Followers"}, {"url": "http://aampe.co", "anchor_text": "aampe.co"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2d3762e7f110&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&user=Schaun+Wheeler&userId=2d3762e7f110&source=post_page-2d3762e7f110--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd8dcfa98f86c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-science-productionization-portability-f5d1a1f2f45b&newsletterV3=2d3762e7f110&newsletterV3Id=d8dcfa98f86c&user=Schaun+Wheeler&userId=2d3762e7f110&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}