{"url": "https://towardsdatascience.com/batch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f", "time": 1683010352.327411, "path": "towardsdatascience.com/batch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f/", "webpage": {"metadata": {"title": "Batch Normalization in practice: an example with Keras and TensorFlow 2.0 | by B. Chen | Towards Data Science", "h1": "Batch Normalization in practice: an example with Keras and TensorFlow 2.0", "description": "In this article, we will focus on adding and customizing batch normalization in our machine learning model and look at an example of how we do this in practice with Keras and TensorFlow 2.0. In the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/machine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e", "anchor_text": "model regularization tutorial", "paragraph_index": 13}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "machine learning repo", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Anderson Iris flower (iris)", "paragraph_index": 18}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "UCI Iris dataset", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "anchor_text": "one-hot encoding", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and TensorFlow 2.0", "paragraph_index": 27}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github", "paragraph_index": 44}], "all_paragraphs": ["In this article, we will focus on adding and customizing batch normalization in our machine learning model and look at an example of how we do this in practice with Keras and TensorFlow 2.0.", "In the rise of deep learning, one of the most important ideas has been an algorithm called batch normalization (also known as batch norm).", "Batch normalization is a technique for training very deep neural networks that standardizes the inputs to a layer for each mini-batch. This has the effect of stabilizing the learning process and dramatically reducing the number of training epochs required to train deep networks.", "Batch normalization can be implemented during training by calculating the mean and standard deviation of each input variable to a layer per mini-batch and using these statistics to perform the standardization.", "Formally, the batch normalization algorithm [1] is defined as:", "In the algorithm, B is used to denote a mini-batch of size m of the entire training set. The mean and variance of B could thus be calculated as:", "For a layer with d-dimensional input, x = (x_1, \u2026, x_d), each dimension of its input can be normalized (re-centered and rescaled) separately. Thus, the normalization for a d-dimensional input can be calculated as:", "\u03b5 is added in the denominator for numerical stability and is an arbitrarily small constant.", "And finally, to restore the representation power of the network, a transformation step is defined as:", "where the parameter \u03b2 and \u03b3 are subsequently learned in the optimization process.", "The benefits of batch normalization are [2]:", "If you are looking for a complete explanation, you might find the following resources useful:", "In the following article, we are going to add and customize batch normalization in our machine learning model.", "We will be using the same dataset as we did in the model regularization tutorial. You can skip this chapter if you are already familiar with it.", "In order to run this tutorial, you need to install", "TensorFlow 2, numpy, pandas, sklean, matplotlib", "They can all be installed directly vis PyPI and I strongly recommend to create a new Virtual Environment. For a tutorial on creating a Python virtual environment", "This is a step by step tutorial and all instructions are in this article. For source code, please check out my Github machine learning repo.", "This tutorial uses the Anderson Iris flower (iris) dataset for demonstration. The dataset contains a set of 150 records under five attributes: sepal length, sepal width, petal length, petal width, and class (known as target from sklearn datasets).", "First, let\u2019s import the libraries and obtain iris dataset from scikit-learn library. You can also download it from the UCI Iris dataset.", "For the purpose of exploring data, let\u2019s load data into a DataFrame", "And the df should look like below:", "We notice the label column is a categorical feature and will need to convert it to one-hot encoding. Otherwise, our machine learning algorithm won\u2019t be able to directly take in that as input.", "Now, the df should look like:", "Next, let\u2019s create X and y. Keras and TensorFlow 2.0 only take in Numpy array as inputs, so we will have to convert DataFrame back to Numpy array.", "Finally, let\u2019s split the dataset into a training set (80%)and a test set (20%) using train_test_split() from sklearn library.", "Great! our data is ready for building a Machine Learning model.", "There are 3 ways to create a machine learning model with Keras and TensorFlow 2.0. Since we are building a simple fully connected neural network and for simplicity, let\u2019s use the easiest way: Sequential Model with Sequential().", "First, let\u2019s import Sequential and BatchNormalization", "Let\u2019s go ahead and create a sequential model", "Our model has the following specifications:", "We can add batch normalization into our model by adding it in the same way as adding Dense layer.", "BatchNormalization() normalize the activation of the previous layer at each batch and by default, it is using the following values [3]:", "These can all be changed by adding optional arguments to BatchNormalization() . For example", "RandomNormal() generates a tensor with a normal distribution and Constant() generates a tensor with constant values. By running model.summary() you should get a model summary like below:", "Let\u2019s now compile and fit our model with batch normalization. We first compile our model with the following specifications", "After that, we can call model.fit() to fit our model to the training data.", "If all runs smoothly, we should get an output like below", "Finally, it\u2019s time to see if the model is any good by", "Let\u2019s create a function plot_metric() for plotting metrics.", "By running plot_metric(history, 'accuracy') to plot the progress on accuracy.", "By running plot_metric(history, 'loss') to plot the progress on loss.", "To evaluate the model on the test set", "And we should get an output like below", "Please checkout the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb1ec28bde96f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----b1ec28bde96f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1ec28bde96f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1ec28bde96f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Markus Winkler"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://machinelearningmastery.com/batch-normalization-for-training-of-deep-neural-networks/", "anchor_text": "Jason Brownlee"}, {"url": "https://arxiv.org/pdf/1502.03167v3.pdf", "anchor_text": "Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift"}, {"url": "https://arxiv.org/abs/1502.03167", "anchor_text": "The original paper"}, {"url": "https://www.coursera.org/lecture/deep-neural-network/normalizing-activations-in-a-network-4ptp2", "anchor_text": "Batch Normalization in Deeplearning.ai"}, {"url": "https://towardsdatascience.com/machine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e", "anchor_text": "model regularization tutorial"}, {"url": "https://towardsdatascience.com/create-virtual-environment-using-virtualenv-and-add-it-to-jupyter-notebook-6e1bf4e03415", "anchor_text": "Create Virtual Environment using \u201cvirtualenv\u201d and add it to Jupyter Notebook"}, {"url": "https://medium.com/analytics-vidhya/create-virtual-environment-using-conda-and-add-it-to-jupyter-notebook-d319a81dfd1", "anchor_text": "Create Virtual Environment using \u201cconda\u201d and add it to Jupyter Notebook"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "machine learning repo"}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Anderson Iris flower (iris)"}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "UCI Iris dataset"}, {"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "anchor_text": "one-hot encoding"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and TensorFlow 2.0"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github"}, {"url": "https://arxiv.org/pdf/1502.03167v3.pdf", "anchor_text": "Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift"}, {"url": "https://keras.io/api/layers/normalization_layers/batch_normalization/", "anchor_text": "Batch Normalization from Keras API Documentation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b1ec28bde96f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----b1ec28bde96f---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/batch-normalization?source=post_page-----b1ec28bde96f---------------batch_normalization-----------------", "anchor_text": "Batch Normalization"}, {"url": "https://medium.com/tag/keras?source=post_page-----b1ec28bde96f---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b1ec28bde96f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1ec28bde96f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&user=B.+Chen&userId=563d09da62a&source=-----b1ec28bde96f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1ec28bde96f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&user=B.+Chen&userId=563d09da62a&source=-----b1ec28bde96f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1ec28bde96f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb1ec28bde96f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b1ec28bde96f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b1ec28bde96f--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}