{"url": "https://towardsdatascience.com/kubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c", "time": 1683009243.2597718, "path": "towardsdatascience.com/kubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c/", "webpage": {"metadata": {"title": "Kubernetes Application Deployment with AWS EKS and ECR | by Janitha Tennakoon | Towards Data Science", "h1": "Kubernetes Application Deployment with AWS EKS and ECR", "description": "Kubernetes is a container orchestration platform that is created by Google in 2014. It is an open-source platform where currently many organizations widely use for container deployment and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://console.aws.amazon.com/iam/home?region=ap-southeast-1#/policies/arn%3Aaws%3Aiam%3A%3Aaws%3Apolicy%2FAmazonEC2ContainerRegistryFullAccess", "anchor_text": "AmazonEC2ContainerRegistryFullAccess", "paragraph_index": 12}], "all_paragraphs": ["Kubernetes is a container orchestration platform that is created by Google in 2014. It is an open-source platform where currently many organizations widely use for container deployment and management. Although there are other container orchestration tools are available in the community like Docker Swarm, Kubernetes remains in the top for container orchestration due to its features and flexible usability.", "Amazon Elastic Kubernetes Service is a service provided for Kubernetes on AWS infrastructure. Like any other service offered by AWS, Kubernetes resources will be fully managed by AWS themselves, which gives less overload for developers on maintaining them. AWS also make sure that these resources are highly available and reliable every time.", "Amazon Elastic Container Registry is a fully managed Docker registry provided by AWS. Just like the popular docker registry Dockerhub, ECR also supports private and public repositories which are very secure. We can either push or pull images to ECR using AWS CLI.", "In this article, we are going to explore how we can deploy Kubernetes applications using AWS EKS and ECR services. Before going into complex details about how we are going to implement our Kubernetes solution below is the summary of tasks that we will be performing.", "Now I hope you have at least a little bit of an idea about what we are going to cover in this article. Before we start implementing we need to have the following prerequisites available in our development machines.", "After fulfilling our prerequisites first task will be to creating a simple server. I am using Node.js with express to create a very simple web application that will be listening on port 3000.", "Next, let\u2019s dockerize our web application. For that create a Dockerfile and issue docker build command.", "Now if you issue docker images we will see our webapp image. The next task is to push our image to AWS ECR.", "Before we can push the image we need to create a repository on ECR. For that go to the ECR dashboard and click Create Repository.", "Now we have a repository to push our image. But before that, we need to authenticate our AWS CLI to push images to our repository. For that issue below command.", "After that tag the image with our repository name. Here as the version, you can give any version, but in this instance, I am going to make the version as latest.", "Now the last step, push our image to the ECR repository.", "If you get any permission issues make sure your AWS CLI role has permission AmazonEC2ContainerRegistryFullAccess.", "Now go to our repository and the image we pushed should be available there.", "The next step would be to create our EKS cluster. When we create our cluster, we need to specify the VPC subnets for our cluster to use. Amazon EKS requires subnets in at least two Availability Zones. When creating VPC we have two options.", "In this article, we are going to create a combination of public and private subnets. In that case, our web application can be externally accessed by using a public subnet, also if we need to deploy something like database then we can make them private which will be only accessible by our web application and any other application within the VPC.", "VPC for our cluster can be created manually if we want. But let\u2019s create our VPC using AWS Cloudformation because AWS already has a template for creating a public and private subnet VPC.", "In the end, select Create and wait until the stack is created. At the end of the stack creation, it will give 3 outputs.", "We can create clusters easily by giving eksctl create cluster command. But let\u2019s create a YAML file with additional configurations below.", "In the above cluster.yaml file, we define the following configurations for our cluster.", "Now issue below command to create our cluster on EKS.", "After that eksctl will start creating our cluster according to our YAML file. Creating the cluster and nodes will take several minutes. At the get issue following command to check whether our cluster is deployed.", "Sometimes you may get the following error when you issue the kubectl command. This might mean that in our kubectl config file, credentials and users required to access our cluster is not defined.", "To write these configuration details to config file issue following command.", "Now let\u2019s start to deploy our application on the created Kubernetes cluster. First, to deploy our application on pods, we need to create a deployment. Below is the deployment manifest that will be used for deployment.", "Issue following command to create our deployment.", "To check whether our deployment created, issue below command.", "Now we can see that our deployment is created and is running on two pods.", "Now to access our application, we need to create a service. Our service type will be Nodeport because we need our application to access from outside.", "To create our service issue below command", "To check whether our service created, issue below command.", "Now let\u2019s try to access our web application externally. From the service, we know that our application is listening on port 31479. Next, we need to acquire the public IP address of our application nodes. Let\u2019s first try to identify where are the pods of our application are running.", "From that, we can identify the nodes of the pods that our application is running. To get the external IP addresses of those nodes, issue the get nodes command.", "In the above nodes list, we can see two of our nodes have external IPs while one does not have because we configured it as a private worker node. Now we have our IP addresses as well as the port it is listening. The next task will be to add this port in the node\u2019s security group to allow traffic in. For that identify security group created for nodes and add an inbound rule to allow traffic in port 31479.", "After that, we can get a public node IP address and call to it with port 31479.", "We can also do the same with other IP address and the result should be the same.", "The next task would be to deploy a database into our Kubernetes cluster. But I will leave that task for you to try out. After that make sure to delete the cluster by giving below command to avoid charges on EC2 instances we created.", "That is it for how to create and deploy applications to Kubernetes using AWS EKS and ECR. There are so many other concepts inside Kubernetes as well as on EKS that we can learn. So make sure to learn more and more until you feel the confidence to deploy and manage applications. Thank you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Associate Tech Lead | AWS Community Builder from Sri Lanka currently working in Singapore."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4600e11b2d3c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://janitha000.medium.com/?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": ""}, {"url": "https://janitha000.medium.com/?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": "Janitha Tennakoon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fd45980958d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&user=Janitha+Tennakoon&userId=1fd45980958d&source=post_page-1fd45980958d----4600e11b2d3c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4600e11b2d3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4600e11b2d3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@clemhlrdt?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Cl\u00e9ment H"}, {"url": "https://towardsdatascience.com/s/photos/computer?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://kubernetes.io/docs/tasks/tools/install-kubectl/", "anchor_text": "https://kubernetes.io/docs/tasks/tools/install-kubectl/"}, {"url": "https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html", "anchor_text": "https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html"}, {"url": "https://docs.aws.amazon.com/eks/latest/userguide/install-aws-iam-authenticator.html", "anchor_text": "https://docs.aws.amazon.com/eks/latest/userguide/install-aws-iam-authenticator.html"}, {"url": "https://github.com/weaveworks/eksctl", "anchor_text": "ttps://github.com/weaveworks/eksctl"}, {"url": "https://console.aws.amazon.com/iam/home?region=ap-southeast-1#/policies/arn%3Aaws%3Aiam%3A%3Aaws%3Apolicy%2FAmazonEC2ContainerRegistryFullAccess", "anchor_text": "AmazonEC2ContainerRegistryFullAccess"}, {"url": "https://amazon-eks.s3.us-west-2.amazonaws.com/cloudformation/2020-06-10/amazon-eks-vpc-private-subnets.yaml", "anchor_text": "https://amazon-eks.s3.us-west-2.amazonaws.com/cloudformation/2020-06-10/amazon-eks-vpc-private-subnets.yaml"}, {"url": "https://medium.com/tag/kubernetes?source=post_page-----4600e11b2d3c---------------kubernetes-----------------", "anchor_text": "Kubernetes"}, {"url": "https://medium.com/tag/aws?source=post_page-----4600e11b2d3c---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/docker?source=post_page-----4600e11b2d3c---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/tag/containers?source=post_page-----4600e11b2d3c---------------containers-----------------", "anchor_text": "Containers"}, {"url": "https://medium.com/tag/container-orchestration?source=post_page-----4600e11b2d3c---------------container_orchestration-----------------", "anchor_text": "Container Orchestration"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4600e11b2d3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&user=Janitha+Tennakoon&userId=1fd45980958d&source=-----4600e11b2d3c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4600e11b2d3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&user=Janitha+Tennakoon&userId=1fd45980958d&source=-----4600e11b2d3c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4600e11b2d3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4600e11b2d3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4600e11b2d3c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4600e11b2d3c--------------------------------", "anchor_text": ""}, {"url": "https://janitha000.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://janitha000.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Janitha Tennakoon"}, {"url": "https://janitha000.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "459 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fd45980958d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&user=Janitha+Tennakoon&userId=1fd45980958d&source=post_page-1fd45980958d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc03af888eea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkubernetes-application-deployment-with-aws-eks-and-ecr-4600e11b2d3c&newsletterV3=1fd45980958d&newsletterV3Id=c03af888eea6&user=Janitha+Tennakoon&userId=1fd45980958d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}