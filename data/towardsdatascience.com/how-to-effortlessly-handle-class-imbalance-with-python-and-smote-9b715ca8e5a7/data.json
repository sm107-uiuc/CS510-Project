{"url": "https://towardsdatascience.com/how-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7", "time": 1683017310.835414, "path": "towardsdatascience.com/how-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7/", "webpage": {"metadata": {"title": "How to Effortlessly Handle Class Imbalance with Python and SMOTE | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "How to Effortlessly Handle Class Imbalance with Python and SMOTE", "description": "How many times did you get a 99% accurate model that\u2019s unusable? Building classification models is no-joke, especially when there\u2019s a class imbalance in your data. You know, when there\u2019s only one\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/dark06thunder/credit-card-dataset", "anchor_text": "Here\u2019s", "paragraph_index": 11}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 38}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 40}], "all_paragraphs": ["How many times did you get a 99% accurate model that\u2019s unusable? Building classification models is no-joke, especially when there\u2019s a class imbalance in your data. You know, when there\u2019s only one fraud in 1000 transactions.", "You see, identifying 950 of 999 genuine transactions is easy. The trick is to correctly identify a single fraud case \u2014 every time.", "Reading feels like a nightmare? There\u2019s an easy solution:", "That\u2019s where SMOTE (Synthetic Minority Over-sampling Technique) comes in handy. You can use it to oversample the minority class. SMOTE is a type of data augmentation that synthesizes new samples from the existing ones.", "Yes \u2014 SMOTE actually creates new samples. It is light years ahead from simple duplication of the minority class. That approach stupidly creates \u201cnew\u201d data points by duplicating existing ones. As a result, no new information is brought to the dataset.", "But how does SMOTE do it?", "It selects samples in the minority class that are close and then draws lines between them. New sample points are located on these lines.", "To be more precise, a random sample is chosen, and then a KNN algorithm is used to select neighbors to which lines are drawn. With this procedure, you can create as many synthetic samples as needed. This makes SMOTE perfect for datasets of all sizes.", "The only real downside is that synthetic examples are created without \u201cconsulting\u201d the majority class. This could result in overlapping samples in both classes.", "That\u2019s the only theory you\u2019ll need to understand this article.", "Here are the topics covered next:", "So you need a classification dataset that suffers from a class imbalance problem. Something like credit card fraud detection should do. Here\u2019s one from Kaggle you can download for free.", "Here\u2019s how to load it with Python:", "There are twenty-something columns which you\u2019ll prepare in a bit. First, let\u2019s explore the target class distribution:", "Yikes. Only around 1.68% of transactions are classified as fraud. A great recipe to make high-accuracy low-recall models. More on that in a bit.", "You can\u2019t pass a dataset to a machine learning algorithm in this form. Some preparation is a must.", "You won\u2019t spend much time here. The goal is to get a minimum viable dataset for machine learning.", "Here\u2019s the list of initial changes:", "The dataset now looks like this:", "Better, but still needs a bit of work. Notice how larger the values are in income than in no_of_child. That\u2019s expected, but machine learning algorithms will give more importance to variables on a larger scale. Introducing data scaling.", "You\u2019ll use MinMaxScaler from scikit-learn to scale columns that have values greater than 1 to [0, 1] range. Here\u2019 how:", "Here\u2019s how the dataset looks now:", "Much better \u2014 everything is in the [0, 1] range, all columns are numerical, and there are no missing values.", "This means one thing \u2014 the dataset is machine learning ready.", "Let\u2019s start with a naive approach. You\u2019ll create a Random Forest model on the dataset and completely ignore the class imbalance.", "To start, you\u2019ll have to split the dataset into training and testing portions. There\u2019s only 1.68% of fraud transactions in the entire dataset. Ideally, you want the percentage roughly the same in the train and test sets.", "Here\u2019s how to do the split and check the percentage of the positive class:", "Onto the modeling now. Let\u2019s make it as simple as possible. You\u2019ll train a Random Forest classifier on the train set and evaluate it on the test set. Confusion matrix, accuracy score, and recall score will tell you just how bad is it:", "The model is 98% accurate, so where\u2019s the problem?", "Yes, it can correctly classify almost all genuine transactions. But it also classified 91% of fraud transactions as genuine. In a nutshell \u2014 the model is unusable.", "Class imbalance killed its performance. SMOTE can help.", "You already know what SMOTE is, and now you\u2019ll see how to install it and use it. Execute the following command from Terminal:", "You can now apply SMOTE to features (X) and the target (y) and store the results in dedicated variables. The new feature and target set is larger, due to oversampling. Here\u2019s the code for applying SMOTE:", "There are 37K data points instead of 25K, and the class balance is perfect \u2014 50:50. You\u2019ll train the model on a new dataset next:", "The resulting model is usable, to say at least. SMOTE did its job, and it resulted in a model that significantly outperformed its previous version.", "And there you have it \u2014 SMOTE in a nutshell. You can use it whenever a dataset suffers from a class imbalance problem. The go-to approach nowadays is to use both undersampling and oversampling, but that\u2019s a topic for another time.", "Just for fun, you can compare the misclassifications of both models. By doing so, you could see if the model built after oversampling still misclassifies the same data points.", "How do you handle class imbalance? Let me know in the comments below.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9b715ca8e5a7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----9b715ca8e5a7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b715ca8e5a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b715ca8e5a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@talescrow?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ari He"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/dark06thunder/credit-card-dataset", "anchor_text": "Here\u2019s"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----9b715ca8e5a7---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9b715ca8e5a7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9b715ca8e5a7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9b715ca8e5a7---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----9b715ca8e5a7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b715ca8e5a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----9b715ca8e5a7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b715ca8e5a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----9b715ca8e5a7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b715ca8e5a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9b715ca8e5a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9b715ca8e5a7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9b715ca8e5a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-effortlessly-handle-class-imbalance-with-python-and-smote-9b715ca8e5a7&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}