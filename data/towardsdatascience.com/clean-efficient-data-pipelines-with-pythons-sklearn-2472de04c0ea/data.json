{"url": "https://towardsdatascience.com/clean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea", "time": 1683013226.8577101, "path": "towardsdatascience.com/clean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea/", "webpage": {"metadata": {"title": "Pre-Process Data like a Pro: Intro to Scikit-Learn Pipelines | by Guillermo Perez | Towards Data Science", "h1": "Pre-Process Data like a Pro: Intro to Scikit-Learn Pipelines", "description": "You wrote all your queries, gathered all the data and are all fired up to implement the latest machine learning algorithm you read about on Medium. Wait! You soon realize you need to deal with\u2026"}, "outgoing_paragraph_urls": [{"url": "http://insideairbnb.com/", "anchor_text": "insideairbnb.com", "paragraph_index": 6}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html", "anchor_text": "it as an argument.", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/all-about-feature-scaling-bcc0ad75cb35", "anchor_text": "here.", "paragraph_index": 20}, {"url": "https://scikit-learn.org/stable/developers/develop.html", "anchor_text": "examples", "paragraph_index": 25}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Scikit-Learn documentation", "paragraph_index": 34}, {"url": "https://github.com/gperez1138/data-wrangling-tutorial", "anchor_text": "git repository", "paragraph_index": 37}, {"url": "https://www.linkedin.com/in/gperez1138/", "anchor_text": "linkedin", "paragraph_index": 38}], "all_paragraphs": ["\u201cWithout a systematic way to start and keep data clean, bad data will happen.\u201d", "You wrote all your queries, gathered all the data and are all fired up to implement the latest machine learning algorithm you read about on Medium. Wait! You soon realize you need to deal with missing data, imputation, categorical data, standardization, etc.", "Instead of \u201cmanually\u201d pre-processing data you can start writing functions and data pipelines that you can apply to any data set. Luckily for us, python\u2019s Scikit-Learn library has several classes that will make all of this a piece of cake!", "In this article you will learn how to :", "tl:dr: Let\u2019s build a pipeline where we can impute, transform, scale, and encode like this:", "Without knowing much you can infer that different transformations are applied to numerical variables and categorical variables. Let\u2019s go into the proverbial weeds and see how we end up with this pipeline.", "For all of these examples, I will be using the airbnb NYC listings dataset from insideairbnb.com . This is a real dataset containing information scraped from airbnb and has all the information related to a listing on the site.", "Let us imagine we want to predict the price of a listing given some variables like the property type and neighborhood.", "Let\u2019s start by getting our categorical and numerical variables that we want to work with. We will keep it simple by removing data with missing values in our categorical variables of interest and with no reviews.", "Is a dataset even real if it isn\u2019t missing data? The reality is that we have to deal with missing data all the time. You will have to decide how to deal with missing data for your specific use", "Scikit-Learn provides us with a nice simple class to deal with missing values.", "Let us impute numerical variables such as price or security deposit with the median. For simplicity, we do this for all numerical variables.", "The SimpleImputer class will replace all the missing values with the median. The .fit_transform() method will return a nice numpy array object that is ready to be used with any machine learning method. You can choose different metrics and pass it as an argument.", "Numerical variables are pretty straightforward. Let us deal with categorical data that usually comes in strings. In this case, we have to deal with variables such as neighborhood, room_type, bed_type. Machine Learning algorithms work better with numbers, so we will convert our categorical variables.", "We use the OrdinalEncoder to convert our string data to numbers. Each unique value in the variables will be mapped to a number. E.g Apartment =0, Condominium=1, etc.", "Are we done? Not yet. ML algos can take things a little to literally and think that categories 1 and 2 are more similar than 1 and 19. This might be good for ratings or things where there is an order but how about neighborhoods? Can this simple encoder differentiate the vibes of SoHo and TriBeCa? Does it know all the normies work in Midtown?", "We can transform our data to have a singular attribute per category. For Example, we create an attribute equal to 1 when the \u2018property_type\u2019 is \u2018House\u2019 and 0 otherwise. Repeat for all other categories.", "This process is called one-hot encoding. If you come from a stats or econometrics background these are called dummy variables/attributes.", "A wild sparse matrix appears! Instead of a NumPy array the encoder returns a sparse matrix which is very convenient when we have several categorical attributes with hundreds of categories.", "The matrix is full of 0s except for a single 1 per row. This would use a lot of memory to store but the spare matrix is smart and stores only the location of the nonzero elements.", "It is very important to scale our data when using machine learning algorithms. There are exceptions, but when the variables are in different scales we usually need to scale them. You can read all about it here.", "A couple of ways to do it:", "Scikit-Learn API is very flexible lets you create your own custom \u201ctransformation\u201d that you can easily incorporate into your process. You just need to implement the fit(), transform(), and fit_transform() methods.", "Adding the TransformerMixin as a base class gets you the fit_transform() method automatically.", "Here we have a very simple transformer that creates the ratio of rating to number of reviews. You can make these as complicated as you wish.", "Checkout the Scikit-Learn documentation for more details and examples.", "We can finally put everything together! One dataset can require several transformations which vary according to the variable type. These must also be performed in the right order.", "Scikit-Learn gifts us the Pipeline class to help with this ubiquitous process to write clean and efficient code.", "We created a pipeline for our numerical variables. The Pipeline constructor takes in a list of (\u2018Estimator Name\u2019, Estimator()) pairs. All estimators except the last one must have the fit_transform() method. They must be transformers. The names should be informative but you can put whatever you want.", "Let us complete our pipeline with our categorical data and create our \u201cmaster\u201d Pipeline", "We can combine different pipelines applied to different sets of variables. Here we are applying our numerical pipeline (Impute, Transform, Scale) to the numerical variables (num_vars is a list of column names) and do hot encoding to our categorical variables (cat_vars is a list of column names).", "The ColumnTransformer class will do exactly what the name implies. It will apply the pipeline or transformer to a specified list of variables.", "It takes in a list of tuples with (\u2018name\u2019, transformer/pipeline, \u2018variables list\u2019)", "Once we have set up and defined our pipeline process, we can apply it to any dataset or fresh new data easily with the fit_transform() method.", "Now you know the basics of implementing clean and efficient pipelines that can be easily organized and utilized on different datasets. For more detailed information reference the Scikit-Learn documentation", "Why stop at pre-processing? In the pipeline you can finish with the training of your model. Here is a quick complete example:", "Once you have your data transformation setup, you can include the training as another \u201cestimator\u201d in your pipeline. Your pipeline can be used as any other estimator. SVC() is included at the end and will use the scaled data passed to it. You can then reuse this pipeline for many other machine learning algorithms or datasets.", "Hopefully, this framework will help you write neat code that is easy to maintain. You can find this airbnb complete working example in a jupyter notebook in this git repository.", "Do clap and share if you found this worthy and helpful. Follow me or feel free to connect on linkedin.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist sharing thoughts on wine, motorcycles, self improvement -oh and data science!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2472de04c0ea&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://guillermo-perez.medium.com/?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": ""}, {"url": "https://guillermo-perez.medium.com/?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": "Guillermo Perez"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fecd0c64f1461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&user=Guillermo+Perez&userId=ecd0c64f1461&source=post_page-ecd0c64f1461----2472de04c0ea---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2472de04c0ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2472de04c0ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mahiruysal?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Mahir Uysal"}, {"url": "https://unsplash.com/s/photos/cowboy?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://insideairbnb.com/", "anchor_text": "insideairbnb.com"}, {"url": "http://data.insideairbnb.com/united-states/ny/new-york-city/2020-07-07/data/listings.csv.gz'", "anchor_text": "http://data.insideairbnb.com/united-states/ny/new-york-city/2020-07-07/data/listings.csv.gz'"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html", "anchor_text": "it as an argument."}, {"url": "https://www.6sqft.com/hilarious-infographic-of-manhattan-stereotypes-is-spot-on/", "anchor_text": "6sqft"}, {"url": "https://towardsdatascience.com/all-about-feature-scaling-bcc0ad75cb35", "anchor_text": "here."}, {"url": "https://scikit-learn.org/stable/developers/develop.html", "anchor_text": "examples"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Scikit-Learn documentation"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Scikit-Learn documentation"}, {"url": "https://github.com/gperez1138/data-wrangling-tutorial", "anchor_text": "git repository"}, {"url": "https://www.linkedin.com/in/gperez1138/", "anchor_text": "linkedin"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2472de04c0ea---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data?source=post_page-----2472de04c0ea---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/python?source=post_page-----2472de04c0ea---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-preprocessing?source=post_page-----2472de04c0ea---------------data_preprocessing-----------------", "anchor_text": "Data Preprocessing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2472de04c0ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&user=Guillermo+Perez&userId=ecd0c64f1461&source=-----2472de04c0ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2472de04c0ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&user=Guillermo+Perez&userId=ecd0c64f1461&source=-----2472de04c0ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2472de04c0ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2472de04c0ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2472de04c0ea---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2472de04c0ea--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2472de04c0ea--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2472de04c0ea--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2472de04c0ea--------------------------------", "anchor_text": ""}, {"url": "https://guillermo-perez.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://guillermo-perez.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Guillermo Perez"}, {"url": "https://guillermo-perez.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "18 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fecd0c64f1461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&user=Guillermo+Perez&userId=ecd0c64f1461&source=post_page-ecd0c64f1461--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce15f161793f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclean-efficient-data-pipelines-with-pythons-sklearn-2472de04c0ea&newsletterV3=ecd0c64f1461&newsletterV3Id=ce15f161793f&user=Guillermo+Perez&userId=ecd0c64f1461&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}