{"url": "https://towardsdatascience.com/reduce-dimensions-for-single-cell-4224778a2d67", "time": 1682999775.653745, "path": "towardsdatascience.com/reduce-dimensions-for-single-cell-4224778a2d67/", "webpage": {"metadata": {"title": "Reduce Dimensions for Single Cell | by Nikolay Oskolkov | Towards Data Science", "h1": "Reduce Dimensions for Single Cell", "description": "This is the eighth article in the column Mathematical Statistics and Machine Learning for Life Sciences where I try to cover analytical techniques common for Bioinformatics, Biomedicine, Genetics\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/tagged/stats-ml-life-sciences?source=post_page---------------------------", "anchor_text": "Mathematical Statistics and Machine Learning for Life Sciences", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Single_cell_sequencing", "anchor_text": "single cell genomics", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "tSNE", "paragraph_index": 0}, {"url": "https://github.com/lmcinnes/umap", "anchor_text": "UMAP", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "Curse of Dimensionality", "paragraph_index": 1}, {"url": "https://academic.oup.com/bioinformatics/article/35/16/2865/5258099", "anchor_text": "dropout", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Heaviside_step_function", "anchor_text": "Heaviside step function", "paragraph_index": 3}, {"url": "https://www.nature.com/articles/s41467-018-07582-3", "anchor_text": "Cancer Associated Fibroblasts (CAFs)", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/modules/manifold.html", "anchor_text": "scikit-learn manifold learning", "paragraph_index": 5}, {"url": "https://github.com/NikolayOskolkov/DimReductSingleCell", "anchor_text": "github", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Signal_processing", "anchor_text": "signal processing", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Text_mining", "anchor_text": "text mining", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Metagenomics", "anchor_text": "Metagenomics", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/RNA-Seq", "anchor_text": "RNA sequencing", "paragraph_index": 7}, {"url": "https://github.com/NikolayOskolkov/DimReductSingleCell", "anchor_text": "github", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Simplex", "anchor_text": "Simplex", "paragraph_index": 9}, {"url": "https://arxiv.org/abs/1802.03426", "anchor_text": "math behind UMAP", "paragraph_index": 9}, {"url": "https://github.com/NikolayOskolkov/DimReductSingleCell", "anchor_text": "github", "paragraph_index": 11}, {"url": "https://medium.com/u/8570b484f56c?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "Nikolay Oskolkov", "paragraph_index": 11}, {"url": "http://linkedin.com/in/nikolay-oskolkov-abb321186?source=post_page---------------------------", "anchor_text": "Linkedin", "paragraph_index": 11}], "all_paragraphs": ["This is the eighth article in the column Mathematical Statistics and Machine Learning for Life Sciences where I try to cover analytical techniques common for Bioinformatics, Biomedicine, Genetics, Evolutionary Science etc. Today we are going to talk about dimension reduction techniques applied to single cell genomics data. Among others, we are going to compare linear and non-linear dimension reduction techniques in order to understand why tSNE and UMAP became golden standard for Single Cell biology.", "Single cell genomics is a high dimensional data with approximately 20 000 dimensions corresponding to the protein coding genes. Usually not all of the genes are equally important for the cellular function, i.e. there are redundant genes which can be eliminated from the analysis in order to simplify the data complexity and overcome the Curse of Dimensionality. To exclude redundant genes and project the data onto a latent space where the hidden stricture of the data becomes transparent is the goal of dimension reduction.", "Principal Component Analysis (PCA) is a basic linear dimension reduction technique which has been widely recognized to be inappropriate for the single cell data due to their highly non-linear structure. Intuitively the non-linearity comes from the large fraction of stochastic zeros in the expression matrix due to the dropout effect. Typically, single cell data have 60\u201380% zero elements in the expression matrix. In this way, single cell data are similar to image data where e.g. for the images of hand-written digits MNIST data set we have 86% of pixels having zero intensity.", "This large percentage of stochastic zeros in the expression matrix makes the data behave similar to the non-linear Heaviside step function, i.e. the gene expression is either zero or non-zero regardless of how much \u201cnon-zero\u201d. Let us demonstrate basic linear and non-linear dimension reduction techniques applied to the Cancer Associated Fibroblasts (CAFs) single cell data set.", "We are going to start with the linear dimension reduction techniques. Here we read and log-transform the single cell CAFs expression data, the latter can be viewed as a way to normalize the data. As usually, the columns are genes and the rows are cells, the last column corresponds to the IDs of the 4 populations (clusters) found previously in the CAFs data set.", "Now we are going to apply the most popular linear dimensionality reduction techniques using the scikit-learn manifold learning library. Check my github for the complete script, here for simplicity I show only the codes for the Linear Discriminant Analysis (LDA):", "What we can immediately conclude is that the linear dimensionality reduction techniques can not fully resolve the heterogeneity in the single cell data. For instance, the small yellow cluster does not seem to be distinct from the other 3 cell clusters. The only exception is the LDA plot, however this is not a truly unsupervised learning method as in contrast to the rest it uses the cell labels in order to construct the latent features where the classes are most separable from each other. Thus the linear dimension reduction techniques are good at preserving the global structure of the data (connections between all the data points) while it seems that for single cell data it is more important to keep the local structure of the data (connections between neighboring points).", "It is really fascinating to observe how the data is converted into the latent low-dimensional representation, and each of the dimension reduction techniques deserves its own article. It is interesting to think about why basically each of the techniques is applicable in one particular research area and not common in other areas. For example, Independent Component Analysis (ICA) is used in signal processing, Non-Negative Matrix Factorization (NMF) is popular for text mining, Non-Metric Multi-Dimensional Scaling (NMDS) is very common in Metagenomics analysis etc., but it is rare to see e.g. NMF to be used for RNA sequencing data analysis.", "We turn to the non-linear dimension reduction techniques and check whether they are capable of resolving all hidden structure in the single cell data. Again, complete codes can be found on the github, here for simplicity I show only the code for the tSNE algorithm which is known to have difficulty handling really high dimensional data and hence is common to be run on 20\u201350 pre-reduced dimensions with e.g. PCA.", "Here we see that most of the non-linear dimensionality reduction techniques have successfully resolved the small yellow cluster via preserving the local structure (connections between neighboring points) of the data. For instance, the Locally Linear Embedding (LLE) approximates the non-linear manifold by a collection of locally linear planar surfaces which happens to be crucial for reconstructing the rare cell populations such as the small yellow cluster. The best visualization though comes from tSNE and UMAP. The former captures the local structure as well as LLE, and seems to work on raw expression data in this particular case, however a pre-dimension reduction with PCA provides typically more condensed and distinct clusters. In contrast, UMAP preserves both the local and the global data structure and is based on the topological data analysis where a manifold is represented as a collection of elementary Simplex units, this ensures that the distances between the data points do not look all equal in the high-dimensional manifold but there is a distribution of distances similar to the 2D space. In other words, UMAP is an elegant attempt to beat the Curse of Dimensionality, and I am going to dedicate a separate post to the math behind UMAP.", "In this post, we have learnt that single cell genomics data have a non-linear structure which comes from the large proportion of stochastic zeros in the expression matrix due to the drop out effect. The linear manifold learning techniques preserve the global structure of the data and are not capable of fully resolving all cell populations present. In contrast, preserving the local connectivity between the data points (LLE, tSNE, UMAP) is the key factor for a successful dimensionality reduction of single cell genomics data.", "In the comments below let me know which analyses in Life Sciences seem especially mysterious to you and I will try to address them in this column. Check the codes from the post on my github. Follow me at Medium Nikolay Oskolkov, in Twitter @NikolayOskolkov and connect in Linkedin. Next time we will cover unsupervised OMICs integration, stay tuned.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4224778a2d67&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4224778a2d67--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nikolay-oskolkov.medium.com/?source=post_page-----4224778a2d67--------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8570b484f56c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&user=Nikolay+Oskolkov&userId=8570b484f56c&source=post_page-8570b484f56c----4224778a2d67---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4224778a2d67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4224778a2d67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/stats-ml-life-sciences", "anchor_text": "Mathematical Statistics and Machine Learning for Life Sciences"}, {"url": "https://www.nature.com/articles/nbt.4314.pdf", "anchor_text": "image source"}, {"url": "https://towardsdatascience.com/tagged/stats-ml-life-sciences?source=post_page---------------------------", "anchor_text": "Mathematical Statistics and Machine Learning for Life Sciences"}, {"url": "https://en.wikipedia.org/wiki/Single_cell_sequencing", "anchor_text": "single cell genomics"}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "tSNE"}, {"url": "https://github.com/lmcinnes/umap", "anchor_text": "UMAP"}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "Curse of Dimensionality"}, {"url": "https://academic.oup.com/bioinformatics/article/35/16/2865/5258099", "anchor_text": "dropout"}, {"url": "https://nlml.github.io/in-raw-numpy/in-raw-numpy-t-sne/", "anchor_text": "image source"}, {"url": "https://en.wikipedia.org/wiki/Heaviside_step_function", "anchor_text": "Heaviside step function"}, {"url": "https://www.nature.com/articles/s41467-018-07582-3", "anchor_text": "Cancer Associated Fibroblasts (CAFs)"}, {"url": "https://scikit-learn.org/stable/modules/manifold.html", "anchor_text": "scikit-learn manifold learning"}, {"url": "https://github.com/NikolayOskolkov/DimReductSingleCell", "anchor_text": "github"}, {"url": "https://www.nature.com/articles/s41467-018-07582-3", "anchor_text": "CAFs single cell"}, {"url": "https://jakevdp.github.io/PythonDataScienceHandbook/05.10-manifold-learning.html", "anchor_text": "image source"}, {"url": "https://en.wikipedia.org/wiki/Signal_processing", "anchor_text": "signal processing"}, {"url": "https://en.wikipedia.org/wiki/Text_mining", "anchor_text": "text mining"}, {"url": "https://en.wikipedia.org/wiki/Metagenomics", "anchor_text": "Metagenomics"}, {"url": "https://en.wikipedia.org/wiki/RNA-Seq", "anchor_text": "RNA sequencing"}, {"url": "https://github.com/NikolayOskolkov/DimReductSingleCell", "anchor_text": "github"}, {"url": "https://www.nature.com/articles/s41467-018-07582-3", "anchor_text": "CAFs single cell"}, {"url": "https://en.wikipedia.org/wiki/Simplex", "anchor_text": "Simplex"}, {"url": "https://arxiv.org/abs/1802.03426", "anchor_text": "math behind UMAP"}, {"url": "https://github.com/NikolayOskolkov/DimReductSingleCell", "anchor_text": "github"}, {"url": "https://medium.com/u/8570b484f56c?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "http://linkedin.com/in/nikolay-oskolkov-abb321186?source=post_page---------------------------", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4224778a2d67---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4224778a2d67---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/stats-ml-life-sciences?source=post_page-----4224778a2d67---------------stats_ml_life_sciences-----------------", "anchor_text": "Stats Ml Life Sciences"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----4224778a2d67---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/clustering?source=post_page-----4224778a2d67---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4224778a2d67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&user=Nikolay+Oskolkov&userId=8570b484f56c&source=-----4224778a2d67---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4224778a2d67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&user=Nikolay+Oskolkov&userId=8570b484f56c&source=-----4224778a2d67---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4224778a2d67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4224778a2d67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4224778a2d67---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4224778a2d67--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4224778a2d67--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4224778a2d67--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4224778a2d67--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4224778a2d67--------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "https://nikolay-oskolkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8570b484f56c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&user=Nikolay+Oskolkov&userId=8570b484f56c&source=post_page-8570b484f56c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff4a74ad409c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freduce-dimensions-for-single-cell-4224778a2d67&newsletterV3=8570b484f56c&newsletterV3Id=f4a74ad409c6&user=Nikolay+Oskolkov&userId=8570b484f56c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}