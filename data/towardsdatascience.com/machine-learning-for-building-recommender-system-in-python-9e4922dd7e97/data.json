{"url": "https://towardsdatascience.com/machine-learning-for-building-recommender-system-in-python-9e4922dd7e97", "time": 1683011938.219842, "path": "towardsdatascience.com/machine-learning-for-building-recommender-system-in-python-9e4922dd7e97/", "webpage": {"metadata": {"title": "Machine Learning for Building Recommender System in Python | by Yuefeng Zhang, PhD | Towards Data Science", "h1": "Machine Learning for Building Recommender System in Python", "description": "Recommender systems are widely used in product recommendations such as recommendations of music, movies, books, news, research articles, restaurants, etc. [1][5][9][10]. The collaborative filtering\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Recommender_system", "anchor_text": "Recommender systems", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm", "anchor_text": "Nearest Neighbor algorithm", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Machine_learning", "anchor_text": "machine learning", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Matrix_factorization_(recommender_systems)#:~:text=Matrix%20factorization%20is%20a%20class,two%20lower%20dimensionality%20rectangular%20matrices.", "anchor_text": "Matrix factorization", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Singular_value_decomposition", "anchor_text": "singular value decomposition", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Bayesian_networks", "anchor_text": "Bayesian networks", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Cluster_Analysis", "anchor_text": "clustering models", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Collaborative_filtering#cite_note-Suetal2009-5", "anchor_text": "[5]", "paragraph_index": 13}, {"url": "http://surpriselib.com/", "anchor_text": "Surprise", "paragraph_index": 17}, {"url": "https://spark.apache.org/docs/latest/mllib-collaborative-filtering.html#:~:text=Tutorial-,Collaborative%20filtering,commonly%20used%20for%20recommender%20systems.&text=mllib%20currently%20supports%20model%2Dbased,spark.", "anchor_text": "Spark RDD-based API for collaborative filtering", "paragraph_index": 17}, {"url": "https://github.com/databricks/koalas", "anchor_text": "Koalas", "paragraph_index": 40}], "all_paragraphs": ["Recommender systems are widely used in product recommendations such as recommendations of music, movies, books, news, research articles, restaurants, etc. [1][5][9][10].", "There are two popular methods for building recommender systems:", "The collaborative filtering method [5][10] predicts (filters) the interests of a user on a product by collecting preferences information from many other users (collaborating). The assumption behind the collaborative filtering method is that if a person P1 has the same opinion as another person P2 on an issue, P1 is more likely to share P2\u2019s opinion on a different issue than that of a randomly chosen person [5].", "Content-based filtering method [6][9] utilizes product features/attributes to recommend other products similar to what the user likes, based on other users\u2019 previous actions or explicit feedback such as rating on products.", "A recommender system may use either or both of these two methods.", "In this article, I use the Kaggle Netflix prize data [2] to demonstrate how to use model-based collaborative filtering method to build a recommender system in Python.", "The rest of the article is arranged as follows:", "As described in [5], the main idea behind collaborative filtering is that one person often gets the best recommendations from another with similar interests. Collaborative filtering uses various techniques to match people with similar interests and make recommendations based on shared interests.", "The high-level workflow of a collaborative filtering system can be described as follows:", "Typically a collaborative filtering system recommends products to a given user in two steps [5]:", "This is called user-based collaborative filtering. One specific implementation of this method is the user-based Nearest Neighbor algorithm.", "As an alternative, item-based collaborative filtering (e.g., users who are interested in x also interested in y) works in an item-centric manner:", "There are two types of collaborative filtering system:", "In a model-based system, we develop models using different machine learning algorithms to predict users\u2019 rating of unrated items [5]. There are many model-based collaborative filtering algorithms such as Matrix factorization algorithms (e.g., singular value decomposition (SVD), Alternating Least Squares (ALS) algorithm [8]), Bayesian networks, clustering models, etc.[5].", "A memory-based system uses users\u2019 rating data to compute the similarity between users or items. Typical examples of this type of systems are neighbourhood-based method and item-based/user-based top-N recommendations [5].", "This article describes how to build a model-based collaborative filtering system using the SVD model.", "This section describes how to build a recommender system in Python.", "There are multiple Python libraries available (e.g., Python scikit Surprise [7], Spark RDD-based API for collaborative filtering [8]) for building recommender systems. I use the Python scikit Surprise library in this article for demonstration purpose.", "The Surprise library can be installed as follows:", "As described before, I use the Kaggle Netflix prize data [2] in this article. There are multiple data files for different purposes. The following data files are used in this article:", "The training dataset is too big to be handled on a Laptop. Thus I only load the first 100,000 records from each of the training data files for demonstration purpose.", "Once training data files have been downloaded onto a local machine, the first 100,000 records from each of the training data files can be loaded into memory as Pandas DataFrames as follows:", "The resulting different DataFrames for different portions of training data are combined into one as follows:", "The movie titles file can be loaded into memory as Pandas DataFrame:", "The Dataset module in Surprise provides different methods for loading data from files, Pandas DataFrames, or built-in datasets such as ml-100k (MovieLens 100k) [4]:", "I use the load_from_df() method to load data from Pandas DataFrame in this article.", "The Reader class in Surprise is to parse a file containing users, items, and users\u2019 ratings on items. The default format is that each rating is stored in a separate line in the following order separated by space: user item rating", "This order and the separator are configurable using the following parameters:", "I use the default settings in this article. The item, user, rating correspond to the columns of Cust_Id, Movie_Id, and Rating of the DataFrame respectively.", "The Surprise library [7] contains the implementation of multiple models/algorithms for building recommender systems such as SVD, Probabilistic Matrix Factorization (PMF), Non-negative Matrix Factorization (NMF), etc. The SVD model is used in this article.", "The following code is to load data from Pandas DataFrame and create a SVD model instance:", "Once the data and model for product recommendation are ready, the model can be evaluated using cross-validation as follows:", "The following are the results of the cross validation of the SVD model:", "Once the model has been evaluated to our satisfaction, then we can re-train the model using the entire training dataset:", "After a recommendation model has been trained appropriately, it can be used for prediction.", "For example, given a user (e.g., Customer Id 785314), we can use the trained model to predict the ratings given by the user on different products (i.e., Movie titles):", "To recommend products (i.e., movies) to the given user, we can sort the list of movies in decreasing order of predicted ratings and take the top N movies as recommendations:", "The following are the top 10 movies to be recommended to the user with Customer Id 785314:", "In this article, I used the scikit Surprise library [7] and the Kaggle Netflix prize data [2] to demonstrate how to use model-based collaborative filtering method to build a recommender system in Python.", "As described at the beginning of this article, the dataset is too big to be handled on a laptop or any typical single personal computer. Thus I only loaded the first 100,000 records from each of the training dataset files for demonstration purpose.", "In the settings of real applications, I would recommend to use Surprise with Koalas or use the ALS algorithm in Spark MLLib to implement collaborative filtering system and run it on Spark cluster [8].", "The Jupyter notebook with all of the source code used in this article is available in Github [11].", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist at Wavicle Data Solutions, He was a Senior Data Scientist at SMS Assist, a Senior Data Engineer at Capital One, and a DMTS at Motorola"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9e4922dd7e97&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zhangyuefeng1?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": "Yuefeng Zhang, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80e8f2faf4bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=post_page-80e8f2faf4bc----9e4922dd7e97---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e4922dd7e97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e4922dd7e97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Recommender_system", "anchor_text": "Recommender systems"}, {"url": "https://en.wikipedia.org/wiki/Collaborative_filtering", "anchor_text": "collaborative filtering"}, {"url": "https://developers.google.com/machine-learning/recommendation/content-based/basics", "anchor_text": "Content-based filtering"}, {"url": "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm", "anchor_text": "Nearest Neighbor algorithm"}, {"url": "https://en.wikipedia.org/wiki/Machine_learning", "anchor_text": "machine learning"}, {"url": "https://en.wikipedia.org/wiki/Matrix_factorization_(recommender_systems)#:~:text=Matrix%20factorization%20is%20a%20class,two%20lower%20dimensionality%20rectangular%20matrices.", "anchor_text": "Matrix factorization"}, {"url": "https://en.wikipedia.org/wiki/Singular_value_decomposition", "anchor_text": "singular value decomposition"}, {"url": "https://en.wikipedia.org/wiki/Bayesian_networks", "anchor_text": "Bayesian networks"}, {"url": "https://en.wikipedia.org/wiki/Cluster_Analysis", "anchor_text": "clustering models"}, {"url": "https://en.wikipedia.org/wiki/Collaborative_filtering#cite_note-Suetal2009-5", "anchor_text": "[5]"}, {"url": "http://surpriselib.com/", "anchor_text": "Surprise"}, {"url": "https://spark.apache.org/docs/latest/mllib-collaborative-filtering.html#:~:text=Tutorial-,Collaborative%20filtering,commonly%20used%20for%20recommender%20systems.&text=mllib%20currently%20supports%20model%2Dbased,spark.", "anchor_text": "Spark RDD-based API for collaborative filtering"}, {"url": "https://github.com/databricks/koalas", "anchor_text": "Koalas"}, {"url": "https://www.kaggle.com/laowingkin/netflix-movie-recommendation", "anchor_text": "Netflix \u2014 Movie recommendation"}, {"url": "https://www.kaggle.com/netflix-inc/netflix-prize-data?select=qualifying.txt", "anchor_text": "Netflix Prize data, Dataset from Netflix\u2019s competition to improve their reccommendation algorithm"}, {"url": "https://en.wikipedia.org/wiki/Recommender_system", "anchor_text": "Recommender system"}, {"url": "https://realpython.com/build-recommendation-engine-collaborative-filtering/", "anchor_text": "Build a Recommendation Engine With Collaborative Filtering"}, {"url": "https://en.wikipedia.org/wiki/Collaborative_filtering", "anchor_text": "Collaborative filtering"}, {"url": "https://developers.google.com/machine-learning/recommendation/content-based/basics", "anchor_text": "Content-based Filtering"}, {"url": "http://surpriselib.com/", "anchor_text": "Surprise"}, {"url": "https://medium.com/analytics-vidhya/how-to-build-a-restaurant-recommendation-engine-part-1-21aadb5dac6e", "anchor_text": "How to build a Restaurant Recommendation Engine"}, {"url": "https://medium.com/analytics-vidhya/how-to-build-a-restaurant-recommendation-engine-part-2-71e2d0721084", "anchor_text": "How to build a Restaurant Recommendation Engine"}, {"url": "https://github.com/yzzhang/machine-learning/tree/master/recommender", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9e4922dd7e97---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/collaborative-filtering?source=post_page-----9e4922dd7e97---------------collaborative_filtering-----------------", "anchor_text": "Collaborative Filtering"}, {"url": "https://medium.com/tag/recommender-systems?source=post_page-----9e4922dd7e97---------------recommender_systems-----------------", "anchor_text": "Recommender Systems"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9e4922dd7e97---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e4922dd7e97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=-----9e4922dd7e97---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e4922dd7e97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=-----9e4922dd7e97---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e4922dd7e97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9e4922dd7e97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9e4922dd7e97---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9e4922dd7e97--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yuefeng Zhang, PhD"}, {"url": "https://medium.com/@zhangyuefeng1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "293 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80e8f2faf4bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=post_page-80e8f2faf4bc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F84632d34eae6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-building-recommender-system-in-python-9e4922dd7e97&newsletterV3=80e8f2faf4bc&newsletterV3Id=84632d34eae6&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}