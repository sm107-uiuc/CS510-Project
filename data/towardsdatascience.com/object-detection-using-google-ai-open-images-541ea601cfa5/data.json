{"url": "https://towardsdatascience.com/object-detection-using-google-ai-open-images-541ea601cfa5", "time": 1682994214.611566, "path": "towardsdatascience.com/object-detection-using-google-ai-open-images-541ea601cfa5/", "webpage": {"metadata": {"title": "Object Detection using Google AI Open Images | by Alyson Brown | Towards Data Science", "h1": "Object Detection using Google AI Open Images", "description": "When was the last time you logged into your phone using nothing but your face? Or clicked a selfie with some friends and used a Snapchat filter that put some fancy dog ears on your face? Did you know\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/google-ai-open-images-object-detection-track", "anchor_text": "Google AI Open Image challenge", "paragraph_index": 4}, {"url": "https://www.figure-eight.com/dataset/open-images-annotated-with-bounding-boxes/", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://www.coursera.org/learn/convolutional-neural-networks/home/welcome", "anchor_text": "course", "paragraph_index": 5}, {"url": "https://arxiv.org/pdf/1506.02640.pdf", "anchor_text": "cost function", "paragraph_index": 20}, {"url": "https://arxiv.org/pdf/1506.02640.pdf", "anchor_text": "paper", "paragraph_index": 21}], "all_paragraphs": ["Project by Atindra Bandi, Alyson Brown, Sagar Chadha, Amy Dang and Jason Su", "When was the last time you logged into your phone using nothing but your face? Or clicked a selfie with some friends and used a Snapchat filter that put some fancy dog ears on your face? Did you know that these cool features are enabled by a fancy neural network that not only recognizes that there is a face in the photo but also detects where the ears should go. Your phone, in a sense, can \u2018see\u2019 you and it even knows what you look like!", "The technology that helps computers \u2018see\u2019 is called \u201ccomputer vision\u201d. In recent years, computer vision applications are becoming increasingly commonplace due to an explosion in computing power making deep learning models faster and more feasible. Many companies such as Amazon, Google, Tesla, Facebook, and Microsoft are investing heavily in this technology and its applications.", "We focus on two main computer vision tasks\u2014 image classification and object detection.", "Recognizing that many interesting data science applications in the future would involve working with images, my team of budding data scientists and I decided to try our hands at the Google AI Open Image challenge hosted on Kaggle. We thought of this as the perfect opportunity to get our hands dirty with neural networks and convolutions, and potentially impress our professors and classmates. This challenge provided us with 1.7 million images with 12 million bounding box annotations (their X and Y coordinates relative to the image) of 500 object classes. You can find the data here.", "We highly recommend going through Andrew Ng\u2019s Coursera course on Convolutional Neural networks to anyone who wants to read about CNNs.", "Exploratory Data Analysis \u2014 As with all data analyses, we began exploring what images we had and the type of objects we needed to detect.", "A quick look at the training images revealed that certain objects had more of a presence than others in terms of how many times they appeared. The chart above shows the distribution of the top 43 classes. It is clear that there is a huge disparity and it would need to be resolved somehow. In the interest of time and money (GPU costs are high :( ) we chose the aforementioned 43 object classes and a subset of ~ 300K images with these objects. We had about 400 images for each object class in the training data.", "We considered various object detection algorithms, including VGG, Inception and YOLO, but ultimately chose the YOLO algorithm because of its speed, computational power and the abundance of online articles that could guide us through the process. Faced with computational and time restraints, we made two key decisions -", "The YOLO algorithm requires some specific inputs -", "Below is the code snippet for YOLO inputs", "The architecture is as shown below \u2014 it has 23 convolution layers each with its own batch normalization, Leaky RELU activation and max pooling.", "These layers try to extract multiple important features from images so that the various classes can be detected. For the purpose of object detection, the YOLO algorithm divides the input image into a 19*19 grid each with 5 different anchor boxes. It then tries to detect classes within each of these grid cells and assigns an object to one of the 5 anchor boxes for each grid cell. The anchor boxes differ in shape and are intended to capture differently shaped objects for each grid cell.", "The YOLO algorithm outputs a matrix (shown below) for each of the defined anchor boxes-", "Given that we had to train the algorithm for 43 classes, we got output dimensions of:", "These matrices give us the probabilities of observing an object for each anchor box and also the probability of what class that object is. To filter out anchor boxes that don\u2019t have any classes or have the same object as some other box, we use two thresholds \u2014 IoU threshold to filter out anchor boxes capturing the same object and confidence threshold to filter out boxes that don\u2019t contain any class with a high confidence.", "Below is the illustration of last few layers of the YOLO v2 architecture:", "Transfer learning is the idea of obtaining a neural network that has already been trained to classify images and using it for our specific purpose. This saves us computation time since we don\u2019t need to train a lot of weights \u2014 for instance, the YOLO v2 model we used has about 50 million weights \u2014 training which would have taken 4\u20135 days easily on the Google cloud instance we were using.", "To successfully implement transfer learning, we had to make a few updates to our model:", "We re-initialized the weights of YOLO\u2019s last convolution layer to train it on our data set which eventually helped us identify unique classes. Below is the code snippet for the same -", "In any object detection problem we want to identify the right object at the right place with a high confidence in an image. There are 3 major components to the cost function:", "Please feel free to refer to the original YOlO paper for a detailed look of the cost function.", "The beauty of YOLO is that it uses errors that are easy to optimize using optimization functions such as Stochastic Gradient Descent (SGD), SGD with momentum, or Adam etc. Below code snippet shows the parameters we used for optimizing the cost function.", "There are many metrics to evaluate models in object detection, and for our project we decided to use the mAP score, which is the average of the maximum precision at different recall values over all IoU thresholds. In order to understand mAP, we\u2019ll do a quick review of precision, recall, and IoU (intersection over union).", "Precision measures the percentage of positive predictions that are correct. Recall is the proportion of true positives out of all possible outcomes. These two values are inversely related and are also dependent on the model score threshold that you set for the model (in our case, it is the confidence score). Their mathematical definitions are presented below:", "IoU measures how much overlap there is between two regions, which is equal to the area of overlap over the area of union. This measures how well your predictions are (from your object detector) compared with the ground truth (true object boundary). To summarize, the mAP score is the mean AP over all IoU thresholds.", "Object detection is different from other computer vision tasks. You can use a pre-trained model and edit as needed to meet your needs. You\u2019ll prob need GCP or another platform that allows for higher computing power. Math is hard, read others\u2019 articles and fail fast.", "In the beginning, we found that the model was not able to predict many of the classes because many of them only had a few training images, which caused an imbalance training dataset. Therefore, we decided to just use the most popular 43 classes, which is not a perfect approach, but each class had at least 500 images. However, our predictions\u2019 confidence scores were still pretty low. To solve this problem, we selected images that contained our target classes.", "Object detection is a very challenging topic, but don\u2019t be scared and try to learn as much as possible from the various open sources online, like Coursera, YouTube instructional videos, GitHub, and Medium. All these free wisdom can help you succeed in this amazing field!", "a. Data Augmentation \u2014 Change existing images slightly to create new images", "b. Image duplication \u2014 We can use the same image multiple times to train the algorithm on the specific rare class", "c. Ensemble\u2014 Train one model on the popular classes and train another for the rare classes and use predictions from both.", "2. In addition, we can try an ensemble of different models, such as MobileNet, VGG, etc. which are convolutional neural networks algorithms also used for object detection.", "If you\u2019d like to take a detailed look into our team\u2019s code, here\u2019s the GitHub link. Please feel free to provide any feedback or comments!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MS, Business Analytics @ UT Austin | Clemson Tiger"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F541ea601cfa5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alyson_brown?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alyson_brown?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": "Alyson Brown"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F15110fd89b3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&user=Alyson+Brown&userId=15110fd89b3a&source=post_page-15110fd89b3a----541ea601cfa5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F541ea601cfa5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F541ea601cfa5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@introspectivedsgn?utm_source=medium&utm_medium=referral", "anchor_text": "Erik Mclean"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/evolution-of-object-detection-and-localization-algorithms-e241021d8bad", "anchor_text": "article"}, {"url": "https://www.kaggle.com/c/google-ai-open-images-object-detection-track", "anchor_text": "Google AI Open Image challenge"}, {"url": "https://www.figure-eight.com/dataset/open-images-annotated-with-bounding-boxes/", "anchor_text": "here"}, {"url": "https://www.coursera.org/learn/convolutional-neural-networks/home/welcome", "anchor_text": "course"}, {"url": "https://arxiv.org/pdf/1506.02640.pdf", "anchor_text": "cost function"}, {"url": "https://arxiv.org/pdf/1506.02640.pdf", "anchor_text": "paper"}, {"url": "https://medium.com/@jonathan_hui/map-mean-average-precision-for-object-detection-45c121a31173", "anchor_text": "Source"}, {"url": "https://github.com/bandiatindra/Object-Detection-Project", "anchor_text": "bandiatindra/Object-Detection-ProjectContribute to bandiatindra/Object-Detection-Project development by creating an account on GitHub.github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----541ea601cfa5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----541ea601cfa5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/cnn?source=post_page-----541ea601cfa5---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----541ea601cfa5---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F541ea601cfa5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&user=Alyson+Brown&userId=15110fd89b3a&source=-----541ea601cfa5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F541ea601cfa5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&user=Alyson+Brown&userId=15110fd89b3a&source=-----541ea601cfa5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F541ea601cfa5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F541ea601cfa5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----541ea601cfa5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----541ea601cfa5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----541ea601cfa5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----541ea601cfa5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----541ea601cfa5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alyson_brown?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alyson_brown?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alyson Brown"}, {"url": "https://medium.com/@alyson_brown/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "118 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F15110fd89b3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&user=Alyson+Brown&userId=15110fd89b3a&source=post_page-15110fd89b3a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F70ee55bd8f95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-google-ai-open-images-541ea601cfa5&newsletterV3=15110fd89b3a&newsletterV3Id=70ee55bd8f95&user=Alyson+Brown&userId=15110fd89b3a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}