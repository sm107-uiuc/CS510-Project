{"url": "https://towardsdatascience.com/pandas-for-football-player-value-936c3243bd9a", "time": 1682996458.799407, "path": "towardsdatascience.com/pandas-for-football-player-value-936c3243bd9a/", "webpage": {"metadata": {"title": "Pandas for Football Player Value. A Web-Scraping and Pandas Guided\u2026 | by Stephen Fordham | Towards Data Science", "h1": "Pandas for Football Player Value", "description": "With this in mind, this tutorial will focus on how to scrape information for the most expensive January Premier League signings ever recorded for each position, in a standard 4\u20134\u20132 formation. Once\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.forbes.com/sites/robertkidd/2019/02/28/the-most-expensive-premier-league-signings-in-january-revealed/#5614d28fb095", "anchor_text": "The Forbes Webpage shown below will be used and is provided here.", "paragraph_index": 3}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham", "paragraph_index": 32}], "all_paragraphs": ["In Football, January offers a chance for teams in the League to make changes to their squad.", "With this in mind, this tutorial will focus on how to scrape information for the most expensive January Premier League signings ever recorded for each position, in a standard 4\u20134\u20132 formation.", "Once scraped, the tutorial will show how to transform scraped data in a Pandas DataFrame, and demonstrate how this format of data structure can be useful for initial data analysis.", "The Forbes Webpage shown below will be used and is provided here. This Webpage has all the information of interest.", "Notably, all the January signings in all positions, the club the players transferred from, and the club they transferred to. In addition, the year that transfer took place, and their transfer fees in \u00a3\u2019s and $\u2019s, when the players were originally purchased, and their value now in \u00a3\u2019s and $\u2019s based on a \u2018football player inflation rate\u2019.", "To begin, I import the requests library. I then create a \u2018url\u2019 variable, and assign the URL link from the Forbes website to this variable. This link contains information relating to the most expensive transfers in the January Transfer window.", "I use the get method from the requests library to begin extracting my data. To confirm the connection from my python environment to the Webpage, I print the status_code, which returns 200.", "200 is the HTTP status code for \u201cOK\u201d, a successful response. (Other codes you may be familiar with are 404 Not Found, 403 Forbidden, and 500 Internal Server Error.)", "Once the connection is validated, I use the text attribute to retrieve the underlying html source code of the Forbes Webpage. When I print the html text, the output is quite large in my console. To help narrow down my area of interest, I use \u2018CTRL-F\u2019 whilst in the console, and search for the name of a player I know will lead me to where I would like to extract data from.", "This search leads me to the information I require, immediately after the <strong> tag. From a glance at the source output, I can see Shay Given, Newcastle to Manchester City, his transfer fee in \u00a3\u2019s and $\u2019s, when the player was originally purchased, and his value now in \u00a3\u2019s and $\u2019s.", "What is particularly useful in this scenario, is the regularity in the underlying HTML source code. For example, each player\u2019s name is embedded the same way within a <strong> tag. In addition, the Team the player transferred from is always after the \u2018nbsp;\u2019 characters, and before the word \u2018to\u2019. This pattern means I can create a for loop to iterate over my code and extract the relevant information.", "Initially, I like to narrow down my search area. The output from htmltext = response.text returns a giant string, which I can split, using the split string method. I split on \u2018*Fees reported\u2019 and take everything after that string by indexing at 1, and split again on a unique string, and take the string before that by indexing at 0.", "This leave me with a shortened string. To convert the string, \u2018secondsplit\u2019 into a list, I split it at a strong tag and take everything after the second element (python index 1) until the end of my list.", "This leaves me a list (thirdsplit) with all the information I want to extract inside for each player.", "I can now iterate over my list. To find the original transfer fee for example, I use the split method to split each element in my thirdsplit list, and extract the string after the \u2018($\u2019 sign and before the \u2018m)\u2019 characters by using substring notation.", "I then append each transfer fee to a newly constructed list called transfer cost. I repeat this same process for get the players, their previous club, year of transfer, new club, and fee as of 2019 when a football player inflation rate is applied.", "In some instances, the split method for a particular variable in the for loop does not quite remove all the necessary characters. When I run the for loop as shown, the prefix, \u2018Jos&amp;eacute;\u2019 appears before the player Antonio Reyes.", "To create the new players list, I simply add a condition to remove these characters, and generate a new list. This involved checking for leading characters and replacing them with an empty string as shown in the attached GitHub gist code snippet. The same validation was applied to the Old_team list.", "Once the lists have been assembled and cleaned up I can create a pandas DataFrame. To do so, I import pandas, and zip my lists together inside the pd.DataFrame method. I assign appropriately labelled column names for the lists so that they are representative of their content, for example the \u2018Players\u2019 column refers to the list, \u2018Players_refined\u2019.", "The datatypes of the transfer_df DataFrame columns, Transfer_Fee, Transfer_Year and Cost_2019 are changed to appropriate numeric types using the .astype() method, before the DataFrame is sorted based on highest Transfer_Fee using the .sort_values() method.", "I finally create two additional columns. One which determines the ratio between the Cost of the player in 2019 (based on player inflation rate) and their tranfers fee at the time of purchase. The second column refers to the player\u2019s respective position.", "An additional step I implement is the re-ordering of the columns. It reads better if, for example the Player name is followed by the Player\u2019s respective position.", "When the transfer_df DataFrame is viewed all the necessary changes have been implemented.", "The data has been successfully extracted from the Forbes Webpage and inputted into a Pandas DataFrame!", "An aspect of the pandas library which I really like is the groupby method. Here, the data is in a very clear and readable form.", "It is clear that in January, Arsenal signed the most expensive left-winger(LW), Antonio Reyes for $23.9M. Further to this, Chelsea have signed 4 of the 11 most expensive January signings (based on the 4\u20134\u20132 formation), 2 of which were in 2011. This data is easier to interpret for comparison purposes that the original text displayed on the Webpage.", "A bar-plot can now be produced to help visualize the relative change in market value, between time of original purchase to the present day.", "Both the Transfer_Fee_change_column and the schematic illustrate this point more clearly than the raw text depicted on the Forbes Web-page.", "This schematic shows that if Fernando Torres had been purchased in today\u2019s transfer market, he would cost 2.10 times more than he did in 2011. However, from our table and schematic we can clearly see that Aymeric Laporte would cost less, 0.84 times what was paid for him in 2018. At the extreme end, if Scott Parker was purchased today, he would be 3.37 times more expensive than his original 2004 transfer fee.", "A normalization dotted line has been added at 1.0 on the y-axis to shown the relative change in ratio.", "This introductory example described how we can scrape data and transform it into a pandas DataFrame. By doing so, the data can easily be manipulated and analysed. In this case, it is now easy to group, based on club, create a new column which calculates the transfer fee change ratio between original purchase and the present market value. Further to this, we can create informative plots, like the bar-plot shown in this article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Articles on Data Science and Programming https://github.com/StephenFordham"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F936c3243bd9a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@stephenfordham?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e----936c3243bd9a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F936c3243bd9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F936c3243bd9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/1Nu_qjXO5-0", "anchor_text": "Unsplash"}, {"url": "https://www.forbes.com/sites/robertkidd/2019/02/28/the-most-expensive-premier-league-signings-in-january-revealed/#5614d28fb095", "anchor_text": "The Forbes Webpage shown below will be used and is provided here."}, {"url": "https://medium.com/tag/data-science?source=post_page-----936c3243bd9a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----936c3243bd9a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/sports?source=post_page-----936c3243bd9a---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/analytics?source=post_page-----936c3243bd9a---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/data?source=post_page-----936c3243bd9a---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F936c3243bd9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----936c3243bd9a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F936c3243bd9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----936c3243bd9a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F936c3243bd9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F936c3243bd9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----936c3243bd9a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----936c3243bd9a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----936c3243bd9a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----936c3243bd9a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----936c3243bd9a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/@stephenfordham/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "977 Followers"}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbd4ed43cae00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-for-football-player-value-936c3243bd9a&newsletterV3=5d3f46276e7e&newsletterV3Id=bd4ed43cae00&user=Stephen+Fordham&userId=5d3f46276e7e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}