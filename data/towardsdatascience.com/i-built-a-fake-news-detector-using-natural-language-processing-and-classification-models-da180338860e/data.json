{"url": "https://towardsdatascience.com/i-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e", "time": 1682995716.58697, "path": "towardsdatascience.com/i-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e/", "webpage": {"metadata": {"title": "I Built a Fake News Detector Using Natural Language Processing and Classification Models | by Jasmine Vasandani | Towards Data Science", "h1": "I Built a Fake News Detector Using Natural Language Processing and Classification Models", "description": "When WhatsApp announced that it was deleting 2 million accounts every month to prevent the spread of fake news, I was intrigued. Of the millions of accounts flagged for deletion, how many are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.theguardian.com/technology/2019/feb/06/whatsapp-deleting-two-million-accounts-per-month-to-stop-fake-news", "anchor_text": "announced", "paragraph_index": 0}, {"url": "https://github.com/dmarx/psaw", "anchor_text": "Pushshift.io API Wrapper", "paragraph_index": 1}, {"url": "https://www.reddit.com/r/TheOnion/", "anchor_text": "r/TheOnion", "paragraph_index": 1}, {"url": "https://www.google.com/search?q=nottheonion&rlz=1C5CHFA_enUS820US820&oq=nottheonion&aqs=chrome..69i57j69i60l2j69i61j0l2.1961j0j4&sourceid=chrome&ie=UTF-8", "anchor_text": "r/nottheonion", "paragraph_index": 1}, {"url": "http://www.theonion.come", "anchor_text": "www.theonion.com", "paragraph_index": 1}, {"url": "https://faq.whatsapp.com/en/android/26000216/?category=5245250", "anchor_text": "Tips to help prevent the spread of rumors and fake news", "paragraph_index": 4}, {"url": "http://www.theonion.com", "anchor_text": "theonion.com", "paragraph_index": 6}, {"url": "http://www.foxnews.come,", "anchor_text": "foxnews.com", "paragraph_index": 6}, {"url": "http://www.theguardian.com", "anchor_text": "theguardian.com", "paragraph_index": 6}, {"url": "http://www.google.com", "anchor_text": "google.com", "paragraph_index": 6}, {"url": "http://www.bbc.com", "anchor_text": "bbc.com", "paragraph_index": 6}, {"url": "http://www.newsweek.com", "anchor_text": "newsweek.com", "paragraph_index": 6}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Pipeline", "paragraph_index": 8}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "GridSearchCV", "paragraph_index": 8}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "CountVectorizer", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html", "anchor_text": "TfidVectorizer", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html", "anchor_text": "LogisticRegression", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html", "anchor_text": "MultinomialNB", "paragraph_index": 9}, {"url": "https://github.com/jasminevasandani/NLP_Classification_Model_FakeNews", "anchor_text": "GitHub repo", "paragraph_index": 14}, {"url": "http://davidcapella.com/", "anchor_text": "David Capella", "paragraph_index": 15}, {"url": "http://www.jasminev.co", "anchor_text": "www.jasminev.co", "paragraph_index": 16}, {"url": "https://github.com/jasminevasandani", "anchor_text": "https://github.com/jasminevasandani", "paragraph_index": 18}, {"url": "https://www.jasminev.co/", "anchor_text": "https://www.jasminev.co/", "paragraph_index": 18}], "all_paragraphs": ["When WhatsApp announced that it was deleting 2 million accounts every month to prevent the spread of fake news, I was intrigued. Of the millions of accounts flagged for deletion, how many are misclassified as fake news? How did WhatsApp even create an automated process of deleting millions of fake news accounts? In an attempt to answer these questions, I built my own fake news detector using open source data from Reddit. Here\u2019s how I did it and what I learned along the way.", "With the help of Pushshift.io API Wrapper*, I scraped approximately 30,000 posts from the Subreddits r/TheOnion and r/nottheonion. I chose these Subreddits to see how well I could distinguish between fake news and absurd news. Posts on the r/TheOnion feature satirical news from www.theonion.com or other similar parody sites. Posts on r/nottheonion feature absurd current events reported on by credible news outlets.", "To keep my data clean and concise, I chose to make my predictor variable (X) the title of a post and my target variables (y) be 1 to represent r/TheOnion and 0 to represent r/nottheonion. To clean my data, I created a data cleaning function that dropped duplicate rows in a DataFrame, removed punctuation and numbers from all text, removed excessive spacing, and converted all text to lowercase.", "Now that my Subreddit datasets were nice and clean, I was ready to conduct an exploratory data analysis (EDA). Even though I decided to assign post titles to my predictor variable (X), during my data scrape I also acquired other features of a post to uncover any hidden stories in the data. In total, I scraped the following features from each post:", "Something peculiar stood out to me when I observed the number of posts shared by an author. In r/notheonion with 15 million subscribers, only three authors shared over 100 posts, while r/TheOnion with 95k subscribers had 14 authors who shared over 100 posts, the most being 4,113 posts. After making this observation, I confirmed that I made a good decision to use r/TheOnion as a case study to understand WhatsApp\u2019s fake news problem. In WhatsApp\u2019s \u201cTips to help prevent the spread of rumors and fake news,\u201d three of the seven tips focus on preventing the spread of fake news. One of the biggest problems with fake news is not necessarily that it gets written, but rather that it gets spread. The activity of r/TheOnion\u2019s authors mimics the core qualities of the fake news phenomenon.", "The first biggest mistake in data science is looking every business challenge as predictive approach. Remember 70% of low hanging problems can be solved by just doing an EDA.", "Another interesting thing I discovered during my EDA of the data was the most referenced domains in each Subreddit. Of course, the majority of the domains referenced in r/TheOnion were from theonion.com and other parody news sites. However, the most referenced domains in r/nottheonion gave me a kick. The top five most referenced domains on r/nottheonion were foxnews.com, theguardian.com, google.com, bbc.com, and newsweek.com.", "I performed more EDA on my datasets and analyzed the most frequently used words by applying CountVectorizer(ngram_range = (1,1)) on the data. I also analyzed the most frequently used bigrams by applying CountVectorizer(ngram_range = (2,2)) on the data. Between the two Subreddits I made note of common frequent words and added them to a custom stop_words list which I would later use in my modeling of the data.", "I could have begun the modeling process early on, but I decided to conduct EDA first in order to get to know my data well. After the data shared their stories with me, I began to create and refine my predictive models. I set my predictor (titles) and target (subreddit) variables, conducted a train/test split, and found the best parameters for my models through Pipeline and GridSearchCV. I used a combination of vectorizers and classification models to find the best parameters that would give me the highest accuracy score. I optimized for accuracy to ensure that all fake news gets classified as fake news, and that all authentic news does not get classified as fake news.", "I implemented four models with combinations of using CountVectorizer and TfidVectorizer paired with LogisticRegression and MultinomialNB. My best model for achieving the highest test accuracy score implemented CountVectorizer and MultinomialNB. Here\u2019s my code for how I found the best parameters for this model.", "My best model for interpreting coefficients implemented CountVectorizer and LogisticRegression. Here\u2019s my code for how I found the best parameters for this model.", "To evaluate my CountVectorizer and MultinomialNB model, I implemented a confusion matrix. While a 90% accuracy test score is high, that still signifies that 10% of posts are being misclassified as either fake news or real news. If this were WhatsApp\u2019s scores for their fake news detector, 10% of all fake news accounts would be misclassified on a monthly basis. Good thing I created a fake news detector on a smaller dataset first.", "Finally, even though my CountVectorizer and LogisticRegression model didn\u2019t perform as well as the model above, I still decided to interpret its coefficients to get a better picture of how each word affects the predictions being made. In the graph below of my logistic regression coefficients, the word that contributes the most positively to being from r/TheOnion is \u2018kavanaugh\u2019, followed by the \u2018incredible\u2019 and \u2018ftw\u2019. The word that contributes the most positively to being from r/nottheonion is \u2018Florida\u2019, followed by \u2018cops\u2019 and \u2018arrested\u2019. After exponentiating my coefficients, I discovered that as occurences of \u201ckavanaugh\u201d increases by 1 in a title, that title is 7.7 times as likely to be classified as r/TheOnion. And as occurrences of \u201cflorida\u201d increases by 1 in a title, that title is 14.9 times as likely to be classified as r/nottheonion.", "Looking back at my process, I would have tested more NLP vectorizers and classification models on my data. Moving forward, I\u2019m curious to learn more about how to parse through images, videos, and other forms of media through machine learning, since news articles aren\u2019t always written in text format. I also have a better understanding of how WhatsApp might have created a model to detect fake news accounts. As far as WhatsApp\u2019s accuracy score for deleting accounts, that\u2019s a question that\u2019s still on my mind.", "To view all of my code for this process, check out my GitHub repo.", "*Hat tip David Capella for sharing the API wrapper with me!", "Jasmine Vasandani is a data scientist, strategist, and researcher. She is passionate about building inclusive communities in data. Learn more about her: www.jasminev.co/", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science/Analytics Manager + Strategist | Twitter: @jasmine_data | GitHub: https://github.com/jasminevasandani | Me: https://www.jasminev.co/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fda180338860e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----da180338860e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da180338860e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jasmine.vasandani?source=post_page-----da180338860e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasmine.vasandani?source=post_page-----da180338860e--------------------------------", "anchor_text": "Jasmine Vasandani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7ee6a045d4f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&user=Jasmine+Vasandani&userId=7ee6a045d4f5&source=post_page-7ee6a045d4f5----da180338860e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda180338860e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda180338860e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/XmMsdtiGSfo", "anchor_text": "Unsplash"}, {"url": "https://www.theguardian.com/technology/2019/feb/06/whatsapp-deleting-two-million-accounts-per-month-to-stop-fake-news", "anchor_text": "announced"}, {"url": "https://github.com/dmarx/psaw", "anchor_text": "Pushshift.io API Wrapper"}, {"url": "https://www.reddit.com/r/TheOnion/", "anchor_text": "r/TheOnion"}, {"url": "https://www.google.com/search?q=nottheonion&rlz=1C5CHFA_enUS820US820&oq=nottheonion&aqs=chrome..69i57j69i60l2j69i61j0l2.1961j0j4&sourceid=chrome&ie=UTF-8", "anchor_text": "r/nottheonion"}, {"url": "http://www.theonion.come", "anchor_text": "www.theonion.com"}, {"url": "https://faq.whatsapp.com/en/android/26000216/?category=5245250", "anchor_text": "Tips to help prevent the spread of rumors and fake news"}, {"url": "http://www.theonion.com", "anchor_text": "theonion.com"}, {"url": "http://www.foxnews.come,", "anchor_text": "foxnews.com"}, {"url": "http://www.theguardian.com", "anchor_text": "theguardian.com"}, {"url": "http://www.google.com", "anchor_text": "google.com"}, {"url": "http://www.bbc.com", "anchor_text": "bbc.com"}, {"url": "http://www.newsweek.com", "anchor_text": "newsweek.com"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Pipeline"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "GridSearchCV"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "CountVectorizer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html", "anchor_text": "TfidVectorizer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html", "anchor_text": "LogisticRegression"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html", "anchor_text": "MultinomialNB"}, {"url": "https://github.com/jasminevasandani/NLP_Classification_Model_FakeNews", "anchor_text": "GitHub repo"}, {"url": "http://davidcapella.com/", "anchor_text": "David Capella"}, {"url": "http://www.jasminev.co", "anchor_text": "www.jasminev.co"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----da180338860e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----da180338860e---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/data-science?source=post_page-----da180338860e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/fake-news?source=post_page-----da180338860e---------------fake_news-----------------", "anchor_text": "Fake News"}, {"url": "https://medium.com/tag/data-journalism?source=post_page-----da180338860e---------------data_journalism-----------------", "anchor_text": "Data Journalism"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda180338860e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&user=Jasmine+Vasandani&userId=7ee6a045d4f5&source=-----da180338860e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda180338860e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&user=Jasmine+Vasandani&userId=7ee6a045d4f5&source=-----da180338860e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda180338860e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da180338860e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fda180338860e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----da180338860e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----da180338860e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----da180338860e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----da180338860e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----da180338860e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----da180338860e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----da180338860e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----da180338860e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----da180338860e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasmine.vasandani?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasmine.vasandani?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jasmine Vasandani"}, {"url": "https://medium.com/@jasmine.vasandani/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "354 Followers"}, {"url": "https://github.com/jasminevasandani", "anchor_text": "https://github.com/jasminevasandani"}, {"url": "https://www.jasminev.co/", "anchor_text": "https://www.jasminev.co/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7ee6a045d4f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&user=Jasmine+Vasandani&userId=7ee6a045d4f5&source=post_page-7ee6a045d4f5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc4377e0b19d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-built-a-fake-news-detector-using-natural-language-processing-and-classification-models-da180338860e&newsletterV3=7ee6a045d4f5&newsletterV3Id=c4377e0b19d0&user=Jasmine+Vasandani&userId=7ee6a045d4f5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}