{"url": "https://towardsdatascience.com/using-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f", "time": 1683003465.384904, "path": "towardsdatascience.com/using-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f/", "webpage": {"metadata": {"title": "Using Graph Convolutional Neural Networks on Structured Documents for Information Extraction | by Dhaval Potdar | Towards Data Science", "h1": "Using Graph Convolutional Neural Networks on Structured Documents for Information Extraction", "description": "While Deep Learning solutions such as CNNs effectively capture patterns in data in Euclidean space, there is an increasing number of applications where data is represented in the form of a Graph and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/graph-theory-and-deep-learning-know-hows-6556b0e9891b", "anchor_text": "this", "paragraph_index": 10}, {"url": "https://aws.amazon.com/textract/", "anchor_text": "Amazon Textract", "paragraph_index": 14}, {"url": "https://cloud.google.com/vision/docs/ocr", "anchor_text": "Google Vision API", "paragraph_index": 14}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html", "anchor_text": "Pandas DataFrame", "paragraph_index": 15}, {"url": "https://cloud.google.com/vision/docs/request", "anchor_text": "endpoint URL", "paragraph_index": 17}, {"url": "https://networkx.github.io/", "anchor_text": "networkx", "paragraph_index": 21}, {"url": "https://github.com/dhavalpotdar/Graph-Convolution-on-Structured-Documents/blob/7400704346cb9698f6c6b1ad3307d2439d17fa33/grapher.py#L520", "anchor_text": "code", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1904.12577", "anchor_text": "arXiv", "paragraph_index": 27}, {"url": "https://priba.github.io/assets/publi/slides/2019_ICDAR_PRiba.pdf", "anchor_text": "ICDAR", "paragraph_index": 28}, {"url": "https://priba.github.io/assets/publi/slides/2019_ICDAR_PRiba.pdf", "anchor_text": "priba.github.io", "paragraph_index": 28}, {"url": "https://github.com/dhavalpotdar/Graph-Convolution-on-Structured-Documents", "anchor_text": "here is my starter code", "paragraph_index": 28}, {"url": "https://arxiv.org/pdf/1901.00596.pdf", "anchor_text": "Here", "paragraph_index": 35}, {"url": "https://medium.com/u/c5d462ada007?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "Dhaval Potdar", "paragraph_index": 36}, {"url": "https://www.udacity.com/course/data-analyst-nanodegree--nd002", "anchor_text": "Data Analyst", "paragraph_index": 36}, {"url": "https://www.udacity.com/course/machine-learning-engineer-nanodegree--nd009t", "anchor_text": "Machine Learning Engineer", "paragraph_index": 36}, {"url": "https://www.linkedin.com/in/dhavalpotdar/", "anchor_text": "LinkedIn", "paragraph_index": 36}, {"url": "https://github.com/dhavalpotdar", "anchor_text": "GitHub", "paragraph_index": 36}], "all_paragraphs": ["While Deep Learning solutions such as CNNs effectively capture patterns in data in Euclidean space, there is an increasing number of applications where data is represented in the form of a Graph and lack a grid-like regularity. As Graphs can be irregular, they may have a variable size of un-ordered nodes and each node may have a different number of neighbors, resulting in mathematical operations such as convolutions difficult to apply to the Graph domain.", "Some examples of such non-Euclidean data include:", "This article particularly discusses the use of Graph Convolutional Neural Networks (GCNs) on structured documents such as Invoices and Bills to automate the extraction of meaningful information by learning positional relationships between text entities. Multiple approaches are discussed along with methods to convert documents to graphs since documents do not inherently have a graph-like layout.", "denote an edge pointing from v_i to v_j. Then, the Adjacency Matrix A is an n x n matrix with,", "where n is the number of nodes in the Graph.", "Further, a Graph may have node attributes such that,", "where X is a node feature matrix with,", "representing the feature vector of node v.", "Here are some illustrations of undirected graphs with no self-loops along with their corresponding Adjacency Matrices:", "Each of these nodes can further have node attributes or feature vectors denoted by the feature matrix:", "In the real world example of a social network, node attributes could be demographic information on people (nodes) and their relationships would be the edges. Be sure to check out this article for an in-depth understanding of Graphs.", "Structured documents such as Invoices and Bills have a certain order of occurrence when it comes to entities such as headers and tables. For example in most invoices, tables lie between the header and the footer. Also, the total amount, which is an important entity of the invoice which we hope to extract, generally lies in the bottom right corner of the table. Such recurring structural information along with text attributes can help a Graph Neural Network learn neighborhood representations and perform node classification as a result.", "But how do we get such documents in a graphical format?", "The answer is OCR coupled with Geometric Algorithms.", "In this step, we use commercially available OCR Engines such as Amazon Textract or Google Vision API to generate what is called an Object Map of the document.", "Each \u201cobject\u201d in the map is a text entity \u2014 a word or a sentence. In the context of this article, we refer to the object map as a Pandas DataFrame having five columns \u2014 xmin, ymin, xmax, ymax, Object.", "(xmin, ymin) and (xmax, ymax) give us the coordinates of the rectangular bounding box while the Object column gives the actual text inside that box.", "Here is a GitHub Gist going over the generation of such an Object Map given the path of the document image and the endpoint URL of the Google Vision API instance.", "Once we have generated an object map we make use of a visibility based Geometric Algorithm to connect objects to each other, thus forming a Graph with objects as the nodes and the connections as the edges.", "Geometric Algorithm: Connecting objects based on visibility", "Step-1: Start with the object in the top-left corner. For each object in the map, iterate over all other objects. Step-2: For each object, look to the right.Step-3: If another object is present in direct visibility, make a connection. Step-4: For each object, look directly underneath. Step-5: If another object is present in direct visibility, make a connection.", "The output is in the form of a Dictionary so that we can use networkx, a Python library on network analysis to construct a graph from it. Further, we return the Text List so as to use the text of each node as its feature vector.", "Next, we use networkx to create an Adjacency Matrix A for the document along with a feature matrix X generated by count vectorizing at character level for each text object.", "Here is the code for the same.", "As the end result, we expect the document to look like this:", "Once we have our document in the form of a Graph, the next step is feeding this data to a GCN. Here, we have the option of choosing from a number of GCN implementations most notable of which are described below:", "Here are implementations of GCNs specifically suited to Information Extraction from Invoices:", "Table understanding in Structured Documents:Paper: arXivDescription: The implementation of GCN in this paper does not strictly follow the mathematical definition of Graph Convolution instead, for each node the feature vectors of connected nodes in the Graph are simply concatenated with the feature vector of the node under consideration. Thus, a new aggregated feature vector is formed for each node which is then simply fed through a fully connected layer.", "Table Detection in Invoice Documents by Graph Neural Networks:Paper: ICDARSlides: priba.github.ioCode: Although the code isn\u2019t provided by the author, here is my starter code for the same.Illustration:", "All of these methods give encouraging results. For example, here is the output of the Semi-supervised classification approach on a sample Invoice:", "Since the paradigm of Semi-supervised learning states that both labeled and unlabeled nodes be present in the Graph at the time of learning representations, this output was observed on a single Invoice as a Graph.", "There were total four classes \u2014 info, contact, table item and other (not displayed). A set of seed nodes for each class were labeled initially. The GCN was then able to learn representations for the unlabeled nodes from these initial seed nodes.", "An end-to-end solution can be implemented by first identifying seed nodes by using standard NLP techniques and then feeding the Graph to the network. The most noteworthy feature here is the ability to generate node representations for previously unseen documents with very low latency.", "Graph Convolutional Neural Networks prove to be increasingly useful in novel applications where data assumes a connectionist structure. Further, data having spatial meaning as in the case of Structured Documents, can be adapted to a graphical structure and then be used with GCNs.", "Semi-supervised learning can be used on-the-fly on static Graphs to generate representations for nodes without the need for large training sets. Moving beyond vanilla CNNs for non-euclidean data opens up exciting opportunities for new areas in applied research.", "Here is a comprehensive survey on Graph Neural Networks as of 2019 for further reading.", "Dhaval Potdar is a Data Science enthusiast with experience in AI Research. He has graduated from the Data Analyst and Machine Learning Engineer Nanodegrees with Udacity and is currently working in an Analytics Startup based out of Mumbai. Taking up messy data and turning it into something of value is what I\u2019m getting better at day by day. Connect with me on LinkedIn and check out my GitHub for more cool projects.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Yet another data enthusiast | AI Research"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc1088dcd2b8f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dhavalpotdar?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dhavalpotdar?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "Dhaval Potdar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5d462ada007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&user=Dhaval+Potdar&userId=c5d462ada007&source=post_page-c5d462ada007----c1088dcd2b8f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1088dcd2b8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1088dcd2b8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/graph-theory-and-deep-learning-know-hows-6556b0e9891b", "anchor_text": "this"}, {"url": "https://aws.amazon.com/textract/", "anchor_text": "Amazon Textract"}, {"url": "https://cloud.google.com/vision/docs/ocr", "anchor_text": "Google Vision API"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html", "anchor_text": "Pandas DataFrame"}, {"url": "https://cloud.google.com/vision/docs/request", "anchor_text": "endpoint URL"}, {"url": "https://networkx.github.io/", "anchor_text": "networkx"}, {"url": "https://github.com/dhavalpotdar/Graph-Convolution-on-Structured-Documents/blob/7400704346cb9698f6c6b1ad3307d2439d17fa33/grapher.py#L11", "anchor_text": "Python implementation"}, {"url": "https://github.com/dhavalpotdar/Graph-Convolution-on-Structured-Documents/blob/7400704346cb9698f6c6b1ad3307d2439d17fa33/grapher.py#L520", "anchor_text": "code"}, {"url": "https://arxiv.org/abs/1706.02216", "anchor_text": "arXiv"}, {"url": "http://snap.stanford.edu/graphsage/", "anchor_text": "snap.stanford.edu"}, {"url": "https://github.com/williamleif/GraphSAGE", "anchor_text": "GitHub"}, {"url": "https://arxiv.org/abs/1609.02907", "anchor_text": "arXiv"}, {"url": "https://tkipf.github.io/graph-convolutional-networks/", "anchor_text": "tkipf.github.io"}, {"url": "https://github.com/tkipf/gcn", "anchor_text": "GitHub"}, {"url": "https://arxiv.org/abs/1904.12577", "anchor_text": "arXiv"}, {"url": "https://priba.github.io/assets/publi/slides/2019_ICDAR_PRiba.pdf", "anchor_text": "ICDAR"}, {"url": "https://priba.github.io/assets/publi/slides/2019_ICDAR_PRiba.pdf", "anchor_text": "priba.github.io"}, {"url": "https://github.com/dhavalpotdar/Graph-Convolution-on-Structured-Documents", "anchor_text": "here is my starter code"}, {"url": "https://arxiv.org/pdf/1901.00596.pdf", "anchor_text": "Here"}, {"url": "https://medium.com/u/c5d462ada007?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "Dhaval Potdar"}, {"url": "https://www.udacity.com/course/data-analyst-nanodegree--nd002", "anchor_text": "Data Analyst"}, {"url": "https://www.udacity.com/course/machine-learning-engineer-nanodegree--nd009t", "anchor_text": "Machine Learning Engineer"}, {"url": "https://www.linkedin.com/in/dhavalpotdar/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/dhavalpotdar", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/graph-convolution?source=post_page-----c1088dcd2b8f---------------graph_convolution-----------------", "anchor_text": "Graph Convolution"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----c1088dcd2b8f---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/geometric-deep-learning?source=post_page-----c1088dcd2b8f---------------geometric_deep_learning-----------------", "anchor_text": "Geometric Deep Learning"}, {"url": "https://medium.com/tag/information-extraction?source=post_page-----c1088dcd2b8f---------------information_extraction-----------------", "anchor_text": "Information Extraction"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c1088dcd2b8f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc1088dcd2b8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&user=Dhaval+Potdar&userId=c5d462ada007&source=-----c1088dcd2b8f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc1088dcd2b8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&user=Dhaval+Potdar&userId=c5d462ada007&source=-----c1088dcd2b8f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1088dcd2b8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc1088dcd2b8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c1088dcd2b8f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c1088dcd2b8f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dhavalpotdar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dhavalpotdar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dhaval Potdar"}, {"url": "https://medium.com/@dhavalpotdar/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "69 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5d462ada007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&user=Dhaval+Potdar&userId=c5d462ada007&source=post_page-c5d462ada007--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc5d462ada007%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graph-convolutional-neural-networks-on-structured-documents-for-information-extraction-c1088dcd2b8f&user=Dhaval+Potdar&userId=c5d462ada007&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}