{"url": "https://towardsdatascience.com/6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8", "time": 1683009973.676213, "path": "towardsdatascience.com/6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8/", "webpage": {"metadata": {"title": "6 Lesser-Known Yet Awesome Tricks in Pandas | by Kat Li | Towards Data Science", "h1": "6 Lesser-Known Yet Awesome Tricks in Pandas", "description": "As the most popular Python library for analytics, Pandas is a big project that offers various data manipulation and processing capabilities. It is probably no exaggeration to say that data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Table_of_food_nutrients", "anchor_text": "Table of food nutrients", "paragraph_index": 2}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html", "anchor_text": "options system", "paragraph_index": 7}, {"url": "http://Since this is beyond the scope of this blog, I will not discuss it here, however, more details regarding how to (create ODBC or JDBC connections) can be found here.", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://github.com/YiLi225/Pandas_Tricks", "anchor_text": "Github repo here", "paragraph_index": 30}, {"url": "https://yilistats.medium.com/membership", "anchor_text": "my link", "paragraph_index": 31}, {"url": "https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw", "anchor_text": "\u201cData Talks with Kat\u201d", "paragraph_index": 32}], "all_paragraphs": ["As the most popular Python library for analytics, Pandas is a big project that offers various data manipulation and processing capabilities. It is probably no exaggeration to say that data scientists, myself included, use Pandas on a day-to-day basis in our work.", "This blog is Part 1 of the mini-series dedicated to sharing my top 10 lesser-known yet most favorable features in Pandas. Hopefully, you can walk away with some inspirations to make your own code more robust and efficient.", "The dataset for this mini-series is from the Table of food nutrients, a Wikipedia page containing 16 tabular lists for basic foods categorized by food types, and their nutrients. For this demonstration, specifically, we will work with a subset of the Dairy products table, as shown below,", "1. Scraping tables from HTML with read_html(match)", "When it comes to web scraping in Python, my go-to library used to be the BeautifulSoup until I discovered read_html() in Pandas. Without the hassle of parsing the HTML page, we can directly extract the data stored as HTML tables,", "Noticed the arg. match = \u2018Fortified milk\u2019 in the code? It is used to only select table(s) containing the string or regular expression specified, which, in our case, is the dairy table. The match arg. will be extremely handy when our HTML page becomes big.", "Looking at the output display, however, we realize that quite a few rows and columns are truncated!", "Working with Pandas for a while, you probably know that it allows users to configure display-related options in its options system. For instance, setting pd.options.display.max_rows = 1000 solves the display issue above, which literally made my day back when I first learned Pandas!", "However, my frustrations piled up on the fact that I had to re-write the same config. options every single time I started a new IPython session. Little did I know that these options can be compiled into the IPython startup file,", "Then we simply set the PYTHONSTARTUP environment variable to point at this startup file, and all the convenient settings will be automatically loaded when Python starts. Here is the printout after the startup file being executed,", "As we just saw, this data contains missing values due to the sub-categories in the \u2018Food\u2019 column,", "Intuitively, our next step is to remove the missing values by either eliminating the rows with NAs or populating them with the desired values. Regardless of which option we decide to go with, we need first to concatenate the \u2018Food\u2019 column as they each contain unique information. This, as we all know, can be achieved via looping through rows with the .iterrows() method.", "However, a better way of looping in Pandas is .itertuples(), which, as the name suggests, returns a tuple rather than a pd.Series as in .iterrows() .", "More often than not, I find .itertuples() runs way faster than .iterrows() because the former eliminates several overhead in calling .iterrows() method, e.g., checking data types. More details can be found here if you are interested.", "Now, let\u2019s explore how to concatenate our \u2018Food\u2019 values with .itertuples(),", "Tricks in this syntax include (1) initializing two global variables to store the current \u2018Food\u2019 value and the row index, which happens to be the 1st element in the \u2018row\u2019 tuple; (2) modifying the original dairy table by assigning back the new concatenated \u2018Food\u2019 value.", "Here shows the output we envisioned,", "4. Imputing missing values with .fillna(method)", "As we briefly touched upon, the other way of handling missing values is to populate them with desired values, which, in our case, would be values in the next consecutive row. Now the fillna() function comes in handy,", "With just one line of code, our missing values are imputed,", "Here we specify the arg. method = \u2018bfill\u2019: backward fill that propagates the first non-null values backward. Another option is \u2018ffill\u2019: forward fill, which is particularly useful in time series data. More detail about this parameter and its multiple value options is linked here.", "In fact, when I first learned the .fillna(), I enjoyed it very much because it allows me to impute NAs without first subsetting the rows with NAs. Nevertheless, not until I discovered the arg. method that this function quickly became one of my favorite functions in Pandas.", "With NAs being filled in, now how about us taking a different approach to concatenate the \u2018Food\u2019 values? Step 1, let\u2019s create some key variables indicating which rows are to be combined, i.e., two consecutive rows having the same values on variables other than \u2018Food\u2019,", "Two tricks here: (1) using shift(1) to select the previous row, which is then compared with the current row; (2) calling cumsum() for booleans converted to an integer vector (i.e., 1=True, 0=False) to \u201ccalculate\u201d if the two rows are different.", "Since we compared all 3 columns in the dataset, there are 3 additional key variables (e.g., Measure_) created from the cumsum(). Once we merge them back with the dairy table, we will see the following output, where all 3 key variables stay the same for the rows to be combined,", "6. Introspecting the GroupBy object with .get_group()", "Having our key variables available, we can continue to concatenate the \u2018Food\u2019 values using another favorable trick: .groupby() + .apply(), and the code below returns the same output as in item \u21163,", "Similar to the GROUPBY operation in SQL, .groupby() in Pandas chunks our data into groups defined by the key variables. But how does it work exactly? To introspect the object .DataFrameGroupBy, we can leverage the lesser-used .groups and .get_group(),", "From the partial printout below, we can see that each group is a tiny dataframe pieced from the original dataset, and when we call apply(), the same operation (e.g., join in our case) will iterate through individual group until it reaches the end,", "Therefore, explicitly visualizing the GroupBy object is extremely helpful in ensuring that we are applying the operations against the correct sub-dataset.", "There you have it! 6 lesser-used tricks to level up your coding in Pandas, and I hope you find this topic helpful. In Part 2 of this mini-series, I will be sharing the other 4 of my most favorite Pandas features, so be on a lookout for that \ud83d\ude42As always, all the code can be found in my Github repo here, and happy learning!", "Want more data science and programming tips? Use my link to sign up to Medium and gain full access to all my content.", "Also subscribe to my newly created YouTube channel \u201cData Talks with Kat\u201d,", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F32236f3785c8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----32236f3785c8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----32236f3785c8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yilistats.medium.com/?source=post_page-----32236f3785c8--------------------------------", "anchor_text": ""}, {"url": "https://yilistats.medium.com/?source=post_page-----32236f3785c8--------------------------------", "anchor_text": "Kat Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7657f76e72be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&user=Kat+Li&userId=7657f76e72be&source=post_page-7657f76e72be----32236f3785c8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32236f3785c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32236f3785c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/vpOeXr5wmR4", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Table_of_food_nutrients", "anchor_text": "Table of food nutrients"}, {"url": "https://en.wikipedia.org/wiki/Table_of_food_nutrients", "anchor_text": "Wikipedia"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html", "anchor_text": "options system"}, {"url": "https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw", "anchor_text": "\u201cData Talks with Kat\u201d"}, {"url": "https://en.wikipedia.org/wiki/Table_of_food_nutrients", "anchor_text": "Wikipedia"}, {"url": "http://Since this is beyond the scope of this blog, I will not discuss it here, however, more details regarding how to (create ODBC or JDBC connections) can be found here.", "anchor_text": "here"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html", "anchor_text": "here"}, {"url": "https://github.com/YiLi225/Pandas_Tricks", "anchor_text": "Github repo here"}, {"url": "https://yilistats.medium.com/membership", "anchor_text": "my link"}, {"url": "https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw", "anchor_text": "\u201cData Talks with Kat\u201d"}, {"url": "https://towardsdatascience.com/6-sql-tricks-every-data-scientist-should-know-f84be499aea5", "anchor_text": "6 SQL Tricks Every Data Scientist Should KnowSQL tricks to make your analytics work more efficienttowardsdatascience.com"}, {"url": "https://towardsdatascience.com/data-reshaping-in-sql-r-and-python-d44ca19e71b8", "anchor_text": "Data Reshaping in SQL, R and PythonFrom Python vs. R to Python & Rtowardsdatascience.com"}, {"url": "https://medium.com/tag/pandas?source=post_page-----32236f3785c8---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/python?source=post_page-----32236f3785c8---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----32236f3785c8---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----32236f3785c8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tips-and-tricks?source=post_page-----32236f3785c8---------------tips_and_tricks-----------------", "anchor_text": "Tips And Tricks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F32236f3785c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&user=Kat+Li&userId=7657f76e72be&source=-----32236f3785c8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F32236f3785c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&user=Kat+Li&userId=7657f76e72be&source=-----32236f3785c8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32236f3785c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----32236f3785c8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F32236f3785c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----32236f3785c8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----32236f3785c8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----32236f3785c8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----32236f3785c8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----32236f3785c8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----32236f3785c8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----32236f3785c8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----32236f3785c8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----32236f3785c8--------------------------------", "anchor_text": ""}, {"url": "https://yilistats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yilistats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kat Li"}, {"url": "https://yilistats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "https://www.youtube.com/@DataTalksWithKat", "anchor_text": "https://www.youtube.com/@DataTalksWithKat"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7657f76e72be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&user=Kat+Li&userId=7657f76e72be&source=post_page-7657f76e72be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F37afe5b5308f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8&newsletterV3=7657f76e72be&newsletterV3Id=37afe5b5308f&user=Kat+Li&userId=7657f76e72be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}