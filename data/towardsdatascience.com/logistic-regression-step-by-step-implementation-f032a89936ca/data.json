{"url": "https://towardsdatascience.com/logistic-regression-step-by-step-implementation-f032a89936ca", "time": 1683015593.992039, "path": "towardsdatascience.com/logistic-regression-step-by-step-implementation-f032a89936ca/", "webpage": {"metadata": {"title": "Logistic Regression Step by Step Implementation | by Jeremy Zhang | Towards Data Science", "h1": "Logistic Regression Step by Step Implementation", "description": "And to predict 1 response variable $y$ (may be the sales of next year, the house price, etc.), the simplest form is to use a linear regression to do the prediction with the formula: Where $W$ is a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/gradient-descent-explanation-implementation-c74005ff7dd1", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://math.stackexchange.com/questions/78575/derivative-of-sigmoid-function-sigma-x-frac11e-x", "anchor_text": "here", "paragraph_index": 11}, {"url": "https://github.com/MJeremy2017/deep-learning/tree/main/logistic-regression", "anchor_text": "git repo", "paragraph_index": 18}, {"url": "https://github.com/MJeremy2017/deep-learning/tree/main/logistic-regression", "anchor_text": "here", "paragraph_index": 24}], "all_paragraphs": ["Say we are doing a classic prediction task, where given a input vector with $n$ variables:", "And to predict 1 response variable $y$ (may be the sales of next year, the house price, etc.), the simplest form is to use a linear regression to do the prediction with the formula:", "Where $W$ is a column vector with $n$ dimension. Say now our question changed a bit, we hope to predict a probability, like what\u2019s the probability of raining tomorrow? In this sense, this linear regression might be a little unfit here, as a linear expression can be unbounded but our probability is ranged in $[0, 1]$.", "To bound our prediction in $[0, 1]$, the widely used technic is to apply a sigmoid function:", "With numpy we can easily visualize the function.", "The definition of loss function of logistic regression is:", "Where y_hat is our prediction ranging from $[0, 1]$ and y is the true value. When the actual value is y = 1, the equation becomes:", "the closer y_hat to 1, the smaller our loss is. And the same goes for y = 0 .", "Given this actual value y, we hope to minimize the loss L, and the technic we are going to apply here is gradient descent(the details has been illustrated here), basically what we need to do is to apply derivative to our variables and move them slightly down to the optimum.", "Here we have 2 variables, W and b, and for this example, the update formula of them would be:", "Where W is a column vector with n weights correspond to the n dimension of x^(i). In order to get the derivative of our targets, chain rules would be applied:", "You can try out the deduction on your own, the only tricky part is the derivative of sigmoid function, for a good explanation you can refer to here.", "The above gives the forward and backward updating process, which is well enough to implement a logistic regression if we were to feed in our training model *ONE AT A TIME*. However, in most training cases, we don\u2019t do that. Instead training samples are feed in batches, and the backward propagation is updated with average loss of the batch.", "Which means that for a model that feed with m samples at a time, the loss function would be:", "Where i denotes the ith training sample.", "Now instead of using x, a single vector, as our input, we specify a matrix X with size n x m, where as above, n is the number of features and m is number of training samples (basically, we line up m training samples in a matrix). Now the formula becomes:", "Note that here we use *UPPER LETTER* to denote our matrix and vectors (a caveat is that b here is still a single value, the more formal way would be to represent b as a vector, but in python the addition of a single value to a matrix would be automated broadcasted).", "Let\u2019s break down the size of the matrices one by one.", "Our formula stuff ends here, let\u2019s implement our algorithm, before that some data needs to be generated to make a classification task (the whole implementation is also in my git repo).", "Now everything is set, let\u2019s go for the implementation.", "Our predict function would be simply going through the forward process given trained weights", "Notice that for the train function, the input shape of X needs to have shape of n x m, and Y with shape of 1 x m, where m is the batch size.", "The input need to transpose in order to fit in our training requirements.", "Now let\u2019s ensemble everything into a class to look more structured. For completeness, a batched training would also be implemented", "The full training detail can check here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hmm\u2026I am a data scientist looking to catch up the tide\u2026"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff032a89936ca&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f032a89936ca--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f032a89936ca--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://meatba11.medium.com/?source=post_page-----f032a89936ca--------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=post_page-----f032a89936ca--------------------------------", "anchor_text": "Jeremy Zhang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37783fc8c26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&user=Jeremy+Zhang&userId=f37783fc8c26&source=post_page-f37783fc8c26----f032a89936ca---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff032a89936ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff032a89936ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/gradient-descent-explanation-implementation-c74005ff7dd1", "anchor_text": "here"}, {"url": "https://math.stackexchange.com/questions/78575/derivative-of-sigmoid-function-sigma-x-frac11e-x", "anchor_text": "here"}, {"url": "https://github.com/MJeremy2017/deep-learning/tree/main/logistic-regression", "anchor_text": "git repo"}, {"url": "https://github.com/MJeremy2017/deep-learning/tree/main/logistic-regression", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f032a89936ca---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f032a89936ca---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff032a89936ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&user=Jeremy+Zhang&userId=f37783fc8c26&source=-----f032a89936ca---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff032a89936ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&user=Jeremy+Zhang&userId=f37783fc8c26&source=-----f032a89936ca---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff032a89936ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f032a89936ca--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff032a89936ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f032a89936ca---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f032a89936ca--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f032a89936ca--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f032a89936ca--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f032a89936ca--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f032a89936ca--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f032a89936ca--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f032a89936ca--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f032a89936ca--------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeremy Zhang"}, {"url": "https://meatba11.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37783fc8c26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&user=Jeremy+Zhang&userId=f37783fc8c26&source=post_page-f37783fc8c26--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcdbd8b83c584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-step-by-step-implementation-f032a89936ca&newsletterV3=f37783fc8c26&newsletterV3Id=cdbd8b83c584&user=Jeremy+Zhang&userId=f37783fc8c26&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}