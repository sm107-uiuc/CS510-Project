{"url": "https://towardsdatascience.com/interactive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8", "time": 1683015182.9721699, "path": "towardsdatascience.com/interactive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8/", "webpage": {"metadata": {"title": "Interactive Visualization of the Outcome of Any Binary Classifier \u2014 in 5 Lines of Python | by Samuele Mazzanti | Towards Data Science", "h1": "Interactive Visualization of the Outcome of Any Binary Classifier \u2014 in 5 Lines of Python", "description": "Binary classification is the most common task in machine learning. It\u2019s also pretty general, since n-class problems and regression problems can be both reduced to the binary case (of course with some\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "confusion matrix", "paragraph_index": 4}, {"url": "https://plotly.com/python/", "anchor_text": "Plotly", "paragraph_index": 19}, {"url": "https://www.linkedin.com/in/samuelemazzanti/", "anchor_text": "my Linkedin contact", "paragraph_index": 27}], "all_paragraphs": ["5 lines of code for people in a hurry:", "Binary classification is the most common task in machine learning. It\u2019s also pretty general, since n-class problems and regression problems can be both reduced to the binary case (of course with some loss of information).", "Say that you have gathered your data, cleaned it and fitted a classifier. Unfortunately, when the job is over, the job has just begun! In fact, you still have to deal with a lot of stuff: true positives, false positives, false negatives, accuracy, precision, recall, \u2026 And to boot, all these are multiplied by the number of possible thresholds (there are easily thousands of them).", "This is why I started looking for a single (possibly graphical and interactive) representation, containing all the relevant information regarding a binary classification task. Given that this visualization is founded on confusion matrices, I\u2019ve called it \u201cconfusion_viz\u201d.", "The most elementary tool used to evaluate the goodness of classification (may be a machine learning model, but also a deterministic rule) is called confusion matrix. It\u2019s a table showing how many individuals are classified correctly or not, for each class.", "For example, let\u2019s take a simple classification problem on some simulated data:", "The fact that numbers are \u201craw\u201d constitutes both the strength and the weakness of a confusion matrix.", "Therefore, several options may be adopted to make a confusion matrix more \u201cexpressive\u201d. For instance:", "These manipulations give a multifaceted portrait of a model\u2019s performance. However, the problem is that humans are not good at storing plenty of information. This is why I started wondering how to get an impactful visualization of confusion matrix that could show all the relevant information \u201cat a glance\u201d.", "The requirements for such a visualization are:", "After some attempts, I have come to define a visualization that is intuitive enough for my goals. According to it, the confusion matrix above would look like this:", "The square with pink borders represents the totality of positives (i.e. True Positives + False Negatives). This is like the bull\u2019s eye of a dashboard: we wish our model to be capable of throwing most of its darts here.", "The square with black edges represents exactly the guess made by the model: these are all the individuals tagged as positives. Thus, the area in common between the pink-edge square and the black-edge square is filled with green and represents the true positives. The remaining part is made of False Positives and is colored in red.", "But things get a bit more complex than that. In fact, for each model, we don\u2019t have just one confusion matrix. Actually, we have a lot of them. How is that even possible? This is often uneasy to understand for non-technical stakeholders.", "It all depends on the concept of \u201cprobability threshold\u201d. The output of most classification algorithm is not actually a 0/1 for each individual, but rather a number between 0 and 1 expressing how likely that individual is to be a positive, which we call \u201cprobability\u201d.", "Therefore, the final classification 0/1 is not automatic, but it derives from a (business) decision. The decision consists in identifying the probability threshold above which the individual should be classified as 1.", "Let\u2019s make this even more explicit:", "Each possible decision is associated with an array of 0/1. In turn, each array is associated with a different confusion matrix. This is why, for a single model, we may have thousands (or even millions!) of possible confusion matrices: one for each threshold.", "Thus, the question becomes: can we represent the different confusion matrices (or at least a representative subset of them) in a single plot?", "By using Plotly, it can be done through a slider: this is where interactive plots come to our aid. The idea is that, as we move the slider from the left to the right, the associated threshold increases, and therefore the selection becomes more and more \u201crestrictive\u201d, in the sense that the number of observations that we classify as positives is smaller and smaller.", "The slider indicates what is the current probability threshold (\u201cP \u2265 threshold\u201d).", "If you keep an eye on precision and recall, you will notice that they have an opposite behaviour: as the slider moves to the right, recall decreases while precision improves. This makes a lot of sense: if you select only the riskiest individuals, you will probably be more precise, but at the cost of identifying a smaller fraction of positives (i.e. smaller recall).", "In general, the interactive nature of the plot allows you to pick a threshold that is suitable for your specific use case.", "All you have to do is pip-installing the package confusion_viz in your environment.", "The package consists of a class called ConfusionViz, so you simply need to import it in your Python code. The next snippet shows how to use ConfusionViz: showing the interactive plot in notebook mode (command .show()) or exporting it to an html file (command .to_html()) that you can then open with any browser.", "You just need to replace y_test and probas_test with your own data, and the game is made!", "Thank you for reading! I hope you found this post useful.", "I appreciate feedback and constructive criticism. If you want to talk about this article or other related topics, you can text me at my Linkedin contact.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Data Scientist | Striving for simplicity."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9c1f627ded8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03----9c1f627ded8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c1f627ded8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c1f627ded8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "confusion matrix"}, {"url": "https://plotly.com/python/", "anchor_text": "Plotly"}, {"url": "https://www.linkedin.com/in/samuelemazzanti/", "anchor_text": "my Linkedin contact"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----9c1f627ded8---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9c1f627ded8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/visualization?source=post_page-----9c1f627ded8---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/confusion-matrix?source=post_page-----9c1f627ded8---------------confusion_matrix-----------------", "anchor_text": "Confusion Matrix"}, {"url": "https://medium.com/tag/classification?source=post_page-----9c1f627ded8---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c1f627ded8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----9c1f627ded8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c1f627ded8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----9c1f627ded8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c1f627ded8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9c1f627ded8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9c1f627ded8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9c1f627ded8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9c1f627ded8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9c1f627ded8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9c1f627ded8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/@mazzanti.sam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce90f5bea5f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-visualization-of-binary-classification-in-5-lines-of-python-9c1f627ded8&newsletterV3=e16f3bb86e03&newsletterV3Id=ce90f5bea5f9&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}