{"url": "https://towardsdatascience.com/introducing-generalized-integrated-gradients-gig-ecad6a03d77f", "time": 1683003242.8611908, "path": "towardsdatascience.com/introducing-generalized-integrated-gradients-gig-ecad6a03d77f/", "webpage": {"metadata": {"title": "Introducing Generalized Integrated Gradients (GIG) | by Jay Budzik | Towards Data Science", "h1": "Introducing Generalized Integrated Gradients (GIG)", "description": "Of all the ways machine learning is being deployed in the global economy, one of the highest-impact applications is in credit underwriting. Machine learning is proven to yield better predictions of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1705.07874", "anchor_text": "Shapley Additive Explanations", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1703.01365", "anchor_text": "Integrated Gradients", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Cooperative_game_theory", "anchor_text": "cooperative game", "paragraph_index": 1}, {"url": "https://arxiv.org/pdf/1705.07874.pdf", "anchor_text": "SHAP", "paragraph_index": 2}, {"url": "https://arxiv.org/pdf/1703.01365.pdf", "anchor_text": "Integrated Gradients", "paragraph_index": 2}, {"url": "https://www.zest.ai/blog/many-heads-are-better-than-one-making-the-case-for-ensemble-learning", "anchor_text": "recent post", "paragraph_index": 4}, {"url": "http://www.zest.ai/", "anchor_text": "Zest AI", "paragraph_index": 5}, {"url": "https://arxiv.org/abs/1909.01869", "anchor_text": "Generalized Integrated Gradients", "paragraph_index": 6}, {"url": "https://www.amazon.com/Principles-Mathematical-Analysis-International-Mathematics/dp/007054235X", "anchor_text": "measure theory", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Shapley_value#Aumann%E2%80%93Shapley_value", "anchor_text": "Aumann-Shapley", "paragraph_index": 13}, {"url": "https://arxiv.org/abs/1909.01869", "anchor_text": "Generalized Integrated Gradients", "paragraph_index": 19}, {"url": "https://arxiv.org/abs/1909.01869", "anchor_text": "GIG paper", "paragraph_index": 20}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Merrill%2C+J", "anchor_text": "John Merrill", "paragraph_index": 20}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Ward%2C+G", "anchor_text": "Geoff Ward", "paragraph_index": 20}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Kamkar%2C+S", "anchor_text": "Sean Kamkar", "paragraph_index": 20}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Budzik%2C+J", "anchor_text": "Jay Budzik", "paragraph_index": 20}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Merrill%2C+D", "anchor_text": "Douglas Merrill", "paragraph_index": 20}], "all_paragraphs": ["Why A New Credit Assignment Method is Needed", "Of all the ways machine learning is being deployed in the global economy, one of the highest-impact applications is in credit underwriting. Machine learning is proven to yield better predictions of borrower defaults, increase access to credit for those who need it, and mitigate bias in lending. But not all machine learning techniques, including the wide swath at work in less regulated uses, are built to be transparent. Many of the algorithms that get deployed generate results that are difficult to explain. Recently, researchers have proposed novel and powerful methods for explaining machine learning models, notably Shapley Additive Explanations (SHAP Explainers) and Integrated Gradients (IG). These methods provide mechanisms for assigning credit to the data variables used by a model to generate a score. They work by representing the machine learning model as a game: each variable is a player, the rules of the game are the model\u2019s scoring functions, and the value of the game is the score given by the model. Credit allocation in a cooperative game is a well-understood problem.", "SHAP uses various methods to compute Shapley values, which work well in atomic games to identify the most important variables by re-computing the outcome of the model with each variable systematically removed. When the algorithm is a neural net, which runs infinitesimal tiny games none of which individually matters but they do in the aggregate, you need Integrated Gradients to explain a model. IG uses Aumann-Shapley values to understand the difference in model scores between two applicants. It quantifies how much each input variable contributes to the difference in a model\u2019s score. After all, some changes matter more than others according to the model, and so our task is to measure which changes the model thinks are more or less important.", "Both are great innovations in their own right, but neither provides satisfactory credit allocation for mixed-type models that achieve the best results. The explainers implemented in the SHAP package either require variables to be statistically independent or that missing values can be replaced by an average. Both of these are non-starters in financial services. IG requires the model to be everywhere differentiable, which isn\u2019t true for decision trees, and so it only works on models like neural networks.", "Big tech firms like Google, Facebook, and Microsoft have been exploiting the benefits of ensembled ML for years. They build models that use trees and neural networks and a full palette of modeling math, but they\u2019re not operating under the same regulatory constraints as financial services firms. Banks and lenders would benefit immensely from using these same kinds of advanced models for applications like credit underwriting and fraud detection. (Check out our recent post introducing a new ensemble method called deep stacking that yielded one small lender $13 million in profit and a more accurate and stable model.)", "All the arrows point to the need for a new way to explain complex, ensembled ML models for high-stakes applications such as credit and lending. This is why Zest AI developed GIG.", "Generalized Integrated Gradients (GIG) is a new credit assignment algorithm that overcomes the limitations of both Shapley and Aumann-Shapley by applying the tools of measure theory. GIG is a formal extension of IG that accurately allocates credit for a significantly broader class of models, including almost all of the scoring functions currently in use in the machine learning field. GIG is the only method for rigorously calculating the contributions of each variable with respect to diverse ensembles of models.", "What makes GIG better at explaining complex ML models is that it avoids making unrealistic and potentially dangerous assumptions about the data. GIG follows directly from its axioms. With SHAP and other methods based on Shapley Values, you have to map the input variables into a much higher dimensional space in order to get the values to work for machine learning functions. There are an uncountable number of such mappings, and it is not clear which, if any, is the correct mapping. By contrast, GIG is entirely determined by mathematics.", "GIG allocates credit by directly analyzing the model function in pieces to answer the question, \u201cWhich input variables led to the change in the model score?\u201d It measures the importance of each variable by accumulating changes in the model score along a path from first input to another according to a unique formula that computes the amount each variable causes the predictive function to change its score.", "Application to a real-world credit risk model", "To demonstrate GIG\u2019s capabilities, we used it to explain a mixed ensemble model built from real-world lending data. The model, illustrated below and cited earlier, is a stacked ensemble of 4 XGBoost models and 2 neural network models.", "Table stakes in any model explainability task are to quantify accurately the importance of each feature in the model. We conducted a series of experiments (described in our paper) that show that GIG accurately quantifies the influence of the variables in simple models. The experiments built a series of toy models based on known variations in input data, and we showed that GIG was able to accurately portray what the model learned from the deliberately modified data. Here, we look at a real-world application. Table 1 shows feature importance for the more complex ensemble displayed in Figure 1. The table shows that GIG can explain even this more complex, real-world model.", "In addition to computing overall feature importance, GIG allows you to quantify feature importance for each applicant and for various populations, such as the highest performing and the lowest-performing loans, or the variables that caused a difference in approval rate between men and women applicants.", "As we mentioned earlier, GIG is a differential credit assignment function based on IG and Aumann-Shapley. Differential credit assignment answers the question of how much each change in the input caused a change in the model\u2019s score. You compare the set of inputs between two applicants and the likelihood of default returned by the model for each (for example, one applicant might have been denied, and another applicant might have been approved). GIG shows how much each input variable contributed to the change in score that led to the approved/denied decision.", "Let\u2019s visualize how this all works. Figure 2 shows a set of approved applicants in green and a set of denied applicants in red. Declined applicants have a high number of delinquencies and bankruptcies. The opposite is true for approved applicants.", "Differential credit assignment functions like GIG explain the difference between the two classes of applicants by comparing each approved applicant with each denied applicant: You\u2019re basically computing the difference in delinquencies and bankruptcies between each pair of approved and denied applicants and taking the average. This process is illustrated for one pair in this comparison, shown in Figure 3, below.", "This is meant for illustration only, the charts are missing the model score. A more realistic picture is displayed in Figure 4, below, which shows how the model score varies with respect to the delinquency and bankruptcy variables along a path between a denied applicant and an approved applicant. The IG method uses Aumann-Shapley values to computes the contribution of delinquencies and bankruptcies to the change in the model score along the path between the approved and denied applicants.", "A model can have any number of dimensions, and Aumann-Shapley will accommodate them. But as we said before, the Aumann-Shapley value only works for smooth functions like neural networks. Figure 5 illustrates a simple example of a composition of functions that Aumann-Shapley (and therefore IG) cannot explain.", "GIG works by first enumerating all the discontinuities in the discrete functions (e.g., by depth-first search of the model\u2019s decision trees) and computes the value of the discrete function from the left and from the right of each discontinuity. It assigns credit based on the average of these two values, as shown in the left panel of Figure 6 below. The credit assigned to the continuous parts is computed using IG (right panel of Figure 6). The discrete and continuous contributions are then put back together to arrive at a highly accurate combined contribution.", "Ensemble models produce better results than any single modeling method alone, but they have heretofore been impossible to explain accurately. We introduced a new method, Generalized Integrated Gradients, which is the only method, under a small set of reasonable axioms, of explaining diverse ensembles and combinations of functions that we often encounter in real-world applications of machine learning such as in financial services. GIG makes it possible to use these advanced, more effective models in your lending business to make more good loans and fewer bad loans and still explain the results to consumers, regulators, and business owners.", "The original GIG paper was written by Zest AI\u2019s John Merrill, Geoff Ward, Sean Kamkar, Jay Budzik, and Douglas Merrill.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CTO of Zest AI. Proud dad. Altadena vis Chicago."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fecad6a03d77f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jay.budzik?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jay.budzik?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": "Jay Budzik"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46656044e366&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&user=Jay+Budzik&userId=46656044e366&source=post_page-46656044e366----ecad6a03d77f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fecad6a03d77f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fecad6a03d77f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@blakesox?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Blake Wheeler"}, {"url": "https://unsplash.com/s/photos/illuminated?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.zest.ai/blog/many-heads-are-better-than-one-making-the-case-for-ensemble-learning", "anchor_text": "provide more predictive accuracy"}, {"url": "http://www.zest.ai/", "anchor_text": "Zest AI"}, {"url": "https://arxiv.org/abs/1705.07874", "anchor_text": "Shapley Additive Explanations"}, {"url": "https://arxiv.org/abs/1703.01365", "anchor_text": "Integrated Gradients"}, {"url": "https://en.wikipedia.org/wiki/Cooperative_game_theory", "anchor_text": "cooperative game"}, {"url": "https://arxiv.org/pdf/1705.07874.pdf", "anchor_text": "SHAP"}, {"url": "https://arxiv.org/pdf/1703.01365.pdf", "anchor_text": "Integrated Gradients"}, {"url": "https://www.zest.ai/blog/many-heads-are-better-than-one-making-the-case-for-ensemble-learning", "anchor_text": "recent post"}, {"url": "http://www.zest.ai/", "anchor_text": "Zest AI"}, {"url": "https://arxiv.org/abs/1909.01869", "anchor_text": "Generalized Integrated Gradients"}, {"url": "https://www.amazon.com/Principles-Mathematical-Analysis-International-Mathematics/dp/007054235X", "anchor_text": "measure theory"}, {"url": "https://en.wikipedia.org/wiki/Shapley_value#Aumann%E2%80%93Shapley_value", "anchor_text": "Aumann-Shapley"}, {"url": "https://arxiv.org/abs/1909.01869", "anchor_text": "Generalized Integrated Gradients"}, {"url": "https://arxiv.org/abs/1909.01869", "anchor_text": "GIG paper"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Merrill%2C+J", "anchor_text": "John Merrill"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Ward%2C+G", "anchor_text": "Geoff Ward"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Kamkar%2C+S", "anchor_text": "Sean Kamkar"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Budzik%2C+J", "anchor_text": "Jay Budzik"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Merrill%2C+D", "anchor_text": "Douglas Merrill"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ecad6a03d77f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----ecad6a03d77f---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/technology-news?source=post_page-----ecad6a03d77f---------------technology_news-----------------", "anchor_text": "Technology News"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ecad6a03d77f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/big-data?source=post_page-----ecad6a03d77f---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fecad6a03d77f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&user=Jay+Budzik&userId=46656044e366&source=-----ecad6a03d77f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fecad6a03d77f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&user=Jay+Budzik&userId=46656044e366&source=-----ecad6a03d77f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fecad6a03d77f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fecad6a03d77f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ecad6a03d77f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ecad6a03d77f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jay.budzik?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jay.budzik?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jay Budzik"}, {"url": "https://medium.com/@jay.budzik/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46656044e366&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&user=Jay+Budzik&userId=46656044e366&source=post_page-46656044e366--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F46656044e366%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-generalized-integrated-gradients-gig-ecad6a03d77f&user=Jay+Budzik&userId=46656044e366&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}