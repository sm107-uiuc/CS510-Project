{"url": "https://towardsdatascience.com/the-little-known-ogrid-function-in-numpy-19ead3bdae40", "time": 1683002235.391973, "path": "towardsdatascience.com/the-little-known-ogrid-function-in-numpy-19ead3bdae40/", "webpage": {"metadata": {"title": "The Little Known OGrid Function in Numpy | by Ritvik Kharkar | Towards Data Science", "h1": "The Little Known OGrid Function in Numpy", "description": "This past quarter, I was helping my students learn the powerful numerical processing library in Python known as Numpy. For a good chunk of the course, we were using Numpy to perform transformations\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["This past quarter, I was helping my students learn the powerful numerical processing library in Python known as Numpy. For a good chunk of the course, we were using Numpy to perform transformations on images, because images are, after all, just big arrays of numbers.", "Soon enough, we started talking about how to transform an image, from basic transformations like making an image black & white to more complex edits like adding a halo around an image. It was during this discussion that I learned about the little known ogrid function in Numpy and how we can leverage it to more easily transform images.", "Ogrid stands for \u201copen grid\u201d and basically provides a way to act on specific pixels of an image based on their row and column index. To start from basics, here is how to call the ogrid function in Numpy assuming you\u2019ve imported Numpy as np.", "We see here that ogrid takes in a range of the x-coordinate (0 through 10, not including 10) and a range of the y-coordinate (0 through 5, not including 5). We store the results of ogrid in two variables, x and y.", "Showing the contents of x reveals that it is a list of size-one lists, each of which is a number between 0 and 9. Showing the contents of y reveals that it is a list of a single list, which is just the numbers between 0 and 4.", "Well, suppose you have a matrix that is 10 by 5, just like the dimensions of the ogrid. We see below that indexing the matrix using the ogrid gives back exactly the matrix itself.", "More importantly, we can use the x and y returned by the ogrid to create something called a \u201cmask\u201d, isolating only the matrix elements we care about, based on their row and column index.", "In the code above, note that we only care about matrix elements whose row index (x) is bigger than 5 or whose column index (y) is less than 3. The result is a mask, which is an array of True/False indicating where the condition holds and where it does not.", "Because now, we can use this mask to act on only the elements of our matrix where the mask is True (or equivalently, False).", "Above, we set any matrix element to 0 where the mask is True, giving the resulting matrix. Apply the same train of thought to an entire image and we see that we can use ogrid to create masks that help us act on specific pixels of our image. Let\u2019s see a few examples!", "Let\u2019s first read in the image we\u2019ll be working with.", "The result is our favorite electric mouse.", "Then, let\u2019s generate the ogrid for this image.", "One important note is the direction of the axes in Numpy. Contrary to how we are used to seeing x and y axes, the axes in a Numpy image are as below:", "One of the coolest and most instructive image transformations with ogrid involves adding geometric shapes to your image. Since most basic geometric shapes have simple mathematical formulas, we can perform functions on the x and y returned by ogrid to recreate these formulas. For example, let\u2019s see some code to create a black circle in the middle of our image.", "The key part of this code is on line 9, where you\u2019ll recognize the formula for a circle from your Algebra class. This particular circle is centered at the middle of our image, and has radius 100 pixels. We then use this circle mask to black out any pixels in the image that are included in the mask, resulting in the image below.", "Nice! What if we want to make a square? Well, its arguably even easier.", "We just construct the square (or rectangle) as a composition of four filters on the x and y returned by ogrid. We then set to red any pixel in the image included in the square mask.", "Finally, what if we want a cyan colored triangle in the bottom right corner of our image? Well, we can work out the mathematical formula, and code it as follows.", "Awesome! Looks like we just created some nice artwork.", "Next, let\u2019s see how we might use ogrid to rotate an image by 90 degrees. In fact, we won\u2019t write much code here, but the important thing is that we understand the concept.", "If we take a simple 3x3 image and rotate it 90 degrees counter clockwise, we get the following result.", "Mathematically, this is like taking the pixel that lives at indexes (i,j) and mapping it to a new location (j,-i). Applying that transformation to every pixel in the image might seem daunting and seems like we need to write a few for loops, but using ogrid, the task becomes a one-liner.", "Namely, if our image is called img, then indexing the image as img[y,-x], using the x and y returned by ogrid, we get exactly the rotated image.", "To wrap up, let\u2019s look at a slightly more complex image transformation. Namely, we want to create a halo around the image.", "Specifically, we want to add some positive values to all the pixels of our image, and the further a pixel is from the center, the bigger the value we will add. In total, this will have the effect of \u201cwashing out\u201d pixels near the corners and edges and have little effect on pixels near the center of the image. The fully commented code is below.", "There is a good amount of code here and I encourage you to read it and try it for yourself. In a nutshell we:", "And that\u2019s all! Hopefully, you learned a bit about the very useful ogrid functions in Numpy.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer \u2014 Mathemagician \u2014 Home Chef"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F19ead3bdae40&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ritvikmathematics?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ritvikmathematics?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": "Ritvik Kharkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddca178f703&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&user=Ritvik+Kharkar&userId=ddca178f703&source=post_page-ddca178f703----19ead3bdae40---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19ead3bdae40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19ead3bdae40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mojoblogs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Zara Walker"}, {"url": "https://unsplash.com/s/photos/city-grid?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----19ead3bdae40---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----19ead3bdae40---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----19ead3bdae40---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/software-development?source=post_page-----19ead3bdae40---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----19ead3bdae40---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19ead3bdae40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&user=Ritvik+Kharkar&userId=ddca178f703&source=-----19ead3bdae40---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19ead3bdae40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&user=Ritvik+Kharkar&userId=ddca178f703&source=-----19ead3bdae40---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19ead3bdae40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F19ead3bdae40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----19ead3bdae40---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----19ead3bdae40--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----19ead3bdae40--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----19ead3bdae40--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----19ead3bdae40--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ritvikmathematics?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ritvikmathematics?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ritvik Kharkar"}, {"url": "https://medium.com/@ritvikmathematics/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "703 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddca178f703&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&user=Ritvik+Kharkar&userId=ddca178f703&source=post_page-ddca178f703--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F578561866797&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-little-known-ogrid-function-in-numpy-19ead3bdae40&newsletterV3=ddca178f703&newsletterV3Id=578561866797&user=Ritvik+Kharkar&userId=ddca178f703&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}