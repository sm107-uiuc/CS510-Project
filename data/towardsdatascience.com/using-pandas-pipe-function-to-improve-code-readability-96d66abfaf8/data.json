{"url": "https://towardsdatascience.com/using-pandas-pipe-function-to-improve-code-readability-96d66abfaf8", "time": 1683008897.987156, "path": "towardsdatascience.com/using-pandas-pipe-function-to-improve-code-readability-96d66abfaf8/", "webpage": {"metadata": {"title": "Using Pandas pipe function to improve code readability | by B. Chen | Towards Data Science", "h1": "Using Pandas pipe function to improve code readability", "description": "In Data Processing, it is often necessary to write a function to perform operations (such as statistical calculations, splitting, or substituting value) on a certain row or column to obtain new data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Fluent_interface", "anchor_text": "Fluent Interface", "paragraph_index": 3}, {"url": "https://www.kaggle.com/c/titanic/overview", "anchor_text": "Titanic Dataset from Kaggle", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff", "anchor_text": "apply()", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff", "anchor_text": "map()", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff", "anchor_text": "map()", "paragraph_index": 19}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github", "paragraph_index": 24}], "all_paragraphs": ["In Data Processing, it is often necessary to write a function to perform operations (such as statistical calculations, splitting, or substituting value) on a certain row or column to obtain new data.", "Pandas introduced pipe() starting from version 0.16.2. pipe() enables user-defined methods in method chains.", "Method chaining is a programmatic style of invoking multiple method calls sequentially with each call performing an action on the same object and returning it.", "It eliminates the cognitive burden of naming variables at each intermediate step. Fluent Interface, a method of creating object-oriented API relies on method cascading (aka method chaining). This is akin to piping in Unix systems.", "Method chaining substantially increases the readability of the code. Let\u2019s dive into a tutorial to see how it improves our code readability.", "For this tutorial, we will be working on the Titanic Dataset from Kaggle. This is a very famous dataset and very often is a student\u2019s first step in data science. Let\u2019s import some libraries and load data to get started.", "We created a function load_data() to load train.csv file into pandas DataFrame.", "Let\u2019s start by checking out missing values. We can use seaborn to create a simple heatmap to see where are missing values", "Age, Cabin, and Embarked have missing values. The proportion of Age missing is likely small enough for reasonable replacement with some form of imputation. Looking at the Cabin column, it looks like a lot of missing values. The proportion of Embarked missing is very small.", "Suppose we have been asked to work on the following tasks", "Let\u2019s go ahead and use pipe() to accomplish them step by step,", "Let\u2019s create a function split_name(), which takes in a DataFrame as input and returns a DataFrame.", "x_df['Name'] selects the Name column (Known as a Series in Pandas) and the Pandas apply() is used to apply the split_name_series() function on the values of the Series.", "We should get an output like below:", "Let\u2019s create a function substitute_sex(), which takes in a DataFrame as input and returns a DataFrame.", "x_df['Sex'] select the Sex column and then the Pandas map() used for substituting each value in a Series with another value.", "We should get an output like below:", "We would like to replace the missing Age with some form of imputation. One way to do this is by filling in the mean age of all the passengers. However, we can be smarter about this and check the average age by passenger class. For example:", "We can see the wealthier passengers in the higher classes tend to be older, which makes sense. We\u2019ll use these average age values to impute based on Pclass for Age.", "x_df['Age'].isna() selects the Age column and detects the missing values. Then, x_df.loc[cond, 'Pclass'] is used to access Pclass values conditionally and call Pandas map() for substituting each value with another value. Finally, x_df.loc[cond, 'Age']=res conditionally replace all missing Age values with res.", "All missing ages should be replaced based on Pclass for Age. Let\u2019s check this by running the heatmap on res.", "Let\u2019s create a function create_age_group(), which takes a DataFrame as input and returns a DataFrame.", "pd.cut() is used to convert ages to groups of age ranges.", "We should get an output like below:", "Please checkout the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "Lastly, here are 2 related articles you may be interested in", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F96d66abfaf8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----96d66abfaf8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96d66abfaf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96d66abfaf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@junio_006?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "June Wong"}, {"url": "https://unsplash.com/s/photos/pipe?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Fluent_interface", "anchor_text": "Fluent Interface"}, {"url": "https://towardsdatascience.com/the-unreasonable-effectiveness-of-method-chaining-in-pandas-15c2109", "anchor_text": "By Adiamaan Keerthi"}, {"url": "https://www.kaggle.com/c/titanic/overview", "anchor_text": "Titanic Dataset from Kaggle"}, {"url": "https://www.kaggle.com/c/titanic/data?select=train.csv", "anchor_text": "Kaggle"}, {"url": "https://towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff", "anchor_text": "apply()"}, {"url": "https://towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff", "anchor_text": "map()"}, {"url": "https://towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff", "anchor_text": "map()"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github"}, {"url": "https://towardsdatascience.com/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff", "anchor_text": "Introduction to Pandas apply, applymap and map"}, {"url": "https://towardsdatascience.com/working-with-missing-values-in-pandas-5da45d16e74", "anchor_text": "Working with missing values in Pandas"}, {"url": "https://medium.com/tag/pandas?source=post_page-----96d66abfaf8---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----96d66abfaf8---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/python?source=post_page-----96d66abfaf8---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----96d66abfaf8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pipes?source=post_page-----96d66abfaf8---------------pipes-----------------", "anchor_text": "Pipes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F96d66abfaf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&user=B.+Chen&userId=563d09da62a&source=-----96d66abfaf8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F96d66abfaf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&user=B.+Chen&userId=563d09da62a&source=-----96d66abfaf8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96d66abfaf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F96d66abfaf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----96d66abfaf8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----96d66abfaf8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----96d66abfaf8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----96d66abfaf8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----96d66abfaf8--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-pandas-pipe-function-to-improve-code-readability-96d66abfaf8&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}