{"url": "https://towardsdatascience.com/supercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489", "time": 1683010523.564794, "path": "towardsdatascience.com/supercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489/", "webpage": {"metadata": {"title": "Supercharge Your Shallow ML Models With Hummingbird | by Anthony Agnone | Towards Data Science", "h1": "Supercharge Your Shallow ML Models With Hummingbird", "description": "Since the most recent resurgence of deep learning in 2012, a lion\u2019s share of new ML libraries and frameworks have been created. The ones that have stood the test of time (PyTorch, Tensorflow, ONNX\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.dictionary.com/e/slang/42/", "anchor_text": "the answer to everything in the universe.", "paragraph_index": 10}, {"url": "https://beta.deepnote.com/article/supercharge-your-shallow-ml-models-with-hummingbird", "anchor_text": "original version", "paragraph_index": 13}, {"url": "https://github.com/microsoft/hummingbird", "anchor_text": "Github repo", "paragraph_index": 17}, {"url": "https://beta.deepnote.com/article/supercharge-your-shallow-ml-models-with-hummingbird", "anchor_text": "NVIDIA T4 Tensor Core", "paragraph_index": 19}, {"url": "http://LifeWithData.org", "anchor_text": "LifeWithData.org", "paragraph_index": 29}], "all_paragraphs": ["Since the most recent resurgence of deep learning in 2012, a lion\u2019s share of new ML libraries and frameworks have been created. The ones that have stood the test of time (PyTorch, Tensorflow, ONNX, etc) are backed by massive corporations, and likely aren\u2019t going away anytime soon.", "This also presents a problem, however, as the deep learning community has diverged from popular traditional ML software libraries like scikit-learn, XGBoost, and LightGBM. When it comes time for companies to bring multiple models with different software and hardware assumptions into production, things get\u2026hairy.", "I know, I know. Using microservices in Kubernetes can solve the design pattern issue to an extent by keeping things de-coupled\u2026if that\u2019s even what you want?", "But, I think that really just ignores the problem. What if you want to seamlessly deploy either an XGBoost regressor or fully-connected DNN as your service\u2019s main output? Sure, you could hot-swap the hardware your service launches onto. How about the code?", "Are you going to ram in a dressed-up version of an if-else switch to use one software framework vs the other, depending on the model type?", "Well, for a lot of use cases, it is. However, there\u2019s still a huge gap between problems requiring neural nets and problems that can be sufficiently solved with more traditional models. For the more traditional models, don\u2019t you still want to be able to use the latest and greatest computational frameworks to power your model\u2019s predictions? This would allow you to scale your model up more before you need to resort to scaling it out via redundant instances.", "Microsoft research has introduced hummingbird to bridge this gap between CPU-oriented models and tensor-oriented models. The library simply takes any of our already-trained traditional models and returns a version of that model built on tensor computations. Hummingbird aims to solve two core concerns with current ML applications:", "With Hummingbird, your ML pipelines will start to look cleaner. You\u2019ll know that, regardless of the algorithm, you end up with a model that creates its predictions via tensor computations. Not only that, these tensor computations will be run by the same deep learning framework of choice that your organization has likely already given allegiance to.", "All of this from one function call. Not a bad deal in my book!", "Let\u2019s get this part out of the way. You know the drill.", "Let\u2019s control randomness in Numpy and PyTorch with the answer to everything in the universe.", "Let\u2019s define a quick helper to quickly make some classification data, and create some data sets with it.", "Thanks to Deepnote, I don\u2019t have to take up half of this notebook just printing out data shapes and distributions for you. These notebooks come with a feature-packed variable explorer which provides most of the basic EDA-style questions you will have about your data.", "Check out the original version of this article to see how Deepnote automatically creates beautiful articles from their Jupyter-style notebooks.", "Now, the one-liner to get your model transformed into tensor computations via Hummingbird is convert(clf, 'pytorch').", "Just to make our comparisons even easier, let\u2019s make a quick method on top of that to automatically move it to a GPU when it\u2019s available. As some final added sugar, we\u2019ll take in a flag that forces keeping the model on CPU, should the need arise. Keep in mind though, the single call to convert() is the only interface you need to have with Hummingbird; it does all of its magic under the hood of that single function call. Once you get the model returned to you, you call predict() on it like any other traditional pythonic ML model.", "Alright, it\u2019s time to benchmark! Don\u2019t worry about a flurry of imports or method wrappers. Let\u2019s keep it simple here with the %%timeit magic command. This magic command will automatically run the code in the cell multiple times, reporting out the mean and standard deviation of the runtime samples. First, we'll time the sklearn model as-is. Then, we'll see how the Hummingbird on-CPU and on-GPU models compare.", "Well\u2026that was unexpected. There are no two ways about this one: Hummingbird might run slower on CPU for certain data sets. This can even be seen by some of their current example notebooks in the Hummingbird Github repo. Also, I did mention that the runtime is slower on certain data sets with intention, as it does outperform for others.", "That being said, this side effect shouldn\u2019t have anyone running for the door \u2014 remember the library\u2019s goal! The main reason for converting a model to tensor computations is to leverage hardware that excels in that area.", "Spoiler alert: I\u2019m talking about GPUs! This Deepnote notebook comes powered by an NVIDIA T4 Tensor Core GPU. Let\u2019s see how the model runs on that.", "There we go! Now, we not only have a 73% mean speedup over the original, but also an order of magnitude tighter variance. The original standard deviation of runtime is 1.1% of its mean, and the GPU runtime\u2019s standard deviation is 0.18%!", "Hold in your excitement for now, though. Your model could have the fastest runtime in the world; if it doesn\u2019t maintain its accuracy through the conversion, it could be utterly useless. Let\u2019s see how the predictions compare between the original model and both transformed models. For this, we turn to one of my favorite visualization libraries, seaborn.", "Not bad at all. The distribution of the deltas for the CPU-based model is rather symmetric around zero with a 3\u03c3 (note the axis scale) around 1e-7. The distribution of the deltas for the GPU-based model has a similarly small deviation, but show a non-zero bias and a skew! This is certainly interesting behavior that piques the curious mind, but it remains a small detail for all but the most precision-sensitive models.", "The jury is in: Hummingbird delivers precision alongside the speedup \ud83d\udc4d.", "Check out the comparisons below from some of Microsoft\u2019s larger-scale comparisons. \ud83d\ude80", "Oh, and by the way, you also automatically plug into all of the future computational optimizations that come from the thousands of people employed to work on these mega-frameworks. As support for the less popular frameworks dies off (trust me, it eventually happens), you will sit comfortably, knowing that every one of your models run on well-supported, tensor-based inference frameworks.", "After all, we\u2019re in the business of data science, not runtime optimization. It feels good to leverage the big guys to get the job done in that area, freeing us up to focus on our core competencies.", "As with a lot of other recent moves by Microsoft Research, I\u2019m excited about Hummingbird. This is a great step towards consolidation in the rapidly diverging ML space, and some order from chaos is always a good thing. I\u2019m sure the runtime hiccups of their CPU-based inferencing will be smoothed out over time while ensuring continued advantages on the GPU. As their updates get made, we\u2019re just a few clicks away from a GPU-enabled Deepnote notebook ready to test their claims!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Living the LifeWithData.org | Top writer in AI"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcdad2069e489&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cdad2069e489--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cdad2069e489--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://anthonyagnone.medium.com/?source=post_page-----cdad2069e489--------------------------------", "anchor_text": ""}, {"url": "https://anthonyagnone.medium.com/?source=post_page-----cdad2069e489--------------------------------", "anchor_text": "Anthony Agnone"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9e20d56791&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&user=Anthony+Agnone&userId=9b9e20d56791&source=post_page-9b9e20d56791----cdad2069e489---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcdad2069e489&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcdad2069e489&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@levidjones?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Levi Jones"}, {"url": "https://unsplash.com/s/photos/hummingbird?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Don%27t_repeat_yourself", "anchor_text": "DRY"}, {"url": "https://www.dictionary.com/e/slang/42/", "anchor_text": "the answer to everything in the universe."}, {"url": "https://beta.deepnote.com/article/supercharge-your-shallow-ml-models-with-hummingbird", "anchor_text": "original version"}, {"url": "https://giphy.com/gifs/turtle-slide-climbing-w87yLYL7lwDWE", "anchor_text": "Giphy"}, {"url": "https://github.com/microsoft/hummingbird", "anchor_text": "Github repo"}, {"url": "https://beta.deepnote.com/article/supercharge-your-shallow-ml-models-with-hummingbird", "anchor_text": "NVIDIA T4 Tensor Core"}, {"url": "https://media.giphy.com/media/B1uajA01vvL91Urtsp/giphy.gif", "anchor_text": "Giphy"}, {"url": "https://azuredata.microsoft.com/articles/ebd95ec0-1eae-44a3-90f5-c11f5c916d15", "anchor_text": "Microsoft Research"}, {"url": "https://github.com/microsoft/hummingbird", "anchor_text": "[Code] Hummingbird Github Repo"}, {"url": "https://azuredata.microsoft.com/articles/ebd95ec0-1eae-44a3-90f5-c11f5c916d15", "anchor_text": "[Blog] Hummingbird Microsoft Blog Post"}, {"url": "http://learningsys.org/neurips19/assets/papers/27_CameraReadySubmission_Hummingbird%20(5).pdf", "anchor_text": "[Paper] Compiling Classical ML Pipelines into Tensor Computations for One-size-fits-all Prediction Serving"}, {"url": "https://scnakandala.github.io/papers/TR_2020_Hummingbird.pdf", "anchor_text": "[Paper] Taming Model Serving Complexity, Performance, and Cost: A Compilation to Tensor Computations Approach"}, {"url": "https://deepnote.com/about/", "anchor_text": "The Story of Deepnote"}, {"url": "https://docs.deepnote.com/", "anchor_text": "Deepnote Documentation"}, {"url": "https://docs.deepnote.com/features/package-management", "anchor_text": "Integrated Package Management"}, {"url": "https://docs.deepnote.com/environment/selecting-hardware", "anchor_text": "Choosing the Hardware"}, {"url": "https://lifewithdata.org/cord-19/", "anchor_text": "CORD-19: The Data Science Response to COVID-19"}, {"url": "https://lifewithdata.org/deepmind-acme-reverb/", "anchor_text": "Deepmind Surges On, Releasing ACME and Reverb RL"}, {"url": "https://lifewithdata.org/torch-serve/", "anchor_text": "PyTorch Levels Up Its Serving Game With TorchServe"}, {"url": "https://beta.deepnote.com/article/supercharge-your-shallow-ml-models-with-hummingbird", "anchor_text": "https://beta.deepnote.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cdad2069e489---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cdad2069e489---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----cdad2069e489---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----cdad2069e489---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/software-development?source=post_page-----cdad2069e489---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcdad2069e489&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&user=Anthony+Agnone&userId=9b9e20d56791&source=-----cdad2069e489---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcdad2069e489&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&user=Anthony+Agnone&userId=9b9e20d56791&source=-----cdad2069e489---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcdad2069e489&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cdad2069e489--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcdad2069e489&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cdad2069e489---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cdad2069e489--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cdad2069e489--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cdad2069e489--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cdad2069e489--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cdad2069e489--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cdad2069e489--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cdad2069e489--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cdad2069e489--------------------------------", "anchor_text": ""}, {"url": "https://anthonyagnone.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anthonyagnone.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anthony Agnone"}, {"url": "https://anthonyagnone.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "http://LifeWithData.org", "anchor_text": "LifeWithData.org"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9e20d56791&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&user=Anthony+Agnone&userId=9b9e20d56791&source=post_page-9b9e20d56791--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F51d3f002c6de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharge-your-shallow-ml-models-with-hummingbird-cdad2069e489&newsletterV3=9b9e20d56791&newsletterV3Id=51d3f002c6de&user=Anthony+Agnone&userId=9b9e20d56791&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}