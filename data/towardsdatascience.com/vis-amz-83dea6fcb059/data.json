{"url": "https://towardsdatascience.com/vis-amz-83dea6fcb059", "time": 1683000452.462802, "path": "towardsdatascience.com/vis-amz-83dea6fcb059/", "webpage": {"metadata": {"title": "Visualizing 100,000 Amazon Products | by Dr. Oliver Borchers | Towards Data Science", "h1": "Visualizing 100,000 Amazon Products", "description": "The fse code in this article may be deprecated. Please make sure to use the updated code as outlined on Github. Throughout my PhD studies I regularly work with sentence embeddings. More specifically\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/oborchers/Fast_Sentence_Embeddings", "anchor_text": "Github", "paragraph_index": 0}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings", "anchor_text": "Github", "paragraph_index": 1}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings/blob/master/notebooks/Tutorial.ipynb", "anchor_text": "notebook", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/fse-2b1ffa791cf9", "anchor_text": "Medium", "paragraph_index": 5}, {"url": "http://jmcauley.ucsd.edu/data/amazon/", "anchor_text": "dataset", "paragraph_index": 6}, {"url": "https://fasttext.cc/docs/en/english-vectors.html", "anchor_text": "FastText", "paragraph_index": 10}, {"url": "http://ixa2.si.ehu.es/stswiki/index.php/STS_benchmark_reproducibility", "anchor_text": "reproducibility", "paragraph_index": 12}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings/blob/master/notebooks/Tutorial.ipynb", "anchor_text": "notebook", "paragraph_index": 21}, {"url": "https://github.com/KlugerLab/FIt-SNE", "anchor_text": "FIt-SNE", "paragraph_index": 24}, {"url": "https://public.tableau.com/views/ProductMap_15674406439260/TSNEPrice?:embed=y&:display_count=yes&:origin=viz_share_link", "anchor_text": "tableau", "paragraph_index": 26}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings", "anchor_text": "Github", "paragraph_index": 36}], "all_paragraphs": ["The fse code in this article may be deprecated. Please make sure to use the updated code as outlined on Github.", "Throughout my PhD studies I regularly work with sentence embeddings. More specifically, I work with average [1] and smooth inverse frequency (SIF)[2] embeddings. While the original implementations on Github are quite useful, I always found them to be tricky to integrate into any NLP pipeline I use. This was due to the non-standardized interface and the lack of optimizations. Thus, I decided to implement Average, SIF, and uSIF [3] embeddings in an optimized package which neatly integrates into Gensim. Partly because I liked the challenge, partly because I needed good tools. This package is called fse and is available on Github and Pypi. Have a look at the tutorial notebook to see how it works.", "You will need regular Python (>3.6) packages, specifically Numpy, Scipy, Cython, and Gensim.TL;DR: If you need sentence embeddings fast, just use:", "This post is intended for a technical data-science audience. We are going to explore how you can use fast sentence embeddings to visualize the well-known Amazon review dataset. The tools of trade used in this story are fse, FIt-SNE, and Tableau.", "The outcome of this pipeline is shown in the first picture of this post. You will find a link to the interactive Tableau mapping to browse through all 100,000 products at the end of this post.", "For a more detailed introduction on the inner workings of the library, feel free to read my first Medium post on sentence embeddings.", "If you work with NLP, chances are you\u2019ve heard from the public Stanford Amazon review dataset. I\u2019ve received the full version from Julian McAuley three years ago for my PhD research in marketing and do continue to work with it now and then. The second largest category is the \u201cElectronics\u201d category with 7,824,482 reviews in total. Wouldn\u2019t it be nice to know what\u2019s actually in there?", "To obtain embeddings for each product, we need the review data and the meta data. Both are connected by the unique Amazon ASIN identifier. I already prepared everything as a nice pandas DataFrame (which I am not allowed to share). Let\u2019s have a look at the metadata:", "To actually visualize the data (i.e. represent each product as a mappable vector), we can only use the reviews for each product. Thus, we are coping with a many-to-one embedding. After filtering out ASINs with less than 10 reviews, we end up with 97,249 unique ASINs and 6,875,530 reviews.", "We don\u2019t perform any kind of preprocessing for the textual data. Why? Because.", "To obtain an embedding for each review, we first need some kind of pretrained embedding. It is likely that reviews may contain many unknown words. Luckily, fse offers support for FastText models out of the box. We first load the publicly available FastText model:", "Next, we instantiate the SIF model from fse.", "The number of components is equal to 10, which was reported in the STS benchmark reproducibility section.", "Notice the lang_freq argument. Some pre-trained embeddings do not contain information about the word frequency in a corpus. fse supports the induction of word frequencies for pre-trained models for multiple languages, which are essential for the SIF and uSIF models (this might take a while depending on the size of your vocabulary).", "All fse models require the input to be a list of tuples. The first entry of the tuple is a list of tokens (the sentence) and the second represents the index of the sentence. The latter determines the target row in the embedding matrix where the sentence is added to. We will later write multiple sentences (reviews) on a single row (many-to-one).", "fse provides multiple input classes, which all provide a different functionality. There are 6 input classes to choose from:", "These are ordered by speed. Meaning, that IndexedList is the fastest, while CSplitCIndexedList is the slowest variant (more calls = slower). Why multiple classes? Because I wanted to have each __getitem__ method to have as few lines of code as possible not to slow down the computation.", "For our review data we are using the SplitCIndexedList, as we do not want to pre-split the data (pre-splitting 7 mio. reviews takes up a huge amount of ram). Internally, the class will point to our reviews and only perform the pre-processing when you call __getitem__.", "Notice, that both sentences point to index 0. Therefore, they will both be added to the embedding with index 0. To map each ASIN to an index, we only need some further convenience functions.", "Now that we have everything ready, we can just call", "The model was trained on a cloud instance with 16 cores and 32 GB ram. The whole process takes around 15 minutes, with about 8500 reviews / second. Each review contains 86 words on average and in total we encounter 593,774,622 words. We compressed about 7 million reviews into a matrix with a shape of 100,000 * 300. Adding further workers makes no difference, because the preprocessing (splitting) is the bottleneck.", "If your data is already pre-splitted, you may reach up to 500,000 sentences / second on a regular MacBook Pro. Take a look at the tutorial notebook if you want to learn more.", "After training the sentence embedding we can access each individual embedding by its index or the complete embedding matrix. The syntax is as close to Gensims syntax as possible for easy usage.", "The corresponding Sentencevectors (sv) class provides quite a few functions to work with the resulting sentence embeddings. For example, you can use similarity, distance, most_similar, similar_by_word, similar_by_sentence, or similar_by_vector.", "Visualizing this much data may take extremely long if we revert to the standard sklearn t-SNE implementation. Thus, let us try a more optimized approach: FIt-SNE. This optimized t-SNE implementation makes use of Fourier Transformations to speed up the computation of t-SNE. Feel free to read the paper [4]. It works like a charm and uses all 16 cores of the machine.", "Having computed the mapping, we are effectively done with the most difficult part. Adding some information from the meta data to each point, we can finally export everything to Tableau.", "To access the corresponding graphics, visit my public tableau page:", "You can hover over each point and obtain information about product price, name, brand, and so on.", "Looking at the embedding, we observe that there is quite a lot of information contained in each cluster.", "Additionally, I went into the data and labeled some of the clusters manually to determine if the cluster formations are at least somewhat valid. It seems as if the mapping captures quite a lot of the information contained in the reviews.", "Remember: all we did was averaging all words for each review and summing all reviews. I am pretty stunned by what is possible using a simple average-based embedding.", "Sentence embeddings are an essential part of NLP pipelines. This blog post shows how to use fast sentence embeddings, FIt-SNE, and Tableau to visualize the well known Amazon review dataset.", "I hope you do find pleasure in using fse. Please feel free to suggest further models or features which might be useful.", "The corresponding fse package is available on pip / Github and offers a fast way of computing sentence embeddings for data scientists.", "For inquiries and questions, feel free to contact me.", "And don\u2019t forget to follow me if you like this content :-)", "The code for this post is available on Github and via pip:", "Opinions expressed are solely my own and do not express the views or opinions of my employer. The author assumes no responsibility or liability for any errors or omissions in the content of this site. The information contained in this site is provided on an \u201cas is\u201d basis with no guarantees of completeness, accuracy, usefulness or timeliness.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "From data to business value: Lead Machine Learning Engineer @ Oxolo | Data Scientist| Programmer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F83dea6fcb059&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@oliverbor?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oliverbor?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": "Dr. Oliver Borchers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc2fcfdd820b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&user=Dr.+Oliver+Borchers&userId=c2fcfdd820b0&source=post_page-c2fcfdd820b0----83dea6fcb059---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83dea6fcb059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83dea6fcb059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings", "anchor_text": "Github"}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings", "anchor_text": "Github"}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings/blob/master/notebooks/Tutorial.ipynb", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/fse-2b1ffa791cf9", "anchor_text": "Medium"}, {"url": "http://jmcauley.ucsd.edu/data/amazon/", "anchor_text": "dataset"}, {"url": "https://fasttext.cc/docs/en/english-vectors.html", "anchor_text": "FastText"}, {"url": "http://ixa2.si.ehu.es/stswiki/index.php/STS_benchmark_reproducibility", "anchor_text": "reproducibility"}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings/blob/master/notebooks/Tutorial.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/KlugerLab/FIt-SNE", "anchor_text": "FIt-SNE"}, {"url": "https://public.tableau.com/views/ProductMap_15674406439260/TSNEPrice?:embed=y&:display_count=yes&:origin=viz_share_link", "anchor_text": "tableau"}, {"url": "https://public.tableau.com/views/ProductMap_15674406439260/TSNEPrice?:embed=y&:display_count=yes&:origin=viz_share_link", "anchor_text": "https://public.tableau.com/views/ProductMap_15674406439260/TSNEPrice?:embed=y&:display_count=yes&:origin=viz_share_link"}, {"url": "https://github.com/oborchers/Fast_Sentence_Embeddings", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----83dea6fcb059---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----83dea6fcb059---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/nlp?source=post_page-----83dea6fcb059---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/word-embeddings?source=post_page-----83dea6fcb059---------------word_embeddings-----------------", "anchor_text": "Word Embeddings"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----83dea6fcb059---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83dea6fcb059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&user=Dr.+Oliver+Borchers&userId=c2fcfdd820b0&source=-----83dea6fcb059---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83dea6fcb059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&user=Dr.+Oliver+Borchers&userId=c2fcfdd820b0&source=-----83dea6fcb059---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83dea6fcb059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F83dea6fcb059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----83dea6fcb059---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----83dea6fcb059--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----83dea6fcb059--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----83dea6fcb059--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----83dea6fcb059--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oliverbor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oliverbor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dr. Oliver Borchers"}, {"url": "https://medium.com/@oliverbor/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "284 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc2fcfdd820b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&user=Dr.+Oliver+Borchers&userId=c2fcfdd820b0&source=post_page-c2fcfdd820b0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbb76721149ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvis-amz-83dea6fcb059&newsletterV3=c2fcfdd820b0&newsletterV3Id=bb76721149ab&user=Dr.+Oliver+Borchers&userId=c2fcfdd820b0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}