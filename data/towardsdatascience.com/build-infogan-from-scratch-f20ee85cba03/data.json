{"url": "https://towardsdatascience.com/build-infogan-from-scratch-f20ee85cba03", "time": 1683012643.664831, "path": "towardsdatascience.com/build-infogan-from-scratch-f20ee85cba03/", "webpage": {"metadata": {"title": "Build InfoGAN From Scratch. Understand InfoGAN and build your own\u2026 | by Kuan Wei | Towards Data Science", "h1": "Build InfoGAN From Scratch", "description": "From the above image, can you tell which hand-written digits are synthesized by the machine and which are made by humans? The answer is: all of them are synthesized by the machine! In fact, this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1606.03657", "anchor_text": "InfoGAN (Information Maximizing Generative Adversarial Network)", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Mutual_information", "anchor_text": "mutual information", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1606.03657", "anchor_text": "original paper", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/infogan-generative-adversarial-networks-part-iii-380c0c6712cd", "anchor_text": "Zak Jost", "paragraph_index": 4}, {"url": "https://medium.com/@jonathan_hui/gan-cgan-infogan-using-labels-to-improve-gan-8ba4de5f9c3d", "anchor_text": "Jonathan Hui", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/understand-transposed-convolutions-and-build-your-own-transposed-convolution-layer-from-scratch-4f5d97b2967", "anchor_text": "article explaining it", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1606.03657", "anchor_text": "InfoGAN: Interpretable Representation Learning by Information Maximizing Generative Adversarial Nets", "paragraph_index": 22}], "all_paragraphs": ["From the above image, can you tell which hand-written digits are synthesized by the machine and which are made by humans? The answer is: all of them are synthesized by the machine! In fact, this image comes from a scientific paper \u201cInfoGAN: Interpretable Representation Learning by Information Maximizing Generative Adversarial Nets\u201d, where the authors developed a special Generative Adversarial Network named InfoGAN (Information Maximizing Generative Adversarial Network) and used it to synthesize MNIST hand-written digits. As you may know, GANs are widely used for synthesizing new data, especially images. However, one drawback of normal GANs is that we have no control over the images GANs produce. For instance, a GAN that is trained to produce fake hand-written digit images may be able to generate very real hand-written digit images, but we have no control over which number it generates. InfoGAN solved this problem: the network can learn to produce images with specific categorical features (such as digits 0 to 9) and continuous features (such as the rotational angle of the digits), in an unsupervised manner. In addition, because the learning is unsupervised, it is able to find the patterns hidden among the images, and generate images that follow these hidden patterns. Sometimes the model can learn very interesting patterns that are beyond your imagination (for example, one of my models learns to transit from number 2 to number 8. You will see it later!). In this notebook, I will introduce how InfoGAN achieves the control of the images being produced, and how to build an InfoGAN from scratch to synthesize feature-specific MNIST hand-written digits, just like the image above.", "A normal GAN has two fundamental elements: a generator that accepts random noises and produces fake images, and a discriminator that accepts both fake and real images and identifies if the image is real or fake. During the training, the generator gets \u201cpenalized\u201d if the discriminator successfully detects the image it produces is fake. Therefore, the generator will learn to produce fake images that are more and more similar to the real ones to \u201cfool\u201d the discriminator.", "In InfoGAN, to control the types of images produced, we need to feed additional information on the top of random noises to the generator and force it to use the information when making the fake images. The additional information we feed should relate to the types of features we want the images to have. For example, if we want to produce specific MNIST digits, we need to feed a categorical vector containing integers from 0 to 9; if we want to produce MNIST digits with different rotational angles, we may want to feed float numbers randomly selected between -1 to 1.", "Feeding additional information is easy, as we just need to add extra inputs to the generator model. But how can we ensure that the generator will use the information instead of completely ignoring it? If we still train the generator simply based on the response of the discriminator, the generator won\u2019t use the additional information as the additional information will not help the generator to create more realistic images (it is only helpful to generate specific features of the images). Thus, we need to apply extra \u201cpenalties\u201d on the generator if it does not use the additional information. One way is to add an additional network (often named auxiliary network and denoted as Q) that takes fake images and reproduces the additional information we fed into the generator. In this way, the generator is forced to use the additional information as if it doesn\u2019t, there is no way that the auxiliary network can correctly reproduce the additional information, and the generator will be \u201cpenalized\u201d. The picture below summaries the structures of GAN (left) and InfoGAN(right).", "Note: in the paper, theoretically, the generator should be trained through maximizing mutual information. However, mutual information is practically unable to calculate. Therefore the authors approximated mutual information, and the approximation becomes the cross-entropy (i.e. difference) between the inputs of the additional information and the reproduced information. If you are interested in mutual information and how it is approximated, you can check the original paper, or two very good medium articles by Zak Jost and Jonathan Hui.", "After understanding the structure of InfoGAN, let\u2019s get our hands dirty and build an InfoGAN to produce feature-specific MNIST digits! As seen from the above image, InfoGAN contains three models: generator (G), discriminator (D), and auxiliary model (Q). The input of the generator includes three parts: a noise vector of size 62, a categorical vector of size 10 (representing 10 digits), and a continuous vector of size 1. The noise vector is generated through normal distribution, the categorical vector is generator through picking an integer from 0 to 9, and the continuous vector is generated by picking a float value from -1 to 1.", "The generator in InfoGAN has exactly the same structure as the generator in normal GAN. It firstly contains two fully-connected layers to expand the input shape to 6272 units. Then the 6272 units are reshaped into 128 7x7 layers. Afterward, the reshaped layers are processed through three transposed-convolutional layers to form the final 28x28 pixels image (if you are unfamiliar with the transposed-convolutional layer, I have an article explaining it).", "The discriminator is also the same as the ones in normal GANs. It contains two convolutional layers and two fully-connected layers. The last fully-connected layer generates an output with a \u201csigmoid\u201d activation function to represent real images (1) or fake images (0).", "The auxiliary model shares all layers from the discriminator except for the last fully-connected layer, and thus these two models are defined together. The auxiliary model has two additional fully-connected layers to identify additional information. Since we have two additional inputs for our generator (a categorical vector and a continuous vector), we also need to have two different outputs from the auxiliary model. Thus, I set one fully-connected layer with a \u201csoftmax\u201d activation function to identify the categorical output, two fully-connected layers to represent \u201cmu\u201d (mean) and \u201csigma\u201d(standard deviation) of a Gaussian distribution:", "Note: as our continuous vector is a float number randomly selected from a uniform distribution between -1 and 1, there can be infinitely many float numbers to choose. Therefore, it is not practical to ask the auxiliary model to predict the exact number that the generator takes. Instead, we can predict a Gaussian distribution, and ask the model to maximize the likelihood of having the continuous vector inside the distribution.", "After defining the three models, we can construct our InfoGAN network! I used Keras for network construction:", "I know it is quite a long code, so let\u2019s digest it step by step:", "Now, you simply need to train it with a few lines of code!!!", "Now, let\u2019s see some very interesting results I got from the InfoGAN model!", "First, if you change the categorical vector input, you can generate different numbers. However, the model won\u2019t know that label 0 corresponds to number 0! It only knows that different labels correspond to different numbers (believe me, I somehow used an entire day to realize this. I always thought that I failed when feeding label 0 generates number 9 for me).", "So you may want to rearrange the labels:", "Varying continuous vector can generate same number with different shapes. For example, for number 1, the number rotates in a clockwise direction when increasing the continuous vector value. Note that even though we trained the model using values from -1 to 1, by feeding -1.5 and 1.5 we can still get meaningful results!", "Note that the labels are not the same as the ones above. This is because I trained the model again and the model always correlates labels to numbers randomly.", "Number 5 is more interesting. It seems that the model is trying to rotate the number, but because of its more complex shape, the number is sheared.", "You may notice that I set a ratio of 0.1 to continuous loss, both when adding it to the total generator loss and to the total auxiliary loss. This is to avoid confusing the model. If the continuous loss has a similar ratio as the categorical loss (i.e. close to 1), then the model will think it as another factor to determine the type of the numbers. For example, the images below are generated when I use a ratio of 0.5:", "As you can see, even though I use the same label, by varying the continuous vector value, the number gradually changed from 2 to 4, or 2 to 8! This also means that the computer can actually find similarities between number 2 to number 4, and number 2 to number 8, and knows how to convert from one to another. Isn\u2019t it amazing?", "InfoGAN is a very powerful GAN that can learn patterns among images in an unsupervised manner and produce images by following the patterns. It is also very fun to play with, as you can generate lots of variations of images by manipulating the input variables. With the codes present in this story, you can build your own InfoGAN and see what amazing images you can produce!", "Xi Chen, Yan Duan, Rein Houthooft, John Schulman, Ilya Sutskever, and Pieter Abbeel, InfoGAN: Interpretable Representation Learning by Information Maximizing Generative Adversarial Nets (2016), Cornell University", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff20ee85cba03&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kuan-wei0413.medium.com/?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": ""}, {"url": "https://kuan-wei0413.medium.com/?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": "Kuan Wei"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe9be0735c457&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&user=Kuan+Wei&userId=e9be0735c457&source=post_page-e9be0735c457----f20ee85cba03---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20ee85cba03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20ee85cba03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1606.03657", "anchor_text": "InfoGAN (Information Maximizing Generative Adversarial Network)"}, {"url": "https://en.wikipedia.org/wiki/Mutual_information", "anchor_text": "mutual information"}, {"url": "https://arxiv.org/abs/1606.03657", "anchor_text": "original paper"}, {"url": "https://towardsdatascience.com/infogan-generative-adversarial-networks-part-iii-380c0c6712cd", "anchor_text": "Zak Jost"}, {"url": "https://medium.com/@jonathan_hui/gan-cgan-infogan-using-labels-to-improve-gan-8ba4de5f9c3d", "anchor_text": "Jonathan Hui"}, {"url": "https://towardsdatascience.com/understand-transposed-convolutions-and-build-your-own-transposed-convolution-layer-from-scratch-4f5d97b2967", "anchor_text": "article explaining it"}, {"url": "https://engineering.taboola.com/predicting-probability-distributions/", "anchor_text": "Minimizing the negative log probability density function is the same as maximizing the probability of our continuous vectors lying inside the predicted Gaussian distribution"}, {"url": "https://arxiv.org/abs/1606.03657", "anchor_text": "InfoGAN: Interpretable Representation Learning by Information Maximizing Generative Adversarial Nets"}, {"url": "https://engineering.taboola.com/predicting-probability-distributions/", "anchor_text": "Predicting Probability Distributions Using Neural Networks - Taboola Tech BlogShaked is an Algorithm Engineer at Taboola, working on Machine Learning applications for Recommendation Systems. He\u2026engineering.taboola.com"}, {"url": "https://machinelearningmastery.com/how-to-develop-an-information-maximizing-generative-adversarial-network-infogan-in-keras/", "anchor_text": "How to Develop an Information Maximizing GAN (InfoGAN) in Keras - Machine Learning MasteryThe Generative Adversarial Network, or GAN, is an architecture for training deep convolutional models for generating\u2026machinelearningmastery.com"}, {"url": "https://medium.com/tag/python?source=post_page-----f20ee85cba03---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----f20ee85cba03---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f20ee85cba03---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/generative-adversarial?source=post_page-----f20ee85cba03---------------generative_adversarial-----------------", "anchor_text": "Generative Adversarial"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----f20ee85cba03---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff20ee85cba03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&user=Kuan+Wei&userId=e9be0735c457&source=-----f20ee85cba03---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff20ee85cba03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&user=Kuan+Wei&userId=e9be0735c457&source=-----f20ee85cba03---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20ee85cba03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff20ee85cba03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f20ee85cba03---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f20ee85cba03--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f20ee85cba03--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f20ee85cba03--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f20ee85cba03--------------------------------", "anchor_text": ""}, {"url": "https://kuan-wei0413.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kuan-wei0413.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kuan Wei"}, {"url": "https://kuan-wei0413.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "72 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe9be0735c457&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&user=Kuan+Wei&userId=e9be0735c457&source=post_page-e9be0735c457--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F404d6499249c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-infogan-from-scratch-f20ee85cba03&newsletterV3=e9be0735c457&newsletterV3Id=404d6499249c&user=Kuan+Wei&userId=e9be0735c457&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}