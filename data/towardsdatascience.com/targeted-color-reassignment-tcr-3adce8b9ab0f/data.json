{"url": "https://towardsdatascience.com/targeted-color-reassignment-tcr-3adce8b9ab0f", "time": 1683002833.887554, "path": "towardsdatascience.com/targeted-color-reassignment-tcr-3adce8b9ab0f/", "webpage": {"metadata": {"title": "Targeted Color Reassignment (TCR) | by Shashidhar Pai | Towards Data Science", "h1": "Targeted Color Reassignment (TCR)", "description": "What started out as an article to explain K-Means and understanding how the \u2018Elbow Graph\u2019 is used to select the number of clusters in K-Means, transformed into a good example for how Kmeans, a fairly\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.opencv.org/3.0-beta/doc/py_tutorials/py_ml/py_kmeans/py_kmeans_opencv/py_kmeans_opencv.html", "anchor_text": "Kmeans", "paragraph_index": 7}], "all_paragraphs": ["What started out as an article to explain K-Means and understanding how the \u2018Elbow Graph\u2019 is used to select the number of clusters in K-Means, transformed into a good example for how Kmeans, a fairly simple concept in Data Science, can be used within the domain of Image Processing to solve the relatively complex problem of Targeted Color Reassignment(TCR) for an object in an image.", "I will be using the below terminologies extensively to explain the process of TCR.", "Single Object Image(SOI): Where the image contains only one object.", "Multi-Object Image(MOI): Where the image contains multiple objects.", "A sample of what we are trying to achieve is shown below(Fig b). We will be taking an input image of both SOI and MOI categories and attempt to change the color of an object present in the image. For example, let's look into Fig b where we change the color of a Ralph Lauren, Roll Neck Jumper from it\u2019s original brown color to any color of our choice, in this case, blue.", "There are two main objectives of this project, first color reassignment of an object in a Single Object Image(SOI) and second is to achieve the same color reassignment in a target object in a Multi-Object Image(MOI) without altering the other objects. Going back to the sweater example, we aim to change the color of the sweater, when only the sweater is present in the image(SOI) and also when it is being adorned by a person(MOI).", "We first start with loading the images, we load the following three images, a Single Object Image of a blue shirt and two Multi-Object Image where the blue shirt is being worn by a person.", "In this part of the project, we will be working solely on SOIs Fig c(leftmost). We shall first convert the input image from RGB space to HSV space, making it easier for us to work on the colors in the image. I will soon release a blog on why working on the HSV space it easier for us to work with colors, so stay tuned. We now need to look at the colors present within the input image, to give us an idea of the color of the object and the color of the background in the SOI that is we need to look at the color palette of the image. To derive the color palette, we cluster all the pixels in the image using the Kmeans algorithm present within the OpenCV package. This groups together all the pixels in the images with similar colors into K clusters thus identifying the K most prominent colors in the image.", "For the input image we have taken, we can set K to two and we will group all the pixels in the image into two clusters that represent the two most prominent colors, in our case, it would be the color of the background(white) and color of the object(a shade of blue) as seen below(Fig d).", "Once we have clustered the image and get the cluster details as seen above, we can see that Cluster A with centroid [104, 227, 122]maps to the target object pixels, a shade of blue and Cluster B with centroid [0, 0, 250] maps to the background pixels, a shade of white. We now build a TCR Filter that will help us apply functions or operations on selective pixels within the image. The output of the K-Means algorithm extrapolated over the pixels of the input image generates the TCR Filter(Fig e right). The TRC Filter now enables us to independently alter all the pixels in a cluster.", "Reassignment, given that we have successfully segmented the object (Cluster A) in the image we can now reassign these pixels to any color of our choice using the TCR filter. The TCR filter enables us to alter the pixels of cluster A, keeping the pixels of cluster B unchanged, we can now add a delta value to the Hue of the pixels of Cluster A, the object pixels to changes it's color from a shade of blue to a shade of red while keeping the background unaltered. Here I have converted the original blue shirt to a red shirt as seen below(Fig f).", "Now that we have achieved TCR in Single Object Images(SOI), we shall now move on to changing the color of the object in Muti-Object Images(MOI). We read the second input image, the MOI (Fig g leftmost) and convert it into HSV space similar to the SOI image.", "We use the clusters that we detected in the SOI for the same object to help identify the targeted object pixels and build the new TCR Filter for the new input MOI as the object pixels in the new input image (MOI) will lie in the vicinity of the object cluster\u2019s centroid from SOI. For instance, when we plot the HSV values of new input MOI(Fig g leftmost), the blue shirt, with Hue in Red, Saturation in Yellow and Value in Black as seen in Fig g(rightmost), we clearly observe the Hue value spike at around 10 and 100. The spikes in the plot around H=100 lie close to the hue of the centroid of cluster A [104,227,122] from the SOI clustering and represent the object in the MOI. We can see from the HSV map below(Fig g middle) where hue is plotted on the X-axis against Saturation on the Y-axis, Hue near 100 maps to shades of blue, the color of the shirt in our input.", "The new TCR filter for the targeted object in the MOI is built by selecting the pixels with hues that are in a binding distance from the cluster\u2019s centroid derived from the SOI for the object. The new TCR Filter grants us access to alter or edit the pixels that belong to the targeted object without affecting the pixels of the other objects. We can now move across the hue scale (Fig g middle) to change the color of the targeted object. For the input Multi-Object Image of the blue shirt (Fig h middle), we select hue values that are in a binding distance from the hue of cluster A\u2019s centroid(H=104) derived from the TCR of SOI for the blue shirt. This selects the target objects pixels, in this case, the blue shirt in the image and generates the new unique TCR Filter for the MOI (Fig h leftmost). We can now add a delta value to these pixels to alter their hue using the new TCR Filter. A delta addition of 70 to the hue results in the color of the shirt to shift from blue to red. Fig i represents the color reassignment for the input blue shirt with different delta values resulting in different color shifts.", "Below are a few of the exploratory trials I ran on other clothing items with different styles and textures.", "Where can this be used? For starters, any clothing company that wishes to explore more color options on their products in an automated fashion. Any business(probably a startup) that wants to save money and time hiring models to try out all the color options they provide for the same item. The concept of Smart mirrors outside of trial rooms where customers who visit the stores and like a dress would go and try it on then stand in front of a smart mirror which allows the user to instantaneously change the color of their dress and try out multiple options that the physical store might not have stock or their online counterpart offers.", "Why clothing? since I work as a customer analyst for a fashion-related retail industry, I started the project with clothing products and other fashion-related products. Having said that, this algorithm can be used for any other item or in any other industry. For example the auto industry, we can with the same ease change the color of an automobile as shown below.", "The algorithm struggles to identify distinguishing segments in the MOIs when there are multiple objects that are very close to each other in the Hue scale in the HSV space. For instance, when a person wears clothing with a shade very close to the shade of their skin. Since we are performing color-based segmentation the algorithm also struggles when the background shares a hue value close to that of the targeted object.", "There is more to be done on this work, automating the range selection of the binding value for selecting the object in MOI. To use the Machine Learning algorithms to apply TCR on a specific object detected with the help of an object detection algorithm. Alternate approaches can be explored like feature mapping to map the object from the SOI to the MOI accompanied by an agglomerative clustering to build the TCR Filter for MOI.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science | Computer Vision. Customer Analyst at Mast Global, L Brands."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3adce8b9ab0f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shashidhar_pai?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shashidhar_pai?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": "Shashidhar Pai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F40230cd2ab3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&user=Shashidhar+Pai&userId=40230cd2ab3a&source=post_page-40230cd2ab3a----3adce8b9ab0f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3adce8b9ab0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3adce8b9ab0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://docs.opencv.org/3.0-beta/doc/py_tutorials/py_ml/py_kmeans/py_kmeans_opencv/py_kmeans_opencv.html", "anchor_text": "Kmeans"}, {"url": "https://www.learnopencv.com/color-spaces-in-opencv-cpp-python/", "anchor_text": "https://www.learnopencv.com/color-spaces-in-opencv-cpp-python/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3adce8b9ab0f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----3adce8b9ab0f---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/color-reassignment?source=post_page-----3adce8b9ab0f---------------color_reassignment-----------------", "anchor_text": "Color Reassignment"}, {"url": "https://medium.com/tag/k-means?source=post_page-----3adce8b9ab0f---------------k_means-----------------", "anchor_text": "K Means"}, {"url": "https://medium.com/tag/innovation?source=post_page-----3adce8b9ab0f---------------innovation-----------------", "anchor_text": "Innovation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3adce8b9ab0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&user=Shashidhar+Pai&userId=40230cd2ab3a&source=-----3adce8b9ab0f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3adce8b9ab0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&user=Shashidhar+Pai&userId=40230cd2ab3a&source=-----3adce8b9ab0f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3adce8b9ab0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3adce8b9ab0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3adce8b9ab0f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3adce8b9ab0f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shashidhar_pai?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shashidhar_pai?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shashidhar Pai"}, {"url": "https://medium.com/@shashidhar_pai/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F40230cd2ab3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&user=Shashidhar+Pai&userId=40230cd2ab3a&source=post_page-40230cd2ab3a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F40230cd2ab3a%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-color-reassignment-tcr-3adce8b9ab0f&user=Shashidhar+Pai&userId=40230cd2ab3a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}