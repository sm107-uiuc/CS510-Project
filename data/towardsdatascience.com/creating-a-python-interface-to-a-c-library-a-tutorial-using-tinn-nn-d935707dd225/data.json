{"url": "https://towardsdatascience.com/creating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225", "time": 1682993425.513624, "path": "towardsdatascience.com/creating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225/", "webpage": {"metadata": {"title": "Using Tinn (Tiny Neural Network in C) with Python | by Chris Knorowski | Towards Data Science", "h1": "Using Tinn (Tiny Neural Network in C) with Python", "description": "At SensiML we are focused on building machine learning tools that make it easy for developers to create and deploy trained models to embedded IoT devices. In this post, I\u2019m going to show you how to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://sensiml.com", "anchor_text": "SensiML", "paragraph_index": 0}, {"url": "https://sensiml.com", "anchor_text": "SensiML", "paragraph_index": 0}, {"url": "https://github.com/glouw/tinn.git", "anchor_text": "download Tinn from GitHub", "paragraph_index": 1}, {"url": "https://gist.github.com/cdknorow/056355c8788657abb037c71405de9745", "anchor_text": "find it here", "paragraph_index": 4}, {"url": "https://sensiml.com/#contact", "anchor_text": "get in touch with us", "paragraph_index": 20}, {"url": "https://sensiml.com", "anchor_text": "site", "paragraph_index": 20}], "all_paragraphs": ["At SensiML we are focused on building machine learning tools that make it easy for developers to create and deploy trained models to embedded IoT devices. In this post, I\u2019m going to show you how to turn Tinn (a tiny neural network written in standard C) into a shared library and then to call it from Python as if it were a native Python function. We use this method at SensiML to experiment with and build C libraries that target embedded devices while still natively using our Python data science toolkit.", "If you are going to work through this tutorial, you\u2019ll need Tinn. You can download Tinn from GitHub.", "Alternatively, go to the site and download it by clicking on the clone or download it, then selecting the download zip file.", "Step 2. Compile Tinn into a shared library", "In order to call the Tinn functions, we have to create a shared library. I\u2019ve created a makefile for compiling the Tinn library to a shared library, you can find it here. Replace the make file in the Tinn folder with the one provided, cd into the Tinn folder in the terminal, and run make.", "(Note: This was written for Linux/OSX if you are on windows you use the ubuntu bash shell to compile)", "If everything works, a shared library file named libtinn.so should have been created in the directory. We will link to this shared library in the next step in order to call these functions directly.", "Lets first take a look at the Tinn.h file to see which functions we will need to call from python.", "The first python interface we will create is the Tinn struct. We can do this using ctypes.Strucuture class. This structure has two properties that need to be filled in, __slots__ and _fields_. The __slots__ let us assign properties to the struct_tinn class. The _fields_ lets us describes which ctype to use for each variable.", "Below you can see the python Tinn struct class, which I call struct_tinn. Using ctypes, we can specify all of the variable types in the struct_tinn, in this case, integers and pointers to arrays of floats.", "Now that we have created a python representation of the Tinn struct, we need to import and create the python representations of the c functions we want to call. For this tutorial, they are the following", "with these three functions, we will be able to initialize, train, and make predictions using the Tinn library. Next, we use ctyles.CDLL to import the shared library we created in step 2 of this tutorial.", "For each of the functions we want to call, we have to specify the input and output types of the functions as python ctypes. We do this by setting the argtypes and restype properties of our cf_lib functions.", "At this point, we have created all of the python wrapper objects we need to be able to call Tinn from python. In order to use the NN, we still need to write a initialize, train, and predict methods for python.", "Let us start with a function to initialize a Tinn object with a set of parameters. We\u2019ll call this init_tinn and pass the number of inputs, number of outputs, and number of hidden layers that we want in our NN.", "Here you can see, we cast all of the inputs to ctypes before passing them to the xtbuild function. The Tinn object can now be initialized by calling our python function.", "Because it is a python object, we can dynamically index into all of the Tinn attributes.", "Next, let us build our train and predict functions. Our train function will take the Tinn object, an array of X digits, and y targets, as well as alpha the training step size.", "The predict function will take the trained Tinn object, and an input vector to recognize, returning the predicted value with the highest confidence from the NN.", "Finally, let us use our python Tinn functions in a standard data science workflow to identify handwritten digits. We\u2019ll import the digit data from sklearn, then create a standard train test dataset with an 80/20 split. For fun, we loop over the learning rate as well to see what learning rate works best for this dataset. And finally, make some predictions to test the model accuracy.", "That wraps up this blog post. We\u2019ve gone over how to create a shared c library, how to use ctypes to instantiates c structures and c functions from within python. Then we initialized and trained the Tinn NN model using our calls from the python shell. I hope you\u2019ve enjoyed this tutorial, if you have any questions please feel free to drop me a line or comment below. If you are interested in building smart sensor algorithms for IoT devices where you want to run inference locally at the sensor, get in touch with us or check out our site to learn more.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CTO/Cofounder of SensiML. Works at the intersection of physics, software engineering and machine learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd935707dd225&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d935707dd225--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d935707dd225--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cknorow?source=post_page-----d935707dd225--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cknorow?source=post_page-----d935707dd225--------------------------------", "anchor_text": "Chris Knorowski"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fda7ba8b94b89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&user=Chris+Knorowski&userId=da7ba8b94b89&source=post_page-da7ba8b94b89----d935707dd225---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd935707dd225&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd935707dd225&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://sensiml.com", "anchor_text": "SensiML"}, {"url": "https://sensiml.com", "anchor_text": "SensiML"}, {"url": "https://github.com/glouw/tinn.git", "anchor_text": "download Tinn from GitHub"}, {"url": "https://github.com/glouw/tinn.git", "anchor_text": "https://github.com/glouw/tinn.git"}, {"url": "https://gist.github.com/cdknorow/056355c8788657abb037c71405de9745", "anchor_text": "find it here"}, {"url": "https://sensiml.com/#contact", "anchor_text": "get in touch with us"}, {"url": "https://sensiml.com", "anchor_text": "site"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d935707dd225---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----d935707dd225---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/c-programming?source=post_page-----d935707dd225---------------c_programming-----------------", "anchor_text": "C Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d935707dd225---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/iot?source=post_page-----d935707dd225---------------iot-----------------", "anchor_text": "IoT"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd935707dd225&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&user=Chris+Knorowski&userId=da7ba8b94b89&source=-----d935707dd225---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd935707dd225&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&user=Chris+Knorowski&userId=da7ba8b94b89&source=-----d935707dd225---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd935707dd225&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d935707dd225--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd935707dd225&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d935707dd225---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d935707dd225--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d935707dd225--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d935707dd225--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d935707dd225--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d935707dd225--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d935707dd225--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d935707dd225--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d935707dd225--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cknorow?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cknorow?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chris Knorowski"}, {"url": "https://medium.com/@cknorow/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "64 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fda7ba8b94b89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&user=Chris+Knorowski&userId=da7ba8b94b89&source=post_page-da7ba8b94b89--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5e34d745925a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-python-interface-to-a-c-library-a-tutorial-using-tinn-nn-d935707dd225&newsletterV3=da7ba8b94b89&newsletterV3Id=5e34d745925a&user=Chris+Knorowski&userId=da7ba8b94b89&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}