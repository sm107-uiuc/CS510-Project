{"url": "https://towardsdatascience.com/performing-exploration-robin-hood-style-da1369114300", "time": 1683001308.449739, "path": "towardsdatascience.com/performing-exploration-robin-hood-style-da1369114300/", "webpage": {"metadata": {"title": "Performing Exploration, Robin-Hood Style | by Shaked Zychlinski | Towards Data Science", "h1": "Performing Exploration, Robin-Hood Style", "description": "Our core business at Taboola is to provide the surfers-of-the-web with personalized content recommendations wherever they might surf. We do so using state of the art Deep Learning methods, which\u2026"}, "outgoing_paragraph_urls": [{"url": "https://engineering.taboola.com/", "anchor_text": "Taboola\u2019s Engineering Blog", "paragraph_index": 0}, {"url": "https://medium.com/@shakedzy/going-old-school-designing-algorithms-for-fast-weighted-sampling-in-production-c48fc1f40051", "anchor_text": "In a previous post", "paragraph_index": 2}, {"url": "http://shakedzy.xyz", "anchor_text": "shakedzy.xyz", "paragraph_index": 14}], "all_paragraphs": ["This blog post was originally published on Taboola\u2019s Engineering Blog.", "Our core business at Taboola is to provide the surfers-of-the-web with personalized content recommendations wherever they might surf. We do so using state of the art Deep Learning methods, which learn what to display to each user from our growing pool of articles and advertisements. But as we challenge ourselves manifesting better models and better predictions, we also find ourselves constantly facing another issue \u2014 how do we not listen to our models. Or in other words: how do we explore better?", "As I\u2019ve just mentioned, our pool of articles is growing, meaning more and more items are added each minute \u2014 and from an AI perspective, this is a major issue we must tackle, because by the time we finish training a new model and push it to production, it will already have to deal with items that never existed in its training data. In a previous post, I\u2019ve discussed how we use weighted sampling to allow more exploration of items with low CTR (Click-Through Rate) while attempting not to harm the traffic of high CTR items. In this post, I\u2019ll extend this dilemma even further, and discuss how we can allow meaningful exploration of items which our models have never seen before.", "Understanding the use of embeddings \u2014 and what they represent \u2014 is the key to understanding the discussed exploration method, so let\u2019s briefly review how they work. An embedding is a set of weights (or more simply, a vector) learned by the model to represent the characteristics of an input feature. Let\u2019s say that we have two items in our pool, where item A is super-successful among gamers of age 20 to 30 living in the US and Canada, and item B is very popular among cooking-lovers of ages 30 to 40 living in German-speaking countries in Europe. Where should the model store this learned information? In each item\u2019s embeddings, of course! So embeddings are value-specific vectors the model has learned, and it allows it to distinguish one from another, and estimate their performance more accurately. For each of our items, the model learns a new vector. If our model is training correctly, another item which is successful with item A\u2019s crowd will have an embedding vector which will be close to him in our vector space.", "But let\u2019s say that our training data has another item, item C, which is so new it appeared on the training data only once. Is this single appearance sufficient for the model to learn anything about this item? Of course not. So there\u2019s no point in creating an embedding for it \u2014 as it will obviously just be noise. Yet, we still need an embedding for it, so what should we do?", "Whenever we build embeddings to a feature, we decide on a threshold of minimum appearances each value must have in order to have its own embedding. All the values which have less appearances than the required threshold are then aggregated and are used to construct a single embedding which will be used for all of them. This embedding is named the Out Of Vocabulary embedding (OOV), as it is used for all the values that didn\u2019t make it into the list (or vocabulary) of values which have their own embedding. Even more, the OOV embedding is also used for all the completely new items which the model never seen before.", "It\u2019s easy to see why having an OOV embedding is really bad for any value. It is constructed of many many completely different values, which rarely have anything to do with one another. This means that OOVs are usually noisy and have very low CTR estimates \u2014 even though there\u2019s nothing wrong with these items, they simply weren\u2019t displayed enough when the model was trained.", "But there\u2019s a vicious cycle here \u2014 if a new item received an OOV embedding due to lack of appearances, it will receive very low CTR estimates by the model \u2014 which again won\u2019t allow it to receive many appearances. This can make the model stick to the same items it always displays, and this isn\u2019t good for us. So\u2026 it\u2019s time for us to head over to Sherwood forest!", "One of our most important goals at Taboola is to predict whether our users will click on an item we\u2019ve shown them or not. Therefore, our training data is constructed of all the items we\u2019ve shown (also known as impressions), and the user\u2019s response (clicked or not). As there\u2019s an obvious positive correlation between the number of times we show a certain item to the number of clicks it receives, it\u2019s easy to see that our best-selling items are also the ones with the most appearances in our training data. This means these are also the items with the most powerful and well-trained embeddings.", "So the trick we did here is quite simple \u2014 just like there\u2019s a minimal threshold of appearances to the embeddings, which below it a value becomes an OOV, we\u2019ve added a maximal threshold to the appearances, which above it a value also becomes an OOV. We tuned it so only the very top of items will fall above this threshold and will be added to the OOV bucket. This provides us with an OOV made by a combination of the most profitable items we have \u2014 so now all new items receive a super-powerful embedding, which makes the model give them higher CTR estimates. We named this method Robin Hood Exploration, as we \u201csteal\u201d data from our best items and move it to our OOVs.", "Impressions (yellow) and revenue (green) by different embedding groups of the Robin Hood method compared to our default model.", "The Robin Hood method is performing as expected \u2014 our OOVs and Weak embedding groups receive more traffic and also yield more revenue, but on the expense of our top-sellers. Medium-strength embeddings are left with almost no change. Reducing traffic of top sellers is something we can deal with when affecting a limited amount of traffic \u2014 our purpose here is to perform exploration, a.k.a: give traffic to new items, and there\u2019s no need to perform exploration over our best sellers \u2014 we already know they\u2019re our best-sellers. And there is even more good news: when it comes to our overall revenue \u2014 this method showed absolutely no negative impact over it.", "To conclude, our Robin-Hood approach, which transfers data from top items to OOVs, has proved itself to be a valuable method for performing meaningful exploration with minimal technical effort. We hope it will prove itself worthy for our readers too. Safe ride!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Head of Recommendations at Lightricks. Lives in Tel-Aviv, Israel. See me on shakedzy.xyz"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fda1369114300&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----da1369114300--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da1369114300--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://shakedzy.medium.com/?source=post_page-----da1369114300--------------------------------", "anchor_text": ""}, {"url": "https://shakedzy.medium.com/?source=post_page-----da1369114300--------------------------------", "anchor_text": "Shaked Zychlinski"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43218078e688&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&user=Shaked+Zychlinski&userId=43218078e688&source=post_page-43218078e688----da1369114300---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda1369114300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda1369114300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://engineering.taboola.com/", "anchor_text": "Taboola\u2019s Engineering Blog"}, {"url": "https://medium.com/@shakedzy/going-old-school-designing-algorithms-for-fast-weighted-sampling-in-production-c48fc1f40051", "anchor_text": "In a previous post"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----da1369114300---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----da1369114300---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----da1369114300---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----da1369114300---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----da1369114300---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda1369114300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&user=Shaked+Zychlinski&userId=43218078e688&source=-----da1369114300---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda1369114300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&user=Shaked+Zychlinski&userId=43218078e688&source=-----da1369114300---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda1369114300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da1369114300--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fda1369114300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----da1369114300---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----da1369114300--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----da1369114300--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----da1369114300--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----da1369114300--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----da1369114300--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----da1369114300--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----da1369114300--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----da1369114300--------------------------------", "anchor_text": ""}, {"url": "https://shakedzy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://shakedzy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shaked Zychlinski"}, {"url": "https://shakedzy.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "http://shakedzy.xyz", "anchor_text": "shakedzy.xyz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43218078e688&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&user=Shaked+Zychlinski&userId=43218078e688&source=post_page-43218078e688--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4123ceb9438d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fperforming-exploration-robin-hood-style-da1369114300&newsletterV3=43218078e688&newsletterV3Id=4123ceb9438d&user=Shaked+Zychlinski&userId=43218078e688&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}