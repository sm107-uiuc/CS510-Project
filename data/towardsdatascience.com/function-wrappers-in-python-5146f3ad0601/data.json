{"url": "https://towardsdatascience.com/function-wrappers-in-python-5146f3ad0601", "time": 1683006837.142283, "path": "towardsdatascience.com/function-wrappers-in-python-5146f3ad0601/", "webpage": {"metadata": {"title": "Function Wrappers in Python. Putting a Wrapper Around a Function | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Function Wrappers in Python", "description": "An important principle of software programming is the DRY principle. DRY is an acronym for \u201cDon\u2019t Repeat Yourself\u201d. The goal of DRY is to avoid needless repetition in software programming\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mirichoi0218/insurance", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/spierre91/medium_code/blob/master/metaprogramming/function_wrapping.py", "anchor_text": "GitHub", "paragraph_index": 22}], "all_paragraphs": ["An important principle of software programming is the DRY principle. DRY is an acronym for \u201cDon\u2019t Repeat Yourself\u201d. The goal of DRY is to avoid needless repetition in software programming. Applications of DRY include implementing abstractions through functions, classes, decorators, class decorators and metaclasses. In this post, we will use a function decorator to wrap and add extra processing to existing functions used for model building.", "For our example, we will define a decorator function that reports the execution time of an input function. As a data scientist, I often have to consider the execution time of fit and predict calls made in production. Let\u2019s consider this use case.", "We will be using the synthetic medical data from Medical Costs Personal Dataset which can be found here. We will define functions for reading data, fitting data and making predictions. We will then define a decorator function that will report the execution time for each function call.", "To start, let\u2019s read in our data into a Pandas data frame:", "Let\u2019s print the first five rows of data:", "Let\u2019s now frame our prediction problem. Let\u2019s use the \u2018age\u2019, \u2018bmi\u2019, and \u2018children\u2019 columns as input features and \u2018charges\u2019 as our target. Let\u2019s also split our data for training and testing. First, let\u2019s import some necessary packages:", "Next, let\u2019s define our input and out. Let\u2019s also split our data into training and testing sets:", "Here, we select a test size corresponding to a random sample of 20% of the data. Now, let\u2019s put all of this into a single function:", "Next, let\u2019s define a function, \u2018fit_model\u2019, that we will use to fit our model to our training data. Let\u2019s import the \u2018LinearRegression\u2019 module:", "In our \u2018fit_model\u2019 function let\u2019s define a \u2018LinearRegression\u2019 object and fit our model to the training data:", "Finally, let\u2019s define a function that will make predictions on the test set:", "Now that we have our functions defined, let\u2019s define our decorator function that will report execution times. Our decorator function will be a timer function, called \u2018timethis\u2019, and it will take a function as input:", "Next, we will define a \u2018wrapper\u2019 function within our \u2018timethis\u2019 function:", "In our \u2018wrapper\u2019 function we will define \u2018start\u2019 and \u2018end\u2019 variables that we will use to record the start and end of a run. In between defining our \u2018start\u2019 and \u2018end\u2019 variables we will call the input function and store it in a variable called \u2018result\u2019:", "The last thing we need to do is place the \u2018@wraps\u2019 decorator in the line before our \u2018wrapper\u2019 function:", "The \u2018@wraps\u2019 decorator takes the function passed into \u2018@timethis\u2019 and copies over the function name, docstring, arguments list, etc\u2026", "We will then print the name of the function and the run time (\u2018end\u2019 \u2014 \u2018start\u2019). We also return the input function, which we stored in the \u2018result\u2019 variable:", "Finally, the \u2018timethis\u2019 function returns the \u2018wrapper\u2019:", "Now we can use the \u2018@timethis\u2019 decorator on any of our functions. Let\u2019s apply \u2018@timethis\u2019 to our \u2018read_split\u2019 method. We simply put \u2018@timethis\u2019 in the line right before the function we\u2019d like to wrap:", "Now if we call our \u2018read_split\u2019 method our decorator \u2018@timethis\u2019 should print the execution time:", "Let\u2019s do the same for our fit method:", "I\u2019ll stop here but feel free to play around with the code and data yourself. I encourage you to analyze the execution times for some other regression models that you can build with this data like random forest or support vector regression.", "To summarize, in this post we discussed function wrappers in python. To start we defined three functions for building a linear regression model. We defined functions for reading and splitting our data for training, fitting our model to training data, and making predictions on our test set. We then defined a function wrapper that allowed us to report execution time for each function call. I hope you found this post useful/interesting. The code in this post is available on GitHub. Thank you for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5146f3ad0601&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----5146f3ad0601---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5146f3ad0601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5146f3ad0601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/search/wrap/", "anchor_text": "Source"}, {"url": "https://www.kaggle.com/mirichoi0218/insurance", "anchor_text": "here"}, {"url": "http://twitter.com/wraps", "anchor_text": "@wraps"}, {"url": "http://twitter.com/wraps", "anchor_text": "@wraps"}, {"url": "http://twitter.com/wraps", "anchor_text": "@wraps"}, {"url": "http://twitter.com/timethis", "anchor_text": "@timethis"}, {"url": "http://twitter.com/timethis", "anchor_text": "@timethis"}, {"url": "https://github.com/spierre91/medium_code/blob/master/metaprogramming/function_wrapping.py", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/python?source=post_page-----5146f3ad0601---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/software-development?source=post_page-----5146f3ad0601---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5146f3ad0601---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----5146f3ad0601---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----5146f3ad0601---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5146f3ad0601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----5146f3ad0601---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5146f3ad0601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----5146f3ad0601---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5146f3ad0601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5146f3ad0601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5146f3ad0601---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5146f3ad0601--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5146f3ad0601--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5146f3ad0601--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5146f3ad0601--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunction-wrappers-in-python-5146f3ad0601&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}