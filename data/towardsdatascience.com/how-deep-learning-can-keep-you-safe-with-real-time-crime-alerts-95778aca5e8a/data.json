{"url": "https://towardsdatascience.com/how-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a", "time": 1683011908.511446, "path": "towardsdatascience.com/how-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a/", "webpage": {"metadata": {"title": "How Deep Learning Can Keep You Safe with Real-Time Crime Alerts | by Nikunj Aggarwal | Towards Data Science", "h1": "How Deep Learning Can Keep You Safe with Real-Time Crime Alerts", "description": "Citizen scans thousands of public first responder radio frequencies 24 hours a day in major cities across the US. The collected information is used to provide real-time safety alerts about incidents\u2026"}, "outgoing_paragraph_urls": [{"url": "https://citizen.com/", "anchor_text": "Citizen", "paragraph_index": 0}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7256403/", "anchor_text": "top performing", "paragraph_index": 2}, {"url": "https://www.n2nov.net/nypdcodes.html", "anchor_text": "special codes", "paragraph_index": 2}, {"url": "https://cloud.google.com/speech-to-text/docs/context-strength", "anchor_text": "speech contexts", "paragraph_index": 2}, {"url": "https://cloud.google.com/speech-to-text/docs/boost", "anchor_text": "boosted", "paragraph_index": 3}, {"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "XGBoost", "paragraph_index": 5}, {"url": "http://brics.butlersheriff.org/help/radio/tones-on-brics/", "anchor_text": "special alert tones", "paragraph_index": 6}, {"url": "https://cloud.google.com/speech-to-text/docs/basics#select-model", "anchor_text": "phone models", "paragraph_index": 9}, {"url": "https://arxiv.org/abs/1412.5567", "anchor_text": "several hundred hours of transcription data", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Keyword_spotting", "anchor_text": "keyword spotting", "paragraph_index": 13}, {"url": "https://arxiv.org/abs/1706.03762", "anchor_text": "Transformer model", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/Mel-frequency_cepstrum#:~:text=Mel%2Dfrequency%20cepstral%20coefficients%20(MFCCs,%2Da%2Dspectrum%22).", "anchor_text": "MFCC", "paragraph_index": 16}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/Sequential", "anchor_text": "Keras Sequential", "paragraph_index": 16}, {"url": "https://citizen.com/", "anchor_text": "Citizen", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/nikuaggarwal/", "anchor_text": "https://www.linkedin.com/in/nikuaggarwal/", "paragraph_index": 27}], "all_paragraphs": ["Citizen scans thousands of public first responder radio frequencies 24 hours a day in major cities across the US. The collected information is used to provide real-time safety alerts about incidents like fires, robberies, and missing persons to more than 5M users. Having humans listen to 1000+ hours of audio daily made it very challenging for the company to launch new cities. To continue scaling, we built ML models that could discover critical safety incidents from audio.", "Our custom software-defined radios (SDRs) capture large swathes of radio frequency (RF) and create optimized audio clips that are sent to an ML model to flag relevant clips. The flagged clips are sent to operations analysts to create incidents in the app, and finally, users near the incidents are notified.", "We started with a top performing speech-to-text engine based on the word error rate (WER). There are a lot of special codes used by police that are not part of the normal vernacular. For example, an NYPD officer requests backup units by transmitting a \u201cSignal 13\u201d. We customized the vocabulary to our domain using speech contexts.", "We also boosted some words to fit our domain, for example, \u201cassault\u201d isn\u2019t used colloquially, but is very common in our use case. We had to bias our models towards detecting \u201cassault\u201d over \u201ca salt\u201d.", "After tuning the parameters, we were able to get reasonable accuracy for transcriptions in some cities. The next step was to use the transcribed data of the audio clips and figure out which ones were relevant to Citizen.", "We modeled a binary classification problem with the transcriptions as input and a confidence level as output. XGBoost gave us the best performance on our dataset.", "We had insight from someone who previously worked in law enforcement that radio transmissions about major incidents in some cities are preceded by special alert tones to get the attention of police on the ground. This extra feature helped make our model more reliable, especially in cases of bad transcriptions. Some other useful features we found were the police channel and transmission IDs.", "We A/B tested the ML model in operations workflow. After a few days of running the test, we noticed no degradation in the incidents created by analysts who were using the model-flagged clips only.", "We launched the model in a few cities. Now a single analyst could handle multiple cities at once, which wasn\u2019t previously possible! With the new spare capacity on operations, we were able to launch multiple new cities.", "The model didn\u2019t turn out to be a panacea for all our problems. We could only use it in a few cities which had good quality audio. Public speech-to-text engines are trained on phone models with different acoustic profile than radios; as a result, the transcription quality was sometimes unreliable. Transcriptions were completely unusable for the older analog systems, which were very noisy.", "We tried multiple models from multiple providers, but none of them were trained on an acoustic profile similar to our dataset and couldn\u2019t handle noisy audio.", "We explored replacing the speech-to-text engine with the one trained on our data while keeping the rest of the pipeline the same. However, we needed several hundred hours of transcription data for our audio which was very slow and expensive to generate. We had an option to optimize the process by only transcribing the \u201cimportant\u201d words defined in our vocabulary and adding blanks for the irrelevant words \u2014 but that was still just an incremental reduction in effort.", "Eventually, we decided to build a custom speech processing pipeline for our problem domain.", "Since we only care about the presence of keywords, we didn\u2019t need to find the right order of words and could reduce our problem to keyword spotting. That was a much easier problem to solve! We decided to do so using a convolutional neural network (CNN) trained on our dataset.", "Using CNNs over Recurrent neural networks (RNNs) or Long short-term memory (LSTM) models meant that we could train much faster and had quicker iterations. We also evaluated using the Transformer model which is massively parallel but requires a lot of hardware to run. Since we were only looking for short term dependencies between audio segments to detect words, a computationally simple CNN seemed a better choice over Transformers and it freed up hardware for us to be more vigorous with hyperparameter tuning.", "We split the audio clips into fixed duration subclips. We gave a positive label to a subclip if a vocabulary word was present. We then marked an audio clip as useful if any such subclip was found in it. During the training process, we tried how varying the duration of subclips affected our convergence performance. Long clips made it much harder for the model to figure out which portion of the clip was useful and also harder to debug. Short clips meant that words partially appeared across multiple clips, which made it harder for the model to identify them. We were able to tune this hyperparameter and find a reasonable duration.", "For each subclip, we convert the audio into MFCC coefficients and also add the first and second-order derivatives. The features are generated with a frame size of 25ms and stride of 10ms. The features are then fed into a neural network based on Keras Sequential model using a Tensorflow backend. The first layer is a Gaussian noise which makes the model more robust to noise differences between different radio channels. We tried an alternative approach of artificially overlaying real noise to clips, but that slowed down training time significantly with no meaningful performance gains.", "We then added subsequent layers of Conv1D, BatchNormalization, and MaxPooling1D. Batch normalization helped with the model convergence, and max pooling helped in making the model more robust to minor variations in speech and also to channel noise. Also, we tried adding dropout layers, but those didn\u2019t improve the model meaningfully. Finally, we added a densely-connected neural network layer which fed into a single output-dense layer with sigmoid activation.", "To label the training data, we gave annotators the list of keywords for our domain and asked them to mark the start and end positions within a clip along with the word label if any of the vocabulary words were present.", "To ensure the annotations were reliable, we had a 10% overlap across annotators and calculated how they performed on the overlapped clips. Once we had ~50 hours of labeled data, we started the training process. We kept collecting more data while iterating on the training process.", "Since some words in our vocabulary were much more common than others, our model had a reasonable performance on common words but struggled with rarer words with fewer examples. We tried creating artificial examples of those words by overlaying the word utterance in other clips. However, the performance gains were not commensurate with actually getting labeled data for those words. Eventually, as our model improved with common words, we ran it on unlabeled audio clips and excluded the ones where the model found those words. That helped us reduce the redundant words from our future labeling.", "After several iterations of data collection and hyperparameter tuning, we were able to train a model with high recall on our vocabulary words and reasonable precision. High recall was very important to capture critical safety alerts. The flagged clips are always listened to before an alert is sent, so false positives were not a huge concern.", "We A/B tested the model in some boroughs of New York City. The model was able to cut down audio volume by 50\u201375% (depending on the channel). It also clearly outcompeted our model trained on public speech-to-text engine since NYC has very noisy audio due to analog systems.", "Somewhat surprisingly, we then found that the model transferred well to audio from Chicago even though the model was trained on NYC data. After collecting a few hours of Chicago clips, we were able to transfer-learn from the NYC model to get reasonable performance in Chicago.", "Our speech processing pipeline with the custom deep neural network was broadly applicable to police audio from major US cities. It discovered critical safety incidents from the audio, allowing Citizen to expand rapidly into cities across the country and serve the mission of keeping communities safe.", "Picking computationally simple CNN architecture over RNN, LSTM, or Transformer and simplifying our labeling process were major breakthroughs that allowed us to outperform public speech-to-text models in a very short time and with limited resources.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Lead at Citizen | https://www.linkedin.com/in/nikuaggarwal/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F95778aca5e8a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nikunjag?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nikunjag?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": "Nikunj Aggarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F75a2bfb9dd1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&user=Nikunj+Aggarwal&userId=75a2bfb9dd1c&source=post_page-75a2bfb9dd1c----95778aca5e8a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95778aca5e8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95778aca5e8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/data-for-change", "anchor_text": "Data for Change"}, {"url": "http://citizen.com/mission", "anchor_text": "Citizen"}, {"url": "https://citizen.com/", "anchor_text": "Citizen"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7256403/", "anchor_text": "top performing"}, {"url": "https://www.n2nov.net/nypdcodes.html", "anchor_text": "special codes"}, {"url": "https://cloud.google.com/speech-to-text/docs/context-strength", "anchor_text": "speech contexts"}, {"url": "https://cloud.google.com/speech-to-text/docs/boost", "anchor_text": "boosted"}, {"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "XGBoost"}, {"url": "http://brics.butlersheriff.org/help/radio/tones-on-brics/", "anchor_text": "special alert tones"}, {"url": "https://cloud.google.com/speech-to-text/docs/basics#select-model", "anchor_text": "phone models"}, {"url": "https://arxiv.org/abs/1412.5567", "anchor_text": "several hundred hours of transcription data"}, {"url": "https://en.wikipedia.org/wiki/Keyword_spotting", "anchor_text": "keyword spotting"}, {"url": "https://arxiv.org/abs/1706.03762", "anchor_text": "Transformer model"}, {"url": "https://en.wikipedia.org/wiki/Mel-frequency_cepstrum#:~:text=Mel%2Dfrequency%20cepstral%20coefficients%20(MFCCs,%2Da%2Dspectrum%22).", "anchor_text": "MFCC"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/Sequential", "anchor_text": "Keras Sequential"}, {"url": "https://citizen.com/", "anchor_text": "Citizen"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----95778aca5e8a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----95778aca5e8a---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/convolutional-neural-net?source=post_page-----95778aca5e8a---------------convolutional_neural_net-----------------", "anchor_text": "Convolutional Neural Net"}, {"url": "https://medium.com/tag/applied-machine-learning?source=post_page-----95778aca5e8a---------------applied_machine_learning-----------------", "anchor_text": "Applied Machine Learning"}, {"url": "https://medium.com/tag/data-for-change?source=post_page-----95778aca5e8a---------------data_for_change-----------------", "anchor_text": "Data For Change"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95778aca5e8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&user=Nikunj+Aggarwal&userId=75a2bfb9dd1c&source=-----95778aca5e8a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95778aca5e8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&user=Nikunj+Aggarwal&userId=75a2bfb9dd1c&source=-----95778aca5e8a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95778aca5e8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F95778aca5e8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----95778aca5e8a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----95778aca5e8a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----95778aca5e8a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----95778aca5e8a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----95778aca5e8a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nikunjag?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nikunjag?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nikunj Aggarwal"}, {"url": "https://medium.com/@nikunjag/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7 Followers"}, {"url": "https://www.linkedin.com/in/nikuaggarwal/", "anchor_text": "https://www.linkedin.com/in/nikuaggarwal/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F75a2bfb9dd1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&user=Nikunj+Aggarwal&userId=75a2bfb9dd1c&source=post_page-75a2bfb9dd1c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F75a2bfb9dd1c%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-deep-learning-can-keep-you-safe-with-real-time-crime-alerts-95778aca5e8a&user=Nikunj+Aggarwal&userId=75a2bfb9dd1c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}