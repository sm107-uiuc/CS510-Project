{"url": "https://towardsdatascience.com/learning-from-imbalanced-datasets-b601a1f1e154", "time": 1683004632.7810571, "path": "towardsdatascience.com/learning-from-imbalanced-datasets-b601a1f1e154/", "webpage": {"metadata": {"title": "Learning from Imbalanced Datasets | by Ido Zehori | Towards Data Science", "h1": "Learning from Imbalanced Datasets", "description": "Data scientists are often faced with the need to work with imbalanced datasets. Indeed, imbalanced classes are a common problem in machine learning classification, where there\u2019s a disproportionate\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Accuracy_paradox", "anchor_text": "wikipedia", "paragraph_index": 4}], "all_paragraphs": ["Data scientists are often faced with the need to work with imbalanced datasets. Indeed, imbalanced classes are a common problem in machine learning classification, where there\u2019s a disproportionate ratio of observations in each class.", "Class imbalance can be found in a variety of areas, including AdTech, medical diagnosis, spam filtering and fraud detection. But most machine learning algorithms work best with the number of samples in each class are roughly equal. This is because most algorithms are designed to maximize accuracy and reduce error.", "In this article, we offer guidelines for working with imbalanced datasets. But before doing any of what we recommend, you should first identify whether you can collect more data. Getting more of your undersampled class is always the best solution.", "After you\u2019ve collected as much data as possible, dealing with imbalanced datasets involves choosing three things: the right metric, what resampling method(s) to use, and the right modeling framework once you\u2019ve pre-processed your data.\u200d", "The Accuracy Paradox is the paradoxical finding that accuracy is not a good metric for predictive models when classifying in predictive analytics. This is because a simple model may have a high level of accuracy but be too crude to be useful. For example, if the incidence of female VS males is dominant, being found in 99% of cases, then predicting that every case is female will have an accuracy of 99%. wikipedia", "A closer look at this paradoxical behavior will reveal two types of misclassifications: false positives and false negatives. In an example involving fire alarms, a false positive would involve predicting that there is a fire (predicting positive) when there isn\u2019t; and a false negative would be mistakenly predicting that there is no fire (predicting negative) when there actually is. In the case of the accuracy paradox, we can see that all of our mistakes were predicting positive (meaning that there is a fire) as not fire, since all the predictions we made were only not fire. This leaves us with as many false negatives as there are negative observations.", "To more closely examine where we were accurate or inaccurate with respect to false positives and false negatives, we need to look at the closely related metrics precision and recall. To fully evaluate the effectiveness of a model, you must examine both precision and recall. Precision and recall are alternative performance metrics:", "Unfortunately, precision and recall are by nature in tension. That is, improving precision typically reduces recall, and vice versa. The importance of precision versus recall depends on the business logic of the problem. For example, in the case of the fire alarm, we\u2019ll want to catch all fires, even at the cost of triggering a false alarm every once in a while. This translates to recall being much more important than precision.", "The opposite case can be seen in YouTube recommendations, for example. False negatives are taken lightly since there is no real harm in recommending something you might not like. At the same time, the benefits of recommending something you didn\u2019t know about and might like outweigh the risks of you merely skipping the video.", "To get the full picture of the false positive and false negative map of your prediction, we recommend looking at your model\u2019s scores in the framework of a confusion matrix.", "Finally, if you\u2019re aiming to choose a single metric rather than dealing with two metrics simultaneously, you might want to consider an F1 score. The F1 score is the harmonic mean of the precision and recall, where an F1 score reaches its best value at 1 (perfect precision and recall) and worst at 0.", "Data scientists have a number of resampling methods to choose from, each offering their own advantages and disadvantages. Here, we\u2019ll focus on a few of the more popular methods used in the industry. Since different modeling tasks might require different resampling methods, we advise you to try out a few methods to explore which works best for your specific problem.", "SMOTE (Synthetic Minority Oversampling Algorithm)This resampling method generates new minority class samples along the lines between an observation and each of its nearest minority neighbors. One advantage of this method is that it allows you to avoid overfitting, which occurs when exact replicas of minority instances are added in random oversampling. This method helps emphasize the regions in which there is a large proportion of positive labels rather then overfitting on a single positive observation that might not generalize.", "\u200dChoosing the Right Modeling FrameworksTrying a variety of algorithms is a great rule of thumb anytime you encounter a machine learning problem. And doing so is especially beneficial when you\u2019re working with imbalanced datasets.", "Decision trees generally perform well on imbalanced data. They work by minimizing the entropy in the data by learning a hierarchy of \u201cif/else\u201d questions.", "Some models allow you to assign weights on the loss function in order to treat classes where the dataset consists of classes that are unequal in size. In the scikit-learn framework, this is usually called \u201cclass_weights\u201d and it often takes in a dictionary that defines by how much each class should be penalized. This parameter also exists in the XGBoost framework, where it\u2019s called \u201cscale_pos_weight.\u201d", "Whatever modeling framework you choose, we recommend starting by reading the documentation and checking whether the model supports some kind of loss function penalty for the case of imbalanced data.", "As we mentioned, the problem of imbalanced data is a common one. Don\u2019t let it intimidate you. While working with imbalanced data is certainly challenging, it\u2019s also doable so long as you plan carefully while following the guidelines we\u2019ve provided here.", "You should always start small. Read up on a method and ensure that you know exactly what\u2019s going on under the hood. If you find that a method is bringing you value, you can further tune it by trying different methods from the same family.", "Also, respect the baseline. Compare everything you do to a simple baseline to ensure that you\u2019re not wasting your time, and that by implementing these methods on your data you are actually moving the needle enough. The simplest and strongest baselines we suggest are random oversampling and random undersampling.", "Finally, use an external library. As is the case 99% of the time in data science, you\u2019re not the first person to encounter the problem you\u2019re facing! Look for open source libraries that solve the problem you\u2019re working with. If python is your weapon of choice for data science (as it should be!), we recommend Imbalanced-learn (link below).", "Here are some resources to further assist you as you find your way through working with imbalanced datasets:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Creating real business impact with Data Science and Machine Learning. Leading the Data Science @ BigaBid."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb601a1f1e154&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zehori.ido?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zehori.ido?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": "Ido Zehori"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2da8865bbec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&user=Ido+Zehori&userId=2da8865bbec5&source=post_page-2da8865bbec5----b601a1f1e154---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb601a1f1e154&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb601a1f1e154&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@eduardoequis?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Eduardo S\u00e1nchez"}, {"url": "https://unsplash.com/s/photos/unbalanced?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Accuracy_paradox", "anchor_text": "wikipedia"}, {"url": "https://en.wikipedia.org/wiki/File:Precisionrecall.svg", "anchor_text": "Wikipedia"}, {"url": "https://www.datasciencecentral.com/profiles/blogs/handling-imbalanced-data-sets-in-supervised-learning-using-family", "anchor_text": "Rohit Walimbe"}, {"url": "http://datasciencecentral.com", "anchor_text": "datasciencecentral"}, {"url": "https://youtu.be/P0YN5-PFOU0", "anchor_text": "here"}, {"url": "https://docs.google.com/presentation/d/1ef97mUt38OAV4rZMqFXdu0DsKcw-eokyoF7RTzuYXGo/edit?usp=sharing", "anchor_text": "\u2014 here"}, {"url": "https://github.com/scikit-learn-contrib/imbalanced-learn", "anchor_text": "here"}, {"url": "http://link.springer.com/chapter/10.1007/978-0-387-09823-4_45", "anchor_text": "Data Mining for Imbalanced Datasets: An Overview"}, {"url": "http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=5128907", "anchor_text": "Learning from Imbalanced Data"}, {"url": "https://www.bigabid.com/blog", "anchor_text": "Bigabid blog"}, {"url": "https://www.bigabid.com/blog/data-learning-from-imbalanced-datasets", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b601a1f1e154---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----b601a1f1e154---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b601a1f1e154---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/imbalanced-data?source=post_page-----b601a1f1e154---------------imbalanced_data-----------------", "anchor_text": "Imbalanced Data"}, {"url": "https://medium.com/tag/modeling?source=post_page-----b601a1f1e154---------------modeling-----------------", "anchor_text": "Modeling"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb601a1f1e154&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&user=Ido+Zehori&userId=2da8865bbec5&source=-----b601a1f1e154---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb601a1f1e154&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&user=Ido+Zehori&userId=2da8865bbec5&source=-----b601a1f1e154---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb601a1f1e154&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb601a1f1e154&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b601a1f1e154---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b601a1f1e154--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b601a1f1e154--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b601a1f1e154--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b601a1f1e154--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zehori.ido?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zehori.ido?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ido Zehori"}, {"url": "https://medium.com/@zehori.ido/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "107 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2da8865bbec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&user=Ido+Zehori&userId=2da8865bbec5&source=post_page-2da8865bbec5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F753206d9e9a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-from-imbalanced-datasets-b601a1f1e154&newsletterV3=2da8865bbec5&newsletterV3Id=753206d9e9a9&user=Ido+Zehori&userId=2da8865bbec5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}