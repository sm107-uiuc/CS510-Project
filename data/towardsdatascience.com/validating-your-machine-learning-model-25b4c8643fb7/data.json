{"url": "https://towardsdatascience.com/validating-your-machine-learning-model-25b4c8643fb7", "time": 1683000613.879455, "path": "towardsdatascience.com/validating-your-machine-learning-model-25b4c8643fb7/", "webpage": {"metadata": {"title": "Validating your Machine Learning Model | by Maarten Grootendorst | Towards Data Science", "h1": "Validating your Machine Learning Model", "description": "I believe that one of the most underrated aspects of creating your Machine Learning Model is thorough validation. Using proper validation techniques helps you understand your model, but most\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/PAIR-code/facets", "anchor_text": "Facets", "paragraph_index": 16}, {"url": "http://rasbt.github.io/mlxtend/installation/", "anchor_text": "mlxtend", "paragraph_index": 45}, {"url": "http://rasbt.github.io/mlxtend/installation/", "anchor_text": "mlxtend", "paragraph_index": 50}, {"url": "http://rasbt.github.io/mlxtend/user_guide/evaluate/combined_ftest_5x2cv/", "anchor_text": "Alpaydin, 1999", "paragraph_index": 51}, {"url": "https://www.linkedin.com/in/mgrootendorst/", "anchor_text": "LinkedIn", "paragraph_index": 54}, {"url": "https://twitter.com/MaartenGr", "anchor_text": "Twitter", "paragraph_index": 54}, {"url": "http://www.linkedin.com/in/mgrootendorst/", "anchor_text": "www.linkedin.com/in/mgrootendorst/", "paragraph_index": 56}], "all_paragraphs": ["I believe that one of the most underrated aspects of creating your Machine Learning Model is thorough validation. Using proper validation techniques helps you understand your model, but most importantly, estimate an unbiased generalization performance.", "There is no single validation method that works in all scenarios. It is important to understand if you are dealing with groups, time-indexed data, or if you are leaking data in your validation procedure.", "Which validation method is right for my use case?", "When researching these aspects I found plenty of articles describing evaluation techniques, but validation techniques typically stop at k-Fold cross-validation.", "I would like to show you the world that uses k-Fold CV and goes one step further into Nested CV, LOOCV, but also into model selection techniques.", "The following methods for validation will be demonstrated:", "The basis of all validation techniques is splitting your data when training your model. The reason for doing so is to understand what would happen if your model is faced with data it has not seen before.", "The most basic method is the train/test split. The principle is simple, you simply split your data randomly into roughly 70% used for training the model and 30% for testing the model.", "The benefit of this approach is that we can see how the model reacts to previously unseen data.", "However, what if one subset of our data only have people of a certain age or income levels? This is typically referred to as a sampling bias:", "Sampling bias is systematic error due to a non-random sample of a population, causing some members of the population to be less likely to be included than others, resulting in a biased sample.", "Before going into methods that help with the sampling bias (like k-Fold cross-validation), I would like to go into the additional holdout set.", "When optimizing the hyperparameters of your model, you might overfit your model if you were to optimize using the train/test split.", "Why? Because the model searches for the hyperparameters that fit the specific train/test you made.", "To solve this issue, you can create an additional holdout set. This is often 10% of the data which you have not used in any of your processing/validation steps.", "After optimizing your model on the train/test split, you can check if you did not overfit by validating on your holdout set.", "TIP: If only use a train/test split, then I would advise comparing the distributions of your train and test sets. If they differ significantly, then you might run into problems with generalization. Use Facets to easily compare their distributions.", "To minimize sampling bias we can think about approach validation slightly different. What if, instead of making a single split, we make many splits and validate on all combinations of those splits?", "This is where k-fold cross-validation comes in. It splits the data into k folds, then trains the data on k-1 folds and test on the one fold that was left out. It does this for all combinations and averages the result on each instance.", "The advantage is that all observations are used for both training and validation, and each observation is used once for validation. We typically choose either i=5 or k=10 as they find a nice balance between computational complexity and validation accuracy:", "TIP: The scores of each fold from cross-validation techniques are more insightful than one may think. They are mostly used to simply extract the average performance. However, one might also look at the variance or standard deviation of the resulting folds as it will give information about the stability of the model across different data inputs.", "A variant of k-Fold CV is Leave-one-out Cross-Validation (LOOCV). LOOCV uses each sample in the data as a separate test set while all remaining samples form the training set. This variant is identical to k-fold CV when k = n (number of observations).", "It can be easily implemented using sklearn:", "NOTE: LOOCV is computationally very costly as the model needs to be trained n times. Only do this if the data is small or if you can handle that many computations.", "The issue with k-Fold CV is that you might want each fold to only contain a single group. For example, let\u2019s say you have a dataset of 20 companies and their clients and you want to predict the success of these companies.", "To keep the folds \u201cpure\u201d and only contain a single company you would create a fold for each company. That way, you create a version of k-Fold CV and LOOCV where you leave one company/group out.", "Again, implementation can be done using sklearn:", "When you are optimizing the hyperparameters of your model and you use the same k-Fold CV strategy to tune the model and evaluate performance you run the risk of overfitting. You do not want to estimate the accuracy of your model on the same split that you found the best hyperparameters for.", "Instead, we use a Nested Cross-Validation strategy allowing to separate the hyperparameter tuning step from the error estimation step. To do this, we nest two k-fold cross-validation loops:", "The example below shows an implementation using k-Fold CV for both the inner and outer loop.", "You are free to select the cross-validation approaches you use in the inner and outer loops. For example, you can use Leave-one-group-out for both the inner and outer loops if you want to split by specific groups.", "Now, what would happen if you were to use k-Fold CV on time series data? Overfitting would be a major concern since your training data could contain information from the future. It is important that all your training data happens before your test data.", "One way of validating time series data is by using k-fold CV and making sure that in each fold the training data takes place before the test data.", "Fortunately, sklearn is again to the rescue and has a Time Series CV builtin:", "NOTE: Make sure to order your data according to the time index that you use seeing as you do not supply the TimeSeriesSplit with a time index. Thus, it will create the split simply based on the order in which the records appear.", "When do you consider one model to be better than another? If one model\u2019s accuracy is insignificantly higher than another, is that a sufficient enough reason for choosing the best model?", "As a Data Scientist, I want to make sure that I understand if a model is actually significantly more accurate than another. Fortunately, many methods exist that apply statistics to the selection of Machine Learning models.", "One such method is the Wilcoxon signed-rank test which is the non-parametric version of the paired Student\u2019s t-test. It can be used when the sample size is small and the data does not follow a normal distribution.", "We can apply this significance test for comparing two Machine Learning models. Using k-fold cross-validation we can create, for each model, k accuracy scores. This will result in two samples, one for each model.", "Then, we can use the Wilcoxon signed-rank test to test if the two samples differ significantly from each other. If they do, then one is more accurate than the other.", "Below, you can see an implementation of this procedure.", "The result will be a p-value. If that value is lower than 0.05 we can reject the null hypothesis that there are no significant differences between the models.", "NOTE: It is important that you keep the same folds between the models to make sure the samples are drawn from the same population. This is achieved by simply setting the same random_state in the cross-validation procedure.", "McNemar\u2019s test is used to check the extent to which the predictions between one model and another match. This is referred to as the homogeneity of the contingency table. From that table, we can calculate x\u00b2 which can be used to compute the p-value:", "Again, if the p-value is lower than 0.05 we can reject the null hypothesis and see that one model is significantly better than the other.", "We can use mlxtend package to create the table and calculate the corresponding p-value:", "The 5x2CV paired t-test is a method often used to compare Machine Learning models due to its strong statistical foundation.", "The method works as follows. Let\u2019s say we have two classifiers, A and B. We randomly split the data in 50% training and 50% test. Then, we train each model on the training data and compute the difference in accuracy between the models from the test set, called DiffA. Then, the training and test splits are reversed and the difference is calculated again in DiffB.", "This is repeated five times after which the mean variance of the differences is computed (S\u00b2). Then, it is used to calculate the t-statistic:", "Where DiffA\u2081 is the mean variance of the first iteration.", "Again, we can use themlxtend package to calculate the corresponding p-value:", "NOTE: You can use the combined 5x2CV F-test instead which was shown to be slightly more robust (Alpaydin, 1999). This method is implemented in mlxtend as from mlxtend.evluate import combined_ftest_5x2cv.", "Validation can be a tricky subject as it requires significant understanding of the data in order to select the correct procedure. Hopefully, this helped you get some feeling of the methods that are often used for validation.", "All code can be found here:", "If you are, like me, passionate about AI, Data Science, or Psychology, please feel free to add me on LinkedIn or follow me on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Psychologist. Passionate about anything AI-related! Get in touch: www.linkedin.com/in/mgrootendorst/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F25b4c8643fb7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maartengrootendorst?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maartengrootendorst?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": "Maarten Grootendorst"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22405c3b2875&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&user=Maarten+Grootendorst&userId=22405c3b2875&source=post_page-22405c3b2875----25b4c8643fb7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25b4c8643fb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25b4c8643fb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@neonbrand?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "NeONBRAND"}, {"url": "https://unsplash.com/s/photos/wrong?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://www.jondornart.com/", "anchor_text": "http://www.jondornart.com/"}, {"url": "https://github.com/PAIR-code/facets", "anchor_text": "Facets"}, {"url": "http://rasbt.github.io/mlxtend/installation/", "anchor_text": "mlxtend"}, {"url": "http://rasbt.github.io/mlxtend/installation/", "anchor_text": "mlxtend"}, {"url": "http://rasbt.github.io/mlxtend/user_guide/evaluate/combined_ftest_5x2cv/", "anchor_text": "Alpaydin, 1999"}, {"url": "https://github.com/MaartenGr/validation", "anchor_text": "MaartenGr/validationThis repo contains the code for the validation blog.github.com"}, {"url": "https://www.linkedin.com/in/mgrootendorst/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/MaartenGr", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----25b4c8643fb7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/validation?source=post_page-----25b4c8643fb7---------------validation-----------------", "anchor_text": "Validation"}, {"url": "https://medium.com/tag/data-science?source=post_page-----25b4c8643fb7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/modeling?source=post_page-----25b4c8643fb7---------------modeling-----------------", "anchor_text": "Modeling"}, {"url": "https://medium.com/tag/statistics?source=post_page-----25b4c8643fb7---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25b4c8643fb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&user=Maarten+Grootendorst&userId=22405c3b2875&source=-----25b4c8643fb7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25b4c8643fb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&user=Maarten+Grootendorst&userId=22405c3b2875&source=-----25b4c8643fb7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25b4c8643fb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F25b4c8643fb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----25b4c8643fb7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----25b4c8643fb7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maartengrootendorst?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maartengrootendorst?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maarten Grootendorst"}, {"url": "https://medium.com/@maartengrootendorst/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.5K Followers"}, {"url": "http://www.linkedin.com/in/mgrootendorst/", "anchor_text": "www.linkedin.com/in/mgrootendorst/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22405c3b2875&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&user=Maarten+Grootendorst&userId=22405c3b2875&source=post_page-22405c3b2875--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb052d90faf55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidating-your-machine-learning-model-25b4c8643fb7&newsletterV3=22405c3b2875&newsletterV3Id=b052d90faf55&user=Maarten+Grootendorst&userId=22405c3b2875&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}