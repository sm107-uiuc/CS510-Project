{"url": "https://towardsdatascience.com/the-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b", "time": 1683000156.710479, "path": "towardsdatascience.com/the-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b/", "webpage": {"metadata": {"title": "An Illustrated Guide to Bi-Directional Attention Flow (BiDAF) | by Meraldo Antonio | Towards Data Science", "h1": "An Illustrated Guide to Bi-Directional Attention Flow (BiDAF)", "description": "This article illustrates the workings of BiDAF, an NLP model that has pushed the envelope in the Question and Answer domain. Each step is elaborated and lots of pictures are included!"}, "outgoing_paragraph_urls": [{"url": "https://rajpurkar.github.io/SQuAD-explorer/", "anchor_text": "the Stanford Question and Answering Dataset (SQuAD)", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1802.05365", "anchor_text": "ELMo", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "BERT", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1611.01603", "anchor_text": "original BiDAF paper", "paragraph_index": 1}, {"url": "https://medium.com/@meraldo.antonio/the-definitive-guide-to-bidaf-part-2-word-embedding-character-embedding-and-contextual-c151fc4f05bb", "anchor_text": "part 2", "paragraph_index": 14}, {"url": "https://arxiv.org/abs/1611.01603", "anchor_text": "Bi-Directional Attention Flow for Machine Comprehension (Minjoon Seo et. al, 2017)", "paragraph_index": 15}, {"url": "https://www.linkedin.com/in/meraldo/", "anchor_text": "LinkedIn", "paragraph_index": 16}, {"url": "https://medium.com/@meraldo.antonio/membership", "anchor_text": "my referral link", "paragraph_index": 16}], "all_paragraphs": ["The year 2016 saw the publication of BiDAF by a team at University of Washington. BiDAF handily beat the best Q&A models at that time and for several weeks topped the leaderboard of the Stanford Question and Answering Dataset (SQuAD), arguably the most well-known Q&A dataset. Although BiDAF\u2019s performance has since been surpassed, the model remains influential in the Q&A domain. The technical innovation of BiDAF inspired the subsequent development of competing models such as ELMo and BERT, by which BiDAF was eventually dethroned.", "When I first read the original BiDAF paper, I was rather overwhelmed by how seemingly complex it was.", "BiDAF exhibits a modular architecture \u2014 think of it as a composite structure made out of lego blocks with the blocks being \u201cstandard\u201d NLP elements such as GloVe, CNN, LSTM and attention. The problem with understanding BiDAF is that there are just so many of these blocks to learn about and the ways they are combined can seem rather \u201chacky\u201d at times. This complexity, coupled with the rather convoluted notations used in the original paper, serves as a barrier to understanding the model.", "In this article series, I will deconstruct how BiDAF is assembled and describe each component of BiDAF in (hopefully) an easy-to-digest manner. Copious amount of pictures and diagrams will be provided to illustrate how these components fit together.", "Before delving deeper into BiDAF, let\u2019s first position it within the broader landscape of Q&A models. There are several ways with which a Q&A model can be logically classified. Here are some of them:", "So where does BiDAF fit in within these classification schemes? BiDAF is a closed-domain, extractive Q&A model that can only answer factoid questions. These characteristics imply that BiDAF requires a Context to answer a Query. The Answer that BiDAF returns is always a substring of the provided Context.", "Another quick note: as you may have noticed, I have been capitalizing the words \u201cContext\u201d, \u201cQuery\u201d and \u201cAnswer\u201d. This is intentional. These terms have both technical and non-technical meaning and the capitalization is my way of indicating that I am using these words in their specialized technical capacities.", "With this knowledge at hand, we\u2019re now ready to explore how BiDAF is structured. Let\u2019s dive in!", "BiDAF\u2019s ability to pinpoint the location of the Answer within a Context stems from its layered design. Each of these layers can be thought of as a transformation engine that transforms the vector representation of words; each transformation is accompanied by the inclusion of additional information.", "The BiDAF paper describes the model as having 6 layers, but I\u2019d like to think of BiDAF as having 3 parts instead. These 3 parts along with their functions are briefly described below.", "BiDAF has 3 embedding layers whose function is to change the representation of words in the Query and the Context from strings into vectors of numbers.", "These Query and Context representations then enter the attention and modeling layers. These layers use several matrix operations to fuse the information contained in the Query and the Context. The output of these steps is another representation of the Context that contains information from the Query. This output is referred to in the paper as the \u201cQuery-aware Context representation.\u201d", "The Query-aware Context representation is then passed into the output layer, which will transform it to a bunch of probability values. These probability values will be used to determine where the Answer starts and ends.", "A simplified diagram that depicts the BiDAF architecture is provided below:", "If all these don\u2019t make sense yet, don\u2019t worry; in the next articles, I will delve into each BiDAF component in detail. See you in part 2!", "[1] Bi-Directional Attention Flow for Machine Comprehension (Minjoon Seo et. al, 2017)", "If you have any comments about the article or would like to reach out to me, feel free to send me a connection through LinkedIn. Also, I\u2019d be very grateful if you could support me by becoming a Medium member through my referral link. As a member, you\u2019ll be able to read all my writings on data science and personal development and have full access to all stories on Medium.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist @ DBS \ud83c\uddf8\ud83c\uddec. Enthusiast of quantitative finance, operations research, MLOps, and Cloud Computing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd0e96e9e666b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@meraldo.antonio?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@meraldo.antonio?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": "Meraldo Antonio"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65b4354e2ed8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&user=Meraldo+Antonio&userId=65b4354e2ed8&source=post_page-65b4354e2ed8----d0e96e9e666b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0e96e9e666b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0e96e9e666b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/12ea-y_1-UE", "anchor_text": "Unsplash"}, {"url": "https://rajpurkar.github.io/SQuAD-explorer/", "anchor_text": "the Stanford Question and Answering Dataset (SQuAD)"}, {"url": "https://arxiv.org/abs/1802.05365", "anchor_text": "ELMo"}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "BERT"}, {"url": "https://arxiv.org/abs/1611.01603", "anchor_text": "original BiDAF paper"}, {"url": "https://medium.com/@meraldo.antonio/the-definitive-guide-to-bidaf-part-2-word-embedding-character-embedding-and-contextual-c151fc4f05bb", "anchor_text": "Part 2"}, {"url": "https://medium.com/@meraldo.antonio/the-definitive-guide-to-bidaf-part-3-attention-92352bbdcb07", "anchor_text": "Part 3"}, {"url": "https://towardsdatascience.com/modeling-and-output-layers-in-bidaf-an-illustrated-guide-with-minions-f2e101a10d83", "anchor_text": "Part 4"}, {"url": "https://www.ibm.com/watson", "anchor_text": "IBM-Watson"}, {"url": "https://medium.com/@meraldo.antonio/the-definitive-guide-to-bidaf-part-2-word-embedding-character-embedding-and-contextual-c151fc4f05bb", "anchor_text": "part 2"}, {"url": "https://arxiv.org/abs/1611.01603", "anchor_text": "Bi-Directional Attention Flow for Machine Comprehension (Minjoon Seo et. al, 2017)"}, {"url": "https://www.linkedin.com/in/meraldo/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/@meraldo.antonio/membership", "anchor_text": "my referral link"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d0e96e9e666b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d0e96e9e666b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----d0e96e9e666b---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d0e96e9e666b---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----d0e96e9e666b---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0e96e9e666b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&user=Meraldo+Antonio&userId=65b4354e2ed8&source=-----d0e96e9e666b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0e96e9e666b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&user=Meraldo+Antonio&userId=65b4354e2ed8&source=-----d0e96e9e666b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0e96e9e666b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd0e96e9e666b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d0e96e9e666b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d0e96e9e666b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@meraldo.antonio?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@meraldo.antonio?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Meraldo Antonio"}, {"url": "https://medium.com/@meraldo.antonio/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "367 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65b4354e2ed8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&user=Meraldo+Antonio&userId=65b4354e2ed8&source=post_page-65b4354e2ed8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff1745664aa6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-definitive-guide-to-bi-directional-attention-flow-d0e96e9e666b&newsletterV3=65b4354e2ed8&newsletterV3Id=f1745664aa6d&user=Meraldo+Antonio&userId=65b4354e2ed8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}