{"url": "https://towardsdatascience.com/predicting-hr-attrition-using-support-vector-machines-d8b4e82d5351", "time": 1683010175.97438, "path": "towardsdatascience.com/predicting-hr-attrition-using-support-vector-machines-d8b4e82d5351/", "webpage": {"metadata": {"title": "Predicting HR Attrition using Support Vector Machines | by Arpan Mishra | Towards Data Science", "h1": "Predicting HR Attrition using Support Vector Machines", "description": "Following my previous post, I will be covering how we can apply Support Vector Machines using python and Scikit-Learn on a real world dataset. This data was taken from a recent InClass hackathon\u2026"}, "outgoing_paragraph_urls": [{"url": "https://drive.google.com/drive/folders/1wKpNOY20UhyG0JQ_Y1L2Rp5bEH0Gft5V?usp=sharing", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html", "anchor_text": "pipelines", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "transformers", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html", "anchor_text": "documentation", "paragraph_index": 20}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "documentation", "paragraph_index": 26}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html", "anchor_text": "documentation", "paragraph_index": 28}, {"url": "https://www.kaggle.com/mishraboi/hr-attrition-prediction", "anchor_text": "Kaggle notebook", "paragraph_index": 33}], "all_paragraphs": ["Following my previous post, I will be covering how we can apply Support Vector Machines using python and Scikit-Learn on a real world dataset. This data was taken from a recent InClass hackathon hosted by IIT, Guwahati on Kaggle as part of their Summer Analytics 2020 capstone project, you can download it from here.", "In this post, you will see how easy it is to train and tune SVM and make them work for your problem statement. Using this I ranked 29th in the hackathon (top 4%) with very minimal pre-processing and feature engineering.", "Before we proceed, you must have an intuitive understanding of how SVM works. I would suggest you go through my previous post for an in-depth explanation of this algorithm.", "Now assuming that you understand the theory behind support vector machines \u2026", "As the COVID-19 keeps unleashing its havoc, the world continues to get pushed into the crisis of the great economic recession, more and more companies start to cut down their underperforming employees. Companies firing hundreds and thousands of Employees is a typical headline today. Cutting down employees or reducing an employee salary is a tough decision to take. It needs to be taken with utmost care as imprecision in the identification of employees whose performance is attriting may lead to sabotaging of both employees\u2019 career and the company\u2019s reputation in the market.", "Aim: To predict Employee Attrition by the given data about his/her past history.", "To preserve the original training data I have made a copy of it.", "We have 1628 observations and 29 features, out of which 22 are integers and 7 are objects. Some of the integer data type features might also be categorical. We have to predict Attrition which can either be 0 or 1 (1 if the employee left the company).", "Let's print out some statistics of our variables", "The weird thing to note here is that Behaviour has 0 standard deviation and mean=min=max = 1. This means that this columns has a value of 1 for all the observations, so we will drop it. We will also drop Id because it will have unique values for all the employees.", "On exploring a little further I found that the feature PerformanceRating has only two values, 3 or 4 so I have mapped them to 0 and 1 respectively.", "Let's check the distribution of our target variable Attrition.", "We have more or less a balanced distribution.", "Alright, so the data has 628 duplicates and all the duplicates correspond to Attrition 1. So that means that data was oversampled to make it balanced. We will drop the duplicates now and check the distribution again.", "Now our training data has 1000 data points and the target variable is imbalanced. There are many ways to tackle imbalanced data sets like upsampling or downsampling using SMOTE.", "We can also use a cross validation strategy such as stratified k-fold which keeps the distribution of our target variable (here Attrition) similar across the folds. The training and validation data is split using stratified sampling instead of random sampling. The stratas here are the two values of our target variable. If you don\u2019t understand what this means then don\u2019t worry about it just remember that it is an effective method to tackle imbalanced datasets while we train our model. You can learn more about it in the scikit-learn user guide for cross validation here.", "We will follow the following steps now:", "These are a lot of steps. Well, scikit-learn allows us to do all of this in a few simple lines of codes using pipelines and column transformers.", "So, first, we make a pipeline for pre-processing", "The variable categorical stores all column names of object data type features and numeric stores all the integer data type columns.", "Now we define the pipeline for the models and print out the cross validation scores of the different models. Using cross_val_score we can pass \u201cskf\u201d into \u201ccv\u201d parameter and it will take care of splitting iterating and calculating the scores for us. I have used \u2018roc_auc\u2019 as the scoring metric as the data is imbalanced. For a better understanding of the parameters for cross_val_score check out its documentation.", "Clearly, support vector classifier performs better than our tree based models. It is possible that Random Forest and XGBoost may perform better after removing more features and tuning but in this post we will use SVM.", "After One hot encoding we had 46 features in total in the dataset, as the dimensionality increases there is more chance of overfitting and there might be irrelevant features as well. So I decided to go with PCA to reduce the dimensionality.", "So, first I took 46 components and included PCA in our pipeline. I have visualised the cumulative explained variance.", "We can see that about 34 components explain 100% variance. So we take 34 components and fit our model.", "Our score has reduced by 0.01 but we have considerably reduced the dimensions and there is now higher chance that this model will perform better on unseen data.", "To squeeze out every bit of performance from the model, it is now time to tune our SVM model. we will use GridSearchCV for this if you`re not familiar with it take a look at the documentation.", "The parameters that can we tune are:", "There are more parameters but these are the important ones that affect performance, take a look at the scikit-learn documentation before going further.", "Tuning is also a very easy process with pipelines, we just define out parameter grid and pass the entire pipeline into grid search. I have not tuned kernel here. Since \u2018rbf\u2019 is the most used kernel and works for most of the tasks, I will just use it to save on some compute time. You can go ahead and try tuning kernel as well.", "You may have noticed that I have prepended \u2018svc__\u2019 in front of all the parameters in the parameter grid, that is done just to specify which step of our pipeline are we tuning in the grid search as we are not just passing an estimator into GridSearchCV but an entire pipeline. I`m sure there might be better ways to do this, let me know in the comments if you know of better techniques.", "We can try tuning our model further to find the best C by just tweaking the range of C and fixing the values of other hyperparameters like so", "The final mean validation score now is 0.8319. Time to make our submission on Kaggle.", "As you can see that my rank dropped 4 places once the private leader board was revealed. This happened because my model overfit on the training data, I should have probably not gone too crazy tuning \u201cC\u201d. Better feature selection might also help in improving the score. What do you think? Feel free to go through my Kaggle notebook and execute the code.", "Thank you if you stuck around till the end. I hope you found this post useful and learnt something new from this. Please provide valuable feedback in the comments, I would love to know your ideas on improving the performance.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd8b4e82d5351&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mishraarpan6?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mishraarpan6?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": "Arpan Mishra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fea811b84fa53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&user=Arpan+Mishra&userId=ea811b84fa53&source=post_page-ea811b84fa53----d8b4e82d5351---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8b4e82d5351&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8b4e82d5351&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ikukevk?utm_source=medium&utm_medium=referral", "anchor_text": "Kevin Ku"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://drive.google.com/drive/folders/1wKpNOY20UhyG0JQ_Y1L2Rp5bEH0Gft5V?usp=sharing", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/decoding-support-vector-machines-5b81d2f7b76f", "anchor_text": "Decoding Support Vector MachinesIntuitively understand how Support Vector Machines worktowardsdatascience.com"}, {"url": "https://imgflip.com/i/346y74", "anchor_text": "imgflip"}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html", "anchor_text": "pipelines"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "transformers"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html", "anchor_text": "documentation"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "documentation"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html", "anchor_text": "documentation"}, {"url": "https://www.kaggle.com/mishraboi/hr-attrition-prediction", "anchor_text": "Kaggle notebook"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d8b4e82d5351---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d8b4e82d5351---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----d8b4e82d5351---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd8b4e82d5351&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&user=Arpan+Mishra&userId=ea811b84fa53&source=-----d8b4e82d5351---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd8b4e82d5351&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&user=Arpan+Mishra&userId=ea811b84fa53&source=-----d8b4e82d5351---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8b4e82d5351&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd8b4e82d5351&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d8b4e82d5351---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d8b4e82d5351--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mishraarpan6?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mishraarpan6?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arpan Mishra"}, {"url": "https://medium.com/@mishraarpan6/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "26 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fea811b84fa53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&user=Arpan+Mishra&userId=ea811b84fa53&source=post_page-ea811b84fa53--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fea811b84fa53%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hr-attrition-using-support-vector-machines-d8b4e82d5351&user=Arpan+Mishra&userId=ea811b84fa53&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}