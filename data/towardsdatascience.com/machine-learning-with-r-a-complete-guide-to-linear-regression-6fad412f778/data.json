{"url": "https://towardsdatascience.com/machine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778", "time": 1683018191.365194, "path": "towardsdatascience.com/machine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778/", "webpage": {"metadata": {"title": "Machine Learning with R: A Complete Guide to Linear Regression | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Machine Learning with R: A Complete Guide to Linear Regression", "description": "Chances are you had some prior exposure to machine learning and statistics. Basically, that\u2019s all linear regression is \u2014 a simple statistics problem. Linear regression is a simple algorithm developed\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/aungpyaeap/fish-market", "anchor_text": "Fish Market", "paragraph_index": 18}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 30}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 32}], "all_paragraphs": ["Chances are you had some prior exposure to machine learning and statistics. Basically, that\u2019s all linear regression is \u2014 a simple statistics problem.", "Today you\u2019ll learn the different types of linear regression and how to implement all of them in R:", "Linear regression is a simple algorithm developed in the field of statistics. As the name suggests, linear regression assumes a linear relationship between the input variable(s) and a single output variable. Needless to say, the output variable (what you\u2019re predicting) has to be continuous. The output variable can be calculated as a linear combination of the input variables.", "There are two types of linear regression:", "You\u2019ll implement both today \u2014 simple linear regression from scratch and multiple linear regression with built-in R functions.", "You can use a linear regression model to learn which features are important by examining coefficients. If a coefficient is close to zero, the corresponding feature is considered to be less important than if the coefficient was a large positive or negative value.", "That\u2019s how the linear regression model generates the output. Coefficients are multiplied with corresponding input variables, and in the end, the bias (intercept) term is added.", "There\u2019s still one thing we should cover before diving into the code \u2014 assumptions of a linear regression model:", "You should be aware of these assumptions every time you\u2019re creating linear models. We\u2019ll ignore most of them for the purpose of this article, as the goal is to show you the general syntax you can copy-paste between the projects.", "If you have a single input variable, you\u2019re dealing with simple linear regression. It won\u2019t be the case most of the time, but it can\u2019t hurt to know. A simple linear regression can be expressed as:", "As you can see, there are two terms you need to calculate beforehand \u2014 betas.", "You\u2019ll first see how to calculate Beta1, as Beta0 depends on it. Here\u2019s the formula:", "And here\u2019s the formula for Beta0:", "These x\u2019s and y\u2019s with the bar over them represent the mean (average) of the corresponding variables.", "Let\u2019s see how all of this works in action. The code snippet below generates X with 300 linearly spaced numbers between 1 and 300, and generates Y as a value from the normal distribution centered just above the corresponding X value with a bit of noise added. Both X and Y are then combined into a single data frame and visualized as a scatter plot with the ggplot2 package:", "Onto the coefficient calculation now. The coefficients for Beta0 and Beta1 are obtained first, and then wrapped into a simple_lr_predict() function that implements the line equation.", "The predictions can then be obtained by applying the simple_lr_predict() function to the vector X \u2013 they should all line on a single straight line. Finally, input data and predictions are visualized with the ggplot2package:", "And that\u2019s how you can implement simple linear regression in R from scratch! Next, you\u2019ll learn how to handle situations when there are multiple input variables.", "You\u2019ll use the Fish Market dataset to build your model. To start, the goal is to load in the dataset and check if some of the assumptions hold. Normal distribution and outlier assumptions can be checked with boxplots.", "The code snippet below loads in the dataset and visualizes box plots for every feature (not the target):", "A degree of skew seems to be present in all input variables, and the first three contain a couple of outliers. We\u2019ll keep this article strictly machine learning based, so we won\u2019t do any data preparation and cleaning.", "Train/test split is the obvious next step once you\u2019re done with preparation. The caTools package is the perfect candidate for the job.", "You can train the model on the training set after the split. R has the lm function built-in, and it is used to train linear models. Inside the lm function, you\u2019ll need to write the target variable on the left and input features on the right, separated by the ~ sign. If you put a dot instead of feature names, it means you want to train the model on all features.", "After the model is trained, you can call the summary() function to see how well it performed on the training set. Here\u2019s a code snippet for everything discussed so far:", "The most interesting thing here is the P-values, displayed in the Pr(>|t|) column. Those values indicate the probability of a variable not being important for prediction. It\u2019s common to use a 5% significance threshold, so if a P-value is 0.05 or below, we can say that there\u2019s a low chance it is not significant for the analysis.", "Let\u2019s make a residuals plot next. As a general rule, if a histogram of residuals looks normally distributed, the linear model is as good as it can be. If not, it means you can improve it somehow. Here\u2019s the code for visualizing residuals:", "As you can see, there\u2019s a bit of skew present due to a large error on the far right.", "And now it\u2019s time to make predictions on the test set. You can use the predict() function to apply the model to the test set. As an additional step, you can combine actual values and predictions into a single data frame, just so the evaluation becomes easier. Here\u2019s how:", "If you want a more concrete way of evaluating your regression models, look no further than RMSE (Root Mean Squared Error). This metric will inform you how wrong your model is on average. In this case, it reports back the average number of weight units the model is wrong:", "The rmse variable holds the value of 83.60, indicating the model is on average wrong by 83.60 units of weight.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6fad412f778&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6fad412f778--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6fad412f778--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----6fad412f778--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----6fad412f778--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----6fad412f778---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6fad412f778&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6fad412f778&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jjying?utm_source=medium&utm_medium=referral", "anchor_text": "JJ Ying"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/aungpyaeap/fish-market", "anchor_text": "Fish Market"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://appsilon.com/r-linear-regression/", "anchor_text": "https://appsilon.com"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6fad412f778---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6fad412f778---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6fad412f778---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/r?source=post_page-----6fad412f778---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6fad412f778---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6fad412f778&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----6fad412f778---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6fad412f778&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----6fad412f778---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6fad412f778&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6fad412f778--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6fad412f778&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6fad412f778---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6fad412f778--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6fad412f778--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6fad412f778--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6fad412f778--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6fad412f778--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6fad412f778--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6fad412f778--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6fad412f778--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-a-complete-guide-to-linear-regression-6fad412f778&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}