{"url": "https://towardsdatascience.com/boruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a", "time": 1683004860.3289971, "path": "towardsdatascience.com/boruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a/", "webpage": {"metadata": {"title": "Boruta Explained Exactly How You Wished Someone Explained to You | by Samuele Mazzanti | Towards Data Science", "h1": "Boruta Explained Exactly How You Wished Someone Explained to You", "description": "Feature selection is a fundamental step in many machine learning pipelines. You dispose of a bunch of features and you want to select only the relevant ones and to discard the others. The aim is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Occam%27s_razor", "anchor_text": "Occam", "paragraph_index": 0}, {"url": "https://www.jstatsoft.org/article/view/v036i11", "anchor_text": "this", "paragraph_index": 1}, {"url": "https://github.com/scikit-learn-contrib/boruta_py", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://edition.cnn.com/2007/US/Careers/02/02/cb.tall.people/", "anchor_text": "height has been proven to be related to salary", "paragraph_index": 4}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFromModel.html#sklearn.feature_selection.SelectFromModel", "anchor_text": "SelectFromModel", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Binomial_distribution", "anchor_text": "binomial distribution", "paragraph_index": 23}], "all_paragraphs": ["Feature selection is a fundamental step in many machine learning pipelines. You dispose of a bunch of features and you want to select only the relevant ones and to discard the others. The aim is simplifying the problem by removing unuseful features which would introduce unnecessary noise (ever heard of Occam?).", "Boruta is a pretty smart algorithm dating back to 2010 designed to automatically perform feature selection on a dataset. It was born as a package for R (this is the article that first described it). A version of Boruta for Python \u2014 called BorutaPy \u2014 exists and can be found here.", "In this post, we will see some straightforward Python code for implementing Boruta from scratch \u2014 I believe that building something from scratch is the best way to really understand it \u2014 and, at the end of the post, we will see how to use BorutaPy to make our life easier.", "In order to see Boruta in action, let\u2019s build a toy dataset with 3 features (age, height and weight), a target variable (income) and 5 observations.", "So the goal is to predict the income of a person knowing his/her age, height and weight. This may seem nonsensical (at least in theory: in practice, height has been proven to be related to salary), but in general it\u2019s advisable not to be influenced by one\u2019s bias.", "In a real-life situation, we would have to deal with more than 3 features (from some hundreds to many thousands, typically). Thus, it would be unfeasible to go through each of them and decide whether to keep it or not. Moreover, there are relationships (such as non linear relationships and interactions) that are not easily spotted by a human eye, not even with accurate analysis.", "Ideally, we would like to find an algorithm that is able to autonomously decide whether any given feature of X bears some predictive value about y.", "A popular algorithm for feature selection is sklearn\u2019s SelectFromModel. Basically, you choose a model of convenience \u2014 capable of capturing non-linear relationships and interactions, e.g. a random forest \u2014 and you fit it on X and y. Then, you extract the importance of each feature from this model and keep only the features that are above a given threshold of importance.", "This sounds reasonable, but the weak spot of such an approach is self-evident: who determines the threshold, and how? There is a good deal of arbitrariness in it.", "When I first crashed into this problem, I started looking for a more robust solution. Until I found Boruta. Boruta is a feature selection algorithm which is statistically grounded and works extremely well even without any specific input by the user. How is that even possible?", "Boruta is based on two brilliant ideas.", "In Boruta, features do not compete among themselves. Instead \u2014 and this is the first brilliant idea \u2014 they compete with a randomized version of them.", "In practice, starting from X, another dataframe is created by randomly shuffling each feature. These permuted features are called shadow features. At this point, the shadow dataframe is attached to the original dataframe to obtain a new dataframe (we will call it X_boruta), which has twice the number of columns of X.", "This is how X_boruta would look like in our case:", "Then, a random forest is fitted on X_boruta and y.", "Now, we take the importance of each original features and compare it with a threshold. This time, the threshold is defined as the highest feature importance recorded among the shadow features. When the importance of a feature is higher than this threshold, this is called a \u201chit\u201d. The idea is that a feature is useful only if it\u2019s capable of doing better than the best randomized feature.", "The code to reproduce this process is the following", "For our toy dataset, the outcome is:", "Apparently, we should drop weight and get on with age and height. But should we trust this run? What if it was just an unlucky run for weight? What if instead it was just a lucky run for age and height?", "This is where the second brilliant idea of Boruta comes into play.", "As often happens in machine learning (in life?), the key is iteration. Not surprisingly, 20 trials are more reliable than 1 trial and 100 trials are more reliable than 20 trials.", "For instance, let\u2019s repeat for 20 times the process seen above.", "Now, how do we set a decision criterion? This is the second brilliant idea contained in Boruta.", "Let\u2019s take a feature (no matter if age, height or weight) and say we have absolutely no clue if it\u2019s useful or not. What is the probability that we shall keep it? The maximum level of uncertainty about the feature is expressed by a probability of 50%, like tossing a coin. Since each independent experiment can give a binary outcome (hit or no hit), a series of n trials follows a binomial distribution.", "In Python, the probability mass function of a binomial distibution can be computed as follows:", "These values look like a bell:", "In Boruta, there is not a hard threshold between a refusal and an acceptance area. Instead, there are 3 areas:", "The areas are defined by selecting the two most extreme portions of the distribution called tails of the distribution (in our example each tail accounts for 0.5% of the distribution).", "So, we did 20 iterations on our toy data and ended up with some statistically grounded conclusions:", "In this paragraph, we have implemented the necessary code, but a great (optimized) library for Boruta in Python exists.", "Boruta can be installed via pip:", "This is how it can be used:", "As you can see, the features stored in boruta.support_ are the ones that at some point ended up in the acceptance area, thus you should include them in your model. The features stored in boruta.support_weak_ are the ones that Boruta didn\u2019t manage to accept or refuse (blue area) and the choice is up to the data scientist: these features may be accepted or not depending on the use case.", "Feature selection is a decisive part of a machine learning pipeline: being too conservative means introducing unnecessary noise, while being too aggressive means throwing away useful information.", "In this post, we have seen how to use Boruta for performing a robust, statistically grounded feature selection on your dataset. Indeed, making substantial decisions about features is critical to ensure the success of your predictive model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Data Scientist | Striving for simplicity."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4489d70e154a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4489d70e154a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4489d70e154a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----4489d70e154a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=post_page-----4489d70e154a--------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03----4489d70e154a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4489d70e154a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4489d70e154a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Occam%27s_razor", "anchor_text": "Occam"}, {"url": "https://www.jstatsoft.org/article/view/v036i11", "anchor_text": "this"}, {"url": "https://github.com/scikit-learn-contrib/boruta_py", "anchor_text": "here"}, {"url": "https://edition.cnn.com/2007/US/Careers/02/02/cb.tall.people/", "anchor_text": "height has been proven to be related to salary"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFromModel.html#sklearn.feature_selection.SelectFromModel", "anchor_text": "SelectFromModel"}, {"url": "https://en.wikipedia.org/wiki/Binomial_distribution", "anchor_text": "binomial distribution"}, {"url": "https://medium.com/tag/feature-selection?source=post_page-----4489d70e154a---------------feature_selection-----------------", "anchor_text": "Feature Selection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4489d70e154a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4489d70e154a---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4489d70e154a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----4489d70e154a---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4489d70e154a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----4489d70e154a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4489d70e154a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=-----4489d70e154a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4489d70e154a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4489d70e154a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4489d70e154a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4489d70e154a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4489d70e154a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4489d70e154a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4489d70e154a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4489d70e154a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4489d70e154a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4489d70e154a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4489d70e154a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4489d70e154a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mazzanti.sam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samuele Mazzanti"}, {"url": "https://medium.com/@mazzanti.sam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe16f3bb86e03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=post_page-e16f3bb86e03--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce90f5bea5f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboruta-explained-the-way-i-wish-someone-explained-it-to-me-4489d70e154a&newsletterV3=e16f3bb86e03&newsletterV3Id=ce90f5bea5f9&user=Samuele+Mazzanti&userId=e16f3bb86e03&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}