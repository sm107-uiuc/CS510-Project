{"url": "https://towardsdatascience.com/how-to-connect-and-interact-with-search-applications-from-python-520118139f69", "time": 1683015841.81949, "path": "towardsdatascience.com/how-to-connect-and-interact-with-search-applications-from-python-520118139f69/", "webpage": {"metadata": {"title": "How to connect and interact with search applications from python | by Thiago G. Martins | Towards Data Science", "h1": "How to connect and interact with search applications from python", "description": "Vespa is the faster, more scalable and advanced search engine currently available, imho. It has a native tensor evaluation framework, can perform approximate nearest neighbor search and deploy the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://vespa.ai/", "anchor_text": "Vespa", "paragraph_index": 0}, {"url": "https://blog.vespa.ai/approximate-nearest-neighbor-search-in-vespa-part-1/", "anchor_text": "approximate nearest neighbor search", "paragraph_index": 0}, {"url": "https://blog.vespa.ai/efficient-open-domain-question-answering-on-vespa/", "anchor_text": "BERT models", "paragraph_index": 0}, {"url": "https://pyvespa.readthedocs.io/en/latest/index.html", "anchor_text": "pyvespa library", "paragraph_index": 1}, {"url": "https://cord19.vespa.ai/", "anchor_text": "CORD-19 search app", "paragraph_index": 2}, {"url": "https://colab.research.google.com/github/vespa-engine/pyvespa/blob/master/docs/sphinx/source/connect-to-vespa-instance.ipynb", "anchor_text": "Google Colab", "paragraph_index": 3}, {"url": "https://github.com/vespa-engine/pyvespa", "anchor_text": "Feedback and contributions", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.application.Vespa", "anchor_text": "Vespa", "paragraph_index": 6}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.Query", "anchor_text": "Query", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.Union", "anchor_text": "Union", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.WeakAnd", "anchor_text": "WeakAnd", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.ANN", "anchor_text": "ANN", "paragraph_index": 9}, {"url": "https://github.com/vespa-engine/sample-apps/blob/master/vespa-cloud/cord-19-search/src/main/application/schemas/doc.sd", "anchor_text": "application schema", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/query.ipynb", "anchor_text": "query page", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/collect-training-data.ipynb", "anchor_text": "collect training data page", "paragraph_index": 18}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.application.Vespa.collect_training_data", "anchor_text": "collect_training_data", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.Query", "anchor_text": "Query", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/evaluation.ipynb", "anchor_text": "evaluation page", "paragraph_index": 21}, {"url": "http://Vespa.ai", "anchor_text": "Vespa.ai", "paragraph_index": 24}], "all_paragraphs": ["Vespa is the faster, more scalable and advanced search engine currently available, imho. It has a native tensor evaluation framework, can perform approximate nearest neighbor search and deploy the latest developments in NLP modeling, such as BERT models.", "This post will give you an overview of the Vespa python API available through the pyvespa library. The main goal of the library is to allow for faster prototyping and to facilitate Machine Learning experiments for Vespa applications.", "We are going to connect to the CORD-19 search app and use it as an example here. You can later use your own application to replicate the following steps. Future posts will go deeper into each topic described in this overview tutorial.", "You can also run the steps contained here from Google Colab.", "Warning: The library is under active development and backward incompatible changes may occur. Feedback and contributions are welcome.", "The library is available at PyPI and therefore can be installed with pip.", "We can connect to a running Vespa application by creating an instance of Vespa with the appropriate url. The resulting app will then be used to communicate with the application.", "Easily define matching and ranking criteria", "When building a search application, we usually want to experiment with different query models. A Query model consists of a match phase and a ranking phase. The matching phase will define how to match documents based on the query sent and the ranking phase will define how to rank the matched documents. Both phases can get quite complex and being able to easily express and experiment with them is very valuable.", "In the example below we define the match phase to be the Union of the WeakAnd and the ANN operators. The WeakAnd will match documents based on query terms while the Approximate Nearest Neighbor (ANN) operator will match documents based on the distance between the query and document embeddings. This is an illustration of how easy it is to combine term and semantic matching in Vespa.", "We then define the ranking to be done by the bm25 rank-profile that is already defined in the application schema. We set list_features=True to be able to collect ranking-features later in this tutorial. After defining the match_phase and the rank_profile we can instantiate the Query model.", "Send queries via the query API. See the query page for more examples.", "We can use the query_model that we just defined to issue queries to the application via the query method.", "We can see the number of documents that were retrieved by Vespa:", "And the number of documents that were returned to us:", "We often need to either evaluate query models or to collect data to improve query models through ML. In both cases we usually need labelled data. Let\u2019s create some labelled data to illustrate their expected format and their usage in the library.", "Each data point contains a query_id, a query and relevant_docs associated with the query.", "Non-relevant documents are assigned \"score\": 0 by default. Relevant documents will be assigned \"score\": 1 by default if the field is missing from the labelled data. The defaults for both relevant and non-relevant documents can be modified on the appropriate methods.", "Collect training data to analyse and/or improve ranking functions. See the collect training data page for more examples.", "We can collect training data with the collect_training_data method according to a specific Query model. Below we will collect two documents for each query in addition to the relevant ones.", "Many rank features are returned by default. We can select some of them to inspect:", "Define metrics and evaluate query models. See the evaluation page for more examples.", "We will define the following evaluation metrics:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Working on Vespa.ai. Follow me on Twitter @Thiagogm"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F520118139f69&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----520118139f69--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----520118139f69--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tgmstat.medium.com/?source=post_page-----520118139f69--------------------------------", "anchor_text": ""}, {"url": "https://tgmstat.medium.com/?source=post_page-----520118139f69--------------------------------", "anchor_text": "Thiago G. Martins"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa578be8bee86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&user=Thiago+G.+Martins&userId=a578be8bee86&source=post_page-a578be8bee86----520118139f69---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F520118139f69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F520118139f69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pyvespa.readthedocs.io/en/latest/index.html", "anchor_text": "pyvespa"}, {"url": "https://vespa.ai/", "anchor_text": "Vespa"}, {"url": "https://blog.vespa.ai/approximate-nearest-neighbor-search-in-vespa-part-1/", "anchor_text": "approximate nearest neighbor search"}, {"url": "https://blog.vespa.ai/efficient-open-domain-question-answering-on-vespa/", "anchor_text": "BERT models"}, {"url": "https://pyvespa.readthedocs.io/en/latest/index.html", "anchor_text": "pyvespa library"}, {"url": "https://unsplash.com/@davidclode?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "David Clode"}, {"url": "https://unsplash.com/s/photos/python?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://cord19.vespa.ai/", "anchor_text": "CORD-19 search app"}, {"url": "https://colab.research.google.com/github/vespa-engine/pyvespa/blob/master/docs/sphinx/source/connect-to-vespa-instance.ipynb", "anchor_text": "Google Colab"}, {"url": "https://github.com/vespa-engine/pyvespa", "anchor_text": "Feedback and contributions"}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.application.Vespa", "anchor_text": "Vespa"}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.Query", "anchor_text": "Query"}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.Union", "anchor_text": "Union"}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.WeakAnd", "anchor_text": "WeakAnd"}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.ANN", "anchor_text": "ANN"}, {"url": "https://github.com/vespa-engine/sample-apps/blob/master/vespa-cloud/cord-19-search/src/main/application/schemas/doc.sd", "anchor_text": "application schema"}, {"url": "https://towardsdatascience.com/query.ipynb", "anchor_text": "query page"}, {"url": "https://towardsdatascience.com/collect-training-data.ipynb", "anchor_text": "collect training data page"}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.application.Vespa.collect_training_data", "anchor_text": "collect_training_data"}, {"url": "https://towardsdatascience.com/reference-api.rst#vespa.query.Query", "anchor_text": "Query"}, {"url": "https://towardsdatascience.com/evaluation.ipynb", "anchor_text": "evaluation page"}, {"url": "https://medium.com/tag/vespa?source=post_page-----520118139f69---------------vespa-----------------", "anchor_text": "Vespa"}, {"url": "https://medium.com/tag/pyvespa?source=post_page-----520118139f69---------------pyvespa-----------------", "anchor_text": "Pyvespa"}, {"url": "https://medium.com/tag/cord19?source=post_page-----520118139f69---------------cord19-----------------", "anchor_text": "Cord19"}, {"url": "https://medium.com/tag/search?source=post_page-----520118139f69---------------search-----------------", "anchor_text": "Search"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F520118139f69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&user=Thiago+G.+Martins&userId=a578be8bee86&source=-----520118139f69---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F520118139f69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&user=Thiago+G.+Martins&userId=a578be8bee86&source=-----520118139f69---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F520118139f69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----520118139f69--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F520118139f69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----520118139f69---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----520118139f69--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----520118139f69--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----520118139f69--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----520118139f69--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----520118139f69--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----520118139f69--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----520118139f69--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----520118139f69--------------------------------", "anchor_text": ""}, {"url": "https://tgmstat.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tgmstat.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thiago G. Martins"}, {"url": "https://tgmstat.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "96 Followers"}, {"url": "http://Vespa.ai", "anchor_text": "Vespa.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa578be8bee86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&user=Thiago+G.+Martins&userId=a578be8bee86&source=post_page-a578be8bee86--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd1c0d81e840f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-connect-and-interact-with-search-applications-from-python-520118139f69&newsletterV3=a578be8bee86&newsletterV3Id=d1c0d81e840f&user=Thiago+G.+Martins&userId=a578be8bee86&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}