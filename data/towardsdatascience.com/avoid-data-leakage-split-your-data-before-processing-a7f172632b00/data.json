{"url": "https://towardsdatascience.com/avoid-data-leakage-split-your-data-before-processing-a7f172632b00", "time": 1683001024.622999, "path": "towardsdatascience.com/avoid-data-leakage-split-your-data-before-processing-a7f172632b00/", "webpage": {"metadata": {"title": "Avoid Data Leakage \u2014 Split Your Data Before Processing | by Sun Weiran | Towards Data Science", "h1": "Avoid Data Leakage \u2014 Split Your Data Before Processing", "description": "Data leakage refers to the accidental sharing of information between training and testing datasets. This sharing of information will give the model a \u2018heads-up\u2019 about the testing dataset and generate\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Rule of thumb: Split your dataset into train and test sets before you do any processing to the data. Otherwise there might be data leakage that makes model evaluation overly optimistic.", "Some of you might have these experiences:", "These might happen due to Data Leakage.", "Data leakage refers to the accidental sharing of information between training and testing datasets. This sharing of information will give the model a \u2018heads-up\u2019 about the testing dataset and generate seemingly optimal evaluation scores. However, since the model overfits the testing data, it cannot predict accurately on future unseen datasets, i.e. Kaggle test data or production live data.", "One of the common causes of data leakage is due to train-test split after data processing.", "Assume we have the following dataset and want to use columns 1 and 2 to predict the target.", "The following steps are carried out in order:", "For step 1, value for Y is computed by 4 / 6, which indicates that there are 6 Ys in the dataset and 4 of them have positive targets. This information is accidentally shared between the training and testing datasets because the data is split after processing. At step 4, the model is trained from 4 Ys and will somehow \u2018expect\u2019 two Ys in the test data with one of it having a positive target. This will lead to an overly optimistic expectation of model performance.", "Similarly, for step 2, letter \u2018e\u2019 at row 5 is encoded as 5 because it understands the full dataset has \u2018a\u2019, \u2018b\u2019, \u2018c\u2019 and \u2018d\u2019. This information is also leaked between the training and testing data.", "The above mentioned issue has a tremendously negative impact, but the solution is simple \u2014 split before processing. Let use the same example but different steps:", "Note that Y is replaced with 0.75 because there are 4 Ys in training data and 3 of them have positive targets. Letter \u2018e\u2019 is encoded as 4 because there is no \u2018c\u2019 in training data. Testing data is assumed to be unseen before and follow similar patterns. Thus they are transformed with the same encoders fit from the training data.", "By splitting the data first, there are two major benefits:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa7f172632b00&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a7f172632b00--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a7f172632b00--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sunwrn?source=post_page-----a7f172632b00--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sunwrn?source=post_page-----a7f172632b00--------------------------------", "anchor_text": "Sun Weiran"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fedaaf0105f40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&user=Sun+Weiran&userId=edaaf0105f40&source=post_page-edaaf0105f40----a7f172632b00---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7f172632b00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7f172632b00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a7f172632b00---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a7f172632b00---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----a7f172632b00---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa7f172632b00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&user=Sun+Weiran&userId=edaaf0105f40&source=-----a7f172632b00---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa7f172632b00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&user=Sun+Weiran&userId=edaaf0105f40&source=-----a7f172632b00---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7f172632b00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a7f172632b00--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa7f172632b00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a7f172632b00---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a7f172632b00--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a7f172632b00--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a7f172632b00--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a7f172632b00--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a7f172632b00--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a7f172632b00--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a7f172632b00--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a7f172632b00--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sunwrn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sunwrn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sun Weiran"}, {"url": "https://medium.com/@sunwrn/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "122 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fedaaf0105f40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&user=Sun+Weiran&userId=edaaf0105f40&source=post_page-edaaf0105f40--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc88b76ff5c64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-data-leakage-split-your-data-before-processing-a7f172632b00&newsletterV3=edaaf0105f40&newsletterV3Id=c88b76ff5c64&user=Sun+Weiran&userId=edaaf0105f40&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}