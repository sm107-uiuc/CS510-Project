{"url": "https://towardsdatascience.com/setup-mlflow-in-production-d72aecde7fef", "time": 1683001177.998945, "path": "towardsdatascience.com/setup-mlflow-in-production-d72aecde7fef/", "webpage": {"metadata": {"title": "Setup MLflow in Production. MLflow is an open-source platform for\u2026 | by Sumeet Gyanchandani | Towards Data Science", "h1": "Setup MLflow in Production", "description": "MLflow is an open-source platform for machine learning lifecycle management. Recently, I set up MLflow in production with a Postgres database as a Tracking Server and SFTP for the transfer of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@gyani91/mlflow-basic-logging-functions-e16cdea047b", "anchor_text": "next post", "paragraph_index": 27}], "all_paragraphs": ["This is the first article in my MLflow tutorial series:", "MLflow is an open-source platform for machine learning lifecycle management. Recently, I set up MLflow in production with a Postgres database as a Tracking Server and SFTP for the transfer of artifacts over the network. It took me about 2 weeks to get all the components right but this post would help you setup of MLflow in a production environment in about 10 minutes.", "Tracking Server stores the metadata that you see in the MLflow UI. First, let\u2019s create a new Conda environment:", "Install the MLflow and PySFTP libraries:", "Our Tracking Server uses a Postgres database as a backend for storing the metadata. So let\u2019s install PostgreSQL:", "Next, we will create the admin user and a database for the Tracking Server", "As we\u2019ll need to interact with Postgres from Python, it is needed to install the psycopg2 library. However, to ensure a successful installation we need to install the GCC Linux package before:", "If you would like to connect to the PostgreSQL Server remotely or would like to give its access to the users. You can", "Then add the following line at the end of the postgresql.conf file.", "You can then specify a remote IP from which you want to allow connection to the PostgreSQL Server, by adding the following line at the end of the pg_hba.conf file", "The next step is creating a directory for our Tracking Server to log the Machine Learning models and other artifacts. Remember that the Postgres database is only used for storing metadata regarding those models. This directory is called artifact URI.", "You can run the Tracking Server with the following command. But as soon as you do Ctrl-C or exit the terminal the server stops.", "If you want the Tracking server to be up and running after restarts and be resilient to failures, it is very useful to run it as a systemd service.", "You need to go into the /etc/systemd/system directory and create a new file called mlflow-tracking.service with the following content:", "Activate and enable the above service with the following commands:", "Check that everything worked as expected with the following command:", "You should see an output similar to this:", "Create user for the server named mlflow_user and make mlflow directory as the working directory for this user. Then create an ssh-key pair in the .ssh directory for the mlflow_user (/mlflow/.ssh in our case). Put the public key in the authorized_keys file and share the private key with the users.", "Additionally, for the MLflow UI to be able to read the artifacts, copy the private key to /root/.ssh/ as well.", "Next, we need to create the Host Key for the server manually using this command:", "You can now restart the machine and the MLflow Tracking Server will be up and running after this restart.", "In order to start tracking everything under the production Tracking Server, it is necessary to set the following environment variable in your .bashrc.", "Do not forget to source your .bashrc file!", "Make sure you install pip packages for mlflow and pysftp in your environment (pysftp is required to facilitate the transfer of artifacts to the production server).", "To be able to authenticate the pysftp transfers, put the private key generated on the Production Server in the .ssh directory of your local machine . Then do", "When prompted to save <hostname_of_server> as a known host, answer yes.", "Run a sample machine learning model from the internet to check whether MLflow can track the runs.", "In the next post, I\u2019ll speak about basic MLflow logging functions", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Associate Director at UBS | Former Machine Learning Engineer at Apple, Microsoft Research, Nomoko, Credit Suisse | Master of Science in Artificial Intelligence"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd72aecde7fef&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gyani91?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gyani91?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": "Sumeet Gyanchandani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bea8130eb19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&user=Sumeet+Gyanchandani&userId=5bea8130eb19&source=post_page-5bea8130eb19----d72aecde7fef---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd72aecde7fef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd72aecde7fef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://mlflow.org", "anchor_text": "https://mlflow.org"}, {"url": "https://medium.com/@gyani91/setup-mlflow-in-production-d72aecde7fef", "anchor_text": "Setup MLflow in Production"}, {"url": "https://medium.com/@gyani91/mlflow-basic-logging-functions-e16cdea047b", "anchor_text": "MLflow: Basic logging functions"}, {"url": "https://medium.com/@gyani91/mlflow-logging-for-tensorflow-37b6a6a53e3c", "anchor_text": "MLflow logging for TensorFlow"}, {"url": "https://medium.com/@gyani91/mlflow-projects-24c41b00854", "anchor_text": "MLflow Projects"}, {"url": "https://medium.com/@gyani91/retrieving-the-best-model-using-python-api-for-mlflow-7f76bf503692", "anchor_text": "Retrieving the best model using Python API for MLflow"}, {"url": "https://medium.com/@gyani91/serving-a-model-using-mlflow-8ba5db0a26c0", "anchor_text": "Serving a model using MLflow"}, {"url": "https://www.anaconda.com/distribution/", "anchor_text": "Anaconda"}, {"url": "http://nmkzh-testing-001.nomoko.lan:7000", "anchor_text": "http://<hostname_of_server>:8000"}, {"url": "https://medium.com/@gyani91/mlflow-basic-logging-functions-e16cdea047b", "anchor_text": "next post"}, {"url": "https://www.mlflow.org/docs/latest/quickstart.html#installing-mlflow", "anchor_text": "Installing MLflow"}, {"url": "https://medium.com/tag/mlflow?source=post_page-----d72aecde7fef---------------mlflow-----------------", "anchor_text": "Mlflow"}, {"url": "https://medium.com/tag/postgres?source=post_page-----d72aecde7fef---------------postgres-----------------", "anchor_text": "Postgres"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d72aecde7fef---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d72aecde7fef---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----d72aecde7fef---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd72aecde7fef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&user=Sumeet+Gyanchandani&userId=5bea8130eb19&source=-----d72aecde7fef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd72aecde7fef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&user=Sumeet+Gyanchandani&userId=5bea8130eb19&source=-----d72aecde7fef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd72aecde7fef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd72aecde7fef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d72aecde7fef---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d72aecde7fef--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d72aecde7fef--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d72aecde7fef--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d72aecde7fef--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gyani91?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gyani91?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sumeet Gyanchandani"}, {"url": "https://medium.com/@gyani91/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "102 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bea8130eb19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&user=Sumeet+Gyanchandani&userId=5bea8130eb19&source=post_page-5bea8130eb19--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F39b4f0292d99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsetup-mlflow-in-production-d72aecde7fef&newsletterV3=5bea8130eb19&newsletterV3Id=39b4f0292d99&user=Sumeet+Gyanchandani&userId=5bea8130eb19&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}