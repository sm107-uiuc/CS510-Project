{"url": "https://towardsdatascience.com/walkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9", "time": 1683001337.3247092, "path": "towardsdatascience.com/walkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9/", "webpage": {"metadata": {"title": "Walkthrough: Mapping Basics with bokeh and GeoPandas in Python | by Rebecca Weng | Towards Data Science", "h1": "Walkthrough: Mapping Basics with bokeh and GeoPandas in Python", "description": "My goal this week was to learn how to make an interactive map and then to create a tutorial on how to make that map. Maps can be really useful in visualizing geographical data and change over time\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/rweng18/bokeh_map", "anchor_text": "my GitHub repo", "paragraph_index": 2}, {"url": "http://geopandas.org/install.html", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://docs.bokeh.org/en/latest/docs/gallery.html", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://docs.bokeh.org/en/latest/docs/user_guide/quickstart.html#userguide-quickstart", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://docs.bokeh.org/en/latest/docs/installation.html", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://www.census.gov/geographies/mapping-files/time-series/geo/carto-boundary-file.html", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://www.census.gov/newsroom/press-kits/2018/pop-estimates-national-state.html", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://www.waterqualitydata.us/", "anchor_text": "Water Quality Data", "paragraph_index": 19}, {"url": "https://docs.bokeh.org/en/latest/docs/reference/models/sources.html", "anchor_text": "here", "paragraph_index": 22}], "all_paragraphs": ["My goal this week was to learn how to make an interactive map and then to create a tutorial on how to make that map. Maps can be really useful in visualizing geographical data and change over time. They can provide a nice way to literally zoom out and see macro-level changes. First, I will provide an overview of the two main packages used: GeoPandas and bokeh. Then I will walk through how to get from a particular dataset to a particular interactive map. The map created is by no means complete or perfect. So in conclusion, I will go over some potential improvements, and provide a list of resources of where I found my information and some starting points if you are interested in bokeh, GeoPandas, or interactive mapping.", "This blog post was inspired by a variety of posts about mapping and visualization. All sources used for inspiration and other helpful links are posted below in the resources section.", "Code can be found on my GitHub repo.", "GeoPandas is an open-source package that helps users work with geospatial data. GeoPandas has a number of dependencies. The one that we will focus on is the package, shapely, on which GeoPandas relies on performing geometric operations. In our case, the shape of each US state will be encoded as a polygon or multipolygon via the shapely package. Then used through GeoPandas to understand the geospatial data.", "In order for GeoPandas to run, it needs a few packages already installed. It can be difficult to ensure this. But if you are sure, you can install it with pip. Otherwise, using Anaconda to install GeoPandas will take care of the dependencies for you.", "You can read more about installing GeoPandas here.", "While GeoPandas does allow for plotting, bokeh allows us to create more complex plots. bokeh is a multifunctional, open-source package meant to help users create beautiful, interactive visualizations. Bokeh was first released in April 2013, and the latest release was in October 2019. Following this last release, Python 2.7, Python 3.5 or earlier will no longer be supported. A full gallery of the plots you can make in Bokeh can be found here.", "bokeh relies on several packages. You can still use pip to install Bokeh, but you may run into issues in terms of dependencies. In my case, I used Anaconda to install bokeh, as it takes care of making sure the dependencies are in order.", "More details for installation can be found here and here.", "Create a map of the contiguous US that shows the state population. Within each state, show where lead was found in 2018.", "In order to create a map, you will need a shapefile (.shp). In this case, I downloaded a shapefile from the US Census Bureau here. The file tells Geopandas what shapes we are mapping out. In our case, we need a file that outlines each state in the contiguous US. We use a geometry column so that the Geopandas package knows where to look for information for the shapes of each state. The shapes are shapely Polygon objects in this case.", "Running the following line of code in a Jupyter Notebook will return an image of Maryland.", "But we can cast the geometry element as a string to see how the shapely geometry object is represented:", "Returns a long string that represents the many polygons that make up Maryland:", "Now that we have an idea of how we will map out the US, we need to combine the geometry of each state with the data we want to plot. In this case, we need to connect each state to its population in 2018. You can find US population estimates by state and year here through the US Census Bureau.", "Now we know that both the shapefile and the state population csv have a column called \u201cNAME\u201d that we can match together. So now we can merge the files using pandas.", "Now that we have merged the data and limited it to the contiguous USA, we can convert the data to a format that is conducive to mapping:", "Now that the data has been converted to the appropriate format, we can plot the map of state populations using the following steps:", "Now that we\u2019ve created the map, we can add a color bar that will indicate the state population.", "Now that we have the basic map down, we can add information about the water sites where lead was found. The data I used was from Water Quality Data. From the data available, I downloaded two datasets:", "After we\u2019ve loaded in the data, we need to examine and clean the data. In this case, get rid of points with no results for lead, or 0 ug/l of lead. In this case, we only want to plot sites where the test was measured in ug/l or mg/l. We convert the mg/l to ug/l to have consistent units.", "After cleaning the data, we can merge the water sites with the lead samples. Then we sort the sites, drop any duplicates, matching on both the site and the day. Then we can subset for water sites that are within the contiguous USA based on latitude and longitude. We then create a month column for plotting purposes. Finally, we create a geometry row by creating shapely geometry Point objects", "Now that we have created a suitable geometry column, we can specify the coordinate reference system (crs) and convert the data to a geodataframe. Then we extract the x and y coordinates for plotting purposes and convert to a columndatasource. More information on bokeh data sources can be found here.", "There are a lot of data points (10,000+) and it might make more sense to view the data by time period. So for this example, I divided the data by month, and created a slider tool so that you can view every water site during any month in 2018.", "Now that we have created the slider object, we need to update it based on user input. We do this by writing a callback function and a CustomJSFilter.", "Now that we have written our functions, we can plot the water sampling sites, a hover tool for the sites, as well as the slider.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Technical writer & tech enthusiast making the complex accessible | @Princeton Sociology UG \u201918 | @FlatironSchool DS NYC | Bookworm | Foodie"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F43f40aa5b7e9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rweng18?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rweng18?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": "Rebecca Weng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52f42f78df5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&user=Rebecca+Weng&userId=52f42f78df5a&source=post_page-52f42f78df5a----43f40aa5b7e9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F43f40aa5b7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F43f40aa5b7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/rweng18/bokeh_map", "anchor_text": "my GitHub repo"}, {"url": "http://geopandas.org/install.html", "anchor_text": "here"}, {"url": "https://docs.bokeh.org/en/latest/docs/gallery.html", "anchor_text": "here"}, {"url": "https://docs.bokeh.org/en/latest/docs/user_guide/quickstart.html#userguide-quickstart", "anchor_text": "here"}, {"url": "https://docs.bokeh.org/en/latest/docs/installation.html", "anchor_text": "here"}, {"url": "https://www.census.gov/geographies/mapping-files/time-series/geo/carto-boundary-file.html", "anchor_text": "here"}, {"url": "https://www.census.gov/newsroom/press-kits/2018/pop-estimates-national-state.html", "anchor_text": "here"}, {"url": "https://www.waterqualitydata.us/", "anchor_text": "Water Quality Data"}, {"url": "https://docs.bokeh.org/en/latest/docs/reference/models/sources.html", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/a-complete-guide-to-an-interactive-geographical-map-using-python-f4c5197e23e0", "anchor_text": "\u201cA Complete Guide to an Interactive Geographical Map using Python.\u201d Towards Data Science (Shivangi Patel, Feb. 5, 2019)"}, {"url": "https://docs.bokeh.org/en/latest/docs/user_guide/interaction/widgets.html", "anchor_text": "\u201cAdding Widgets.\u201d Bokeh Documentation."}, {"url": "https://docs.bokeh.org/en/latest/docs/reference/models/filters.html#bokeh.models.filters.CustomJSFilter", "anchor_text": "\u201cbokeh.models.filters.\u201d Bokeh Documentation."}, {"url": "https://docs.bokeh.org/en/latest/docs/reference/models/sources.html", "anchor_text": "\u201cbokeh.models.sources.\u201d Bokeh Documentation."}, {"url": "http://geopandas.org/index.html", "anchor_text": "GeoPandas Documentation"}, {"url": "https://towardsdatascience.com/geopandas-101-plot-any-data-with-a-latitude-and-longitude-on-a-map-98e01944b972", "anchor_text": "\u201cGeoPandas 101: Plot any data with a latitude and longitude on a map.\u201d (Ryan Stewart, Oct. 31, 2018)"}, {"url": "https://stackoverflow.com/questions/46420266/how-to-use-a-slider-callback-to-filter-a-columndatasource-in-bokeh-using-python", "anchor_text": "How to use a slider callback to filter a ColumnDataSource in Bokeh using Python 3? Stack Overflow."}, {"url": "https://automating-gis-processes.github.io/2016/Lesson5-interactive-map-bokeh.html", "anchor_text": "\u201cInteractive maps with Bokeh.\u201d University of Helsinki."}, {"url": "https://docs.bokeh.org/en/latest/docs/user_guide/interaction/callbacks.html#userguide-interaction-jscallbacks", "anchor_text": "\u201cJavascript Callbacks.\u201d Bokeh Documentation."}, {"url": "https://shapely.readthedocs.io/en/stable/manual.html#", "anchor_text": "The Shapely User Manual"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----43f40aa5b7e9---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/geospatial?source=post_page-----43f40aa5b7e9---------------geospatial-----------------", "anchor_text": "Geospatial"}, {"url": "https://medium.com/tag/data-science?source=post_page-----43f40aa5b7e9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----43f40aa5b7e9---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/python?source=post_page-----43f40aa5b7e9---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F43f40aa5b7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&user=Rebecca+Weng&userId=52f42f78df5a&source=-----43f40aa5b7e9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F43f40aa5b7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&user=Rebecca+Weng&userId=52f42f78df5a&source=-----43f40aa5b7e9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F43f40aa5b7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F43f40aa5b7e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----43f40aa5b7e9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----43f40aa5b7e9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rweng18?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rweng18?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rebecca Weng"}, {"url": "https://medium.com/@rweng18/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "186 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52f42f78df5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&user=Rebecca+Weng&userId=52f42f78df5a&source=post_page-52f42f78df5a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F36227475c63f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwalkthrough-mapping-basics-with-bokeh-and-geopandas-in-python-43f40aa5b7e9&newsletterV3=52f42f78df5a&newsletterV3Id=36227475c63f&user=Rebecca+Weng&userId=52f42f78df5a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}