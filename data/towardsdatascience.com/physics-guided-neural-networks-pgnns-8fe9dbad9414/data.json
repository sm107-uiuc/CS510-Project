{"url": "https://towardsdatascience.com/physics-guided-neural-networks-pgnns-8fe9dbad9414", "time": 1682994146.201243, "path": "towardsdatascience.com/physics-guided-neural-networks-pgnns-8fe9dbad9414/", "webpage": {"metadata": {"title": "Physics-guided Neural Networks (PGNNs) | by Mehmet Alican Noyan | Towards Data Science", "h1": "Physics-guided Neural Networks (PGNNs)", "description": "Data + Physics = The Ultimate Algorithm"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1710.11431", "anchor_text": "Physics-guided Neural Networks (PGNN): An Application in Lake Temperature Modeling", "paragraph_index": 1}, {"url": "http://aed.see.uwa.edu.au/research/models/GLM/", "anchor_text": "general lake model (GLM)", "paragraph_index": 8}, {"url": "https://twitter.com/malicannoyan", "anchor_text": "@malicannoyan", "paragraph_index": 15}, {"url": "https://arxiv.org/abs/1612.08544", "anchor_text": "Theory-guided Data Science: A New Paradigm for Scientific Discovery from Data", "paragraph_index": 16}, {"url": "https://arxiv.org/abs/1711.10561", "anchor_text": "Physics Informed Deep Learning (Part I): Data-driven Solutions of Nonlinear Partial Differential Equations", "paragraph_index": 17}, {"url": "http://www.ipsumio.com", "anchor_text": "www.ipsumio.com", "paragraph_index": 19}], "all_paragraphs": ["When machine learning algorithms are learning, they are actually searching for a solution in the hypothesis space you defined by your choice of algorithm, architecture, and configuration. Hypothesis space could be quite large even for a fairly simple algorithm. Data is the only guide we use to look for a solution in this huge space. What if we can use our knowledge of the world \u2014 for example, physics\u2014 together with data to guide this search?", "This is what Karpatne et al. explained in their paper Physics-guided Neural Networks (PGNN): An Application in Lake Temperature Modeling. In this post, I will explain why this idea is crucial and I will also describe how they did it by summarizing the paper.", "Imagine you have sent your alien \ud83d\udc7d friend (optimization algorithm) to a supermarket (hypothesis space) to buy your favorite cheese (solution). The only clue she has is the picture of the cheese (data) you gave her. Since she lacks the preconceptions we have about supermarkets she will have a hard time finding the cheese. She might wander around cosmetics, cleaning supplies before even reaching the food section.", "This is similar to how machine learning optimization algorithms like gradient descent look for a hypothesis. Data is the only guide. Ideally, this should work just fine but most of the time the data is noisy or not enough. Incorporating our knowledge into the optimization algorithms \u2014 search for the cheese in the food section, don\u2019t even look at the cosmetics \u2014 could alleviate these challenges. Let\u2019s see next, how we can actually do this.", "Now, let me summarize how the authors utilize physics to guide a machine learning model. They present two approaches for this: (1) using physics theory, they calculate additional features (feature engineering) to feed into the model along with the measurements and (2) they add a physical inconsistency term to the loss function in order to punish physically inconsistent predictions.", "The first approach, feature engineering, is extensively used in machine learning. The second approach, however, is compelling. Very much like adding a regularization term to punish overfitting, they add a physical inconsistency term to the loss function. Hence, with this new term, the optimization algorithm should also take care of minimizing physically inconsistent results.", "In the paper, Karpatne et al. combined these two approaches with a neural network and demonstrated an algorithm they call physics-guided neural network (PGNN). There are two main advantages PGNNs could provide:", "In the paper, lake temperature modeling is given as an example to demonstrate the effectiveness of the PGNN. Water temperature controls the growth, survival, and reproduction of biological species living in the lake. Therefore accurate observations and predictions of temperature are crucial for understanding the changes occurring in the community. The task is to develop a model that can predict the water temperature as a function of depth and time, for a given lake. Now let\u2019s see how they applied (1) feature engineering and (2) loss function modification for this problem.", "(1) For feature engineering, they used a model called the general lake model (GLM) to generate new features and feed them into the NN. It is a physics-based model that captures the processes governing the dynamics of temperature in a lake (heating due to sun, evaporation etc.).", "(2) Let\u2019s now see how they defined this physical inconsistency term. It is known that denser water sinks. The relationship between water temperature and its density is also known. Hence predictions should follow the fact that the deeper the point, the higher the predicted density. If for a pair of points, the model predicts higher density for the point closer to the surface, this is a physically inconsistent prediction.", "Now it is possible to incorporate this idea into the loss function. We would like to punish if \u03c1A> \u03c1B and do nothing otherwise. Moreover, for a larger inconsistency, the punishment should be higher. This can be done easily by adding the value of the function max( \u03c1A- \u03c1B, 0) to the loss function. If \u03c1A> \u03c1B (i.e. inconsistency), the function will give a positive value that will increase the value of the loss function (the function we are trying to minimize), otherwise it will give zero leaving the loss function unchanged.", "At this point, two modifications are necessary to the function in order to use it properly. What is important is the average inconsistency of all the pairs, not one single pair. Therefore it is possible to sum max( \u03c1A- \u03c1B, 0) for all points and divide by the number of points. Also, it is critical to control the relative importance of minimizing physical inconsistency. This can be done by multiplying the average physical inconsistency with a hyperparameter (works like the regularization parameter).", "Here are the results of 4 models. They are:", "Comparing NN with the PHY we can conclude that NN gives more accurate predictions at the expense of physically inconsistent results. Comparing PGNN0 and PGNN we can see that physical inconsistency is eliminated mostly thanks to the modified loss function. Improved accuracy is mostly due to feature engineering with some contribution from the loss function.", "To sum things up, these first results show us that this new type of algorithm, PGNN, is very promising for providing accurate and physically consistent results. Moreover, incorporating our knowledge of the world into the loss function provides an elegant way to improve the generalization performance of machine learning models. This seemingly simple idea has the potential to fundamentally improve the way we conduct machine learning and scientific research.", "You can find me on Twitter @malicannoyan.", "Further readingTheory-guided Data Science: A New Paradigm for Scientific Discovery from Data", "Physics Informed Deep Learning (Part I): Data-driven Solutions of Nonlinear Partial Differential Equations", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Founder and data scientist at www.ipsumio.com. I\u2019m here to understand and share intuitive aspects of machine learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8fe9dbad9414&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@m.alican.noyan?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.alican.noyan?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": "Mehmet Alican Noyan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6ecb3248310a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&user=Mehmet+Alican+Noyan&userId=6ecb3248310a&source=post_page-6ecb3248310a----8fe9dbad9414---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8fe9dbad9414&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8fe9dbad9414&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1710.11431", "anchor_text": "Physics-guided Neural Networks (PGNN): An Application in Lake Temperature Modeling"}, {"url": "https://www.instagram.com/dom_l_garcia_/", "anchor_text": "Dominic L. Garcia"}, {"url": "https://developers.google.com/machine-learning/crash-course/generalization/video-lecture", "anchor_text": "Achieving generalization"}, {"url": "https://en.wikipedia.org/wiki/Explainable_Artificial_Intelligence", "anchor_text": "Explainable AI (XAI)"}, {"url": "http://aed.see.uwa.edu.au/research/models/GLM/", "anchor_text": "general lake model (GLM)"}, {"url": "https://twitter.com/malicannoyan", "anchor_text": "@malicannoyan"}, {"url": "https://arxiv.org/abs/1612.08544", "anchor_text": "Theory-guided Data Science: A New Paradigm for Scientific Discovery from Data"}, {"url": "https://arxiv.org/abs/1711.10561", "anchor_text": "Physics Informed Deep Learning (Part I): Data-driven Solutions of Nonlinear Partial Differential Equations"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8fe9dbad9414---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/science?source=post_page-----8fe9dbad9414---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8fe9dbad9414---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----8fe9dbad9414---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----8fe9dbad9414---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8fe9dbad9414&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&user=Mehmet+Alican+Noyan&userId=6ecb3248310a&source=-----8fe9dbad9414---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8fe9dbad9414&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&user=Mehmet+Alican+Noyan&userId=6ecb3248310a&source=-----8fe9dbad9414---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8fe9dbad9414&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8fe9dbad9414&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8fe9dbad9414---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8fe9dbad9414--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.alican.noyan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.alican.noyan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mehmet Alican Noyan"}, {"url": "https://medium.com/@m.alican.noyan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "316 Followers"}, {"url": "http://www.ipsumio.com", "anchor_text": "www.ipsumio.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6ecb3248310a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&user=Mehmet+Alican+Noyan&userId=6ecb3248310a&source=post_page-6ecb3248310a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa2eb8d9b2f66&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fphysics-guided-neural-networks-pgnns-8fe9dbad9414&newsletterV3=6ecb3248310a&newsletterV3Id=a2eb8d9b2f66&user=Mehmet+Alican+Noyan&userId=6ecb3248310a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}