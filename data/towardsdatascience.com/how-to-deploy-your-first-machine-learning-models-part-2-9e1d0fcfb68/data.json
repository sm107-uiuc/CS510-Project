{"url": "https://towardsdatascience.com/how-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68", "time": 1683016335.6743412, "path": "towardsdatascience.com/how-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68/", "webpage": {"metadata": {"title": "How to deploy your first Machine learning models \u2014 Part#2 | by Salma El Shahawy | Towards Data Science", "h1": "How to deploy your first Machine learning models \u2014 Part#2", "description": "Deploy the Machine Learning API to Heroku using the CircleCI pipeline with fewer command. Docker configurations included"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/exclusive-how-to-deploy-your-first-machine-learning-models-bf0a2109e522", "anchor_text": "In the previous post", "paragraph_index": 0}, {"url": "https://github.com/salma71/prediction_app", "anchor_text": "project repo at Github", "paragraph_index": 2}, {"url": "https://www.fullstackpython.com/api-creation.html", "anchor_text": "here is a great resource to learn API", "paragraph_index": 5}, {"url": "https://programminghistorian.org/en/lessons/creating-apis-with-python-and-flask", "anchor_text": "well as this guide", "paragraph_index": 5}, {"url": "https://realpython.com/flask-connexion-rest-api/", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://realpython.com/the-model-view-controller-mvc-paradigm-summarized-with-legos/", "anchor_text": "check this guide", "paragraph_index": 7}, {"url": "https://www.tutorialspoint.com/python_design_patterns/python_design_patterns_model_view_controller.htm", "anchor_text": "this guide too", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/exclusive-how-to-deploy-your-first-machine-learning-models-bf0a2109e522", "anchor_text": "Part#1", "paragraph_index": 8}, {"url": "https://github.com/salma71/prediction_app", "anchor_text": "Github repo", "paragraph_index": 14}, {"url": "https://www.docker.com/get-started", "anchor_text": "docker", "paragraph_index": 24}, {"url": "https://docs.docker.com/engine/reference/run/", "anchor_text": "reference", "paragraph_index": 29}, {"url": "https://docs.docker.com/engine/reference/commandline/container_logs/", "anchor_text": "reference", "paragraph_index": 30}, {"url": "https://www.heroku.com/what", "anchor_text": "heroku", "paragraph_index": 31}, {"url": "https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop/related?hl=en", "anchor_text": "postman", "paragraph_index": 40}], "all_paragraphs": ["In the previous post, I gave a high level overview of the required steps to develop a machine learning pipeline according to industry best practices. In this part, I will continue, and build accessible REST-API endpoints and deploy it to the Heroku platform using CI/CD pipeline.", "Most of the code in this post is already explained in part#1.", "The project repo at Github in case you want to follow along.", "Let\u2019s break it down one by one to understand the structure.", "REST stands for Representational State Transfer (REST) which means that the server will transfer to the client a representation of the requested resource state. API stands for Application Programming Interface; in this tutorials, we won\u2019t build a fully REST-API; we would develop a prediction service instead. This because the scope of this tutorial is to develop a REST-API for ML models.", "To understand the API structure, here is a great resource to learn API creation from the ground up as well as this guide and here.", "As a mindset of a software architecture, you would focus on making design decisions that make it easy of change , extensibility, and of course less bugs. So this is the benefit of using the MVC (Model, View, Controller) architecture, it modularize distinct functionality within the application where it provides sort of abstraction of the three components. Let\u2019s have a brief summary of those three components:", "If you want to learn more about the MVC pattern and other patterns in the software engineering, check this guide and this guide too.", "Part#1 was completed by publishing the regression_model as a private package on Gemfury. In this part, we would use this package to process the data and deploy to the Heroku platform.", "We would start by creating a new package named with the name of ml_api under the packages main directory. The package skeleton would include the the followings:", "The ml_package has three main directories and other python script files.", "requirements.txt: Contains all the requirements to run the package.", "Nothing new here, I just included the flask version I wish to use. Also, included the regression_model package I published on gemfury \u2014 I provided the index-url variable because it is private package not public yet. If you wish to use the package locally, just add your path instead of mine and uncomment it. I included marshmallow for schema validation, as well as gunicorn for deployment purposes.", "It is important that each separate package has its own requirements file.", "If you cloned the Github repo and following along, make sure to install the required dependencies within the ml_api package directory.", "At this stage, you can try to check the API endpoints on the browser. We can do so by telling flask which entry point to start up the API. In terminal, run the following command", "Then execute the run.py file by running python run.py from terminal; now you can see that the server is up and running on port 5000 at /health endpoint.", "Resources to get better understanding of Flask micro-framework:", "We instantiated the schema, then get the input data into the correct format. After that, load the input data and run a check against the schema to make sure that there are no errors. It will simply raise a validation error if something went wrong during validation check.", "The steps would be as the followings:", "It may seem intimidating, but once you got the idea it would be an easy task. So, let\u2019s get started!", "A container is a standard unit of software that packages up code and all its dependencies so the application runs fast and reliably from one computing environment to another.", "Docker is a tool to make it easy for creating, deploying and running containers without complications. Docker container is a standardized unit of software development, containing everything that the software application needs to run. That\u2019s includes code, runtime, system tools, libraries, dependencies, etc.", "Containers became so popular since they have found in 2013 because of reproducibility they offer. This is a huge benefit because you know exactly what were the steps used to create a given container, easy error traceable. Also, it is faster and more lightweight than virtual machine. Easy to use with the CI/CD pipelines.", "You can navigate to docker and follow the steps to download it into your local machine.", "So what we want to create is a linux based container image that\u2019s why most of the command would be linux command.", "Now we are ready to build the image; to do so, we need to run the following command in the terminal if you are in OSX/Linus:", "Important: If you wish to build the image locally on your machine first as a test, you can define the PIP_EXTRA_INDEX_URL locally using the .env file. Otherwise the following command will throw an error that it couldn\u2019t fetch the required package, regression-model.", "You can check if the image has a successful built by using docker images in the terminal. It would list all the docker images built on your local machine.", "2. Run the docker image \u2014 reference", "4. View container logs (get the container ID by running docker ps) \u2014 reference", "Heroku is a cloud based platform as a service that allows developers to build , run, and operate applications entirely in the cloud \u2014 heroku.", "To be able to deploy, you need to add the PIP_EXTRA_INDEX_URL variables to the config vars list in the heroku project setting.", "To do so, Navigate to the application settings \u2192 Reveal Config Vars \u2192", "Now it is time to configure the deployment pipeline to automate the deployment every time you you commit to your remote.", "2. Make sure that both the regression-model==1.0.0 and gunicorn==19.9.0 are imported in the requirements file within the ml_api directory.", "3. Create Makefile that is responsible to capture the commit id of the latest change on the master branch, then create a remote and finally push the work into heroku.", "4. config.py Add the required steps to the circleci config file \u2014 section 10 and 11. It basically, set up the steps required for deployment from reinstall the requirements to capture the new dependencies to set up the heroku remote and deploy. Finally, specifying the workflow of the pipeline, where the deployment should occur after training the model \u2014 logical step.", "P.N: In line 114, I set the docker_layer_caching: false because setting it to true would through an error while running the circleci. You need to upgrade your plane to be able to set this to true.", "Now, when you commit your changes to github, the application should automatically be deployed to the heroku platform.", "You can either navigate to heroku dashboard and open the application from there or by using a tool like postman to make sure that the API is working.", "Note that we have only two end points, health and version. Once confirming that everything is properly working, additional endpoints could be added. This approach is very useful, starting simple would make it easier to capture errors and bugs and consequently spend less time in debugging sessions.", "In this part, we\u2019ve explored many concepts about the API design and how to automate the process to save time. This project gave you some of the best practices to follow to build a production grade application. Also, it gave you a flavor of the practical workflow of the SLCD \u2014 Software Life Cycle Development of a machine learning model. If you have any questions, please ask them; I would love to help! Happy learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9e1d0fcfb68&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://salmaeng71.medium.com/?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0----9e1d0fcfb68---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e1d0fcfb68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e1d0fcfb68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@the_roaming_platypus?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "timJ"}, {"url": "https://unsplash.com/s/photos/ultimate?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/exclusive-how-to-deploy-your-first-machine-learning-models-bf0a2109e522", "anchor_text": "In the previous post"}, {"url": "https://github.com/salma71/prediction_app", "anchor_text": "project repo at Github"}, {"url": "https://www.fullstackpython.com/api-creation.html", "anchor_text": "here is a great resource to learn API"}, {"url": "https://programminghistorian.org/en/lessons/creating-apis-with-python-and-flask", "anchor_text": "well as this guide"}, {"url": "https://realpython.com/flask-connexion-rest-api/", "anchor_text": "here"}, {"url": "https://realpython.com/the-model-view-controller-mvc-paradigm-summarized-with-legos/", "anchor_text": "check this guide"}, {"url": "https://www.tutorialspoint.com/python_design_patterns/python_design_patterns_model_view_controller.htm", "anchor_text": "this guide too"}, {"url": "https://towardsdatascience.com/exclusive-how-to-deploy-your-first-machine-learning-models-bf0a2109e522", "anchor_text": "Part#1"}, {"url": "https://github.com/salma71/prediction_app", "anchor_text": "Github repo"}, {"url": "https://realpython.com/primer-on-python-decorators/", "anchor_text": "https://realpython.com/primer-on-python-decorators/"}, {"url": "http://flask.pocoo.org/docs/1.0/quickstart/", "anchor_text": "http://flask.pocoo.org/docs/1.0/quickstart/"}, {"url": "https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world", "anchor_text": "https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world"}, {"url": "http://flask.pocoo.org/docs/1.0/blueprints/", "anchor_text": "http://flask.pocoo.org/docs/1.0/blueprints/"}, {"url": "https://github.com/pallets/flask", "anchor_text": "https://github.com/pallets/flask"}, {"url": "https://towardsdatascience.com/exclusive-how-to-deploy-your-first-machine-learning-models-bf0a2109e522", "anchor_text": "part#1"}, {"url": "https://www.docker.com/get-started", "anchor_text": "docker"}, {"url": "https://docs.docker.com/engine/reference/commandline/build/", "anchor_text": "reference"}, {"url": "https://docs.docker.com/engine/reference/run/", "anchor_text": "reference"}, {"url": "https://docs.docker.com/engine/reference/commandline/container_logs/", "anchor_text": "reference"}, {"url": "https://www.heroku.com/what", "anchor_text": "heroku"}, {"url": "https://signup.heroku.com/login", "anchor_text": "heroku"}, {"url": "https://devcenter.heroku.com/articles/heroku-cli", "anchor_text": "heroku-cli"}, {"url": "https://devcenter.heroku.com/articles/getting-started-with-python#define-a-procfile", "anchor_text": "heroku instructions"}, {"url": "https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop/related?hl=en", "anchor_text": "postman"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9e1d0fcfb68---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deployment-automation?source=post_page-----9e1d0fcfb68---------------deployment_automation-----------------", "anchor_text": "Deployment Automation"}, {"url": "https://medium.com/tag/docker?source=post_page-----9e1d0fcfb68---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9e1d0fcfb68---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/api?source=post_page-----9e1d0fcfb68---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e1d0fcfb68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----9e1d0fcfb68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e1d0fcfb68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----9e1d0fcfb68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e1d0fcfb68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9e1d0fcfb68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9e1d0fcfb68---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9e1d0fcfb68--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://salmaeng71.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "414 Followers"}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "https://www.linkedin.com/in/salma-elshahawy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F428e575094be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-your-first-machine-learning-models-part-2-9e1d0fcfb68&newsletterV3=992085c0dce0&newsletterV3Id=428e575094be&user=Salma+El+Shahawy&userId=992085c0dce0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}