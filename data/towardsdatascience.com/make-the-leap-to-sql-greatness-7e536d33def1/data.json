{"url": "https://towardsdatascience.com/make-the-leap-to-sql-greatness-7e536d33def1", "time": 1683003993.3723361, "path": "towardsdatascience.com/make-the-leap-to-sql-greatness-7e536d33def1/", "webpage": {"metadata": {"title": "Make The Leap to SQL Greatness. Some Need-to-Know Subtleties to Level\u2026 | by Kathrin Verestoun | Towards Data Science", "h1": "Make The Leap to SQL Greatness", "description": "As I\u2019ve been trying to bridge the gap in my SQL skills from shaky intermediate to confident data maven, I\u2019ve found there is a lack of resources for the intermediate learner. Most SQL books are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.oreilly.com/library/view/sql-in-a/9780596155322/ch04s02.html", "anchor_text": "SQL in a Nutshell", "paragraph_index": 10}, {"url": "https://stackoverflow.com/a/2026609", "anchor_text": "Stack Overflow response by Jeff Atwood", "paragraph_index": 14}, {"url": "https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency/", "anchor_text": "this great stack overflow response", "paragraph_index": 16}, {"url": "https://stackoverflow.com/questions/1282945/python-integer-division-yields-float", "anchor_text": "change made from Python 2 to Python 3 for division to no longer default to integer division", "paragraph_index": 17}, {"url": "https://stackoverflow.com/questions/3443672/integer-division-in-sql-server", "anchor_text": "this Stack Overflow answer", "paragraph_index": 19}], "all_paragraphs": ["As I\u2019ve been trying to bridge the gap in my SQL skills from shaky intermediate to confident data maven, I\u2019ve found there is a lack of resources for the intermediate learner. Most SQL books are catered either to getting a business analyst to write their first SELECT * or to a seasoned database administrator (DBA) who\u2019s writing DDL to set up and maintain databases. This doesn\u2019t fit my need at all\u2014data scientists and data analysts need to know how to handle complex table joins, and don\u2019t need to change the schema or modify data.", "I taught myself SQL. I was driven by the necessity to view data on the backend of reports for which I was responsible. And by doing so, I plunged head-first into a complex world of joins, aggregations, and TOO. MANY. TABLES. (If you\u2019ve only taken SQL classes where you have 5 tables max in your example database, you ain\u2019t seen nothin\u2019 yet\u2014quite literally.)", "This article is a summary of some recent tips, tricks, and subtleties I\u2019ve picked up and wanted to share for everyone else out looking to cross the chasm between SQL mediocracy and greatness.", "ANSI SQL (American National Standards Institute) is the de-facto \u201cstandard\u201d that all Database Management Systems (DBMS) align to when creating their DBMS-specific SQL. However, it seems that they align in the most high-level, tangential way possible. I\u2019ve seen answers on stack overflow insist that the syntax variations between the different variants are close enough to ignore, but I\u2019ve gotten stuck far too many times to ignore when I was trying to use syntax I learned on the job (using SQL Server) in a different setting (PostgresSQL).", "The biggest problem is that the syntax I was using was otherwise valid\u2014with numerous sources online\u2014so it was difficult to discern exactly WHY the query didn\u2019t work. And that led me to doubt my skills, as opposed to realizing that I needed to use different syntax or find a different solution.", "Surprisingly, I\u2019ve yet to find a good comprehensive list of syntax differences! Here is a short list of differences that I\u2019ve personally encountered. Let me know what differences have frustrated you in the past so I can add them!", "This article \u2014 and in fact my foray for the past week and a half to sharpen my SQL skills \u2014 was due to a SQL challenge that asked me to find the median. Writing a median function in Python is in my wheelhouse, but I felt intimidated by having to do it in SQL. In fact, when I searched online, I found that the Median function is not an ANSI SQL standard, and Postgres doesn\u2019t have an implementation of it.", "This problem led me to discover percentile_cont() and percentile_disc(), which are ANSI SQL standard functions. The syntax might be new to you, but it\u2019s worth memorizing:", "column_name is the column you want to calculate the median on, and table_name is the table the column comes from. Notice how the usual aggregation functions we use take the column_name as the function input (e.g. MAX(cost)or AVG(distance), but percentile_cont(n)instead takes the percentile you want to calculate. In our case, we use 50% to obtain the median.", "percenticle_disc(n) is a similar function, but it is limited to values that actually exist in your dataset. That is, if you have an even number of columns, percentile_disc(0.5) will take the smaller value of the two values found to be in middle of the dataset, while percentile_cont(0.5) will instead return the average.", "Know that there are other ANSI SQL Standard Functions that will allow you to calculate correlation and covariance and even regression line slope without taking your data out of your database. As a reference, check out SQL in a Nutshell.", "You can actually solve the Median problem with common aggregation functions if you think creatively:", "Solution #1 is simpler, although it requires manual intervention to make sure the calculation is correct. If you have an odd number of data points, it\u2019s easy\u2014 First, you find out what row delineates the top 50% of your dataset. This is done using the inner subquery SELECT COUNT(*)/2 FROM table_name. For example, if you have 4,383 rows of data, the subquery will return row #2,191. Since you are doing integer division, the value is floored (a nuance that I will also address later). Then, you can write the outer query where you will LIMIT 1 to get your median value and OFFSET the selection by the result of your subquery. (Note: This is also a great example of OFFSET coming in clutch.)", "Beware that solution #1 only works for an odd number of data points. If you want to deal with an even number of data points, you will need to modify it to LIMIT 2 and calculate the average of those two median values. While not a great solution in production, it\u2019s an easy-to-remember solution for interviews.", "Solution #2 is a Stack Overflow response by Jeff Atwood that is more complex but is agnostic the number of data points. Unfortunately, it doesn\u2019t work in PostgresSQL or MySQL because they don\u2019t support the TOP or PERCENT keywords. (Again, know your differences!)", "When I was working as a business analyst at a bank, I wrote an FSD (Functional Specifications Document) outlining how to obtain and calculate cashflows from various product databases. And when my fellow developers used the FSD to code the calculations, I noticed that the values were slightly off. It was a difference of pennies or dollars for transaction amounts in the millions, but the differences were disconcerting\u2014why were the values not matching?", "It turns out it had everything to do with how numbers were being stored in the database, and what data type was used in the calculation. Floating-point data types like float and real and double precision are stored imprecisely, and small inaccuracies can get amplified over time. In general, you should be using fixed-point data types like numeric to do any precise calculations. For more information about why you should never use floating-point data types to do calculations\u2014especially numeric ones\u2014check out this great stack overflow response. The take-away is if", "Unlike the change made from Python 2 to Python 3 for division to no longer default to integer division, SQL still assumes division between two integers is intended to be floor division. That is, the remainder is thrown away and only an integer is returned. (e.g. SELECT 7/3 returns 2)", "If you want to obtain the decimal values as well when your values don\u2019t divide evenly, don\u2019t forget to CAST one value to a numeric or float data type first. For example:", "In both examples above, the function CAST() and the :: symbol can be used for type conversion. For a detailed explanation of how to use CAST to get a floating-point answer, I recommend this Stack Overflow answer.", "Type casting can feel tricky at first, especially since data types between SQL DBMS standards are different. But I recommend you figure out exactly what data types\u2014particularly numeric\u2014are valid for your SQL of choice and make sure you know what data type you are expecting as a result of a calculation! Even if you don\u2019t cast every single numeric value or column in your results, you should at least know what you are getting. It can be too easy to use the default result that may give you the wrong answer.", "The syntax for CAST is simple:", "Where expression can be the name of a column or a calculation between columns. the datatype is the data type you want to CAST your expression into, and the (length) is optional, but can be used to specify the character limit for varchar(25) or numeric precision like numeric(8,1).", "The ::symbol works exactly like the CAST function, so if you see it instead of CAST know that they are both doing type conversion:", "Notice that in the example above, we convert the dividend to a float before calculating the ratio so our result a float rather than an integer.", "Some database management systems like pgadmin4 will show you the data type right in the query results window:", "Other times, you will need to investigate the data types as specified by the metadata. You can do this through the DBMS GUI\u2014for example, SQL Workbench allows you to view the table metadata through the Database Explorer:", "Otherwise, you can use the following SQL to view the data types if you have sufficient permissions:", "I\u2019d love to hear what SQL tips have either really leveled up your game\u2014especially those I haven\u2019t touched on in this article\u2014or what you are still struggling with!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, @FlatironSchool Graduate, and Curious Human"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7e536d33def1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7e536d33def1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7e536d33def1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@go.kathrin?source=post_page-----7e536d33def1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@go.kathrin?source=post_page-----7e536d33def1--------------------------------", "anchor_text": "Kathrin Verestoun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7233694f1f63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&user=Kathrin+Verestoun&userId=7233694f1f63&source=post_page-7233694f1f63----7e536d33def1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e536d33def1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e536d33def1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alexradelich?utm_source=medium&utm_medium=referral", "anchor_text": "Alex Radelich"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.oreilly.com/library/view/sql-in-a/9780596155322/ch04s02.html", "anchor_text": "SQL in a Nutshell"}, {"url": "https://stackoverflow.com/a/2026609", "anchor_text": "Stack Overflow response by Jeff Atwood"}, {"url": "https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency/", "anchor_text": "this great stack overflow response"}, {"url": "https://stackoverflow.com/questions/1282945/python-integer-division-yields-float", "anchor_text": "change made from Python 2 to Python 3 for division to no longer default to integer division"}, {"url": "https://stackoverflow.com/questions/3443672/integer-division-in-sql-server", "anchor_text": "this Stack Overflow answer"}, {"url": "https://medium.com/tag/sql?source=post_page-----7e536d33def1---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7e536d33def1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----7e536d33def1---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/postgresql?source=post_page-----7e536d33def1---------------postgresql-----------------", "anchor_text": "Postgresql"}, {"url": "https://medium.com/tag/sql-server?source=post_page-----7e536d33def1---------------sql_server-----------------", "anchor_text": "Sql Server"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7e536d33def1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&user=Kathrin+Verestoun&userId=7233694f1f63&source=-----7e536d33def1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7e536d33def1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&user=Kathrin+Verestoun&userId=7233694f1f63&source=-----7e536d33def1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e536d33def1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7e536d33def1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7e536d33def1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7e536d33def1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7e536d33def1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7e536d33def1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7e536d33def1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7e536d33def1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7e536d33def1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7e536d33def1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7e536d33def1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7e536d33def1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@go.kathrin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@go.kathrin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kathrin Verestoun"}, {"url": "https://medium.com/@go.kathrin/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "168 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7233694f1f63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&user=Kathrin+Verestoun&userId=7233694f1f63&source=post_page-7233694f1f63--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F50051836825&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-the-leap-to-sql-greatness-7e536d33def1&newsletterV3=7233694f1f63&newsletterV3Id=50051836825&user=Kathrin+Verestoun&userId=7233694f1f63&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}