{"url": "https://towardsdatascience.com/a-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210", "time": 1683014024.625212, "path": "towardsdatascience.com/a-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210/", "webpage": {"metadata": {"title": "A Guide: Turning OpenStreetMap Location Data into ML Features | by Daniel L J Thomas | Towards Data Science", "h1": "A Guide: Turning OpenStreetMap Location Data into ML Features", "description": "Take the following problem. You\u2019re tasked with predicting what a new Airbnb host might charge (and by extension, what a guest might pay) across London. To answer this question you need to collect\u2026"}, "outgoing_paragraph_urls": [{"url": "http://insideairbnb.com/get-the-data.html", "anchor_text": "80,000 Airbnb properties in London", "paragraph_index": 2}, {"url": "https://wiki.openstreetmap.org/wiki/Amazon_Logistics", "anchor_text": "Amazon", "paragraph_index": 5}, {"url": "https://www.tesmanian.com/blogs/tesmanian-blog/tesla-owners-smart-summon-routes-open-street-maps-full-self-driving", "anchor_text": "Tesla", "paragraph_index": 5}, {"url": "https://github.com/Uber-OSM/Global", "anchor_text": "Uber", "paragraph_index": 5}, {"url": "https://blogs.bing.com/maps/2018-06/microsoft-releases-125-million-building-footprints-in-the-us-as-open-data", "anchor_text": "124 million building footprints", "paragraph_index": 6}, {"url": "https://wiki.openstreetmap.org/wiki/Map_Features#Aeroway", "anchor_text": "See here", "paragraph_index": 7}, {"url": "https://geoffboeing.com/2018/03/osmnx-features-roundup/", "anchor_text": "Geoff Boeing", "paragraph_index": 8}, {"url": "https://github.com/dljthomas1/Accessing-OpenStreetMap-Data", "anchor_text": "see here", "paragraph_index": 25}, {"url": "https://www.instagram.com/HouseOfData/", "anchor_text": "HouseOfData", "paragraph_index": 26}], "all_paragraphs": ["Take the following problem. You\u2019re tasked with predicting what a new Airbnb host might charge (and by extension, what a guest might pay) across London. To answer this question you need to collect data about the factors that are likely to contribute to the nightly price of an Airbnb property in the city.", "The more of these factors you can collect some data on, the closer your ML model can get to that sweet spot of a near-perfect prediction in the middle.", "You already have information about the 80,000 Airbnb properties in London and their hosts. What you\u2019re missing, however, is crucial information about the competition \u2014 where are hotels located, how many shops, bars, restaurants, tourist destinations, etc, are close by. After all, who travels to London to stay in a quiet neighbourhood with no activity? This is where OpenStreetMap can help.", "Before we move on, if you would rather follow this guide in the form of a Jupyter Notebook, a link is provided at the end of the article.", "OpenStreetMap (OSM) describe themselves as \u201ca collaborative project to create a free editable map of the world\u201d. They are the Wikipedia of maps. Its 5 million contributors can do everything from adding new roads or removing shops which have closed down.", "If anyone can change it, is it even reliable? Yes! Unless you are a hardcore Google user you probably use OSM every day. Apple, Microsoft, Facebook, Mapbox and FourSquare all use OSM as the basis of their mapping efforts. Amazon use it for their logistics chain. Tesla use it in their autonomous vehicles. Uber use it within their internal route-finding platform. OSM is probably the most tried and tested mapping platform that exists.", "You can also take some comfort from the fact these corporate tech contributors are adding to the platform at scale. Microsoft has combined computer vision and satellite imagery to add 124 million building footprints across the United States.", "OSM\u2019s biggest advantage is that it is absolutely free and available for use without limitation. You can pull tonnes of information about the local area \u2014 covering everything from local amenities to bus stops, cycles lanes and even drinking fountains. See here for a full list of OSM features.", "We access OSM data through OSMnx\u2013a python module initially written by Geoff Boeing to support his PhD thesis.", "Let\u2019s suppose we want to find all the restaurants in London:", "You could loop this process and also pull all data on bars, restaurants, nightclubs, and all of the other amenities that might affect what a host will charge for an Airbnb.", "Let\u2019s quickly check of the data we have pulled. We\u2019ll use OSMnx to pull the geometry of London\u2019s boundary and plot both using matplotlib.", "What we currently have is a dataframe of all the restaurants in London. For a machine learning model, what we need is the number of restaurants within a 10-minute walk each Airbnb property. Quite a bit of manipulation is required to get to this.", "OSMnx returns most properties as a single point (longitude/latitude) coordinates. However, a few are returned as polygons (a shape). This usually happens when the property is large. Working with polygons is more complicated than working with points so we will convert them all to points by calculating their centre point. We do this using shapely.", "Before we carry out any calculations we need to convert our point coordinates to a local projection. As you know, the earth is a sphere. A projection is a method of flattening the surface of the earth so we can display it on a map. The problem, however, is that there is no way to flatten the surface of a sphere in a way that all parts are sized proportionately equally.", "Take the examples below. On the left, we have the Mercator projection \u2014 a popular map projection originally designed to help 16th-century sailors get around the world. Notice landmasses become disproportionately large the further away from the equator you get. On the right, we have an Equirectangular projection which corrects some of these issues. Notice the size difference between Africa and Greenland on both maps.", "Some \u2018equal earth\u2019 projections do exist but they are useless as visual tools. Take these two Azimuthal Equidistant Projections. You should recognise the one on the right as the UN Logo.", "The only way to get around this is to find a projection that makes the specific part of the world that you are interested in equally sized. These are known as local UTM Coordinate Referencing Systems. Fortunately for us, OSMnx has a method built-in that can help us quickly find the correct local UTM.", "Now we have the local UTM, we import our Airbnb data and convert it into the local projection. We do the same with the original restaurant data we pulled in from OSMnx.", "Finally, we need to iterate through each AirBnb property and work out how many restaurants there are within a 10-minute walk (approximately 1km).", "I do this using a K-D Tree. Explaining how K-D Trees work is outside the scope of this article, but in short, they\u2019re a super efficient way of searching through our 80,000 AirBnb rooms and 6,000 restaurants and figuring out which ones are close to which. First, we set up the tree of all restaurant points:", "Then we create a function which we will perform on each of our Airbnb property. The function will query the tree and find the 500 closest restaurants along with calculating their distances from the Airbnb property. We use a figure of 500 in the hope that no property has more than 500 restaurants close to it.", "And finally, we set up a timer and apply the function to each Airbnb row:", "So there you have it. Now you know how many restaurants there are within a 10-minute walk of each Airbnb property 80,000 AirBnb properties. You could repeat this process for bars, shops, subway stations, tourist hotspots, public parks, and whatever else you think may influence the price of an Airbnb property \u2014 as I did.", "In my final XGBoost model, as you can see below, these OSM features (highlighted in red) ended up being some of the most important drivers of price in London.", "For the full Jupyter Notebook see here.", "Enjoyed this article? Check out my data visualisation page on Instagram: HouseOfData.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Deliveroo. HouseOfData Visualisations on Instagram. @DanielLJThomas on Twitter"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe687b66db210&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e687b66db210--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e687b66db210--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dljthomas1?source=post_page-----e687b66db210--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dljthomas1?source=post_page-----e687b66db210--------------------------------", "anchor_text": "Daniel L J Thomas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1ccbfeff1a01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&user=Daniel+L+J+Thomas&userId=1ccbfeff1a01&source=post_page-1ccbfeff1a01----e687b66db210---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe687b66db210&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe687b66db210&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://insideairbnb.com/get-the-data.html", "anchor_text": "80,000 Airbnb properties in London"}, {"url": "https://wiki.openstreetmap.org/wiki/Amazon_Logistics", "anchor_text": "Amazon"}, {"url": "https://www.tesmanian.com/blogs/tesmanian-blog/tesla-owners-smart-summon-routes-open-street-maps-full-self-driving", "anchor_text": "Tesla"}, {"url": "https://github.com/Uber-OSM/Global", "anchor_text": "Uber"}, {"url": "https://blogs.bing.com/maps/2018-06/microsoft-releases-125-million-building-footprints-in-the-us-as-open-data", "anchor_text": "124 million building footprints"}, {"url": "https://media.ccc.de/v/state-of-the-map-2020-academic-track-4858-curious-cases-of-corporations-in-openstreetmap", "anchor_text": "SOTM2020"}, {"url": "https://wiki.openstreetmap.org/wiki/Map_Features#Aeroway", "anchor_text": "See here"}, {"url": "https://geoffboeing.com/2018/03/osmnx-features-roundup/", "anchor_text": "Geoff Boeing"}, {"url": "https://simple.wikipedia.org/wiki/Equirectangular_projection#/media/File:Equirectangular-projection.jpg", "anchor_text": "Mercator"}, {"url": "https://simple.wikipedia.org/wiki/Equirectangular_projection#/media/File:Equirectangular-projection.jpg", "anchor_text": "Equirectangular"}, {"url": "https://en.wikipedia.org/wiki/Azimuthal_equidistant_projection", "anchor_text": "Wikipedia"}, {"url": "https://github.com/dljthomas1/Accessing-OpenStreetMap-Data", "anchor_text": "see here"}, {"url": "https://www.instagram.com/HouseOfData/", "anchor_text": "HouseOfData"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e687b66db210---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/openstreetmap?source=post_page-----e687b66db210---------------openstreetmap-----------------", "anchor_text": "Openstreetmap"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----e687b66db210---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/python?source=post_page-----e687b66db210---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/mapping?source=post_page-----e687b66db210---------------mapping-----------------", "anchor_text": "Mapping"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe687b66db210&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&user=Daniel+L+J+Thomas&userId=1ccbfeff1a01&source=-----e687b66db210---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe687b66db210&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&user=Daniel+L+J+Thomas&userId=1ccbfeff1a01&source=-----e687b66db210---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe687b66db210&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e687b66db210--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe687b66db210&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e687b66db210---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e687b66db210--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e687b66db210--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e687b66db210--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e687b66db210--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e687b66db210--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e687b66db210--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e687b66db210--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e687b66db210--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dljthomas1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dljthomas1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Daniel L J Thomas"}, {"url": "https://medium.com/@dljthomas1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1ccbfeff1a01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&user=Daniel+L+J+Thomas&userId=1ccbfeff1a01&source=post_page-1ccbfeff1a01--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F1ccbfeff1a01%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-guide-turning-openstreetmap-location-data-into-ml-features-e687b66db210&user=Daniel+L+J+Thomas&userId=1ccbfeff1a01&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}