{"url": "https://towardsdatascience.com/5-machine-learning-techniques-for-sales-forecasting-598e4984b109", "time": 1683006205.624377, "path": "towardsdatascience.com/5-machine-learning-techniques-for-sales-forecasting-598e4984b109/", "webpage": {"metadata": {"title": "5 Machine Learning Techniques for Sales Forecasting | by Molly Ruby | Towards Data Science", "h1": "5 Machine Learning Techniques for Sales Forecasting", "description": "Forecasting sales is a common and essential use of machine learning (ML). Sales forecasts can be used to identify benchmarks and determine incremental impacts of new initiatives, plan resources in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/demand-forecasting-kernels-only", "anchor_text": "on Kaggle", "paragraph_index": 1}, {"url": "https://github.com/mollyliebeskind/sales_forecasting", "anchor_text": "GitHub", "paragraph_index": 1}, {"url": "https://www.analyticsvidhya.com/blog/2018/09/non-stationary-time-series-python/", "anchor_text": "found here.", "paragraph_index": 4}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/tree/master/notebooks", "anchor_text": "found here.", "paragraph_index": 5}, {"url": "https://people.duke.edu/~rnau/arimrule.htm", "anchor_text": "rules for selecting lags", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/predicting-sales-611cb5a252de", "anchor_text": "Baris Karaman\u2019s data driven growth series.", "paragraph_index": 9}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/blob/master/models.py", "anchor_text": "found here", "paragraph_index": 11}, {"url": "https://devdocs.io/scikit_learn/", "anchor_text": "scikit-learn library", "paragraph_index": 12}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/blob/master/models.py", "anchor_text": "helper functions", "paragraph_index": 12}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/blob/master/models.py", "anchor_text": "helper functions", "paragraph_index": 20}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/blob/master/results.py", "anchor_text": "found here", "paragraph_index": 22}, {"url": "https://github.com/mollyliebeskind/sales_forecasting", "anchor_text": "found here.", "paragraph_index": 25}], "all_paragraphs": ["Forecasting sales is a common and essential use of machine learning (ML). Sales forecasts can be used to identify benchmarks and determine incremental impacts of new initiatives, plan resources in response to expected demand, and project future budgets. In this article, I will show how to implement 5 different ML models to predict sales.", "The data for this demonstration can be found on Kaggle and the full code is on GitHub.", "The first step is to load the data and transform it into a structure that we will then use for each of our models. In its raw form, each row of data represents a single day of sales at one of ten stores. Our goal is to predict monthly sales, so we will first consolidate all stores and days into total monthly sales.", "In our new data frame, each row now represents total sales in a given month across all stores.", "If we plot the total monthly sales over time, we see that average monthly sales increase over time, which means that our data is not stationary. To make it stationary, we will calculate the difference between sales in each month and add this into our data frame as a new column. Additional details on stationery and differencing can be found here.", "Below is a visual representation of how our data looked before and after the differencing transformation. Code for all plots can be found here.", "Now that our data represent monthly sales and we have transformed it to be stationary, we will set up the data for our different model types. To do this, we will define two different structures: one will be used for ARIMA modeling and the other will be used for the rest of the models.", "For our Arima model, we will need only a datetime index and the dependent variable (diff in sales) columns.", "For our other models, we will create a new data frame where each feature represents a previous month\u2019s sales. To determine how many months to include in our feature set, we will observe the autocorrelation and partial autocorrelation plots and use the rules for selecting lags in ARIMA modeling. This way, we can keep consistent a look-back period for our ARIMA and regressive models.", "Based on the above, we will choose our look-back period to be 12 months. We will, therefore, generate a data frame that has 13 columns, 1 column for each of the 12 months and the column for our dependent variable, difference in sales. Code for the below was grabbed from Baris Karaman\u2019s data driven growth series.", "Now we have two separate data structures, our Arima structure that includes a datetime index and our supervised structure that includes lags as features.", "To create and assess all of our models, we use a series of helper functions that perform the following functions. The code for all of the helper functions can be found here.", "For our regressive models, we can use the fit-predict structure of the scikit-learn library. We therefore can set up a base modeling structure that we will call for each model. The function below calls many of the helper functions outlined above to split the data, run the model, and output RMSE and MAE scores.", "The output below shows the predictions (red) overlaid on top of the actual sales (blue) for each of the regressive models. While the results look similar, the nuanced differences equate to a few thousand dollars in sales, which we will see in the comparison section below.", "LSTM is a type of recurrent neural network that is particularly useful for making predictions with sequential data. For this purpose, we will use a very simple LSTM. For additional accuracy, seasonal features and additional model complexity can be added.", "The resulting plot looks similar to the three regressive plots above, so we will hold off on comparing the results until we look at the errors below.", "The ARIMA model looks slightly different than the models above. We use the statsmodels SARIMAX package to train the model and generate dynamic predictions. The SARIMA model breaks down into a few parts.", "In the code below, we define our model and then make dynamic predictions for the last 12 months of the data. For standard, non-dynamic predictions, the following month\u2019s prediction is made using the actual sales from the prior months. In contrast, for dynamic predictions, the following month\u2019s prediction is made using the predicted sales from the prior months.", "Again, the results look pretty good. We will dig in further below.", "To compare model performance, we will look at root mean squared error (RMSE) and mean absolute error (MAE). These measurements are both commonly used for comparing model performance, but they have slightly different intuition and mathematical meaning.", "From the helper functions above, we use get_scores to calculate the RMSE and MAE scores for each model. These scores were saved in a dictionary and pickled. For comparison, we will transform that dictionary into a Pandas data frame and plot the results.", "This gives us the following data frame.", "We can see that although our model outputs looked similar in the plots above, they do vary in their degree of accuracy. Below is a visual to help us see the difference. Plot code can be found here.", "What we see is that overall the XGBoost model had the best performance followed closely by the ARIMA and LSTM models. A caveat here is that all of the models above were derived in their most basic form to demonstrate how they can be used for sales forecasting. The models were only lightly tuned to minimize complexity. The LSTM for example could have many additional nodes and layers to increase performance.", "To identify which model is right for your use case, you should consider the following.", "The full code for this introduction into sales forecasting can be found here. Please add any questions or comments below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F598e4984b109&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----598e4984b109--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----598e4984b109--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@molly.ruby?source=post_page-----598e4984b109--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@molly.ruby?source=post_page-----598e4984b109--------------------------------", "anchor_text": "Molly Ruby"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7a38f8e9fb80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&user=Molly+Ruby&userId=7a38f8e9fb80&source=post_page-7a38f8e9fb80----598e4984b109---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F598e4984b109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F598e4984b109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/demand-forecasting-kernels-only", "anchor_text": "on Kaggle"}, {"url": "https://github.com/mollyliebeskind/sales_forecasting", "anchor_text": "GitHub"}, {"url": "https://www.analyticsvidhya.com/blog/2018/09/non-stationary-time-series-python/", "anchor_text": "found here."}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/tree/master/notebooks", "anchor_text": "found here."}, {"url": "https://people.duke.edu/~rnau/arimrule.htm", "anchor_text": "rules for selecting lags"}, {"url": "https://towardsdatascience.com/predicting-sales-611cb5a252de", "anchor_text": "Baris Karaman\u2019s data driven growth series."}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/blob/master/models.py", "anchor_text": "found here"}, {"url": "https://devdocs.io/scikit_learn/", "anchor_text": "scikit-learn library"}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/blob/master/models.py", "anchor_text": "helper functions"}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/blob/master/models.py", "anchor_text": "helper functions"}, {"url": "https://github.com/mollyliebeskind/sales_forecasting/blob/master/results.py", "anchor_text": "found here"}, {"url": "https://github.com/mollyliebeskind/sales_forecasting", "anchor_text": "found here."}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----598e4984b109---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----598e4984b109---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/sales-forecasting?source=post_page-----598e4984b109---------------sales_forecasting-----------------", "anchor_text": "Sales Forecasting"}, {"url": "https://medium.com/tag/arima?source=post_page-----598e4984b109---------------arima-----------------", "anchor_text": "Arima"}, {"url": "https://medium.com/tag/lstm?source=post_page-----598e4984b109---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F598e4984b109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&user=Molly+Ruby&userId=7a38f8e9fb80&source=-----598e4984b109---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F598e4984b109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&user=Molly+Ruby&userId=7a38f8e9fb80&source=-----598e4984b109---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F598e4984b109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----598e4984b109--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F598e4984b109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----598e4984b109---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----598e4984b109--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----598e4984b109--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----598e4984b109--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----598e4984b109--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----598e4984b109--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----598e4984b109--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----598e4984b109--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----598e4984b109--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@molly.ruby?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@molly.ruby?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Molly Ruby"}, {"url": "https://medium.com/@molly.ruby/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7a38f8e9fb80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&user=Molly+Ruby&userId=7a38f8e9fb80&source=post_page-7a38f8e9fb80--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F23ca99469bed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-machine-learning-techniques-for-sales-forecasting-598e4984b109&newsletterV3=7a38f8e9fb80&newsletterV3Id=23ca99469bed&user=Molly+Ruby&userId=7a38f8e9fb80&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}