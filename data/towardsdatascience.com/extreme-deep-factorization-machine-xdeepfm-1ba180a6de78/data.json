{"url": "https://towardsdatascience.com/extreme-deep-factorization-machine-xdeepfm-1ba180a6de78", "time": 1683001983.284683, "path": "towardsdatascience.com/extreme-deep-factorization-machine-xdeepfm-1ba180a6de78/", "webpage": {"metadata": {"title": "eXtreme Deep Factorization Machine(xDeepFM) | by Abhishek Sharma | Towards Data Science", "h1": "eXtreme Deep Factorization Machine(xDeepFM)", "description": "We are living in times where we are spoilt for choice. Whether it is food, music or entertainment the amount of options that we have is simply mind-boggling. But thanks to the recommendation engines\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/shenweichen/DeepCTR/blob/master/examples/criteo_sample.txt", "anchor_text": "here", "paragraph_index": 29}, {"url": "https://github.com/microsoft/recommenders", "anchor_text": "Microsoft\u2019s library", "paragraph_index": 34}, {"url": "https://github.com/Leavingseason/xDeepFM", "anchor_text": "code", "paragraph_index": 34}, {"url": "https://medium.com/@abhisheksharma_57055/neural-collaborative-filtering-96cef1009401", "anchor_text": "this", "paragraph_index": 35}], "all_paragraphs": ["We are living in times where we are spoilt for choice. Whether it is food, music or entertainment the amount of options that we have is simply mind-boggling. But thanks to the recommendation engines that fuel these apps/sites these alternatives are provided to us in a ranked list. In this blog, we will be discussing a new recommendation algorithm called Extreme Deep Factorisation Machines (xDeepFM).", "This blog is organized as follows:", "5. Coded Example using deepCTR library", "The current recommendation landscape is dominated by FM/DNN based models. But some good hybrid architectures which fuse FM and DNN based systems are also coming up.", "1. Factorization Machine (FM) based approach", "2. Deep Neural Network ( DNN ) based approach", "You can look into this post to get a brief overview of Neural Collaborative Filtering (NCF). This is the most cited of all hybrid models.", "All examples of the hybrid category use DNN to learn implicit bitwise feature interactions. They differ in how the high order feature interactions are learned.", "Out of these 3, CIN is unique to xDeepFM.", "The problem with DNN based systems is that they learn the high order interactions implicitly. In xDeepFM the explicit high order feature interactions are learned through Compressed Interaction Network (CIN).", "CIN is inducted by xDeepFM due to the following benefits:", "The explicit feature interactions are learned by the CIN through its hidden layers (Every x in Figure 4 is a hidden layer) which are defined as follows", "X(k-1,i): Embedding vector of the ith field in k-th layer (k-1 hidden layer)X(0,j): Embedding vector of the jth field in k-th layer (base embedding/original feature embedding)W(k,h,i,j): Learnable parameter with dimension m * H(k-1)", "Every row in X(k) is differentiated only by W(k,h). In contrast to DNN there is no activation to transform the hidden layer.", "Equation 1 is similar to RNN based models as CIN\u2019s output is dependent on the last hidden layer and additional input.", "m: Number of rows in the original feature matrixH(k): Number of rows in the feature matrix at hidden layer k", "Z(k+1) is an intermediate tensor which is an outer product of hidden layer X(k) and original feature matrix X(0). Z(k+1) can be regarded as a special type of image and W(k,h) as a filter.", "As you slide the Weight Matrix along the dimension D (size of every feature embedding) you get a hidden vector X(k+1,i).", "The result of the hidden layers is summed row-wise and then concatenated together before being fed to the output layer.", "All pooling vectors from hidden layers are concatenated before connected to output units:", "Linear, CIN, and DNN are all trained parallelly with the output equation as follows:", "Sigma: Sigmoid Functiona: Raw FeaturesW,b: Learnable parameters", "DNN and CIN based layers complement each other well as together they can learn", "1. Both implicit (DNN) and explicit (CIN) feature interactions.", "2. Both low (DNN) and high (Both) order feature interactions.", "First-term represents the number of parameters at the output layerSecond-term represents the number of parameters at every layer kIf we assume all hidden layers to have the same number of feature vectors H. The number of parameters can be represented as O(m*H*H*T)", "Time complexity is equivalent to O(mHD * H * T). mhd: Cost of computing Z(k+1,h) for 1 rowH: Number of feature vectors (rows) at layer HT: Number of hidden layers in CIN", "With that, we are done with the theory of xdeepfm. It\u2019s time to see it in action.", "I have used xDeepFM implementation from the deepCTR library. For some other implementations check out the References segment.", "Download the sample data from here and then use the following code to read the data and separate features as dense or sparse.", "The sparse features require embedding while the dense features require normalization. We are using MinMax scaler for normalization while LabelEncoder for feature encoding.", "In the next code blob, we are initializing, compiling, training and predicting using xDeepFM", "xDeepFM is an example of a hybrid architecture. It combines MF with DNN to come up with a better performance. It does this by using CIN(Compressed Interaction Network). CIN has 2 special virtues:", "Like other popular hybrid methods, xDeepFM incorporates CIN with DNN.Due to which high order feature interactions can be learned both explicitly and implicitly. This reduces the need for manual feature engineering.", "I will urge you to try out Microsoft\u2019s library or the xDeepFM\u2019s author\u2019s code to play around with different xDeepFM\u2019s implementations.", "You can also look at this post to get a brief overview of NCF which is another popular hybrid architecture.", "Please feel free to share your thoughts and ideas in the comments section.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1ba180a6de78&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@abhisheksharma_57055?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@abhisheksharma_57055?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": "Abhishek Sharma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6bf1381e177&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&user=Abhishek+Sharma&userId=6bf1381e177&source=post_page-6bf1381e177----1ba180a6de78---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1ba180a6de78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1ba180a6de78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nate_dumlao?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Nathan Dumlao"}, {"url": "https://unsplash.com/s/photos/choice?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@abhisheksharma_57055/neural-collaborative-filtering-96cef1009401", "anchor_text": "Neural Collaborative FilteringSupercharging collaborative filtering with neural networksmedium.com"}, {"url": "https://github.com/shenweichen/DeepCTR/blob/master/examples/criteo_sample.txt", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1803.05170", "anchor_text": "xDeepFM paper"}, {"url": "https://github.com/Leavingseason/xDeepFM", "anchor_text": "Code from the writers of paper xDeepFM"}, {"url": "https://github.com/microsoft/recommenders", "anchor_text": "Code from Microsoft library for recommendation"}, {"url": "https://github.com/shenweichen/DeepCTR", "anchor_text": "deepctr"}, {"url": "https://github.com/microsoft/recommenders", "anchor_text": "Microsoft\u2019s library"}, {"url": "https://github.com/Leavingseason/xDeepFM", "anchor_text": "code"}, {"url": "https://medium.com/@abhisheksharma_57055/neural-collaborative-filtering-96cef1009401", "anchor_text": "this"}, {"url": "https://medium.com/@abhisheksharma_57055/neural-collaborative-filtering-96cef1009401", "anchor_text": "Neural Collaborative FilteringSupercharging collaborative filtering with neural networksmedium.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1ba180a6de78---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1ba180a6de78---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----1ba180a6de78---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1ba180a6de78---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/recommendations?source=post_page-----1ba180a6de78---------------recommendations-----------------", "anchor_text": "Recommendations"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1ba180a6de78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&user=Abhishek+Sharma&userId=6bf1381e177&source=-----1ba180a6de78---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1ba180a6de78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&user=Abhishek+Sharma&userId=6bf1381e177&source=-----1ba180a6de78---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1ba180a6de78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1ba180a6de78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1ba180a6de78---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1ba180a6de78--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1ba180a6de78--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1ba180a6de78--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1ba180a6de78--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@abhisheksharma_57055?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@abhisheksharma_57055?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abhishek Sharma"}, {"url": "https://medium.com/@abhisheksharma_57055/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "305 Followers"}, {"url": "https://www.linkedin.com/in/abhishek-sharma-960b474b/", "anchor_text": "https://www.linkedin.com/in/abhishek-sharma-960b474b/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6bf1381e177&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&user=Abhishek+Sharma&userId=6bf1381e177&source=post_page-6bf1381e177--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8f7ad8aedc15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-deep-factorization-machine-xdeepfm-1ba180a6de78&newsletterV3=6bf1381e177&newsletterV3Id=8f7ad8aedc15&user=Abhishek+Sharma&userId=6bf1381e177&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}