{"url": "https://towardsdatascience.com/end-to-end-machine-learning-project-reviews-classification-60666d90ec19", "time": 1683011861.1151612, "path": "towardsdatascience.com/end-to-end-machine-learning-project-reviews-classification-60666d90ec19/", "webpage": {"metadata": {"title": "End to End Machine Learning Project: Reviews Classification | by Kiprono Elijah Koech | Towards Data Science", "h1": "End to End Machine Learning Project: Reviews Classification", "description": "In this article, we will go through a classification problem that involves classifying a review as either positive or negative. The reviews used here are the reviews made by customers on a service\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/kipronokoech/Reviews-Classification/blob/master/data_collection.ipynb", "anchor_text": "this notebook", "paragraph_index": 1}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Sklearn", "paragraph_index": 5}, {"url": "https://github.com/kipronokoech/Reviews-Classification", "anchor_text": "link", "paragraph_index": 20}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "Wikipedia", "paragraph_index": 27}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "here", "paragraph_index": 28}, {"url": "https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/", "anchor_text": "oversampling techniques", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/kipronokoech/", "anchor_text": "https://www.linkedin.com/in/kipronokoech/", "paragraph_index": 38}], "all_paragraphs": ["In this article, we will go through a classification problem that involves classifying a review as either positive or negative. The reviews used here are the reviews made by customers on a service ABC.", "The data used in this particular project were scraped from the web and data cleaning done in this notebook.", "After we scraping the data was saved to a .txt file and here is an example of one line of the file (to represent one data point)", "The data point is a dictionary and we are interested in the reviewBody and stars.", "We will categorize the reviews as follows", "At the moment of data collection, there were 36456 reviews on the site. The data is highly imbalanced: 94% of the total reviews are positive, 4% are negative and 2% are neutral. In this project, we will fit different Sklearn models on the imbalanced data and also on balanced data (dropping positive excesses so that we have the same number of positive and negative reviews.)", "Below is a plot showing the composition of the data:", "In Fig 2 and the figures above, we can see that the data is highly imbalanced. Could this be a sign of a problem? We shall see.", "Let's start by importing necessary packages and also define the class Review that we will use to categorize a given review message", "Here, we will load the data and use the Review class to categorize the review message as positive, negative or neutral", "Before we continue further, we need to understand the concept of Bag-of-Words.", "As we know, a computer only understands numbers and therefore we need to convert the review messages we have into a list of numbers using bag-of-words model.", "A bag-of-words is a representation of text that describes the occurrence of words within a document. It involves two things: A vocabulary of known words. A measure of the presence of known words.", "The bag-of-words model is a supporting model used in document classification where the (frequency of) occurrence of each word is used as a feature for training a classifier.", "From the above two sentences, we can derive the following dictionary", "[Excellent, Services, by, the, ABC, remit, team, recommend, bad, transaction, delayed, for, three, days, don\u2019t]", "We now tokenize this dictionary to generate the following two data points that can now be used to train the classifier", "In python, tokenization is done as follows", "Now that we understand the concept of Bag-of-Words, lets now apply that knowledge on our train_x and test_x", "At this point, we have the vectors that we can use to fit the models and we can go ahead and do just that", "Other models trained includes Ensemble Random Forest, Naive Bayes, Decision Tree and Logistic Regression. A link to the full code.", "The models were evaluated using accuracy metric and the results were as follows", "We are getting an accuracy of 90%, is that right or there\u2019s something wrong? The answer is, there is something wrong.", "The data is imbalanced and using accuracy as an evaluation metric is not a good idea. Below is the distribution in the categories", "What happens if the classifier predicts all positive reviews correctly and none for negative and neutral reviews in the test set? The classifier will attain an accuracy of 93.48%!!!!!!", "This means that our model will be 93.48% accurate and we will think that the model is good but in reality, the model \u201cjust knows best\u201d how the predict one class (positive reviews). In fact, from Fig 4, SVM predicted no neutral review at all", "To understand this problem further, let us introduce another metric: F1 score, and use it to evaluate our models.", "The F1 score is the harmonic mean of the precision and recall Wikipedia.", "Precision and recall measures how well the model correctly classifies the positive cases and the negative cases. Read more here.", "When we evaluate our models on this metric the result is as follows", "From Fig 6 and Fig 7, we now know that the models are very good in classifying positive reviews and poor in predicting negative and neutral reviews.", "As a way of balancing the data we decided to randomly drop some positive reviews so that we use evenly-distributed reviews on training the model. This time round we are training the model on 1055 positive reviews and 1055 negative reviews. We are also dropping the neutral class.", "(You can also consider using oversampling techniques to fix the problem of imbalanced data)", "After training the models we ended up with the following results", "SVM attains the best result of 88.9% accuracy and upon checking the F1 score (below) we can now realize that the models predicts negative reviews as good as positive ones.", "If we look at the confusion matrix showing the results of SVM we notice that the model is good in predicting both classes", "After going through this project I hope you were able to learn that:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist || Statistician||Writer. You can contact me on LinkedIn on: https://www.linkedin.com/in/kipronokoech/ or on email using: kiprono@aims.ac.za"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F60666d90ec19&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----60666d90ec19--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----60666d90ec19--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kiprono_65591?source=post_page-----60666d90ec19--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kiprono_65591?source=post_page-----60666d90ec19--------------------------------", "anchor_text": "Kiprono Elijah Koech"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9872f324f100&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&user=Kiprono+Elijah+Koech&userId=9872f324f100&source=post_page-9872f324f100----60666d90ec19---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60666d90ec19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60666d90ec19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/kipronokoech/Reviews-Classification/blob/master/data_collection.ipynb", "anchor_text": "this notebook"}, {"url": "https://towardsdatascience.com/web-scraping-scraping-table-data-1665b6b2271c", "anchor_text": "Web Scraping: Scraping Table DataIt this post, we will learn how to scrape web data using Python. Simplified.towardsdatascience.com"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Sklearn"}, {"url": "https://scikit-learn.org/stable/modules/feature_extraction.html", "anchor_text": "link"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "link"}, {"url": "https://github.com/kipronokoech/Reviews-Classification", "anchor_text": "link"}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "here"}, {"url": "https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/", "anchor_text": "oversampling techniques"}, {"url": "https://github.com/kipronokoech/Reviews-Classification", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----60666d90ec19---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----60666d90ec19---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/sklearn?source=post_page-----60666d90ec19---------------sklearn-----------------", "anchor_text": "Sklearn"}, {"url": "https://medium.com/tag/data-processing?source=post_page-----60666d90ec19---------------data_processing-----------------", "anchor_text": "Data Processing"}, {"url": "https://medium.com/tag/python?source=post_page-----60666d90ec19---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F60666d90ec19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&user=Kiprono+Elijah+Koech&userId=9872f324f100&source=-----60666d90ec19---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F60666d90ec19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&user=Kiprono+Elijah+Koech&userId=9872f324f100&source=-----60666d90ec19---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60666d90ec19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----60666d90ec19--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F60666d90ec19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----60666d90ec19---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----60666d90ec19--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----60666d90ec19--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----60666d90ec19--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----60666d90ec19--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----60666d90ec19--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----60666d90ec19--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----60666d90ec19--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----60666d90ec19--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kiprono_65591?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kiprono_65591?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kiprono Elijah Koech"}, {"url": "https://medium.com/@kiprono_65591/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://www.linkedin.com/in/kipronokoech/", "anchor_text": "https://www.linkedin.com/in/kipronokoech/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9872f324f100&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&user=Kiprono+Elijah+Koech&userId=9872f324f100&source=post_page-9872f324f100--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fab1eb8a83bbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-machine-learning-project-reviews-classification-60666d90ec19&newsletterV3=9872f324f100&newsletterV3Id=ab1eb8a83bbd&user=Kiprono+Elijah+Koech&userId=9872f324f100&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}