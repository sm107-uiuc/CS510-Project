{"url": "https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2", "time": 1683015194.181568, "path": "towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2/", "webpage": {"metadata": {"title": "End to End Adaptation of ResNet in Google Colab \u2014 Part 3: Image Pre-Processing | by Dev Dash MD MPH | Towards Data Science", "h1": "End to End Adaptation of ResNet in Google Colab \u2014 Part 3: Image Pre-Processing", "description": "Part 1 \u2014 Overview of the entire project. No python was required, only a Google and Kaggle account. Hopefully you have convinced yourself that you personally are able to run the code in its entirety\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-1-5e56fce934a6", "anchor_text": "Part 1", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-2-hardware-dataset-setup-f23dd4e0004d", "anchor_text": "Part 2", "paragraph_index": 2}, {"url": "https://colab.research.google.com/drive/1W5tU1X3w1uIY-R1HpQredT1vpiLGcDIQ?usp=sharing", "anchor_text": "Cat & Dog \u2014 Resnet-18", "paragraph_index": 3}, {"url": "https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html", "anchor_text": "Deep Learning with Pytorch", "paragraph_index": 24}, {"url": "https://pytorch.org/tutorials/beginner/blitz/neural_networks_tutorial.html", "anchor_text": "Neural Networks with Pytorch.", "paragraph_index": 25}, {"url": "https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html", "anchor_text": "Transfer Learning for Computer Vision.", "paragraph_index": 26}], "all_paragraphs": ["A quick recap of what we\u2019ve done so far:", "Part 1 \u2014 Overview of the entire project. No python was required, only a Google and Kaggle account. Hopefully you have convinced yourself that you personally are able to run the code in its entirety, as well as testing it.", "Part 2 \u2014 The libraries were imported as well as the database from Kaggle. It was unzipped (uncompressed) into a folder. We also did a short overview of how to figure out what kind of hardware you\u2019re working with. GPU information is important when dealing with image databases like ours.", "Link to Colab Notebook: Cat & Dog \u2014 Resnet-18", "Before we\u2019re able to \u2018load\u2019 images into the architecture for training, we must preprocess them first.", "The code above creates this following structure (val and train under the main dataset folder, and folders of dogs and cats in their respective subfolder):", "For those of you wishing for nomenclature, we are performing supervised machine learning here, with labeled data. The way we are \u2018labeling\u2019 the data is by putting it in a folder. The code will be told to use the name of the folder containing the images as the label.", "I will almost certainly trip up on this in the future, but the more you read about neural networks, the words \u2018modeling\u2019 and \u2018models\u2019 start to blur together and you can invariably produce statements like \u2018We are modeling our problem with this particular model.\u2019", "When referring to the technical definition of the model, I encourage you to use the word architecture. I admit my code will have statements like \u2018train_model\u2019 but in this case, model = architecture, i.e. the ResNet-18 architecture. \u2018We are modeling our problem with this particular architecture\u2019 sounds a lot more palatable.", "The initial step is to split the data into training and testing. We will use the training data to train our architecture (adjust the parameters). ResNet-18 has 11 million trainable parameters. The testing set will be used to measure how well the architecture is performing, showing it new data as a \u2018test\u2019.", "The \u2018src_directory\u2019 contains all the images. \u2018listdir\u2019 gets the listing of all the files in the source directory and if the file starts with \u2018cat\u2019, we place it in the cats folder, same with dog. This is captured in \u2018file.startswith(\u2018cat or dog\u2019)\u2019.", "You can see that by default, the destination is the \u2018train\u2019 folder, unless a random number (defaulted to be between 0 and 1) is less than 0.25 \u2014 which should happen around 25% of the time, in which case the file gets shuttled to the \u2018val\u2019 folder.", "A bit to unpack here. Let me get one line out of the way \u2014 \u2018Resize\u2019. The ResNet architecture expects images that are 224x224 (why is not in scope of this post), so both train and val (validation) images have to be resized as such.", "Lets do this backward. The line \u2018ToTensor()\u2019 \u2014 sets our image up for computation. It is essentially a multidimensional array (height, width, color space). The \u2018Normalize\u2019 function for each [train, val] normalizes the data according to the three RGB channels. The first set of numbers is the mean, the second set is the standard deviation. These particular normalization values are used because the torchvision architectures (like ResNet) have been trained on ImageNet and calculated based off millions of images.", "That leaves three transforms \u2014 Rotation, RandomHorizontalFlip, and RandomResizedCrop. The \u2018what\u2019 of these transforms is easier to understand compared to the \u2018why\u2019. Essentially, you want to present as many different training images to your network. One way to increase the variety of these pictures is use a huge dataset \u2014 in this case almost 19,000 training images.", "We are able to artificially increase the variety of the images by doing small modifications on the images.", "Rotation and RandomHorizontalFlip are self explanatory.", "RandomResizedCrop picks a small patch out of the image (224x224 in this case) with a randomly picked range between 0.96 and 1.0 and with a randomly picked aspect ratio between 0.95 and 1.05.", "Dataloaders allow for batch delivery of the dataset into the architecture for training. They are critical for ensuring a streamlined flow of data. Accordingly, the first variable you see set is batch_size = 16. If you have trouble training (especially with GPU memory problems), decrease the batch size in multiples of 2.", "Data_dir sets the main directory of the training and validation images. The \u2018datasets.ImageFolder\u2019 allows for the labels to be set up as we\u2019ve done before \u2014 the name of the folder is the label itself (instead of the label embedded in the filename or stored elsewhere). You can see the \u2018data_transforms\u2019 that we defined above is applied within the \u2018image_datasets\u2019 variable.", "\u2018torch.utils.data.DataLoader\u2019 allows for \u2018image_datasets\u2019 to incorporate into the \u2018dataloaders\u2019 variable.", "We later split the \u2018dataloaders\u2019 variable into \u2018train_dataloader\u2019 and \u2018val_dataloader\u2019 in the last two lines.", "Finally, ensuring the GPU is used: device = torch.device(\u201ccuda:0\u201d). We will make sure the architecture is loaded onto the GPU in the coming steps.", "Please leave any questions below and I will try to answer them as best I can.", "[1] Deep Learning with Pytorch, Accessed October 2020", "[2] Neural Networks with Pytorch. Accessed October 2020", "[3] Transfer Learning for Computer Vision. Accessed October 2020", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffe30917d9aa2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://piotrr.medium.com/?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": ""}, {"url": "https://piotrr.medium.com/?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": "Dev Dash MD MPH"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21d76fb2c1a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=post_page-21d76fb2c1a9----fe30917d9aa2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe30917d9aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe30917d9aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@martinadams", "anchor_text": "Unsplash.com"}, {"url": "https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-1-5e56fce934a6", "anchor_text": "Part 1"}, {"url": "https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-2-hardware-dataset-setup-f23dd4e0004d", "anchor_text": "Part 2"}, {"url": "https://colab.research.google.com/drive/1W5tU1X3w1uIY-R1HpQredT1vpiLGcDIQ?usp=sharing", "anchor_text": "Cat & Dog \u2014 Resnet-18"}, {"url": "https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html", "anchor_text": "Deep Learning with Pytorch"}, {"url": "https://pytorch.org/tutorials/beginner/blitz/neural_networks_tutorial.html", "anchor_text": "Neural Networks with Pytorch."}, {"url": "https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html", "anchor_text": "Transfer Learning for Computer Vision."}, {"url": "https://github.com/Kaggle/kaggle-api", "anchor_text": "Kaggle API."}, {"url": "https://medium.com/tag/pytorch?source=post_page-----fe30917d9aa2---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----fe30917d9aa2---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/transformation?source=post_page-----fe30917d9aa2---------------transformation-----------------", "anchor_text": "Transformation"}, {"url": "https://medium.com/tag/resnet?source=post_page-----fe30917d9aa2---------------resnet-----------------", "anchor_text": "Resnet"}, {"url": "https://medium.com/tag/end2end?source=post_page-----fe30917d9aa2---------------end2end-----------------", "anchor_text": "End2end"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe30917d9aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=-----fe30917d9aa2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe30917d9aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=-----fe30917d9aa2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe30917d9aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffe30917d9aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fe30917d9aa2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fe30917d9aa2--------------------------------", "anchor_text": ""}, {"url": "https://piotrr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://piotrr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dev Dash MD MPH"}, {"url": "https://piotrr.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://www.linkedin.com/in/dev-dash-6b6834173/", "anchor_text": "https://www.linkedin.com/in/dev-dash-6b6834173/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21d76fb2c1a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=post_page-21d76fb2c1a9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F78b6f9b4cc46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fend-to-end-adaptation-of-resnet-in-google-colab-part-3-image-pre-processing-fe30917d9aa2&newsletterV3=21d76fb2c1a9&newsletterV3Id=78b6f9b4cc46&user=Dev+Dash+MD+MPH&userId=21d76fb2c1a9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}