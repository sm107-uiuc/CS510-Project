{"url": "https://towardsdatascience.com/transformation-scaling-of-numeric-features-intuition-7f4436e8e074", "time": 1683005054.75206, "path": "towardsdatascience.com/transformation-scaling-of-numeric-features-intuition-7f4436e8e074/", "webpage": {"metadata": {"title": "Explained: ML Transformation & Scaling | by Manu Sharma | Towards Data Science", "h1": "Explained: ML Transformation & Scaling", "description": "Scaling, Standardizing and Transformation are important steps of numeric feature engineering and they are being used to treat skewed features and rescale them for modelling. Machine Learning & Deep\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/home-credit-default-risk/data", "anchor_text": "Data", "paragraph_index": 4}, {"url": "https://github.com/manu007sharma/Medium_Notebooks/tree/master/Scale_Transform", "anchor_text": "Notebook", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/pandas-index-explained-b131beaf6f7b", "anchor_text": "Pandas Index -Invisible", "paragraph_index": 34}, {"url": "https://medium.com/analytics-vidhya/pandas-stack-unstack-pivot-table-crosstab-5cb9a16fe020", "anchor_text": "Pandas Pivot & Stacking", "paragraph_index": 34}], "all_paragraphs": ["Scaling, Standardizing and Transformation are important steps of numeric feature engineering and they are being used to treat skewed features and rescale them for modelling. Machine Learning & Deep Learning algorithms are highly dependent on the input data quality. If Data quality is not good, even high-performance algorithms are of no use. It\u2019s as simple as Garbage In : Garbage Out.", "Data Scientists have so many preprocessing steps to test & validate before the modelling. And that further adds the confusion around the effect and use of transformation and scaling. Here we will try to answer some of the questions while using a public dataset", "When to use Transformation or Scaling? Which scaler to use? Which algorithms benefit?", "Data used for this exercise is the main datafile from Home Credit Default Risk. Data is collated around to predict clients\u2019 repayment abilities. Data is for all the loan applications, one row represents one loan application in our data sample.", "DataSet can be downloaded from \u2014 Data. And Jupyter Notebook can be downloaded from \u2014 Notebook.", "Dataset is published for explaining the capability of each applicant\u2019s repaying a loan? Below is the distribution of the Target feature and some of the independent features. Target feature has imbalanced data problem, the positive class only has 8% ratio of the full data.", "Below are some of the important numeric independent features and their histogram. They are picked just for the exercise explanation. They all are looking in different ranges and scales e.g. AMT_ANNIUITY is in mn range but OWN_CAR_AGE can max go till 90.", "Below is the original data\u2019s combined boxplot, it is looking highly skewed because of the different scale and skewed features in one space.", "Normally distributed features are an assumption in Statistical algorithms. Deep learning & Regression-type algorithms also benefit from normally distributed data.", "Transformation is required to treat the skewed features and make them normally distributed. Right skewed features can be transformed to normality with Square Root/ Cube Root/ Logarithm transformation.", "As per the above histograms AMT_ANNUITY, AMT_CREDIT, AMT_GOODS_PRICE, AMT_INCOME_TOTAL, & OWN_CAR_AGE are skewed numeric features and DAYS_BIRTH are normally distributed.", "Skewness can be because of one of the two reasons", "Introduction of log transformation: As the left graph exhibits, the output of the Log function for positive values increases very slowly. So higher values are marginalized more as compared to the lower observations.", "Effects of Transformation: Skewed Numeric feature may get normally distributed after log transformation. For example, in the below graph AMT_CREDIT is normally distributed after the log transformation.", "Scaling is required to rescale the data and it\u2019s used when we want features to be compared on the same scale for our algorithm. And, when all features are in the same scale, it also helps algorithms to understand the relative relationship better.", "If dependent features are transformed to normality, Scaling should be applied after transformation.", "Which Algorithms may benefit after Scaling? Scaling is helpful in Distance-based algorithms and also in faster convergence", "Linear & Logistic Regression, KMeans/ KNN, Neural Networks, PCA will benefit from scaling", "Which Algorithms may not benefit after Scaling? Some algorithms are independent of Scaling. Entropy & Information Gain based techniques are not sensitive to monotonic transformation.", "Tree-Based Algorithms, Decision Tree, Random Forest, Boosted Trees(GBM, light GBM, xgboost) may not benefit from scaling.", "During Scaling/ Standardizing/ Normalizing, we will follow sklearn vocabulary, so it\u2019s a good choice to use general word Scaling instead of Standardizing or Normalizing", "Scaler model fitted on the train data will be used to transform the test set. Never fit scaler again on the test data", "Sklearn has following four scalers primarily", "1. Minmax scaler2. Robust scaler3. Standard Scaler4. Normalizer.", "Minmax scaler should be the first choice for scaling. For each feature, each value is subtracted by the minimum value of the respective feature and then divide by the range of original maximum and minimum of the same feature. It has a default range between [0,1].", "Below is the histogram of all 6 feature after the Minmax scaling. We haven\u2019t log-transformed any of the features before scaling. MinMaxScaler hasn't changed the internal distribution of the feature and also brought everyone on the same scale.", "Below is the combined box plot of all 6 features after scaling. And, all are in the range of [0,1 ]. The internal space between each feature\u2019s values has been maintained and their relative distribution is also looking better as compared to the original data", "RobustScaler can be used when data has high outliers and we want to subside their effects. But unimportant outliers should be removed in the first place. RobustScaler subtracts the column\u2019s median and divides by the interquartile range.", "Following graph is a histogram of features after the Robust Scaler. Though the histogram looks similar to the original data distribution, their respective internal distance space is not maintained like the original data.", "Also, as seen in the below box plot, now the range is not in [0,1]. And also the relative spaces between each feature\u2019s values are distorted and not same now. Using robustscaler, in this case, will pass wrong information to the modelling process about your underlying data.", "StandardScaler rescales each column to have 0 mean and 1 Standard Deviation. It standardizes a feature by subtracting the mean and dividing by the standard deviation. If the original distribution is not normally distributed, it may distort the relative space among the features.", "Below is the histogram of features after applying standard scaler, Distribution is looking similar to the original data distribution, but they aren\u2019t same, their respective internal distance of observations are changed during standard scaling.", "Following is a combined boxplot of features after the standard scaling, As expected, it distorts the relative distances between the feature values, where after min-max they were looking better", "Normalizer is applied on rows, not columns, so sklearn users shouldn\u2019t get confused and must not use normalizer. Some of the used applications cases of Normalizer are comparing multiple entities during the same time-series, i.e. stock movements of multiple stocks in a given period", "Thanks for reading. If you have liked this article, you may also like Pandas Index -Invisible Soul, Pandas Pivot & Stacking", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7f4436e8e074&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@manusharma_66718?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@manusharma_66718?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": "Manu Sharma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcc90427ba155&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&user=Manu+Sharma&userId=cc90427ba155&source=post_page-cc90427ba155----7f4436e8e074---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f4436e8e074&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f4436e8e074&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@paucasals?utm_source=medium&utm_medium=referral", "anchor_text": "Pau Casals"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/home-credit-default-risk/data", "anchor_text": "Data"}, {"url": "https://github.com/manu007sharma/Medium_Notebooks/tree/master/Scale_Transform", "anchor_text": "Notebook"}, {"url": "https://towardsdatascience.com/pandas-index-explained-b131beaf6f7b", "anchor_text": "Pandas Index -Invisible"}, {"url": "https://medium.com/analytics-vidhya/pandas-stack-unstack-pivot-table-crosstab-5cb9a16fe020", "anchor_text": "Pandas Pivot & Stacking"}, {"url": "https://medium.com/@manusharma_66718", "anchor_text": "Medium"}, {"url": "http://www.linkedin.com/in/data2datasciences/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7f4436e8e074---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7f4436e8e074---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----7f4436e8e074---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----7f4436e8e074---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----7f4436e8e074---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7f4436e8e074&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&user=Manu+Sharma&userId=cc90427ba155&source=-----7f4436e8e074---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7f4436e8e074&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&user=Manu+Sharma&userId=cc90427ba155&source=-----7f4436e8e074---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f4436e8e074&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7f4436e8e074&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7f4436e8e074---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7f4436e8e074--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7f4436e8e074--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7f4436e8e074--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7f4436e8e074--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@manusharma_66718?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@manusharma_66718?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Manu Sharma"}, {"url": "https://medium.com/@manusharma_66718/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "151 Followers"}, {"url": "https://www.linkedin.com/in/data2datasciences/", "anchor_text": "https://www.linkedin.com/in/data2datasciences/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcc90427ba155&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&user=Manu+Sharma&userId=cc90427ba155&source=post_page-cc90427ba155--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fff7c6438cf6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransformation-scaling-of-numeric-features-intuition-7f4436e8e074&newsletterV3=cc90427ba155&newsletterV3Id=ff7c6438cf6d&user=Manu+Sharma&userId=cc90427ba155&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}