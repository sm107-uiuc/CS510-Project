{"url": "https://towardsdatascience.com/average-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2", "time": 1683000602.489333, "path": "towardsdatascience.com/average-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2/", "webpage": {"metadata": {"title": "Average Rolling based Real-time Calamity Detection using Deep Learning | by Gautam Kumar | Towards Data Science", "h1": "Average Rolling based Real-time Calamity Detection using Deep Learning", "description": "Natural disasters like hurricanes, wildfire, earthquake, flood, tsunamis, and volcanic eruption often have catastrophic effects on human lives and cause significant infrastructure harm. It is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/gautamkumarjaiswal/videoClassification", "anchor_text": "GitHub", "paragraph_index": 12}, {"url": "https://drive.google.com/file/d/1PgItDyMsg57mwe3uxIlWGTP-KTbyqKf6/view?usp=sharing", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://drive.google.com/file/d/1vn6EhgsCbxp6pBd_AXrtLyMhc6xEjduR/view?usp=sharing", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://drive.google.com/drive/folders/1QuQMPqwMb6baTHdg67BFmTQ91Z0fXxAZ?usp=sharing", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://www.twilio.com/", "anchor_text": "twilio", "paragraph_index": 14}, {"url": "https://www.pyimagesearch.com/author/adrian/", "anchor_text": "Adrian Rosebrock", "paragraph_index": 15}], "all_paragraphs": ["Natural disasters like hurricanes, wildfire, earthquake, flood, tsunamis, and volcanic eruption often have catastrophic effects on human lives and cause significant infrastructure harm. It is challenging to detect these disasters as quickly as possible before it can largely affect human and animal lives. Remote sensing applications are used for this purpose. Images captured from the satellite are assessed to identify any abnormal change in the atmosphere, which may lead to a natural disaster. However, these systems are still not fully automatic and require human effort to analyze satellite images properly. Use of human resources for this purpose makes this process time-taking and also human error-prone. Recently, a wildfire in Amazon rainforest got the attention of the world when NASA released a satellite image of the burning forest. The forest could be saved if we can detect wildfire at an early stage and take appropriate action to minimize losses. Current advances in remote sensing applications yield significant success in the management of natural disasters. It still requires human effort and time to analyze satellite images, which causes a delay in prediction. This challenge leads to a substantial loss of infrastructure and lives. Therefore, a fully automated system is the need of the hour, which can identify these natural disasters with minimum time delay. This system can prevent the loss of precious human lives and other resources.In this study, we developed an automated calamity detection system using deep learning, which can predict disasters in real-time and send an alert message. For this purpose, we trained ResNet50 CNN model, and performance is measured by calculating the confusion matrix. Model is also tested with pre-recorded videos acquired from satellites and drones. Experimental results yield 91% accuracy and perform well when tested with videos collected from YouTube.", "Database collection: We collected satellite images of different calamities such as cyclone (928 images), wildfire (1077 images), earthquake (1350 images) and flood (1070 images).", "Preprocessing: Database images of varying spatial resolutions are resized to the image of size 224 x 224 followed by conversion into RGB format. To avoid overfitting/underfitting, we follow data augmentation approach and applied transformation such as rotation (30), zoom (0.15), width shift and height shift (0.2), shear range (0.15) and horizontal flip randomly to each image. This augmented image is taken as an input to the convolutional neural network (CNN) model.", "Model training: Instead of training CNN model from sketch, we used transfer learning technique using pre-trained ImageNet weights. We used ResNet50 as the backbone model, all the internal layers upto global average pooling (GAP) layer remains unchanged. We have removed FC layer and added average pooling (pool_size = (7, 7)), Flatten, Dense layer (512), Dropout layer (0.5) and Dense layer followed by Activation (softmax). The fine tuned architecture is shown in Figure 1.", "A model (M) is obtained by the training the CNN with 80 epoch.The performance of the model is evaluated in two phases. In the first phase, a sample test image dataset from the collected database is used to evaluate its performance. Evaluation metric such as precision, recall and accuracy of the system is measured. We also plot Receiver Operating Characteristics (ROC) curve to show trade-off between false positive rate and true positive rate. We analyzed the performance of the model by plotting precision-recall and area under curve.", "In the second phase, real-time videos are provided as input to the system. From a live video stream source (S), a frame is extracted and pre-processed by resizing it (to the size of the image which was used to train model) followed by conversion of RGB channel ordering. Each extracted and pre-processed frame from the live video is fed to model to predict its class label. The algorithm calculates the probability of each class and returns a label corresponding to class for which probability is maximum. This process is repeated for each frame from a video stream. For each incoming frame, predicted class and its probability are annotated on the output frame. Therefore, we get output video as a series of the annotated frame showing class label and the probability of predicted class. However, there is a problem with this method called \u2018prediction flickering\u2019. Due to this, label in the output video frequently changes among classes.", "Principle of Rolling Averaging: To reduce the flickering effect, we applied the principle of rolling averaging. It is also known as running average or moving mean or rolling mean and generally used for time series data to reduce fluctuations in the output. A subset of input time series data represented by a queue (Q) of size k = 64 is maintained to apply rolling averaging. Mean is calculated over the last \u2018k\u2019 prediction from the Q and class label (L) of the largest corresponding probability is selected to label the output frame. Please refer Figure 2 to understand this process mathematically.", "The database is divided into train and test set in a ratio of 80:20. CNN model is trained by 80% of database image while tested with 20%, and confusion matrix is plotted for the test set. We calculate True Positive (TP), False Positive (FP), True Negative (TN) and False Negative (TN). From these parameters, we calculate the Sensitivity, Recall, F-score, and Accuracy of the system. We also plot the Receiver Operating Characteristics curve (ROC) and Precision-Recall curve to analyze the result, which is shown in Figure 3 and 4 respectively. Figure 5 represents confusion matrix which shows the classification accuracy of all types of classes.", "The developed system takes pre-recorded video or real-time video as an input, extract frames from the video and fed it to trained CNN model. CNN model takes each frame sequentially and process it to predict the type of calamity and produces a sequence of labeled frames as output. Each output frame is annotated with the type of predicted calamity along with its corresponding probability. In case no disaster is detected, the frame is annotated as \u2018Normal\u2019. An alert message is generated only when there is a change in the label of the output frame. For frames annotated as \u2018Normal\u2019, no message is generated. Output of system when tested with per-recorded video is shown below.", "A sample outputs generated by the system is shown in Figure 6.", "An alert message is generated only when there is a change in the label of the output frame. For frames annotated as \u2018Normal\u2019 no message is generated. We used the trial version of Twilio API to send a message to a mobile number, as shown in Figure 7.", "The proposed real-time calamity detection system can be used to detect disaster and generate an alert automatically. This system can be used for two different purposes. First, to process satellite images to predict and warn cyclone and forest fire. Second, to process satellite images for quick detection of affected regions during natural calamities like flood and high-intensity earthquakes. This idea can be used to predict the disaster through a satellite camera. For example, a geostationary satellite which is situated over the coastal region can detect cyclone while polar satellite can easily capture a live stream of forest, mountains, rivers, flood areas etc and if it finds any sign calamity, system can automatically generate an alert. Therefore, it dramatically reduces human effort and time to analyze the satellite image for any type of disaster. For earthquake, it is difficult to predict in advance using a satellite image, but the system can record details of the affected/destroyed areas. Similarly, in case of flood, the proposed method can quickly detect and generate an alert in an automated way which can help us to take necessary steps against these calamities. Therefore, the proposed system can be used as a \u2018eyes in the sky\u2019 and can help the research community to predict disaster in advance and to optimize the damages during natural calamities.", "The complete source code of the project is available at my GitHub repository. Trained model can be downloaded from here and here. You will get two files \u2018activity_gpu.model\u2019 and \u2018lb.pickle\u2019, keep both files inside \u2018model\u2019 folder downloaded from GitHub. To test developed model, download test video from here and keep it inside \u2018example_clips\u2019 folder and run the predict_video.py file as", "python predict_video.py \u2014 model model/activity_gpu.model \u2014 label-bin model/lb.pickle \u2014 input example_clips/cyclone_movie.mp4 \u2014 output output/cyclon_movie_output.avi \u2014 size 10", "If everything is okay, system will pop-up a new window showing output of the model. However, to get alert message on your mobile phone you have to create account at twilio and modify code as mentioned in the comment section of \u2018train.py\u2019 file. You can also use other API for alert generation. To train the model from sketch use train.py file. At my GitHub repository, I have provided only 5 samples of each class. If you find any error during training then download at-least 40 images of each class and train the network again.", "This project bagged 2nd position in the competition \u201cInnovative idea and Design\u201d organized by Indian Space Research Organization (ISRO) in a collaboration with National Institute of Technology, Rourkela, INDIA on 20th Sept 2019. Development of the project is equally contributed by Jayeeta Chakraborty. Thanks Adrian Rosebrock for excellent tutorials which also helped me to develop this project.", "Feel free to download/modify code. You are welcome to ask any question and give suggestion/feedback. Hope you may find this article helpful. Thank you for your time. Have a great day :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD, National Institute of Technology, Rourkela, INDIA"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae51a2ffd8d2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gautamkumarjaiswal?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gautamkumarjaiswal?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": "Gautam Kumar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff52761adf17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&user=Gautam+Kumar&userId=ff52761adf17&source=post_page-ff52761adf17----ae51a2ffd8d2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://github.com/gautamkumarjaiswal/videoClassification", "anchor_text": "GitHub"}, {"url": "https://drive.google.com/file/d/1PgItDyMsg57mwe3uxIlWGTP-KTbyqKf6/view?usp=sharing", "anchor_text": "here"}, {"url": "https://drive.google.com/file/d/1vn6EhgsCbxp6pBd_AXrtLyMhc6xEjduR/view?usp=sharing", "anchor_text": "here"}, {"url": "https://drive.google.com/drive/folders/1QuQMPqwMb6baTHdg67BFmTQ91Z0fXxAZ?usp=sharing", "anchor_text": "here"}, {"url": "https://www.twilio.com/", "anchor_text": "twilio"}, {"url": "https://www.pyimagesearch.com/author/adrian/", "anchor_text": "Adrian Rosebrock"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ae51a2ffd8d2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ae51a2ffd8d2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/realtime?source=post_page-----ae51a2ffd8d2---------------realtime-----------------", "anchor_text": "Realtime"}, {"url": "https://medium.com/tag/calamity?source=post_page-----ae51a2ffd8d2---------------calamity-----------------", "anchor_text": "Calamity"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----ae51a2ffd8d2---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae51a2ffd8d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&user=Gautam+Kumar&userId=ff52761adf17&source=-----ae51a2ffd8d2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae51a2ffd8d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&user=Gautam+Kumar&userId=ff52761adf17&source=-----ae51a2ffd8d2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae51a2ffd8d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae51a2ffd8d2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae51a2ffd8d2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gautamkumarjaiswal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gautamkumarjaiswal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gautam Kumar"}, {"url": "https://medium.com/@gautamkumarjaiswal/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "122 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff52761adf17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&user=Gautam+Kumar&userId=ff52761adf17&source=post_page-ff52761adf17--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffc205380dc90&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faverage-rolling-based-real-time-calamity-detection-using-deep-learning-ae51a2ffd8d2&newsletterV3=ff52761adf17&newsletterV3Id=fc205380dc90&user=Gautam+Kumar&userId=ff52761adf17&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}