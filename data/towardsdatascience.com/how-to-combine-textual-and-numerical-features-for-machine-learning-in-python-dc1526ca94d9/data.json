{"url": "https://towardsdatascience.com/how-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9", "time": 1683018186.155218, "path": "towardsdatascience.com/how-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9/", "webpage": {"metadata": {"title": "How to Combine Textual and Numerical Features for Machine Learning in Python | by Yuki Takahashi | Towards Data Science", "h1": "How to Combine Textual and Numerical Features for Machine Learning in Python", "description": "Data in applied machine learning for NLP often contain both text and numerical inputs. For instance, when you build a model to predict future sales of a product from twitter or news, it would be more\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/lstm-vs-bert-a-step-by-step-guide-for-tweet-sentiment-analysis-ced697948c47?sk=f3c8716107a4cf54e7efbec2bc7bc84b", "anchor_text": "LSTM vs BERT \u2014 a step-by-step guide for tweet sentiment analysis", "paragraph_index": 6}, {"url": "https://github.com/yuki678", "anchor_text": "https://github.com/yuki678", "paragraph_index": 8}], "all_paragraphs": ["Data in applied machine learning for NLP often contain both text and numerical inputs. For instance, when you build a model to predict future sales of a product from twitter or news, it would be more effective to consider past sales figures, the number of visitors, market trend, etc. along with the texts. You won\u2019t predict a stock price movement simply from news sentiment but rather use it to compliment the model based on economic indices and the historical prices. This post shows how to combine text inputs and numerical inputs in scikit-learn (for Tfidf) and pytorch (for LSTM/BERT).", "When you have a training dataframe which contains both number fields and text and apply a simple model from scikit-lean or some equivalent, one of the easiest way is to use sklearn.pipeline.FeatureUnion in Pipeline.", "The following example assumes X_train to be a pandas DataFrame, which consists of many number fields with a text field at the last column. Then you can create a FunctionTransformer to separate the number columns and the text column. The functions passed to this FunctionTransformer can be anything, so modify this according to your input data. Here it simply return the last column as textual feature and the rest as numerical features. Then apply Tfidf Vectorizer on texts and fed into the classifier. This sample uses RandomForest as an estimator and GridSearchCV to search the best model in the given parameters but it can be anything else.", "Scikit-learn provides good APIs to manage ML pipeline, which just does the job and can even more complex steps in the same way.", "If you apply deep neural network, it\u2019s more common to use either Tensorflow/Keras or Pytorch to define the layers. Both have similar APIs and can combine the text and number inputs in the same way and the following sample uses pytorch.", "To process texts in a neural network, first it should be embedded in such a way that the model expects. It is also common to have a dropout layer to avoid overfitting. This model add one dense layer (i.e. fully-connected layer) before concatenating with numerical features to balance the number of features. Finally, apply the dense layer to output the desired number of output.", "If you are looking for the end-to-end process how to apply the above LSTM/BERT models in the deep learning, please refer to this post \u2014 LSTM vs BERT \u2014 a step-by-step guide for tweet sentiment analysis.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A product manager in London. Github \u2014 https://github.com/yuki678"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdc1526ca94d9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yuki678.medium.com/?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": ""}, {"url": "https://yuki678.medium.com/?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": "Yuki Takahashi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3acb9d6e47b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&user=Yuki+Takahashi&userId=3acb9d6e47b8&source=post_page-3acb9d6e47b8----dc1526ca94d9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc1526ca94d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc1526ca94d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://unsplash.com/@moritz_photography?utm_source=medium&utm_medium=referral", "anchor_text": "Moritz Kindler"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/lstm-vs-bert-a-step-by-step-guide-for-tweet-sentiment-analysis-ced697948c47?sk=f3c8716107a4cf54e7efbec2bc7bc84b", "anchor_text": "LSTM vs BERT \u2014 a step-by-step guide for tweet sentiment analysis"}, {"url": "https://medium.com/tag/ai?source=post_page-----dc1526ca94d9---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/nlp?source=post_page-----dc1526ca94d9---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----dc1526ca94d9---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----dc1526ca94d9---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----dc1526ca94d9---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdc1526ca94d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&user=Yuki+Takahashi&userId=3acb9d6e47b8&source=-----dc1526ca94d9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdc1526ca94d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&user=Yuki+Takahashi&userId=3acb9d6e47b8&source=-----dc1526ca94d9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc1526ca94d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdc1526ca94d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dc1526ca94d9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dc1526ca94d9--------------------------------", "anchor_text": ""}, {"url": "https://yuki678.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yuki678.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yuki Takahashi"}, {"url": "https://yuki678.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "385 Followers"}, {"url": "https://github.com/yuki678", "anchor_text": "https://github.com/yuki678"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3acb9d6e47b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&user=Yuki+Takahashi&userId=3acb9d6e47b8&source=post_page-3acb9d6e47b8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F23923a612f87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-combine-textual-and-numerical-features-for-machine-learning-in-python-dc1526ca94d9&newsletterV3=3acb9d6e47b8&newsletterV3Id=23923a612f87&user=Yuki+Takahashi&userId=3acb9d6e47b8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}