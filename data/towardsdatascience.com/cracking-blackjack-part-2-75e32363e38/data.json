{"url": "https://towardsdatascience.com/cracking-blackjack-part-2-75e32363e38", "time": 1683011333.199003, "path": "towardsdatascience.com/cracking-blackjack-part-2-75e32363e38/", "webpage": {"metadata": {"title": "Cracking Blackjack \u2014 Part 2. Intro to Reinforcement Learning &\u2026 | by adithyasolai | Towards Data Science", "h1": "Cracking Blackjack \u2014 Part 2", "description": "If you haven\u2019t done so already, please read Part 1 before continuing. The rest of this article will assume you have read and understood Part 1. To move forward with our mission to \u201ccrack\u201d Blackjack\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@ppalanic/cracking-blackjack-part-1-31da28aeb4bb?source=friends_link&sk=ce1251c59477bf8a6977ef232fd1d234", "anchor_text": "Part 1", "paragraph_index": 0}, {"url": "https://medium.com/@ppalanic/cracking-blackjack-part-1-31da28aeb4bb?source=friends_link&sk=ce1251c59477bf8a6977ef232fd1d234", "anchor_text": "Part 1", "paragraph_index": 9}, {"url": "https://gym.openai.com/", "anchor_text": "OpenAI Gym", "paragraph_index": 10}, {"url": "https://medium.com/@ppalanic/cracking-blackjack-part-1-31da28aeb4bb?source=friends_link&sk=ce1251c59477bf8a6977ef232fd1d234", "anchor_text": "Part 1", "paragraph_index": 13}], "all_paragraphs": ["If you haven\u2019t done so already, please read Part 1 before continuing. The rest of this article will assume you have read and understood Part 1.", "To move forward with our mission to \u201ccrack\u201d Blackjack using Reinforcement Learning, we must understand the image above. Below, I have broken down the image into its components, and their equivalents in Blackjack:", "The cycle above implies that this loop will go on indefinitely, so where/when does the actual learning happen?", "A single cycle can be represented as a sequence:", "As we do loops around this cycle, we can record these State/Action/Reward tuples. Going through some \u201cn\u201d number of loops around the cycle and recording State/Action/Reward tuples as we go along is called an episode.", "After we do our desired number of loops (let\u2019s say 50), our agent will go through the State/Action/Reward tuples and update its policy accordingly. In the next article, we will dive into exactly how our Reinforcement Learning algorithm will direct our agent in using these State/Action/Reward tuples to optimize its policy.", "How many loops around the cycle should comprise an episode? In my Blackjack environment, I considered one round of Blackjack to be one episode. This means that there will usually be 1\u20133 State/Action/Reward tuples per episode, because the agent will likely only make 1\u20133 stand/hit decisions per round of Blackjack (or more on rare occasions).", "Luckily, we had the notion of a \u201cround\u201d in Blackjack to help define an episode. However, other contexts, such as applying Reinforcement Learning to predict the stock market, do not have \u201crounds\u201d to help define episodes. There are no starting and stopping points in the stock market, and you will have to get creative when defining episodes!", "For these reasons, predicting the stock market using Reinforcement Learning would be considered a continuous task, and cracking Blackjack would be considered an episodic task.", "The Blackjack game we set up in Part 1 does not accurately model the Reinforcement Learning cycle. We are missing crucial components such as logging State/Action/Reward tuples and defining an episode.", "We will build our new Blackjack environment within the framework of OpenAI Gym. This framework provides a standardized method of defining our environment so that we can easily experiment with other self-written and open-source Reinforcement Learning algorithms. This framework also provides useful API to define our states, actions, and rewards more comprehensively.", "To build our environment, we will be defining the functions in the OpenAI Gym environment template. These functions are the necessary pieces in modeling the cycle process of Reinforcement Learning, and are as follows:", "Before diving into the code for these functions, let\u2019s see how these functions work together to model the Reinforcement Learning cycle. In the simulation below, we use our OpenAI Gym environment and the policy of randomly choosing hit/stand to find average returns per round.", "The code snippet below contains my implementation of Blackjack as an OpenAI Gym environment. Just skim through it for now, and go through it in more detail after finishing this article. I have detailed the key lines from each function below. These functions re-use some of the functions and classes built in Part 1.", "First, we utilize OpenAI Gym\u2019s spaces functions to define our action space: hit or stand. We use a discrete set of two binary choices: 0 for hit, and 1 for stand.", "Next, we define the observation space. An observation space is a set of all of the possible states that an agent can observe and respond to. A state in our version of Blackjack is the player\u2019s hand value and the dealer\u2019s up-card.", "The observation space is one component of the environment in the Reinforcement Learning cycle. Other components, such as calculating rewards and player hand value, are implemented in the step() function or re-used from Part 1.", "The full range of possible hand values we consider is 3 through 20. 2 is not possible because it requires two Aces, and our logic for calculating hand value does not evaluate two Aces to 2. For hand values 21 (Blackjack!) and beyond (bust), the agent does not have to make any decisions.", "The full range of possible dealer up-cards is 2 through Ace. Ace is represented by just 11, and not 1 as well. In our algorithm, the agent does not care about whether the dealer\u2019s Ace evaluates to 1 or 11 when learning and optimizing.", "The player\u2019s hand value range is 3 through 20, and that is a range of 18 discrete values. The dealer up-card range is 2 through Ace, and that is a range of 10 discrete values. We use OpenAI Gym\u2019s spaces functions again to represent this. We also use spaces.Tuple to signify that these two ranges must be multiplied together to get the full range of possible states.", "Finally, initialize the environment\u2019s done variable to False to ensure a full round of Blackjack is played before an episode ends.", "As mentioned before, this function re-uses functions from Part 1 to reset and re-shuffle the deck, deal 2 cards to player and dealer, and evaluate the player\u2019s hand value.", "The function also returns the initial state as a numpy array containing two values: the player\u2019s hand value and the dealer\u2019s up-card.", "This function receives an action from the agent. The _take_action(action) function is called to deal a new card and re-calculate the player\u2019s hand value if the action is hit.", "Then, the function sees if the episode of Blackjack is now done after taking the action.", "If the episode is now done, then the function re-uses the logic from play_game() in Part 1 to determine the winner and rewards.", "Finally, the function returns the new state, the rewards, and whether the episode is done. {} is a return value to provide a description of what happened in the function, but we leave it empty for now.", "This function just uses simple print() functions to display the player\u2019s hand value, the cards in the player\u2019s hand, the dealer\u2019s up-card, and the value of env.done.", "This function is mostly used for debugging.", "In the coming articles, we will utilize our custom OpenAI Gym environment and new knowledge of Reinforcement Learning to design, implement, and test our own Reinforcement Learning algorithm!", "We will model our algorithm using a First-Visit Monte Carlo approach, and tweak crucial levers such as \u03b3 (discount rate), \u03b1 (learn rate), and \u03b5 (explore vs exploit) to maximize returns.", "Everything we have been discussing will finally come together in the next article. We will finally direct an AI agent to organically learn an optimal policy to crack Blackjack!", "I would really appreciate feedback of any kind! I want to become a more consistent, effective content creator.", "Did you learn something? Was I hard to follow?", "Feel free to leave a comment below or email me at adithyasolai7@gmail.com!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Development Engineer I @ AWS"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F75e32363e38&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----75e32363e38--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----75e32363e38--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://adithyasolai.medium.com/?source=post_page-----75e32363e38--------------------------------", "anchor_text": ""}, {"url": "https://adithyasolai.medium.com/?source=post_page-----75e32363e38--------------------------------", "anchor_text": "adithyasolai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1677da1d199&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&user=adithyasolai&userId=1677da1d199&source=post_page-1677da1d199----75e32363e38---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F75e32363e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F75e32363e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/Cracking-Blackjack", "anchor_text": "Cracking Blackjack"}, {"url": "https://medium.com/@ppalanic/cracking-blackjack-part-1-31da28aeb4bb?source=friends_link&sk=ce1251c59477bf8a6977ef232fd1d234", "anchor_text": "Part 1"}, {"url": "https://unsplash.com/photos/P787-xixGio", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@ppalanic/cracking-blackjack-part-1-31da28aeb4bb?source=friends_link&sk=ce1251c59477bf8a6977ef232fd1d234", "anchor_text": "Part 1"}, {"url": "https://medium.com/@ppalanic/cracking-blackjack-part-1-31da28aeb4bb?source=friends_link&sk=ce1251c59477bf8a6977ef232fd1d234", "anchor_text": "Part 1"}, {"url": "https://gym.openai.com/", "anchor_text": "OpenAI Gym"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_2/Monte%20Carlo%20Blackjack%20Part%202.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/@ppalanic/cracking-blackjack-part-1-31da28aeb4bb?source=friends_link&sk=ce1251c59477bf8a6977ef232fd1d234", "anchor_text": "Part 1"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_2/Monte%20Carlo%20Blackjack%20Part%202.ipynb", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_2/Monte%20Carlo%20Blackjack%20Part%202.ipynb", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_2/Monte%20Carlo%20Blackjack%20Part%202.ipynb", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_2/Monte%20Carlo%20Blackjack%20Part%202.ipynb", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_2/Monte%20Carlo%20Blackjack%20Part%202.ipynb", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_2/Monte%20Carlo%20Blackjack%20Part%202.ipynb", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack/blob/master/MC_Blackjack_Part_2/Monte%20Carlo%20Blackjack%20Part%202.ipynb", "anchor_text": "here"}, {"url": "https://github.com/adithyasolai/Monte-Carlo-Blackjack", "anchor_text": "GitHub Repo for this project."}, {"url": "https://towardsdatascience.com/cracking-blackjack-part-3-8fd3a5870efd?source=friends_link&sk=98055a00e2e685239d7148524a2d0b17", "anchor_text": "Part 3 here."}, {"url": "https://medium.com/tag/cracking-blackjack?source=post_page-----75e32363e38---------------cracking_blackjack-----------------", "anchor_text": "Cracking Blackjack"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----75e32363e38---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/monte-carlo?source=post_page-----75e32363e38---------------monte_carlo-----------------", "anchor_text": "Monte Carlo"}, {"url": "https://medium.com/tag/data-science?source=post_page-----75e32363e38---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----75e32363e38---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F75e32363e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&user=adithyasolai&userId=1677da1d199&source=-----75e32363e38---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F75e32363e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&user=adithyasolai&userId=1677da1d199&source=-----75e32363e38---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F75e32363e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----75e32363e38--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F75e32363e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----75e32363e38---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----75e32363e38--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----75e32363e38--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----75e32363e38--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----75e32363e38--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----75e32363e38--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----75e32363e38--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----75e32363e38--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----75e32363e38--------------------------------", "anchor_text": ""}, {"url": "https://adithyasolai.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://adithyasolai.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "adithyasolai"}, {"url": "https://adithyasolai.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "42 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1677da1d199&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&user=adithyasolai&userId=1677da1d199&source=post_page-1677da1d199--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb229f7eeb2b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcracking-blackjack-part-2-75e32363e38&newsletterV3=1677da1d199&newsletterV3Id=b229f7eeb2b7&user=adithyasolai&userId=1677da1d199&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}