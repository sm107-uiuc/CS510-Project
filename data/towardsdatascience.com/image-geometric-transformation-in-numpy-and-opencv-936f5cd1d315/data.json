{"url": "https://towardsdatascience.com/image-geometric-transformation-in-numpy-and-opencv-936f5cd1d315", "time": 1683001496.2748532, "path": "towardsdatascience.com/image-geometric-transformation-in-numpy-and-opencv-936f5cd1d315/", "webpage": {"metadata": {"title": "Image Geometric Transformation In Numpy and OpenCV | by Daryl Tan | Towards Data Science", "h1": "Image Geometric Transformation In Numpy and OpenCV", "description": "Geometric transformation is an essential image processing techniques that have wide applications. For example, a simple use case would be in computer graphics to simply rescale the graphics content\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/darylclimb/image_affine_transform", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html", "anchor_text": "affine transformation in OpenCV", "paragraph_index": 28}], "all_paragraphs": ["Geometric transformation is an essential image processing techniques that have wide applications. For example, a simple use case would be in computer graphics to simply rescale the graphics content when displaying it on a desktop vs mobile.", "It could also be applied to projectively warp an image to another image plane. For instance, instead of looking at a scene straight ahead, we wish to look at it from another viewpoint, perspective transformation is applied in this scenario to achieve that.", "One other exciting application is in training deep neural networks. Training deep model requires vast amount of data. And in almost all cases, models benefit from higher generalisation performance as training data increases. One way to artificially generate more data is to randomly apply an affine transformation to the input data. A technique also known as augmentation.", "In this article, I would like to walk you through some of the transformation and how we can perform them in Numpy first to understand the concept from first principles. Then how it could be easily achieved using OpenCV. if you are like me who likes to understand concepts from basic theories, this post would be of interest to you!", "In particular, I will focus on 2D affine transformation. What you need is some basic knowledge of Linear Algebra and you should be able to follow. The accompanying code can be found here if you prefer to tingle with it yourself!", "Without going too much into the mathematical details, the behaviour of the transform is controlled by some parameters in the affine A.", "is a 2x3 matrix or 3x3 in homogenous coordinate, and x is a vector of the form [x, y] or [x, y, 1] in homogeneous coordinate. The formula above says that A takes any vector x and maps it to another vector x\u2019.", "Generally, an affine transformation has 6 degrees of freedom, warping any image to another location after matrix multiplication pixel by pixel. The transformed image preserved both parallel and straight line in the original image (think of shearing). Any matrix A that satisfies these 2 conditions is considered an affine transformation matrix.", "To narrow our discussion, there are some specialized forms of A and this is what we are interested in. This includes the Rotation, Translation and Scaling matrices as shown in the figure below.", "One very useful property of the above affine transformations is they are linear functions. They preserve the operation of multiplication and addition and obey the superposition principle.", "In other words, we can composite 2 or more transformations: vector addition to represent translation and matrix multiplication to represent the linear mapping as long as we represent them in homogenous coordinate. For example, we could represent a rotation followed by a translation as", "In Python and OpenCV, the origin of a 2D matrix is located at the top left corner starting at x, y= (0, 0). The coordinate system is left-handed where x-axis points positive to the right and y-axis points positive downwards.", "But most transformation matrix you find in textbooks and literature including the 3 matrices shown above follows the right-hand coordinate system. So some minor adjustments must be made to align the axis direction.", "Before we experiment with the transformations on images, let\u2019s look at how we could do it on point coordinates. Because they are essentially the same with images being an array of 2D coordinates in a grid.", "Python provides a useful shorthand operator, @ to represent matrix multiplication.", "It is important to take note that, with a few exceptions, matrices generally do not commute. i.e.", "You will observe in figure 3 that they do not result in the same mapping and that order matters. How the function is applied can be understood from right to left.", "Now for images, there are several things to take note. Firstly, as mention before, we must realign the vertical axis. Secondly, the transformed points must be projected onto an image plane.", "In essence, the steps that need to be taken are:", "Let's look at a transformation where we wish to zoom in by 2x and rotate an image by 45 degrees about its centre position.", "This could be done by applying the following composite matrix.", "Few points to take note in the 2 code snippets above.", "As you can see, due to step 4, the resulting image (figure 4) will have several aliasing and holes. To eliminate this, open-source libraries use interpolation techniques to fill the gaps after transformation.", "Another approach to prevent aliasing is to formulate the warping as that of resampling from the source image I(x, y) given the warped points X\u2019. This can be done by multiplying X\u2019 by the inverse of A. As a caveat, the transformation has to be invertible.", "Note: for images, the inverse warping of X\u2019 is simply reprojecting I\u2019(x, y) onto I(x, y). So we simply apply the inverse transformation to I\u2019(x, y) pixel coordinates as you will see below.", "2. Determine where it lands in the original image plane", "3. Resample from I(x, y) the RGB pixels and map it back to I\u2019(x, y)", "Running the above code should give you a dense, hole-free image :) Feel free to download the code and play around with the parameters to apply other transformations.", "Now that you have a better understanding of geometric transformation, most developers and researchers usually save themselves the hassle of writing all those transformations and simply rely on optimised libraries to perform the task. Doing affine transformation in OpenCV is very simple.", "There are a few ways to do it.", "The code below shows the overall affine matrix that would give the same results as above. A good exercise would be to derive the formulation yourself!", "2. Rely on OpenCV to return the affine transformation matric using cv2.getRotationMatrix2D(center, angle, scale).", "This function rotates the image about the point center with angle and scale it with scale", "In this article, I have covered the basic concepts of geometric transformation and how you can apply it on images. Many advanced computer vision such as slam using visual odometry and multiview view synthesis relies on first understanding transformations.", "I believe it is most certainly beneficial as a computer vision practitioner to understand how these transformations work under the hood when we use powerful libraries such as imgaug and albumentation.", "Thanks for reading! And I hope you have gained a better understanding of how the formulas are written and used in libraries. Follow to see more post on computer vision and machine learning:) Do sound out in the comments if you spot any mistake or anything is unclear!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F936f5cd1d315&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://daryl-tan.medium.com/?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": ""}, {"url": "https://daryl-tan.medium.com/?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": "Daryl Tan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd5d47d10c0e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&user=Daryl+Tan&userId=d5d47d10c0e9&source=post_page-d5d47d10c0e9----936f5cd1d315---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F936f5cd1d315&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F936f5cd1d315&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.semanticscholar.org/paper/Computer-Vision-Algorithms-and-Applications-Szeliski/4282a344671189e17c9c9e00e329fe2d0fa71769/figure/263", "anchor_text": "Geometric Transformations"}, {"url": "https://github.com/darylclimb/image_affine_transform", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Linear_map", "anchor_text": "Wikipedia"}, {"url": "https://learn.adafruit.com/assets/1264", "anchor_text": "Pixel Coordinates"}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html", "anchor_text": "affine transformation in OpenCV"}, {"url": "https://towardsdatascience.com/depth-estimation-1-basics-and-intuition-86f2c9538cd1", "anchor_text": "Depth Estimation: Basics and IntuitionUnderstanding how far things are relative to a camera remains difficult but absolutely necessary for exciting\u2026towardsdatascience.com"}, {"url": "https://medium.com/swlh/camera-lidar-projection-navigating-between-2d-and-3d-911c78167a94", "anchor_text": "Camera-Lidar Projection: Navigating between 2D and 3DLidars and cameras are two essential sensors for perception and scene understanding. They build an environment in\u2026medium.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----936f5cd1d315---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----936f5cd1d315---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----936f5cd1d315---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/python?source=post_page-----936f5cd1d315---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----936f5cd1d315---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F936f5cd1d315&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&user=Daryl+Tan&userId=d5d47d10c0e9&source=-----936f5cd1d315---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F936f5cd1d315&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&user=Daryl+Tan&userId=d5d47d10c0e9&source=-----936f5cd1d315---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F936f5cd1d315&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F936f5cd1d315&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----936f5cd1d315---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----936f5cd1d315--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----936f5cd1d315--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----936f5cd1d315--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----936f5cd1d315--------------------------------", "anchor_text": ""}, {"url": "https://daryl-tan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://daryl-tan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Daryl Tan"}, {"url": "https://daryl-tan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "429 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd5d47d10c0e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&user=Daryl+Tan&userId=d5d47d10c0e9&source=post_page-d5d47d10c0e9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa91ae4c3a6fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-geometric-transformation-in-numpy-and-opencv-936f5cd1d315&newsletterV3=d5d47d10c0e9&newsletterV3Id=a91ae4c3a6fd&user=Daryl+Tan&userId=d5d47d10c0e9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}