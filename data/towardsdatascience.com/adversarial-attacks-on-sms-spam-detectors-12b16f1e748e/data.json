{"url": "https://towardsdatascience.com/adversarial-attacks-on-sms-spam-detectors-12b16f1e748e", "time": 1683012728.2010722, "path": "towardsdatascience.com/adversarial-attacks-on-sms-spam-detectors-12b16f1e748e/", "webpage": {"metadata": {"title": "Adversarial Attacks on SMS Spam Detectors | by Lowri Williams | Towards Data Science", "h1": "Adversarial Attacks on SMS Spam Detectors", "description": "Note: The methodology behind the approach discussed in this post stems from a collaborative publication between myself and Irene Anthi. Spam SMS text messages often show up unexpectedly on our phone\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/2004.05005.pdf", "anchor_text": "collaborative publication", "paragraph_index": 0}, {"url": "https://twitter.com/IreneAnthi", "anchor_text": "Irene Anthi", "paragraph_index": 0}, {"url": "https://www.kaggle.com/uciml/sms-spam-collection-dataset", "anchor_text": "SMS Spam Collection", "paragraph_index": 5}, {"url": "https://www.nltk.org/", "anchor_text": "Natural Language Tool Kit (NLTK)", "paragraph_index": 7}, {"url": "https://radimrehurek.com/gensim/models/word2vec.html", "anchor_text": "Word2Vec", "paragraph_index": 11}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html", "anchor_text": "Scikit-learn\u2019s train test split method from the model selection", "paragraph_index": 14}], "all_paragraphs": ["Note: The methodology behind the approach discussed in this post stems from a collaborative publication between myself and Irene Anthi.", "Spam SMS text messages often show up unexpectedly on our phone screens. That\u2019s aggravating enough, but it gets worse. Whoever is sending you a spam text message is usually trying to defraud you. Most spam text messages don\u2019t come from another phone. They often originate from a computer and are delivered to your phone via an email address or an instant messaging account.", "There exists several security mechanisms for automatically detecting whether an email or an SMS message is spam or not. These approaches often rely on machine learning. However, the introduction of such systems may also be subject to attacks.", "The act of deploying attacks towards machine learning based systems is known as Adversarial Machine Learning (AML). The aim is to exploit the weaknesses of the pre-trained model which may have \u201cblind spots\u201d between the data points it has seen during training. More specifically, by automatically introducing slight perturbations to the unseen data points, the model may cross a decision boundary and classify the data as a different class. As a result, the model\u2019s effectiveness can significantly be reduced.", "In the context of SMS spam detection, AML can be used to manipulate textual data by including perturbations to cause spam data to be classified as being not spam, consequently bypassing the detector.", "The SMS Spam Collection is a set of SMS tagged messages that have been collected for SMS spam research. It contains a set of 5,574 English SMS text messages which are tagged according to whether they are spam (425 message) or not-spam (3,375).", "Let\u2019s first cover the pre-processing techniques we need to consider before we dive into applying any kind of machine learning techniques. We\u2019ll perform pre-processing techniques that are standard for most Natural Language Processing (NLP) problems. These include:", "Python\u2019s Natural Language Tool Kit (NLTK) can handle these pre-processing requirements. The output should now look something to the following:", "Word embedding is one of the most popular representation of text vocabulary. It is capable of capturing the context of a word in a document, its semantic and syntactic similarity to its surrounding words, and its relation with other words.", "But how are word embeddings captured in context? Word2Vec is one of the most popular technique to learn word embeddings using a two-layer Neural Network. The Neural Network takes in the corpus of text, analyses it, and for each word in the vocabulary, generates a vector of numbers that encode important information about the meaning of the word in relation to the context in which it appears.", "There are two main models: the Continuous Bag-of-Words model and the Skip-gram model. The Word2Vec Skip-gram model is a shallow Neural Network with a single hidden layer that takes in a word as input and tries to predict the context of the words that surround it as an output.", "In this case, we will be using Gensim\u2019s Word2Vec for creating the model. Some of the important parameters are as follows:", "Next, we\u2019ll see how to use the Word2Vec model to generate the vector for the documents in the dataset. Word2Vec vectors are generated for each SMS message in the training data by traversing through the dataset. By simply using the model on each word of the text messages, we retrieve the word embedding vectors for those words. We then represent a message in the dataset by calculating the average over all of the vectors of words in the text.", "Let\u2019s first encode our target labels spam and not_spam. This involves converting the categorical values to numerical values. We\u2019ll then assign the features to the variable X and the target labels to the variable y. Lastly, we\u2019ll split the pre-processed data into two datasets.", "To split the data into 2 such datasets, we\u2019ll use Scikit-learn\u2019s train test split method from the model selection function. In this case, we\u2019ll split the data into 70% training and 30% testing.", "For the sake of this post, we\u2019ll use a Decision Tree classifier. In reality, you\u2019d want to evaluate a variety of classifiers using cross-validation to determine which is the best performing. The \u201cno free lunch\u201d theorem suggests that there is no universally best learning algorithm. In other words, the choice of an appropriate algorithm should be based on its performance for that particular problem and the properties of data that characterise the problem.", "Once the model is trained, we can evaluate its performance when it tries to predict the target labels of the test set. The classification report shows that the model can predict the test samples with a high weighted-average F1-score of 0.94.", "A well known use case of AML is in image classification. This involves adding noise that may not be perceptible to the human eye which also fools the classifier.", "There are various methods by which adversarial samples can be generated. Such methods vary in complexity, the speed of their generation, and their performance. An unsophisticated approach towards crafting such samples is to manually perturb the input data points. However, manual perturbations are slow to generate and evaluate by comparison with automatic approaches.", "One of the most popular technique towards automatically generating perturbed samples include the Jacobian-based Saliency Map Attack (JSMA). The methods rely on the methodology, that when adding small perturbations to the original sample, the resulting sample can exhibit adversarial characteristics in that the resulting sample is now classified differently by the targeted model.", "The JSMA method generates perturbations using saliency maps. A saliency map identifies which features of the input data are the most relevant to the model decision being one class or another; these features, if altered, are most likely affect the classification of the target values. More specifically, an initial percentage of features (gamma) is chosen to be perturbed by a (theta) amount of noise. Then, the model establishes whether the added noise has caused the targeted model to misclassify or not. If the noise has not affected the model\u2019s performance, another set of features is selected and a new iteration occurs until a saliency map appears which can be used to generate an adversarial sample.", "A pre-trained MLP is used as the underlying model for the generation of adversarial samples. Here, we explore how different combinations of the JSMA parameters affect the performance of the originally trained Decision Tree.", "To explore how different combinations of the JSMA parameters affect the performance of the trained Decision Tree, adversarial samples were generated from all spam data points present in the testing data by using a range of combinations of gamma and theta. The adversarial samples were then joined with the non-spam testing data points and presented to the trained model. The heat map reports the overall weighted-average F1-scores for all adversarial combinations of JSMA\u2019s gamma and theta parameters.", "The classification performance of the Decision Tree model achieved a decrease in F1-scores across all of the gamma and theta parameters. When gamma= 0.3, theta= 0.5, the model\u2019s classification performance decreased by 18 percentage points (F1-score = 0.759). In this case, based on this dataset, gamma= 0.3, theta= 0.5 would be the optimal parameter one would use to successfully reduce the accuracy of a machine learning based SMS spam detector.", "So, what have I learnt from this analysis?", "Due to their effectiveness and flexibility, machine learning based detectors are now recognised as fundamental tools for detecting whether SMS text messages are spam or not. Nevertheless, such systems are vulnerable to attacks that may severely undermine or mislead their capabilities. Adversarial attacks may have severe consequences in such infrastructures, as SMS texts may be modified to bypass the detector.", "The next steps would be to explore how such samples can support the robustness of supervised models using adversarial training. This entails including adversarial samples into the training dataset, re-training the model, and evaluating its performance on all adversarial combinations of JSMA\u2019s gamma and theta parameters.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F12b16f1e748e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lowri-a-williams.medium.com/?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": ""}, {"url": "https://lowri-a-williams.medium.com/?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": "Lowri Williams"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe98db206e1b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&user=Lowri+Williams&userId=e98db206e1b3&source=post_page-e98db206e1b3----12b16f1e748e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12b16f1e748e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12b16f1e748e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/2004.05005.pdf", "anchor_text": "collaborative publication"}, {"url": "https://twitter.com/IreneAnthi", "anchor_text": "Irene Anthi"}, {"url": "https://www.kaggle.com/uciml/sms-spam-collection-dataset", "anchor_text": "SMS Spam Collection"}, {"url": "https://www.nltk.org/", "anchor_text": "Natural Language Tool Kit (NLTK)"}, {"url": "https://radimrehurek.com/gensim/models/word2vec.html", "anchor_text": "Word2Vec"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html", "anchor_text": "Scikit-learn\u2019s train test split method from the model selection"}, {"url": "https://arxiv.org/abs/1412.6572", "anchor_text": "Adversarial machine learning in image classification"}, {"url": "https://github.com/LowriWilliams/SMS_Adversarial_Machine_Learning", "anchor_text": "https://github.com/LowriWilliams/SMS_Adversarial_Machine_Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----12b16f1e748e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----12b16f1e748e---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----12b16f1e748e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/adversarial-attack?source=post_page-----12b16f1e748e---------------adversarial_attack-----------------", "anchor_text": "Adversarial Attack"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----12b16f1e748e---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F12b16f1e748e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&user=Lowri+Williams&userId=e98db206e1b3&source=-----12b16f1e748e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F12b16f1e748e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&user=Lowri+Williams&userId=e98db206e1b3&source=-----12b16f1e748e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F12b16f1e748e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F12b16f1e748e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----12b16f1e748e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----12b16f1e748e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----12b16f1e748e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----12b16f1e748e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----12b16f1e748e--------------------------------", "anchor_text": ""}, {"url": "https://lowri-a-williams.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lowri-a-williams.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lowri Williams"}, {"url": "https://lowri-a-williams.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "233 Followers"}, {"url": "https://lowriwilliams.co.uk", "anchor_text": "https://lowriwilliams.co.uk"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe98db206e1b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&user=Lowri+Williams&userId=e98db206e1b3&source=post_page-e98db206e1b3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff5f2750d6328&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarial-attacks-on-sms-spam-detectors-12b16f1e748e&newsletterV3=e98db206e1b3&newsletterV3Id=f5f2750d6328&user=Lowri+Williams&userId=e98db206e1b3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}