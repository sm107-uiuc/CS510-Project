{"url": "https://towardsdatascience.com/writing-custom-keras-generators-fe815d992c5a", "time": 1682993229.816978, "path": "towardsdatascience.com/writing-custom-keras-generators-fe815d992c5a/", "webpage": {"metadata": {"title": "Custom Keras Generators. A short intro to writing Keras\u2026 | by Nilesh | Towards Data Science", "h1": "Custom Keras Generators", "description": "The idea behind using a Keras generator is to get batches of input and corresponding output on the fly during training process, e.g. reading in 100 images, getting corresponding 100 label vectors and\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["The idea behind using a Keras generator is to get batches of input and corresponding output on the fly during training process, e.g. reading in 100 images, getting corresponding 100 label vectors and then feeding this set to the gpu for training step.", "The problem I faced was memory requirement for the standard Keras generator. The in-memory generator creates copies of the original data as well as has to convert the dtype from uint8 to float64. On the other hand, the Keras generator to read from directory expects images in each class to be in an independent directory (Not possible in multi-label problems, segmentation problems etc.)", "So, I like to split the batch generator into 4 steps:", "Step 1 : Define a function to get input (can be subsetting a numpy array, pandas dataframe, reading in from disk etc.) :", "Step 2 : Define a function to get output :", "Step 3 : Define a function to preprocess input :", "Step 4 : Bring everything together to define your generator :", "And there you have it, you can add to pre-processing function as defined by your specific data-set , have the output as an image mask ( segmentation problems, localization problems etc. ).", "After this, using this custom generator is the same as using a predefined Keras ImageDataGenerator and simply pass the generator object to model.fit_generator().", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in applied machine learning, statistics and data science"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffe815d992c5a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nilesh-patil.medium.com/?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": ""}, {"url": "https://nilesh-patil.medium.com/?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": "Nilesh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F63c788157fef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&user=Nilesh&userId=63c788157fef&source=post_page-63c788157fef----fe815d992c5a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe815d992c5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe815d992c5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://keras.io/preprocessing/image/#imagedatagenerator", "anchor_text": "Keras Generators"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fe815d992c5a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fe815d992c5a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fe815d992c5a---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----fe815d992c5a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/technology?source=post_page-----fe815d992c5a---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe815d992c5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&user=Nilesh&userId=63c788157fef&source=-----fe815d992c5a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe815d992c5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&user=Nilesh&userId=63c788157fef&source=-----fe815d992c5a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe815d992c5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffe815d992c5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fe815d992c5a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fe815d992c5a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fe815d992c5a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fe815d992c5a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fe815d992c5a--------------------------------", "anchor_text": ""}, {"url": "https://nilesh-patil.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nilesh-patil.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nilesh"}, {"url": "https://nilesh-patil.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "314 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F63c788157fef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&user=Nilesh&userId=63c788157fef&source=post_page-63c788157fef--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F71e3ebaf68a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-custom-keras-generators-fe815d992c5a&newsletterV3=63c788157fef&newsletterV3Id=71e3ebaf68a6&user=Nilesh&userId=63c788157fef&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}