{"url": "https://towardsdatascience.com/generative-adversarial-networks-6a17673db367", "time": 1683014097.9734132, "path": "towardsdatascience.com/generative-adversarial-networks-6a17673db367/", "webpage": {"metadata": {"title": "Generative Adversarial Networks. Understanding the GAN game with MNIST | by NVS Yashwanth | Towards Data Science", "h1": "Generative Adversarial Networks", "description": "Designed by Ian Goodfellow and his colleagues in 2014, GANs consist of two neural networks that are trained together in a zero-sum game where one player\u2019s loss is the gain of another."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Ian_Goodfellow", "anchor_text": "Ian Goodfellow", "paragraph_index": 0}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "Get it here.", "paragraph_index": 27}, {"url": "https://pytorch.org/docs/stable/nn.html#torch.nn.LeakyReLU", "anchor_text": "Leaky ReLu", "paragraph_index": 29}, {"url": "https://pytorch.org/docs/stable/generated/torch.nn.Tanh.html#torch.nn.Tanh", "anchor_text": "Tanh", "paragraph_index": 33}, {"url": "https://pytorch.org/docs/stable/nn.html#bcewithlogitsloss", "anchor_text": "BCEWithLogitsLoss", "paragraph_index": 40}, {"url": "https://developers.google.com/machine-learning/gan/applications", "anchor_text": "To read more about these check out this link", "paragraph_index": 46}], "all_paragraphs": ["Designed by Ian Goodfellow and his colleagues in 2014, GANs consist of two neural networks that are trained together in a zero-sum game where one player\u2019s loss is the gain of another.", "To understand GANs we need to be familiar with generative models and discriminative models.", "Generative models try to output new data points using the distribution from the training set. These models generate new data instances. These models capture joint probability p(X, Y)", "Types of Generative models1. Explicit density models2. Implicit density models", "Explicit density models define an explicit density function while implicit density models define a stochastic procedure that can directly generate data.", "If you are interested in reading more about generative models, check out this popular GitHub repository below.", "On the other hand, Discriminative models capture conditional probabilities p(X/Y) and they differentiate different data instances.", "Generative models solve difficult tasks. The level of attention detail is more compared to that in discriminative models. Simply speaking generative models do more work. Generative models try to approximate the real data distribution as closely as possible.", "In the figure above we can see that the discriminative model tries to separate 0\u2019s and 1\u2019s data space. Whereas the generative models closely approximate the 0\u2019s and 1\u2019s data space.", "Now that you know the basic definitions of generative and discriminative models, let us learn about GANs.", "Generative Adversarial Networks (GANs) are generative models. They generate whole images in parallel. GANs consist of 2 networks: Discriminator & Generator networks", "GANs use a differentiable function. This is usually a neural network. We call it the generator network. This generator network takes random inputs. These inputs are noise. This noise is given to a differentiable function that transforms and reshapes the same into a recognizable structure. This could be an image and the same is highly dependent on the noise at the input of the differentiable function.", "For various noise inputs, we can generate many images. However, the generator network immediately doesn't start giving out realistic images. We need to train it.", "How do we train this generator network? Probably the same way as any other network? Actually no!", "Generator networks see many images and try to output something similar to the same probability distribution. How is that done? \ud83d\udc40", "Here comes the Discriminator, a regular neural network classifier. The discriminator guides our generator network.", "For the sake of simplicity let us call the output images of the generator network as fake images. The output of the generator, the fake images, are given to the discriminator as the input. The Discriminator also sees so-called real images from the training data. The discriminator then outputs the probability that the input is a real image. So a 1 for real images, and 0 for fake images. Meanwhile, the generator also tries to output images that could be assigned a probability of 1 by the discriminator.", "Most machine learning models try to minimize some cost function by optimizing the parameters. If we were to assign cost functions to GANs, we can say the cost for the discriminator is negative of the cost of the generator and vice versa.", "So let us try to understand how GANs work by assuming discriminator and generators as 2 players and a say a function f.", "The generator tries to decrease the output value of the function f, while the discriminator tries to increase it. Let us assume this is done until we reach an equilibrium where neither the generator can decrease the output value of the function f, nor the discriminator can increase it. Since we use 2 optimization algorithms simultaneously, one for the generator and the other for the discriminator, we may never reach an equilibrium. Adam optimizer is a good choice.", "Briefly speaking, the generator and discriminator compete, where the generator gives fake data to the discriminator. The discriminator which also sees training data, predicts if the received image is real or fake.", "Look at this example below from google developers' machine learning crash course.", "The generator begins with unrealistic images and quickly learns to fool the discriminator.", "Thus, the generator is trained over time to fool the discriminator to make it look like the fake images are much like the real ones that the discriminator sees.", "During the training process of the discriminator, it is shown real images and uses computes the discriminator loss. It classifies both real and fake images from the generator and discriminator loss penalizes the discriminator if any image is incorrectly classified. Through backpropagation, the discriminator updates its weights.", "Similarly, the generator is given noisy inputs to generate fake images. These images are given to the discriminator and the generator loss penalizes the generator for producing a sample that the discriminator network classifies as fake. Weights are updated through backpropagation right from the discriminator into the generator.", "It is important to note that the generator must be constant during the discriminator training phase. Similarly, the discriminator remains constant during the generator training phase. Thus GAN training proceeds in an alternating fashion.", "In this section, we will learn to design a GAN that can generate new images of handwritten digits. We will use the famous MNIST dataset. Get it here.", "The discriminator is going to be a typical linear classifier.", "The activation function we will be using is Leaky ReLu.", "Why leaky ReLu?We should use a leaky ReLU to allow gradients to flow backward through the layer unhindered. A leaky ReLU is like a normal ReLU, except that there is a small non-zero output for negative input values.", "The generator uses latent samples to make fake images. These latent samples are vectors which are mapped to the fake images. A latent vector is just a compressed, feature-level representation of an image!", "To understand what is a latent sample, consider an autoencoder. The outputs that connect the encoder and decoder portion of a network are made up of a compressed representation that could also be referred to as a latent vector.", "The activation function for all the layers remains the same except we will be using Tanh at the output.", "Why Tanh at the output?The generator has been found to perform the best with \ud835\udc61\ud835\udc4e\ud835\udc5b\u210etanh for the generator output, which scales the output to be between -1 and 1, instead of 0 and 1.", "We want the output of the generator to be comparable to the real images pixel values, which are normalized values between 0 and 1. Thus, we\u2019ll also have to scale our real input images to have pixel values between -1 and 1 when we train the discriminator. This will be done during the training phase.", "To help the discriminator generalize better, the labels are reduced a bit from 1.0 to 0.9. For this, we\u2019ll use the parameter smooth; if True, then we should smooth our labels. In PyTorch, this looks like:labels = torch.ones(size) * 0.9", "We also made use of dropout layers to avoid overfitting.", "The discriminator\u2019s goal is to output a 1 for real and 0 for fake images. On the other hand, the generator wants to make fake images that closely resemble the real ones.", "Thus we can say if \u201cD\u201d represents the loss for the discriminator, then the following can be stated:The goal of discriminator : D(real_images)=1 & D(fake_images)=0The goal of generator: D(real_images)=0 & D(fake_images)=1", "We will use BCEWithLogitsLoss, which combines a sigmoid activation function (we want the discriminator to output a value 0\u20131 indicating whether an image is real or fake) and binary cross-entropy loss.", "As mentioned earlier, Adam is a suitable optimizer.", "The generator takes in a vector z and outputs fake images. The discriminator alternates between training on the real images and that of the fakes images produced by the generator.", "We shall plot generator and discriminator losses against the number of epochs.", "This way the generator starts out with noisy images and learns over time.", "You can check out the code and readme file on my GitHub profile as well.", "Since the time Ian Goodfellow and his colleagues at the University of Montreal designed GANs, they exploded with popularity. The number of applications is remarkable. GANs were further improved by many variations some of which are CycleGAN, Conditional GAN, Progressive GAN, etc. To read more about these check out this link. Now open a Jupyter notebook and try to implement whatever you learned.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A decision analyst with a keen interest in AI. When I don\u2019t code, I try to understand the math behind neural nets."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6a17673db367&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a17673db367--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a17673db367--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nvsyashwanth?source=post_page-----6a17673db367--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nvsyashwanth?source=post_page-----6a17673db367--------------------------------", "anchor_text": "NVS Yashwanth"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7bd459d521f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&user=NVS+Yashwanth&userId=7bd459d521f3&source=post_page-7bd459d521f3----6a17673db367---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a17673db367&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a17673db367&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@amandadalbjorn?utm_source=medium&utm_medium=referral", "anchor_text": "Amanda Dalbj\u00f6rn"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Ian_Goodfellow", "anchor_text": "Ian Goodfellow"}, {"url": "https://github.com/wiseodd/generative-models", "anchor_text": "wiseodd/generative-modelsCollection of generative models, e.g. GAN, VAE in Pytorch, and Tensorflow.github.com"}, {"url": "https://developers.google.com/machine-learning/gan/generative", "anchor_text": "Image from Source: Google Developers."}, {"url": "https://unsplash.com/@jeshoots?utm_source=medium&utm_medium=referral", "anchor_text": "JESHOOTS.COM"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://developers.google.com/machine-learning/gan/gan_structure", "anchor_text": "Image from Source: Google Developers."}, {"url": "https://developers.google.com/machine-learning/gan/gan_structure", "anchor_text": "Image from Source: Google Developers."}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "Get it here."}, {"url": "https://pytorch.org/docs/stable/nn.html#torch.nn.LeakyReLU", "anchor_text": "Leaky ReLu"}, {"url": "https://pytorch.org/docs/stable/generated/torch.nn.LeakyReLU.html#torch.nn.LeakyReLU", "anchor_text": "Image from PyTorch documentation"}, {"url": "https://pytorch.org/docs/stable/generated/torch.nn.Tanh.html#torch.nn.Tanh", "anchor_text": "Tanh"}, {"url": "https://pytorch.org/docs/stable/generated/torch.nn.Tanh.html#torch.nn.Tanh", "anchor_text": "Image from PyTorch documentation"}, {"url": "https://pytorch.org/docs/stable/nn.html#bcewithlogitsloss", "anchor_text": "BCEWithLogitsLoss"}, {"url": "https://github.com/NvsYashwanth/MNIST-GAN", "anchor_text": "NvsYashwanth/MNIST-GANUnderstanding GANs with MNIST implementation.github.com"}, {"url": "https://developers.google.com/machine-learning/gan/applications", "anchor_text": "To read more about these check out this link"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6a17673db367---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6a17673db367---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/mnist?source=post_page-----6a17673db367---------------mnist-----------------", "anchor_text": "Mnist"}, {"url": "https://medium.com/tag/gan?source=post_page-----6a17673db367---------------gan-----------------", "anchor_text": "Gan"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----6a17673db367---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a17673db367&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&user=NVS+Yashwanth&userId=7bd459d521f3&source=-----6a17673db367---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a17673db367&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&user=NVS+Yashwanth&userId=7bd459d521f3&source=-----6a17673db367---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a17673db367&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a17673db367--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6a17673db367&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6a17673db367---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a17673db367--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6a17673db367--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6a17673db367--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6a17673db367--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6a17673db367--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6a17673db367--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6a17673db367--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6a17673db367--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nvsyashwanth?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nvsyashwanth?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "NVS Yashwanth"}, {"url": "https://medium.com/@nvsyashwanth/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "87 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7bd459d521f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&user=NVS+Yashwanth&userId=7bd459d521f3&source=post_page-7bd459d521f3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F70d9f149410&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-6a17673db367&newsletterV3=7bd459d521f3&newsletterV3Id=70d9f149410&user=NVS+Yashwanth&userId=7bd459d521f3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}