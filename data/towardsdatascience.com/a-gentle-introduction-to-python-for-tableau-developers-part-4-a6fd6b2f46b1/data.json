{"url": "https://towardsdatascience.com/a-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1", "time": 1683013064.864316, "path": "towardsdatascience.com/a-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1/", "webpage": {"metadata": {"title": "A gentle introduction to Python for Tableau Developers (Part 4) | by Elliott Stam | Towards Data Science", "h1": "A gentle introduction to Python for Tableau Developers (Part 4)", "description": "Between data blends, joins, and wrestling with the resulting levels of detail in Tableau, managing relationships between data can be tricky. Stepping into your shiny new Python shoes, the world opens\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions", "anchor_text": "list comprehension", "paragraph_index": 17}, {"url": "https://realpython.com/python-lambda/", "anchor_text": "lambda function", "paragraph_index": 38}], "all_paragraphs": ["Between data blends, joins, and wrestling with the resulting levels of detail in Tableau, managing relationships between data can be tricky.", "Stepping into your shiny new Python shoes, the world opens up a bit. Instead of trying to squeeze everything into a single data source to rule them all, you can choose your battles.", "In our previous articles, we already saw:", "In this article, we\u2019ll focus on one of the most important aspects of working with data in any ecosystem: joins.", "Lucky for us, the Tableau data we have been playing around with comes with batteries included! Within the context of the fictitious store we have been analyzing, we have a bit of data detailing various items that were returned.", "Let\u2019s use this data on orders and returns to get comfortable joining data in Python using the Pandas library. Along the way, we\u2019ll see how different types of joins can help us accomplish different goals.", "Remember that orders data we\u2019ve been working with? Let\u2019s get a good look at it real quick.", "Ah, that\u2019s familiar. Now let\u2019s see what\u2019s behind door #2. But first, in the spirit of getting a feel for how Pandas works, let\u2019s highlight how we are getting our hands on this data.", "In the first article, we used Pandas read_excel() function to get our orders data from an Excel file. It turns out this file has multiple sheets:", "Let\u2019s ignore the \u2018People\u2019 sheet for now (nobody likes them anyway), and simply acknowledge the fact that when we used the read_excel() function without specifying a sheet name, the function grabbed the first sheet available in the Excel workbook.", "Here\u2019s how we can specify that we want to fetch data from the \u2018Returns\u2019 sheet:", "And here\u2019s what that data looks like:", "In the data joining world, an arranged marriage is better than a blind date. That is, we want to be the overbearing parents who inspect the columns we are about to join our data on, looking for any inconsistencies that would make for a poor match. Blindly joining our data together just because we assume the columns match up could lead to some undesired results.", "To prove that point, let\u2019s take a stroll into a blind date and see what happens.", "For starters, let\u2019s observe which columns our two data sets have in common.", "It looks to me like we have \u2018Order ID\u2019 and \u2018Market\u2019 in common. Of course, in many real world scenarios the same information might be stored under different names, but this isn\u2019t the real world. It\u2019s an example!", "By the way, here\u2019s a shortcut you could use to find values that exist in both column lists:", "What you just saw is called a list comprehension. If you end up falling in love with Python, these will become like second nature to you. They\u2019re very useful. In this case, our list comprehension provides us any value of list X whose values also appear in list Y.", "Now that we know we have two columns in common, what are we waiting for!? Initiate the blind date!", "So we have \u2018Order ID\u2019 and \u2018Market\u2019 in common between our orders and our returns. Let\u2019s join them.", "In Pandas, you can use the join() method and you can also use the merge() method. Different strokes for different folks. I prefer the merge() method in pretty much any scenario, so that\u2019s what we\u2019ll use here. Team merge, for life.", "And let\u2019s see what the results look like:", "First of all, we ran .shape on the resulting dataframe to get values for the number of rows and columns (in that order). So our resulting dataframe has 51,290 rows and 25 columns, where the original orders dataframe has 51,290 rows and 24 columns.", "This join has effectively sprinkled in new data for each of our rows, providing one additional column named \u2018Returned\u2019, which takes on the value of \u2018Yes\u2019 if an order was returned.", "Note that in our join we specified the columns to join on as well as how to perform the join. What is this \u2018left\u2019 join? It simply means that the table that was there first (in this example that is our store_df) will remain as-is, and the new table\u2019s data will be sprinkled onto it wherever relevant.", "Let\u2019s compare this to an inner join:", "This inner join behaves differently from our left join in the sense that it only keeps the intersection between the two tables. This type of join would be useful if we only cared about analyzing orders that were returned, as it filters out any orders that were not returned.", "Sometimes you think you know everything, and that\u2019s when it bites you the hardest. In this example, we think we know that we have two matching columns: \u2018Order ID\u2019 and \u2018Market\u2019. But do our two data sets agree on what a market is?", "Let\u2019s stir up some drama. Orders, how do you define your markets?", "This line of code takes a look at the entire \u2018Market\u2019 column and outputs the unique values found within it.", "Okay. Returns, how do you define your markets?", "It looks like our orders and returns teams both need to get on the same page in terms of whether they use acronyms for markets or spell them out.", "On the orders side, to avoid future issues we should probably switch \u2018Canada\u2019 to an acronym value like \u2018CA\u2019.", "On the returns side, to avoid future issues we should probably switch \u2018United States\u2019 to \u2018US\u2019", "But wait, that only fixes the future issues\u2026 what kinds of problems is this causing right now?", "To see the mess we\u2019re in, let\u2019s look at how many returns we have per market (using the inner join from earlier):", "Hurray, it looks like our US market is perfect and has no returns! Or wait, is it the United States market\u2026 ah, oops.", "Because the data containing our orders calls the market \u2018US\u2019 and the data containing our returns calls the market \u2018United States\u2019, the join will never match the two.", "Luckily, it\u2019s really easy to rename our markets. Here\u2019s a quick way to do it in this situation, where there\u2019s really just one mismatch that\u2019s causing a problem. This introduces the concept of a lambda function, which you can simply ignore for now if it makes no sense to you.", "Basically what this does is it creates a function on the fly that we use quickly to perform a useful action in a single line of code. The result of running the line of code above is that any occurrence of the \u2018United States\u2019 market has been renamed to \u2018US\u2019.", "Now, if we run that inner join between store_df and returns_df, the results will look a bit different:", "And if we check how many returns there are per market, we get this:", "Now that we know how to join our orders and our returns, can you figure out how to stitch together a table like the one shown below?", "Looks like the \u2018Tables\u2019 sub-category is crying out for attention again! We can\u2019t escape it.", "Applying what we\u2019ve learned so far in this series, can you recreate this table on your own? If you\u2019re a real over-achiever, go ahead and build it in Tableau as well and compare the process. How do you handle the market mismatch in Tableau vs Python? There are multiple ways to crack the case \u2014 go try it out!", "Joining data is an absolutely crucial skill if you\u2019re working with data at scale. Understanding what you\u2019re joining is as important as knowing the technical details of how to execute the joins, keep that in mind!", "If you send your data on a blind date to be joined with another table, be aware of the risks. Scrub your data sets clean before sending them on dates with other data. Dirty data tends to leave a mess, and you\u2019ll be the one troubleshooting it.", "Hope to see you next time as we dive into crafting reusable code using functions!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist and author. Sometimes seen falling down mountains with a snowboard strapped to my feet."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa6fd6b2f46b1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@elliottstam?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@elliottstam?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": "Elliott Stam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd193f11526c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&user=Elliott+Stam&userId=d193f11526c9&source=post_page-d193f11526c9----a6fd6b2f46b1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6fd6b2f46b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6fd6b2f46b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@bannon15?utm_source=medium&utm_medium=referral", "anchor_text": "Bannon Morrissy"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/a-gentle-introduction-to-python-for-tableau-developers-part-1-862b9bdd1c85", "anchor_text": "Pandas groupby expressions and basic visualizations"}, {"url": "https://towardsdatascience.com/a-gentle-introduction-to-python-for-tableau-developers-part-2-c18095a03e0e", "anchor_text": "Calculations and coloring sales by profitability"}, {"url": "https://towardsdatascience.com/a-gentle-introduction-to-python-for-tableau-developers-part-3-8634fa5b9dec", "anchor_text": "Data exploration with advanced visuals"}, {"url": "https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions", "anchor_text": "list comprehension"}, {"url": "https://realpython.com/python-lambda/", "anchor_text": "lambda function"}, {"url": "https://medium.com/tag/python?source=post_page-----a6fd6b2f46b1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/tableau?source=post_page-----a6fd6b2f46b1---------------tableau-----------------", "anchor_text": "Tableau"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a6fd6b2f46b1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----a6fd6b2f46b1---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/programming?source=post_page-----a6fd6b2f46b1---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa6fd6b2f46b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&user=Elliott+Stam&userId=d193f11526c9&source=-----a6fd6b2f46b1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa6fd6b2f46b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&user=Elliott+Stam&userId=d193f11526c9&source=-----a6fd6b2f46b1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6fd6b2f46b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa6fd6b2f46b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a6fd6b2f46b1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a6fd6b2f46b1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@elliottstam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@elliottstam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Elliott Stam"}, {"url": "https://medium.com/@elliottstam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "509 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd193f11526c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&user=Elliott+Stam&userId=d193f11526c9&source=post_page-d193f11526c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2f1f73d79eed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-python-for-tableau-developers-part-4-a6fd6b2f46b1&newsletterV3=d193f11526c9&newsletterV3Id=2f1f73d79eed&user=Elliott+Stam&userId=d193f11526c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}