{"url": "https://towardsdatascience.com/data-ingestion-is-almost-a-solved-problem-4ef35efff0ee", "time": 1683018281.362114, "path": "towardsdatascience.com/data-ingestion-is-almost-a-solved-problem-4ef35efff0ee/", "webpage": {"metadata": {"title": "Data ingestion is (almost) a solved problem | by Gianluca Gindro | Towards Data Science", "h1": "Data ingestion is (almost) a solved problem", "description": "Ask anyone who has been involved in a data related job over the past 10\u201315 years what is the most boring task they would rather avoid, and chances are many would answer \u2018data ingestion\u2019. Everyone\u2026"}, "outgoing_paragraph_urls": [{"url": "https://fivetran.com/docs/getting-started/consumption-based-pricing#tableswithoutprimarykeys", "anchor_text": "enerates a synthetic primary key", "paragraph_index": 12}, {"url": "https://www.stitchdata.com/docs/replication/loading/understanding-loading-behavior", "anchor_text": "documentation", "paragraph_index": 13}, {"url": "https://www.stitchdata.com/docs/integrations/saas/mixpanel/v23-12-2015", "anchor_text": "Stitch Data Mixpanel integration", "paragraph_index": 15}, {"url": "http://thedatamba.com", "anchor_text": "thedatamba.com", "paragraph_index": 38}], "all_paragraphs": ["Ask anyone who has been involved in a data related job over the past 10\u201315 years what is the most boring task they would rather avoid, and chances are many would answer \u2018data ingestion\u2019.", "Everyone would like to have data ready to be analysed. Sure, data cleaning and pre-processing is also another good candidate to avoid, but there is something uniquely annoying in the feeling of spending time purely on replicating data, without supposedly adding any value to it. In a sense at least data cleaning gives that sense of purpose of \u2018putting your house in order\u2019.", "Yet, data ingestion is a fundamental task, and, until some time ago, you had to work on a combination of API calls, CSV get requests, web-hooks, incremental loads rules, streaming services and ODBC connections just to replicate external data into your data warehouse or local system.", "I\u2019ve faced lots of these challenges myself over the past years, which is why I was particularly excited when in my last project I had the chance to explore in detail how data ingestion tools have transformed this space.", "There are two data ingestion tools that I am going to review here:", "The ideal scenario of using a data ingestion tool is when:", "The ELT requirement is a crucial one here. While, I would argue, ELT vs ETL is often down to individual preference, there are scenarios where it is preferable to transform data before ingestion, for example if lots of data cleaning, transformation or filtering is required before ingestion, to avoid un-necessary complicated processing after the data has already been loaded into the DB.", "While the above use cases cover a vast range of use cases, as exclusion of points above, they won\u2019t cover cases where:", "Now let\u2019s compare the two tools on a number of key dimensions.", "An obvious advantage of using a data ingestion tool is that it will handle incremental uploads for you. If you have small enough data sources that can be replicated in full every day, of course you don\u2019t need to worry too much about this point.", "Generally speaking, both Fivetran and Stitch Data perform log-based replications, that is, they access source systems change-logs to consume the incremental changes in the data, and replicate them downstream. This is something that happens under the hood, so you don\u2019t have to worry about that, apart from making sure your source systems have change-logs enabled.", "The other point to consider is whether your data has a primary key. You obviously want to have a primary key, because this is the only way the tools can recognize that an existing record has been updated. If not, they might insert a new copy of the record each time it is modified, which is obviously an undesired behaviour.", "Fivetran here is a bit more sophisticated in that it generates a synthetic primary key even when source tables have none.", "Stitch Data on the other hand resorts to an append-only replication method when no primary key is present at source, as it explains in its documentation.", "From my experience, in most practical cases you will deal with sources that have a primary key (and if you have control on the source databases, you need to make sure the source tables have one).", "However, there are situations where this is not the case, a notable example I have encountered is the Stitch Data Mixpanel integration, which lacks a primary key. In this case, the same record can sometimes be inserted multiple times, which means you have to dedupe it at destination, for example by taking a unique combination of some fields (such as event_type, user_distinct_id, page_url and timestamp).", "This is far from ideal, but should not generate too much trouble as long as you are careful with your queries to consume the data.", "JSON data sources can in general be a pain to handle, but how much of a pain would depend on the actual data model and the tools used.", "This scenario is commonly found if you have a NoSql data source such as MongoDB, but would also apply if you have a relational data source with some JSON fields, such as in a Postgres database.", "The most critical case here is if you have source tables (ie collections), that are truly unstructured, that is, they contain a high number of different fields each. This could be the case, for example, if each object represents a book and its fields represent the chapter names. Chances are that the chapter names would be different for each book. Cases like this would not match well the JSON-to-relational mapping, and, both with Fivetran and Stitch Data, you would find your destination tables having as many columns as there are unique fields in the source collection. This is not only impractical, but it would also throw an error above a certain threshold, as for example Postgres has a limit of 1600 columns per table.", "If instead you have a limited number of unique fields in each collection (say, up to a few hundreds at the very most), the behaviour would change depending on the tools:", "In summary, there is not any magic that a tool can do if you have truly unstructured source data, however, if you do have some structure, under certain conditions these tools will allow to preserve the dictionary-like format in the destination database.", "Both Fivetran and Stitch Data allow to only import certain tables from a source schema, but Stitch Data here also offers the advantage of being able to selectively import only chosen fields, which can be a useful advantage if you have tables with lots of fields, and particularly if some of these fields contain nested JSON that could complicate the target structure.", "On this point, Fivetran and Stitch Data have two different approaches:", "How does this matter? If your source stream is mainly a sequence of new records appended, this won\u2019t make it much difference, but if your source systems tend to frequently update the same records over and over, Fivetran here can offer an advantage of more clear and predictable pricing.", "Another point to be very careful here is about historical backfills and table schema changes. If you have for example a large table and you add one additional column to it and populate it for all the history, both systems will spot these changes and will update the full records history, even if you might not be genuinely interested in that additional field. This could generate quite high unexpected charges for both tools.", "Based on the charging methods described above, it\u2019s not exactly possible to compare like for like the two tools, however, in a common scenario where the vast majority of source changes are actually new inserts, Stitch Data proves to be significantly cheaper than Fivetran.", "As an example, as of today:", "The replication frequency that you can set-up will depend both on the tool used and the source system. Fivetran claims a lower limit of 5 minutes, Stitch Data for most sources has a lower limit of 30 minutes, however some sources allow a lower value, but you need to be careful in general not to overlap between two subsequent runs.", "Your replication frequency will also affect the number of rows modified, which would particularly affect Stitch Data pricing.", "Let\u2019s remember we are talking about ingestion, not data transformation, so it\u2019s not surprising that neither of these tools have a focus on data transformation capabilities.", "However, Fivetran also offers integration with dbt (data build tool) and Stitch Data is part of the Talend family, traditionally a big player in the ETL domain.", "However, there are no obvious advantages in using their sister data transformation tools, so that part can be genuinely decoupled from ingestion.", "Both Fivetran and Stitch Data are great tools for data ingestion. Which one fits the bill would depend on the actual use cases and needs.", "Fivetran has in some way more complex replication capabilities, but this also comes with an increased cost.", "Stitch Data is a great entry-level tool, which can also handle replication at scale for a number of standard scenarios.", "Fivetran pricing is quite steep at the beginning, but can become more justifiable if you have very high ingestion volumes (eg billions unique rows a month), and can also offer more predictability due to its unique rows pricing model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data guy. No-nonsense approach to data science. INSEAD. Head of data science & analytics at Commonplace. Founder and lead instructor at thedatamba.com."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4ef35efff0ee&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://thedatamba.medium.com/?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": ""}, {"url": "https://thedatamba.medium.com/?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": "Gianluca Gindro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb02ab3988d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&user=Gianluca+Gindro&userId=eb02ab3988d4&source=post_page-eb02ab3988d4----4ef35efff0ee---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ef35efff0ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ef35efff0ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@heyeje?utm_source=medium&utm_medium=referral", "anchor_text": "Heye Jensen"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://fivetran.com/", "anchor_text": "Fivetran"}, {"url": "https://www.stitchdata.com/", "anchor_text": "Stitch Data"}, {"url": "https://fivetran.com/connectors", "anchor_text": "here"}, {"url": "https://www.stitchdata.com/integrations/sources/", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Extract,_load,_transform", "anchor_text": "ELT approach"}, {"url": "https://en.wikipedia.org/wiki/Extract,_transform,_load", "anchor_text": "ETL one"}, {"url": "https://unsplash.com/@romankraft?utm_source=medium&utm_medium=referral", "anchor_text": "Roman Kraft"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://fivetran.com/docs/getting-started/consumption-based-pricing#tableswithoutprimarykeys", "anchor_text": "enerates a synthetic primary key"}, {"url": "https://www.stitchdata.com/docs/replication/loading/understanding-loading-behavior", "anchor_text": "documentation"}, {"url": "https://www.stitchdata.com/docs/integrations/saas/mixpanel/v23-12-2015", "anchor_text": "Stitch Data Mixpanel integration"}, {"url": "http://www.snowflake.com", "anchor_text": "Snowflake"}, {"url": "https://www.stitchdata.com/docs/data-structure/nested-data-structures-row-count-impact", "anchor_text": "explained here"}, {"url": "https://www.stitchdata.com/pricing/", "anchor_text": "pricing plan"}, {"url": "https://fivetran.com/pricing", "anchor_text": "Fivetran pricing"}, {"url": "https://fivetran.com/pricing", "anchor_text": "documentation pages"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4ef35efff0ee---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/database?source=post_page-----4ef35efff0ee---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/tag/data?source=post_page-----4ef35efff0ee---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----4ef35efff0ee---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ef35efff0ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&user=Gianluca+Gindro&userId=eb02ab3988d4&source=-----4ef35efff0ee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ef35efff0ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&user=Gianluca+Gindro&userId=eb02ab3988d4&source=-----4ef35efff0ee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ef35efff0ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4ef35efff0ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4ef35efff0ee---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4ef35efff0ee--------------------------------", "anchor_text": ""}, {"url": "https://thedatamba.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://thedatamba.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gianluca Gindro"}, {"url": "https://thedatamba.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "191 Followers"}, {"url": "http://thedatamba.com", "anchor_text": "thedatamba.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb02ab3988d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&user=Gianluca+Gindro&userId=eb02ab3988d4&source=post_page-eb02ab3988d4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8138d177b937&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-ingestion-is-almost-a-solved-problem-4ef35efff0ee&newsletterV3=eb02ab3988d4&newsletterV3Id=8138d177b937&user=Gianluca+Gindro&userId=eb02ab3988d4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}