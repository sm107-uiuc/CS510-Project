{"url": "https://towardsdatascience.com/validation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d", "time": 1683003355.5520372, "path": "towardsdatascience.com/validation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d/", "webpage": {"metadata": {"title": "Validation Set Over-fitting because of Random Initialization & Selection Bias | by Kamer Ali YUKSEL | Towards Data Science", "h1": "Validation Set Over-fitting because of Random Initialization & Selection Bias", "description": "Deep Learning models are called the universal function approximators. Their strength comes from their great ability of modeling the relationship of given input and output. However, this is also their\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Deep Learning models are called the universal function approximators. Their strength comes from their great ability of modeling the relationship of given input and output. However, this is also their primary weakness for coming up with generalizable solutions to a problem and what makes them so prone to over-fitting (memorizing) the training-set and not working with new data. The current method of ensuring the generalization of Deep Learning models was simply using a validation set to decide on how many iterations (epochs) should be done for training a model; or in other words, early stopping. Then, the Data Scientist would test the trained model on a blind test-set to ensure sure that none of the training hyper-parameters are also over-fitting. This method was working well so far with the problems where you can have such separate datasets, that each has a similar distribution. However, this is not the case for several problems in Finance or Healthcare (both in which I am deeply experienced), and certainly not for Reinforcement Learning problems where the new data would depend on both the environment also to the actions.", "In Healthcare, it is extremely critical for the deployed model to generalize for each unseen patient, who would be present in neither of train or test sets. For that reason, it is a common practice to validate the model with a leave-one-subject out cross-validation where each left-out subject will be different and try to decide on an early stopping epoch based on the statistics of each fold; which can be okay with a large population. In Finance, the situation is even worse as one needs to generalize for future data; whilst, the distribution of the stock-market data always changes and it is almost impossible to have such homogeneous train, validation and test sets. Several Quants train AI models for trading and they often do not perform well with the real-data, although they have been great in the back-tests during their experiments. Finally, most Reinforcement Learning methods have reproducibility problems (especially when a different random-seed is employed) and gradient-free methods like Augmented Random-Search are shown to work better in them. Lastly, it is common that ensembles of the same model (even) often results in better.", "Continual learning of Deep Learning models, which are iterative machine-learning models, is also a nightmare and requires the same validation. In fact, one can never ensure that a Deep Learning model will converge to the same or a better solution in terms of generalization if re-trained from scratch with a new dataset of same size using the same number of epochs. It is a total mess! After years of experience in training models, I have identified a primary cause for this as validation set over-fitting. Since that any machine-learning model is randomly initialized, they can converge to a local-minima, which performs great with the validation-set in use and if you early-stop your training at that point, the model would have less generalization than the optimal solution. For the problems that I have given as an example, there is no way of ensuring this doesn\u2019t happen by checking the validation set. A good method that I have discovered to detect over-fitting only by using the training set, is checking the model performance across a lot of mini-batches. Since that the model would lose its generalization capability during over-fitting, it would start to perform worse in certain mini-batches while trying to learn others and therefore the change of the loss would start fluctuating across them during the training.", "Recently, I have faced this problem while working on a Portfolio Selection (Optimization) problem and I have finally discovered a solution, which is potentially applicable to other domains. I have invented a method that I have named as \u2018Population-based Constant Rebalanced Portfolio Selection\u2019. For this method, I have employed the Autograd functionality in PyTorch to optimize 8192 portfolio(s) simultaneously in GPU. Then, I have used the mean weights of the top-50% portfolio(s) for checking the validation set performance rather than selecting a candidate from portfolio weights that are being trained. (The method converges to a similar result when all of them are used for taking the mean and using top-50% just accelerates the training process.) To sum up, it t turned out that I was able to obtain a smooth training and validation curve, which I was able to use for deciding on an early-stopping epoch without a random-initialization bias. Another interesting possible use of this method could be concurrently evolving adversarial examples for attacking against Deep Learning models. The main difference from the existing evolutionary optimization methods is that each candidate is optimized independently in the proposed method. Further details on this method are in the following:", "The previous portfolio selection methods only addressed the selection of an optimal buy & hold portfolio but do not help to select a constant rebalanced portfolio. Whilst, a minimum volatility constant rebalanced portfolio, which has no-positive return when simply being held, could as well generate profits due to the mean-reversion. Therefore, I have rather tried to select an optimal portfolio for a given trading policy (such as UCRP) and risk-adjusted reward, under transaction costs (1%). Also, the divergence threshold, which is used for deciding when to rebalance back to the selected constant portfolio is also optimized, along with the portfolio weights. To the best of my knowledge, this is also the first Portfolio Selection method that optimizes a portfolio together with the parameters for a defined trading policy by simulating the strategy. The reward function acts as an alternative to Efficient Frontier optimization.", "To conclude, this method enabled me to find generalizable portfolio weights and parameters for a given trading strategy (in this case constant rebalanced portfolio) and defined risk-sensitive reward function. In fact, I have been able to optimize such a trading strategy that has been able to achieve an 80% win-rate and 20x profit-loss ratio on an out-of-sample back-test that is done with QuantConnect. In order to demonstrate the strength of the proposed method, I am sharing the source-code of this strategy that has been discovered in the below link; so that anyone can reproduce the results for themselves. Please, note that finding such a strategy would be very difficult even on training-set. Lastly, I am looking forward for other researchers to develop more solutions for the problem that I have defined in this article; and I hope that it can serve as a trigger for more high-quality research to tackle this severe problem in AI.", "I am an ex-academician (T-Labs, Microsoft Research) and entrepreneur (OTA Expert, LivingRooms), who revolutionized the Parkinson\u2019s disease treatment at work (ConnectedLife) while hacking the stock-market at home. I previously worked in reputable research institutes incl. Socio-Digital Systems (Human Experience and Design) Group in Computer-Mediated Living Laboratory of Microsoft Research Cambridge and Quality & Usability Group of Deutsche Telekom Innovation Laboratories (T-Labs). I lead several research projects on Deep Learning, Machine Learning, Pattern Recognition, Data Mining, HCI, Information Retrieval, Artificial Intelligence, Computer Vision and Computer Graphics; and co-authored 35 publications in many conferences & journals. I currently work in the FinTech domain at hawk:AI, as a Chief Data Scientist.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hi! I am a Sr. Principal AI Architect @ aiXplain. Before I was Chief Data Scientist @ hawk:AI & ConnectedLife, and Researcher @ T-Labs & Microsoft Research."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcbb30d50095d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kayuksel.medium.com/?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": ""}, {"url": "https://kayuksel.medium.com/?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": "Kamer Ali YUKSEL"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F728d307f8858&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&user=Kamer+Ali+YUKSEL&userId=728d307f8858&source=post_page-728d307f8858----cbb30d50095d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcbb30d50095d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcbb30d50095d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.quantconnect.com/terminal/processCache?request=embedded_backtest_dfc0fa7d17e0029e9a7dee3483fe8b7c.html", "anchor_text": "Source-Code of Trading Strategy via Population-based SelectionThis back-test period is not utilized during the optimization of this strategy parameters with Population-based Constant Rebalanced Portfolio Selection.www.quantconnect.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cbb30d50095d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----cbb30d50095d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----cbb30d50095d---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/portfolio-management?source=post_page-----cbb30d50095d---------------portfolio_management-----------------", "anchor_text": "Portfolio Management"}, {"url": "https://medium.com/tag/quantitative-finance?source=post_page-----cbb30d50095d---------------quantitative_finance-----------------", "anchor_text": "Quantitative Finance"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcbb30d50095d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&user=Kamer+Ali+YUKSEL&userId=728d307f8858&source=-----cbb30d50095d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcbb30d50095d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&user=Kamer+Ali+YUKSEL&userId=728d307f8858&source=-----cbb30d50095d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcbb30d50095d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcbb30d50095d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cbb30d50095d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cbb30d50095d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cbb30d50095d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cbb30d50095d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cbb30d50095d--------------------------------", "anchor_text": ""}, {"url": "https://kayuksel.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kayuksel.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kamer Ali YUKSEL"}, {"url": "https://kayuksel.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "48 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F728d307f8858&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&user=Kamer+Ali+YUKSEL&userId=728d307f8858&source=post_page-728d307f8858--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F53b0df995762&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvalidation-set-over-fitting-because-of-random-initialization-selection-bias-cbb30d50095d&newsletterV3=728d307f8858&newsletterV3Id=53b0df995762&user=Kamer+Ali+YUKSEL&userId=728d307f8858&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}