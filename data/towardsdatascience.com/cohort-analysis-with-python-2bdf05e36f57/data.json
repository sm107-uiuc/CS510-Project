{"url": "https://towardsdatascience.com/cohort-analysis-with-python-2bdf05e36f57", "time": 1683018363.120518, "path": "towardsdatascience.com/cohort-analysis-with-python-2bdf05e36f57/", "webpage": {"metadata": {"title": "Cohort Analysis with Python. A data clustering skill that every\u2026 | by Joe Tran | Towards Data Science", "h1": "Cohort Analysis with Python", "description": "If you are a data analyst working for an e-commerce company, there is a high chance that one of your tasks at work is to discover insights from customer data to improve customer retention. However\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/analytics-for-humans/what-is-cohort-analysis-and-how-should-i-use-it-3ac7c39c50dd", "anchor_text": "blog", "paragraph_index": 3}, {"url": "https://github.com/joetrankang/cohort-analysis/raw/main/sales_2018-01-01_2019-12-31.csv", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://bit.ly/3FElqxG", "anchor_text": "https://bit.ly/3FElqxG", "paragraph_index": 15}], "all_paragraphs": ["If you are a data analyst working for an e-commerce company, there is a high chance that one of your tasks at work is to discover insights from customer data to improve customer retention.", "However, the customer data is massive and each customer behaves differently. Customer A who was acquired in March 2020 displays a different behaviour from customer B who was acquired in May 2020. Therefore, it is essential to group customers into different clusters and then investigate the behaviour of each cluster over time. This is called cohort analysis.", "Cohort Analysis is the data analytic technique in understanding the behaviour of a special group of customers over a period of time.", "In this article, I will not go into details the theory of cohort analysis. If you do not know what cohort analysis is all about, I would strongly recommend you read this blog first.", "This article is more to show you how to segment customers into different cohorts and observe the retention rate for each cohort over a period of time.", "You can download the data here.", "Here is it not wise to just simply select df.loc[df['customer_type']]. Let me explain why. In this data, under the customer_type column, First_time refers to new customer, whereas Returning refers to returning customer. So if I first bought on 31 Dec 2019, the data will show me as new customer on 31 Dec 2019 but as returning customer on my 2nd, 3rd, \u2026 time. The cohort analysis looks at new customers and their subsequent purchases. Therefore, if we simply use df.loc[df['customer_type']=='First-time',] we would be ignoring the subsequent purchases of the new customers, which is not a correct way to analyse cohort behaviour.", "Thus, what I did here was that, first create a list of all the first-time customers and store it as first_time. Then from the original customer dataframe df select only those customers whose IDs fall within the first_time customers group. By doing this, we can make sure that we obtain the data that has only first-time customers and their subsequent purchases.", "Now, let\u2019s drop the customer_type column because it is not necessary anymore. Also, convert the day column into correct date-time format", "purchase_rate function will determine whether that is a 2nd, 3rd, 4th purchase of each customer.", "join_date function allows us to identify the date the customer joins.", "age_by_month function gives us how many months from the current purchase of a customer to the first time purchase.", "Now the input is ready. Let\u2019s create cohorts.", "That is it. Hope you guys enjoyed and picked up something from this article. If you have any questions, feel free to put them down in the comment section below. Thank you for your read. Have a great day and happy new year \ud83c\udf89\ud83c\udf89\ud83c\udf89", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Ex-Google | Product Analytics | MLOps | Subscribe to receive my stories \ud83d\udcc8: https://bit.ly/3FElqxG"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2bdf05e36f57&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@joetrankang?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joetrankang?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": "Joe Tran"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F60093eff6455&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&user=Joe+Tran&userId=60093eff6455&source=post_page-60093eff6455----2bdf05e36f57---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bdf05e36f57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bdf05e36f57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/analytics-for-humans/what-is-cohort-analysis-and-how-should-i-use-it-3ac7c39c50dd", "anchor_text": "blog"}, {"url": "https://github.com/joetrankang/cohort-analysis/raw/main/sales_2018-01-01_2019-12-31.csv", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----2bdf05e36f57---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/tag/e-commerce-business?source=post_page-----2bdf05e36f57---------------e_commerce_business-----------------", "anchor_text": "E Commerce Business"}, {"url": "https://medium.com/tag/retention?source=post_page-----2bdf05e36f57---------------retention-----------------", "anchor_text": "Retention"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2bdf05e36f57---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2bdf05e36f57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&user=Joe+Tran&userId=60093eff6455&source=-----2bdf05e36f57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2bdf05e36f57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&user=Joe+Tran&userId=60093eff6455&source=-----2bdf05e36f57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bdf05e36f57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2bdf05e36f57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2bdf05e36f57---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2bdf05e36f57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joetrankang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joetrankang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Joe Tran"}, {"url": "https://medium.com/@joetrankang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "711 Followers"}, {"url": "https://bit.ly/3FElqxG", "anchor_text": "https://bit.ly/3FElqxG"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F60093eff6455&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&user=Joe+Tran&userId=60093eff6455&source=post_page-60093eff6455--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F989ea71b7e15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohort-analysis-with-python-2bdf05e36f57&newsletterV3=60093eff6455&newsletterV3Id=989ea71b7e15&user=Joe+Tran&userId=60093eff6455&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}