{"url": "https://towardsdatascience.com/solving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8", "time": 1683006523.120367, "path": "towardsdatascience.com/solving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8/", "webpage": {"metadata": {"title": "Solving a Quadratic Problem (QP) in an open source linear solver | by Pablo Azurduy | Towards Data Science", "h1": "Solving a Quadratic Problem (QP) in an open source linear solver", "description": "linearization of a quadratic function to solve a quadratic model in a linear solver (python mip), with a retail example. The use of the discretization and approximation of a convex function."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/List_of_optimization_software", "anchor_text": "open source linear solvers available", "paragraph_index": 1}, {"url": "https://www.gurobi.com/es/resource/switching-from-open-source/", "anchor_text": "are not as fast and advanced", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Quadratic_programming", "anchor_text": "QP", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/COIN-OR", "anchor_text": "COIN-CBC", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Quadratic_programming", "anchor_text": "QP model", "paragraph_index": 3}, {"url": "https://www.python-mip.com/", "anchor_text": "python-mip", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Service_level#.CE.B2_service_level_.28type_2.2C_also_known_as_.22fill_rate.22.29", "anchor_text": "fill-rate", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Quadratic_programming#Solution_methods", "anchor_text": "many possible solutions", "paragraph_index": 14}, {"url": "https://www.youtube.com/watch?v=o7_zS7Bx2VA&feature=youtu.be", "anchor_text": "linearization", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/Linearization#Uses_of_linearization", "anchor_text": "points of interest", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Taylor_series", "anchor_text": "Taylor expansion", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Convex_function", "anchor_text": "convex", "paragraph_index": 18}, {"url": "https://math.stackexchange.com/questions/2446606/linear-programming-set-a-variable-the-max-between-two-another-variables/3568461#3568461", "anchor_text": "known codification", "paragraph_index": 18}, {"url": "https://github.com/pabloazurduy/qp-mip", "anchor_text": "here", "paragraph_index": 25}], "all_paragraphs": ["So, I ended up college using a lot of fancy optimization software (with student license) such as AMPL, CPLEX and Gurobi, and I was super hyped because bring-me-the-model and I-will-solve-it. The only problem was that these super awesome solvers are f\u0336*\u0336 \u0336e\u0336x\u0336p\u0336e\u0336n\u0336s\u0336i\u0336v\u0336e\u0336 not cheap and many small companies don\u2019t have the money to buy a license, or maybe they are not willing to pay unless they see the value on that.", "So, as me, you find out that there are many open source linear solvers available out there, but they are not as fast and advanced as your student-licensed-wonderful-solver, and of course, they have limitations. The one feature that I missed the most was the ability to solve QP models.", "Therefore, if you are looking for a way to solve a QP model in an open source linear solver (such as COIN-CBC) this article might be for you.", "If you are familiar with what a QP model is you can skip the next section. If you are wondering why should I care about quadratic functions? keep reading.", "(a.k.a. should\u2019t be solving a linear model ?). I think the easiest way to introduce the importance of QP models is through an example.", "Let\u2019s assume that you have to plan the t-shirt shipments from warehouse to retail stores for an entire season (let\u2019s call i \u2208 I a store and e{i,t} the shipment to the store i in the period t (day t)). Let\u2019s imagine that with some super-cool-machine-learning algorithm you made a forecast for each store and period of time (lets call d{i,t} the demand forecast i \u2208 I, t \u2208 T).", "Let\u2019s say, for the purpose of this example that we have a bump in demand of t-shirts (because, summer) and probably we are not being able to fulfill all the demand. If we plot this forecast for three stores (1,2,4) we have:", "Now, let\u2019s build a linear model to minimize the unfulfilled orders on each store (u{i,t}).", "Ok, so nothing fancy here, just a standard linear model. We implemented in python with our favorite linear modeling library (python-mip \u2764\ufe0f)", "With the model result, we then plot the unfulfilled orders by store, focusing only on two stores (1,4). In this plot, the dashed line represents the filled orders, and the continuous line represents the forecasted demand, then, the gap between these two lines is the unfulfilled amount.", "We can observe some interesting things from the upper plot:", "Then, we have a problem\u2026 The solution is not \u201cfair\u201d between stores. If I manually solve this problem and only have 120 units to distribute between locations, I would split them \u201cmore equally\u201d knowing that I am going to have unfulfilled orders. But, at least I will achieve a fill-rate of 60% in every store, rather to have some of them with 100% and others with 0% fill-rate, keeping a better service level across stores.", "Where did this problem come from? the problem is that our model only cares about the total amount of unfulfilled orders (min \u2211 u{i,t}) so for the model is equivalent to have 100 unfulfilled orders in one store and 0 in the other store or having 50 unfulfilled in each store, because the cost is the same (100 units). so how can we solve that? Using a quadratic function.", "Now, with a \u201cquadratic-punishment\u201d, the cost is not linear between stores and periods, therefore, it is better to have a more equally-distributed unfulfilled number of orders (100\u00b2 + 0\u00b2 > 50\u00b2 + 50\u00b2). That\u2019s one of the most common applications of a quadratic function. Then, how we implemented it in a linear solver?", "There are many possible solutions for solving a QP-model but, we will implement probably the simplest one to keep using our linear solver, the linearization. If we plot the quadratic function, we will have something like the left plot:", "What we want to do is to transform this curve in a series of (k) lines that can be an approximation of the original curve. We are only interested in a certain level of precision of the approximation x\u00b2 so we can choose a limited number of points between the bounds of the domain (x{k} points). More points will lead to a better approximation of the original function. Those points x{k} are called \u201cpoints of interest\u201d. Using the first term of the Taylor expansion we will find the linearization on each point of interest.", "To illustrate this, let\u2019s assume that we have 6 points of interest. Plotting the original curve and the six lines we have the following figure:", "We can observe that the more points we add, the more accurate the approximation will result. But, as we will soon observe, more lines will increase the model complexity.", "We can take advantage of the fact that the x\u00b2 function is convex. Having that property, we can assume that all the lines L(x) are always a \u201clower cover\u201d of f(x). Having this in mind, we can use the max function to have a discrete approximation of the curve ~f(x) because is just the max of all lines (L(x)). Therefore using a known codification we can add it to the model", "We can see that for every discrete point that we add to the linearization, we also add a new binary variable to the model (bk), because of that, a finer approximation will lead to a higher execution time.", "I built a helper that can abstract us from this approximation:", "Then we can simply add it to our previous model implementation", "Let\u2019s run it and see the new results:", "We can observe some interesting from the plot", "We got it!, Now, we can see that the results are way more consistent. It takes a little bit longer using 5 points of interest by store/day, but, if we are going to solve this problem once in a season, it is not a big deal", "Thanks for reading!!, This is the first article that I\u2018ve written so feel free to give me any feedback. All the source code of this project is available here, any issue please leave it in the repo.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ops @uber , Operations Research and Data Science enthusiast."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F56ed6bb468e8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@pablo.azurduy.s?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pablo.azurduy.s?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": "Pablo Azurduy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44e21d36709b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&user=Pablo+Azurduy&userId=44e21d36709b&source=post_page-44e21d36709b----56ed6bb468e8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56ed6bb468e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56ed6bb468e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.funny-memes.org/2014/01/in-terms-of-money-we-have-no-money.html", "anchor_text": "funny-memes.org"}, {"url": "https://www.pinterest.cl/pin/189432728053114696/", "anchor_text": "Melissa Elias"}, {"url": "https://en.wikipedia.org/wiki/List_of_optimization_software", "anchor_text": "open source linear solvers available"}, {"url": "https://www.gurobi.com/es/resource/switching-from-open-source/", "anchor_text": "are not as fast and advanced"}, {"url": "https://en.wikipedia.org/wiki/Quadratic_programming", "anchor_text": "QP"}, {"url": "https://en.wikipedia.org/wiki/COIN-OR", "anchor_text": "COIN-CBC"}, {"url": "https://en.wikipedia.org/wiki/Quadratic_programming", "anchor_text": "QP model"}, {"url": "https://unsplash.com/@burgessbadass?utm_source=medium&utm_medium=referral", "anchor_text": "Burgess Milner"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.python-mip.com/", "anchor_text": "python-mip"}, {"url": "https://github.com/pabloazurduy/qp-mip/blob/master/model.py", "anchor_text": "https://github.com/pabloazurduy/qp-mip"}, {"url": "https://en.wikipedia.org/wiki/Service_level#.CE.B2_service_level_.28type_2.2C_also_known_as_.22fill_rate.22.29", "anchor_text": "fill-rate"}, {"url": "https://makeameme.org/meme/BEWARE--math", "anchor_text": "makeameme.org"}, {"url": "https://en.wikipedia.org/wiki/Quadratic_programming#Solution_methods", "anchor_text": "many possible solutions"}, {"url": "https://www.youtube.com/watch?v=o7_zS7Bx2VA&feature=youtu.be", "anchor_text": "linearization"}, {"url": "https://en.wikipedia.org/wiki/Linearization#Uses_of_linearization", "anchor_text": "points of interest"}, {"url": "https://en.wikipedia.org/wiki/Taylor_series", "anchor_text": "Taylor expansion"}, {"url": "https://en.wikipedia.org/wiki/Convex_function", "anchor_text": "convex"}, {"url": "https://math.stackexchange.com/questions/2446606/linear-programming-set-a-variable-the-max-between-two-another-variables/3568461#3568461", "anchor_text": "known codification"}, {"url": "https://github.com/pabloazurduy/qp-mip/blob/master/model.py", "anchor_text": "https://github.com/pabloazurduy/qp-mip"}, {"url": "https://github.com/pabloazurduy/qp-mip", "anchor_text": "here"}, {"url": "https://medium.com/tag/operations-research?source=post_page-----56ed6bb468e8---------------operations_research-----------------", "anchor_text": "Operations Research"}, {"url": "https://medium.com/tag/qp?source=post_page-----56ed6bb468e8---------------qp-----------------", "anchor_text": "Qp"}, {"url": "https://medium.com/tag/linear-model?source=post_page-----56ed6bb468e8---------------linear_model-----------------", "anchor_text": "Linear Model"}, {"url": "https://medium.com/tag/solver?source=post_page-----56ed6bb468e8---------------solver-----------------", "anchor_text": "Solver"}, {"url": "https://medium.com/tag/python?source=post_page-----56ed6bb468e8---------------python-----------------", "anchor_text": "Python"}, {"url": "https://creativecommons.org/licenses/by-nd/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56ed6bb468e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&user=Pablo+Azurduy&userId=44e21d36709b&source=-----56ed6bb468e8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56ed6bb468e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&user=Pablo+Azurduy&userId=44e21d36709b&source=-----56ed6bb468e8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56ed6bb468e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F56ed6bb468e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----56ed6bb468e8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----56ed6bb468e8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pablo.azurduy.s?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pablo.azurduy.s?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pablo Azurduy"}, {"url": "https://medium.com/@pablo.azurduy.s/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44e21d36709b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&user=Pablo+Azurduy&userId=44e21d36709b&source=post_page-44e21d36709b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F44e21d36709b%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-a-quadratic-problem-qp-in-an-open-source-linear-solver-56ed6bb468e8&user=Pablo+Azurduy&userId=44e21d36709b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}