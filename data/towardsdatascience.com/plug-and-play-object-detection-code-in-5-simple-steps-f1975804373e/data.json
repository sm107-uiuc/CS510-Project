{"url": "https://towardsdatascience.com/plug-and-play-object-detection-code-in-5-simple-steps-f1975804373e", "time": 1683000808.436883, "path": "towardsdatascience.com/plug-and-play-object-detection-code-in-5-simple-steps-f1975804373e/", "webpage": {"metadata": {"title": "Creating a Weapon Detector in 5 simple steps | by Rahul Agarwal | Towards Data Science", "h1": "Creating a Weapon Detector in 5 simple steps", "description": "It forms the backbone of many fantastic industrial applications. Some of them being self-driving cars, medical imaging and face detection. The most common way to solve this problem is by using\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-hitchhikers-guide-to-object-detection-and-instance-segmentation-ac0146fe8e11", "anchor_text": "post", "paragraph_index": 2}, {"url": "https://github.com/MLWhiz/object_detection", "anchor_text": "code", "paragraph_index": 9}, {"url": "https://storage.googleapis.com/openimages/web/index.html", "anchor_text": "open image dataset", "paragraph_index": 11}, {"url": "https://github.com/matterport/Mask_RCNN", "anchor_text": "matterport/Mask_RCNN", "paragraph_index": 20}, {"url": "https://github.com/MLWhiz/data_science_blogs/blob/master/object_detection/guns_and_swords/gns.py", "anchor_text": "gns.py", "paragraph_index": 24}, {"url": "https://github.com/MLWhiz/data_science_blogs/blob/master/object_detection/guns_and_swords/1.%20Visualize%20Dataset.ipynb", "anchor_text": "Visualize Dataset.ipynb", "paragraph_index": 25}, {"url": "https://github.com/MLWhiz/data_science_blogs/blob/master/object_detection/guns_and_swords/1.%20Visualize%20Dataset.ipynb", "anchor_text": "", "paragraph_index": 25}, {"url": "https://github.com/MLWhiz/data_science_blogs/blob/master/object_detection/guns_and_swords/2.%20predict.ipynb", "anchor_text": "prediction.ipynb", "paragraph_index": 33}, {"url": "https://github.com/MLWhiz/data_science_blogs/tree/master/object_detection", "anchor_text": "Github", "paragraph_index": 38}, {"url": "https://coursera.pxf.io/7mKnnY", "anchor_text": "Deep Learning in Computer Vision", "paragraph_index": 39}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium", "paragraph_index": 40}, {"url": "http://eepurl.com/dbQnuX", "anchor_text": "blog", "paragraph_index": 40}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz", "paragraph_index": 40}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 43}], "all_paragraphs": ["Object Detection is a helpful tool to have in your coding repository.", "It forms the backbone of many fantastic industrial applications. Some of them being self-driving cars, medical imaging and face detection.", "In my last post on Object detection, I talked about how Object detection models evolved.", "But what good is theory, if we can\u2019t implement it?", "This post is about implementing and getting an object detector on our custom dataset of weapons.", "The problem we will specifically solve today is that of Instance Segmentation using Mask-RCNN.", "Can we create masks for each object in the image? Specifically something like:", "The most common way to solve this problem is by using Mask-RCNN. The architecture of Mask-RCNN looks like below:", "There is a lot more to it. If you want to learn more about the theory, read my last post.", "This post is mostly going to be about the code.", "The use case we will be working on is a weapon detector. A weapon detector is something that can be used in conjunction with street cameras as well as CCTV\u2019s to fight crime. So it is pretty nifty.", "So, I started with downloading 40 images each of guns and swords from the open image dataset and annotated them using the VIA tool. Now setting up the annotation project in VIA is petty important, so I will try to explain it step by step.", "VIA is an annotation tool, using which you can annotate images both bounding boxes as well as masks. I found it as one of the best tools to do annotation as it is online and runs in the browser itself.", "You will see a page like:", "The next thing we want to do is to add the different class names in the region_attributes. Here I have added \u2018gun\u2019 and \u2018sword\u2019 as per our use case as these are the two distinct targets I want to annotate.", "I have kept all the files in the folder data. Next step is to add the files we want to annotate. We can add files in the data folder using the \u201cAdd Files\u201d button in the VIA tool. And start annotating along with labels as shown below after selecting the polyline tool.", "Click on save project on the top menu of the VIA tool.", "Save file as via_region_data.json by changing the project name field. This will save the annotations in COCO format.", "We will need to set up the data directories first so that we can do object detection. In the code below, I am creating a directory structure that is required for the model that we are going to use.", "After running the above code, we will get the data in the below folder structure:", "We will use the code from the matterport/Mask_RCNN GitHub repository. You can start by cloning the repository and installing the required libraries.", "Once we are done with installing the dependencies and cloning the repo, we can start with implementing our project.", "We make a copy of the samples/balloon directory in Mask_RCNN folder and create a samples/guns_and_swords directory where we will continue our work:", "We start by renaming and changing balloon.py in the samples/guns_and_swords directory to gns.py. The balloon.py file right now trains for one target. I have extended it to use multiple targets. In this file, we change:", "Showing only the changedgnsConfig here to get you an idea. You can take a look at the whole gns.py code here.", "Once we are done with changing the gns.py file,we can visualize our masks and images. You can do simply by following this Visualize Dataset.ipynb notebook.", "To train the maskRCNN model, on the Guns and Swords dataset, we need to run one of the following commands on the command line based on if we want to initialise our model with COCO weights or imagenet weights:", "The command with weights=last will resume training from the last epoch. The weights are going to be saved in the logs directory in the Mask_RCNN folder.", "This is how the loss looks after our final epoch.", "You can take advantage of tensorboard to visualise how your network is performing. Just run:", "You can get the tensorboard at", "Here is how our mask loss looks like:", "We can see that the validation loss is performing pretty abruptly. This is expected as we only have kept 20 images in the validation set.", "Predicting a new image is also pretty easy. Just follow the prediction.ipynb notebook for a minimal example using our trained model. Below is the main part of the code.", "This is how the result looks for some images in the validation set:", "The results don\u2019t look very promising and leave a lot to be desired, but that is to be expected because of very less training data(60 images). One can try to do the below things to improve the model performance for this weapon detector.", "In this post, I talked about how to implement Instance segmentation using Mask-RCNN for a custom dataset.", "I tried to make the coding part as simple as possible and hope you find the code useful. In the next part of this post, I will deploy this model using a web app. So stay tuned.", "You can download the annotated weapons data as well as the code at Github.", "If you want to know more about various Object Detection techniques, motion estimation, object tracking in video etc., I would like to recommend this awesome course on Deep Learning in Computer Vision", "Thanks for the read. I am going to be writing more beginner-friendly posts in the future too. Follow me up at Medium or Subscribe to my blog to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter @mlwhiz.", "Also, a small disclaimer \u2014 There might be some affiliate links in this post to relevant resources as sharing knowledge is never a bad idea.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff1975804373e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1975804373e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1975804373e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----f1975804373e--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----f1975804373e--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----f1975804373e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1975804373e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1975804373e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://storage.googleapis.com/openimages/web/index.html", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/a-hitchhikers-guide-to-object-detection-and-instance-segmentation-ac0146fe8e11", "anchor_text": "post"}, {"url": "https://medium.com/@jonathan_hui/image-segmentation-with-mask-r-cnn-ebe6d793272", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/a-hitchhikers-guide-to-object-detection-and-instance-segmentation-ac0146fe8e11", "anchor_text": "Demystifying Object Detection and Instance Segmentation for Data ScientistsEasy Explanation!!! I triedtowardsdatascience.com"}, {"url": "https://github.com/MLWhiz/object_detection", "anchor_text": "code"}, {"url": "https://storage.googleapis.com/openimages/web/index.html", "anchor_text": "open image dataset"}, {"url": "http://www.robots.ox.ac.uk/~vgg/software/via/via.html", "anchor_text": "http://www.robots.ox.ac.uk/~vgg/software/via/via.html"}, {"url": "https://github.com/matterport/Mask_RCNN", "anchor_text": "matterport/Mask_RCNN"}, {"url": "https://github.com/matterport/Mask_RCNN", "anchor_text": "https://github.com/matterport/Mask_RCNN"}, {"url": "https://github.com/MLWhiz/data_science_blogs/blob/master/object_detection/guns_and_swords/gns.py", "anchor_text": "gns.py"}, {"url": "https://github.com/MLWhiz/data_science_blogs/blob/master/object_detection/guns_and_swords/1.%20Visualize%20Dataset.ipynb", "anchor_text": "Visualize Dataset.ipynb"}, {"url": "https://github.com/MLWhiz/data_science_blogs/blob/master/object_detection/guns_and_swords/1.%20Visualize%20Dataset.ipynb", "anchor_text": ""}, {"url": "https://localhost:6006", "anchor_text": "https://localhost:6006"}, {"url": "https://github.com/MLWhiz/data_science_blogs/blob/master/object_detection/guns_and_swords/2.%20predict.ipynb", "anchor_text": "prediction.ipynb"}, {"url": "https://unsplash.com/@cgower?utm_source=medium&utm_medium=referral", "anchor_text": "Christopher Gower"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/MLWhiz/data_science_blogs/tree/master/object_detection", "anchor_text": "Github"}, {"url": "https://coursera.pxf.io/7mKnnY", "anchor_text": "Deep Learning in Computer Vision"}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium"}, {"url": "http://eepurl.com/dbQnuX", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f1975804373e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f1975804373e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----f1975804373e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f1975804373e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----f1975804373e---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1975804373e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----f1975804373e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1975804373e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----f1975804373e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1975804373e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1975804373e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff1975804373e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f1975804373e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1975804373e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f1975804373e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f1975804373e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f1975804373e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f1975804373e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f1975804373e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f1975804373e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f1975804373e--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplug-and-play-object-detection-code-in-5-simple-steps-f1975804373e&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}