{"url": "https://towardsdatascience.com/target-encoding-for-multi-class-classification-c9a7bcb1a53", "time": 1683012823.4072268, "path": "towardsdatascience.com/target-encoding-for-multi-class-classification-c9a7bcb1a53/", "webpage": {"metadata": {"title": "Target Encoding For Multi-Class Classification | Towards Data Science", "h1": "Target Encoding For Multi-Class Classification", "description": "What is wrong with TargetEncoder from category_encoders?"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/all-about-target-encoding-d356c4e9e82", "anchor_text": "my previous article that explained how target encoding actually works", "paragraph_index": 0}, {"url": "http://contrib.scikit-learn.org/category_encoders/index.html", "anchor_text": "category-encoders", "paragraph_index": 0}, {"url": "https://dl.acm.org/doi/10.1145/507533.507538", "anchor_text": "original paper", "paragraph_index": 5}, {"url": "https://github.com/mohannishant6", "anchor_text": "GitHub", "paragraph_index": 17}], "all_paragraphs": ["This article is in continuation of my previous article that explained how target encoding actually works. The article explained the encoding method on a binary classification task through theory and an example, and how category-encoders library gives incorrect results for multi-class target. This article shows when TargetEncoder of category_encoders fails, gives a snip of the theory behind encoding multi-class target, and provides the correct code, along with an example.", "Look at this data. Color is a feature, and Target is well... target. Our aim is to encode Color based on Target.", "Let\u2019s do the usual target encoding on this.", "Hmm, that doesn\u2019t look right, does it? All the colors were replaced with 1. Why? Because TargetEncoder takes mean of all the Target values for each color, instead of probability.", "While TargetEncoder works for the case when you have a binary target having 0 and 1s, it won\u2019t work for two cases:", "Here is what the original paper by Daniele Micci-Barreca that introduced mean target encoding says for multi-class targets.", "Let\u2019s say there are n classes in the label.", "The theory says, first step is to one-hot encode your label. This gives n binary columns, one corresponding to each class of the target. However, only n-1 binary columns will be linearly independent. So, any one of these columns can be dropped. Now, use the usual target encoding for each categorical feature using each binary label, one at a time. Therefore, for one categorical feature you get n-1 target encoded features. If there are k categorical features in the dataset, you get k times (n-1) features in total.", "Let\u2019s continue with the previous data.", "Step 1: One-hot encode the label.", "Notice that Target_1 column represents presence or absence of 0 in the Target. It\u2019s 1 if there is a 0 in Target, and 0 otherwise. Similarly, Target_2 column represents presence or absence of 1 in the Target.", "Step 2: Target encode Color using each of the one-hot encoded Targets.", "Step 3: If there are more categorical features other than Color, repeat step 1 and 2 for all.", "Note that for the sake of clarity, I encoded all the three Color_Target columns. If you know one-hot encoding then you know that one of the columns can be removed without any loss of information. Therefore, here we can safely remove Color_Target_3 column, without any loss of information.", "You are here for the code, aren\u2019t you!?", "I give here a function, which takes as input a pandas dataframe of features, and a pandas series of the target label. The feature df can have a mixture of numeric and categorical features.", "In this article, I pointed out what\u2019s wrong with category_encoder\u2019s TargetEncoder. I explained what the original paper on target encoding has to say for multi-class labels. I explained the same through an example and provided a working modular code for you to plug and play in your application.", "Check out some of my cool projects on GitHub!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc9a7bcb1a53&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mohannishant6.medium.com/?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": ""}, {"url": "https://mohannishant6.medium.com/?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": "Nishant Mohan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F30ff2a59e5e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&user=Nishant+Mohan&userId=30ff2a59e5e5&source=post_page-30ff2a59e5e5----c9a7bcb1a53---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9a7bcb1a53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9a7bcb1a53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@heftiba?utm_source=medium&utm_medium=referral", "anchor_text": "Toa Heftiba"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/all-about-target-encoding-d356c4e9e82", "anchor_text": "my previous article that explained how target encoding actually works"}, {"url": "http://contrib.scikit-learn.org/category_encoders/index.html", "anchor_text": "category-encoders"}, {"url": "https://dl.acm.org/doi/10.1145/507533.507538", "anchor_text": "original paper"}, {"url": "https://www.linkedin.com/in/mohannishant/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/mohannishant6", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/multiclass-classification?source=post_page-----c9a7bcb1a53---------------multiclass_classification-----------------", "anchor_text": "Multiclass Classification"}, {"url": "https://medium.com/tag/target-encoding?source=post_page-----c9a7bcb1a53---------------target_encoding-----------------", "anchor_text": "Target Encoding"}, {"url": "https://medium.com/tag/multi-class?source=post_page-----c9a7bcb1a53---------------multi_class-----------------", "anchor_text": "Multi Class"}, {"url": "https://medium.com/tag/categorical-data?source=post_page-----c9a7bcb1a53---------------categorical_data-----------------", "anchor_text": "Categorical Data"}, {"url": "https://medium.com/tag/categorical-variable?source=post_page-----c9a7bcb1a53---------------categorical_variable-----------------", "anchor_text": "Categorical Variable"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9a7bcb1a53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&user=Nishant+Mohan&userId=30ff2a59e5e5&source=-----c9a7bcb1a53---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9a7bcb1a53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&user=Nishant+Mohan&userId=30ff2a59e5e5&source=-----c9a7bcb1a53---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9a7bcb1a53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc9a7bcb1a53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c9a7bcb1a53---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c9a7bcb1a53--------------------------------", "anchor_text": ""}, {"url": "https://mohannishant6.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mohannishant6.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nishant Mohan"}, {"url": "https://mohannishant6.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "74 Followers"}, {"url": "https://www.linkedin.com/in/mohannishant/", "anchor_text": "https://www.linkedin.com/in/mohannishant/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F30ff2a59e5e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&user=Nishant+Mohan&userId=30ff2a59e5e5&source=post_page-30ff2a59e5e5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9fbd44251677&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftarget-encoding-for-multi-class-classification-c9a7bcb1a53&newsletterV3=30ff2a59e5e5&newsletterV3Id=9fbd44251677&user=Nishant+Mohan&userId=30ff2a59e5e5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}