{"url": "https://towardsdatascience.com/how-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418", "time": 1683015003.001933, "path": "towardsdatascience.com/how-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418/", "webpage": {"metadata": {"title": "How to build a KNN classification model from scratch and visualize it using Streamlit | by Rahul Banerjee | Towards Data Science", "h1": "How to build a KNN classification model from scratch and visualize it using Streamlit", "description": "KNN or K Nearest Neighbour is used for classification and regression. In this tutorial, we will be using it for classification. Since the target label is known, it is a Supervised algorithm. It\u2026"}, "outgoing_paragraph_urls": [{"url": "https://plotly.com/python/line-and-scatter/", "anchor_text": "Plotly\u2019s documentation", "paragraph_index": 22}, {"url": "https://medium.com/illumination/how-to-deploy-your-streamlit-app-on-heroku-7060b8c3df17", "anchor_text": "my tutorial", "paragraph_index": 29}, {"url": "https://github.com/rahulbanerjee26/KNN-Streamlit", "anchor_text": "here", "paragraph_index": 30}], "all_paragraphs": ["KNN or K Nearest Neighbour is used for classification and regression. In this tutorial, we will be using it for classification. Since the target label is known, it is a Supervised algorithm. It essentially takes an input and finds the K nearest points to it. It then checks the labels of the nearest points and classifies the input as the label which occurred the most. Say we want to build a model to classify an animal as a dog or a cat based on the weight, height as input. If K = 3, we find the 3 nearest points to our input and check their label. If 2 of the 3 nearest points have a label \u2018dog\u2019, our model classifies the input as \u2018dog\u2019. If 2 of the 3 nearest points have a label \u2018cat\u2019, our model will classify the input as \u2018cat\u2019", "First, we will create all the helper functions we will need. Then we will combine them and add some streamlit functions to build a web app.", "For ease of understanding and visualization, we will be working with a dataset that has 2 features and has binary labels, i.e \u20180\u2019 and \u20181\u2019.", "To normalize a list of values, we iterate over each value and find the difference between the value and minimum value in the list. We then divide it by the difference of maximum and minimum values in the list.", "The function takes in a list of values and returns the normalized values", "This function will be used to calculate the distance between two given points. We will use Euclid's Formula to calculate the distance.", "The function takes in two 2D points and returns the Euclidean Distance between them. Since we are considering a dataset with only 2 features, we are only considering the x and y coordinates. As the number of features increases, this function will need to change to find the squared difference between all indices.", "We iterate over each value in the dataset and use our distance function above to calculate the distance between the two points. We then store the distances and sort it.", "The function takes the following parameters as input:", "First, we create an empty array to store the distances. We need to store the distance and the index of the record in the dataset. The index can be used in the y array to find the label for that record.", "Then we sort the distances. Next, we use the get_label function (It will be discussed below) to get the most occurring label.", "Since the distances array is sorted, the first k elements,i.e distances[0:k] are the k nearest neighbours to our input. We return the predicted label of our input, the k nearest neighbours and the rest of the neighbours.", "We essentially get the k nearest neighbours, check the label for each. In our case, we have only two labels \u20180\u2019 and \u20181\u2019. If the label of a neighbour is \u20180\u2019 we increment count for occurrences of \u20180\u2019 and do the same for \u20181\u2019. We compare the counts for occurrences of both labels and return the label with the higher count.", "The function takes the k nearest neighbours as the input. Each record in neighbours contains the distance from the input point and its original id. We use the id and the y array to get the label of the record. We then check the label and return the predicted label.", "We have created the required Helper functions. Now we will combine them along with some streamlit functions. Exciting Stuff! \ud83d\ude0e", "We will use Plotly to plot our graphs since Plotly plots interactive graphs. For our dataset, we will import a dataset from sklearn.datasets. We will also use the pandas library to create Datframes.", "I will break the rest of the tutorial into three parts", "We will use streamlit\u2019s title method to display a title and slider method to create a numerical slider to get input from the user. Since our data is normalized, we expect the input to be normalized as well. Therefore we restrict the user to enter values between 0 and 1. We can also take input from the user and use minimum, maximum values in our dataset to normalize the input.", "Every time the slider value is changed the entire python script is re-run and the variables will contain the new values according to the slider.", "The make_blobs functions create a dataset for us which looks similar to the distribution in the graph above. In the real world, the dataset won\u2019t be so co-operative but this dataset will suffice for now. I suggest you plot a scatter plot using matplotlib to see the distribution of the data.", "x contains the features and y contains the respective labels", "First, we use the normalizing helper function we created before to normalize our data. Then we combine the x and y array to create a Dataframe. We use streamlit\u2019s dataframe method to view the dataframe.", "You can read Plotly\u2019s documentation for a better understanding of the above code. We create a figure with the scatter plot of the dataframe we just created. We also add our input point to better understand where it is located with respect to other points in the dataset. Streamlit\u2019s plotly_chart method takes a Plotly figure as a parameter and plots an interactive graph on our app.", "We use the find_nearest function we created earlier to get the predicted label and ids, distances of the k nearest neighbours and the far neighbours.", "We display the predicted label us streamlit\u2019s subheader method", "The above code basically uses the id of the nearest neighbours and combines the id, distance with the feature1, feature2 values of the record and its label. We use the combined list to create a dataframe containing the information of the nearest neighbours. We then use streamlit\u2019s dataframe method to display it. This dataframe will help us understand the graph below it.", "We create a similar dataframe for the far neighbours. We use Plotly to plot a scatter plot. We will now add the input and lines connecting the input to its k nearest neighbours.", "We iterate over each of the neighbours and add a line between the neighbour and our input point to the figure we created. Finally, we use the plotly_chart method to plot the figure.", "And That\u2019s It \ud83d\udc4f We have a created a KNN classifier from scratch and created a Streamlit App to visualize it", "If you are interested in deploying your streamlit app, check out my tutorial.", "You can find the GitHub repo here.", "I am still fairly new to the world of Machine Learning, if you find any errors/mistakes or any piece of code which can be optimized, please let me know! I am always open to feedback \ud83d\ude03", "I recently created a blog using WordPress, I would love it if you check it out \ud83d\ude03", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Developer | Views are my own"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9fe8059cc418&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rahul1999.medium.com/?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": ""}, {"url": "https://rahul1999.medium.com/?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": "Rahul Banerjee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6e3dfc7b6a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&user=Rahul+Banerjee&userId=6e3dfc7b6a86&source=post_page-6e3dfc7b6a86----9fe8059cc418---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9fe8059cc418&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9fe8059cc418&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://plotly.com/python/line-and-scatter/", "anchor_text": "Plotly\u2019s documentation"}, {"url": "https://medium.com/illumination/how-to-deploy-your-streamlit-app-on-heroku-7060b8c3df17", "anchor_text": "my tutorial"}, {"url": "https://github.com/rahulbanerjee26/KNN-Streamlit", "anchor_text": "here"}, {"url": "https://realpythonproject.com/", "anchor_text": "Python Project Tutorials \u2014 Improve your CV/Portfolio with these Python Project Tutorials.Deploy your Machine Learning Web App using Streamlit Sharing In my previous articles, I have talked about building a\u2026realpythonproject.com"}, {"url": "https://www.linkedin.com/in/rahulbanerjee2699/", "anchor_text": "Rahul Banerjee \u2014 Product Engineering Intern \u2014 EY | LinkedInView Rahul Banerjee\u2019s profile on LinkedIn, the world\u2019s largest professional community. Rahul has 4 jobs listed on their\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/knn?source=post_page-----9fe8059cc418---------------knn-----------------", "anchor_text": "Knn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9fe8059cc418---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----9fe8059cc418---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/streamlit?source=post_page-----9fe8059cc418---------------streamlit-----------------", "anchor_text": "Streamlit"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9fe8059cc418---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9fe8059cc418&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&user=Rahul+Banerjee&userId=6e3dfc7b6a86&source=-----9fe8059cc418---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9fe8059cc418&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&user=Rahul+Banerjee&userId=6e3dfc7b6a86&source=-----9fe8059cc418---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9fe8059cc418&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9fe8059cc418&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9fe8059cc418---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9fe8059cc418--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9fe8059cc418--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9fe8059cc418--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9fe8059cc418--------------------------------", "anchor_text": ""}, {"url": "https://rahul1999.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rahul1999.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Banerjee"}, {"url": "https://rahul1999.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "698 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6e3dfc7b6a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&user=Rahul+Banerjee&userId=6e3dfc7b6a86&source=post_page-6e3dfc7b6a86--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F48ebe237f3bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418&newsletterV3=6e3dfc7b6a86&newsletterV3Id=48ebe237f3bd&user=Rahul+Banerjee&userId=6e3dfc7b6a86&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}