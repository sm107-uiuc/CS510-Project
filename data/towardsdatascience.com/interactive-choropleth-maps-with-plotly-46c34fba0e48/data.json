{"url": "https://towardsdatascience.com/interactive-choropleth-maps-with-plotly-46c34fba0e48", "time": 1682997638.596714, "path": "towardsdatascience.com/interactive-choropleth-maps-with-plotly-46c34fba0e48/", "webpage": {"metadata": {"title": "Interactive Choropleth Maps With Plotly | by Benedikt Droste | Towards Data Science", "h1": "Interactive Choropleth Maps With Plotly", "description": "Recently, I wanted to visualize data from the last federal election. I live in Duesseldorf, Germany and wanted to know in which districts which party had relative strengths. Surprisingly, it was a\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.mapbox.com.", "anchor_text": "www.mapbox.com.", "paragraph_index": 3}, {"url": "https://opendate.duesseldorf.de", "anchor_text": "https://opendate.duesseldorf.de", "paragraph_index": 5}, {"url": "https://plot.ly/~empet/14692/mapbox-choropleth-that-works-with-plotly/#/", "anchor_text": "tutorial", "paragraph_index": 15}, {"url": "https://medium.com/@droste.benedikt/membership", "anchor_text": "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community.", "paragraph_index": 30}, {"url": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "anchor_text": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "paragraph_index": 32}], "all_paragraphs": ["Recently, I wanted to visualize data from the last federal election. I live in Duesseldorf, Germany and wanted to know in which districts which party had relative strengths.Surprisingly, it was a little harder than expected. Therefore I would like to share my experiences here. We will go through the following steps together:", "0. Preparation1. Reading Data Over An Api In GeoJSON- And JSON-Format2. Extracting The Relevant Features From The GeoJSON-Data3. Customizing Our Map With Colorscales and Mouseovers4. Putting Everything Together And Adding Interactivity", "You can follow this tutorial with your own dataset to create your individual map. The easiest way to do this would be to have the data in GeoJSON or JSON format. Here you can take a look at the data from this tutorial:", "You also need a mapbox account for this tutorial. Mapbox provides a flexible geodata API. Using the Mapbox API, we can map our individual data to a scalable world map. You can create an account at www.mapbox.com. You need a individual token to use the mapbox services which be be found under the account settings:", "GeoJSON is open standard format for geographical features. Within this standard, storage of data follows a particular structure. Features can be points, lines, polygons or even combinations of the three types. For example, a polygon, a closed area inside a specific room, might look like this:", "In our example, we will also access GeoJSON data and combine it with JSON data. On the website https://opendate.duesseldorf.de there are both geodata and election data for the districts in Dusseldorf. However, the data is separated and we must merge it later.", "First, we import all necessary libraries:", "Now we can read the contents for the URLs:", "Both data sources are now available as a nested dictionary. With data_wahl['result']['records'] the election results of the individual districts can be displayed:", "We can now import the relevant election data from the dictionary into a pandas dataframe:", "Now let\u2019s look at the geodata. For further processing with Plotly, we now extract the relevant features from the geodata request:", "The list sources contains the coordinates for all parts of the city. We will later hand over this list to the Mapbox object in order to present the respective districts.The IDs of the districts are also extracted from the geodata:", "We need the IDs later to allocate the correct colorscales for each party and each district.", "In order to be able to dynamically color the individual parts of the city later on, we need the range of the respective percentages for each party. The lightest shade is assigned the lowest value and the highest value the darkest shade. For this we determine for each party and each district the lowest and highest value:", "Now we create for each party its own colorscale. Above all, I focused on the colors of the parties:", "The following function I have taken from a tutorial, which is highly recommended:", "Now we use this function for our previously created mini- and max-dictionaries to create the individual colorscales:", "We want to identify the respective election winner on one card and the individual parties on the other. For this we adapt the mouseover texts:", "For Plotly we must now note the following. The data includes the geodata to represent the shapes for the districts, and the mouseover texts. But we want flexible colorscales depending on the selection in the dropdown menu and relative strength of a party in each district. These colorscales are represented by the layer. The data can be assigned to a list. Depending on the selection of the dropdown, we set the visibility for individual elements from the list to True or False. For example, if we have a list of three records and want to render the first one, we give a list of the entries [True,False,False] as an argument for visible.", "We first create the data list. We extract the longitude and latitude elements for each district and add them to a list:", "The layers are also collected in a list:", "Now we add the drop down menu. First, we will complete the labels for the entries and the respective Visible conditions. Finally, we submit the data and layer lists:", "In the visible list, we define which element of the data list is displayed. In order for the colorscales to adapt accordingly, we must also define our layers list under \"mapbox.layers\" .", "If we put everything together we have the following code:", "If you want to run the code, you need to modify the mapbox_access_token in line 10.", "Your result should look like this:", "It\u2019s very easy to process GeoJSON- and JSON-formats with Python. With Plotly you can create beautiful Choropleth maps from the geo information. It does get a bit trickier if you want to add interactivity using a dropdown, as you need individual colorscales for each layer. However, the args provides the needed flexibility. In a next step, it would still be nice to add an individual colorbar legend. In addition, it would be interesting to illustrate even more socio-demographic characteristics. So be creative!", "General documentation for choropleth Plotly maps:", "A great notebook by empet as introduction to Plotly choropleth maps:", "An update of the same user for the new Plotly trace-type choroplethmapbox:", "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analyst in a management consultancy | Interested in data science, web scraping & storytelling | https://www.linkedin.com/in/benedikt-droste-893b1b189/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F46c34fba0e48&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@droste.benedikt?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": "Benedikt Droste"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F93813b47e030&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&user=Benedikt+Droste&userId=93813b47e030&source=post_page-93813b47e030----46c34fba0e48---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F46c34fba0e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F46c34fba0e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://opendata.duesseldorf.de/api/action/datastore/search.json?resource_id=6893a12e-3d75-4b2f-bb8b-708982bea7b7", "anchor_text": "https://opendata.duesseldorf.de/api/action/datastore/search.json?resource_id=6893a12e-3d75-4b2f-bb8b-708982bea7b7"}, {"url": "https://opendata.duesseldorf.de/sites/default/files/Stadtteile_WGS84_4326.geojson", "anchor_text": "https://opendata.duesseldorf.de/sites/default/files/Stadtteile_WGS84_4326.geojson"}, {"url": "http://www.mapbox.com.", "anchor_text": "www.mapbox.com."}, {"url": "https://opendate.duesseldorf.de", "anchor_text": "https://opendate.duesseldorf.de"}, {"url": "https://plot.ly/~empet/14692/mapbox-choropleth-that-works-with-plotly/#/", "anchor_text": "tutorial"}, {"url": "https://github.com/bd317/geodata/blob/master/API-Duesseldorf-Github%20(1).ipynb", "anchor_text": "https://github.com/bd317/geodata/blob/master/API-Duesseldorf-Github%20(1).ipynb"}, {"url": "https://plot.ly/python/choropleth-maps/", "anchor_text": "https://plot.ly/python/choropleth-maps/"}, {"url": "https://plot.ly/~empet/14692/mapbox-choropleth-that-works-with-plotly/#/", "anchor_text": "b'Mapbox choropleth that works with Plotly | empet | Plotly'Edit descriptionplot.ly"}, {"url": "https://plot.ly/~empet/15237/choroplethmapbox-with-dropdown-menu/#/", "anchor_text": "b'Choroplethmapbox with dropdown menu | empet | Plotly'Edit descriptionplot.ly"}, {"url": "https://medium.com/@droste.benedikt/membership", "anchor_text": "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community."}, {"url": "https://medium.com/tag/plotly?source=post_page-----46c34fba0e48---------------plotly-----------------", "anchor_text": "Plotly"}, {"url": "https://medium.com/tag/python?source=post_page-----46c34fba0e48---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F46c34fba0e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&user=Benedikt+Droste&userId=93813b47e030&source=-----46c34fba0e48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F46c34fba0e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&user=Benedikt+Droste&userId=93813b47e030&source=-----46c34fba0e48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F46c34fba0e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F46c34fba0e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----46c34fba0e48---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----46c34fba0e48--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----46c34fba0e48--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----46c34fba0e48--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----46c34fba0e48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Benedikt Droste"}, {"url": "https://medium.com/@droste.benedikt/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "971 Followers"}, {"url": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "anchor_text": "https://www.linkedin.com/in/benedikt-droste-893b1b189/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F93813b47e030&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&user=Benedikt+Droste&userId=93813b47e030&source=post_page-93813b47e030--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe545585931c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-choropleth-maps-with-plotly-46c34fba0e48&newsletterV3=93813b47e030&newsletterV3Id=e545585931c&user=Benedikt+Droste&userId=93813b47e030&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}