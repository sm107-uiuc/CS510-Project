{"url": "https://towardsdatascience.com/reverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8", "time": 1683017656.0749362, "path": "towardsdatascience.com/reverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8/", "webpage": {"metadata": {"title": "Reverse Arrow of Time with Genetic Algorithm and GPU | by Eric Bouteillon | Towards Data Science", "h1": "Reverse Arrow of Time with Genetic Algorithm and GPU", "description": "On September 1st 2020, Kaggle relaunched a previous competition \u201cConway\u2019s Reverse Game of Life\u201d with improved rules. Our final standing in this competition is a combination of diverse techniques, and\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.kaggle.com", "anchor_text": "Kaggle", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/conways-reverse-game-of-life-2020/overview", "anchor_text": "Kaggle website", "paragraph_index": 1}, {"url": "http://en.wikipedia.org/wiki/Conway's_Game_of_Life", "anchor_text": "Wikipedia", "paragraph_index": 3}, {"url": "https://pytorch.org/tutorials/beginner/blitz/tensor_tutorial.html#sphx-glr-beginner-blitz-tensor-tutorial-py", "anchor_text": "tensor", "paragraph_index": 7}, {"url": "https://www.kaggle.com/c/conways-reverse-game-of-life-2020/overview/evaluation", "anchor_text": "evaluation section", "paragraph_index": 9}, {"url": "https://github.com/ebouteillon", "anchor_text": "my github repository", "paragraph_index": 22}], "all_paragraphs": ["On September 1st 2020, Kaggle relaunched a previous competition \u201cConway\u2019s Reverse Game of Life\u201d with improved rules. Our final standing in this competition is a combination of diverse techniques, and I will show you an approach which helped the team to rise to the second position: a Genetic Algorithm I wrote from scratch. Many top solutions were based on a systematic search of a solution requiring thousand hours of CPU time. This innovative and performant approach reaches a top 10 position after running only 4 hours on a GPU.", "Official competition description in available on the Kaggle website and is paraphrased in this section for ease of reading:", "The Game of Life is a cellular automaton created by mathematician John Conway in 1970. The game consists of a board of cells that are either on or off. One creates an initial configuration of these on/off states and observes how it evolves. There are four simple rules to determine the next state of the game board, given the current state:", "These simple rules result in many interesting behaviors and have been the focus of a large body of mathematics. As Wikipedia states:", "The emergence of order from simple rules begs an interesting question \u2014 what happens if we set time backwards?", "This competition is an experiment to see if machine learning (or optimization, or any method) can predict the game of life in reverse. Is the chaotic start of Life predictable from its orderly ends? Kaggle has created many games, evolved them, and provided only the end boards. We are asked to predict the starting board that resulted in each end board.", "Genetic algorithms are among the most fascinating techniques for optimizing problems. They draw inspiration from Charles Darwin\u2019s theory of natural evolution.", "For this competition, individuals considered are potential boards at their initial state. To take full advantage of pytorch, the population is stored in a single boolean tensor with dimensions (number_of_individuals, N, N) where N is the dimension of a board; N=25 for this competition.", "Create a random initial population made of n_parents boards of size NxN. I also included a hyper-parameter to set how many cells are live (20% in sample code below).", "The competition metric is defined in the evaluation section of the competition:", "You are evaluated on the mean absolute error of your predictions, stepped forward by the specified, and compared to the provided ending solution.", "In other words, to score an individual, we need to apply the Game Of Life rules to this board and count how many cells are different than the target solution.", "Note: each cell is expressed with a boolean, therefore computing the absolute error for each cell between the input (board after applying the game of life rules) and the target can be done with a single xor. Then we can compute the score for all individuals within the population with a sum on only the two last two tensor\u2019s dimensions.", "The first step is to determine for each cell how many of its direct neighbors are lives. For counting neighbors, we are using a simple 2D-convolution on the whole board.", "We are combining the genetic information of two parents to create a new individual. Choosing randomly cells between the two parents was less efficient than replacing a complete region of one parent with cells from another parent. That is the reason why I am using masks of random 17x17 squares. Cells outside the square are taken from the first parent and cells inside the square are cells from the second parent. To improve speed, 625 masks are generated in advance and kept in GPU memory and are randomly chosen for each new individual.", "We randomly flip cells of parents from live to death and conversely, with a probability of MUTATION.", "The results of this implementation are pretty good as it reaches 9th position in the competition leader-board by running less than 4 hours on my computer\u2019s GPU (9 hours on Kaggle\u2019s GPU). The score continues to improve if we run the algorithm longer (for instance by increasing the population size).", "The implementation is also memory efficient as we can grow the population up to 1 million individuals on a 11GB GPU.", "We saw how to implement from scratch a genetic algorithm on GPU using pytorch. It is a pretty performant solution both in term of speed and results.", "I learned a lot along the way about Genetic Algorithm, pytorch and how to optimize computation on the GPU.", "I would like to thank my amazing teammates: Konstantin, Robert and Maximiliano for their great approaches that push the team to the second position.", "Implementation is available as a Kaggle notebook:", "As well as on my github repository:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Product Owner at Ingenico. He has a Master of Science in Physics and a Master of Advanced Studies in Photonic, Image and Cybernetics. Kaggle Master."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1871a7b4fff8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bouteillon1981?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bouteillon1981?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": "Eric Bouteillon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc9a956273317&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&user=Eric+Bouteillon&userId=c9a956273317&source=post_page-c9a956273317----1871a7b4fff8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1871a7b4fff8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1871a7b4fff8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/geralt-9301/", "anchor_text": "geralt"}, {"url": "https://pixabay.com/illustrations/dna-genetic-material-helix-proteins-3539309/", "anchor_text": "Pixabay"}, {"url": "http://www.kaggle.com", "anchor_text": "Kaggle"}, {"url": "http://www.python.org", "anchor_text": "python"}, {"url": "http://pytorch.org", "anchor_text": "pytorch"}, {"url": "https://www.kaggle.com/c/conways-reverse-game-of-life-2020/overview", "anchor_text": "Kaggle website"}, {"url": "http://en.wikipedia.org/wiki/Conway's_Game_of_Life", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life", "anchor_text": "Conway\u2019s Game of Life"}, {"url": "https://en.wikipedia.org/wiki/File:Game_of_life_animated_glider_2.gif", "anchor_text": "Wikipedia"}, {"url": "https://pytorch.org/tutorials/beginner/blitz/tensor_tutorial.html#sphx-glr-beginner-blitz-tensor-tutorial-py", "anchor_text": "tensor"}, {"url": "https://www.kaggle.com/c/conways-reverse-game-of-life-2020/overview/evaluation", "anchor_text": "evaluation section"}, {"url": "https://www.kaggle.com/ebouteillon/top-10-with-first-genetic-algorithm-on-gpu", "anchor_text": "Top 10 with First Genetic Algorithm on GPU! \ud83d\udd25Kaggle Notebook using data from Conway's Reverse Game of Life 2020www.kaggle.com"}, {"url": "https://github.com/ebouteillon", "anchor_text": "my github repository"}, {"url": "https://github.com/ebouteillon/conways-reverse-game-of-life-2020", "anchor_text": "ebouteillon/conways-reverse-game-of-life-2020My notebooks about Kaggle competition \"Conway's Reverse Game of Life 2020\"github.com"}, {"url": "https://www.kaggle.com/c/conways-reverse-game-of-life-2020/overview/description", "anchor_text": "Conway's Reverse Game of Life 2020Reverse the arrow of time in the Game of Lifewww.kaggle.com"}, {"url": "https://www.mathworks.com/help/gads/how-the-genetic-algorithm-works.html", "anchor_text": "How the Genetic Algorithm Works - MATLAB & SimulinkThe following outline summarizes how the genetic algorithm works: The algorithm begins by creating a random initial\u2026www.mathworks.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1871a7b4fff8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1871a7b4fff8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----1871a7b4fff8---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----1871a7b4fff8---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/programming?source=post_page-----1871a7b4fff8---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1871a7b4fff8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&user=Eric+Bouteillon&userId=c9a956273317&source=-----1871a7b4fff8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1871a7b4fff8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&user=Eric+Bouteillon&userId=c9a956273317&source=-----1871a7b4fff8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1871a7b4fff8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1871a7b4fff8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1871a7b4fff8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1871a7b4fff8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bouteillon1981?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bouteillon1981?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Eric Bouteillon"}, {"url": "https://medium.com/@bouteillon1981/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "31 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc9a956273317&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&user=Eric+Bouteillon&userId=c9a956273317&source=post_page-c9a956273317--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc9a956273317%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freverse-arrow-of-time-with-genetic-algorithm-and-gpu-1871a7b4fff8&user=Eric+Bouteillon&userId=c9a956273317&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}