{"url": "https://towardsdatascience.com/geovec-word-embeddings-for-geosciences-ac1e1e854e19", "time": 1682999776.430443, "path": "towardsdatascience.com/geovec-word-embeddings-for-geosciences-ac1e1e854e19/", "webpage": {"metadata": {"title": "GeoVec: word embeddings for geosciences | by Jos\u00e9 Padarian | Towards Data Science", "h1": "GeoVec: word embeddings for geosciences", "description": "Analogies, categorisation, relatedness and spatial interpolation of word embeddings."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-1-8c0669b18097", "anchor_text": "deep learning and soil science", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-2-129e0cb4be94", "anchor_text": "Digital Soil Mapping with CNNs", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/introduction-to-word-embeddings-4cf857b12edc", "anchor_text": "introduction to word embeddings", "paragraph_index": 6}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "provided by the authors of GloVe", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/introduction-to-word-embeddings-4cf857b12edc", "anchor_text": "introduction to word embeddings", "paragraph_index": 11}], "all_paragraphs": ["As I described in the first post on deep learning and soil science, part of the job of a soil scientist is performed on the field and consists of describing what we see as thoroughly as possible. Those are important records that help us to form the mental model of the study area and to remind us of details that otherwise we might forget.", "Here is (part of) a typical soil description:", "Ap1 \u2014 0 to 7 inches; brown (10YR 5/3) ashy fine sandy loam, very dark grayish brown (10YR 3/2) moist; weak fine granular structure; soft, very friable, nonsticky and slightly plastic, common very fine and fine roots; few very fine interstitial and tubular pores; 15 percent sand-size pumice less than 2.0mm in diameter; neutral (pH 6.6); clear smooth boundary. (0 to 8 inches thick)", "Ap2 \u2014 7 to 9 inches; brown (10YR 5/3) ashy fine sandy loam, very dark grayish brown (10YR 3/2) moist; weak medium granular structure; slightly hard, friable, nonsticky and slightly plastic; common very fine and fine roots; common fine and very fine tubular and interstitial pores; 20 percent sand-size pumice less than 2.0mm in diameter; neutral (pH 7.0); clear wavy boundary. (0 to 7 inches thick)", "We can see that it is organised by layers and contains details such as colour, presence of roots, descriptions of the pores, textural class (estimated proportion of clay, silt and sand), etc. Most of the time the descriptions follow some recommended format but they might contain more or less free-form text depending on the study.", "These layer descriptions are usually accompanied by samples that are sent to the laboratory than can then be used, for example, to make maps of soil properties like the one I described on Digital Soil Mapping with CNNs. But the descriptions are almost never used by themselves although they contain important information. For instance, a layer with a dark colour could have relatively high concentration of organic matter compared with a layer with lighter colour (of course, there are exceptions).", "In order to use the valuable information contained in descriptions, my colleague Ignacio Fuentes and I decided to experiment with natural language processing (NLP) to generate domain-specific word embeddings. I\u2019m not going to explain what word embeddings are but you can find good articles such as this introduction to word embeddings.", "Since most language models take into account the co-occurence of words, we used a relatively large corpus of 280,764 full-text articles related to geosciences. After pro-processing the text (tokenisation, removing stopwords, etc.), we fitted a GloVe model to generate word embeddings that we could use in other applications.", "Downloading the 280,764 articles, pro-processing them and fitting the GloVe model was actually the easy part of the process. Since we needed to evaluate the generated vector space, we created a domain-specific test suite considering three tasks, namely analogy, relatedness and categorisation.", "In case those tasks don\u2019t sound familiar, here is a brief description and examples.", "We compared our domain-specific embeddings (GeoVec) with general domain embeddings provided by the authors of GloVe and we observed an overall performance increase of 107.9%. Of course, this is an expected outcome considering the specificity of the tasks.", "If you are familiar with word embedding (or you read this introduction to word embeddings), you have probably seen plots showing the relationship between capital cities and countries, king-male/queen-female, or other groups of analogies. In this work we were able to obtain similar results but related to geosciences.", "From the plot, any pair of related words can be expressed as an analogy. For example, from the left panel, it is possible to generate the analogy \u201cclaystone is to clay as sandstone is to ___? (sand)\u201d and the first model output is indeed \u201csand\u201d. In the left panel it is possible to observe simple analogies, mostly syntactic since \u201cclaystone\u201d contains the word \u201cclay\u201d. The right panel presents a more advanced relationship where rock names are assigned to their corresponding rock type.", "In the case of categorisation, the image below shows two examples where a k-means algorithm can correctly differentiate groups of embeddings. The left panel shows groups of soil classes from two different classification systems (USDA and WBR). There is only one ambiguous soil class (Vertisols) which is present in both classification systems, but the embeddings encode that relationship correctly, placing that class in between both groups. The right panel shows an example of how the embeddings encode information from different aggregation levels. The same soils that were correctly differentiated into two groups on the left panel, they form a cohesive group when compared to rock types on the right panel.", "Maybe you have seen some cool examples of latent space interpolation for images, such as the face interpolation example below, but it is not commonly used in the context of word embeddings.", "In the case of words, we wanted to explore if the interpolated embeddings (space \u201cbetween\u201d 2 words) yield some\u2026", "In order to generate the interpolated embeddings, we obtained linear combinations of two words embeddings by using the formula:", "where v_int is the interpolated embedding, v_a and v_b are the embeddings of the two selected words. By varying the value of \u03b1 in the range [0, 1], we generated a gradient of embeddings. For each intermediate embedding obtained by interpolation, we calculated the cosine similarity against all the words in the corpus and selected the closest one.", "In the image to the left you can see a gradient of embedding between the words \u201cboulder\u201d and \u201cclay\u201d. Those two extreme words correspond to different particle sizes, with coarse and fine size, respectively. A more complete list of particle sizes is, in order from coarse to fine, \u201cboulder\u201d > \u201ccobble\u201d > \u201cgravel\u201d > \u201csand\u201d > \u201csilt\u201d > \u201cclay\u201d. The resulting interpolated embeddings actually correspond (are close) to those particle sizes, in the same order!", "We were hoping to see that result with the interpolation (nevertheless, we were quite amazed!) since we wanted to explore the idea of spatially interpolating embeddings, which is closer to our field.", "The idea of this project was to generate a 3D geological map based on bore hole observations distributed as shown in the map bellow. The descriptions have associated coordinates and depths, similar to the soil description at the top of this blog.", "In order to perform the 3D interpolation, first we had to generate \u201cdescription embeddings\u201d. Since this is a proof of concept, we decided to use the simple approach of calculating the mean of the word embeddings in each description, resulting in a single embedding with 300 components (the number of components of GeoVec) for each description.", "After interpolating the embeddings, we obtained a 3D model that looks like:", "The left panel shows the most likely class per voxel (derived from a multi-class classifier), the middle panel shows the Confusion Index between the first and second most likely class per voxel, and the right panel shows the corresponding entropy.", "A complete description of the interpolation process and the multi-class classifier can be found in the corresponding publication (at the moment it is under review, but I will update this post after the publication has been accepted).", "These are just the first attempts to use word embeddings in geosciences. The results were very interesting since the GloVe model seems to capture many \u201cnatural\u201d properties (such as particle sizes) quite well. Of course, that is only possible if the corpus is large and diverse enough.", "We made the embedding public so people can use them and experiment with them. We will also make the test suite available to allow people to expand it with new and more complex tests, and also to use them as a baseline for new (and better!) models.", "I see great potential in using word embeddings in geosciences. There is a lot of descriptive information that has been collected over the years that could be \u201crescued\u201d and used. I also think that is possible to complement numerical data with word embeddings, so I will keep experimenting and writing about it. Stay tuned!", "More details about this work can be found in the corresponding papers.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Research Fellow at The University of Sydney. Trying to use Machine Learning for everything related to Geo Sciences\u2026 It mostly works :)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac1e1e854e19&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@spadarian?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@spadarian?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": "Jos\u00e9 Padarian"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3e87fae89f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=post_page-3e87fae89f4a----ac1e1e854e19---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac1e1e854e19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac1e1e854e19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-1-8c0669b18097", "anchor_text": "Deep learning and Soil Science - Part 1Soil spectra to predict soil properties. A multitask convolutional neural network to predict multiple soil properties\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-2-129e0cb4be94", "anchor_text": "Deep learning and Soil Science \u2014 Part 2Digital Soil Mapping using contextual spatial information. A multi-task CNN to generate soil maps from point information.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-1-8c0669b18097", "anchor_text": "deep learning and soil science"}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-2-129e0cb4be94", "anchor_text": "Digital Soil Mapping with CNNs"}, {"url": "https://towardsdatascience.com/introduction-to-word-embeddings-4cf857b12edc", "anchor_text": "introduction to word embeddings"}, {"url": "https://en.wikipedia.org/wiki/Chalcanthite", "anchor_text": "chalcanthite"}, {"url": "https://en.wikipedia.org/wiki/Malachite", "anchor_text": "malachite"}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "provided by the authors of GloVe"}, {"url": "https://towardsdatascience.com/introduction-to-word-embeddings-4cf857b12edc", "anchor_text": "introduction to word embeddings"}, {"url": "https://doi.org/10.5194/soil-5-177-2019,", "anchor_text": "https://doi.org/10.5194/soil-5-177-2019"}, {"url": "https://doi.org/10.17605/OSF.IO/4UYEQ", "anchor_text": "https://doi.org/10.17605/OSF.IO/4UYEQ"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac1e1e854e19---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/word-embeddings?source=post_page-----ac1e1e854e19---------------word_embeddings-----------------", "anchor_text": "Word Embeddings"}, {"url": "https://medium.com/tag/nlp?source=post_page-----ac1e1e854e19---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ac1e1e854e19---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ac1e1e854e19---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac1e1e854e19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=-----ac1e1e854e19---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac1e1e854e19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=-----ac1e1e854e19---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac1e1e854e19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac1e1e854e19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac1e1e854e19---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac1e1e854e19--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@spadarian?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@spadarian?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jos\u00e9 Padarian"}, {"url": "https://medium.com/@spadarian/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "503 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3e87fae89f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=post_page-3e87fae89f4a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff423d6bca138&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeovec-word-embeddings-for-geosciences-ac1e1e854e19&newsletterV3=3e87fae89f4a&newsletterV3Id=f423d6bca138&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}