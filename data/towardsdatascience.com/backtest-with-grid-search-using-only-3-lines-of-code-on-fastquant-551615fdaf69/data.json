{"url": "https://towardsdatascience.com/backtest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69", "time": 1683012275.99137, "path": "towardsdatascience.com/backtest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69/", "webpage": {"metadata": {"title": "Optimize your trading strategy with three lines of code | by Lorenzo Ampil | Towards Data Science", "h1": "Optimize your trading strategy with three lines of code", "description": "If you want to consistently earn money with your investments, backtesting is one of the best ways to assess the effectiveness of your trading strategies \u2014 of course, assuming that you implement it\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/enzoampil/fastquant", "anchor_text": "fastquant", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/backtest-your-trading-strategy-with-only-3-lines-of-python-3859b4a4ab44?source=friends_link&sk=ec647b6bb43fe322013248fd1d473015", "anchor_text": "article", "paragraph_index": 4}, {"url": "https://hawksight.co/", "anchor_text": "this new tool", "paragraph_index": 5}, {"url": "https://finance.yahoo.com/", "anchor_text": "Yahoo Finance", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/backtest-your-trading-strategy-with-only-3-lines-of-python-3859b4a4ab44?source=friends_link&sk=ec647b6bb43fe322013248fd1d473015", "anchor_text": "article", "paragraph_index": 17}, {"url": "https://github.com/mementum/backtrader", "anchor_text": "backtrader", "paragraph_index": 22}, {"url": "https://github.com/enzoampil/fastquant", "anchor_text": "fastquant", "paragraph_index": 22}, {"url": "https://enzoampil.github.io/fastquant-blog/grid%20search/backtest/2020/04/20/backtest_with_grid_search.html", "anchor_text": "technical tutorial", "paragraph_index": 23}, {"url": "https://twitter.com/AND__SO", "anchor_text": "Twitter", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/lorenzoampil/", "anchor_text": "Linkedin", "paragraph_index": 24}, {"url": "https://join.slack.com/t/fastquant/shared_invite/zt-gaaoahkz-X~5qw0psNOLg1iFYKcpRlQ", "anchor_text": "Slack workspace", "paragraph_index": 25}, {"url": "https://hawksight.co/", "anchor_text": "new no-code tool I\u2019m building", "paragraph_index": 26}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 28}, {"url": "http://Hawksight.co", "anchor_text": "Hawksight.co", "paragraph_index": 30}, {"url": "https://github.com/enzoampil/fastquant", "anchor_text": "https://github.com/enzoampil/fastquant", "paragraph_index": 30}], "all_paragraphs": ["If you want to consistently earn money with your investments, backtesting is one of the best ways to assess the effectiveness of your trading strategies \u2014 of course, assuming that you implement it properly. The idea is that you can experiment with the different parameters for your chosen strategies, and see which combinations give you the best returns for your investment.", "However, this can easily start getting tedious as you would have to run hundreds or even thousands of parameter combinations manually.", "To solve this problem, we can use fastquant to implement a technique called \u201cgrid search\u201d, which basically allows you to run a backtest across each of the parameter combinations that you want to run for your strategy.", "For the rest of the article, I\u2019ll be demonstrating how to apply automated grid search when backtesting your trading strategies.", "Note: If you\u2019re not yet familiar with how to do basic backtesting with fastquant, you may want to check out my previous article on how to do this in 3 lines of code.", "As a side note, if you\u2019re interested in performing this type of analysis without even having to code, do sign up for this new tool I\u2019m building to make advanced investment analysis more accessible!", "Okay, let\u2019s start by installing fastquant via pip.", "Note: get_stock_data supports all of the companies accessible from Yahoo Finance and PSE.", "Say you want to backtest a simple moving average crossover (SMAC) strategy on JFC stock with a fast period of 15 days, and slow period of 40 days.", "You\u2019ll notice that your final portfolio value went down by a lot (~31%), and by looking at the chart below, you\u2019ll see that this is because the strategy was still recommending trades (green and red arrows) when the stock was on an overall down trend.", "So now, we\u2019ll want to see if there\u2019s a combination of \u201cslow period\u201d and \u201cfast period\u201d that will lead to an SMAC strategy that knows not to make trades during the overall downtrend.", "One way to do this is to try out a large number of possible fast period and slow period combinations. For this example, we\u2019ll set the slow period to take values within the range 20 to 241 (skipping every 5), while the fast period can take values within the range 1 to 20.", "This means fast period can take 20 possible values, while slow period can take 45 possible values. Together, that translates to 900 (20 x 45) possible combinations! Imagine doing this one by one right.", "Thankfully, we can easily automate this by using fastquant\u2019s built-in grid search capabilities by using iterators (e.g. list , range ) as inputs, rather than single numbers.", "Note that \u201cbacktest\u201d returns a pandas dataframe (\u201cresults\u201d) which contains the results for each iteration on each row. Each column of the dataframe corresponds to either a parameter that was used (e.g. fast_period), or a performance metric for the strategy (e.g. final_value).", "Conveniently, the rows are sorted in descending order based on each iteration\u2019s portfolio return, and so the \u201cbest\u201d parameter combinations are the ones at the top of the dataframe.", "In this case, it seems that the top parameter combination is: fast_period=3 , and slow_period=105 , with a portfolio return of 7,042.02. This indicates that we may want to use this parameter combination when utilizing the SMAC strategy on JFC stock.", "Note: It is very possible that this parameter combination is still overfitting to the chosen period. See the caveats and safeguards of backtesting in this previous article.", "Now, let\u2019s run our optimal strategy!", "As shown in the plot below, the parameter combination above would have recommended us to sell our stock right before the overall downtrend \u2014 see the red downward arrow right before the drop. This explains how it was able to avoid the losses that we saw during our initial implementation of the SMAC strategy at the beginning of this article.", "With the results dataframe, you can even visualize the effectiveness of each parameter combination with a heatmap like below!", "Congratulations! By now, you should be familiar with how to automatically optimize your trading strategy with fastquant\u2019s built in grid search capabilities. Next time you catch yourself plugging in parameter combinations manually to backtest, do consider using this automated approach!", "It\u2019s also important to note that this is a capability that was adapted from the backtrader package, which fastquant is built on top of. The difference is that fastquant allows you to do this in much fewer lines of code (as few as 3), so that you can spend more time testing your hypotheses, rather than setting up code.", "To see a more detailed version of the examples above with full code, including a demo on how the code would have looked without the \u201cbuilt-in grid search\u201d, do check out this technical tutorial by Jerome de Leon.", "If you have any questions about this material, please feel free to comment below, or message me on Twitter, or Linkedin.", "Lastly, in case you want to contribute to the package, or learn more about how others are using fastquant, do join our community Slack workspace, where we have bi-weekly meet ups with fellow quants!", "If you want to make this kind of analysis even more simple without having to code at all (or want to avoid the pain of doing all of the setup required), you can subscribe for early access to this new no-code tool I\u2019m building to democratize data driven investments.", "Hoping to make these kinds of powerful analyses accessible to more people!", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-Founder & CTO @ Hawksight.co | Creator of the fastquant python package https://github.com/enzoampil/fastquant | AI Products for Finance with #ML, and #NLProc"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F551615fdaf69&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----551615fdaf69--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----551615fdaf69--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lorenzoampil.medium.com/?source=post_page-----551615fdaf69--------------------------------", "anchor_text": ""}, {"url": "https://lorenzoampil.medium.com/?source=post_page-----551615fdaf69--------------------------------", "anchor_text": "Lorenzo Ampil"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fffdac9d6f5eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&user=Lorenzo+Ampil&userId=ffdac9d6f5eb&source=post_page-ffdac9d6f5eb----551615fdaf69---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F551615fdaf69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F551615fdaf69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/enzoampil/fastquant", "anchor_text": "fastquant"}, {"url": "https://towardsdatascience.com/backtest-your-trading-strategy-with-only-3-lines-of-python-3859b4a4ab44?source=friends_link&sk=ec647b6bb43fe322013248fd1d473015", "anchor_text": "article"}, {"url": "https://hawksight.co/", "anchor_text": "this new tool"}, {"url": "https://finance.yahoo.com/", "anchor_text": "Yahoo Finance"}, {"url": "https://towardsdatascience.com/backtest-your-trading-strategy-with-only-3-lines-of-python-3859b4a4ab44?source=friends_link&sk=ec647b6bb43fe322013248fd1d473015", "anchor_text": "article"}, {"url": "https://enzoampil.github.io/fastquant-blog/grid%20search/backtest/2020/04/20/backtest_with_grid_search.html", "anchor_text": "technical tutorial"}, {"url": "https://github.com/mementum/backtrader", "anchor_text": "backtrader"}, {"url": "https://github.com/enzoampil/fastquant", "anchor_text": "fastquant"}, {"url": "https://enzoampil.github.io/fastquant-blog/grid%20search/backtest/2020/04/20/backtest_with_grid_search.html", "anchor_text": "technical tutorial"}, {"url": "https://twitter.com/AND__SO", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/lorenzoampil/", "anchor_text": "Linkedin"}, {"url": "https://join.slack.com/t/fastquant/shared_invite/zt-gaaoahkz-X~5qw0psNOLg1iFYKcpRlQ", "anchor_text": "Slack workspace"}, {"url": "https://hawksight.co/", "anchor_text": "new no-code tool I\u2019m building"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/trading?source=post_page-----551615fdaf69---------------trading-----------------", "anchor_text": "Trading"}, {"url": "https://medium.com/tag/stocks?source=post_page-----551615fdaf69---------------stocks-----------------", "anchor_text": "Stocks"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----551615fdaf69---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/tag/finance?source=post_page-----551615fdaf69---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/data-science?source=post_page-----551615fdaf69---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F551615fdaf69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&user=Lorenzo+Ampil&userId=ffdac9d6f5eb&source=-----551615fdaf69---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F551615fdaf69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&user=Lorenzo+Ampil&userId=ffdac9d6f5eb&source=-----551615fdaf69---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F551615fdaf69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----551615fdaf69--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F551615fdaf69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----551615fdaf69---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----551615fdaf69--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----551615fdaf69--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----551615fdaf69--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----551615fdaf69--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----551615fdaf69--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----551615fdaf69--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----551615fdaf69--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----551615fdaf69--------------------------------", "anchor_text": ""}, {"url": "https://lorenzoampil.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lorenzoampil.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lorenzo Ampil"}, {"url": "https://lorenzoampil.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "918 Followers"}, {"url": "http://Hawksight.co", "anchor_text": "Hawksight.co"}, {"url": "https://github.com/enzoampil/fastquant", "anchor_text": "https://github.com/enzoampil/fastquant"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fffdac9d6f5eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&user=Lorenzo+Ampil&userId=ffdac9d6f5eb&source=post_page-ffdac9d6f5eb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4cce090dcbcc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktest-with-grid-search-using-only-3-lines-of-code-on-fastquant-551615fdaf69&newsletterV3=ffdac9d6f5eb&newsletterV3Id=4cce090dcbcc&user=Lorenzo+Ampil&userId=ffdac9d6f5eb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}