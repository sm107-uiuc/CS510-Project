{"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "time": 1683009473.747404, "path": "towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970/", "webpage": {"metadata": {"title": "What is One-Hot Encoding and how to use Pandas get_dummies function | by B. Chen | Towards Data Science", "h1": "What is One-Hot Encoding and how to use Pandas get_dummies function", "description": "I get questions all the time about some concepts in machine learning and what they really mean, for example, in one of my previous articles Google\u2019s 7 steps of Machine Learning in practice, I get\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/the-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77", "anchor_text": "Google\u2019s 7 steps of Machine Learning in practice", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Ordinal_data", "anchor_text": "ordinal variable", "paragraph_index": 5}, {"url": "https://en.wikiversity.org/wiki/Dummy_variable_(statistics)", "anchor_text": "dummy encoding variable", "paragraph_index": 10}, {"url": "https://en.wikiversity.org/wiki/Dummy_variable_(statistics)", "anchor_text": "Dummy encoding variable", "paragraph_index": 11}, {"url": "https://www.geeksforgeeks.org/ml-dummy-variable-trap-in-regression-models/", "anchor_text": "dummy variable trap", "paragraph_index": 11}, {"url": "https://www.kaggle.com/c/titanic/overview", "anchor_text": "Titanic Dataset from Kaggle", "paragraph_index": 12}, {"url": "https://en.wikiversity.org/wiki/Dummy_variable_(statistics)", "anchor_text": "dummy encoding variable", "paragraph_index": 17}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github", "paragraph_index": 28}], "all_paragraphs": ["I get questions all the time about some concepts in machine learning and what they really mean, for example, in one of my previous articles Google\u2019s 7 steps of Machine Learning in practice, I get asked what is one-hot encoding, and when should we use it? That\u2019s is a great question and every machine learning practitioner needs to know the answer, so let\u2019s talk about it and dive into some code with Pandas get_dummies().", "In the step of data processing in machine learning, we often need to prepare our data in specific ways before feeding into a machine learning model. One of the examples is to perform a One-Hot encoding on categorical data.", "One Hot Encoding is a process in the data processing that is applied to categorical data, to convert it into a binary vector representation for use in machine learning algorithms", "One of the major problems with machine learning is that a lot of algorithms cannot work directly with categorical data. Categorical data [1] are variables that can take on one of a limited number of possible values. Some examples are:", "Therefore, we need a way to convert categorical data into a numerical form and our machine learning algorithm can take in that as input. The most widely used encoding techniques are:", "In the above examples, each value in a categorical variable represents a different category. Some categories may have a natural relationship (known as a natural ordering) to each other. The airline travel class variable does have a natural ordering of values. This type of categorical variable is known as an ordinal variable. Ordinal variables should be treated differently in machine learning because the ordinality generally comes with some significance. In the case of airline travel class, the passengers in the higher classes tend to be wealthier and older. Integer Encoding is used to convert ordinal variable to numerical data, for example", "First Class is 1, Business Class is 2, and Economy Class is 3", "The integer values have a natural ordered relationship between each other and machine learning algorithms may be able to learn this relationship [2].", "For categories variables where no such ordinal relationship exists, Integer Encoding could result in poor performance or unexpected results [2]. Fortunately, One-Hot Encoding is a way to combat this. One-Hot Encoding simply creates one column for every possible value and put a 1 in the appropriate column. Below is the equivalent One-Hot Encoding representation.", "With One-Hot Encoding, the binary vector arrays representation allows a machine learning algorithm to leverage the information contained in a category value without the confusion caused by ordinality.", "However, there is some redundancy in One-Hot encoding. For instance, in the above example, if we know that a passenger\u2019s flight ticket is not First Class and not Economy Class, then it must be Business Class. So we only need to use two of these three dummy-coded variables as a predictor. More generally, the number of dummy-coded variables needed is one less than the number of possible values, which is K-1. In statistics, this is called a dummy encoding variable, or dummy variable. Below is the equivalent dummy encoding variable representation:", "Dummy encoding variable is a standard advice in statistics to avoid the dummy variable trap, However, in the world of machine learning, One-Hot encoding is more recommended because dummy variable trap is not really a problem when applying regularization [3].", "Before we diving into tutorial, let\u2019s first pull up an example dataset we can work with. For this tutorial, we will be working on the Titanic Dataset from Kaggle. This is a very famous dataset and very often is a student\u2019s first step in machine learning. Let\u2019s import pandas and load data to get started.", "We created a function load_data() to load train.csv file into pandas DataFrame.", "Let\u2019s pretend we want to create a One-Hot encoding variable for the Sex column. Here is how we create it.", "What it does is create one column for every possible value and they are two possible values for Sex. It tells you whether it is female or male by putting a 1 in the appropriate column.", "Generally speaking, if we have K possible values for a categorical variable, we will get K columns to represent it.", "There is some redundancy in One-Hot encoding. For instance, in the above Sex One-Hot encoding, a person is either male or female. So we only need to use one of these two dummy-coded variables as a predictor. More generally, the number of dummy-coded variables needed is one less than the number of possible values, which is K-1. In statistics, this is called a dummy encoding variable, or dummy variable.", "By default, the get_dummies() does not do dummy encoding, but One-Hot encoding. To produce an actual dummy encoding from a DataFrame, we need to pass drop_first=True", "By default, get_dummies() use variable values as column names. For instance, male and female in the above Sex column example. To identify where the dummy variables came from, we can use the prefix argument. For example:", "Now, let\u2019s try to get One-Hot encoding for a variable that has more than two possible values. For instance, there is an Embarked column and we can do value_counts() to check its different values.", "You might be thinking we have still got to attach the One-Hot encoding variables to the DataFrame. To do that, we first assign the output to a variable called embarked_dummies", "Then, we use pd.concat() to attach embarked_dummies to the DataFrame df.", "The way pd.concat() works is we can concatenate columns side by side or rows on top of one another. So in this case, we concatenate df and embarked_dummies along columns (axis =1). In the end, we overwrite the original df.", "By running df.head(), we can see that we\u2019ve now got the Embarked_C, Embarked_Q, and Embarked_S.", "We have been passing a Series to get_dummies(), but we\u2019re gonna pass a DataFrame.", "df is a DataFrame. We pass columns a list and we tell it Sex and Embarked are the columns we want to dummy.", "By running df.head(), we can see that the original Sex column and Embarked column are gone, they have been replaced with the dummy columns.", "Please checkout the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F922eb9bd4970&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----922eb9bd4970---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F922eb9bd4970&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F922eb9bd4970&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@hope_house_press_leather_diary_studio?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Hope House Press \u2014 Leather Diary Studio"}, {"url": "https://towardsdatascience.com/s/photos/coding?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/the-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77", "anchor_text": "Google\u2019s 7 steps of Machine Learning in practice"}, {"url": "https://en.wikipedia.org/wiki/Ordinal_data", "anchor_text": "ordinal variable"}, {"url": "https://en.wikiversity.org/wiki/Dummy_variable_(statistics)", "anchor_text": "dummy encoding variable"}, {"url": "https://en.wikiversity.org/wiki/Dummy_variable_(statistics)", "anchor_text": "Dummy encoding variable"}, {"url": "https://www.geeksforgeeks.org/ml-dummy-variable-trap-in-regression-models/", "anchor_text": "dummy variable trap"}, {"url": "https://www.kaggle.com/c/titanic/overview", "anchor_text": "Titanic Dataset from Kaggle"}, {"url": "https://www.kaggle.com/c/titanic/data?select=train.csv", "anchor_text": "Kaggle"}, {"url": "https://en.wikiversity.org/wiki/Dummy_variable_(statistics)", "anchor_text": "dummy encoding variable"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github"}, {"url": "https://en.wikipedia.org/wiki/Categorical_variable", "anchor_text": "Categorical variable in Wikipedia"}, {"url": "https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/", "anchor_text": "Why one-hot encoding in machine learning"}, {"url": "https://kiwidamien.github.io/are-you-getting-burned-by-one-hot-encoding.html", "anchor_text": "Are you getting burned by one-hot encoding"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----922eb9bd4970---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/one-hot-encoding?source=post_page-----922eb9bd4970---------------one_hot_encoding-----------------", "anchor_text": "One Hot Encoding"}, {"url": "https://medium.com/tag/python?source=post_page-----922eb9bd4970---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----922eb9bd4970---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/dummy-variable?source=post_page-----922eb9bd4970---------------dummy_variable-----------------", "anchor_text": "Dummy Variable"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F922eb9bd4970&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&user=B.+Chen&userId=563d09da62a&source=-----922eb9bd4970---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F922eb9bd4970&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&user=B.+Chen&userId=563d09da62a&source=-----922eb9bd4970---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F922eb9bd4970&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F922eb9bd4970&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----922eb9bd4970---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----922eb9bd4970--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----922eb9bd4970--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----922eb9bd4970--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----922eb9bd4970--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}