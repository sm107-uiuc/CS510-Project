{"url": "https://towardsdatascience.com/forecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f", "time": 1683015213.709856, "path": "towardsdatascience.com/forecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f/", "webpage": {"metadata": {"title": "Forecasting web traffic in a GIF | Towards Data Science", "h1": "Forecasting web traffic with Python and Google Analytics", "description": "Learn how to forecast web traffic using Python and the Google Analytics API: a step-by-step guide that will show you how to create time-series as a GIF."}, "outgoing_paragraph_urls": [{"url": "https://support.google.com/analytics/answer/6367342?hl=en", "anchor_text": "demo Google Analytics account", "paragraph_index": 4}, {"url": "https://developers.google.com/analytics/devguides/config/mgmt/v3", "anchor_text": "Google\u2019s Management API documentation", "paragraph_index": 5}, {"url": "https://facebook.github.io/prophet/", "anchor_text": "Facebook\u2019s Prophet Github.", "paragraph_index": 26}, {"url": "https://medium.com/making-sense-of-data/time-series-next-value-prediction-using-regression-over-a-rolling-window-228f0acae363", "anchor_text": "speaking about rolling windows", "paragraph_index": 36}, {"url": "https://medium.com/@arthur.s.moreau/how-to-explain-predictive-modeling-to-business-managers-ed9a0b3a9ebf", "anchor_text": "How to explain predictive modelling to managers", "paragraph_index": 53}], "all_paragraphs": ["SolarPanelCompany decided to hire their first Data Scientist: me. I was quite excited by the challenge of having to build everything from scratch. My goal was to get a first quick win to show my value to the team.", "In the first week, a marketing manager came to your desk panicking: \u201cLook!\u201d he says by pointing at the screen of his laptop \u201cOn Google Analytics, I see our traffic went down during the last month! Can your Prediction Data Learning stuff do something to save the business?\u201d.", "\u201cAlright,\u201d I think \u201cthat\u2019s not the real question here.\u201d So I rephrase: \u201cAre you asking me to show whether we have a downwards trend or just a seasonal effect?\u201d. He stares blankly. \u201cAre you asking me to verify when we can hope that it will go back upwards? \u2014 Yes! Exactly that! I have a meeting with the Marketing Director tomorrow. I let you work on that!\u201d", "If this situation happened to you, or if you want to create the visual forecasting of your own web traffic, you are on the right page! Here is the step-by-step guide to creating a prediction of the number of visitors to your website based on your Google Analytics data and, as a bonus, make it a likable GIF for the business guys. In short, we\u2019ll create a time series model with the Prophet package.", "Needed for this step: admin right to a Google Analytics account. If you don\u2019t have any, you can use a demo Google Analytics account and simply import the data in a csv.", "This not an easy step, but Google created a lot of documentation to help you go through. I will here present the step-by-step guide to fetch the traffic. If you are interested in other metrics (such as goals, pageviews, etc.) you need to have a look in the extensive official Google\u2019s Management API documentation.", "The first package is our eternal friend Pandas. The two last package are from Google and allow you to call the Google Analytics API.", "If you don\u2019t have access to the Google API yet, you need to activate that on your side. The below videos explains all the steps to do so.", "So let\u2019s start the fun. Our first piece of code is calling the key and the right view. Note that the view number can be found in your Google Analytics account under \u201csetting>view\u201d", "In the above part, the first line doesn\u2019t change, but the 2nd and the 3rd have to be changed with your own access keys.", "Now we will use the code from Google API\u2019s documentation. If you don\u2019t understand it all, it doesn\u2019t matter: copy-pasting it will do the job if you modified properly the paragraph above.", "We can see above the mention \u2018metrics\u2019. On my side, as I wanted to do a time series, I cared only about the traffic dimension but also imported the Pageviews for later analysis.", "These block of codes are the standard ones given by Google for people willing to fetch their data.", "Ok right, now you have your data in the DataFrame dfanalytics. Congratulations! you successfully called the Google API, the first step is achieved.", "So we have the data. It took already a bit of time but now is the fun part: predicting the web traffic of SolarPanelCompany.", "To start this forecasting of the Google Analytics traffic, we need to start importing our packages. We will use Facebook\u2019s Prophet here. This great tool is super easy to use as it uses the same syntax as the package scikit. Facebook themselves use them for all their time series forecast, be it for web traffic or other.", "Let\u2019s first explore a bit and check how our data is doing. A simple plot does the job.", "We can already see a strong seasonality in the data. Indeed, this is the data about solar panels. The seasonality is thus expected: it grows smoothly from February to July, as the sun get more and more intense. Then, in August people know it\u2019s too late to enjoy the sun and the line goes down.", "Back to our code, let\u2019s check what the prophet has to say. Facebook\u2019s prophet requires you to change the name your two columns:", "Although Facebook claims that Prophet is well resistant against missing data and outliers, it\u2019s never bad to get rid of them. Especially in our case: let\u2019s say that the tracking of the website crashed for one day or two, you don\u2019t want this to influence.", "If you have some missing data, as I had, you will input them in a new DataFrame. You also need to assign a value to it. I personally used the 7 days moving average.", "Then we concat the frameworks together and put a cap and a floor. The floor is \u201c0\u201d as you know you won\u2019t have negative traffic. On the other hand, the cap is purely \u201chuman-in-the-loop\u201d work, so based on your good judgment. This cap and floor will help create the boundaries of the model.", "That will be quick as we don\u2019t have so much features; only the value of the observation itself.", "We see that there are no more outliers that the missing data, we can keep on.", "Training the model with Prophet is really easy. The team copied the mechanism used is scikit packages: .fit() and .predict()", "So first we create the model. There are numerous variations that can be added. I will explain my choices below.", "If you want to adapt your model under different criteria, I recommend have a look in the Facebook\u2019s Prophet Github.", "Until now, we have trained our model on our previous data. In order to forecast future web traffic, we first need to create future timestamps. Here I will create 60 days, so two months in the future.", "Here we go. In the next two lines, we will finally forecast our website traffic from Google Analytics.", "And Voil\u00e0! We can see the beauty of my traffic jumping off the cliff in November and December.", "Now Prophet has another great function: it can show the different components in a graph.", "There are already some interesting conclusions:", "That\u2019s already some great insights that I can give back to the marketing manager. Not only I can advise on the day where they should spend more ads budget, but I can also confirm that, yes, it\u2019s normal to see a down in our traffic. And it will recover only in February.", "Also interesting is to see the overall trends compare to the data. We can here see when the trend changes.", "Great, now we have done most of the work to predict our Google Analytics traffic. But as rigorous Data Scientist, we also want to test the model.", "The testing for time series is slightly different than for traditional models. We need to work with a rolling window: a rolling windows means using 60 days of data and assess how well it predicted against the next 30 days of data.", "In this graph above for instance, the red part is use to predicts the green part. After cross-validation, the red part will move forward in time to take the next 60 days and again, predicts the next 30 days. This is the concept of the rolling windows. There are enough articles speaking about rolling windows, so I won\u2019t extend on that.", "And here we are. We now have the RMSE plotted against the horizon in day. As we can see, the further the horizons, the bigger the error.", "Now for the sake of your own work, you can play with the hyperparameters of the model to try to push this down. As we are using this graph for marketing purposes and not for engineering ones, such an RMSE is good enough.", "So in the first part, I fetched my data and in the second part, I created the model. Now, it\u2019s time to make it nice so that the Marketing Manager and the CMO are excited about it. Human-truth: having something pleasant to look at makes it more valuable, so time to make my work valuable.", "For pure attention purposes, I had the fun to create a GIF. This kind of animation can really hook on the attention, and thus the interest from the stakeholders to my project.", "Let\u2019s start by importing the packages:", "We want it catchy, so we will directly start with a stylish element: the dark background.", "Very nice effect. Let\u2019s now plot our forecast.", "We first need to create one dataframe containing both our data and our prediction.", "Ok that was the easy part, now we will have the big block to create our GIF. To pursue here, be sure to have installed PillowWriter or Imagemagick, these are the ones which will transform your image in GIF.", "The difference between a classic fig, ax matplotlib operation is that we will need to create function to animate the diagram.", "The operation ax.clear() is super important. If you fail to put it, like I did, the animation will create a new graph on top of the previous one. Not terrible, except if.. each new graph has a new color. The final animation will be a rapidly blinking graph changing color every quarter of second. Enough to kill epileptic people.", "Note that if you are working in a notebook, you won\u2019t see the animation in your graph. You have to download the \u2018animation_video.gif\u2019 created to actually see the animation.", "Here you are, proud of your long working hours and ready to rock the stage with your stunning animation. You can now tell how does the future of your business looks like!", "After fetching the data from Google Analytics API, I could plot a time series of our future web traffic in a GIF.", "This visually appealing results helped the marketing manager and the CMO understand that yes, it was normal if the traffic would go down in winter. And yes, it would grow back in Spring, when the sun comes back and people think about solar energy investment.", "Guess which company starting to invest more in their data team.", "Your business manager doesn\u2019t understand how a prediction works and how you work? You might be interested by How to explain predictive modelling to managers", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning fanatic: During day-time, I build algorithm. And during night-time, I share them with the world."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffb066659ae8f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arthur-s-moreau.medium.com/?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": ""}, {"url": "https://arthur-s-moreau.medium.com/?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": "Arthur Moreau"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F98606cfc84a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&user=Arthur+Moreau&userId=98606cfc84a0&source=post_page-98606cfc84a0----fb066659ae8f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb066659ae8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb066659ae8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://support.google.com/analytics/answer/6367342?hl=en", "anchor_text": "demo Google Analytics account"}, {"url": "https://developers.google.com/analytics/devguides/config/mgmt/v3", "anchor_text": "Google\u2019s Management API documentation"}, {"url": "https://unsplash.com/@mwilson078?utm_source=medium&utm_medium=referral", "anchor_text": "MICHAEL WILSON"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Fourier_transform", "anchor_text": "Fourier\u2019s Order"}, {"url": "https://facebook.github.io/prophet/", "anchor_text": "Facebook\u2019s Prophet Github."}, {"url": "https://medium.com/making-sense-of-data/time-series-next-value-prediction-using-regression-over-a-rolling-window-228f0acae363", "anchor_text": "speaking about rolling windows"}, {"url": "https://medium.com/@arthur.s.moreau/how-to-explain-predictive-modeling-to-business-managers-ed9a0b3a9ebf", "anchor_text": "How to explain predictive modelling to managers"}, {"url": "https://github.com/ArthurMro/Prediction_marketing/blob/master/Prophet_GA_cs_info.ipynb", "anchor_text": "https://github.com/ArthurMro/Prediction_marketing/blob/master/Prophet_GA_cs_info.ipynb"}, {"url": "https://medium.com/tag/forecasting-models?source=post_page-----fb066659ae8f---------------forecasting_models-----------------", "anchor_text": "Forecasting Models"}, {"url": "https://medium.com/tag/google-analytics?source=post_page-----fb066659ae8f---------------google_analytics-----------------", "anchor_text": "Google Analytics"}, {"url": "https://medium.com/tag/api?source=post_page-----fb066659ae8f---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/python?source=post_page-----fb066659ae8f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----fb066659ae8f---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb066659ae8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&user=Arthur+Moreau&userId=98606cfc84a0&source=-----fb066659ae8f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb066659ae8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&user=Arthur+Moreau&userId=98606cfc84a0&source=-----fb066659ae8f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb066659ae8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffb066659ae8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fb066659ae8f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fb066659ae8f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fb066659ae8f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fb066659ae8f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fb066659ae8f--------------------------------", "anchor_text": ""}, {"url": "https://arthur-s-moreau.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arthur-s-moreau.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arthur Moreau"}, {"url": "https://arthur-s-moreau.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "62 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F98606cfc84a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&user=Arthur+Moreau&userId=98606cfc84a0&source=post_page-98606cfc84a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3e0462e1288b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f&newsletterV3=98606cfc84a0&newsletterV3Id=3e0462e1288b&user=Arthur+Moreau&userId=98606cfc84a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}