{"url": "https://towardsdatascience.com/ai-vs-covid-19-does-it-really-work-a001c8da990a", "time": 1683006576.647427, "path": "towardsdatascience.com/ai-vs-covid-19-does-it-really-work-a001c8da990a/", "webpage": {"metadata": {"title": "AI vs COVID-19. Does it really work? | by Mikhail Padalko | Towards Data Science", "h1": "AI vs COVID-19. Does it really work?", "description": "Deep Learning, COVID-19, medical imaging, Chest X-ray, neural networks, CNN, classification. Proof that COVID-19 Chest X-ray classifiers don't really work."}, "outgoing_paragraph_urls": [{"url": "http://futuremed.systems", "anchor_text": "Futuremed", "paragraph_index": 2}, {"url": "https://github.com/ieee8023/covid-chestxray-dataset", "anchor_text": "The famous GitHub repo", "paragraph_index": 5}, {"url": "https://www.sirm.org/category/senza-categoria/covid-19/", "anchor_text": "Italian database", "paragraph_index": 5}, {"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia", "anchor_text": "chest X-ray pneumonia dataset", "paragraph_index": 5}, {"url": "https://www.kaggle.com/nih-chest-xrays/data", "anchor_text": "NIH ChestXRay-14 dataset", "paragraph_index": 5}, {"url": "https://github.com/futuremed-ru/covid/tree/master/lungs-covid-19-classifier", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://github.com/futuremed-ru/covid", "anchor_text": "project\u2019s GitHub repo", "paragraph_index": 38}], "all_paragraphs": ["Today everyone knows about the pandemic. Professionals do their best to help deal with it: preventing rapid spread of infection, developing diagnosis methods, drug discovery, patient care strategies, vaccine development, mortality predictions, modeling implications for the global economy, and many many others.", "Data scientists are no exception. There\u2019s no need to convince anyone that AI works great for medical applications. You could have seen publications (even scientific papers) claiming that some model has been developed that can predict whether a patient has COVID-19 or not. Some publications claim 90+% prediction accuracy when applying deep learning to chest X-ray images which raise a lot of questions.", "And that\u2019s why: at Futuremed we\u2019re working with medical data in tight collaboration with doctors. And radiologists say that there\u2019s little to none COVID-19 specific patterns in chest X-rays.There are times when AI is capable of finding features that no human doctor can.", "Maybe that\u2019s the case with COVID-19 on chest X-rays either? Let\u2019s find out.", "This is not a tutorial on \u201chow to train a neural network\u201d, but I\u2019ll add all the necessary information to reproduce described work.", "For the task of classifying COVID-19 on Chest X-Ray images, our dataset should have at least two classes: \u201cCOVID-19\u201d and \u201cOther\u201d.We are going to use four sources of data for training:1. The famous GitHub repo with COVID-19 images.2. Images from the Italian database with COVID-19 cases.3. Kaggle chest X-ray pneumonia dataset.4. NIH ChestXRay-14 dataset.", "To get as many COVID-19 images as possible let\u2019s combine the first two sources. Most of the images from the Italian database have already been included in the GitHub repo. But some of them weren\u2019t, so we just added them manually. That way we get all available at the moment (7 April 2020) images with COVID-19, and a couple of images without it (with other pathology or \u201cno finding\u201d, they will be used as \u201cOther\u201d class samples). One thing to note here: each patient can have multiple images in that part of the dataset, so n_patients \u2264 n_images.", "To get more images for the \u201cOther\u201d class the last two sources are used.", "Next, let\u2019s combine all the data. Here are resulting dataset stats:", "All the images were resized to 564x564. Mean and standard deviation were calculated for the images in the dataset.", "Let\u2019s use DenseNet-121 as a backbone for the model (it became almost a default choice for processing 2D medical images). And since our COVID-19 dataset is too small to train a model from scratch, let\u2019s train our model on ChestXRay-14 first, and then use a pre-trained model for weight initialization.When working with medical images it\u2019s crucial to make sure that different images of one patient won\u2019t get into training/validation/test sets. To address this issue and due to the scarcity of COVID-19 images, we decided to use 10-fold cross-validation over patients for training.The following data augmentations were performed for training:", "For evaluation, we used only center crops (no TTA).Calculated mean and std were used to standardize images after augmentation.", "The network was modified to produce two logits for the classes (\u201cCOVID-19\u201d and \u201cOther\u201d). The data was unbalanced, so we choose weighted binary cross-entropy as the loss function. Soft-labeling was also used: one-hot encoded labels smoothing by 0.05. As we cross-validate over patients, the number of images for two classes changes from one fold to another, so we calculate per class weights for every fold on the fly.", "The network was trained using Adam optimizer with AMSGrad. Other hyperparameters and the code can be found in the project repo here. Best on the validation set by ROC AUC model was saved for each fold.", "Resulting models formed an ensemble that is used for further analysis. Mean by all the validation folds metrics:ROC AUC: 0.99387,Accuracy: 0.95046.", "For testing, we used new frontal (PA or AP views) X-ray images from the GitHub repo (the ones that were added from 7 to 22 April 2020).And required to balance (\u201cCOVID-19\u201d and \u201cOther\u201d) classes number of images were added from unused in training patient\u2019s images randomly picked from ChestXRay-14 (as they were picked randomly, statistically most of them were with \u201cno finding\u201d label).All these images with corresponding labels form a test set.", "Per label stats on the test set:", "Not bad! It seems like we\u2019ve got a solid Chest X-ray COVID-19 classifier.", "Results may look convincing for some readers, but the others might have a \u201cthere\u2019s something wrong here\u201d feeling.", "Let\u2019s use more data for evaluating our classifier\u2019s performance.", "First, let\u2019s look at classifier\u2019s performance stats on the rest (unused in training) of ChestXRay-14 dataset:", "Since in that dataset there are no COVID-19 cases, then the only thing we can claim is that our classifier has pretty good specificity (0.99235) on this dataset.Also, you can see that there\u2019s no peak of false positives on such classes as \u201cPneumonia\u201d and \u201cInfiltration\u201d \u2014 the ones which might have similar to the COVID-19 X-ray picture. Does it mean that COVID-19 can be distinguished from other similar looking pathologies by an AI algorithm?", "Second, let\u2019s have a look at the classifier\u2019s performance on unseen proprietary data. The used dataset has only \u201cnormal\u201d and \u201cabnormal\u201d labels. There are no COVID-19 positive patient images in this dataset.", "Specificity drops down significantly (to 0.69333). The classifier doesn\u2019t seem to be so good now. What happened?", "Third, let\u2019s look at the detailed results on new images (7\u201322 Apr 2020) from GitHub repo with COVID-19 cases.", "Summarizing all the statistics above, we get:", "After recalculating the metrics we can already see something:", "It\u2019s not \u201cnot bad\u201d anymore. We can see the truth now: our classifier is rubbish. Let\u2019s think this through.", "As it was mentioned, resulting precision shows that the classifier isn\u2019t able to distinguish COVID-19 specific patterns in the images (remember that radiologists say, there\u2019s not much specific to COVID-19 patterns in chest X-ray images). But what have the classifier learned then, and why does it perform well on GitHub repo and ChestXRay-14 data?", "The classifier learned how images from datasets picked for \u201cOther\u201d class look like. And it also learned that any pathological pattern means it\u2019s \u201cCOVID-19\u201d, given that the image doesn\u2019t look like it\u2019s from \u201cOther\u201d datasets.", "So, generally, the classifier learned to distinguish something pathological and not looking like \u201cOther\u201d images.", "That\u2019s why it marked almost every third image as \u201cCOVID-19\u201d on our proprietary dataset (containing images that don\u2019t look similar to \u201cOther\u201d images).The classifier knows some differences between normal and abnormal images though. It marked as \u201cCOVID-19\u201d every 3rd abnormal and every 5th normal image. At least not all of our effort was in vain :)", "Despite strong data augmentation while training, careful patient-wise k-fold cross-validation, and weighted loss function, the classifier failed to perform well on real-world data.", "We encourage anyone interested to reproduce our experiment.Actually, you don\u2019t need any proprietary data, you may just exclude one dataset from \u201cOther\u201d class, and use it as \u201cunseen\u201d.", "I\u2019d like to point out the two main takeaways:", "Any neural network will always try to find the easiest way to solve the task.", "Look closely at the data on which your model performance is validated. Not just bare numbers.", "At this point, I\u2019m not stating that it\u2019s absolutely impossible to find any COVID-19 specific patterns on Chest X-rays at all. There\u2019s a chance that something specific exists indeed, which AI would be able to capture. But it\u2019s definitely not possible when:", "All the source code is available at our project\u2019s GitHub repo. Feel free to contact me if you have any questions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa001c8da990a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a001c8da990a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a001c8da990a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zoidbeer?source=post_page-----a001c8da990a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zoidbeer?source=post_page-----a001c8da990a--------------------------------", "anchor_text": "Mikhail Padalko"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc12c2b0d2f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&user=Mikhail+Padalko&userId=c12c2b0d2f7&source=post_page-c12c2b0d2f7----a001c8da990a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa001c8da990a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa001c8da990a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://phil.cdc.gov/Details.aspx?pid=23311", "anchor_text": "PHIL"}, {"url": "http://futuremed.systems", "anchor_text": "Futuremed"}, {"url": "https://github.com/ieee8023/covid-chestxray-dataset", "anchor_text": "The famous GitHub repo"}, {"url": "https://www.sirm.org/category/senza-categoria/covid-19/", "anchor_text": "Italian database"}, {"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia", "anchor_text": "chest X-ray pneumonia dataset"}, {"url": "https://www.kaggle.com/nih-chest-xrays/data", "anchor_text": "NIH ChestXRay-14 dataset"}, {"url": "https://github.com/futuremed-ru/covid/tree/master/lungs-covid-19-classifier", "anchor_text": "here"}, {"url": "https://github.com/futuremed-ru/covid", "anchor_text": "project\u2019s GitHub repo"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a001c8da990a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/covid-19?source=post_page-----a001c8da990a---------------covid_19-----------------", "anchor_text": "Covid-19"}, {"url": "https://medium.com/tag/medical-imaging?source=post_page-----a001c8da990a---------------medical_imaging-----------------", "anchor_text": "Medical Imaging"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----a001c8da990a---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/classification-models?source=post_page-----a001c8da990a---------------classification_models-----------------", "anchor_text": "Classification Models"}, {"url": "https://creativecommons.org/licenses/by-nc-sa/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa001c8da990a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&user=Mikhail+Padalko&userId=c12c2b0d2f7&source=-----a001c8da990a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa001c8da990a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&user=Mikhail+Padalko&userId=c12c2b0d2f7&source=-----a001c8da990a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa001c8da990a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a001c8da990a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa001c8da990a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a001c8da990a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a001c8da990a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a001c8da990a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a001c8da990a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a001c8da990a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a001c8da990a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a001c8da990a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a001c8da990a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a001c8da990a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zoidbeer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zoidbeer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mikhail Padalko"}, {"url": "https://medium.com/@zoidbeer/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc12c2b0d2f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&user=Mikhail+Padalko&userId=c12c2b0d2f7&source=post_page-c12c2b0d2f7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc12c2b0d2f7%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-vs-covid-19-does-it-really-work-a001c8da990a&user=Mikhail+Padalko&userId=c12c2b0d2f7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}