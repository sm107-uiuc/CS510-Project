{"url": "https://towardsdatascience.com/deep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8", "time": 1683014959.725572, "path": "towardsdatascience.com/deep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8/", "webpage": {"metadata": {"title": "Deep Learning Model Implementation: Embeddings for Categorical Variables | by Katey Durham | Towards Data Science", "h1": "Deep Learning Model Implementation: Embeddings for Categorical Variables", "description": "For many complex prediction problems, Deep Learning (DL) methodologies such as CNNs, NLP, and fully-connected networks offer the highest levels of performance. This typically comes at the cost of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/machine-learning-model-implementation-assessing-variable-importance-across-models-30c282d143ec?source=friends_link&sk=7969f326ae24f29d7a5092f4db122fde", "anchor_text": "Part 1", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1604.06737", "anchor_text": "Guo and Berkhahn2016", "paragraph_index": 1}, {"url": "https://www.zillow.com/research/data/", "anchor_text": "Zillow Research", "paragraph_index": 2}, {"url": "https://www.fast.ai", "anchor_text": "fastai", "paragraph_index": 3}, {"url": "http://dahliaanalytics.com/htmls/re_zillow.html", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://www2.census.gov/geo/pdfs/maps-data/maps/reference/us_regdiv.pdf", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://www.northamerican.com/ifrm-mig-map", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://vivapredict.com", "anchor_text": "https://vivapredict.com", "paragraph_index": 12}, {"url": "https://vivajams.com", "anchor_text": "https://vivajams.com", "paragraph_index": 12}, {"url": "https://vivamash.com", "anchor_text": "https://vivamash.com", "paragraph_index": 12}], "all_paragraphs": ["For many complex prediction problems, Deep Learning (DL) methodologies such as CNNs, NLP, and fully-connected networks offer the highest levels of performance. This typically comes at the cost of understanding the role of the explanatory features in prediction outcomes. While Machine Learning (ML) methodologies based on statistical methods offer a variety of techniques including variable selection, relative importance and in some cases model coefficients to understand the role of predictors (as discussed in Part 1 of this series), the potential to achieve similar insights on the DL side has been less explored. And, due to the complexities involved, this will likely remain true. However, there are ways to gain some clues as to what is happening in the proverbial black box. For example, in CNN analysis of images, class activated maps are a way to identify which areas of a picture are most active or influential in its classification.", "For time-series or other structured data, embeddings offer an alternative to the standard one-hot encoding or \u2018dummy\u2019 variable representation for categorical features that can lead to insights about their effect patterns on the dependent variable (Guo and Berkhahn2016). Embedding matrices are estimated along with the model fit, and their dimension is typically chosen to be somewhat less than the cardinality of the variable, e.g. an embedding matrix representing days of the week could have the dimensions 7 x 4, allowing each day to be represented by a 4-dimensional embedding vector. This allows patterns and similarities or differences among days to be captured along 4 dimensions.", "I wanted to see if I could estimate embeddings from a DL model, and whether the resulting patterns would be interpretable. When the US Bureau of Economic Analysis (BEA) began to release GDP data by US county recently, I became interested in what other types of data I could find at this level of geographic granularity. I love all things Real Estate and at the time was not an active agent with access to MLS information. Fortunately there was Zillow Research. Although what information Zillow provides at this site can and does change over time, last year they provided access to data on Adjusted Sale Price for approximately 1260 US counties for the period from Jan 1, 2010 to Jan 1, 2018. Other Real Estate data available by county included sale counts, percent price reduction, the Zillow Home Value Index (ZHVI), days on Zillow, monthly listings and the percent of sales of previous foreclosures. All of these features were available at a monthly frequency. I gathered other data by US county including GDP (2015\u20132018, BEA), population patterns, unemployment and poverty, household income, County Business Patterns and US Census Regions and Divisions (2010\u20132018, US Census Bureau). These data were recorded annually. I also obtained the monthly prime interest rate from Federal Reserve Economic Data (2010\u20132018, FRED).", "My objective was to predict the year over year monthly adjusted sale price by US county using the fastai library. I fit a DL model with 2 fully connected layers, where the categorical variables were represented using embeddings. The final model achieved a validation root mean square percent error of 8% in predicting the adjusted sale price for the following year. You can see the code for that fit and how to extract the embeddings here. Once extracted, the embedding matrices were merged back with the original data to compute principal components (PCs). Graphs of the first two PCs for the geographical variables are below, from the most to least granular: State, Division, and Region. Will these lead to anything we can interpret? Let\u2019s find out!", "The layout along PC1 for state embeddings displays some clustering (e.g. CT and RI, NY and NJ) and outliers (e.g. CA, HI) that we might expect, but otherwise appears fairly complex. Let\u2019s move to a higher level grouping using the US Census Divisions and Regions (You can see these here).", "Here things get interesting! Along PC1, things are fairly stacked with the exception of the South Atlantic Division. Along PC2, we have what seem initially like some incongruous groupings, at least thinking in geographic terms. The East North/South Central along with the South Atlantic are grouping with the Mountain Division, and the New England/Mid Atlantic Divisions appear with their coastal opposite, Pacific. What could these areas have in common?", "Thinking in terms of supply and demand and their effect on price, let\u2019s take a look at migration patterns in the US. While the Census Bureau also has this type of information, an interesting source I found (from the people who should know!) is North American Moving Services. You can check out their interactive migration map for the last decade here. In the month before a US election I kinda wish they had chosen different colors than red and blue to distinguish states as either predominantly Outbound or Inbound (!) but it\u2019s a fascinating map. At their site, you can slide the bar to see data for each year from 2011\u20132019, and hover over each state to see its Outbound vs. Inbound statistics, along with property tax percentage.", "Interestingly, we see correspondence with the pattern described by the embeddings above, with the US Census Divisions East South Central, South Atlantic and Mountain having more inbound migration, and the New England (at least CT), Mid Atlantic and Pacific Divisions experiencing more Outbound migration. An exception to the pattern is the East North Central Division, which appears to have more Outbound migration though grouping with the other Inbound Divisions.", "There is still the least granular US Census grouping to consider: Region.", "The four US Census Regions collapse the Census Divisions as displayed above. In terms of the migration patterns we\u2019ve examined, PC1 might be ordering the Regions in terms of migration patterns and their effect on housing prices. The South region of the US has certainly seen some of the largest housing price increases in the last decade. What is really interesting is PC2! While the other three regions basically collapse together on this axis, the West polarizes itself from the rest. While the South, Northeast and Midwest regions have been fairly internally consistent with respect to their Inbound or Outbound migration patterns over the past decade, the West Census Region merges the Pacific and Mountain Divisions with their different migration dynamics.", "With a little extra work, embeddings for categorical variables can be extracted from a DL model fit, and may provide some insight into the ways that the predictor variables are influencing our ability to predict the outcome. Embeddings can also be extracted and used as covariates for other types of modeling, such as ML strategies, and can provide reduced cardinality over a traditional dummy or one hot encoding parameterization.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Predictive Analyst who uses models and intuition https://vivapredict.com ~ NFT jams https://vivajams.com ~ Mashing it all up at https://vivamash.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f12df30fcc8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vivamashup.medium.com/?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": ""}, {"url": "https://vivamashup.medium.com/?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": "Katey Durham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F218a7a5db639&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&user=Katey+Durham&userId=218a7a5db639&source=post_page-218a7a5db639----1f12df30fcc8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f12df30fcc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f12df30fcc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/machine-learning-model-implementation-assessing-variable-importance-across-models-30c282d143ec?source=friends_link&sk=7969f326ae24f29d7a5092f4db122fde", "anchor_text": "Part 1"}, {"url": "https://arxiv.org/abs/1604.06737", "anchor_text": "Guo and Berkhahn2016"}, {"url": "https://www.zillow.com/research/data/", "anchor_text": "Zillow Research"}, {"url": "https://www.fast.ai", "anchor_text": "fastai"}, {"url": "http://dahliaanalytics.com/htmls/re_zillow.html", "anchor_text": "here"}, {"url": "https://www2.census.gov/geo/pdfs/maps-data/maps/reference/us_regdiv.pdf", "anchor_text": "here"}, {"url": "https://www.northamerican.com/ifrm-mig-map", "anchor_text": "here"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----1f12df30fcc8---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/embedding?source=post_page-----1f12df30fcc8---------------embedding-----------------", "anchor_text": "Embedding"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1f12df30fcc8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/real-estate?source=post_page-----1f12df30fcc8---------------real_estate-----------------", "anchor_text": "Real Estate"}, {"url": "https://medium.com/tag/migration?source=post_page-----1f12df30fcc8---------------migration-----------------", "anchor_text": "Migration"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f12df30fcc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&user=Katey+Durham&userId=218a7a5db639&source=-----1f12df30fcc8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f12df30fcc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&user=Katey+Durham&userId=218a7a5db639&source=-----1f12df30fcc8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f12df30fcc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f12df30fcc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f12df30fcc8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f12df30fcc8--------------------------------", "anchor_text": ""}, {"url": "https://vivamashup.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vivamashup.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Katey Durham"}, {"url": "https://vivamashup.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "135 Followers"}, {"url": "https://vivapredict.com", "anchor_text": "https://vivapredict.com"}, {"url": "https://vivajams.com", "anchor_text": "https://vivajams.com"}, {"url": "https://vivamash.com", "anchor_text": "https://vivamash.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F218a7a5db639&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&user=Katey+Durham&userId=218a7a5db639&source=post_page-218a7a5db639--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7eed018d11f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-model-implementation-embeddings-for-categorical-variables-1f12df30fcc8&newsletterV3=218a7a5db639&newsletterV3Id=7eed018d11f8&user=Katey+Durham&userId=218a7a5db639&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}