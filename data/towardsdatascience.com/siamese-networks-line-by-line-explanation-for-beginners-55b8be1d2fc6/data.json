{"url": "https://towardsdatascience.com/siamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6", "time": 1683009662.0156531, "path": "towardsdatascience.com/siamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6/", "webpage": {"metadata": {"title": "Siamese Networks. Line by line explanation for beginners | by Krishna Prasad | Towards Data Science", "h1": "Siamese Networks", "description": "Siamese Networks are a class of neural networks capable of one-shot learning. This post is aimed at deep learning beginners, who are comfortable with python and the basics of convolutional neural\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "this great article", "paragraph_index": 4}, {"url": "https://www.youtube.com/watch?v=6jfw8MuKwpI", "anchor_text": "link", "paragraph_index": 7}, {"url": "https://www.kaggle.com/moltean/fruits", "anchor_text": "Fruits 360", "paragraph_index": 8}], "all_paragraphs": ["Siamese Networks are a class of neural networks capable of one-shot learning. This post is aimed at deep learning beginners, who are comfortable with python and the basics of convolutional neural networks. We will go through line by line explanation of how siamese networks are implemented using Keras in Python. When you are going through the code, in case you feel some things could have been explained or done in a better way, feel free to comment.", "Let us assume we have a company of 1000 employees. We decide to implement a facial recognition system to record the attendance of your employees. If we were to use traditional neural networks, we will have to face two main problems. First one would be the dataset. It would be nearly impossible to assemble a huge collection of dataset from each of our employees, we would end up with a maximum of 5 photos of each of our employees. But a traditional CNN(Convolutional Neural Networks) won\u2019t be able to learn features with such small collection. We\u2019ll also end up with 1000 output classes. Let\u2019s consider that somehow we got a huge dataset from each of our employees and we trained a really good CNN model. What happens when a new employee joins our organization? How can we include the person into our facial recognition system? All these shortcomings can be overcome using siamese networks. In this post, we will experiment with one-shot learning using Siamese networks that concentrate on the difference rather than feature matching.", "Rather than using huge data for each of the class, we calculate the similarity scores between images of different classes. The input to this network will be two images either belonging to the same class or different class. The output will be a floating-point number ranging between 0 and 1, wherein 1 indicates that that the two images are of the same class and 0 indicating they are from different ones. Let me start by explaining how it is different from image classification using CNN Architectures.", "In case of a CNN model, you have a series of convolutional and pooling layers followed by some dense layers and an output layer probably with a softmax function. The convolutional layers here are responsible for feature extraction from the image, whereas the softmax layer is responsible for providing a range of probability for every class. We then decide the class of the image with the neuron that has the highest probability value.", "Take a look at this great article for more information on how CNN works.", "With siamese networks, it has a similar constitution of convolutional and pooling layers except we don\u2019t have a softmax layer. So, we stop with the dense layers. As explained before since the network has two images as inputs, we will end up with two dense layers. Now we calculate the difference of these two layers and output the result to a single neuron with sigmoid activation function(0 to 1). Thus the training data to this network must be structured in such a way that there is a list consisting of two images and a variable either 0 or 1.", "Note: There is only one network and both the images are passed through the same network. It\u2019s just that there are two inputs. Thus, both the inputs will be passing through the same weight matrix from the convolution and dense layers.", "If you are still not clear of how this works, refer to this link.", "For this post, I have used Fruits 360 dataset from Kaggle. However, feel free to experiment with other datasets. The code is hosted in Kaggle. In case you have some doubts with the code, feel free to fork the below notebook and experiment yourself.", "Let us start by importing the libraries that we are using. As mentioned before this code uses Keras for building the model and NumPy, pillow for data preprocessing.", "Note: Don\u2019t import Keras as \u201cfrom tensorflow import Keras\u201d", "This Section is for generating batch files for training. The Batch files should have an X and Y. In the usual case of image classification, If the batch size is 64 and the image size is (100, 100, 3) the size of X would be a list of size 64 and each element in the list would be of size (100, 100, 3).", "In our case since we have 2 inputs, there would be a list (let\u2019s say \u2018A\u2019) of size 64 and each element in \u2018A\u2019 would have a list (let\u2019s say \u2018B\u2019) of length 2 and each element in \u2018B\u2019 would be of size (100, 100, 3). For training, we\u2019ll generate a batch such that for half the input pairs B[0] and B[1] are of the same category. Assign the value 0 to these image pairs. For the other half of the input pairs, B[0] and B[1] are of different category. Assign the value 1 to these image pairs.", "This is a process of validating one-shot learning, we pick \u2019n\u2019 input pairs such that only one input pair belong to the same category and other all are from different ones. If we consider a 9-way one-shot validation, and each input to the network requires two images, x[0] remains constant for all 9 pairs, x[1] belongs to the same category of x[0] only for 1 in 9 pairs, and different for everything else. If all the 9 pairs are given to the model, it is expected that the pair which belong to the same category will have the lowest value out of the 9 pairs. In such a case, we count it as a successful prediction.", "The input parameter n_val refers to the number of validation steps. n_way refers to the number of ways for each validation step. Remember that x[0] mentioned above remains constant for every validation step.", "(For a deeper understanding, please fork the notebook from Kaggle and try debugging each line from this function)", "Training the model has 4 hyperparameters (epochs, batch_size, n_val, n_way)", "The above code was trained for 5000 epochs in Kaggle. Using a GPU would significantly reduce the training time.", "We were able to achieve an accuracy of 90% on the validation set. To improve accuracy even higher, we can try importing weights from a pretrained model such as VGG-16, ResNet-50 and so on.", "Let me know if you are facing any issues. I\u2019ll try my best to respond. As this is my first blog post ever, let me know if it was helpful for you on your projects or if I should change the way of explaining things.", "I\u2019m looking forward to creating more posts on computer vision. Let me know the topics you wish to be covered. Happy hacking!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F55b8be1d2fc6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@krishnaprasad_54871?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@krishnaprasad_54871?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "Krishna Prasad"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1cc36ca07742&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&user=Krishna+Prasad&userId=1cc36ca07742&source=post_page-1cc36ca07742----55b8be1d2fc6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55b8be1d2fc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55b8be1d2fc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/geralt-9301/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4550606", "anchor_text": "Gerd Altmann"}, {"url": "https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4550606", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "this great article"}, {"url": "https://medium.com/u/631ee5e6343e?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "Sumit Saha"}, {"url": "https://www.youtube.com/watch?v=6jfw8MuKwpI", "anchor_text": "link"}, {"url": "https://www.kaggle.com/moltean/fruits", "anchor_text": "Fruits 360"}, {"url": "https://www.kaggle.com/krishnaprasad96/siamese-network", "anchor_text": "https://www.kaggle.com/krishnaprasad96/siamese-network"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----55b8be1d2fc6---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/data-science?source=post_page-----55b8be1d2fc6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----55b8be1d2fc6---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----55b8be1d2fc6---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F55b8be1d2fc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&user=Krishna+Prasad&userId=1cc36ca07742&source=-----55b8be1d2fc6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F55b8be1d2fc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&user=Krishna+Prasad&userId=1cc36ca07742&source=-----55b8be1d2fc6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55b8be1d2fc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F55b8be1d2fc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----55b8be1d2fc6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----55b8be1d2fc6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@krishnaprasad_54871?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@krishnaprasad_54871?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Krishna Prasad"}, {"url": "https://medium.com/@krishnaprasad_54871/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "26 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1cc36ca07742&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&user=Krishna+Prasad&userId=1cc36ca07742&source=post_page-1cc36ca07742--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F792bc236b306&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsiamese-networks-line-by-line-explanation-for-beginners-55b8be1d2fc6&newsletterV3=1cc36ca07742&newsletterV3Id=792bc236b306&user=Krishna+Prasad&userId=1cc36ca07742&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}