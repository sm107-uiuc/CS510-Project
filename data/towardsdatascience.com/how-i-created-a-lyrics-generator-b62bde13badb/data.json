{"url": "https://towardsdatascience.com/how-i-created-a-lyrics-generator-b62bde13badb", "time": 1683004673.820431, "path": "towardsdatascience.com/how-i-created-a-lyrics-generator-b62bde13badb/", "webpage": {"metadata": {"title": "How I Created A Lyrics Generator. Using AI To Write A Hit Song | by Eric Borgos | Towards Data Science", "h1": "How I Created A Lyrics Generator", "description": "There are many lyrics generators online, and while they are fun to fool around with, the songs they create just don\u2019t make much sense. As a real human songwriter (I have written over 100 songs), I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://boredhumans.com/lyrics_generator.php", "anchor_text": "https://boredhumans.com/lyrics_generator.php.", "paragraph_index": 0}, {"url": "https://github.com/minimaxir/gpt-2-simple", "anchor_text": "GPT-2 Simple", "paragraph_index": 2}, {"url": "https://www.kaggle.com/tgdivy/poetry-foundation-poems", "anchor_text": "13,000 poems", "paragraph_index": 2}, {"url": "https://magenta.tensorflow.org", "anchor_text": "Magenta", "paragraph_index": 9}], "all_paragraphs": ["There are many lyrics generators online, and while they are fun to fool around with, the songs they create just don\u2019t make much sense. As a real human songwriter (I have written over 100 songs), I figured there must be a better way to do it, so I decided to build my own using the latest advances in machine learning. There is no good method to teach an AI the concept of a \u201csong,\u201d but it can be trained using NLP to imitate whatever text you show it. I fed it lots of songs to learn from, and eventually, it was able to output lines that sounded coherent. Overall the project involved around 50 hours of programming, but the end result was worth it: https://boredhumans.com/lyrics_generator.php.", "Here are the details on how I did it:", "I started by fine-tuning GPT-2, which is an open-source language model trained on over 8 million web pages to predict the next word in the text. To do this, I used GPT-2 Simple (it has a link where anyone can run it on a free GPU via Google Colab) with a database of 13,000 poems. I was originally going to train it on a database of 400,000 song lyrics that I downloaded, but many of those had swears, sexual content, drug references, and other stuff not appropriate for kids, and I didn\u2019t want my model to learn all that. Plus I wanted my version to sound \u201csmarter\u201d than the other sites, so using poetry instead seemed like a better plan.", "Once I had it working well to create poetry, I then fine-tuned it even more on 7,000 song lyrics from artists I consider poetic (such as Bob Dylan, U2, Taylor Swift, and several dozen more). But the result of that was still poetry, so I added a bunch of non-ML post-processing steps to make it look more like song lyrics. After GPT-2 produces the raw content, I use the first 6 lines and call that the \u201cVerse 1\u201d, then the next 4 lines are the \u201cChorus,\u201d then the next 6 lines as \u201cVerse 2\u201d, and then to make the chorus sound like a chorus, I repeat the first chorus again. I also make all sorts of other small adjustments like filtering out r-rated content, deleting the last line of the raw lyrics because most of the time it is unfinished (cut off), and getting a whole new set of lyrics if the song becomes too short after all the deletions. Sometimes it has phrases like [Repeat Chorus] or (instrumental break), which are no good, so I automatically delete those lines also. All of these tasks were accomplished with simple PHP programming such as using str_replace to get rid of various characters I didn\u2019t want to show up:", "and this for deleting lines that are repeated too much:", "Figuring out the best way to give each song a title turned out to be much harder than I anticipated. It sometimes is hard for human songwriters to do this, and I am not sure an ML model could be trained to do a good job for it, so instead, I choose to create some hard-coded rules to pick the title. I mainly use whatever line is repeated the most , but with limits that it can\u2019t be too short or too long.", "One reason all of this became complicated is that it is a website, not just a plain Python program. Simply figuring out the best way to deploy the Python ML model to the web was an ordeal because it was slightly too big for Google Cloud Run or AWS Lambda, and running it on a regular AWS server would be too expensive. I ended up using AWS LightSail, which is like a regular web host (such as DigitalOcean) but still has many of the advantages of regular AWS.", "Also, once the model was deployed, more work was needed to actually make it function as a website, using PHP and JavaScript/Ajax. And I had endless CORS cross-domain issues getting my PHP page to work with the REST API feed of the ML model (which uses Starlette/uvicorn [similar to Flask]). It involved fixes like adding lines such as these to the Python API part:", "and referencing my server\u2019s SSL certificate like:", "My plan is to eventually add AI-generated music and AI-generated vocals to the lyrics. I have already experimented with state-of-the-art audio programs such as Google\u2019s Magenta , and while it does output nice music, it is nowhere near the level of what is needed to create a real song. And adding vocals is even harder because, in addition to trying to make it sound like a singer instead of just a generic computer voice, the words have to be timed to go with the melody/music. Ideally, all of this can be automatically generated to go with the AI lyrics, and I then will have a complete song from start to finish, so that is what I will be working on next.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am the owner of Impulse Communications, Inc. which is a 25 year-old Internet company specializing in artificial intelligence and website development."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb62bde13badb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b62bde13badb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b62bde13badb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@borgos?source=post_page-----b62bde13badb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@borgos?source=post_page-----b62bde13badb--------------------------------", "anchor_text": "Eric Borgos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F35eadb4290ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&user=Eric+Borgos&userId=35eadb4290ad&source=post_page-35eadb4290ad----b62bde13badb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb62bde13badb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb62bde13badb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/ib306660-546673/", "anchor_text": "IB306660"}, {"url": "https://pixabay.com/photos/lyrics-art-sculpture-thinking-1099741/", "anchor_text": "pixabay.com"}, {"url": "https://boredhumans.com/lyrics_generator.php", "anchor_text": "https://boredhumans.com/lyrics_generator.php."}, {"url": "https://github.com/minimaxir/gpt-2-simple", "anchor_text": "GPT-2 Simple"}, {"url": "https://www.kaggle.com/tgdivy/poetry-foundation-poems", "anchor_text": "13,000 poems"}, {"url": "https://magenta.tensorflow.org", "anchor_text": "Magenta"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b62bde13badb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----b62bde13badb---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/ai?source=post_page-----b62bde13badb---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/music?source=post_page-----b62bde13badb---------------music-----------------", "anchor_text": "Music"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b62bde13badb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb62bde13badb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&user=Eric+Borgos&userId=35eadb4290ad&source=-----b62bde13badb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb62bde13badb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&user=Eric+Borgos&userId=35eadb4290ad&source=-----b62bde13badb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb62bde13badb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b62bde13badb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb62bde13badb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b62bde13badb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b62bde13badb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b62bde13badb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b62bde13badb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b62bde13badb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b62bde13badb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b62bde13badb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b62bde13badb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b62bde13badb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@borgos?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@borgos?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Eric Borgos"}, {"url": "https://medium.com/@borgos/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "105 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F35eadb4290ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&user=Eric+Borgos&userId=35eadb4290ad&source=post_page-35eadb4290ad--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1174c7c33f1e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-a-lyrics-generator-b62bde13badb&newsletterV3=35eadb4290ad&newsletterV3Id=1174c7c33f1e&user=Eric+Borgos&userId=35eadb4290ad&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}