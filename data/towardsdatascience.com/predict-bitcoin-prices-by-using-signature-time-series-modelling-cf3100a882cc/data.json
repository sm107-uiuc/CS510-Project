{"url": "https://towardsdatascience.com/predict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc", "time": 1682995737.4730802, "path": "towardsdatascience.com/predict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc/", "webpage": {"metadata": {"title": "Predict Bitcoin prices by using Signature time series modelling | by Rattana Pukdee | Towards Data Science", "h1": "Predict Bitcoin prices by using Signature time series modelling", "description": "First, I would like to give a short introduction to the Signature method. According to Wikipedia, a rough path is a generalization of the notion of smooth path allowing to construct a robust solution\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1603.03788", "anchor_text": "A Primer on the Signature Method in Machine Learning.", "paragraph_index": 1}, {"url": "https://www.cryptodatadownload.com/", "anchor_text": "https://www.cryptodatadownload.com/", "paragraph_index": 11}, {"url": "https://arxiv.org/abs/1603.03788", "anchor_text": "A Primer on the Signature Method in Machine Learning.", "paragraph_index": 21}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 47}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 47}], "all_paragraphs": ["First, I would like to give a short introduction to the Signature method. According to Wikipedia, a rough path is a generalization of the notion of smooth path allowing to construct a robust solution theory for controlled differential equations driven by classically irregular signals, for example, a Wiener process. The theory was developed in the 1990s by Terry Lyons. The aim of the mathematics is to describe a smooth but potentially highly oscillatory and multidimensional path X effectively.", "The Signature is a homomorphism from the monoid of paths (under concatenation) into the group-like elements of the free tensor algebra. It provides a graduated summary of path X. Here is a formal maths definition of the Signature transformation from A Primer on the Signature Method in Machine Learning.", "Define the Signature of a path as follows", "To make a long story short, Signature is a transformation of a path into a sequence that encapsulates summaries of the path.", "These graduated summaries or features of a path are at the heart of the definition of a rough path; locally they remove the need to look at the fine structure of the path. Taylor\u2019s theorem explains how any smooth function can, locally, be expressed as a linear combination of certain special functions (monomials based at that point).", "Coordinate iterated integrals (terms of the signature) form a more subtle algebra of features that can describe a stream or path in an analogous way; they allow a definition of rough path and form a natural linear \u201cbasis\u201d for continuous functions on paths.", "There are many advantages of using Signature as a basis for functions on paths. First, Signature features are more robust for a rough path. Second, although the signature of a path is an infinitely long sequence, we can use a truncated version of it as a basis to approximate a continuous function without losing much information.", "Moreover, Signature features are scalable. To give an illustration, if we want to model a future crude oil price as a function of historical crude oil prices.", "If you want more information about maths behind the Signature, I recommend you to read", "Here are examples of an application of the Signature features", "Recently, we have seen a remarkable rise of cryptocurrency trading where the most popular currency, Bitcoin, reached its peak at almost $20,000 USD/BTC at the end of 2017 while there was a big crash in November 2018 to around $3000 USD/BTC. The digital money is quite new in the financial market and we would say that its behaviour is almost unpredictable. Knowing that signature can capture meaningful properties of a path and can be used as a linear basis to approximate a continuous function of the path, the author wants to explore how would this promising method perform when we use it to predict the Bitcoin price. We will compare the result with XGBoost algorithm which is a current state-of-the-art machine learning algorithm.", "We will use daily Bitcoin to USD prices data from https://www.cryptodatadownload.com/. We will use data from Gemini which is one of the biggest cryptocurrency trading platforms in the US. Our goal is to use a window of size 30 days to predict the mean price of the next 10 days. For the signature method, we will use a truncated signature of the 30-day prices as features + Lasso linear regression while for the XGBoost, we will use the 30-day prices as features.", "We explore the dataset using pandas.", "We need to remove the first row of the dataframe, reverse the dataframe and use Date as an index.", "So now we are ready to work with the dataframe. Let\u2019s visualise the price by plotting the Close price first.", "There are a few interesting periods that we may be interested in, a boom on Oct 2017 along with crashes on Jan 2018 and Oct 2018. First, we will use data from Jan 2017 to Nov 2017 to see if the model could predict the boom period.", "Next, we will construct features for our machine learning algorithm. Firstly, we will write a function that produces a window of historical prices of size h and means of the next future f prices.", "We will test our function with a sequence of Close prices of length 10", "We get a dataframe that contains a rolling window of size 5 as shown below.", "In addition to the prices window, we add a time column for features as well.", "Now, let\u2019s construct signature features. As mention above, signatures are in the form of iterated integral of a continuous path but we only have discrete data points. There are various ways to transform discrete data points we have into a continuous path. For example,", "Here are illustrations of each transformation from A Primer on the Signature Method in Machine Learning. For two one-dimensional sequence of length 4,", "However, there is another interesting transformation which is a Lead-Lag transformation which transforms a one-dimensional into a two-dimensional path.", "Here, we will use this Lead-Lag transform on our discrete data points and use the signature of that path for our features.", "Next, it\u2019s time to calculate the truncated signature of a path! We are lucky enough and don\u2019t have to write a function to calculate the iterated integrals. Apparently, there is a package ESig that will do the (dirty) works for us though it is still in the active stages of development.", "Following is the documentation of ts.stream2sig(\u2026).stream2sig(array(no_of_ticks x signal_dimension), signature_degree) reads a 2 dimensional numpy array of floats, \u201cthe data in stream space\u201d and returns a numpy vector containing the signature of the vector series up to given signature_degree.", "We will use this function to calculate the signature of a path (Time_lead, Price_lead, Price_lag).", "Now, we are ready to calculate normal features and signature features. For simplicity, we will only use close price of the Bitcoin. What the following code do is to get normal window features with a time column, get prediction target which is mean of the future prices and calculate signature features. For the signature features, we use ESig package to find the level 2 truncated signature of a path (time_lead, price_lead, price_lag).", "We can check the resulted features.", "We split X_sig, y into train and test set for the model and we will predict 10 future prices.", "Firstly, we will train our model on a Lasso linear regression with signature features. We use a time series split test cross-validation and gridsearchCV to tune a hyperparameter alpha.", "and the indispensable part of a time series prediction is to visualise the result.", "The model can predict that there will be a boom in the future with an adequate accuracy of around 15%. Note that here we only use the level 2 truncated signature features. In theory, if we increase the level of truncation, we expect the model to be more accurate as we have more information", "Now we will try our XGBoost model. We also use Time series split cross-validation and GridsearchCV to tune hyperparameters too.", "We observe that the mean absolute error for the train set is quite low which is a sign of overfitting and the value for the test set is about the same as the Signature method. Let\u2019s visualise the graph", "We can see that the model can\u2019t predict the boom period at all and it guessed that the mean future prices are stable. One possible reason for this to happen is that the model hasn\u2019t experienced such a sharp increase before.", "We will use a period from Jan 2018 to Dec 2018 to test whether the model can predict a crash. We test with a duration where the price was quite stable.", "The following is the result of the signature features.", "We got a Convergence warning saying that the model does not converge and the resulted graph is quite weird. Note that here we use only the truncated signature level 2 which has only 12 features so they may not capture important information about the path.", "We experiment with the truncated signature level 3.", "The model did poorer in term or an error but we can see from the graph that it has a more realistic path than the level 2 truncated signature features.", "On the other hand here is the result of the XGBoost algorithm.", "The model did extremely well and made a prediction with an error of up to 0.5%.", "Now, let\u2019s challenge whether these model can predict a crash in Dec 2018.", "We used level 3 truncated signature features and here is the result.", "It\u2019s clear that none of the models can predict the crash in advance. We may reach the limit of using only historical prices here. In the real world, there are many factors that affect the cryptocurrency price such as news, the attractiveness of other financial products. However, technical analysis like this could give us a quick picture of the data.", "We have learnt how to use the signature features to model a time series and compare it with the XGBoost algorithm which is the cutting-edge algorithm at the moment. The XBGoost has done extremely well in a period of stable prices while it could not give us much information when there is a boom or a bust. On the other hand, the Signature method did okay in a stable prices period but potentially can give some information about a significant change. Nonetheless, the data set that the author picked can be biased because we know beforehand that when is the boom period and when is the bust period. To conclude, the method is quite new and still need to prove itself and I encourage readers to have a play on it.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Rattana will start a PhD in Machine Learning this fall."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcf3100a882cc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rattanapukdee.medium.com/?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": ""}, {"url": "https://rattanapukdee.medium.com/?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": "Rattana Pukdee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F42a03755a1aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&user=Rattana+Pukdee&userId=42a03755a1aa&source=post_page-42a03755a1aa----cf3100a882cc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3100a882cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3100a882cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/illustrations/bitcoin-blockchain-currency-3396302/", "anchor_text": "Pixabay"}, {"url": "https://arxiv.org/abs/1603.03788", "anchor_text": "A Primer on the Signature Method in Machine Learning."}, {"url": "https://arxiv.org/abs/1405.4537", "anchor_text": "Rough paths, Signatures and the modelling of functions on streams"}, {"url": "https://arxiv.org/abs/1603.03788", "anchor_text": "A Primer on the Signature Method in Machine Learning"}, {"url": "https://arxiv.org/abs/1307.7244", "anchor_text": "Extracting information from the signature of a financial data stream"}, {"url": "https://arxiv.org/pdf/1308.0371.pdf", "anchor_text": "Sparse arrays of signatures for online character recognition"}, {"url": "https://arxiv.org/pdf/1606.02074.pdf", "anchor_text": "Application of the Signature Method to Pattern Recognition in the CEQUEL Clinical Trial"}, {"url": "https://www.quantstart.com/articles/rough-path-theory-and-signatures-applied-to-quantitative-finance-part-1", "anchor_text": "QuantStart \u2014 Rough Path Theory and Signatures Applied To Quantitative Finance"}, {"url": "https://arxiv.org/abs/1809.09466", "anchor_text": "Derivatives pricing using signature payoffs"}, {"url": "https://www.cryptodatadownload.com/", "anchor_text": "https://www.cryptodatadownload.com/"}, {"url": "https://arxiv.org/abs/1603.03788", "anchor_text": "A Primer on the Signature Method in Machine Learning."}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cf3100a882cc---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----cf3100a882cc---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----cf3100a882cc---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----cf3100a882cc---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/finance?source=post_page-----cf3100a882cc---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf3100a882cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&user=Rattana+Pukdee&userId=42a03755a1aa&source=-----cf3100a882cc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf3100a882cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&user=Rattana+Pukdee&userId=42a03755a1aa&source=-----cf3100a882cc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3100a882cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcf3100a882cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cf3100a882cc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cf3100a882cc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cf3100a882cc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cf3100a882cc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cf3100a882cc--------------------------------", "anchor_text": ""}, {"url": "https://rattanapukdee.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rattanapukdee.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rattana Pukdee"}, {"url": "https://rattanapukdee.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "20 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F42a03755a1aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&user=Rattana+Pukdee&userId=42a03755a1aa&source=post_page-42a03755a1aa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff7aa334bc75c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-bitcoin-prices-by-using-signature-time-series-modelling-cf3100a882cc&newsletterV3=42a03755a1aa&newsletterV3Id=f7aa334bc75c&user=Rattana+Pukdee&userId=42a03755a1aa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}