{"url": "https://towardsdatascience.com/k-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8", "time": 1683016037.889008, "path": "towardsdatascience.com/k-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8/", "webpage": {"metadata": {"title": "K-Means 8x faster, 27x lower error than Scikit-learn\u2019s in 25 lines | by Jakub Adamczyk | Towards Data Science", "h1": "K-Means 8x faster, 27x lower error than Scikit-learn\u2019s in 25 lines", "description": "In my last article on faiss library I\u2019ve shown how to make kNN up to 300 times faster than Scikit-learn\u2019s in 20 lines using Facebook\u2019s faiss library. But we can do much more with it, including both\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/make-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb", "anchor_text": "my last article on faiss library", "paragraph_index": 0}, {"url": "https://github.com/facebookresearch/faiss", "anchor_text": "Facebook\u2019s faiss library", "paragraph_index": 0}], "all_paragraphs": ["In my last article on faiss library I\u2019ve shown how to make kNN up to 300 times faster than Scikit-learn\u2019s in 20 lines using Facebook\u2019s faiss library. But we can do much more with it, including both faster and more accurate K-Means clustering, in just 25 lines!", "K-Means is an iterative algorithm, which clusters the data points into k clusters, each represented with a mean / center point (a centroid). Training starts with some initial guesses and then alternates between two steps: assignment and update.", "In the assignment phase we assign each point to the nearest cluster (using Euclidean distance between point and centroids) and in the update step we recalculate each centroid, calculating a mean point from all points assigned to that cluster in the current step.", "The final quality of clustering is calculated as a sum of in-cluster distances, where for each cluster we calculate a sum of Euclidean distances between points in that cluster and its centroid. This is also called inertia.", "For prediction, we perform a 1 nearest neighbor search (kNN with k=1) between new points and centroids.", "In both libraries we have to specify algorithm hyperparameters: number of clusters, number of restarts (each starting with other initial guesses) and maximal number of iterations.", "As we can see from the example, the core of the algorithm is searching for nearest neighbors, specifically nearest centroids, both for training and prediction. And that\u2019s where faiss is orders of magnitude faster than Scikit-learn! It leverages great C++ implementation, concurrency wherever possible and even GPU, if you want.", "Github Gist below is also available at my regular Github (link).", "A great feature of faiss is that it has both installation and build instructions (installation docs) and an excellent documentation with examples (getting started docs). After the installation, we can write the actual clustering. The code is quite simple, since we just mimic the Scikit-learn API.", "I\u2019ve chosen a few popular datasets available in Scikit-learn for comparison. The train times andpredict times are compared. For easier reading, I\u2019ve explicitly written how many times faster is the faiss-based clustering than Scikit-learn\u2019s. For error comparison I\u2019ve just written how many times lower error the faiss-based clustering achieves (since numbers are large and not very informative).", "All of those times have been measured with the time.process_time() function, that measures process time instead of wall clock time, for more accurate results. Results are averages of 100 runs, except for MNIST, where it took too long for Scikit-learn and I had to do 5 runs.", "As we can see, for K-Means clustering for small datasets (first 4 datasets) faiss-based version is slower for training and has a larger error. For prediction it works universally faster.", "For larger MNIST dataset faiss is a clear winner. Training 20.5 times faster is huge, especially since it reduces time from almost 3 minutes to less than 8 seconds! A 1.5 times faster prediction is also nice. The true achievement, however, is a spectacular 27.5 times lower error. This means that for larger real world dataset the faiss-based version is vastly more accurate. And this takes only 25 lines of code!", "So based on this: if you have large (at least a few thousand samples) real world dataset, the faiss-based version is just plain better. For small toy dataset Scikit-learn is a better choice; however, if you have a GPU, the GPU-accelerated faiss version may turn out faster (I haven\u2019t checked it for fair CPU comparison).", "With 25 lines of code, we can get a huge speed and accuracy boost for K-Means clustering for reasonably sized datasets with the faiss library. If you need, you can get even better with GPU, multiple GPUs and more, which is nicely explained in faiss docs.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science student, ML engineer, Data Science and ML algorithms enthusiast."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feaedc7a3a0c8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jakubadamczyk10?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jakubadamczyk10?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": "Jakub Adamczyk"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa2bd22267201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&user=Jakub+Adamczyk&userId=a2bd22267201&source=post_page-a2bd22267201----eaedc7a3a0c8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feaedc7a3a0c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feaedc7a3a0c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering#/media/File:K-means_convergence.gif", "anchor_text": "source"}, {"url": "https://towardsdatascience.com/make-knn-300-times-faster-than-scikit-learns-in-20-lines-5e29d74e76bb", "anchor_text": "my last article on faiss library"}, {"url": "https://github.com/facebookresearch/faiss", "anchor_text": "Facebook\u2019s faiss library"}, {"url": "https://github.com/facebookresearch/faiss/wiki/Faiss-building-blocks:-clustering,-PCA,-quantization", "anchor_text": "the docs"}, {"url": "https://medium.com/tag/data-science?source=post_page-----eaedc7a3a0c8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----eaedc7a3a0c8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/k-means?source=post_page-----eaedc7a3a0c8---------------k_means-----------------", "anchor_text": "K Means"}, {"url": "https://medium.com/tag/programming?source=post_page-----eaedc7a3a0c8---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----eaedc7a3a0c8---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feaedc7a3a0c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&user=Jakub+Adamczyk&userId=a2bd22267201&source=-----eaedc7a3a0c8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feaedc7a3a0c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&user=Jakub+Adamczyk&userId=a2bd22267201&source=-----eaedc7a3a0c8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feaedc7a3a0c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feaedc7a3a0c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eaedc7a3a0c8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eaedc7a3a0c8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jakubadamczyk10?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jakubadamczyk10?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jakub Adamczyk"}, {"url": "https://medium.com/@jakubadamczyk10/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "89 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa2bd22267201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&user=Jakub+Adamczyk&userId=a2bd22267201&source=post_page-a2bd22267201--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F494f9b4fd578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-8x-faster-27x-lower-error-than-scikit-learns-in-25-lines-eaedc7a3a0c8&newsletterV3=a2bd22267201&newsletterV3Id=494f9b4fd578&user=Jakub+Adamczyk&userId=a2bd22267201&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}