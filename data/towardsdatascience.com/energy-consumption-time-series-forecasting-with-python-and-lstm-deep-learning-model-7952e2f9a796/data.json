{"url": "https://towardsdatascience.com/energy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796", "time": 1683003871.422591, "path": "towardsdatascience.com/energy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796/", "webpage": {"metadata": {"title": "Energy consumption time series forecasting with python and LSTM deep learning model | by Eligijus Bujokas | Towards Data Science", "h1": "Energy consumption time series forecasting with python and LSTM deep learning model", "description": "The objective of this article is to present the reader with a class in python that has a very intuitive and easy input to model and predict time series data using deep learning. Ideally, the reader\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["The objective of this article is to present the reader with a class in python that has a very intuitive and easy input to model and predict time series data using deep learning. Ideally, the reader should be able to copy the code presented in this article or the GitHub repository, tailor it to his needs (add more layers to the model for example) and use it his/her work.", "All the code that is used in this article can be found here:", "The data for this article can be found here:", "The packages that are used for deep modeling are TensorFlow and Keras.", "A time series is a sequence of numerical data points in successive order. These points are often measured at regular intervals (every month, every day, every hour, etc.). The data frequency used in this article is hourly and it was measured from 2004\u201310\u201301 to 2018\u201308\u201303. The total number of raw data points is 121271.", "The main objective of the deep learning algorithm for a given time series is to find a function f such that:", "In other words, we want to estimate a function that explains the current values of energy consumption based on p lags of the same energy consumption.", "This article is not about explaining why long short-term memory (LSTM) deep learning networks are good for time series modeling or how it works. For resources on that check great articles like:", "For the implementation of LSTM (or any RNN layer) in Keras see the official documentation:", "Firstly, we need to read the data :", "We then need a function that converts the time series into an X and Y matrices for the deep learning model to start learning. Let us say that we want to create a function that explains current time series values using 3 lags:", "What we would like is to create two matrices:", "This is the most important trick when using deep learning with time series. You can feed these X and Y matrices not only to a recurrent neural network system (like LSTM) but to any vanilla deep learning algorithm.", "The deep learning model has an LSTM layer (that serves as the input layer as well) and an output layer.", "During my searches on the internet for an easy to use deep learning model with time series I came across various articles that picked apart several parts of modeling like how to define a model, how to create the matrix for the models, etc. I did not find a package or a class that wrapped everything up into one easy to use entity. So I decided to do that myself:", "The parameters for the class are:", "data - the data used for modeling.", "Y_var - the variable name we want to model/forecast.", "lag - the number of lags used for modeling.", "LSTM_layer_depth - number of neurons in the LSTM layer.", "epochs - number of training loops (forward propagation to backward propagation cycles).", "batch_size - the size of the data sample for the gradient descent used in the finding of the parameters by the deep learning model. All the data is divided into chunks of batch_size sizes and fed through the network. The internal parameters of the model are updated after each batch_size of data goes forward and backward in the model.", "To read more about epochs and batch sizes visit:", "train_test_split - the share of the data that is used for testing. 1 - train_test_split is used for the training of the model.", "After the above command, you can witness the fan-favorite training screen:", "Training the model with more lags (hence, a larger X matrix) increases the training time:", "Now that we have a created model we can start forecasting. The formula for the forecasts with a model trained with p lags:", "If the data was split into training and test sets then the deep_learner.predict() method will predict the points which are in the test set to see how our model performs out of sample.", "As we can see, the forecasts for 15 percent of the data that was hidden from model creation are close to the real values.", "We usually want to forecast ahead of the last original time series data. The class DeepModelTS has the method predict_n_ahead(n_ahead) which forecasts n_ahead time steps.", "The above code forecasts one week's worth of steps ahead (168 hours). Comparing it with the previous 400 hours:", "In conclusion, this article presented a simple pipeline example when working with modeling and forecasting of the time series data:", "Reading and cleaning the data (1 row for 1 time step)", "Selecting the number of lags and model depth", "I hope that the reader can use the code showcased in this article in his/her professional and academic work.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A person who tries to understand the world through data and equations"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7952e2f9a796&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://eligijus-bujokas.medium.com/?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": ""}, {"url": "https://eligijus-bujokas.medium.com/?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": "Eligijus Bujokas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd61597e07b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&user=Eligijus+Bujokas&userId=d61597e07b4d&source=post_page-d61597e07b4d----7952e2f9a796---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7952e2f9a796&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7952e2f9a796&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@davidhellmann?utm_source=medium&utm_medium=referral", "anchor_text": "David Hellmann"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/Eligijus112/deep-learning-ts", "anchor_text": "https://github.com/Eligijus112/deep-learning-ts"}, {"url": "https://www.kaggle.com/robikscube/hourly-energy-consumption", "anchor_text": "https://www.kaggle.com/robikscube/hourly-energy-consumption"}, {"url": "https://pathmind.com/wiki/lstm", "anchor_text": "A Beginner's Guide to LSTMs and Recurrent Neural NetworksData can only be understood backwards; but it must be lived forwards. - S\u00f8ren Kierkegaard, Journals* Contents Recurrent\u2026pathmind.com"}, {"url": "https://towardsdatascience.com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21", "anchor_text": "Illustrated Guide to LSTM\u2019s and GRU\u2019s: A step by step explanationHi and welcome to an Illustrated Guide to Long Short-Term Memory (LSTM) and Gated Recurrent Units (GRU). I\u2019m Michael\u2026towardsdatascience.com"}, {"url": "https://keras.io/layers/recurrent/", "anchor_text": "Recurrent Layers - Keras Documentationkeras.engine.base_layer.wrapped_fn() Base class for recurrent layers. Arguments cell: A RNN cell instance. A RNN cell\u2026keras.io"}, {"url": "https://machinelearningmastery.com/difference-between-a-batch-and-an-epoch/", "anchor_text": "Difference Between a Batch and an Epoch in a Neural NetworkStochastic gradient descent is a learning algorithm that has a number of hyperparameters. Two hyperparameters that\u2026machinelearningmastery.com"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----7952e2f9a796---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/timeseries?source=post_page-----7952e2f9a796---------------timeseries-----------------", "anchor_text": "Timeseries"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7952e2f9a796---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----7952e2f9a796---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7952e2f9a796&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&user=Eligijus+Bujokas&userId=d61597e07b4d&source=-----7952e2f9a796---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7952e2f9a796&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&user=Eligijus+Bujokas&userId=d61597e07b4d&source=-----7952e2f9a796---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7952e2f9a796&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7952e2f9a796&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7952e2f9a796---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7952e2f9a796--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7952e2f9a796--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7952e2f9a796--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7952e2f9a796--------------------------------", "anchor_text": ""}, {"url": "https://eligijus-bujokas.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://eligijus-bujokas.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Eligijus Bujokas"}, {"url": "https://eligijus-bujokas.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "359 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd61597e07b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&user=Eligijus+Bujokas&userId=d61597e07b4d&source=post_page-d61597e07b4d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3e3cf5271629&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796&newsletterV3=d61597e07b4d&newsletterV3Id=3e3cf5271629&user=Eligijus+Bujokas&userId=d61597e07b4d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}