{"url": "https://towardsdatascience.com/building-an-application-of-question-answering-system-from-scratch-2dfc53f760aa", "time": 1683010600.107635, "path": "towardsdatascience.com/building-an-application-of-question-answering-system-from-scratch-2dfc53f760aa/", "webpage": {"metadata": {"title": "Building an application of question answering system from scratch | by Hiroki Nakayama | Towards Data Science", "h1": "Building an application of question answering system from scratch", "description": "Question Answering(QA) system is a system that gives appropriate answers to questions expressed in natural languages such as English, Chinese, and so on. For example, suppose a user asks \u201cWhen was\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.mediawiki.org/wiki/API:Main_page", "anchor_text": "MediaWiki API", "paragraph_index": 10}, {"url": "https://rajpurkar.github.io/SQuAD-explorer/", "anchor_text": "SQuAD 2.0 leader board", "paragraph_index": 21}, {"url": "https://huggingface.co/transformers/index.html", "anchor_text": "Transformers' documentation", "paragraph_index": 21}, {"url": "https://github.com/Hironsan", "anchor_text": "https://github.com/Hironsan", "paragraph_index": 23}], "all_paragraphs": ["Question Answering(QA) system is a system that gives appropriate answers to questions expressed in natural languages such as English, Chinese, and so on. For example, suppose a user asks \u201cWhen was Abraham Lincoln assassinated?\u201d In this case, the question answering system is expected to return \u201cApr 15, 1865\u201d. Below is an example of question-answer pairs.", "A question answering system will help you find information efficiently. Generally speaking, we use search engines to search for relevant documents when we look for some information on the Web. However, because they show you documents, you must read the documents and decide whether they contain the information you need. It\u2019s a bother. Thus, commercial search engines have a question answering feature so that you can find information efficiently.", "Question answering systems have several paradigms, but two major paradigms have been used: knowledge-based and information retrieval based question answering. When human beings answer a question, they first try to answer the question with their own knowledge. If they can\u2019t answer the question, they look for an answer on the internet or in books. Question answering systems are similar to human beings. The former corresponds to a knowledge-based system, and the latter corresponds to an information retrieval based system.", "In this post, we will build an IR-based question answering system. First, we transform the question into a search query. Next, we use the MediaWiki API to get the documents. Finally, we extract the answers from the documents using a pre-trained BERT. The entire system can be divided into four parts: question processing, document retrieval, passage retrieval, and answer extraction.", "I show you only important parts in this post, but the entire system is available in the following GitHub repository. The code is small and easy to understand. Please take a look:", "The remainder of the post is organized as follows:", "Question processing transforms a question into a search query. Typically, stop words are removed and words with specific part-of-speech are removed. Also, with the recent evolution of deep learning technology, it has become possible to create a vector that can express the meaning of a sentence well, so a method of converting a question into a vector and using it as a query is also used.", "This time, we will generate a search query by using spaCy. First, the question is parsed and tagged with part-of-speech tags. Next, we remove words based on their part-of-speech tags. Specifically, words other than proper nouns (PROPN), numbers (NUM), verbs (VERB), nouns (NOUN), and adjectives (ADJ) are removed. For example, the question \u201cWho is the founder of Amazon?\u201d generates the query \u201cfounder Amazon\u201d.", "Please take a look at QueryProcessor class:", "In the document retrieval, we will retrieve relevant documents by using the generated query. In the subsequent processing, since the answer will be extracted from these documents, it is required to search the documents that may contain the answer as much as possible. Similar to the question processing, deep learning technology allows us to convert documents into vectors[1].", "This time, we will search for Wikipedia. Wikipedia provides an API called MediaWiki API. We can use the API to search the documents related to the query. The process here consists of two steps. First, we send a query to get a list of related pages. Then we fetch the contents of the individual pages.", "Please take a look at the DocumentRetrieval class:", "In passage retrieval, the documents are divided into smaller units (passages) such as sentences and paragraphs, and passages that are likely to contain an answer are selected. If the document is short, it is not necessary, but if it is long, passage selection is effective because we don\u2019t know which part of the document the query matched. Generally, the subsequent answer extraction process takes a long time to complete, so selecting passages also has the benefit of speeding up the entire system.", "This time, we will select passages that are similar to the question. To calculate the similarity, we use BM25 to create vectors of questions and passages. Once we have created the vectors, we can use the dot product and cosine similarity to calculate the similarity between the question and the passage. Because BM25 is powerful, it is often used as a baseline for passage retrieval.", "Please take a look at the PassageRetrieval class:", "Answer extraction extracts answers from passages. Here, the question and passage are input to the answer extraction model, and the model outputs the answer offset with the score. It then ranks the answers based on the score and presents the answers with the highest scores to the user as the final answer.", "This time, we formulate the answer extraction as context-aware question answering and solve it with BERT. By inputting the question and passage to the BERT, we can get the offset of the answer. It is known that BERT can solve the answer extraction well and outperforms humans on the SQuAD dataset[2][3].", "Please take a look at the AnswerExtraction class:", "Let\u2019s take a look at the application. The following is an example of a question answering. When the question \u201cWho is the founder of Amazon?\u201d is posted, the application converts the question to the query, retrieves documents via MediaWiki API, selects passages and extract answers from them. As a result, the application returns \u201cJeff Bezos\u201d as the top answer:", "As the first step for further improvement, there is a way to improve document retrieval performance by embedding a question and documents in a more sophisticated manner. It is known that the performance is improved by using BERT or Universal Sentence Encoder instead of vectorizing them using BM25[1][4][5].", "A method has also been proposed in which information retrieval and answer extraction are jointly trained[6]. This time, information retrieval and answer extraction were performed separately. Since information retrieval is different from question answering, the systems are locally optimized. By training information retrieval and answer extraction at the same time, the system can be optimized well.", "Of course, you can use better answer extraction models. According to the SQuAD 2.0 leader board, there are several models that are better performance than BERT. For example, ALBERT[7], ELECTRA[8], RoBERTa[9], XLNet[10], and so on. You can use these models easily because Huggingface transformers support them. For further details, see Transformers' documentation.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Open source developer. Interested in machine learning and natural language processing. GitHub: https://github.com/Hironsan"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2dfc53f760aa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Hironsan?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Hironsan?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": "Hiroki Nakayama"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4f20f71312b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&user=Hiroki+Nakayama&userId=b4f20f71312b&source=post_page-b4f20f71312b----2dfc53f760aa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2dfc53f760aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2dfc53f760aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://commons.wikimedia.org/wiki/File:Allee_de_chataigniers_-_Alfred_Sisley.jpg", "anchor_text": "Wikimedia"}, {"url": "https://web.stanford.edu/~jurafsky/slp3/", "anchor_text": "Speech and Language Processing"}, {"url": "https://web.stanford.edu/~jurafsky/slp3/", "anchor_text": "Speech and Language Processing"}, {"url": "https://github.com/Hironsan/WikipediaQA", "anchor_text": "https://github.com/Hironsan/WikipediaQA"}, {"url": "https://github.com/Hironsan/WikipediaQA/blob/2c296107ca9e62acafc08c0a890912a68458b1bb/src/components.py#L12-L21", "anchor_text": "QueryProcessor"}, {"url": "https://www.mediawiki.org/wiki/API:Main_page", "anchor_text": "MediaWiki API"}, {"url": "https://github.com/Hironsan/WikipediaQA/blob/2c296107ca9e62acafc08c0a890912a68458b1bb/src/components.py#L24-L67", "anchor_text": "DocumentRetrieval"}, {"url": "https://github.com/Hironsan/WikipediaQA/blob/2c296107ca9e62acafc08c0a890912a68458b1bb/src/components.py#L70-L93", "anchor_text": "PassageRetrieval"}, {"url": "https://rajpurkar.github.io/SQuAD-explorer/explore/v2.0/dev/", "anchor_text": "SQuAD 2.0"}, {"url": "https://arxiv.org/pdf/1810.04805.pdf", "anchor_text": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"url": "https://github.com/Hironsan/WikipediaQA/blob/2c296107ca9e62acafc08c0a890912a68458b1bb/src/components.py#L96-L113", "anchor_text": "AnswerExtraction"}, {"url": "https://rajpurkar.github.io/SQuAD-explorer/", "anchor_text": "SQuAD 2.0 leader board"}, {"url": "https://huggingface.co/transformers/index.html", "anchor_text": "Transformers' documentation"}, {"url": "https://github.com/Hironsan/WikipediaQA", "anchor_text": "https://github.com/Hironsan/WikipediaQA"}, {"url": "https://arxiv.org/abs/1905.01758", "anchor_text": "Investigating the Successes and Failures of BERT for Passage Re-Ranking"}, {"url": "https://www.aclweb.org/anthology/N19-1423/", "anchor_text": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"url": "https://www.aclweb.org/anthology/D16-1264/", "anchor_text": "SQuAD: 100,000+ Questions for Machine Comprehension of Text"}, {"url": "https://arxiv.org/abs/2004.04906", "anchor_text": "Dense Passage Retrieval for Open-Domain Question Answering"}, {"url": "https://arxiv.org/abs/1907.04780", "anchor_text": "ReQA: An Evaluation for End-to-End Answer Retrieval Models"}, {"url": "https://www.aclweb.org/anthology/P19-1612/", "anchor_text": "Latent Retrieval for Weakly Supervised Open Domain Question Answering"}, {"url": "https://arxiv.org/abs/1909.11942", "anchor_text": "ALBERT: A Lite BERT for Self-supervised Learning of Language Representations"}, {"url": "https://arxiv.org/abs/2003.10555", "anchor_text": "ELECTRA: Pre-training Text Encoders as Discriminators Rather Than Generators"}, {"url": "https://arxiv.org/abs/1907.11692", "anchor_text": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"url": "https://arxiv.org/abs/1906.08237", "anchor_text": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2dfc53f760aa---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----2dfc53f760aa---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----2dfc53f760aa---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/python?source=post_page-----2dfc53f760aa---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/web-applications?source=post_page-----2dfc53f760aa---------------web_applications-----------------", "anchor_text": "Web Applications"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2dfc53f760aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&user=Hiroki+Nakayama&userId=b4f20f71312b&source=-----2dfc53f760aa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2dfc53f760aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&user=Hiroki+Nakayama&userId=b4f20f71312b&source=-----2dfc53f760aa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2dfc53f760aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2dfc53f760aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2dfc53f760aa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2dfc53f760aa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Hironsan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Hironsan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hiroki Nakayama"}, {"url": "https://medium.com/@Hironsan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "288 Followers"}, {"url": "https://github.com/Hironsan", "anchor_text": "https://github.com/Hironsan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4f20f71312b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&user=Hiroki+Nakayama&userId=b4f20f71312b&source=post_page-b4f20f71312b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F40554091ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-application-of-question-answering-system-from-scratch-2dfc53f760aa&newsletterV3=b4f20f71312b&newsletterV3Id=40554091ebf&user=Hiroki+Nakayama&userId=b4f20f71312b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}