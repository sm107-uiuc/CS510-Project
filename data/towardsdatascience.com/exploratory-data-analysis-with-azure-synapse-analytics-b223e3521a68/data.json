{"url": "https://towardsdatascience.com/exploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68", "time": 1683017579.2279732, "path": "towardsdatascience.com/exploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68/", "webpage": {"metadata": {"title": "Exploratory Data Analysis with Azure Synapse Analytics | by Arthur Steijn | Towards Data Science", "h1": "Exploratory Data Analysis with Azure Synapse Analytics", "description": "Last week, 3th of December, Azure Synapse Analytics was announced to be General Available. Another reason to have some fun with a few of the new features in the Azure Synapse Workspace. Like building\u2026"}, "outgoing_paragraph_urls": [{"url": "https://azure.microsoft.com/en-us/services/open-datasets/catalog/nyc-taxi-limousine-commission-yellow-taxi-trip-records/", "anchor_text": "NYC Taxi Open dataset", "paragraph_index": 18}, {"url": "https://azure.microsoft.com/en-us/services/synapse-analytics/", "anchor_text": "Azure Synapse Analytics | Microsoft Azure", "paragraph_index": 22}, {"url": "https://azure.microsoft.com/en-us/updates/azure-synapse-sql-serverless-breaking-change-related-to-tooling-ssms-ads/", "anchor_text": "New version of SSMS and ADS tools for serverless SQL pools in Azure Synapse Analytics | Azure updates | Microsoft Azure", "paragraph_index": 23}, {"url": "https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/on-demand-workspace-overview", "anchor_text": "Serverless SQL pool \u2014 Azure Synapse Analytics | Microsoft Docs", "paragraph_index": 24}, {"url": "https://docs.microsoft.com/en-us/sql/relational-databases/collations/set-or-change-the-column-collation?view=sql-server-ver15", "anchor_text": "Set or Change the Column Collation \u2014 SQL Server | Microsoft Docs", "paragraph_index": 25}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/statements/create-external-table-as-select-transact-sql?view=azure-sqldw-latest", "anchor_text": "CREATE EXTERNAL TABLE AS SELECT (Transact-SQL) \u2014 SQL Server | Microsoft Docs", "paragraph_index": 26}, {"url": "https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/tutorial-data-analyst", "anchor_text": "Tutorial: Use serverless SQL pool to analyze Azure Open Datasets in Azure Synapse Studio \u2014 Azure Synapse Analytics | Microsoft Docs", "paragraph_index": 27}, {"url": "https://docs.microsoft.com/en-us/learn/paths/realize-integrated-analytical-solutions-with-azure-synapse-analytics/?WT.mc_id=modinfra-11136-abartolo&source=learn", "anchor_text": "Realize Integrated Analytical Solutions with Azure Synapse Analytics \u2014 Learn | Microsoft Docs", "paragraph_index": 28}], "all_paragraphs": ["Last week, 3th of December, Azure Synapse Analytics was announced to be General Available. Another reason to have some fun with a few of the new features in the Azure Synapse Workspace. Like building a Power BI report with T-SQL without provisioning a \u2018traditional\u2019 SQL Server instance and building a data pipeline.", "In this blog, we will be using the Serverless SQL Pool included in the workspace, to create just that. Some of the benefits of the Serverless SQL Pool:", "To know more about the Serverless SQL Pool, be sure to check the official documentation. A link is in the references at the end of this blog.", "In the end, I will also provide an example of the \u2018create external table as select\u2019 statement. This is extremely useful if you need to reuse the results of your data analysis. It allows you to export the data to your storage account in the desired format.", "So how did I do this? What steps are needed to build the report:", "Maybe this is a little blunt, but I promise it won\u2019t be difficult. We will go through the steps to take!", "In this case, I used the Azure portal to create a new workspace and used all of the standard settings for creation.", "This is could be the hardest part. In the examples, I use an export of the AdventureWorksLT sample database in Parquet format. If you do not have parquet files, CSV will do the job as well.", "You could place your files in the storage account that is created with the Synapse workspace. However, if you would like to use an existing storage account from the same tenant, that is also possible. Just make sure you assign the right roles to the storage account:", "In case you are not using the created ADLS Account to read data from, a \u2018Linked Service\u2019 needs to be configured to the Storage Account. One way to do this is by navigating to the \u2018Manage\u2019 tab on the left side. Choose \u2018Linked Services\u2019 and click \u2018New\u2019. Choose the appropriate storage type and fill out the details.", "Authentication via Managed Identity is recommended.", "Being \u2018Owner\u2019 or \u2018Contributor\u2019 on the storage account is not sufficient. Not having this specific \u2018Storage Blob Data\u2019 role will result in permission errors when trying to query the files.", "Before we can create views we need a database to create the views on. To do this, open the Synapse Studio via the Azure Portal", "Navigate to the \u2018Data\u2019 tab. Click \u2018Add new resource\u2019 and choose \u2018SQL Database\u2019. In the options pick \u2018Serverless\u2019 for pool type and fill out a fitting name for your database.", "Now we are ready to create a view in the database. In the example below I wrote a join between \u2018SalesOrderHeader\u2019 and \u2018SalesOrderDetail\u2019.", "Navigate to the \u2018Develop\u2019 tab. Click \u2018Add new resource\u2019 and choose \u2018SQL Script\u2019. Add and execute your script. To verify if the view works navigate to the \u2018Data\u2019 tab, select your create database, views and under \u2018Actions\u2019 choose for \u2018Select Top 100 rows\u2019.", "Almost there! Open Power BI Desktop and choose \u2018SQL Server\u2019 as your data source. The server name can be found in the Azure Portal. It will likely be", "Choose your created view and load the data!", "Be aware of the limitations of Import and Direct Query mode. In another example, I made a view of the NYC Taxi Open dataset. And loaded it to Power Bi with the Direct Query mode to prevent the .pbix file from blowing up with the 1.572.000.000 rows.", "Another great feature of the Serverless SQL Pool is the use of the \u2018Create External Table As Select\u2019 statement. Basically, it does two things:", "To be able to use this statement you need to have a few things in place:", "So my goal was to show you that it is fairly easy to set up an Azure Synapse Workspace and use the Serverless SQL Pool to explore data in the data lake. The advantages are many, among them:", "Azure Synapse Analytics | Microsoft Azure", "New version of SSMS and ADS tools for serverless SQL pools in Azure Synapse Analytics | Azure updates | Microsoft Azure", "Serverless SQL pool \u2014 Azure Synapse Analytics | Microsoft Docs", "Set or Change the Column Collation \u2014 SQL Server | Microsoft Docs", "CREATE EXTERNAL TABLE AS SELECT (Transact-SQL) \u2014 SQL Server | Microsoft Docs", "Tutorial: Use serverless SQL pool to analyze Azure Open Datasets in Azure Synapse Studio \u2014 Azure Synapse Analytics | Microsoft Docs", "Realize Integrated Analytical Solutions with Azure Synapse Analytics \u2014 Learn | Microsoft Docs", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Microsoft-oriented Data/DevOps/Cloud Engineer, always looking for new and exciting techniques to improve processes and deliver fast and reliable data pipelines"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb223e3521a68&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b223e3521a68--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b223e3521a68--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arthur86s.medium.com/?source=post_page-----b223e3521a68--------------------------------", "anchor_text": ""}, {"url": "https://arthur86s.medium.com/?source=post_page-----b223e3521a68--------------------------------", "anchor_text": "Arthur Steijn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fca8dba5b4157&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&user=Arthur+Steijn&userId=ca8dba5b4157&source=post_page-ca8dba5b4157----b223e3521a68---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb223e3521a68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb223e3521a68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@claybanks?utm_source=medium&utm_medium=referral", "anchor_text": "Clay Banks"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://azure.microsoft.com/en-us/services/open-datasets/catalog/nyc-taxi-limousine-commission-yellow-taxi-trip-records/", "anchor_text": "NYC Taxi Open dataset"}, {"url": "https://azure.microsoft.com/en-us/services/synapse-analytics/", "anchor_text": "Azure Synapse Analytics | Microsoft Azure"}, {"url": "https://azure.microsoft.com/en-us/updates/azure-synapse-sql-serverless-breaking-change-related-to-tooling-ssms-ads/", "anchor_text": "New version of SSMS and ADS tools for serverless SQL pools in Azure Synapse Analytics | Azure updates | Microsoft Azure"}, {"url": "https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/on-demand-workspace-overview", "anchor_text": "Serverless SQL pool \u2014 Azure Synapse Analytics | Microsoft Docs"}, {"url": "https://docs.microsoft.com/en-us/sql/relational-databases/collations/set-or-change-the-column-collation?view=sql-server-ver15", "anchor_text": "Set or Change the Column Collation \u2014 SQL Server | Microsoft Docs"}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/statements/create-external-table-as-select-transact-sql?view=azure-sqldw-latest", "anchor_text": "CREATE EXTERNAL TABLE AS SELECT (Transact-SQL) \u2014 SQL Server | Microsoft Docs"}, {"url": "https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/tutorial-data-analyst", "anchor_text": "Tutorial: Use serverless SQL pool to analyze Azure Open Datasets in Azure Synapse Studio \u2014 Azure Synapse Analytics | Microsoft Docs"}, {"url": "https://docs.microsoft.com/en-us/learn/paths/realize-integrated-analytical-solutions-with-azure-synapse-analytics/?WT.mc_id=modinfra-11136-abartolo&source=learn", "anchor_text": "Realize Integrated Analytical Solutions with Azure Synapse Analytics \u2014 Learn | Microsoft Docs"}, {"url": "https://medium.com/tag/synapse-analytics?source=post_page-----b223e3521a68---------------synapse_analytics-----------------", "anchor_text": "Synapse Analytics"}, {"url": "https://medium.com/tag/power-bi?source=post_page-----b223e3521a68---------------power_bi-----------------", "anchor_text": "Power Bi"}, {"url": "https://medium.com/tag/serverless?source=post_page-----b223e3521a68---------------serverless-----------------", "anchor_text": "Serverless"}, {"url": "https://medium.com/tag/data-lake?source=post_page-----b223e3521a68---------------data_lake-----------------", "anchor_text": "Data Lake"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----b223e3521a68---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb223e3521a68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&user=Arthur+Steijn&userId=ca8dba5b4157&source=-----b223e3521a68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb223e3521a68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&user=Arthur+Steijn&userId=ca8dba5b4157&source=-----b223e3521a68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb223e3521a68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b223e3521a68--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb223e3521a68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b223e3521a68---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b223e3521a68--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b223e3521a68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b223e3521a68--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b223e3521a68--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b223e3521a68--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b223e3521a68--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b223e3521a68--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b223e3521a68--------------------------------", "anchor_text": ""}, {"url": "https://arthur86s.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arthur86s.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arthur Steijn"}, {"url": "https://arthur86s.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "32 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fca8dba5b4157&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&user=Arthur+Steijn&userId=ca8dba5b4157&source=post_page-ca8dba5b4157--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5d4e7ed324e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-data-analysis-with-azure-synapse-analytics-b223e3521a68&newsletterV3=ca8dba5b4157&newsletterV3Id=5d4e7ed324e1&user=Arthur+Steijn&userId=ca8dba5b4157&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}