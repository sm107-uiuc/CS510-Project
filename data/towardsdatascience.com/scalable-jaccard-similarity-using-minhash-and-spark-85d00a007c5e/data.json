{"url": "https://towardsdatascience.com/scalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e", "time": 1682995832.496286, "path": "towardsdatascience.com/scalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e/", "webpage": {"metadata": {"title": "Scalable Jaccard similarity using MinHash and Spark | by Schaun Wheeler | Towards Data Science", "h1": "Scalable Jaccard similarity using MinHash and Spark", "description": "A simple algorithm makes it much easier to calculate similarity matrices at scale."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Jaccard_index", "anchor_text": "Jaccard similarity coefficient", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/MinHash#Jaccard_similarity_and_minimum_hash_values", "anchor_text": "MinHash", "paragraph_index": 2}, {"url": "https://coxautomotivedatasolutions.github.io/datadriven/spark/data%20skew/joins/data_skew/", "anchor_text": "key skew", "paragraph_index": 2}, {"url": "http://aampe.co", "anchor_text": "aampe.co", "paragraph_index": 8}], "all_paragraphs": ["It occurred to me a little while ago that the Jaccard similarity coefficient has probably cropped up in my work more than any other statistic except for the arithmetic mean. If you have two sets of things (words, parts of words, attributes, categories, or whatever), you can take the number of things in the intersection of the sets and divide by the number of things in the union of the sets. The resulting metric is a meaningful measure of similarity that has the added virtue of being pretty easily explainable to non-technical folks.", "Jaccard similarity gets a little difficult to calculate directly at scale. If you have a really large list of entity-attribute pairs, and you want an entity-by-entity similarity matrix, you basically have to do an inner join, group by entity and count, then do an outer join, group by entity and count, and then join the results of the two joins together. If your workflow uses Spark, as mine does, that\u2019s a whole lot of shuffling. It\u2019s expensive.", "A while ago, a colleague pointed me to something that I feel like I should have known but didn\u2019t: MinHash. For each entity, randomly permute the attributes, then hash them (convert them to integers), then take the minimum. Do that a bunch of times, then calculate the percentage of times the MinHashes from identical draws for two entities match. We can interpret that metric the the same way we would interpret the Jaccard similarity between those two entities\u2019 attribute sets. So it brings the problem down from huge numbers of attributes to small numbers of hashes; but even better, it brings the problem from variable numbers of attributes \u2014 with all of the pains of key skew \u2014 to the same number of MinHashes across all entities.", "Most everything from lines 36 through 52 in the following code snippet comes from Patrick Nicholson, the colleague who told me about MinHash, who adapted the hashing algorithm from Spark\u2019s spark.ml.feature.MinHashLSH implementation. I built the join logic to turn the MinHash results into actual Jaccard similarities, and wrapped the whole thing in a function to make it more portable.", "The function requires a Spark DataFrame, a string indicating the column of the DataFrame that contains the node labels (the entities between which we want to find similarities), and the column that contains the edges (the attributes we will hash). The function outputs a data frame with the two columns of node labels \u2014 each with a suffix as stipulated by the suffixes keyword argument \u2014 and the Jaccard similarity.", "The Jaccard similarity becomes more precise with more draws. One hundred draws (the default in the code below) gives precision up to 0.01. Five hundred draws gives precision up to 0.005. One thousand draws gives precision up to 0.001. You get the idea.", "This little thing has saved me a lot of time and headaches over the last several months. I thought it was worth sharing.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-founder @ aampe.co. Anthropologist + Data Scientist."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F85d00a007c5e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@schaun.wheeler?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@schaun.wheeler?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": "Schaun Wheeler"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2d3762e7f110&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&user=Schaun+Wheeler&userId=2d3762e7f110&source=post_page-2d3762e7f110----85d00a007c5e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F85d00a007c5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F85d00a007c5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Jaccard_index", "anchor_text": "Jaccard similarity coefficient"}, {"url": "https://en.wikipedia.org/wiki/MinHash#Jaccard_similarity_and_minimum_hash_values", "anchor_text": "MinHash"}, {"url": "https://coxautomotivedatasolutions.github.io/datadriven/spark/data%20skew/joins/data_skew/", "anchor_text": "key skew"}, {"url": "https://medium.com/tag/data-science?source=post_page-----85d00a007c5e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----85d00a007c5e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/spark?source=post_page-----85d00a007c5e---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/statistics?source=post_page-----85d00a007c5e---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F85d00a007c5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&user=Schaun+Wheeler&userId=2d3762e7f110&source=-----85d00a007c5e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F85d00a007c5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&user=Schaun+Wheeler&userId=2d3762e7f110&source=-----85d00a007c5e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F85d00a007c5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F85d00a007c5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----85d00a007c5e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----85d00a007c5e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----85d00a007c5e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----85d00a007c5e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----85d00a007c5e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@schaun.wheeler?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@schaun.wheeler?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Schaun Wheeler"}, {"url": "https://medium.com/@schaun.wheeler/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "894 Followers"}, {"url": "http://aampe.co", "anchor_text": "aampe.co"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2d3762e7f110&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&user=Schaun+Wheeler&userId=2d3762e7f110&source=post_page-2d3762e7f110--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd8dcfa98f86c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscalable-jaccard-similarity-using-minhash-and-spark-85d00a007c5e&newsletterV3=2d3762e7f110&newsletterV3Id=d8dcfa98f86c&user=Schaun+Wheeler&userId=2d3762e7f110&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}