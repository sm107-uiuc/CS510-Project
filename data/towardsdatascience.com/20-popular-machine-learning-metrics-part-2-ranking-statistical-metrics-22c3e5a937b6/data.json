{"url": "https://towardsdatascience.com/20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6", "time": 1683014222.397196, "path": "towardsdatascience.com/20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6/", "webpage": {"metadata": {"title": "20 Popular Machine Learning Metrics. Part 2: Ranking, & Statistical Metrics | by Shervin Minaee | Towards Data Science", "h1": "20 Popular Machine Learning Metrics. Part 2: Ranking, & Statistical Metrics", "description": "In the first part of this post, I provided an introduction to 10 metrics used for evaluating classification and regression models. In this part, I am going to provide an introduction to the metrics\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In the first part of this post, I provided an introduction to 10 metrics used for evaluating classification and regression models. In this part, I am going to provide an introduction to the metrics used for evaluating models developed for ranking (AKA learning to rank), as well as metrics for statistical models. In particular, I will cover the talk about the below 5 metrics:", "Ranking is a fundamental problem in machine learning, which tries to rank a list of items based on their relevance in a particular task (e.g. ranking pages on Google based on their relevance to a given query). It has a wide range of applications in E-commerce, and search engines, such as:", "In learning to rank problem, the model tries to predict the rank (or relative order) of a list of items for a given task\u00b9. The algorithms for ranking problem can be grouped into:", "During evaluation, given the ground-truth order of the list of items for several queries, we want to know how good the predicted order of those list of items is.", "There are various metrics proposed for evaluating ranking problems, such as:", "In this post, we focus on the first 3 metrics above, which are the most popular metrics for ranking problem.", "Some of these metrics may be very trivial, but I decided to cover them for the sake of completeness. So feel free to skip over the the ones you are familiar with. Without any further due, let\u2019s begin our journey.", "Mean reciprocal rank (MRR) is one of the simplest metrics for evaluating ranking models. MRR is essentially the average of the reciprocal ranks of \u201cthe first relevant item\u201d for a set of queries Q, and is defined as:", "To illustrate this, let\u2019s consider the below example, in which the model is trying to predict the plural form of English words by masking 3 guess. In each case, the correct answer is also given.", "The MRR of this system can be found as:", "One of the limitations of MRR is that, it only takes the rank of one of the items (the most relevant one) into account, and ignores other items (for example mediums as the plural form of medium is ignored). This may not be a good metric for cases that we want to browse a list of related items.", "Precision at k (P@k) is another popular metric, which is defined as \u201cthe number of relevant documents among the top k documents\u201d:", "As an example, if you search for \u201chand sanitizer\u201d on Google, and in the first page, 8 out of 10 links are relevant to hand sanitizer, then the P@10 for this query equals to 0.8.", "Now to find the precision at k for a set of queries Q, you can find the average value of P@k for all queries in Q.", "P@k has several limitations. Most importantly, it fails to take into account the positions of the relevant documents among the top k. Also it is easy to evaluate the model manually in this case, since only the top k results need to be examined to determine if they are relevant or not.", "Note that recall@k is another popular metric, which can be defined in a very similar way.", "Normalized Discounted Cumulative Gain (NDCG) is perhaps the most popular metric for evaluating learning to rank systems. In contrast to the previous metrics, NDCG takes the order and relative importance of the documents into account, and values putting highly relevant documents high up the recommended lists.", "Before giving the official definition NDCG, let\u2019s first introduce two relevant metrics, Cumulative Gain (CG) and Discounted Cumulative Gain (DCG).", "Cumulative Gain (CG) of a set of retrieved documents is the sum of their relevance scores to the query, and is defined as below.", "Here we assume that the relevance score of each document to a query is given (otherwise it is usually set to a constant value)", "Discounted Cumulative Gain (DCG) is essentially the weighted version of CG, in which a logarithmic reduction factor is used to discount the relevance scores proportionally to the position of the results. This is useful, as in practice we want to give higher priority to the first few items (than the later ones) when analyzing the performance of a system. DCG is defined as:", "There is also another version of", "Normalized Discounted Cumulative Gain (NDCG) tries to further enhance DCG to better suit real world applications. Since the retrieved set of items may vary in size among different queries or systems, NDCG tries to compare the performance using the normalized version of DCG (by dividing it by DCG of the ideal system). In other words, it sorts documents of a result list by relevance, finds the highest DCG (achieved by an ideal system) at position p, and used to normalize DCG as:", "where the IDCG is the \u201c ideal discounted cumulative gain\u201d, and is defined as below:", "NDCG is a popular metric, but has its own limitations too. One of its main limitations is that it does not penalize for bad documents in the result. It may not be suitable to measure performance of queries that may often have several equally good results (especially true when we are mainly interested in the first few results as it is done in practice).", "Although one can think of machine learning as applied statistics and therefore count all ML metrics as some kind of statistical metrics, there are a few metrics which are mostly used by statistician to evaluate the performance of statistical models. Some of the popular metrics here include: Pearson correlation coefficient, coefficient of determination (R\u00b2), Spearman\u2019s rank correlation coefficient, p-value, and more\u00b2. Here we briefly introduce correlation coefficient, and R-squared.", "Pearson correlation coefficient is perhaps one of the most popular metrics in the whole statistics and machine learning area. Its application is so broad that is used in almost every aspects of statistical modeling, from feature selection and dimensionality reduction, to regularization and model evaluation and beyond\u00b3.", "Correlation coefficient of two random variables (or any two vector/matrix) shows their statistical dependence.", "The linear correlation coefficient of two random variable X and Y is defined as below:", "Here \\mu and \\sigma denote the mean and standard variation of each variable, respectively.", "In most cases the underlying statistical distribution of variables are not known, and all we have is a N sample of that random variable (you can think of it as an N-dimensional vector). In those cases, we can use the Sample correlation coefficient of two N-dimensional vectors X, and Y, as below:", "The correlation coefficient of two variables is always a value in [-1,1]. Two variables are known to be independent if and only if their correlation is 0.", "Coefficient of determination or R\u00b2, is formally defined as the proportion of the variance in the dependent variable that is predictable from the independent variable(s).", "To better understand what this means, let\u2019s assume a dataset has N samples with corresponding target values of y_1, y_2, \u2026, y_N. Let\u2019s assume the corresponding predicted values of these samples by our model have values of f_1, f_2, \u2026, f_N.", "Now we can define the below terms that are going to be used to calculate R\u00b2:", "Then the most general definition of R\u00b2 can be written as below:", "In the best case, the modeled values exactly match the observed values, which results in R\u00b2=1. A model which always predicts the mean value of the observed data would have an R\u00b2=0.", "In this post, I provided an introduction to 5popular metrics used for evaluating the performance of ranking and statistical models. In the next part of this post, I am going to provide an introduction to 5 more advanced metrics used for assessing the performance of Computer Vision, NLP, and Deep Learning Models.", "[1] Christopher M. Bishop, \u201cPattern recognition and machine learning\u201d, springer, 2006.", "[2] Jerome Friedman, Trevor Hastie, and Robert Tibshirani. \u201cThe elements of statistical learning\u201d, Springer series in statistics, 2001.", "[3] Tilo Strutz, \u201cData fitting and uncertainty: A practical introduction to weighted least squares and beyond\u201d, Vieweg and Teubner, 2010.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F22c3e5a937b6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shervin.minaee?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shervin.minaee?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": "Shervin Minaee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1ac480820908&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&user=Shervin+Minaee&userId=1ac480820908&source=post_page-1ac480820908----22c3e5a937b6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F22c3e5a937b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F22c3e5a937b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----22c3e5a937b6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----22c3e5a937b6---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/statistics?source=post_page-----22c3e5a937b6---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----22c3e5a937b6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----22c3e5a937b6---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F22c3e5a937b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&user=Shervin+Minaee&userId=1ac480820908&source=-----22c3e5a937b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F22c3e5a937b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&user=Shervin+Minaee&userId=1ac480820908&source=-----22c3e5a937b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F22c3e5a937b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F22c3e5a937b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----22c3e5a937b6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----22c3e5a937b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shervin.minaee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shervin.minaee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shervin Minaee"}, {"url": "https://medium.com/@shervin.minaee/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "544 Followers"}, {"url": "https://sites.google.com/site/shervinminaee/home", "anchor_text": "https://sites.google.com/site/shervinminaee/home"}, {"url": "https://bit.ly/36ubOCf", "anchor_text": "https://bit.ly/36ubOCf"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1ac480820908&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&user=Shervin+Minaee&userId=1ac480820908&source=post_page-1ac480820908--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3476ec30fee8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6&newsletterV3=1ac480820908&newsletterV3Id=3476ec30fee8&user=Shervin+Minaee&userId=1ac480820908&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}