{"url": "https://towardsdatascience.com/analyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3", "time": 1683008543.900081, "path": "towardsdatascience.com/analyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3/", "webpage": {"metadata": {"title": "Analyzing seasonality using Fourier transforms | Towards Data Science", "h1": "Analyzing seasonality with Fourier transforms using Python & SciPy", "description": "The Fourier transform is a valuable data analysis tool to analyze seasonality and remove noise in time-series data. We can leverage Python and SciPy.FFT."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mchirico/montcoalert", "anchor_text": "911 phone call data", "paragraph_index": 1}, {"url": "https://www.youtube.com/watch?v=spUNpyF58BY", "anchor_text": "Visual Introduction to the Fourier Transform", "paragraph_index": 5}, {"url": "https://github.com/Kommandat/seasonality-fourier-analysis", "anchor_text": "Github repo", "paragraph_index": 6}, {"url": "https://github.com/Kommandat/seasonality-fourier-analysis/blob/master/notebooks/Part%201%20-%20Seasonality%20Analysis%20with%20scipy.fft.ipynb", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://www.kaggle.com/mchirico/montcoalert", "anchor_text": "Kaggle", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Nyquist_rate", "anchor_text": "Nyquist rate", "paragraph_index": 7}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.periodogram.html", "anchor_text": "periodogram", "paragraph_index": 11}], "all_paragraphs": ["As the saying goes, history repeats itself. Understanding these patterns helps us make smarter and more prepared decisions. The challenge is separating the pattern from the noise surrounding it. We can use the Fourier transform, commonly used by engineers, to accomplish exactly that\u2014separate signal from noise.", "Today, let\u2019s analyze 911 phone call data from Montgomery County, PA. We\u2019re looking to answer whether there are higher or lower levels of 911 calls during:", "Based on the results, we can make decisions on how to staff our 911 call center. For example, if we find that call volume is highest on Friday evenings, we can offer more shifts on Friday evenings so our call center can handle the higher call volume.", "The Fourier transform allows you to transform a function of time and signal into a function of frequency and power. This tells you what frequencies make up your signal and how strong they are. In our case, the signal is the number of phone calls and we might be expecting some kind of weekly or daily frequencies.", "Real data often contains noise and the Fourier transform lets us see through the noise, and see which frequencies actually matter.", "This article won\u2019t delve into the mathematics and derivation of Fourier transform here. If you\u2019re interested, I recommend watching 3Blue1Brown\u2019s Visual Introduction to the Fourier Transform after completing this exercise. I recommend doing this exercise first because Fourier Transforms are one of those concepts where starting with a practical example will help you appreciate the mathematics behind it.", "First, let\u2019s import and prep the call data. To follow along, you can clone this Github repo and follow the instructions there. The code is here. The raw data is from Kaggle.", "For the data prep, let\u2019s transforming the raw data to count the number of calls each hour. We\u2019re aggregating call count at the hour level because call volume at the minute-level is too low and we\u2019re not expecting to see any seasonality below the hour-level. As a rule of thumb, you want your sampling frequency to be twice the highest component frequency you\u2019re expecting to find in the signal. If your frequency is any lower, a condition called aliasing occurs and distorts your results. The minimum frequency where you meet the \u201c2\u00d7 highest component frequency\u201d rule is referred to as the Nyquist rate. Intuitively, this concept makes sense because we can\u2019t count phone calls per day to answer how the hour of the day impacts phone call volume.", "Also, we need to make sure we fill in any missing hours (where there were no 911 calls) with zeros. Finally, for the signal, let\u2019s chart the difference from the average call count instead of the call count itself. This way, our data is centered around 0, like a real sine wave.", "The first week of data is plotted on the right. Definitely seeing some seasonality here, so it looks like our analysis will be promising.", "We\u2019ll be using the Fourier Transforms submodule in the SciPy package\u2014scipy.fft. We\u2019ll be using the SciPy Fast Fourier Transform (scipy.fft.fft) function to compute the Fourier Transform. If you\u2019re familiar with sorting algorithms, think of the Fast Fourier Transform (FFT) as the Quicksort of Fourier Transforms. FFT is a more efficient way to compute the Fourier Transform and it\u2019s the standard in most packages.", "Just pass your input data into the function and it\u2019ll output the results of the transform. For the amplitude, take the absolute value of the results. To get the corresponding frequency, we use scipy.fft.fftfreq. We can chart the amplitude vs. the frequency. The frequencies with the highest amplitude are indicative of seasonal patterns. Frequencies with low amplitude are noise. Also, scipy\u2019s periodogram function can also get you to a similar chart. Let\u2019s mark the frequencies where we clearly see spikes in amplitude.", "If we look at those frequencies with the highest amplitudes and convert them into hours and days, we see that the top seasonal pattern has a daily frequency (the period is ~1 day).", "After that, the amplitude sharply drops off and we see seasonality at 8 hours and 7 days. The former suggests there\u2019s a spike in call volume 3 times a day (potentially morning, evening, and late-night?). The latter suggests that call volume spikes one day out of the week.", "The other frequencies are difficult to contextualize, but they\u2019re not very important given their low amplitudes.", "Our analysis isn\u2019t too actionable so far. We know there\u2019s daily seasonality, but don\u2019t know what time of day actually has higher seasonality. To figure this out, we can use the inverse Fourier transform. In theory, this should let us convert our filtered results and view just the signal.", "Here\u2019s what that looks like if we chart the filtered signal over the original signal for the first 5 days of data.", "Looks promising! The peaks in the filtered signal line up with the original signal around 5 pm. The problem is that when we stretch this out to the last week of data, the peaks start occurring at 11 am instead.", "So what gives? The problem is that our frequency wasn\u2019t exactly once every 24 hours. It was actually once every 23.996 hours, and over the course of the entire dataset, that small deviation adds up.", "So we\u2019ve answered our initial questions around what kind of seasonality is in the data, but we haven\u2019t been able to answer when seasonality spikes accurately. To take our analysis to the next level, we need to incorporate seasonality into our regression models.", "This will help us figure out when seasonality spikes by trying different inputs inspired by our Fourier results. Additionally, this will allow us to combine seasonality with other variables in our regression model so we can predict future call volume more accurately. We\u2019ll also see how seasonality is often used as a way to explain the residuals in a regression model.", "To learn more about analyzing seasonality, check out the article linked below, where I go over how to use Fourier analysis in your regression models.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software, math & data @ Jump Trading"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbb46945a23d3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lakshayakula?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lakshayakula?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": "Lakshay Akula"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc7b8c98889f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&user=Lakshay+Akula&userId=c7b8c98889f8&source=post_page-c7b8c98889f8----bb46945a23d3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb46945a23d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb46945a23d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/mchirico/montcoalert", "anchor_text": "911 phone call data"}, {"url": "https://www.youtube.com/watch?v=spUNpyF58BY", "anchor_text": "Visual Introduction to the Fourier Transform"}, {"url": "https://github.com/Kommandat/seasonality-fourier-analysis", "anchor_text": "Github repo"}, {"url": "https://github.com/Kommandat/seasonality-fourier-analysis/blob/master/notebooks/Part%201%20-%20Seasonality%20Analysis%20with%20scipy.fft.ipynb", "anchor_text": "here"}, {"url": "https://www.kaggle.com/mchirico/montcoalert", "anchor_text": "Kaggle"}, {"url": "https://en.wikipedia.org/wiki/Nyquist_rate", "anchor_text": "Nyquist rate"}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.periodogram.html", "anchor_text": "periodogram"}, {"url": "https://towardsdatascience.com/how-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51", "anchor_text": "How to add Fourier terms to your regression & seasonality analysis (using Python & SciPy)Include seasonality in your regressions by using Fourier termstowardsdatascience.com"}, {"url": "https://www.youtube.com/watch?v=spUNpyF58BY", "anchor_text": "Visual Introduction to the Fourier Transform"}, {"url": "https://www.gaussianwaves.com/2015/11/interpreting-fft-results-obtaining-magnitude-and-phase-information/", "anchor_text": "How to interpret FFT results \u2014 obtaining magnitude and phase information"}, {"url": "https://www.khanacademy.org/science/electrical-engineering/ee-signals/ee-fourier-series/v/ee-fourier-series-intro", "anchor_text": "Khan Academy\u2014Fourier Series"}, {"url": "https://github.com/Kommandat/seasonality-fourier-analysis/blob/master/notebooks/Part%201%20-%20Seasonality%20Analysis%20with%20scipy.fft.ipynb", "anchor_text": "Project code on Github"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bb46945a23d3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----bb46945a23d3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data?source=post_page-----bb46945a23d3---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/programming?source=post_page-----bb46945a23d3---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----bb46945a23d3---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb46945a23d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&user=Lakshay+Akula&userId=c7b8c98889f8&source=-----bb46945a23d3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb46945a23d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&user=Lakshay+Akula&userId=c7b8c98889f8&source=-----bb46945a23d3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb46945a23d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbb46945a23d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bb46945a23d3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bb46945a23d3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bb46945a23d3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bb46945a23d3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bb46945a23d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lakshayakula?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lakshayakula?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lakshay Akula"}, {"url": "https://medium.com/@lakshayakula/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "339 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc7b8c98889f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&user=Lakshay+Akula&userId=c7b8c98889f8&source=post_page-c7b8c98889f8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa592a2cd2d01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3&newsletterV3=c7b8c98889f8&newsletterV3Id=a592a2cd2d01&user=Lakshay+Akula&userId=c7b8c98889f8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}