{"url": "https://towardsdatascience.com/logging-with-weights-biases-da048e3cbc8b", "time": 1683011075.108882, "path": "towardsdatascience.com/logging-with-weights-biases-da048e3cbc8b/", "webpage": {"metadata": {"title": "Logging with Weights & Biases. Monitoring your Neural Network\u2019s\u2026 | by Abdur Rahman Kalim | Towards Data Science", "h1": "Logging with Weights & Biases", "description": "Logging the loss and accuracy curves has never been an easy job. We often save these values in arrays or lists and then plot them at the end of the training. Sharing these graphs is even harder where\u2026"}, "outgoing_paragraph_urls": [{"url": "https://wandb.auth0.com/login?state=g6Fo2SBWYmVrejBYbGQ3SDlfZWFJLV9TakdTdjltcEJHODFYSaN0aWTZIHlmdUZmTm9iWmxPUXFHOVhITW92dTczWm4yRUdkdGtlo2NpZNkgVlNNNTdVQ3dUOXdiR1N4S3RFREdRSElLQUJIcHB6SXc&client=VSM57UCwT9wbGSxKtEDGQHIKABHppzIw&protocol=oauth2&redirect_uri=https%3A%2F%2Fapp.wandb.ai%2Flogin&audience=https%3A%2F%2Fwandb.auth0.com%2Fuserinfo&scope=openid%20profile%20email&response_type=code&response_mode=query&nonce=bVJhM3dxQUdvLmZneGtIc3RsWXc0NHY0LXI4a0pYMG9GbEJ1dkdoR3FOMw%3D%3D&code_challenge=89lhVADKBMvrdZTZry4gBB25YCLzGH0hQnW153qUqC4&code_challenge_method=S256&auth0Client=eyJuYW1lIjoiYXV0aDAtc3BhLWpzIiwidmVyc2lvbiI6IjEuOS4wIn0%3D", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://colab.research.google.com/drive/1X99lDIZt6fM1DCNWA65xnr7dW6qNvxbh?usp=sharing", "anchor_text": "Colab Notebook", "paragraph_index": 10}], "all_paragraphs": ["Logging the loss and accuracy curves has never been an easy job. We often save these values in arrays or lists and then plot them at the end of the training. Sharing these graphs is even harder where sending screenshots of these graphs seems the only choice. In this tutorial, we will address this issue with Weights & Biases.", "Weights & Biases (WandB) is a python package that allows us to monitor our training in real-time. It can be easily integrated with popular deep learning frameworks like Pytorch, Tensorflow, or Keras. Additionally, it allows us to organize our Runs into Projects where we can easily compare them and identify the best performing model. In this guide, we will learn how to use WandB for logging.", "First, let\u2019s create a free WandB account here. WandB provides a 200GB limited storage on the free account, where we can log graphs, images, videos, and much more.", "Running the code snippet below will install WandB to our Colab Notebook instance. After installing and importing WandB, it will prompt us to authenticate the same way as we do when mounting Google Drive to the notebook instance.", "In this tutorial, we will train a Convolutional Neural Network on Fashion MNIST Dataset which is available in PyTorch\u2019s torchvision.datasets. We will split the datasets into batches and shuffle them before feeding them to our Neural Network. For simplicity, we will not use any data augmentation except transforming the images and labels into torch tensors.", "We will use a simple Convolutional Neural Network with 2 Conv layers and 3 Linear layers. In the input Conv layer, we will keep the input channel count as 1 for the neural network to accept grayscale images. Similarly, in the final hidden layer, the output channel count should be 10 for the model to output scores for each of the 10 classes.", "Before training, we must run wandb.init(). This will initialize a new Run in the WandB database. wandb.init() has the following parameters:", "Any hyperparameter that we want to log can be defined as an attribute of wandb.config. Note that wandb.config should be used to log only those values which do not change during training. Here, we have logged the learning rate using this method.", "Logging weight histograms is as simple as calling wandb.watch() and passing the network object as the argument.", "At the end of each epoch, we can log the loss and accuracy values using wandb.log(). This method takes a dictionary, mapping names (string) with the corresponding values, as the argument. Note that this method is called at the end of every epoch.", "The complete training code is given below. Please note that train and validate are two helper functions that are defined in the Colab Notebook.", "Now that our model is training, we can view the training graphs in real-time. Before the training starts, the Run Link and Project Link will be printed in the cell output. Click on the Run Link to get redirected to the Run page. There, you can see the live graphs (the graphs will keep updating as the model trains). Please note that the graphs are interactive, we can merge multiple graphs, smoothen them, change the color or legends, and much more.", "Recall that we are logging the network weight histograms as well. These can be viewed under the histogram section.", "We can easily compare multiple Runs in the same project using a Parallel Coordinate Chart. It represents the model\u2019s performance, in terms of minimum loss or maximum accuracy, with the neural network\u2019s hyperparameters. This tool proves to be very powerful when dealing with a large number of Runs. It provides a deeper insight into how each hyperparameter affects the model\u2019s performance.", "We can also go to the project page and compare the accuracy and loss curves of selected or all the Runs within that project. The screenshot below shows one of my projects.", "Sharing your model\u2019s training graphs with WandB is as simple as sharing the Run Link or Project Link, just make sure that the project is public for others to view. People with the Project Link or Run Link can view the live graphs too. Isn\u2019t that cool!", "This guide taught us how to use Weights & Biases to monitor our model\u2019s training and also how to share your Runs with others.", "To explore WandB further, check out the links below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Education | Technology | Productivity | Artificial Intelligence | Data Science | Deep Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fda048e3cbc8b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://abdur-rahman-kalim.medium.com/?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": ""}, {"url": "https://abdur-rahman-kalim.medium.com/?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": "Abdur Rahman Kalim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79cf1f77d930&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=post_page-79cf1f77d930----da048e3cbc8b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda048e3cbc8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda048e3cbc8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@isaacmsmith?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Isaac Smith"}, {"url": "https://unsplash.com/s/photos/graphs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://wandb.auth0.com/login?state=g6Fo2SBWYmVrejBYbGQ3SDlfZWFJLV9TakdTdjltcEJHODFYSaN0aWTZIHlmdUZmTm9iWmxPUXFHOVhITW92dTczWm4yRUdkdGtlo2NpZNkgVlNNNTdVQ3dUOXdiR1N4S3RFREdRSElLQUJIcHB6SXc&client=VSM57UCwT9wbGSxKtEDGQHIKABHppzIw&protocol=oauth2&redirect_uri=https%3A%2F%2Fapp.wandb.ai%2Flogin&audience=https%3A%2F%2Fwandb.auth0.com%2Fuserinfo&scope=openid%20profile%20email&response_type=code&response_mode=query&nonce=bVJhM3dxQUdvLmZneGtIc3RsWXc0NHY0LXI4a0pYMG9GbEJ1dkdoR3FOMw%3D%3D&code_challenge=89lhVADKBMvrdZTZry4gBB25YCLzGH0hQnW153qUqC4&code_challenge_method=S256&auth0Client=eyJuYW1lIjoiYXV0aDAtc3BhLWpzIiwidmVyc2lvbiI6IjEuOS4wIn0%3D", "anchor_text": "here"}, {"url": "https://colab.research.google.com/drive/1X99lDIZt6fM1DCNWA65xnr7dW6qNvxbh?usp=sharing", "anchor_text": "Colab Notebook"}, {"url": "https://www.wandb.com/", "anchor_text": "Weights & Biases WebsiteFor more information on Weights & Biaseswww.wandb.com"}, {"url": "https://docs.wandb.com/", "anchor_text": "Weights & Biases Documentationdocs.wandb.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----da048e3cbc8b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----da048e3cbc8b---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----da048e3cbc8b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----da048e3cbc8b---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/data-science?source=post_page-----da048e3cbc8b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda048e3cbc8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=-----da048e3cbc8b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda048e3cbc8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=-----da048e3cbc8b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda048e3cbc8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fda048e3cbc8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----da048e3cbc8b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----da048e3cbc8b--------------------------------", "anchor_text": ""}, {"url": "https://abdur-rahman-kalim.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://abdur-rahman-kalim.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abdur Rahman Kalim"}, {"url": "https://abdur-rahman-kalim.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "129 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79cf1f77d930&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=post_page-79cf1f77d930--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7fa3b489e8e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogging-with-weights-biases-da048e3cbc8b&newsletterV3=79cf1f77d930&newsletterV3Id=7fa3b489e8e7&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}