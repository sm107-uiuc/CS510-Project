{"url": "https://towardsdatascience.com/training-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555", "time": 1683006152.641151, "path": "towardsdatascience.com/training-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555/", "webpage": {"metadata": {"title": "Training EfficientDet Object Detection Model with a Custom Dataset | by Jacob Solawetz | Towards Data Science", "h1": "Training EfficientDet Object Detection Model with a Custom Dataset", "description": "***NOTE: YOLOv5 has been published. If you\u2019re here for EfficientDet in particular, stay for EfficientDet. Otherwise consider running the YOLOv5 PyTorch tutorial in Colab. You\u2019ll have a very\u2026"}, "outgoing_paragraph_urls": [{"url": "https://blog.roboflow.ai/how-to-train-yolov5-on-a-custom-dataset/", "anchor_text": "YOLOv5 PyTorch tutorial in Colab", "paragraph_index": 0}, {"url": "https://blog.roboflow.ai/how-to-train-yolov5-on-a-custom-dataset/", "anchor_text": "Train YOLOv5", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1911.09070", "anchor_text": "published EfficientDet,", "paragraph_index": 1}, {"url": "https://blog.roboflow.ai/training-efficientdet-object-detection-model-with-a-custom-dataset/", "anchor_text": "how to train EfficientDet", "paragraph_index": 2}, {"url": "https://colab.research.google.com/drive/1ZmbeTro4SqT7h_TfW63MLdqbrCUk_1br#scrollTo=KwDS9qqBbMQa", "anchor_text": "EfficientDet Training Colab Notebook", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1905.11946.pdf", "anchor_text": "EfficientNet", "paragraph_index": 5}, {"url": "https://public.roboflow.ai/object-detection/chess-full", "anchor_text": "chess data is available on Roboflow", "paragraph_index": 12}, {"url": "https://colab.research.google.com/drive/1ZmbeTro4SqT7h_TfW63MLdqbrCUk_1br#scrollTo=KwDS9qqBbMQa", "anchor_text": "EfficientDet Colab Notebook", "paragraph_index": 16}, {"url": "https://github.com/signatrix/efficientdet", "anchor_text": "signatrix", "paragraph_index": 18}, {"url": "https://roboflow.ghost.io/ghost/#/editor/post/5e98c6df166ca80038cb25d7", "anchor_text": "break down the architecture of EfficientDet", "paragraph_index": 24}], "all_paragraphs": ["***NOTE: YOLOv5 has been published. If you\u2019re here for EfficientDet in particular, stay for EfficientDet. Otherwise consider running the YOLOv5 PyTorch tutorial in Colab. You\u2019ll have a very performant, trained YOLOv5 model on your custom data in a matter of minutes. Train YOLOv5.", "The Google Brain team recently published EfficientDet, rethinking model scaling for convolutional neural networks. In this post, we provide a tutorial of how to train and use EfficientDet on your own data, with varying number of classes.", "For the original posting: please see this blog post on how to train EfficientDet.", "If you want to get right into the code implementation, jump to our EfficientDet Training Colab Notebook. Colab is free to use and provides a python programming environment equipped with GPU compute resources.", "In the tasks we\u2019ve seen (and as of April 2020), EfficientDet achieves the best performance in the fewest training epochs among object detection model architectures, making it a highly scalable architecture especially when operating with limited compute. This is consistent with the results the EfficientDet authors published.", "EfficientDet is the object detection version of EfficientNet, building on the success EfficientNet has seen in image classification tasks. EfficientNets come from a family of models that achieve a high performance on benchmark tasks while controlling for a number of efficiency parameters, such as model size and FLOPS. The network is delivered in a series of model sizes d0-d7, and the base model is thought to perform better than YOLOv3 with a smaller model size (more to come on this soon).", "In this post, we explore a PyTorch implementation of EfficientNet on a custom dataset, demonstrating how you can do the same for your own dataset.", "Our dataset contains 292 images of chess pieces on a chess board. Each chess piece is labeled with a bounding box describing the pieces class {white-knight, white-pawn, black-queen,\u2026}. Our custom dataset has 12 total classes, which does not match the number of classes in COCO where training occurred. No worries! The model architecture will seamlessly adapt to the number of classes that your custom dataset contains.", "Going straight from data collection to model training leads to suboptimal results. There may be problems with the data. Even if there aren\u2019t, applying image augmentation expands your dataset and reduces overfitting.", "Preparing images for object detection includes, but is not limited to:", "Similar to tabular data, cleaning and augmenting image data can improve your ultimate model\u2019s performance more than architectural changes in your model.", "Roboflow Organize is purpose-built to seamlessly solve these challenges. In fact, Roboflow Organize cuts the code you need to write roughly in half while giving you access to more preprocessing and augmentations options.", "For our specific chess problem, our already preprocessed chess data is available on Roboflow.", "Either fork this dataset to your free Roboflow account, or create a download in COCO JSON format.", "After selecting our annotation format, Roboflow provides a curl script (\u201cShow Download Code\u201d) where we can access our data set.", "We can then use this curl script to import our data into the Colab notebook that we are working in. Colab is a Jupyter Notebook python programming environment provided by Google and provisioned with free GPU usage. Colab is free to start, but may time out on you if your notebook sits idle for 15 minutes or so.", "Jump to our EfficientDet Colab Notebook.", "Once our data has downloaded we will inspect the folder structure. The Coco json data comes down in train, validate, test splits that we have determined in our data set up in Roboflow. Inspecting the train folder, we see that our data has come down as a set of images and an annotation file. We then make file structure in a fashion that our model will be expecting, but no additional data cleaning is required!", "For training, we import a pytorch implementation of EfficientDet courtesy of signatrix. Our implementation uses the base version of EfficientDet-d0. We train from the EfficientNet base backbone, without using a pre-trained checkpoint for the detector portion of the network. We train for 20 epochs across our training set. The implementation naturally adapts to the number of training classes, which is a nice comparison to the original network release in TensorFlow.", "During training, our model saves .onnx files that can be easily called during inference time. We call these files to set up an infer detector and simply pass an image, our list of classes, and a prediction threshold through to our inferencer. The prediction threshold can be adjusted dynamically to control for precision and recall according to your use case.", "We witness a fast inference time and according to a few test images it looks like the network quickly adapted to our custom image detection problem!", "We export our trained model\u2019s .onxx files to Google Drive for future use. You can simply pull those files back down and rebuild the inferencer for your application!", "At the bottom of the notebook, we provide an example of how you can pull trained model weights back down and use them for inference in your application. In a future post, we will provide more detail on how to use EfficientDet in your application.", "And there you have it \u2014 a quick and easy way to begin prototyping EffienctDet on your own data, for your own custom use case, with a varying number of classes.", "We will be comparing more granular evaluations of the EfficientDet model compared to YoloV3 including training time, model size, memory footprint, and inference time in future blog posts. We also plan to break down the architecture of EfficientDet to better understand how the magic happens.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning @ Roboflow \u2014 building tools and artifacts like this one to help practitioners solve computer vision."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F25fb0f190555&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----25fb0f190555--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25fb0f190555--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jacobsolawetz.medium.com/?source=post_page-----25fb0f190555--------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=post_page-----25fb0f190555--------------------------------", "anchor_text": "Jacob Solawetz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f06d25ec2e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=post_page-5f06d25ec2e8----25fb0f190555---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25fb0f190555&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25fb0f190555&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://blog.roboflow.com/the-ultimate-guide-to-object-detection/", "anchor_text": "custom object detection task"}, {"url": "https://blog.roboflow.ai/training-efficientdet-object-detection-model-with-a-custom-dataset/", "anchor_text": "how to train EfficientDet on your own dataset"}, {"url": "https://blog.roboflow.ai/how-to-train-yolov5-on-a-custom-dataset/", "anchor_text": "YOLOv5 PyTorch tutorial in Colab"}, {"url": "https://blog.roboflow.ai/how-to-train-yolov5-on-a-custom-dataset/", "anchor_text": "Train YOLOv5"}, {"url": "https://arxiv.org/abs/1911.09070", "anchor_text": "published EfficientDet,"}, {"url": "https://blog.roboflow.ai/training-efficientdet-object-detection-model-with-a-custom-dataset/", "anchor_text": "how to train EfficientDet"}, {"url": "https://colab.research.google.com/drive/1ZmbeTro4SqT7h_TfW63MLdqbrCUk_1br#scrollTo=KwDS9qqBbMQa", "anchor_text": "EfficientDet Training Colab Notebook"}, {"url": "https://github.com/google/automl/tree/master/efficientdet", "anchor_text": "Source"}, {"url": "https://arxiv.org/pdf/1905.11946.pdf", "anchor_text": "EfficientNet"}, {"url": "https://news.ycombinator.com/item?id=21207411", "anchor_text": "see more"}, {"url": "https://www.tensorflow.org/tutorials/load_data/tfrecord", "anchor_text": "TFRecords for TensorFlow"}, {"url": "https://github.com/qqwweee/keras-yolo3", "anchor_text": "implementations of YOLO"}, {"url": "https://public.roboflow.ai/object-detection/chess-full", "anchor_text": "chess data is available on Roboflow"}, {"url": "https://colab.research.google.com/drive/1ZmbeTro4SqT7h_TfW63MLdqbrCUk_1br#scrollTo=KwDS9qqBbMQa", "anchor_text": "EfficientDet Colab Notebook"}, {"url": "https://github.com/signatrix/efficientdet", "anchor_text": "signatrix"}, {"url": "https://roboflow.ghost.io/ghost/#/editor/post/5e98c6df166ca80038cb25d7", "anchor_text": "break down the architecture of EfficientDet"}, {"url": "https://medium.com/tag/custom-dataset?source=post_page-----25fb0f190555---------------custom_dataset-----------------", "anchor_text": "Custom Dataset"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----25fb0f190555---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----25fb0f190555---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----25fb0f190555---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----25fb0f190555---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25fb0f190555&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=-----25fb0f190555---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25fb0f190555&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=-----25fb0f190555---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25fb0f190555&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25fb0f190555--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F25fb0f190555&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----25fb0f190555---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----25fb0f190555--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----25fb0f190555--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----25fb0f190555--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----25fb0f190555--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----25fb0f190555--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----25fb0f190555--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----25fb0f190555--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----25fb0f190555--------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jacob Solawetz"}, {"url": "https://jacobsolawetz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "513 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f06d25ec2e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=post_page-5f06d25ec2e8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbdaf42b583ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-efficientdet-object-detection-model-with-a-custom-dataset-25fb0f190555&newsletterV3=5f06d25ec2e8&newsletterV3Id=bdaf42b583ae&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}