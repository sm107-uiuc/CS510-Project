{"url": "https://towardsdatascience.com/how-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5", "time": 1682997358.786078, "path": "towardsdatascience.com/how-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5/", "webpage": {"metadata": {"title": "How to deal with Uncertainty in the era of Deep Learning | by Dirk Elsinghorst | Towards Data Science", "h1": "How to deal with Uncertainty in the era of Deep Learning", "description": "When it comes to critical decision-making, you should better be sure that you can trust your model\u2019s prediction. TensorFlow introduces a new library to take uncertainty into account."}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/probability", "anchor_text": "TensorFlow Probability", "paragraph_index": 11}, {"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/layers/DistributionLambda", "anchor_text": "tfp.layers.DistributionLambda", "paragraph_index": 14}, {"url": "https://www.tensorflow.org/probability", "anchor_text": "TensorFlow Probability", "paragraph_index": 14}, {"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/Distribution", "anchor_text": "tfp.distributions.Distribution", "paragraph_index": 14}, {"url": "https://gist.github.com/de-eplearn/ff643168e48de5ada255b23b22627521", "anchor_text": "jupyter notebook", "paragraph_index": 24}, {"url": "https://www.tensorflow.org/probability", "anchor_text": "Tensorflow Probablity", "paragraph_index": 24}, {"url": "https://medium.com/tensorflow/regression-with-probabilistic-layers-in-tensorflow-probability-e46ff5d37baf", "anchor_text": "blog post", "paragraph_index": 24}, {"url": "https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter1_Introduction/Ch1_Introduction_TFP.ipynb", "anchor_text": "rewritten version", "paragraph_index": 24}, {"url": "https://camdavidsonpilon.github.io/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/#tensorflow", "anchor_text": "Bayesian Methods for Hackers", "paragraph_index": 24}, {"url": "https://www.tensorflow.org/probability", "anchor_text": "Tensorflow Probablity", "paragraph_index": 25}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 25}, {"url": "https://medium.com/@dirk.elsinghorst", "anchor_text": "Medium", "paragraph_index": 27}, {"url": "https://www.linkedin.com/in/dirk-elsinghorst/", "anchor_text": "LinkedIn", "paragraph_index": 27}], "all_paragraphs": ["Recently no day goes by without a publication of a new outstanding machine learning application, most likely powered by some deep learning model. Beneath the surface hundreds of thousands of companies applying the same technology to all kinds of different processes. At the latest when it supports critical decision-making, you should think about the degree of certainty that comes with every prediction. We will go through why that is, how to define uncertainty and eventually look at some code examples so that you will be able to apply our findings in your next project.", "Let\u2019s do a thought experiment. Imagine you\u2019re a company that organizes safaris, and you want to create a safer experience for clients in their adventures. As a machine learning engineer your objective could be to create an image classifier that labels surrounding animals as \u201cpotentially dangerous\u201d, or as \u201clikely harmless\u201d. This program would allow the customer to feel safe, and give them the precautions if necessary.", "Luckily you installed month ago cameras on all your vehicles so that you now have a ton of images of zebras, snakes, giraffes, etc. You start right away training your neural network. First evaluations are showing that your model is performing quite well, detecting all kinds of snakes as potentially dangerous and zebras as harmless.", "\u201cThat\u2019s great\u201d, you think, \u201cbut what if I use this model in practice and an animal that was underrepresented or even completely absent in the data shows up in front of my cameras?\u201d", "Well, the model is forced to decide on one of the two possible outcomes even though it actually does not have a clue. Imagine further in this case the (almost) unknown animal would be a tiger. Maybe the model would locate the photo in its internal representation due to certain similarities (stripes, four legs, etc.) closer to a zebra than to a predator and as a result misclassify the situation.", "Wouldn\u2019t it be nice if the model were able to communicate its uncertainty and because you are primarily interested in your clients safety you could calibrate your system to react defensively when in doubt?", "There are many causes for prediction uncertainty but from our modeling perspective it basically boils down into two categories. The easiest way to think of it is as data and model related uncertainty.", "The former is probably the more obvious one. Whenever you are taking multiple measurements under the same circumstances, it\u2019s still quite unlikely to get every time the exact same result. Why is that? For several reasons: If you are using a sensor, every device itself has its accuracy, precision, resolution, etc. In case of a manual lab sample the used technique, personal skill and experience playing their roles. Basically every aspect of the measurement that is unknown and hence introduces some kind of randomness falls in this category.", "If you are able to reduce aleatoric uncertainty depends on how much influence you have on the way your data is collected.", "Now that we covered the uncertainty within the data, what about the model? It\u2019s not just a question of the model\u2019s capability to explain the given data but of how certain it is that the data incorporates all there is to know. Another way of looking at epistemic uncertainty is as a measure of how much an (infinite) ensemble of models would agree on the outcome. If multiple models come to strongly deviating conclusions, the data obviously did not paint the whole picture.", "High epistemic uncertainty can be caused for example by simple models that try to fit complex functions, too little or missing data, etc. That\u2019s where your experience as a modeler can shine. Is an important feature missing? Do you have underrepresented situations in your training data? Did you choose the right model?", "Since both types of uncertainty are not constant throughout all predictions, we need a way of assigning a specific uncertainty to each prediction. That\u2019s where the new TensorFlow Probability package steps in to save the day. It provides a framework that combines probabilistic modeling with the power of our beloved deep learning models.", "For demonstration purposes we will take a very simple regression problem with just one input and one output dimension. The two blobs of the training data differ in their standard deviation and between them is a space where we do not have any data. Will the model be able to consider and communicate these aspects in any meaningful way?", "We will take a two layer neural network. The first one takes the sigmoid and the second one the identity function as activation. So far, everything business as usual.", "The last missing step is the new tfp.layers.DistributionLambda layer from TensorFlow Probability. Instead of a tensor, it returns a tfp.distributions.Distribution which you can use to perform all the kind of operations you would expect from distributions, like sampling, deriving its mean or standard deviation, etc.", "Did you notice the two neurons in the second dense layer? They are needed to learn the output distribution\u2019s mean and standard deviation.", "You can see that by predicting a distribution instead of a single value we are getting closer to what we actually want to achieve. As mentioned earlier, the two blobs have different variances and the model does reflect that in its prediction. One could argue that for each blob the model predicts a constant variance in respect to the fitted mean curve which does not seem to match the data but this is due to the limited model complexity and will be resolved with increasing degrees of freedom.", "But what happens in between the two blobs? That\u2019s not what we expect from a measure of uncertainty in a space without data, right? Who says that in that space there isn\u2019t another so far unmeasured blob somewhere far away from the fitted function? Nobody; we just don\u2019t know. And neither does the model. Regardless, you should not be too surprised by the model\u2019s interpolation.", "After all, that\u2019s what models do: learning the function that best fits the known data and does not hurt this purpose where there is no data.", "So, how can we compensate for this lack of information? It turns out that we already covered the solution earlier: the consideration of epistemic uncertainty.", "The basic approach is to take the idea of using distributions instead of single variables one step further and apply it to all model parameters. Therefore, we take our example from before and substitute the two Keras dense layers with tfp.layers.DenseVariational layers. As a result the model does not only learn one set of weights and biases but sees all its parameters as random variables with more or less variance depending on how certain it is to have found the best fit. During inference the model samples from the parameter distributions which leads to different predictions for each run. Hence, one has to run inference several times and calculate the overall mean and standard deviation.", "How does this upgraded version of our model work with our toy data? We can see that it still reflects the different variances close to the two blobs although they both seem to have increased. This actually makes sense since what we see is the sum of both, the aleatoric and epistemic uncertainty.", "Furthermore, in between the two data blobs the behavior changed more drastically: the model uncertainty, represented by the standard deviation, now spikes where we do not have any data available. This is exactly what we were hoping for.", "Let\u2019s take another look at our example and think about why that actually worked. To recap, the model is trying to find the function that best fits the data. Aren\u2019t there a lot of other functions which fit the data similarly well as the one in chart 4? For example, if you shift the curve slightly along the x-axis to the left or the right the loss won\u2019t change significantly. Therefore, the model parameter responsible for this shift has a wide distribution. Given the data the model is quite uncertain about this parameter.", "If you are interested in the complete code example, take a look at the jupyter notebook. It\u2019s based on the one the Tensorflow Probablity team published with their blog post on the same topic. In case you want to dive in even deeper, I recommend checking out the in a jupyter notebook rewritten version of the book Bayesian Methods for Hackers by Cameron Davidson-Pilon. I really like the interactive manner in which they present the content.", "We saw the importance of considering uncertainty in our models and how to overcome the challenges which come along with it by looking at a simple example using Tensorflow Probablity. Although the library is still quite young I expect it to become a serious grown up pretty soon as it offers an easy way to combine probabilistic modeling and deep learning by fitting in seamlessly with Keras.", "Hopefully it will become more and more common practice to pay attention to the model\u2019s reliability before deriving important decisions from its predictions. To see the arguably most widely used deep learning library laying the foundation to do so is at least a big step in the right direction.", "If you find this post helpful let me know your thoughts and experiences in the comments and don\u2019t forget to follow me on Medium and LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Still like a child: permanently testing, failing and learning | Machine Learning Engineer @ aquatune GmbH | a xylem brand"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F977decdf84b5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----977decdf84b5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----977decdf84b5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dirk.elsinghorst?source=post_page-----977decdf84b5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dirk.elsinghorst?source=post_page-----977decdf84b5--------------------------------", "anchor_text": "Dirk Elsinghorst"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe405704aed0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&user=Dirk+Elsinghorst&userId=e405704aed0a&source=post_page-e405704aed0a----977decdf84b5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F977decdf84b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F977decdf84b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@soltanloo?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Hossein Soltanloo"}, {"url": "https://unsplash.com/search/photos/out-of-focus?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@_smeet__?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Smit Patel"}, {"url": "https://unsplash.com/collections/2530039/white-tigers?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.tensorflow.org/probability", "anchor_text": "TensorFlow Probability"}, {"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/layers/DistributionLambda", "anchor_text": "tfp.layers.DistributionLambda"}, {"url": "https://www.tensorflow.org/probability", "anchor_text": "TensorFlow Probability"}, {"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/Distribution", "anchor_text": "tfp.distributions.Distribution"}, {"url": "https://gist.github.com/de-eplearn/ff643168e48de5ada255b23b22627521", "anchor_text": "jupyter notebook"}, {"url": "https://www.tensorflow.org/probability", "anchor_text": "Tensorflow Probablity"}, {"url": "https://medium.com/tensorflow/regression-with-probabilistic-layers-in-tensorflow-probability-e46ff5d37baf", "anchor_text": "blog post"}, {"url": "https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter1_Introduction/Ch1_Introduction_TFP.ipynb", "anchor_text": "rewritten version"}, {"url": "https://camdavidsonpilon.github.io/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/#tensorflow", "anchor_text": "Bayesian Methods for Hackers"}, {"url": "https://www.tensorflow.org/probability", "anchor_text": "Tensorflow Probablity"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://medium.com/@dirk.elsinghorst", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/dirk-elsinghorst/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----977decdf84b5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----977decdf84b5---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----977decdf84b5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/uncertainty?source=post_page-----977decdf84b5---------------uncertainty-----------------", "anchor_text": "Uncertainty"}, {"url": "https://medium.com/tag/probabilistic-programming?source=post_page-----977decdf84b5---------------probabilistic_programming-----------------", "anchor_text": "Probabilistic Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F977decdf84b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&user=Dirk+Elsinghorst&userId=e405704aed0a&source=-----977decdf84b5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F977decdf84b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&user=Dirk+Elsinghorst&userId=e405704aed0a&source=-----977decdf84b5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F977decdf84b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----977decdf84b5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F977decdf84b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----977decdf84b5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----977decdf84b5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----977decdf84b5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----977decdf84b5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----977decdf84b5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----977decdf84b5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----977decdf84b5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----977decdf84b5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----977decdf84b5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dirk.elsinghorst?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dirk.elsinghorst?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dirk Elsinghorst"}, {"url": "https://medium.com/@dirk.elsinghorst/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "34 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe405704aed0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&user=Dirk+Elsinghorst&userId=e405704aed0a&source=post_page-e405704aed0a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe405704aed0a%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-uncertainty-in-the-era-of-deep-learning-977decdf84b5&user=Dirk+Elsinghorst&userId=e405704aed0a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}