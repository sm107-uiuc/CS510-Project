{"url": "https://towardsdatascience.com/reinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b", "time": 1682996408.7811809, "path": "towardsdatascience.com/reinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b/", "webpage": {"metadata": {"title": "Reinforcement Learning \u2014 Multi-Arm Bandit Implementation | by Jeremy Zhang | Towards Data Science", "h1": "Reinforcement Learning \u2014 Multi-Arm Bandit Implementation", "description": "Multi-Arm Bandit is a classic reinforcement learning problem, in which a player is facing with k slot machines or bandits, each with a different reward distribution, and the player is trying to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/MJeremy2017/RL/blob/master/Multi-ArmBandit/bandit.py", "anchor_text": "code here", "paragraph_index": 1}, {"url": "http://incompleteideas.net/book/the-book-2nd.html", "anchor_text": "Reinforcement Learning: An Introduction", "paragraph_index": 6}, {"url": "https://github.com/MJeremy2017/RL/blob/master/Multi-ArmBandit/bandit.py", "anchor_text": "code here", "paragraph_index": 15}, {"url": "https://github.com/MJeremy2017/RL/blob/master/Multi-ArmBandit/bandit.py", "anchor_text": "code here", "paragraph_index": 18}], "all_paragraphs": ["Multi-Arm Bandit is a classic reinforcement learning problem, in which a player is facing with k slot machines or bandits, each with a different reward distribution, and the player is trying to maximise his cumulative reward based on trials.", "Let\u2019s strike into the problem directly. There are 3 key components in a reinforcement learning problem \u2014 state, action and reward. Let\u2019s recall the problem \u2014 k machines are placed in front of you, and in each episode, you choose one machine and pull the handle, by taking this action, you get a reward accordingly. So the state is the current estimation of all the machines, which is zeros for all in the beginning, the action is the machine you decide to choose at each episode, and the reward is the result or payout after you pull the handle. With these 3 items in our mind, we are able to write the init function of Bandit (check out code here):", "k is the number of bandits we hope to initialise, actions are represented as numbers, which each stands for the machine we are going to pick up, and we have exp_rate (exploration rate) and lr (learning rate) as usual to control exploration and value updating. total_reward and avg_reward are used to measure our result. The payout of each machine is a random value generated from normal distribution, and finally the initial estimates of values are set to 0.", "To identify the machine with the most reward, the straight forward way is to try, try as many times as possible until one has a certain confidence with each machine, and stick to the best estimated machine from onward. The thing is we probably can test in a wiser way. As our goal is to get the maximum reward along the way, we surely should not waste to much time on a machine that always gives a low reward, and on the other hand, even we come across a palatable reward of a certain machine, we should still be able to explore other machines in the hope of some not-explored-enough machines could give us a higher reward.", "So when it comes to choosing actions, we will explore to methods:", "We have talked about \u03f5-greedy many times, where we take random actions with \u03f5 probability and maximum action with 1 - \u03f5 probability. This makes a good balance between exploration and exploitation. Let\u2019s talk a bit on UCB which is based on the formula below:", "where lnt denotes the natural logarithm of t(the number that e = 2.71828would have to be raised to in order to equal t), Nt(a) denotes the number of times that action a has been selected prior to time t(the denominator in the formula, and the number c > 0controls the degree of exploration. If Nt(a)=0, then a is considered to be a maximising action. (From Reinforcement Learning: An Introduction)", "So as the number of trials increase, if a bandit has not yet been explored much, its Nt(a) will be small, thus the right side of the formula will be large. In this way, the formula helps to balance between the current estimation Q and exploration rate.", "To implement UCB, we need to add some variables into the init function:", "The self.times counts the total number of trials and self.action_times counts the number of actions for each bandit.", "Now we can put both \u03f5-greedy and UCB into our method chooseAction function:", "When self.ucb is turned on, we will choose action based on the formula. The self.action_times is added by 0.1 in case value divided by 0. If exp_rate if set to 0 and self.ucb is true, the action will be chosen purely by UCB, but if exp_rate > 0 , then we will have a hybrid method that mixes \u03f5-greedy and UCB.", "The takeAction function receives an action and updates estimates of that action after receiving a reward.", "As the problem described, each bandit\u2019s payout conforms to a certain distribution, thus we add some randomness to each true reward. After receiving the reward, the estimates will be updated by adding the difference between the current observation and previous estimation multiplied by a learning rate.", "And finally, we need a function to start playing.", "We init a 5-arm bandit and compare the average gain among different methods. (check out code here)", "This is the average reward over 2000 iterations using \u03f5-greedy method with different exploration rate. The 0.1 exploration rate surpass the 0.3 one when it converges.", "We add UCB method with different c values into comparison. Both the UCB method have exploration rate 0.1. From the result, we see that in general, UCB outperforms \u03f5-greedy, but it is also in general hard to apply UCB on many other problems beside bandit.", "Please check out full code here, and you are welcomed to contribute and raise issues!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hmm\u2026I am a data scientist looking to catch up the tide\u2026"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5399ef67b24b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://meatba11.medium.com/?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": "Jeremy Zhang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37783fc8c26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&user=Jeremy+Zhang&userId=f37783fc8c26&source=post_page-f37783fc8c26----5399ef67b24b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5399ef67b24b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5399ef67b24b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://blog.lightningai.com/multi-armed-bandits-are-the-new-a-b-tests-27dd7b48765b", "anchor_text": "k-armed bandit"}, {"url": "https://github.com/MJeremy2017/RL/blob/master/Multi-ArmBandit/bandit.py", "anchor_text": "code here"}, {"url": "http://incompleteideas.net/book/the-book-2nd.html", "anchor_text": "Reinforcement Learning: An Introduction"}, {"url": "https://github.com/MJeremy2017/RL/blob/master/Multi-ArmBandit/bandit.py", "anchor_text": "code here"}, {"url": "https://github.com/MJeremy2017/RL/blob/master/Multi-ArmBandit/bandit.py", "anchor_text": "code here"}, {"url": "http://incompleteideas.net/book/the-book-2nd.html", "anchor_text": "http://incompleteideas.net/book/the-book-2nd.html"}, {"url": "https://github.com/JaeDukSeo/reinforcement-learning-an-introduction", "anchor_text": "https://github.com/JaeDukSeo/reinforcement-learning-an-introduction"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5399ef67b24b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----5399ef67b24b---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/python3?source=post_page-----5399ef67b24b---------------python3-----------------", "anchor_text": "Python3"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5399ef67b24b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&user=Jeremy+Zhang&userId=f37783fc8c26&source=-----5399ef67b24b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5399ef67b24b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&user=Jeremy+Zhang&userId=f37783fc8c26&source=-----5399ef67b24b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5399ef67b24b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5399ef67b24b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5399ef67b24b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5399ef67b24b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5399ef67b24b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5399ef67b24b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5399ef67b24b--------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeremy Zhang"}, {"url": "https://meatba11.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37783fc8c26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&user=Jeremy+Zhang&userId=f37783fc8c26&source=post_page-f37783fc8c26--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcdbd8b83c584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-multi-arm-bandit-implementation-5399ef67b24b&newsletterV3=f37783fc8c26&newsletterV3Id=cdbd8b83c584&user=Jeremy+Zhang&userId=f37783fc8c26&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}