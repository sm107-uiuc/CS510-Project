{"url": "https://towardsdatascience.com/cityscape-segmentation-with-tensorflow-2-0-b320b6605cbf", "time": 1683001166.424884, "path": "towardsdatascience.com/cityscape-segmentation-with-tensorflow-2-0-b320b6605cbf/", "webpage": {"metadata": {"title": "Cityscape Image Segmentation With TensorFlow 2.0 | by Shubham Panchal | Towards Data Science", "h1": "Cityscape Image Segmentation With TensorFlow 2.0", "description": "Image Segmentation is a detection technique used in various computer vision applications. We actually \u201csegment\u201d a part of an image in which we are interested. In this story, we\u2019ll be creating a UNet\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "UNet", "paragraph_index": 0}, {"url": "https://www.analyticsvidhya.com/blog/2019/02/tutorial-semantic-segmentation-google-deeplab/", "anchor_text": "semantic segmentation", "paragraph_index": 0}, {"url": "https://www.kaggle.com/dansbecker/cityscapes-image-pairs", "anchor_text": "Cityscapes Image Pairs", "paragraph_index": 7}, {"url": "https://www.kaggle.com/dansbecker", "anchor_text": "DanB", "paragraph_index": 7}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle", "paragraph_index": 7}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/initializers/GlorotUniform", "anchor_text": "Glorot uniform initializer", "paragraph_index": 11}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adam", "anchor_text": "Adam optimizer", "paragraph_index": 16}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/losses/BinaryCrossentropy", "anchor_text": "Binary Crossentropy", "paragraph_index": 16}], "all_paragraphs": ["Image Segmentation is a detection technique used in various computer vision applications. We actually \u201csegment\u201d a part of an image in which we are interested. In this story, we\u2019ll be creating a UNet model for semantic segmentation ( not to be confused with instance segmentation \ud83d\ude15 ).", "You can check out the implementation for this story here ->", "Implementing UNet could be a bit easier if you are using TensorFlow Keras or PyTorch. In simple words,", "UNet has an encoder-decoder type of structure. The encoder takes in the image, performs various convolutions and max-pooling operations on the image and builds a latent representation of it. Now, the decoder takes this representation and upsamples the image ( with the help of skip connections ), finally giving us the segmentation mask.", "What makes UNet different from a Convolutional Autoencoder is that it has skip-connections \ud83d\ude0e. A skip-connection has the name suggests ( maybe ;-) ) preserves the spatial information for the decoder. Generally, the encoder breaks down the image into high-dimensional tensors ( like of shape [8, 8, 256 ] ). This may result in the loss of some important features. While we feed an image to the encoder. After every max-pooling operation ( in the encoder ), we store the result of the operation. Now, when we are performing transposed convolutions in the decoder, we concatenate the previous output ( from the decoder ) and the corresponding tensor which we stored in the encoder part earlier. The decoder receives some metadata of the original image to construct the mask.", "In Keras, we have Con2D, Con2DTranspose, MaxPooling2D and UpSampling2D layers to make your life easy. But we\u2019ll be using raw TensorFlow 2.0 APIs to make the model.", "Maybe the model was named \u201cUNet\u201d because of some U-shape derived using the skip connections. Let\u2019s leave that to the inventors! \ud83d\ude05", "Our dataset hails from Cityscapes Image Pairs by DanB on Kaggle. The images look like,", "The right part is the mask and the left part is the actual image. We will split these images with ImageOps using Pillow.", "The dataset has multiple masks of different classes with their respective colours. For our simplicity, we only try to segment the \u201croad\u201d present in the image. Note that the road has an RGB colour of (128, 63, 126 ). Our model will output a binary mask, consisting of 1s and 0s only. Our input image will be a (128, 128, 3 ) shape image and the target will be a mask of shape (128, 128, 1 ). So, the pixel having an RGB value of (128, 63, 126 ) will have a value of 1 in the target mask. All other pixels will hold a value of 0.", "We will define methods for four operations:", "We will create some weights for our UNet using the Glorot uniform initializer,", "We are now ready to assemble the final model.", "Assembling the UNet model with all the ops we created earlier.", "Notice the tf.concat() operation? That\u2019s the place where we are actually concatenating the output from the previous layer ( decoder ) and the skip-connection ( encoder ).", "The model() takes in the input, passes it through the UNet and returns the sigmoid activated output. \ud83c\udd92", "We optimize our model using Adam optimizer and the Binary Crossentropy loss function ( remember the sigmoid activation at the last layer? ).", "We are now ready to train the model. We will call the train() method for each batch we have created in our dataset.", "You will find a code cell to generate a mask for an image in the notebook. After training for 25 epochs, the results \ud83d\ude02 are here for the validation dataset.", "Hope that was interesting. Happy Machine Learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "\ud83d\ude07 Loves Android and ML, \ud83d\udca1 answering your thought-provoking questions in ML intuitively, \ud83d\udc68\u200d\ud83c\udf93 aspiring ML researcher"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb320b6605cbf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://equipintelligence.medium.com/?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": "Shubham Panchal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd45a9465f044&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&user=Shubham+Panchal&userId=d45a9465f044&source=post_page-d45a9465f044----b320b6605cbf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb320b6605cbf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb320b6605cbf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://equipintelligence.medium.com/list/deep-learning-techniques-methods-and-how-tos-01015cf5f917", "anchor_text": "Deep Learning"}, {"url": "https://unsplash.com/@andreacau?utm_source=medium&utm_medium=referral", "anchor_text": "Andrea Cau"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "UNet"}, {"url": "https://www.analyticsvidhya.com/blog/2019/02/tutorial-semantic-segmentation-google-deeplab/", "anchor_text": "semantic segmentation"}, {"url": "https://colab.research.google.com/drive/1i-7Vn_9hGdOvMjkYNedK5nsonNizhe0o#scrollTo=l8WavclxY7ec&forceEdit=true&sandboxMode=true", "anchor_text": "Cityscape_Image_Segmentationcolab.research.google.com"}, {"url": "https://www.kaggle.com/dansbecker/cityscapes-image-pairs", "anchor_text": "Cityscapes Image Pairs"}, {"url": "https://www.kaggle.com/dansbecker", "anchor_text": "DanB"}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/initializers/GlorotUniform", "anchor_text": "Glorot uniform initializer"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adam", "anchor_text": "Adam optimizer"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/losses/BinaryCrossentropy", "anchor_text": "Binary Crossentropy"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b320b6605cbf---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b320b6605cbf---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----b320b6605cbf---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/programming?source=post_page-----b320b6605cbf---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb320b6605cbf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&user=Shubham+Panchal&userId=d45a9465f044&source=-----b320b6605cbf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb320b6605cbf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&user=Shubham+Panchal&userId=d45a9465f044&source=-----b320b6605cbf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb320b6605cbf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb320b6605cbf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b320b6605cbf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b320b6605cbf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b320b6605cbf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b320b6605cbf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b320b6605cbf--------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shubham Panchal"}, {"url": "https://equipintelligence.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd45a9465f044&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&user=Shubham+Panchal&userId=d45a9465f044&source=post_page-d45a9465f044--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F55bcc27ba160&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcityscape-segmentation-with-tensorflow-2-0-b320b6605cbf&newsletterV3=d45a9465f044&newsletterV3Id=55bcc27ba160&user=Shubham+Panchal&userId=d45a9465f044&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}