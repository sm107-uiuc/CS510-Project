{"url": "https://towardsdatascience.com/guide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79", "time": 1683017551.0394602, "path": "towardsdatascience.com/guide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79/", "webpage": {"metadata": {"title": "Guide to Encoding Categorical Features Using Scikit-Learn For Machine Learning | by Jason Chong | Towards Data Science", "h1": "Guide to Encoding Categorical Features Using Scikit-Learn For Machine Learning", "description": "Feature encoding is the process of turning categorical data in a dataset into numerical data. It is essential that we perform feature encoding because most machine learning models can only interpret\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/spscientist/students-performance-in-exams", "anchor_text": "dataset", "paragraph_index": 3}, {"url": "https://github.com/chongjason914/scikit-learn-tutorial/blob/main/feature-encoding.ipynb", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html", "anchor_text": "get_dummies", "paragraph_index": 28}, {"url": "http://linktr.ee/chongjason", "anchor_text": "linktr.ee/chongjason", "paragraph_index": 60}], "all_paragraphs": ["One of the most crucial preprocessing steps in any machine learning project is feature encoding.", "Feature encoding is the process of turning categorical data in a dataset into numerical data. It is essential that we perform feature encoding because most machine learning models can only interpret numerical data and not data in text form.", "In this article, we will learn:", "As usual, I will demonstrate these concepts through a practical case study using the students\u2019 performance in exams dataset on Kaggle.", "You can find the complete notebook on my GitHub here.", "The students\u2019 performance in exams dataset consists of marks secured by 1,000 students in the math, reading and writing subjects. Along with these test scores, the description of each student such as their gender, race/ethnicity, parental level of education, lunch and test preparation course are also included in the dataset.", "The goal of this project is to build a machine learning pipeline which includes feature encoding as well as a regression model to predict a random student\u2019s test score given his/her description. This is an example of a regression problem in machine learning as our target variable, test score has a continuous distribution.", "As we can see from the diagram above, we have 5 categorical (text) variables and 3 numerical variables in the dataset.", "As it turns out, all the predictor variables are categorical variables and all the target variables are numerical variables.", "For simplicity purposes, let\u2019s take the average of the 3 test scores i.e. math, reading and writing so that we are left with a single target variable to predict.", "Since the 3 test scores are highly positively correlated with each other, it is appropriate for us to just take the average.", "As a result, our new data frame is as follows.", "Exploratory data analysis is the process of analysing and visualising the variables in a dataset. Although this step is not necessary for feature encoding, I personally like to get a feel of my data before performing machine learning. So, feel free to skip past this section if you are only interested to learn about feature encoding.", "In this section, we will explore how the different features in the dataset influence the outcome of a student\u2019s test score.", "Female students perform better than male students on average.", "There appears to be an increasing trend in mean scores as we progress from group A to group E i.e. group A students perform the worst while group E students perform the best.", "However, in the absence of any further information, it is difficult for us to draw any meaningful conclusion.", "For the most part, the results are aligned with what we would expect. As the parental level of education increases, the mean score also increases.", "Students with standard lunch perform better than those with free/reduced lunch.", "Lunch can be seen as a proxy for the financial background of the students. Therefore, it makes sense that, on average, students that are financially better off do better in school compared to those that are financially worse off.", "This should come at no surprise at all. The more prepared students are for their test, the better they will perform.", "Now that we have fully explored the variables in the dataset, we can move on to the main purpose of this article and that is encoding categorical features.", "But before we dive into feature encoding, it is important that we first contrast the difference between a nominal variable and an ordinal variable. This is so that we can match the right encoder in Scikit-learn with the right type of variable.", "A nominal variable is a categorical variable where its data does not follow a logical ordering. Some examples of nominal data include:", "An ordinal variable, on the other hand, is also a categorical variable except its data follows a logical ordering. Some examples of ordinal data include:", "As we will see later on, nominal variables are encoded using Scikit-learn OneHotEncoder while ordinal variables are encoded using Scikit-learn OrdinalEncoder.", "The nominal variables in our dataset include:", "The categories in these features do not have a natural order or ranking.", "In this section, we will explore two different ways to encode nominal variables, one using Scikit-learn OneHotEnder and the other using Pandas get_dummies. Once I have demonstrated the two techniques, I will also outline the several benefits OneHotEncoder has over get_dummies when performing feature encoding.", "We will refer to the gender column in our data frame for this exercise.", "As we can see, OneHotEncoder has created two columns to represent the two categories in the gender column, one for male and one for female.", "Female students will receive a value of 1 in the female column and a value of 0 in the male column. Conversely, male students will receive a value of 0 in the female column and a value of 1 in the male column.", "Nevertheless, the most important takeaway from the illustration above is that OneHotEncoder has successfully transformed what was originally a categorical (text) variable into a numerical variable that our machine learning model can interpret.", "Similarly, get_dummies has encoded the gender feature by creating two columns to represent the two categories in the gender feature, male and female.", "Now, although both approaches give the same result, OneHotEncoder is generally preferred over get_dummies due to the following reasons:", "We will further explore the idea of building a machine learning pipeline towards the end of this article.", "The only ordinal variable in our data frame is the parental level of education feature. As education level can be seen as a progression, this feature is classified as an ordinal variable.", "In this section, we will again consider two approaches to encoding ordinal variables, one using Scikit-learn OrdinalEncoder and the other using Pandas map method. Similar to the previous section, OrdinalEncoder has advantages over the map method when performing feature encoding.", "OrdinalEncoder differs from OneHotEncoder such that it assigns incremental values to the categories of an ordinal variable. This helps machine learning algorithms to pick up on an ordinal variable and subsequently use the information that it has learned to make more accurate predictions.", "In order to use OrdinalEncoder, we have to first specify the order in which we would like to encode our ordinal variable, parental level of education. Here, we want the order to go as follows: some high school, high school, some college, associate\u2019s degree, bachelor\u2019s degree and finally master\u2019s degree.", "Note that OrdinalEncoder has assigned the value of 0 to some high school, 1 to high school, 2 to some college, 3 to associate\u2019s degree, 4 to bachelor\u2019s degree and 5 to master\u2019s degree.", "The Pandas map method is a more manual approach to encoding ordinal variables where we individually assign numerical values to the categories in an ordinal variable.", "Although it replicates the result of the OrdinalEncoder, it is not ideal for encoding ordinal variables with a high number of unique categories.", "For the remainder of this article, we will only consider the use of OneHotEncoder and OrdinalEncoder as means of encoding the categorical variables in our dataset.", "In this section, we will combine OneHotEncoder and OrdinalEncoder into a single-step column transformer.", "First and foremost, what is a pipeline and why do we use it?", "Essentially, a pipeline chains together multiple steps in the machine learning process where the output of each step is used as the input to the next step. It is typically used to chain data preprocessing procedures (e.g. imputation for missing values, scaling and feature encoding) together with modelling into one cohesive workflow.", "Here, we will build two pipelines that share the same column transformer that we have created above but with a different machine learning model, one using linear regression and the other using gradient boosting.", "We will then assess the prediction results from the two pipelines using mean absolute error (MAE) as well as root mean squared error (RMSE). The model with a lower prediction error is deemed as more accurate than the other.", "We will start off by splitting our data into a training set and a test set. Here, I have assigned 30% of the original data as our test set as well as a seed for reproducibility.", "We can now move on to building our pipeline.", "With predictions ready from the two pipelines, we can proceed to evaluate the accuracy of these predictions using mean absolute error (MAE) and mean squared error (RMSE).", "We can conclude that linear regression is slightly more accurate than gradient boosting.", "While these may not the most accurate predictions from a machine learning standpoint, the goal of this article is to demonstrate that you can build a pipeline which chains data preprocessing steps such as feature encoding together with modelling into one single cohesive workflow using Scikit-learn.", "To summarise, in this article, we have learned the difference between a nominal variable and an ordinal variable as well as how to properly encode them using Scikit-learn OneHotEncoder and LabelEncoder.", "We also discussed the benefits of performing feature encoding using the Scikit-learn library over the Pandas library i.e. the flexibility in building a machine learning pipeline.", "Finally, we compared the accuracy of two separate pipelines at predicting students\u2019 test score. We conclude that linear regression is slightly more accurate than gradient boosting due to the lower mean absolute error (MAE) as well as root mean squared error (RMSE).", "I hope you have picked up a thing or two from this article. Thank you so much for reading. I will be publishing more tutorial articles relating to the Scikit-learn library in the coming weeks so do follow me for future updates.", "I look forward to seeing you in my next article. Happy learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Quantium, BCom (Actuarial Studies). Check out my stuff at linktr.ee/chongjason"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5048997a5c79&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5048997a5c79--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5048997a5c79--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://chongjason.medium.com/?source=post_page-----5048997a5c79--------------------------------", "anchor_text": ""}, {"url": "https://chongjason.medium.com/?source=post_page-----5048997a5c79--------------------------------", "anchor_text": "Jason Chong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdc66e2ca621a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&user=Jason+Chong&userId=dc66e2ca621a&source=post_page-dc66e2ca621a----5048997a5c79---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5048997a5c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5048997a5c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@anniespratt?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Annie Spratt"}, {"url": "https://unsplash.com/s/photos/studying?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html", "anchor_text": "OneHotEncoder"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OrdinalEncoder.html#sklearn.preprocessing.OrdinalEncoder", "anchor_text": "OrdinalEncoder"}, {"url": "https://www.kaggle.com/spscientist/students-performance-in-exams", "anchor_text": "dataset"}, {"url": "https://github.com/chongjason914/scikit-learn-tutorial/blob/main/feature-encoding.ipynb", "anchor_text": "here"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html", "anchor_text": "get_dummies"}, {"url": "https://www.facebook.com/chongjason914", "anchor_text": "Facebook"}, {"url": "https://www.instagram.com/chongjason914", "anchor_text": "Instagram"}, {"url": "https://www.twitter.com/chongjason914", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/chongjason914", "anchor_text": "LinkedIn"}, {"url": "https://www.youtube.com/channel/UCQXiCnjatxiAKgWjoUlM-Xg?view_as=subscriber", "anchor_text": "YouTube"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5048997a5c79---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5048997a5c79---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----5048997a5c79---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/feature-encoding?source=post_page-----5048997a5c79---------------feature_encoding-----------------", "anchor_text": "Feature Encoding"}, {"url": "https://medium.com/tag/data-preprocessing?source=post_page-----5048997a5c79---------------data_preprocessing-----------------", "anchor_text": "Data Preprocessing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5048997a5c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&user=Jason+Chong&userId=dc66e2ca621a&source=-----5048997a5c79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5048997a5c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&user=Jason+Chong&userId=dc66e2ca621a&source=-----5048997a5c79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5048997a5c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5048997a5c79--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5048997a5c79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5048997a5c79---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5048997a5c79--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5048997a5c79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5048997a5c79--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5048997a5c79--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5048997a5c79--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5048997a5c79--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5048997a5c79--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5048997a5c79--------------------------------", "anchor_text": ""}, {"url": "https://chongjason.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://chongjason.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jason Chong"}, {"url": "https://chongjason.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "704 Followers"}, {"url": "http://linktr.ee/chongjason", "anchor_text": "linktr.ee/chongjason"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdc66e2ca621a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&user=Jason+Chong&userId=dc66e2ca621a&source=post_page-dc66e2ca621a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9cceb96b5bb3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fguide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79&newsletterV3=dc66e2ca621a&newsletterV3Id=9cceb96b5bb3&user=Jason+Chong&userId=dc66e2ca621a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}