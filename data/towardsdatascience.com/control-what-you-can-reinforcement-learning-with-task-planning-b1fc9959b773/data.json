{"url": "https://towardsdatascience.com/control-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773", "time": 1683005550.02843, "path": "towardsdatascience.com/control-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773/", "webpage": {"metadata": {"title": "Control What You Can: Reinforcement Learning with Task Planning! | by Marin Vlastelica | Towards Data Science", "h1": "Control What You Can: Reinforcement Learning with Task Planning!", "description": "We propose CWYC, a method that combines RL, with task planning and intrinsic motivation to achieve true autonomy and maximum control of its surroundings."}, "outgoing_paragraph_urls": [{"url": "https://bit.ly/3aSzEsZ", "anchor_text": "Control What You Can: Intrinsically Motivated Task-Planning Agent", "paragraph_index": 14}, {"url": "https://al.is.tuebingen.mpg.de/", "anchor_text": "Autonomous Learning Group", "paragraph_index": 15}, {"url": "https://jimimvp.github.io/", "anchor_text": "https://jimimvp.github.io/", "paragraph_index": 17}, {"url": "https://www.linkedin.com/in/mvlastelica/", "anchor_text": "https://www.linkedin.com/in/mvlastelica/", "paragraph_index": 17}], "all_paragraphs": ["Many control problems in the real world have some kind of hierarchical structure. When we talk about truly autonomous robots, ideally we want them to gain maximal control of their environment. We want this to happen based on little or no supervision through the reward function. Furthermore, we want the agents to make use of these inherent task hierarchies in the environment in order to make learning more sample efficient. In layman's terms, we want to leave the robot alone without any specification and let it figure out everything by itself. Most approaches deal with only one of these problems, whereby we [1] proposed a method to deal with all of them at the same time.", "Before jumping into the method, we must make clear the assumptions that we made and certain terminology. For one, we assumed that the environment has task spaces that are well defined and available to us. In our case, a task space is defined as a subspace of the observation space, e.g. the coordinates of an object, although the semantics are not known to the robot. This means that the self-imposed goals correspond to reaching a goal in the task space, e.g., moving an object to a certain location.", "Naturally, tasks can depend on each other, however, just learning this dependency is now enough, because we also need to know which exact goal needs to be reached in the subtasks. To give an example, consider a robot in a warehouse. There is a heavy object in the warehouse that is too heavy to lift directly, hence the robot needs to use the forklift. This scenario naturally decomposes into 3 tasks (simplified): the robot position, the forklift position, the heavy object position. We want the robot to figure out by itself that it should move to the forklift, get the forklift to the heavy object and then move the object. This involves aiming at the correct goals in each of the sub-tasks, respectively.", "Keeping all of this in mind, in our proposed approach, these are the main challenges that we tried to address:", "In Control What You Can (CWYC), we have multiple components that play together in order to achieve sample efficiency in learning. But before jumping into the individual components, we need a way to guide the learning in the absence of extrinsic reward. One could rely on a prediction error of forward models as a surrogate reward, but the prediction error is not enough. The reason that it is not enough is in noisy environments. If we have unpredictable factors in the environment, this yields constant prediction error. Hence we heavily rely on the measure of surprise for intrinsic motivation in all of the following components. In the absence of a success signal (which is 1 if the task was solved), the algorithm relies more heavily on surprise as a surrogate reward. We say that an event/transition is surprising if it incurs an error considerably outside a certain confidence interval, which enables us to deal with noise in the environment.", "The task selector determines which task is to be attempted by the agent. The task selector is effectively a multi-armed bandit, and we need a way to fit its arm distribution. The task that should be attempted is the one that can be the most improved upon, hence we introduce improvement/learning progress (the time derivative of the success) as a means to update the distribution.", "The information about the task dependencies is contained within the task planner, which is effectively a matrix encoding the task graph or contextual multi-arm bandit (where the context is the task to solve and the actions are the previous tasks). We sample the task sequence from the task planner based on the cell entries. A transition probability from task A to task B as an example is proportional to the amount of time required to solve B given solving task A and surprise seen when solving task A before task B in the goal space of B.", "The subgoal generator enables us to set a goal given a task transition in the task chain. I.e., this means that given that we know we want to solve task B later, the generator outputs a goal for task A. The subgoal generator can be seen as a potential function over the goal space of a task. Again, in the absence of a success signal, this reward is dominated by the surprise.", "All of the previous components are summarized in the following figure:", "We evaluated our method on two continuous control tasks, a synthetic tool-use task and a challenging robotic tool-use task against an intrinsic motivation and hierarchical RL baseline. What we have noticed is that in the absence of a well-shaped reward, the baselines fail to learn how to solve these hierarchical tasks. This is strongly connected to the fact that a really small part of the state space being relevant to solving a task. In the presence of a well-shaped reward, other methods were able to solve the tasks as well.", "In the following figure are the performance plots of the tool-use task. Our method (CWYC) has consistently outperformed the baselines on tasks with a bit more complexity in the hierarchy, such as picking up a heavy object. Details can be seen in [1].", "In the animation (2), we can see the training progression of the algorithm in the robotic arm task. The box is too far for the robot to reach by itself, so it needs to realize that it should go for the hook first to succeed in the task of moving the box to the goal position (red).", "Additionally, we measured the \u201cresource allocation\u201d of the algorithm, meaning how much time does the algorithm contribute to each of the individual tasks. In the following figure, we can nicely illustrate our point. Based on our method with the use of the surprise signal and its combination with the success signal, we achieve efficient resource allocation. Tasks that cannot be solved such as moving an object appears randomly in different places quickly receive almost no attention.", "Questions remain however can we alleviate our assumptions further, as in the case of the task spaces. Can we learn efficient task space partitioning for a problem that leads to efficient learning? How can we learn to sample feasible goals for the task given that we do not know which parts of the task space are reachable? This we leave for future research.", "[1] Blaes, Sebastian et al. Control What You Can: Intrinsically Motivated Task-Planning Agent, NeurIPS 2019", "This is work from the Autonomous Learning Group of the Max Planck Institute for Intelligent Systems.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD @ Max Planck Institute for Intelligent Systems | All things ML/AI | Gutar | https://jimimvp.github.io/ | https://www.linkedin.com/in/mvlastelica/ |"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb1fc9959b773&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://marinvp.medium.com/?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": ""}, {"url": "https://marinvp.medium.com/?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": "Marin Vlastelica"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8f3ed874afef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&user=Marin+Vlastelica&userId=8f3ed874afef&source=post_page-8f3ed874afef----b1fc9959b773---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1fc9959b773&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1fc9959b773&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://bit.ly/3aSzEsZ", "anchor_text": "Control What You Can: Intrinsically Motivated Task-Planning Agent"}, {"url": "https://al.is.tuebingen.mpg.de/", "anchor_text": "Autonomous Learning Group"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b1fc9959b773---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b1fc9959b773---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b1fc9959b773---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----b1fc9959b773---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/tag/optimization?source=post_page-----b1fc9959b773---------------optimization-----------------", "anchor_text": "Optimization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1fc9959b773&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&user=Marin+Vlastelica&userId=8f3ed874afef&source=-----b1fc9959b773---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb1fc9959b773&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&user=Marin+Vlastelica&userId=8f3ed874afef&source=-----b1fc9959b773---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb1fc9959b773&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb1fc9959b773&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b1fc9959b773---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b1fc9959b773--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b1fc9959b773--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b1fc9959b773--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b1fc9959b773--------------------------------", "anchor_text": ""}, {"url": "https://marinvp.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://marinvp.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marin Vlastelica"}, {"url": "https://marinvp.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://jimimvp.github.io/", "anchor_text": "https://jimimvp.github.io/"}, {"url": "https://www.linkedin.com/in/mvlastelica/", "anchor_text": "https://www.linkedin.com/in/mvlastelica/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8f3ed874afef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&user=Marin+Vlastelica&userId=8f3ed874afef&source=post_page-8f3ed874afef--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9131bca7a450&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcontrol-what-you-can-reinforcement-learning-with-task-planning-b1fc9959b773&newsletterV3=8f3ed874afef&newsletterV3Id=9131bca7a450&user=Marin+Vlastelica&userId=8f3ed874afef&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}