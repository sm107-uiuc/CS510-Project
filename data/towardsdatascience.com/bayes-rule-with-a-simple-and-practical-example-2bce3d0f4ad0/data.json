{"url": "https://towardsdatascience.com/bayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0", "time": 1683004571.6004531, "path": "towardsdatascience.com/bayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0/", "webpage": {"metadata": {"title": "Bayes\u2019 rule with a simple and practical example | by Tirthajyoti Sarkar | Towards Data Science", "h1": "Bayes\u2019 rule with a simple and practical example", "description": "Bayes\u2019 theorem has been called the most powerful rule of probability and statistics. We show its application through simple yet practical examples with Python code."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Thomas_Bayes", "anchor_text": "Reverend Thomas Bayes", "paragraph_index": 3}, {"url": "https://royalsocietypublishing.org/doi/abs/10.1098/rstl.1763.0053", "anchor_text": "An Essay towards solving a Problem in the Doctrine of Chances", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Pierre-Simon_Laplace", "anchor_text": "Pierre-Simon Laplace", "paragraph_index": 4}, {"url": "https://archive.org/details/thorieanalytiqu01laplgoog/page/n7/mode/2up", "anchor_text": "Th\u00e9orie analytique des probabilit\u00e9s", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Bayesian_inference", "anchor_text": "Bayesian inference", "paragraph_index": 14}, {"url": "https://gist.github.com/tirthajyoti/07e3c81839957423fef62f0ac5bd3ea7", "anchor_text": "The code is here", "paragraph_index": 27}, {"url": "https://github.com/tirthajyoti?tab=repositories", "anchor_text": "GitHub", "paragraph_index": 46}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "add me on LinkedIn", "paragraph_index": 46}, {"url": "https://twitter.com/tirthajyotiS", "anchor_text": "follow me on Twitter", "paragraph_index": 46}], "all_paragraphs": ["Bayes\u2019 theorem (alternatively Bayes\u2019 law or Bayes\u2019 rule) has been called the most powerful rule of probability and statistics. It describes the probability of an event, based on prior knowledge of conditions that might be related to the event.", "For example, if a disease is related to age, then, using Bayes\u2019 theorem, a person\u2019s age can be used to more accurately assess the probability that they have the disease, compared to the assessment of the probability of disease made without knowledge of the person\u2019s age.", "It is a powerful law of probability that brings in the concept of \u2018subjectivity\u2019 or \u2018the degree of belief\u2019 into the cold, hard statistical modeling. Bayes\u2019 rule is the only mechanism that can be used to gradually update the probability of an event as the evidence or data is gathered sequentially.", "Bayes\u2019 theorem is named after Reverend Thomas Bayes, who first used conditional probability to provide an algorithm (his Proposition 9) that uses evidence to calculate limits on an unknown parameter, published as An Essay towards solving a Problem in the Doctrine of Chances (1763). In what he called a scholium, Bayes extended his algorithm to any unknown prior cause.", "Independently of Bayes, Pierre-Simon Laplace in 1774, and later in his 1812 \u201cTh\u00e9orie analytique des probabilit\u00e9s\u201d used conditional probability to formulate the relation of an updated posterior probability from a prior probability, given evidence.", "It is a powerful law of probability that brings in the concept of \u2018subjectivity\u2019 or \u2018the degree of belief\u2019 into the cold, hard statistical modeling.", "It is a logical way of doing data science.", "We start with a hypothesis and a degree of belief in that hypothesis. That means, based on domain expertise or prior knowledge, we assign a non-zero probability to that hypothesis.", "Then, we gather data and update our initial beliefs. If the data support the hypothesis then the probability goes up, if it does not match, then probability goes down.", "Sound\u2019s simple and logical, doesn\u2019t it?", "But traditionally, in the majority of statistical learning, the notion of prior is not used or not looked favorably. Also, the computational intricacies of Bayesian learning have prevented it from being mainstream for more than two hundred years.", "But things are changing now with the advent of Bayesian inference\u2026", "If the data support the hypothesis then the probability goes up, if it does not match, then probability goes down.", "Bayesian statistics and modeling have had a recent resurgence with the global rise of AI and data-driven machine learning systems in all aspects of business, science, and technology.", "Bayesian inference is being applied to genetics, linguistics, image processing, brain imaging, cosmology, machine learning, epidemiology, psychology, forensic science, human object recognition, evolution, visual perception, ecology, and countless other fields where knowledge discovery and predictive analytics are playing a significant role.", "Bayesian statistics and modeling have had a recent resurgence with the global rise of AI and data-driven machine learning systems", "We will apply the Bayes\u2019 rule to a problem of drug screening (e.g. mandatory testing for federal or many other jobs which promise a drug-free work environment).", "Suppose that a test for using a particular drug is 97% sensitive and 95% specific. That is, the test will produce 97% true positive results for drug users and 95% true negative results for non-drug users. These are the pieces of data that any screening test will have from their history of tests. Bayes\u2019 rule allows us to use this kind of data-driven knowledge to calculate the final probability.", "Suppose, we also know that 0.5% of the general population are users of the drug. What is the probability that a randomly selected individual with a positive test is a drug user?", "Note, this is the crucial piece of \u2018Prior\u2019 which is a piece of generalized knowledge about the common prevalence rate. This is our prior belief about the probability of a random test subject being a drug user. That means if we choose a random person from the general population, without any testing, we can only say that there is a 0.5% chance of that person being a drug-user.", "How to use Bayes\u2019 rule then, in this situation?", "We will write a custom function that accepts the test capabilities and the prior knowledge of drug user percentage as input and produces the output probability of a test-taker being a user based on a positive result.", "Here is the formula for computing as per the Bayes\u2019 rule\u2026", "If we run the function with the given data, we get the following result,", "Even with a test that is 97% correct for catching positive cases, and 95% correct for rejecting negative cases, the true probability of being a drug-user with a positive result is only 8.9%!", "If you look at the computations, this is because of the extremely low prevalence rate. The number of false positives outweighs the number of true positives.", "For example, if 1000 individuals are tested, there are expected to be 995 non-users and 5 users. From the 995 non-users, 0.05 \u00d7 995 \u2243 50 false positives are expected. From the 5 users, 0.95 \u00d7 5 \u2248 5 true positives are expected. Out of 55 positive results, only 5 are genuine!", "Let\u2019s see how the probability changes with the prevalence rate. The code is here.", "Note, your decision depends on the probability threshold. Currently, it is set to 0.5. You can lower it if necessary. But, at the threshold of 0.5, you need to have an almost 4.8% prevalence rate to catch a user with a single positive test result.", "We saw that the test sensitivity and specificity impact this computation strongly. So, we may like to see what kind of capabilities are needed to improve the likelihood of catching drug users.", "The plots above clearly show that even with close to 100% sensitivity, we don\u2019t gain much at all. However, the probability response is highly non-linear with respect to the specificity of the test and as it reaches perfection, we get a large increase in the probability. Therefore, all R&D efforts should be focused on how to improve the specificity of the test.", "This conclusion can be intuitively derived from the fact that the main issue with having low probability is the low prevalence rate. Therefore, catching non-users correctly (i.e. improving specificity) is the area where we should focus on because they are much larger in numbers than the user.", "Negative examples are much higher in number than the Positive examples in this problem. Therefore, the True Negative performance of the test should be excellent.", "The best thing about Bayesian inference is the ability to use prior knowledge in the form of a Prior probability term in the numerator of the Bayes\u2019 theorem.", "In this setting of drug screening, the prior knowledge is nothing but the computed probability of a test which is then fed back to the next test.", "That means, for these cases, where the prevalence rate in the general population is extremely low, one way to increase confidence is to prescribe subsequent test if the first test result is positive.", "The posterior probability from the first test becomes the Prior for the second test i.e. the P(user) is not the general prevalence rate anymore for this second test, but the probability from the first test.", "Here is the simple code for demonstrating the chaining.", "When we run this code, we get the following,", "When we run the test the first time, the output (posterior) probability is low, only 8.9%, but that goes up significantly up to 65.4% with the second test, and the third positive test puts the posterior at 97.3%.", "Therefore, a test, which is unable to screen a user first time, can be used multiple times to update our belief with the successive application of Bayes\u2019 rule.", "The best thing about Bayesian inference is the ability to use prior knowledge in the form of a Prior probability term in the numerator of the Bayes\u2019 theorem.", "In this article, we show the basics and application of one of the most powerful laws of statistics \u2014 Bayes\u2019 theorem. Advanced probabilistic modeling and inference process that utilizes this law, has taken over the world of data science and analytics in recent years.", "We demonstrated the application of Bayes\u2019 rule using a very simple yet practical example of drug-screen testing and associated Python code. We showed how the test limitations impact the predicted probability and which aspect of the test needs to be improved for a high-confidence screen.", "We further showed how multiple Bayesian calculations can be chained together to compute the overall posterior and the true power of Bayesian reasoning.", "For further reading and resources, you can refer to these excellent articles,", "If you have any questions or ideas to share, please contact the author at tirthajyoti[AT]gmail.com. Also, you can check the author\u2019s GitHub repositories for code, ideas, and resources in machine learning and data science. If you are, like me, passionate about AI/machine learning/data science, please feel free to add me on LinkedIn or follow me on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sr. Director of AI/ML platform | Stories on Artificial Intelligence, Data Science, and ML | Speaker, Open-source contributor, Author of multiple DS books"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2bce3d0f4ad0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a----2bce3d0f4ad0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bce3d0f4ad0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bce3d0f4ad0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Thomas_Bayes", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Thomas_Bayes", "anchor_text": "Reverend Thomas Bayes"}, {"url": "https://royalsocietypublishing.org/doi/abs/10.1098/rstl.1763.0053", "anchor_text": "An Essay towards solving a Problem in the Doctrine of Chances"}, {"url": "https://en.wikipedia.org/wiki/Pierre-Simon_Laplace", "anchor_text": "Pierre-Simon Laplace"}, {"url": "https://archive.org/details/thorieanalytiqu01laplgoog/page/n7/mode/2up", "anchor_text": "Th\u00e9orie analytique des probabilit\u00e9s"}, {"url": "https://en.wikipedia.org/wiki/Bayesian_inference", "anchor_text": "Bayesian inference"}, {"url": "https://pixabay.com/illustrations/syringe-pill-capsule-morphine-1884784/", "anchor_text": "Pixabay"}, {"url": "https://gist.github.com/tirthajyoti/46453f215156c21d47d34cabd07b5d58", "anchor_text": "code is here"}, {"url": "https://gist.github.com/tirthajyoti/07e3c81839957423fef62f0ac5bd3ea7", "anchor_text": "The code is here"}, {"url": "https://gist.github.com/tirthajyoti/9ddbf0cd16f9897c0b0c85b9cbd43ac3", "anchor_text": "The Python code is here"}, {"url": "https://www.mathsisfun.com/data/bayes-theorem.html", "anchor_text": "https://www.mathsisfun.com/data/bayes-theorem.html"}, {"url": "https://betterexplained.com/articles/an-intuitive-and-short-explanation-of-bayes-theorem/", "anchor_text": "https://betterexplained.com/articles/an-intuitive-and-short-explanation-of-bayes-theorem/"}, {"url": "https://github.com/tirthajyoti?tab=repositories", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "add me on LinkedIn"}, {"url": "https://twitter.com/tirthajyotiS", "anchor_text": "follow me on Twitter"}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "Tirthajyoti Sarkar - Sr. Principal Engineer - Semiconductor, AI, Machine Learning - ON\u2026Making data science/ML concepts easy to understand through writing: https://medium.com/@tirthajyoti Open-source and fun\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2bce3d0f4ad0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2bce3d0f4ad0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----2bce3d0f4ad0---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----2bce3d0f4ad0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----2bce3d0f4ad0---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2bce3d0f4ad0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----2bce3d0f4ad0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2bce3d0f4ad0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----2bce3d0f4ad0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bce3d0f4ad0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2bce3d0f4ad0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2bce3d0f4ad0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2bce3d0f4ad0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/@tirthajyoti/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb285331282ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayes-rule-with-a-simple-and-practical-example-2bce3d0f4ad0&newsletterV3=cb9d97d4b61a&newsletterV3Id=b285331282ca&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}