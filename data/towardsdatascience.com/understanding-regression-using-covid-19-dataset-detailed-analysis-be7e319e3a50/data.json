{"url": "https://towardsdatascience.com/understanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50", "time": 1683010205.576446, "path": "towardsdatascience.com/understanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50/", "webpage": {"metadata": {"title": "Understanding Regression using COVID-19 Dataset \u2014 Detailed Analysis | by Ayushi Jain | Towards Data Science", "h1": "Understanding Regression using COVID-19 Dataset \u2014 Detailed Analysis", "description": "Deep dive into Regression Analysis and how we can use this to infer mindboggling insights using Chicago COVID dataset. Some intuition of both calculus and Linear Algebra will make your journey easier. We will study Linear Regression, Polynomial Regression, Normal equation, gradient descent and step by step python implementation."}, "outgoing_paragraph_urls": [{"url": "https://github.com/Ayushijain09/Regression-on-COVID-dataset", "anchor_text": "here", "paragraph_index": 30}, {"url": "https://www.linkedin.com/in/ayushijain09/", "anchor_text": "Linkedin", "paragraph_index": 46}], "all_paragraphs": ["Hope you all are safe and healthy! COVID-19 has totally changed the course of 2020, shrinking the global economy by a huge rate. In this blog, we will deep dive into Regression Analysis and how we can use this to infer mindboggling insights using Chicago COVID dataset. Some intuition of both calculus and Linear Algebra will make your journey easier. Welcome to my first blog!", "Linear Regression is not just a machine learning algorithm, it plays a huge role in statistics. Coming from a family of supervised learning, each input here is associated with a target label. The task of the model is to basically understand the pattern and find the best fit line that covers each (input, target) pair.", "To give an overview, ML models can be classified on the basis of the task performed and the nature of the output:", "Regression: Output is a continuous variable. Classification: Output is a categorical variable.Clustering: No notion of output.", "Regression & Classification fall under supervised learning while Clustering fall under unsupervised learning.", "Regression is a form of predictive modeling technique where we try to find a significant relationship between a dependent variable and one or more independent variables. There are various types of regression techniques: Linear, Logistic, Polynomial, Ridge, Lasso, Softmax.", "By the term itself, you can guess that the model functions along a straight line, where y can be calculated from a linear combination of the input variables x. Linear Regression hypothesis function can be formulated as:", "\u0398 here stores the coefficients/weights of the input features x and is of the exact same dimensionality as x. Note that to add support for a constant term in our model, we prefix the vector x with 1.", "With single input and output variable, the method is called simple linear regression while with multiple inputs/features, its called multiple linear regression. For both, our goal would be to find the best fitting line that minimizes the sum of squared errors (SSE) or mean squared error (MSE) between our target variable (y) and our predicted output across all samples.", "To proceed, we need to find the parameters/coefficients for that best fit line. There are various techniques to arrive at the geometric equation for the line such as least absolute deviations (minimizing the sum of absolute values of residuals) and the Theil\u2013Sen estimator (which finds a line whose slope is the median of the slopes determined by pairs of sample points), however, statisticians typically use the Ordinary Least Squares method (OLS). OLS is nothing but a method to minimize the distances between the line and the actual outputs. If you want to calculate the regression line by hand, it uses a slightly scary formula to find the slope \u2018\u03b81\u2019 and line intercept \u2018\u03b80\u2019.", "There are 2 approaches/solutions that uses the Least Squares method to implement a linear regression model:", "It\u2019s important to understand that,\u03b8, here essentially can break or make the model. Our aim is to basically look for the \u03b8 that helps in achieving the lowest cost of the model.", "The choice of objective/cost function J(\u03b8) can vary greatly depending on the problem at hand. In general, the mean squared error is best for regression and cross-entropy is best for classification. So, coming back to Normal Equation, it uses an analytical approach to find the parameters of the equation. It took some time for me to understand why things are happening the way they are. Hopefully, this short proof of it will get your concepts in hand.", "If we take a residual vector as e =X\u03b8 \u2014 y, then cost function/sum of squared residuals in a vector form will be :", "For someone new to linear algebra, note that we cannot simply square X\u03b8 \u2014 y. Vector multiplication property states that the square of a vector/matrix is not equal to the square of each of its values. So to get the squared value, we multiply the vector with its transpose.", "Now to find the \u03b8 that minimizes the sum of squared residuals, we need to take the derivative of cost function above with respect to \u03b8.", "That\u2019s all that Normal Equation offers. A very direct and elegant approach to find the exact \u03b8 parameters that would do wonders to fit your data! However, there is a catch here. The matrix inverse function would not go well with larger datasets (large X value) or datasets where the inverse may not exist (the matrix is non-invertible or singular). Even the most efficient inverse algorithm that exists today gives us cubic time complexity. Normal Equation solution can be preferred for \u201csmaller\u201d datasets \u2014 if computing a \u201ccostly\u201d matrix inverse is not a concern but for real-world datasets, approaches such as Gradient descent or SGD are preferred.", "The goal here is similar to what we had for Normal Equation. Gradient descent algorithm figures out a minimal cost function by applying various parameters for theta 0 and theta 1 until it reaches convergence. It is considered to be one of the best iterative optimization algorithms to minimize residual errors.", "Think of a bowl or any convex shape object as your cost function. If you throw any object from the sides of the bowl, it will take the shortest best route and will reach the bottom. That bottom point will provide us with the lowest cost and the \u03b8 parameter to attain the best-fitted model.", "Few challenges might come if we have many local minima instead of one global minima. Cost functions are not usually a regular bowl. It might stop too early or take indefinite time to converge. But fortunately! The cost function in Linear Regression is convex, so no line passing between 2 points meets the curve.", "It\u2019s a very straightforward process. The procedure of GD starts with initializing some random \u03b8 values. We calculate the cost by plugging those values into the cost function. The derivate of the cost function will give us the slope at that point so that we know in which direction to head next in order to get further lower-cost. How does that happen? We use that derivative value to update all the \u03b8 coefficients at each step until we reach the lowest level and there is no more cost decrease. SIMPLE! Isn\u2019t it?", "To compute all of them in one go, we can use the gradient vector that contains the partial derivates for each model parameter.", "Note that this gradient vector points uphill, so we need to go in the opposite direction for downhill. Once we have the gradient vector, we need to find the learning rate \u03b7 to identify the amount of the downhill step.", "There are few things needed to be kept in mind while trying different values of eta \u03b7. If the learning rate is too low, it might take an indefinite time to converge to the optimal value. However, keeping it high might make it jump on the other side and oscillate indefinitely. So, \u03b7 should be kept somewhere in between. To find a good learning rate, we can apply grid search. Through this, we try and test various \u03b7 values keeping a restriction on the number of iterations. The one that converges faster will be a good learning rate for the problem. This method is called Batch Gradient Descent since it performs calculations over full training set X.", "There are two more types of Gradient Descent with not much difference \u2014", "Batch Gradient Descent would blow up if we have very large datasets. It can take forever to complete. Stochastic works in a similar fashion as Batch GD, however here it picks a random instance in the training set and computes the gradient-based only on that instance. All the other calculations will be the same. It is faster than Batch since we have fewer data at the time of manipulation.", "Yet, this algorithm is not regularly used since it takes instances randomly which makes the cost function go high-low repeatedly. Even if it converges to the optimum, it will continue to bounce around. Also, it often picks instances more than once so it is suggested to keep shuffling the data.TIP:So, it is better to have a greater learning rate initially and then reduce it slowly.", "It takes small random sets of instances. But sometimes, it may get harder to escape from local minima. It is better than Stochastic Gradient Descent in terms of irregularity.", "All three end up near minimum, but Batch Gradient Descent actually stops at the minimum.", "Batch Gradient Descent will take longer with larger datasets. Stochastic and Mini Batch would reach the minimum faster if we know how to alter the learning rate.", "Let us first walk through Chicago\u2019s COVID-19 dataset. You can download the dataset from here.", "80% of the COVID datasets available on the web are in a time series format displaying the counts of cases on a daily basis. So, with just death and test counts, I could only visualize whether the peak has reached or if it is still increasing and so on. But to forecast, I wanted to have features on which the case count can have some dependency. We also know that there are many countries where there is inadequate testing done, thus showing less number of cases. Thus, I focused on the datasets where I can get tests and case features to figure out if there is a huge correlation between the two.", "Fortunately, I found this small-sized dataset of Chicago with features such as tests vs cases count. You can observe how the data is displaying a slightly linear pattern on the scatter plot, showing the correlation.", "As you can see, the independent variable is Tests (x) here and dependent is Cases (y). We have a few more features in the dataset, giving the count of people who are older than 30 or younger and those who are Latin, etc. I personally couldn\u2019t deduce what we could analyze with such features. You can try giving it a shot and let me know if we can infer something.", "Mostly all of them show a linear pattern that should not happen! This gives rise to the famous multilinearity problem.", "The Multilinearity problem is when independent variables in a regression model show correlation. Independent variables should be independent. In layman terms, you can think of several variables essentially measuring the same thing. There is no need to have more than one variable to measure the same thing in a model. This basically reduces the precision of the estimate coefficients \u03b8, undermining the statistical power of your regression model.", "To diagnose multicollinearity, we use a measure called a variance inflation factor (VIF). Variance inflation factors (VIF) measures how much the variance of the estimated regression coefficients are inflated as compared to when the predictor variables are not linearly related. Rule of thumb is if we have VIF>10, the model has high multilinearity.", "You can check in the above graph that we have high multilinearity involved in our dataset. The good thing is I have taken only 2 features in my model but in the future, if you create any regression model, check VIFs and drop the independent variables that are correlated with each other.", "The Root Mean Square Error for Linear Regression => 171.8", "As you can see that we have many outliers because of which its not fitting the data well. In cases where the data is complex, we can try to reduce the RMSE by applying Polynomial Regression.", "Special Case of Linear Regression where we try to fit an n degree polynomial equation to the data. It outperforms LR in the capability of finding relationships between features. Here, we add powers to each feature and append them to our existing features. The training will be done on this extended set of features to get a curvilinear relationship between the target variable and the independent variables.", "Scikit learn PolynomialFeatures class consists of a degree parameter that we can add as the maximum power applied to the data. You need to try and test which degrees minimizes RMSE to the most. After trying different values of degree, I found degree 4 is giving me the best solution.", "The Root Mean Square Error for Polynomial Regression=> 131.08.Observe how this plot perfectly fits the data, at least better than Linear Regression. Also, the RMSE decreased to a great extent which gives another proof of its goodness. There are a lot more concepts required to get the performance of a model such as whether it is overfitting or underfitting, the bias/variance trade-off. We will surely cover that in the next blog!", "A RMSE of 0 means that your model is a perfect predictor of the outputs (but this will almost never happen).", "There are various kinds of evaluation metrics for regression & classification problems. RMSE is one of them which should be used if the errors are very large and undesirable since it compensates that by taking a square root.", "Another metrics we have is R Squared(R2) which gives the relative measure of the overall model fitting procedure of a regression line used for predicting. Its value ranges between 0 and 1. Higher the value, better the model. The R\u00b2 can be thought of as representing the percent of variance explained by the model. It has a better version called Adjusted R Squared that even takes into consideration if the features are dropped or added. R Squared either stays constant on the changes or increases. Adjusted R Squared takes changes into consideration which is why this metric is more reliable when you have a lot of features to experiment with.", "Hope you got a good understanding of finding a perfectly fitted line in a real-world scenario! Regression happens everywhere, its time to start noticing it! If you have any questions/thoughts, feel free to leave your feedback in the comment section below or you can reach me on Linkedin. Till then, wait for the next post! :D", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbe7e319e3a50&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ayushijain09?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ayushijain09?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": "Ayushi Jain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F86c908cc4ad4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&user=Ayushi+Jain&userId=86c908cc4ad4&source=post_page-86c908cc4ad4----be7e319e3a50---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe7e319e3a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe7e319e3a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/Ayushijain09/Regression-on-COVID-dataset", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/ayushijain09/", "anchor_text": "Linkedin"}, {"url": "http://mlwiki.org/index.php/OLS_Regression", "anchor_text": "OLS RegressionSuppose we have $m$ training examples $(\\mathbf x_i, y_i)$ $n$ features, $\\mathbf x_i = \\big[x_{i1}, \\ \u2026mlwiki.org"}, {"url": "https://towardsdatascience.com/linear-regression-simplified-ordinary-least-square-vs-gradient-descent-48145de2cf76", "anchor_text": "Linear Regression Simplified \u2014 Ordinary Least Square vs Gradient DescentWhat is Linear Regression? Linear regression is a statistical method of finding the relationship between independent\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----be7e319e3a50---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/regression?source=post_page-----be7e319e3a50---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/covid-19?source=post_page-----be7e319e3a50---------------covid_19-----------------", "anchor_text": "Covid-19"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----be7e319e3a50---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/statistics?source=post_page-----be7e319e3a50---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe7e319e3a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&user=Ayushi+Jain&userId=86c908cc4ad4&source=-----be7e319e3a50---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe7e319e3a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&user=Ayushi+Jain&userId=86c908cc4ad4&source=-----be7e319e3a50---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe7e319e3a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbe7e319e3a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----be7e319e3a50---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----be7e319e3a50--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----be7e319e3a50--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----be7e319e3a50--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----be7e319e3a50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ayushijain09?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ayushijain09?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ayushi Jain"}, {"url": "https://medium.com/@ayushijain09/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "51 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F86c908cc4ad4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&user=Ayushi+Jain&userId=86c908cc4ad4&source=post_page-86c908cc4ad4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb81c1835801b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-regression-using-covid-19-dataset-detailed-analysis-be7e319e3a50&newsletterV3=86c908cc4ad4&newsletterV3Id=b81c1835801b&user=Ayushi+Jain&userId=86c908cc4ad4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}