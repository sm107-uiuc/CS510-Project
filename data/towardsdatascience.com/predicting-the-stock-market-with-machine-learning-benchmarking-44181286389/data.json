{"url": "https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-benchmarking-44181286389", "time": 1683005328.388195, "path": "towardsdatascience.com/predicting-the-stock-market-with-machine-learning-benchmarking-44181286389/", "webpage": {"metadata": {"title": "Predicting the Stock Market with Machine Learning. Benchmarking. | by Vitalii Dodonov | Towards Data Science", "h1": "Predicting the Stock Market with Machine Learning. Benchmarking.", "description": "This article describes the implementation details and the baseline performance of a Machine Learning model used to predict the Next Year\u2019s Income for S&P500 companies over the past 8 years. If you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/vhinny-investing/predicting-the-stock-market-with-machine-learning-introduction-310cd6069ffa?source=friends_link&sk=d4479bf5481f19b2b0b7ac9fe87366af", "anchor_text": "Predicting the Stock Market with Machine Learning. Introduction.", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-drivers-295d85d406e7?source=friends_link&sk=ceb5326ca92e917eceecb02beea7efbd", "anchor_text": "next article", "paragraph_index": 13}, {"url": "http://www.vhinny.com", "anchor_text": "www.vhinny.com", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 16}], "all_paragraphs": ["This article describes the implementation details and the baseline performance of a Machine Learning model used to predict the Next Year\u2019s Income for S&P500 companies over the past 8 years. If you haven\u2019t seen the introduction yet, please read Predicting the Stock Market with Machine Learning. Introduction. to get familiar with the context, problem statement and the approach I have chosen to solve it. Let\u2019s get started!", "A baseline model is a simple model used to establish a reference point and track one\u2019s progress efficiently. How do I know that I have made progress while developing various aspects of the Machine Learning pipeline? I know that I\u2019ve made progress when the new model performs better than the previous one. In this article, I\u2019m going to build this previous model which will be a benchmark for the next, more sophisticated model. In addition, it will help me establish some intuition about features that are important and help prioritize further development.", "The two most dangerous problems in Machine Learning, in my opinion, are Future Leakage and Overfitting.", "Future Leakage refers to including features representing information that is not available at the time of prediction into the training dataset. This is a time series problem. Hence, the first step of preventing future leakage is to make sure that the features used at each timestamp do not come from reports released after that timestamp \u2014 a quick validation but we are better be sure.", "Overfitting refers to training the model in such a way that it predicts the past very well (does a good job on the training set), but fails to predict the future. In case of this study, this problem may come from the notion of financial features not changing drastically year over year. If we include the same company at various timestamps in both training and validation sets and this company happens to continuously increase its income, the model would most likely learn what combination of features represents this company (which will yield correct predictions) instead of what combination of features drives the actual growth. I want my model to be making correct predictions on the companies it has never seen before. Hence, I need to make sure it learns trends in features and not the companies.", "With 8 years of history and 500 companies, I am going to use (2) years of historical data per company per timestamp. Since I need 2 years of historical data for each timestamp, the earliest year available for prediction is 2014 (where 2012 and 2013 make up features) and the latest is 2019 (where 2017 and 2018 make up features). I used years 2018 and 2019 as an out of sample holdout which will not be used to train the model. Instead, I will use it to evaluate and report model performance.", "The model is trained on years 2014 \u2013 2017 using Group K-Fold validation. With this approach, training involves using later years to predict earlier years, which was warned against in the Bias Awareness section. However, this is not a concern in this case because I use Group K-Fold sampling method to separate companies between training and validation by company ID and not randomly. If a company appears in the training set, it will not appear in the validation set at all, regardless of the year. At the same time, having (company A, 2016) in training and (company B, 2014) in validation does not introduce overfitting as cautioned in the Bias Awareness section because company B does not carry any insight into company A, unless targets for these two companies are strongly correlated.", "At this stage, I want a model that is simple to implement and which does not require much tuning. Logistic Regression would have been a good choice, but it requires careful consideration for handling NULLs as well as taking care of correlated features to have meaningful coefficients. XGBoost would probably be the best model for this problem in general, but it requires considerable effort to tune the parameters. I am going to implement a Random Forest instead. Unlike XGBoost, it can not handle NULLs by itself, but it has good performance out of the box and its feature importances are somewhat representative of what makes it predict high probabilities.", "A good way of evaluating a classification model is by looking at its lift curve. A lift curve allows me to answer the following question: \u201cIf I had picked top N predictions from the model, I would have been right in K number of cases out of P number of cases\u201d.", "Below is the lift curve for Class 5 that predicts whether the company doubles its income in the following year.", "This plot depicts three (3) scenarios, showing us the performance of our model, how a random guess would have performed, and how a perfect model would have performed on the holdout set. In this class, there were only ~12% positives so our model had to be quite selective. Let\u2019s assume we draw the top 8% of probabilities (vertical dotted line). The best model would have assigned the top 8% of probabilities to all positive samples, which would extract ~75% of all positive samples in our holdout set (top dotted line). Our model extracted 40% of all positives (middle dotted line), which is about half as good as the perfect model. A Random Guess had only 8% of all positives (bottom dotted line), which is five (5) times worse than our model.", "By moving up the probability ranks, the performance of my model gets closer to the performance of a perfect model. If I draw the top 4% of predictions, performance of my model will be almost perfect in exchange for giving me less options to choose from. While this might sound tempting, one should be cautious since the amount of data is not large enough and the top 4% makes only a few dozen samples.", "That being said, to be a successful investor, one probably needs only a dozen of companies. If done correctly, those would be in the top few percent.", "I have now benchmarked my performance on Class 5 with an out of the box Random Forest model. While this performance looks good, I still do not know what this model relies on to make its decisions. To find out, I\u2019m going to open the box and see what drives the predictions by looking at the feature importances. This would help me establish some intuition about the factors that drive an increase in the next year\u2019s income. See you in the next article.", "In this study, I am using historical Financial Data from www.vhinny.com. Vhinny\u2019s Alpha Dataset provides fundamental data, such as Balance Sheet, Income Statement and the Statement of Cash Flows, for 8+ years starting in 2011 for the S&P500 companies.", "I\u2019m happy to connect with people who share my path, which is the pursuit of financial independence. If you also search for financial independence or if you\u2019d like to collaborate, bounce ideas or exchange thoughts, feel free to reach out! Here are some resources I manage:", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-founder, Head of Engineering at Stan - enabling creators to become entrepreneurs."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F44181286389&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----44181286389--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----44181286389--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vitddnv?source=post_page-----44181286389--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vitddnv?source=post_page-----44181286389--------------------------------", "anchor_text": "Vitalii Dodonov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F650c747f45df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&user=Vitalii+Dodonov&userId=650c747f45df&source=post_page-650c747f45df----44181286389---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F44181286389&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F44181286389&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://stock.adobe.com/ca/images/glowing-forex-chart-background/275842087", "anchor_text": "Image"}, {"url": "https://stock.adobe.com/ca/contributor/201828616/peshkov?load_type=author&prev_url=detail", "anchor_text": "peshkov"}, {"url": "https://medium.com/vhinny-investing/predicting-the-stock-market-with-machine-learning-introduction-310cd6069ffa?source=friends_link&sk=d4479bf5481f19b2b0b7ac9fe87366af", "anchor_text": "Predicting the Stock Market with Machine Learning. Introduction."}, {"url": "https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-drivers-295d85d406e7?source=friends_link&sk=ceb5326ca92e917eceecb02beea7efbd", "anchor_text": "next article"}, {"url": "http://www.vhinny.com", "anchor_text": "www.vhinny.com"}, {"url": "http://www.vhinny.com", "anchor_text": "www.vhinny.com"}, {"url": "https://www.linkedin.com/company/vhinny", "anchor_text": "https://www.linkedin.com/company/vhinny"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/vhinny?source=post_page-----44181286389---------------vhinny-----------------", "anchor_text": "Vhinny"}, {"url": "https://medium.com/tag/investing?source=post_page-----44181286389---------------investing-----------------", "anchor_text": "Investing"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----44181286389---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----44181286389---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/tag/trading?source=post_page-----44181286389---------------trading-----------------", "anchor_text": "Trading"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F44181286389&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&user=Vitalii+Dodonov&userId=650c747f45df&source=-----44181286389---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F44181286389&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&user=Vitalii+Dodonov&userId=650c747f45df&source=-----44181286389---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F44181286389&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----44181286389--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F44181286389&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----44181286389---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----44181286389--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----44181286389--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----44181286389--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----44181286389--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----44181286389--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----44181286389--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----44181286389--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----44181286389--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vitddnv?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vitddnv?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vitalii Dodonov"}, {"url": "https://medium.com/@vitddnv/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "233 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F650c747f45df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&user=Vitalii+Dodonov&userId=650c747f45df&source=post_page-650c747f45df--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6950772ae056&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-benchmarking-44181286389&newsletterV3=650c747f45df&newsletterV3Id=6950772ae056&user=Vitalii+Dodonov&userId=650c747f45df&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}