{"url": "https://towardsdatascience.com/counsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da", "time": 1683007152.7002208, "path": "towardsdatascience.com/counsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da/", "webpage": {"metadata": {"title": "Counsel Chat: Bootstrapping High-Quality Therapy Data | by Nicolas Bertagnolli | Towards Data Science", "h1": "Counsel Chat: Bootstrapping High-Quality Therapy Data", "description": "This past year I was applying NLP to improve the quality of mental health care. One thing I found particularly difficult in this domain is the lack of high-quality data. Sure, you can go scrape\u2026"}, "outgoing_paragraph_urls": [{"url": "http://counselchat.com", "anchor_text": "counselchat.com", "paragraph_index": 1}, {"url": "https://github.com/nbertagnolli/counsel-chat", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.linkedin.com/in/grinlord/", "anchor_text": "Dr. Grin Lord", "paragraph_index": 2}, {"url": "http://www.counselchat.com", "anchor_text": "www.counselchat.com", "paragraph_index": 5}, {"url": "https://github.com/nbertagnolli/counsel-chat/tree/master/data", "anchor_text": "CSV", "paragraph_index": 5}, {"url": "https://counselchat.com/questions/do-i-have-too-many-issues-for-counseling", "anchor_text": "Do I have too many issues for counseling?", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/build-a-bert-sci-kit-transformer-59d60ddd54a5", "anchor_text": "other post", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/good-grams-how-to-find-predictive-n-grams-for-your-problem-c04a5f320b39", "anchor_text": "this post", "paragraph_index": 18}, {"url": "https://woebot.io/", "anchor_text": "woebot.io", "paragraph_index": 20}, {"url": "https://www.wysa.io/", "anchor_text": "wysa.com", "paragraph_index": 20}, {"url": "https://medium.com/huggingface/how-to-build-a-state-of-the-art-conversational-ai-with-transfer-learning-2d818ac26313", "anchor_text": "exceptional walkthrough", "paragraph_index": 21}, {"url": "https://github.com/huggingface/transfer-learning-conv-ai/blob/master/example_entry.py", "anchor_text": "here", "paragraph_index": 28}, {"url": "https://drive.google.com/open?id=19SKMlsiM2CY3Bk8jHMJxOs60kNS3O17I", "anchor_text": "here", "paragraph_index": 30}, {"url": "https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/", "anchor_text": "https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/", "paragraph_index": 35}], "all_paragraphs": ["This past year I was applying NLP to improve the quality of mental health care. One thing I found particularly difficult in this domain is the lack of high-quality data. Sure, you can go scrape Reddit and get some interesting therapeutic interactions between individuals, but in the author\u2019s opinion, this is a poor substitute for what an actual interaction between a client and a therapist is like. Don\u2019t get me wrong, there are datasets. They are just, more often than not, proprietary or pay to play.", "My hope with this post is to introduce a data set of reasonably high-quality therapist responses to mental health questions from real patients. I will discuss the data source, basic information about what is in the data set, and show some simple models we can train using this data culminating with training a chatbot! I am unaffiliated with counselchat.com, but I think they are doing good work and you should check them out. All code for this project is available here.", "An unfortunate fact about Medium is that it doesn\u2019t allow you to coauthor pieces. This was a joint project with Dr. Grin Lord who both suggested this project in the first place and helped with all of the analysis. Also with the help of the CounselChat Co-Founders, Eric Str\u00f6m and Phil Lee. Phil is a serial entrepreneur focused on innovative machine learning and data. Eric is an attorney and licensed Mental Health counselor.", "Counselchat.com is an example of an expert community. It is a platform to help counselors build their reputation and make meaningful contact with potential clients. On the site, therapists respond to questions posed by clients, and users can like responses that they find most helpful. It\u2019s a nice idea and lends itself to some interesting data.", "The coolest thing about this data is that there are verified therapists posting the responses. Not every reply is excellent, but we know that it comes from a domain expert. If you were using Reddit data the person providing advice could be anyone. Here we know that the individuals providing the advice are qualified counselors. Pretty neat! It is important to keep in mind that in-person interactions with a therapist are often very different from what we see publicly online. Another thing, this is not a dialogue between a therapist and a patient. It only involves a single talk turn.", "Initially, we scraped the data from www.counselchat.com. But after reaching out to the founders of counselchat.com for comment they provided us with all of their data for this article! That data dump of both the scraped data and true data is available here as a CSV. So special thanks to Philip and Eric for being so kind and willing to share what they\u2019ve built with the community. All analysis is done using my original scraped data.", "There are 31 topics on the forum, with the number of posted responses ranging from 317 for the topic of \u201cdepression\u201d to 3 for \u201cmilitary issues\u201d (Figure 1\u20133). There are 307 therapist contributors on the site, most of whom are located on the West Coast of the US (Washington, Oregon, California). They range in licensing from Ph.D. level psychologists, social workers, and licensed mental health counselors.", "The site had some duplication of questions and answers that appeared to be generated by the users themselves (e.g., where a therapist copy-pasted a response from one question to another similar question); we did not clean the data for this kind of duplication.", "The dataset is presented as a CSV with 10 columns described below:", "To work with the data you can use the HuggingFace datasets library.", "In general, most questions have only a few responses with 75% of questions having two or fewer total responses. However, many questions have a lot of therapist engagement. The most commented-on question is Do I have too many issues for counseling? It\u2019s nice to see such wonderful participation from therapists on questions like this. As a minor aside, one thing which I really enjoy about working with therapy data is that you get to see humanity\u2019s capacity for kindness and understanding.", "We can also observe some interesting trends in the topics. If we plot the number of questions by topic, we see that most questions are about depression, relationships, and intimacy.", "But, funnily enough, counseling-fundamentals jumped 12 places to take the number three spot in the number of responses. It looks like therapists have lots of opinions about therapy : ).", "In general, most questions are pretty short. The therapists seem to be providing much longer responses. The average question length is 54 words but the average response is 170 words long.", "Counselchat.com, like any good social website these days, has the ability to upvote a therapist\u2019s response to a question. If we take a look at the number of responses that have upvotes we can see that about 30% of responses get upvoted. Most responses did not receive upvotes. The range of upvotes for a single counselor response to a question was from 0 to 8; with the median response receiving 1 upvote.", "To see what might contribute to an upvote I trained a simple classifier using TF-IDF on n-grams, one using BERT features, and one that combined the two. Unfortunately predicting upvotes appears kind of difficult. Our first pass TF-IDF model\u2019s performance isn\u2019t great. By using BERT we can squeak out a little bit higher precision but still not good overall. For the BERT model, I used BERT as a feature extractor as I did in this other post.", "Looking beyond upvotes, classifying therapist responses into different categories is also interesting. It\u2019s sometimes useful to know if people are talking about depression, or maybe intimacy. To that end, I trained an SVM on TF-IDF features. Since BERT features didn\u2019t seem to be giving us all that much here I went with a more interpretable model.", "Unfortunately, performance on the validation set doesn\u2019t look great. If we look at support in the validation set we see that many topics only show up one or two times, so it\u2019s no surprise that we have basically no ability to predict these. Over time these results should improve with more data, especially as more people use the platform.", "I took a look at the top features for this model using the code I describe in this post. It looks like words related to drug use, duty, and loss pop up. It seems somewhat reasonable given that anxiety, depression, grief-and-loss could all be related to \u201closs.\u201d \u201cSubstance-abuse\u201d is also a category that I\u2019d bet \u201c12 step\u201d is pretty strongly correlated with. Anyway, it\u2019s good to spot check these models and make sure they are producing words that make some intuitive sense.", "I thought it might also be interesting to see how well BERT features divide the space so I created some simple UMAP 2D embeddings. We don\u2019t see a strong separation between the classes in general. However, different groups of topics do appear closer together in some cases and further apart in others. Take workplace relationships (purple) for example, it\u2019s very very close to relationship-dissolution (black), but completely separate from counseling fundamentals (bright green).", "Recently there has been an explosion of apps trying to make mental health more accessible using conversational agents, see woebot.io, or wysa.com to get an idea of what\u2019s out there. Since mental health bots are so hot right now I figured we should train one with our new data.", "Training reasonably good chatbots has become surprisingly easy. I don\u2019t want to do a tutorial on training chatbots here when Hugging Face has such an exceptional walkthrough. Though it\u2019s worth touching on some of my experiences. To train this chatbot I used their code almost verbatim. I made two tiny modifications to the code and had to parse the counselchat.com data into the correct form for their transformer based model. Ultimately, I had to write and modify less than 50 lines of code.", "The Hugging Face model is awesome for getting a pretty decent chatbot up and running without much data. I didn\u2019t want my bot to have any personality so I had to comment out line 93 inside the get_data_loaders function. This line makes some permutations of the existing persona, but I wasn\u2019t passing in any personas to the model so this is empty and needs to be commented out.", "The other thing that I did was place", "inside the pad_dataset function. BERT and GPT2 have some input size restrictions and when these are exceeded you can get some cryptic errors in the middle of training like:", "Adding this line helped me find out if any of my data was too big before running a model. It doesn\u2019t help the model at all but was super helpful when I was debugging : ).", "The data format for the Hugging Face transformer model seemed a bit confusing at first, but it was fairly easy to generate. The training data needs to be a JSON file with the following signature:", "Let\u2019s break this down a little bit. The larger JSON object has two main keys. \u201ctrain\u201d and \u201cvalid\u201d. Train is the training data and is a list of personality, utterances pairs. Valid is the same but for the validation set. The personality is a list of sentences defining the personality of the speaker. See the Hugging Face tutorial for more details on this. For my model, I simply left this blank to indicate no personality information. The candidates section holds a list of candidate responses. This list contains some non-optimal responses to the history of the conversation where the last sentence is the ground truth response. Lastly, we have to define the history. In general, this is a list of strings where each position holds a new talk turn. For our bot, we only have the two talk turns, one from the person asking the question and one as the therapist\u2019s response. So we just fill this in with the question. We do this because we are looking for good single responses to problems, not training a general therapist bot.", "If you want another example of how to format the data, Hugging Face has a good one in the repository you can find here.", "With the data properly formatted we can pass it directly to the Hugging Face model. I trained mine with the following specification:", "Voila! We have a chatbot trained on real therapist responses. If you\u2019d like to play with the model please download it here. Then all you need to do is unzip the file and run", "This will build the docker container for Hugging Face\u2019s conversational AI, and then run an interaction script with our trained model. If you get a docker error when building, try and increase the memory allowed for your container in Docker -> Preferences to something like 5GB. This seems to be a common problem when folks try and build this container.", "Here\u2019s an example of the dialogue! We can see that the model is a good listener. Providing advice, and some empathy and compassion. It also seems to be handy in apocalyptic scenarios offering to bring me tools.", "It\u2019s hard to get access to good therapist-patient interactions, but there is good data out there if you look around. Counselchat is an excellent source of limited quality therapist interactions. I hope you find some cool applications of this psychotherapy data in your field.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CAIO at mpathic. I\u2019m working on applying modern NLP techniques to improve communication. Let\u2019s connect https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F971b419f33da&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----971b419f33da--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----971b419f33da--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nbertagnolli.medium.com/?source=post_page-----971b419f33da--------------------------------", "anchor_text": ""}, {"url": "https://nbertagnolli.medium.com/?source=post_page-----971b419f33da--------------------------------", "anchor_text": "Nicolas Bertagnolli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa998d10e34d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=post_page-a998d10e34d8----971b419f33da---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F971b419f33da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F971b419f33da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@polina-zimmerman?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Polina Zimmerman"}, {"url": "https://www.pexels.com/photo/young-woman-talking-with-therapist-3958461/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "http://counselchat.com", "anchor_text": "counselchat.com"}, {"url": "https://github.com/nbertagnolli/counsel-chat", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/grinlord/", "anchor_text": "Dr. Grin Lord"}, {"url": "http://www.counselchat.com", "anchor_text": "www.counselchat.com"}, {"url": "https://github.com/nbertagnolli/counsel-chat/tree/master/data", "anchor_text": "CSV"}, {"url": "https://counselchat.com/questions/do-i-have-too-many-issues-for-counseling", "anchor_text": "Do I have too many issues for counseling?"}, {"url": "https://towardsdatascience.com/build-a-bert-sci-kit-transformer-59d60ddd54a5", "anchor_text": "other post"}, {"url": "https://towardsdatascience.com/good-grams-how-to-find-predictive-n-grams-for-your-problem-c04a5f320b39", "anchor_text": "this post"}, {"url": "https://woebot.io/", "anchor_text": "woebot.io"}, {"url": "https://www.wysa.io/", "anchor_text": "wysa.com"}, {"url": "https://medium.com/huggingface/how-to-build-a-state-of-the-art-conversational-ai-with-transfer-learning-2d818ac26313", "anchor_text": "exceptional walkthrough"}, {"url": "https://github.com/huggingface/transfer-learning-conv-ai/blob/master/example_entry.py", "anchor_text": "here"}, {"url": "https://drive.google.com/open?id=19SKMlsiM2CY3Bk8jHMJxOs60kNS3O17I", "anchor_text": "here"}, {"url": "https://medium.com/tag/python?source=post_page-----971b419f33da---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/ai?source=post_page-----971b419f33da---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/mental-health?source=post_page-----971b419f33da---------------mental_health-----------------", "anchor_text": "Mental Health"}, {"url": "https://medium.com/tag/data-science?source=post_page-----971b419f33da---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/psychology?source=post_page-----971b419f33da---------------psychology-----------------", "anchor_text": "Psychology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F971b419f33da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=-----971b419f33da---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F971b419f33da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=-----971b419f33da---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F971b419f33da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----971b419f33da--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F971b419f33da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----971b419f33da---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----971b419f33da--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----971b419f33da--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----971b419f33da--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----971b419f33da--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----971b419f33da--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----971b419f33da--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----971b419f33da--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----971b419f33da--------------------------------", "anchor_text": ""}, {"url": "https://nbertagnolli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nbertagnolli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nicolas Bertagnolli"}, {"url": "https://nbertagnolli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "286 Followers"}, {"url": "https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/", "anchor_text": "https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa998d10e34d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=post_page-a998d10e34d8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1205c8722589&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcounsel-chat-bootstrapping-high-quality-therapy-data-971b419f33da&newsletterV3=a998d10e34d8&newsletterV3Id=1205c8722589&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}