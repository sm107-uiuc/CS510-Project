{"url": "https://towardsdatascience.com/how-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1", "time": 1682997434.662536, "path": "towardsdatascience.com/how-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1/", "webpage": {"metadata": {"title": "How to resume an interrupted training session in fastai | by Aldo von Wangenheim | Towards Data Science", "h1": "How to resume an interrupted training session in fastai", "description": "What do you do if you have a huge dataset, a large and slow-to-train network and your training session was interrupted after several hours of training? This can happen for many reasons: The\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/search/cs?searchtype=author&query=Smith%2C+L+N", "anchor_text": "Leslie N. Smith papers.", "paragraph_index": 4}, {"url": "https://github.com/KushajveerSingh/Deep-Learning-Notebooks/blob/master/Leslie%20N.%20Smith%20paper%20notebooks%20(fastai)/main.ipynb", "anchor_text": "a very illustrative Jupyter notebook that is worth looking at", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/@nachiket.tanksale", "anchor_text": "Nachiket Tanksale", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/finding-good-learning-rate-and-the-one-cycle-policy-7159fe1db5d6", "anchor_text": "Finding Good Learning Rate and The One Cycle Policy", "paragraph_index": 5}, {"url": "https://www.inf.ufsc.br/~aldo.vw/", "anchor_text": "https://www.inf.ufsc.br/~aldo.vw/", "paragraph_index": 17}], "all_paragraphs": ["What do you do if you have a huge dataset, a large and slow-to-train network and your training session was interrupted after several hours of training? This can happen for many reasons:", "The fit_one_cycle() method employed by fast.ai works with varying, adaptive learning rates and momenta, following a curve where the rate is first increased and then decreased, whereas the momentum is treated oppositely, as shown in the figure below.", "If you interrupt a training in epoch #10 of, say, 20 epochs and then start again for more 9 epochs, you\u2019ll not have the same result as training uninterruptedly for 20 epochs, because a new training from scratch, even if you load the weights from the last epoch, will employ e fresh learning rate and momentum policy and go through the cycle again. What you want is to start from where you were interrupted in the cycle.", "Fit1cycle is a super-convergence policy developed by Leslie N. Smith. It is employed as the standard training policy in fast.ai. See below for details:", "If you want to look at more papers, follow this link: Leslie N. Smith papers. We will not enter into details in this posting. There are several postings on Medium presenting and discussing the fit1cycle training policy in an easy-to-read way:", "This last posting by Kushajveer Singh has a very illustrative Jupyter notebook that is worth looking at. There is also very interesting article from Nachiket Tanksale called Finding Good Learning Rate and The One Cycle Policy where cyclic learning rates and momentum are discussed.", "For this purpose, you have first to be able to record where you stopped and then resume the training cycle from that point and with the correct hyperparameters for that part of the cycle. The first thing you have to do is to save your network every epoch:", "This will have your network be saved every epoch, with the name you provided followed by _#epoch. So at epoch #3, the file saved_net_3.pth will be written. This file you can load after you:", "After reloading the .pth file, you can restart your training, only you\u2019ll tell fit_one_cycle again to consider 20 epochs, but to start training from epoch #4.", "Fast.ai employs special callbacks to do this. To learn details of how this is done, look here:", "The fit_one_cycle method in fast.ai has been developed to allow you to tell it from which part of the cycle to resume an interrupted training. The code for resuming a training will look like this:", "\u2026fast.ai will tell you \u201cLoaded <callback_save_file>_<previous_epoch#>\u201d and resume training.", "You can look at all parameters supported by the fit_one_cycle method here:", "This posting is focused on telling you how to be able to easily resume training in fast.ai, if interrupted. If you\u2019re novice to fast.ai, in order to find some context and learn how to integrate the code above into the whole process of training a network, look into our postings in TowardsDataScience below:", "In this posting we presented a brief overview of the super-convergence fit1cycle training policy employed by fast.ai and presented some easy-to-read posted material that you can use to dive deeper if you want, without having to read the scientific papers by Leslie N. Smith.", "We also have shown you how you can, in a very simple and practical way, employ a few additional parameters of the fit_one_cycle() method from fast.ai to perform fully interruptible and resumable training cycles.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Computer Sciences Professor at UFSC. I do research on image processing, artificial intelligence and telemedicine. https://www.inf.ufsc.br/~aldo.vw/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F77c4f36cd3a1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@awangenh?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awangenh?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": "Aldo von Wangenheim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41721572df3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&user=Aldo+von+Wangenheim&userId=41721572df3f&source=post_page-41721572df3f----77c4f36cd3a1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F77c4f36cd3a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F77c4f36cd3a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://docs.fast.ai/callbacks.one_cycle.html?source=post_page---------------------------", "anchor_text": "https://docs.fast.ai/callbacks.one_cycle.html"}, {"url": "https://arxiv.org/abs/1803.09820?source=post_page---------------------------", "anchor_text": "https://arxiv.org/abs/1803.09820"}, {"url": "https://arxiv.org/abs/1708.07120?source=post_page---------------------------", "anchor_text": "https://arxiv.org/abs/1708.07120"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Smith%2C+L+N", "anchor_text": "Leslie N. Smith papers."}, {"url": "https://link.medium.com/k7eBAlLwDY", "anchor_text": "Training Neural Networks upto 10x Faster by Karanbir Chahal;"}, {"url": "https://link.medium.com/D8uQlAFwDY", "anchor_text": "SuperConvergence with inbuilt regularization by Yogesh Gurjar;"}, {"url": "https://link.medium.com/SxYNKnqwDY", "anchor_text": "Super-Convergence: Very Fast Training of Neural Networks Using Large Learning Rates by Aditya Gupta;"}, {"url": "https://link.medium.com/tpmouPzwDY", "anchor_text": "Fast.ai Part1 v2/v3 Notes \u2014 Learning Rates \u2014 from SGDR to 1cycle and Super-Convergence by Roger Mao;"}, {"url": "http://Reproducing Leslie N. Smith\u2019s papers using fastai\u201d by Kushajveer Singh", "anchor_text": "Reproducing Leslie N. Smith\u2019s papers using fastai by Kushajveer Singh"}, {"url": "https://github.com/KushajveerSingh/Deep-Learning-Notebooks/blob/master/Leslie%20N.%20Smith%20paper%20notebooks%20(fastai)/main.ipynb", "anchor_text": "a very illustrative Jupyter notebook that is worth looking at"}, {"url": "https://towardsdatascience.com/@nachiket.tanksale", "anchor_text": "Nachiket Tanksale"}, {"url": "https://towardsdatascience.com/finding-good-learning-rate-and-the-one-cycle-policy-7159fe1db5d6", "anchor_text": "Finding Good Learning Rate and The One Cycle Policy"}, {"url": "https://github.com/PPPW/deep-learning-random-explore/tree/master/divide_1cycle?source=post_page---------------------------", "anchor_text": "Divide a long 1cycle policy into smaller ones \u2014 a GitHub by PPW"}, {"url": "https://docs.fast.ai/train.html?source=post_page---------------------------#fit_one_cycle", "anchor_text": "https://docs.fast.ai/train.html#fit_one_cycle"}, {"url": "https://towardsdatascience.com/deep-learning-for-diagnosis-of-skin-images-with-fastai-792160ab5495?source=post_page---------------------------", "anchor_text": "Deep Learning for Diagnosis of Skin Images with fastai \u2014 Learn to identify skin cancer and other conditions from dermoscopic images"}, {"url": "https://towardsdatascience.com/deep-learning-and-medical-image-analysis-for-malaria-detection-with-fastai-c8f08560262f?source=post_page---------------------------", "anchor_text": "Deep Learning and Medical Image Analysis for Malaria Detection with fastai"}, {"url": "https://towardsdatascience.com/artificial-intelligence-paleontology-use-deep-learning-to-search-for-microfossils-18760bb30880", "anchor_text": "Artificial Intelligence & Paleontology: Use Deep Learning to search for Microfossils"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----77c4f36cd3a1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----77c4f36cd3a1---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----77c4f36cd3a1---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/fastai?source=post_page-----77c4f36cd3a1---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/learning-rate?source=post_page-----77c4f36cd3a1---------------learning_rate-----------------", "anchor_text": "Learning Rate"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F77c4f36cd3a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&user=Aldo+von+Wangenheim&userId=41721572df3f&source=-----77c4f36cd3a1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F77c4f36cd3a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&user=Aldo+von+Wangenheim&userId=41721572df3f&source=-----77c4f36cd3a1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F77c4f36cd3a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F77c4f36cd3a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----77c4f36cd3a1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----77c4f36cd3a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awangenh?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awangenh?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aldo von Wangenheim"}, {"url": "https://medium.com/@awangenh/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "121 Followers"}, {"url": "https://www.inf.ufsc.br/~aldo.vw/", "anchor_text": "https://www.inf.ufsc.br/~aldo.vw/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41721572df3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&user=Aldo+von+Wangenheim&userId=41721572df3f&source=post_page-41721572df3f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F41721572df3f%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-resume-an-interrupted-training-session-in-fastai-77c4f36cd3a1&user=Aldo+von+Wangenheim&userId=41721572df3f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}