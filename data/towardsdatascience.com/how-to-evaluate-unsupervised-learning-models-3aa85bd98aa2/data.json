{"url": "https://towardsdatascience.com/how-to-evaluate-unsupervised-learning-models-3aa85bd98aa2", "time": 1683007407.870025, "path": "towardsdatascience.com/how-to-evaluate-unsupervised-learning-models-3aa85bd98aa2/", "webpage": {"metadata": {"title": "How To Evaluate Unsupervised Learning Models | by Callum Ballard | Towards Data Science", "h1": "How To Evaluate Unsupervised Learning Models", "description": "So far in this blog series, we have looked at how to create automated playlists of songs by clustering a collection of tracks, based purely on their audio features. Previously, we worked on a toy\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/tagged/music-by-numbers", "anchor_text": "this blog series", "paragraph_index": 0}, {"url": "https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/", "anchor_text": "audio features", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/generating-spotify-playlists-with-unsupervised-learning-abac60182022", "anchor_text": "toy example of 32 songs", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Hierarchical_clustering#Agglomerative_clustering_example", "anchor_text": "Hierarchical Agglomerative Clustering", "paragraph_index": 0}, {"url": "https://www.youtube.com/watch?v=pWB5JZRGl0U", "anchor_text": "Mot\u00f6rhead", "paragraph_index": 0}, {"url": "https://www.youtube.com/watch?v=0qanF-91aJo", "anchor_text": "Black Sabbath", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/generating-spotify-playlists-with-unsupervised-learning-abac60182022", "anchor_text": "previous blog", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Rand_index#Adjusted_Rand_index", "anchor_text": "Adjusted Rand Index", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Fowlkes%E2%80%93Mallows_index", "anchor_text": "Fowlkes Mallow Score", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Silhouette_(clustering)", "anchor_text": "Silhouette Score", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/tagged/music-by-numbers", "anchor_text": "Music By Numbers", "paragraph_index": 27}, {"url": "https://www.linkedin.com/in/callum-ballard/", "anchor_text": "LinkedIn", "paragraph_index": 27}], "all_paragraphs": ["So far in this blog series, we have looked at how to create automated playlists of songs by clustering a collection of tracks, based purely on their audio features. Previously, we worked on a toy example of 32 songs and showed how Hierarchical Agglomerative Clustering (HAC) can automatically create sub-groups of similar songs. We were able to verify the results of this clustering exercise through our existing knowledge of the songs (our algorithm confirmed that Mot\u00f6rhead and Black Sabbath are musically similar \u2014 go figure).", "But what if we don\u2019t have such prior knowledge of our data? What if the data isn\u2019t even labelled (as is the case in many real-life clustering cases)? Even if it is, what if these labels are initially meaningless to us? There are plenty of artists that I\u2019ve never even heard of, and if we\u2019re trying to group thousands of tracks then it\u2019s clearly impractical to manually verify every cluster. In these cases, we need some kind of mathematical measure for how \u2018successful\u2019 our clustering has been.", "To explore how we might go about doing this, we once again turn to Spotify\u2019s API. Suppose we take the songs from four very different playlists:", "If we merge these into a single dataset, an unsupervised machine learning algorithm ought to be able to group their songs into four clusters that somewhat resemble the original four playlists.", "Before we get started, we may indeed want to check our assumption that songs from these diverse playlists are indeed \u2018different\u2019. Of course, visualising more than two features simultaneously on a single chart is challenging. However, if we plot a scatter matrix of all features, colour-coded by playlist, we can see that there are plenty of metric combinations that demonstrate the distinct characteristics of each genre.", "We saw in the previous blog that running a clustering algorithm in Scikit-Learn is very simple:", "We also saw that HAC has three different \u2018linkage criteria\u2019 \u2014 the method by which the algorithm iteravely joins clusters together:", "Let\u2019s see how these three linkage criteria deal with the genre playlist dataset. We represent our results in a matrix, showing what percentage of each playlist\u2019s songs have ended up in each cluster (the clusters have been named, arbitrarily, \u2018A\u2019, \u2018B\u2019, \u2018C\u2019, and \u2018D\u2019).", "Of course, if the clustering had been pefect, we\u2019d expect each row and each column of the matrix to contain exactly one entry of 100% (it needn\u2019t be in a diagonal, of course, since the cluster name assignment is arbitrary).", "It\u2019s worth mentioning that there is another common type of clustering, K-Means, which works slightly differently. Whereas HAC iteratively decreases the number of clusters by merging them together, K-Means clustering maintains a fixed number of clusters (the titular k), but iteratively changes the members of each cluster.", "K-Means is simple to implement in Python:", "If we apply K-Means clustering to the playlist dataset, we get the following:", "While these matrices are good for \u2018eyeballing\u2019 our results, they\u2019re far from mathematically rigorous. Let\u2019s consider some metrics to actually help us assign a number to our cluster quality.", "The Adjusted Rand Index is a variation on the classic Rand Index, and attempts to express what proportion of the cluster assignments are \u2018correct\u2019. It computes a similarity measure between two different clusterings by considering all pairs of samples, and counting pairs that are assigned in the same or different clusters predicted, against the true clusterings, adjusting for random chance.", "This (as well as the other metrics we\u2019ll consider) can be evaluated using Scikit-Learn.", "The Adjusted Rand index is bounded between -1 and 1. Closer to 1 is good, while closer to -1 is bad.", "We see that K-Means and Ward Linkage have a high score. We\u2019d expect this, based on the matrices we previously observed.", "The Fowlkes Mallow Score is similar, in as much that it tells you the degree to which cluster assignments are \u2018correct\u2019. In particular, it calculates the geometric mean between precision and recall. It\u2019s bounded between 0 and 1, with higher values being better.", "We similar rankings to the Adjusted Rand Index \u2014 which we would expect, given that they\u2019re two methods of trying to answer the same question.", "It\u2019s worth noting that we needed to know the original labels in order to compute these metrics. Given that dealing with unlabelled data is one of the main use cases of unsupervised learning, we require some other metrics that evaluate clustering results without needing to refer to \u2018true\u2019 labels.", "Suppose we have the following results from three separate clustering analyses.", "Evidently, the \u2018tighter\u2019 we can make our clusters, the better. Is there some way to ascribe a number to this idea of \u2018tightness\u2019?", "The Silhouette Score attempts to describe how similar a datapoint is to other datapoints in its cluster, relative to datapoints not in its cluster (this is aggregated over all datapoints to get the score for an overall clustering). In other words, it thinks about how \u2018distinct\u2019 the clusters are in space \u2014 indeed one could use any measure of \u2018distance\u2019 to calculate the score.", "It is bounded between -1 and 1. Closer to -1 suggests incorrect clustering, while closer to +1 shows that each cluster is very dense.", "We see that none of the clusters have super-high Silhouette Scores. Interestingly, we see that the Average Linkage clusters have the highest scores. Remember, however, that this algorithm produced two clusters that each contained just a single datapoint, which is unlikely to be a desirable outcome in a real-world situation (a lesson that you often can\u2019t rely on a single metric to make decisions about the quality of an algorithm!)", "The Calinski Harabaz Index is the ratio of the variance of a datapoint compared to points in other clusters, against the variance compared to points within its cluster. Since we want this first part to be high, and the second part to be low, a high CH index is desirable. Unlike other metrics we have seen, this score is not bounded.", "Here we see that our K-Means and Ward Linkage algorithms score highly. The Complete and Average linkage algorithms are punished for having one or two large clusters, which will have a higher level of intra-variance.", "This is the latest blog in my \u2018Music By Numbers\u2019 column, which uses data to tell stories about music. I\u2019d love to hear any comments about the above analysis \u2014 feel free to leave a message below, or reach out to me through LinkedIn!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analysis Lead at Cleo AI, McKinsey & LSE Alumni, previously published in The Economist. Typically found listening to Japanese Math Rock..."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3aa85bd98aa2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@callumballard?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@callumballard?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": "Callum Ballard"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3bcc53c95269&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&user=Callum+Ballard&userId=3bcc53c95269&source=post_page-3bcc53c95269----3aa85bd98aa2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3aa85bd98aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3aa85bd98aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/music-by-numbers", "anchor_text": "Music By Numbers"}, {"url": "https://www.pexels.com/video/musical-instruments-856945/", "anchor_text": "Pexels"}, {"url": "https://towardsdatascience.com/tagged/music-by-numbers", "anchor_text": "this blog series"}, {"url": "https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/", "anchor_text": "audio features"}, {"url": "https://towardsdatascience.com/generating-spotify-playlists-with-unsupervised-learning-abac60182022", "anchor_text": "toy example of 32 songs"}, {"url": "https://en.wikipedia.org/wiki/Hierarchical_clustering#Agglomerative_clustering_example", "anchor_text": "Hierarchical Agglomerative Clustering"}, {"url": "https://www.youtube.com/watch?v=pWB5JZRGl0U", "anchor_text": "Mot\u00f6rhead"}, {"url": "https://www.youtube.com/watch?v=0qanF-91aJo", "anchor_text": "Black Sabbath"}, {"url": "https://open.spotify.com/playlist/37i9dQZF1DX6PKX5dyBKeq?si=troGGkf6SLSP5JhYBP3dZQ", "anchor_text": "Rap UK"}, {"url": "https://open.spotify.com/playlist/37i9dQZF1DXdwTUxmGKrdN?si=hR5UZpPmSdy2l4-JKgNDcw", "anchor_text": "Smooth Jazz"}, {"url": "https://open.spotify.com/playlist/37i9dQZF1DWWEJlAGA9gs0?si=LCS9EwdhTCi_Lx4Cyu_QfQ", "anchor_text": "Classical Essentials"}, {"url": "https://open.spotify.com/playlist/37i9dQZF1DX14fiWYoe7Oh?si=lczQeag8T2SP0NOVpVUImw", "anchor_text": "Essential K-Pop"}, {"url": "https://towardsdatascience.com/generating-spotify-playlists-with-unsupervised-learning-abac60182022", "anchor_text": "previous blog"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Rand_index#Adjusted_Rand_index", "anchor_text": "Adjusted Rand Index"}, {"url": "https://en.wikipedia.org/wiki/Fowlkes%E2%80%93Mallows_index", "anchor_text": "Fowlkes Mallow Score"}, {"url": "https://en.wikipedia.org/wiki/Silhouette_(clustering)", "anchor_text": "Silhouette Score"}, {"url": "https://towardsdatascience.com/tagged/music-by-numbers", "anchor_text": "Music By Numbers"}, {"url": "https://www.linkedin.com/in/callum-ballard/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----3aa85bd98aa2---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/music-by-numbers?source=post_page-----3aa85bd98aa2---------------music_by_numbers-----------------", "anchor_text": "Music By Numbers"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3aa85bd98aa2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3aa85bd98aa2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----3aa85bd98aa2---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3aa85bd98aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&user=Callum+Ballard&userId=3bcc53c95269&source=-----3aa85bd98aa2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3aa85bd98aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&user=Callum+Ballard&userId=3bcc53c95269&source=-----3aa85bd98aa2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3aa85bd98aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3aa85bd98aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3aa85bd98aa2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3aa85bd98aa2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@callumballard?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@callumballard?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Callum Ballard"}, {"url": "https://medium.com/@callumballard/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3bcc53c95269&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&user=Callum+Ballard&userId=3bcc53c95269&source=post_page-3bcc53c95269--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F107151aaecd0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-evaluate-unsupervised-learning-models-3aa85bd98aa2&newsletterV3=3bcc53c95269&newsletterV3Id=107151aaecd0&user=Callum+Ballard&userId=3bcc53c95269&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}