{"url": "https://towardsdatascience.com/the-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48", "time": 1683004540.276909, "path": "towardsdatascience.com/the-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48/", "webpage": {"metadata": {"title": "The 4 steps necessary before fitting a machine learning model | by Dimitris Poulopoulos | Towards Data Science", "h1": "The 4 steps necessary before fitting a machine learning model", "description": "The goal of the story is to provide a general idea on how to structure code that process data before fitting a machine learning model."}, "outgoing_paragraph_urls": [{"url": "https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter", "anchor_text": "Learning Rate", "paragraph_index": 0}, {"url": "https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Software_design_pattern", "anchor_text": "design pattern", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Object-oriented_programming", "anchor_text": "object-oriented programming", "paragraph_index": 4}, {"url": "https://pytorch.org/docs/stable/data.html#data-loading-order-and-sampler", "anchor_text": "documentation", "paragraph_index": 11}, {"url": "https://bigdatastack.eu/", "anchor_text": "BigDataStack", "paragraph_index": 21}, {"url": "https://medium.com/@dpoulopoulos", "anchor_text": "Medium", "paragraph_index": 21}, {"url": "https://www.linkedin.com/in/dpoulopoulos/", "anchor_text": "LinkedIn", "paragraph_index": 21}, {"url": "https://twitter.com/james2pl", "anchor_text": "@james2pl", "paragraph_index": 21}, {"url": "http://www.dimpo.me", "anchor_text": "www.dimpo.me", "paragraph_index": 23}], "all_paragraphs": ["Learning Rate is a newsletter for those who are curious about the world of AI and MLOps. You\u2019ll hear from me every Friday with updates and thoughts on the latest AI news and articles. Subscribe here!", "There are many steps in a common machine learning pipeline and much thought that goes into architecting it. There is the problem definition, data acquisition, error detection and data cleaning, etc. In this story, we begin with the assumption that we have a clean and ready to go dataset.", "With that in mind, we outline the four steps necessary before fitting any machine learning model. We then implement those steps in Pytorch, using a common syntax for invoking multiple method calls; method chaining. The goal is to define a simple yet generalizable API, that transforms any raw dataset into a format that is ready to be consumed by a machine learning model.", "To this end, we will use the build pattern, which constructs a complex object using a step by step approach.", "The builder pattern is a design pattern, which provides a flexible solution to object creation problems in object-oriented programming. Its aim is to separate the construction of a complex object from its representation.", "So, what are those 4 things? In its most simple case, processing data before modelling includes four distinct actions:", "In the following sections, I analyze those four steps one-by-one and implement them in code. Our goal is to finally create a PyTorch DataLoader, an abstraction PyTorch uses to represent an iterable over a dataset. Having a DataLoader is the first step in setting up the training loop. So, without further ado, let us get our hands dirty.", "For this example, we use a mock dataset that is kept in a pandas DataFrame format. Our goal is to create one PyTorch Dataloader class for the training set and one for the validation set. Thus, let us build a class named DataLoaderBuilder that is responsible for building those classes.", "We see that the only operation of the DataLoaderBuilder is to store a data variable, which type is a torch.tensor. So now, we need a way to initialize it from a pandas DataFrame. For that, we use a python classmethod.", "The classmethod is a plain python class method, but instead of receiving self as the first argument it receives a class. Thus, given a pandas DataFrame, we turn the DataFrame into a PyTorch tensor and instantiate the DataLoaderBuilder class, that is passed to the method as the cls argument. Optionally, we can keep only the columns of the DataFrame we care about. After defining it, we patch it to the main DataLoaderBuilder class.", "For this example, we split the dataset into two sets; training and validation. It is easy to extend the code and split it into three sets; training, validation and testing.", "We want to split the dataset randomly, and keep some percentage of the data for training and set aside what is left for validation. To this end, we use Pytorch\u2019s SubsetRandomSampler. You can read more about this sampler and many more sampling methods in the official PyTorch documentation.", "By default, we keep 90% of the data for training and we split across rows (axis=0). Another detail in the code is that we return self. Thus, after creating the train_data and valid_data splits, we return back the whole class. This will permit as to use method chaining in the end.", "Next, we should label the dataset. Most of the time, we use some feature variables to predict a depended variable (i.e. the target). That is, of course, called supervise learning. The label_by_func method annotates the dataset according to a given function. After this call, the dataset is usually converted to (features, target) tuples.", "We see that the label_by_func method accepts a function as an argument and applies it to the train and valid sets. Our job is to design a function that serves our purposes any time we want to label a dataset of some form. Later in the \u201cputting it all together\u201d example we show how simple it is to create such a function.", "Finally, only one step is left; break the dataset into batches. For this, we can leverage PyTorch\u2019s TensorDataset and DataLoader classes.", "This is the last method in the chain, thus, we name it \u201cbuild\u201d. It creates the train and valid datasets and having them it is easy to instantiate the corresponding Pytorch DataLoader, with a known batch size. Keep in mind that we now have labelled the data, thus, self.train_data is a tuple of features and a target variable. Consequently, self.train_data[0] keeps the features and self.train_data[1] holds the target.", "Having that in place, let us put it all together with a simple example.", "In this example, we create a dummy dataset of three columns, where the last column stores the target or depended variable. We then define a get_label function, that pulls the last column and creates a features-target tuple. Finally, using method chaining we can easily create the data loaders we need from a given pandas DataFrame.", "In this story, we saw what are the four necessary steps of data processing before fitting any model, assuming that the dataset is clean. Although this is a toy example, it can be used and extended to cover a wide variety of machine learning problems.", "Also, there are steps that are not covered in this article (e.g. data normalization or augmentation for computer vision) but the goal of the story is to provide a general idea on how to structure code that solves a relevant problem.", "My name is Dimitris Poulopoulos and I\u2019m a machine learning researcher at BigDataStack and PhD(c) at the University of Piraeus, Greece. I have worked on designing and implementing AI and software solutions for major clients such as the European Commission, Eurostat, IMF, the European Central Bank, OECD, and IKEA. If you are interested in reading more posts about Machine Learning, Deep Learning and Data Science, follow me on Medium, LinkedIn or @james2pl on twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer. I talk about AI, MLOps, and Python programming. More about me: www.dimpo.me"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F574bf8f1cd48&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dpoulopoulos.medium.com/?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": "Dimitris Poulopoulos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cc87df5b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=post_page-7cc87df5b1----574bf8f1cd48---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F574bf8f1cd48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F574bf8f1cd48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chuttersnap?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "chuttersnap"}, {"url": "https://unsplash.com/s/photos/pipes?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter", "anchor_text": "Learning Rate"}, {"url": "https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Software_design_pattern", "anchor_text": "design pattern"}, {"url": "https://en.wikipedia.org/wiki/Object-oriented_programming", "anchor_text": "object-oriented programming"}, {"url": "https://pytorch.org/docs/stable/data.html#data-loading-order-and-sampler", "anchor_text": "documentation"}, {"url": "https://bigdatastack.eu/", "anchor_text": "BigDataStack"}, {"url": "https://medium.com/@dpoulopoulos", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/dpoulopoulos/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/james2pl", "anchor_text": "@james2pl"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----574bf8f1cd48---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----574bf8f1cd48---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-pipeline?source=post_page-----574bf8f1cd48---------------data_pipeline-----------------", "anchor_text": "Data Pipeline"}, {"url": "https://medium.com/tag/data-processing?source=post_page-----574bf8f1cd48---------------data_processing-----------------", "anchor_text": "Data Processing"}, {"url": "https://medium.com/tag/programming?source=post_page-----574bf8f1cd48---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F574bf8f1cd48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=-----574bf8f1cd48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F574bf8f1cd48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=-----574bf8f1cd48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F574bf8f1cd48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F574bf8f1cd48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----574bf8f1cd48---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----574bf8f1cd48--------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dimitris Poulopoulos"}, {"url": "https://dpoulopoulos.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12.5K Followers"}, {"url": "http://www.dimpo.me", "anchor_text": "www.dimpo.me"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cc87df5b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=post_page-7cc87df5b1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb5ab149102ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-4-steps-necessary-before-fitting-a-machine-learning-model-574bf8f1cd48&newsletterV3=7cc87df5b1&newsletterV3Id=b5ab149102ea&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}