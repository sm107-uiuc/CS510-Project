{"url": "https://towardsdatascience.com/using-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4", "time": 1682993788.435157, "path": "towardsdatascience.com/using-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4/", "webpage": {"metadata": {"title": "Predict Tomorrow\u2019s Bitcoin (BTC) Price with Recurrent Neural Networks | by Orhan G. Yal\u00e7\u0131n | Towards Data Science", "h1": "Predict Tomorrow\u2019s Bitcoin (BTC) Price with Recurrent Neural Networks", "description": "Using Historical Bitcoin Price Data and Deep Learning, we can predict the future value of the most popular cryptocurrency thanks to LSTMs"}, "outgoing_paragraph_urls": [{"url": "https://linkedin.com/in/orhangaziyalcin/", "anchor_text": "Linkedin", "paragraph_index": 0}, {"url": "https://linkedin.com/in/orhangaziyalcin/", "anchor_text": "Orhan G. Yal\u00e7\u0131n \u2014 Linkedin", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Recurrent_neural_network", "anchor_text": "Wikipedia", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 39}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 39}, {"url": "http://Vizio.ai", "anchor_text": "Vizio.ai", "paragraph_index": 41}], "all_paragraphs": ["If you are reading this article, I am sure that we share similar interests and are/will be in similar industries. So let\u2019s connect via Linkedin! Please do not hesitate to send a contact request! Orhan G. Yal\u00e7\u0131n \u2014 Linkedin", "Wouldn\u2019t it be awesome if you were, somehow, able to predict tomorrow\u2019s Bitcoin (BTC) price? As you all know, the cryptocurrency market has experienced tremendous volatility over the last year. The value of Bitcoin reached its peak on December 16, 2017, by climbing to nearly $20,000, and then it has seen a steep decline at the beginning of 2018. Not long ago, though, a year ago, to be precise, its value was almost half of what it is today. Therefore, if we look at the yearly BTC price chart, we may easily see that the price is still high. The fact that only two years ago, BTC\u2019s value was only the one-tenth of its current value is even more shocking. You may personally explore the historical BTC prices using this plot below:", "There are several conspiracies regarding the precise reasons behind this volatility, and these theories are also used to support the prediction reasoning of crypto prices, particularly of BTC. These subjective arguments are valuable to predict the future of cryptocurrencies. On the other hand, our methodology evaluates historical data to predict the cryptocurrency prices from an algorithmic trading perspective. We plan to use numerical historical data to train a recurrent neural network (RNN) to predict BTC prices.", "There are quite a few resources we may use to obtain historical Bitcoin price data. While some of these resources allow the users to download CSV files manually, others provide an API that one can hook up to his code. Since when we train a model using time series data, we would like it to make up-to-date predictions, I prefer to use an API to obtain the latest figures whenever we run our program. After a quick search, I have decided to use CoinRanking.com\u2019s API, which provides up-to-date coin prices that we can use in any platform.", "Since we are using a time series dataset, it is not viable to use a feedforward neural network as tomorrow\u2019s BTC price is most correlated with today\u2019s, not a month ago\u2019s.", "A recurrent neural network (RNN) is a class of artificial neural network where connections between nodes form a directed graph along a sequence. \u2014 Wikipedia", "An RNN shows temporal dynamic behavior for a time sequence, and it can use its internal state to process sequences. In practice, this can be achieved with LSTMs and GRUs layers.", "Here you can see the difference between a regular feedforward-only neural network and a recurrent neural network (RNN):", "To be able to create a program that trains on the historical BTC prices and predict tomorrow\u2019s BTC price, we need to complete several tasks as follows:", "1 \u2014 Obtaining, Cleaning, and Normalizing the Historical BTC Prices", "2 \u2014 Building an RNN with LSTM", "3 \u2014 Training the RNN and Saving The Trained Model", "4 \u2014 Predicting Tomorrow\u2019s BTC Price and \u201cDeserialize\u201d It", "BONUS: Deserializing the X_Test Predictions and Creating a Plot.ly Chart", "As I mentioned above, we will use CoinRanking.com\u2019s API for the BTC dataset and convert it into a Pandas dataframe with the following code:", "This function is adjusted for 5-years BTC/USD prices by default. However, you may always change these values by passing in different parameter values.", "After obtaining the data and converting it to a pandas dataframe, we may define custom functions to clean our data, normalize it for a neural network as it is a must for accurate results, and apply a custom train-test split. We created a custom train-test split function (not the scikit-learn\u2019s) because we need to keep the time-series in order for training our RNN properly. We may achieve this with the following code, and you may find further function explanations in the code snippet below:", "After defining these functions, we may call them with the following code:", "After preparing our data, it is time for building the model that we will later train by using the cleaned&normalized data. We will start by importing our Keras components and setting some parameters with the following code:", "Then, we will create our Sequential model with two LSTM and two Dense layers with the following code:", "Now it is time to train our model with the cleaned data. You can also measure the time spent during the training. Follow these codes:", "I am keen to save the model and load it later because it is quite satisfying to know that you can actually save a trained model and re-load to use it next time. This is basically the first step for web or mobile integrated machine learning applications.", "After we train the model, we need to obtain the current data for predictions, and since we normalize our data, predictions will also be normalized. Therefore, we need to de-normalize back to their original values. Firstly, we will obtain the data with a similar, partially different, manner with the following code:", "We will only have the normalized data for prediction: No train-test split. We will also reshape the data manually to be able to use it in our saved model.", "After cleaning and preparing our data, we will load the trained RNN model for prediction and predict tomorrow\u2019s price.", "However, our results will vary between -1 and 1, which will not make a lot of sense. Therefore, we need to de-normalize them back to their original values. We can achieve this with a custom function:", "After defining the custom function, we will call these function and extract tomorrow\u2019s BTC prices with the following code:", "With the code above, you can actually get the model\u2019s prediction for tomorrow\u2019s BTC prices.", "You may also be interested in the overall result of the RNN model and prefer to see it as a chart. We can also achieve these by using our X_test data from the training part of the tutorial.", "We will start by loading our model (consider this as an alternative to the single prediction case) and making the prediction on X_test data so that we can make predictions for a proper number of days for plotting with the following code:", "Next, we will import Plotly and set the properties for a good plotting experience. We will achieve this with the following code:", "After setting all the properties, we can finally plot our predictions and observation values with the following code:", "When you run this code, you will come up with the up-to-date version of the following plot:", "As you can see, it does not look bad at all. However, you need to know that even though the patterns match pretty closely, the results are still dangerously apart from each other if you inspect the results on a day-to-day basis. Therefore, the code must be further developed to get better results.", "You have successfully created and trained an RNN model that can predict BTC prices, and you even saved the trained model for later use. You may use this trained model on a web or mobile application by switching to Object-Oriented Programming. Pat yourself on the back for successfully developing a model relevant to artificial intelligence, blockchain, and finance. I think it sounds pretty cool to touch these areas all at once with this simple project.", "If you would like to have access to full code on Google Colab and have access to my latest content, consider subscribing to the mailing list: \u2709\ufe0f", "If you like this article, consider checking out my other similar articles:", "Information published on this website has been prepared for general information purposes only and not as specific advice to any particular person. Any advice contained in this article is General Advice and does not take into account any person\u2019s particular investment objectives, financial situation, and particular needs.", "Before making an investment decision based on this advice, you should consider, with or without the assistance of a qualified adviser, whether it is appropriate to your particular investment needs, objectives, and financial circumstances. The past performance of financial products is no assurance of future performance.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about AI and data apps here building them at Vizio.ai with my team. Feel free to get in touch!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc4ff70f9f3e4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://blog.orhangaziyalcin.com/?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": ""}, {"url": "https://blog.orhangaziyalcin.com/?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": "Orhan G. Yal\u00e7\u0131n"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff47ab81282a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=post_page-ff47ab81282a----c4ff70f9f3e4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4ff70f9f3e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4ff70f9f3e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://linkedin.com/in/orhangaziyalcin/", "anchor_text": "Linkedin"}, {"url": "https://linkedin.com/in/orhangaziyalcin/", "anchor_text": "Orhan G. Yal\u00e7\u0131n \u2014 Linkedin"}, {"url": "https://unsplash.com/photos/iGYiBhdNTpE?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Andre Francois"}, {"url": "https://unsplash.com/search/photos/bitcoin?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.coindesk.com/price/", "anchor_text": "CoinDesk"}, {"url": "https://en.wikipedia.org/wiki/Recurrent_neural_network", "anchor_text": "Wikipedia"}, {"url": "https://towardsdatascience.com/recurrent-neural-networks-and-lstm-4b601dd822a5", "anchor_text": "TowardsDataScience"}, {"url": "http://eepurl.com/hd6Xfv", "anchor_text": "Subscribe Now"}, {"url": "https://towardsdatascience.com/image-noise-reduction-in-10-minutes-with-convolutional-autoencoders-d16219d2956a", "anchor_text": "Image Noise Reduction in 10 Minutes with Convolutional AutoencodersUsing Deep Convolutional Autoencoders to Clean (or Denoise) Noisy Images with the help of Fashion MNIST | Unsupervised\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/image-classification-in-10-minutes-with-mnist-dataset-54c35b77a38d", "anchor_text": "Image Classification in 10 Minutes with MNIST DatasetUsing Convolutional Neural Networks to Classify Handwritten Digits with TensorFlow and Keras | Supervised Deep Learningtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/image-generation-in-10-minutes-with-generative-adversarial-networks-c2afc56bfa3b", "anchor_text": "Image Generation in 10 Minutes with Generative Adversarial NetworksUsing Unsupervised Deep Learning to Generate Handwritten Digits with Deep Convolutional GANs using TensorFlow and the\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/fast-neural-style-transfer-in-5-minutes-with-tensorflow-hub-magenta-110b60431dcc", "anchor_text": "Fast Neural Style Transfer in 5 Minutes with TensorFlow Hub & MagentaTransferring the van Gogh\u2019s Unique Style to Photos with Magenta\u2019s Arbitrary Image Stylization Network and Deep Learningtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c4ff70f9f3e4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recurrent-neural-network?source=post_page-----c4ff70f9f3e4---------------recurrent_neural_network-----------------", "anchor_text": "Recurrent Neural Network"}, {"url": "https://medium.com/tag/bitcoin?source=post_page-----c4ff70f9f3e4---------------bitcoin-----------------", "anchor_text": "Bitcoin"}, {"url": "https://medium.com/tag/algorithmic-trading?source=post_page-----c4ff70f9f3e4---------------algorithmic_trading-----------------", "anchor_text": "Algorithmic Trading"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----c4ff70f9f3e4---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4ff70f9f3e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=-----c4ff70f9f3e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4ff70f9f3e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=-----c4ff70f9f3e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4ff70f9f3e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc4ff70f9f3e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c4ff70f9f3e4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c4ff70f9f3e4--------------------------------", "anchor_text": ""}, {"url": "https://blog.orhangaziyalcin.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://blog.orhangaziyalcin.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Orhan G. Yal\u00e7\u0131n"}, {"url": "https://blog.orhangaziyalcin.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "http://Vizio.ai", "anchor_text": "Vizio.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff47ab81282a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=post_page-ff47ab81282a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6340e0deb03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-recurrent-neural-networks-to-predict-bitcoin-btc-prices-c4ff70f9f3e4&newsletterV3=ff47ab81282a&newsletterV3Id=6340e0deb03&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}