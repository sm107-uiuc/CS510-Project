{"url": "https://towardsdatascience.com/deploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04", "time": 1683004009.829851, "path": "towardsdatascience.com/deploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04/", "webpage": {"metadata": {"title": "Deploying a Simple Machine Learning Model into a WebApp using TensorFlow.js | by Carlos Aguayo | Towards Data Science", "h1": "Deploying a Simple Machine Learning Model into a WebApp using TensorFlow.js", "description": "The beauty in TensorFlow.js is that you can train a Machine Learning Model in Python using Keras or Tensorflow and deploy it on a browser using TensorFlow.js. No need for an external service to run\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/MNIST_database", "anchor_text": "MNIST dataset", "paragraph_index": 5}, {"url": "https://colab.research.google.com/notebooks/intro.ipynb", "anchor_text": "Google Colab", "paragraph_index": 8}, {"url": "https://jupyter.org/", "anchor_text": "Jupyter Notebook", "paragraph_index": 9}, {"url": "https://github.com/carlos-aguayo/carlos-aguayo.github.io/blob/master/tfjs.html", "anchor_text": "HTML page", "paragraph_index": 20}, {"url": "https://www.html5canvastutorials.com/labs/html5-canvas-paint-application/", "anchor_text": "this website", "paragraph_index": 21}, {"url": "https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API", "anchor_text": "HTML5 Canvas", "paragraph_index": 22}, {"url": "http://bencentra.com/code/2014/12/05/html5-canvas-touch-events.html", "anchor_text": "this site", "paragraph_index": 24}, {"url": "https://en.wikipedia.org/wiki/RGBA_color_model", "anchor_text": "RGBA", "paragraph_index": 27}, {"url": "https://ngrok.com/", "anchor_text": "ngrok", "paragraph_index": 33}, {"url": "https://www.linkedin.com/in/carlosaguayo", "anchor_text": "Director of Software Development and Machine Learning Engineer", "paragraph_index": 38}, {"url": "https://www.appian.com/", "anchor_text": "Appian", "paragraph_index": 38}], "all_paragraphs": ["Go ahead and try it in your browser or phone:", "The beauty in TensorFlow.js is that you can train a Machine Learning Model in Python using Keras or Tensorflow and deploy it on a browser using TensorFlow.js. No need for an external service to run your queries.", "This fun and simple app lets you draw a single-digit number, and it recognizes it using simple machine learning tools.", "Here\u2019s the complete code if you want to jump straight at it:", "Let\u2019s get started; these are the ingredients and steps needed to build this demo.", "Any Machine Learning model needs quality data. We are going to use the MNIST dataset, which is a dataset of handwritten digits.", "In this dataset, you have 60,000 images, all of them are of size 28 x 28 pixels in grayscale, with pixel values from 0 to 255.", "See the snippet below for loading and viewing the MNIST dataset.", "Google Colab allows you to write and execute Python in your browser.", "Colab is a very convenient Jupyter Notebook Python Platform pre-loaded with most of the Python Machine Learning libraries that you need, making it a no-hassle approach to get you quickly up and running with an ML project.", "Plus, it gives you free access to GPU/CPU.", "There\u2019s a small preprocessing that needs to happen in the data from MNIST:", "We are finally ready to do some Machine Learning. We can start with a very simple model. We will use a simple Neural Network with just one Hidden layer. This simple model is enough to get a 98% accuracy.", "If you want to be fancy, you can try a Deep Learning Model. With it, you can improve the accuracy to 99%.", "Now that we have a trained model, we need to convert it so that we can use it with TensorFlow.js.", "First, we need to save the model into an HDF5 model.", "Afterward, you can access the files saved by clicking on the folder icon in the left nav.", "There are a few ways to convert the model. A simple one within a Notebook is like this:", "/content/model.h5 is the input and the output is saved into /content/model folder.", "TensorFlow.js needs to be pointed at the JSON file (model.json) and expects a sibling file called \u201cgroup1-shard1of1.bin\u201d. You need these two files. Download both files.", "Let\u2019s have a simple HTML page that uses the HTML5 Canvas component that lets us draw on it. Let\u2019s call this file \u201ctfjs.html\u201d.", "The core drawing code comes from this website:", "Using the HTML5 Canvas component, we can hook mouse events to draw into the Canvas.", "Then we add touch events so that it works on mobile.", "Add the touch action to disable scrolling. The code for that is inspired by this site.", "Once we can draw, let\u2019s fetch the image upon mouse up. We will scale it down to 28 by 28 pixels so that it matches the trained model.", "We then get the data, keep it into an \u201cinput\u201d array and pass it to a predict function that we will define later.", "data is a 1D array with values RGBA values. Our model only takes 0 to 1 values (or 0 from 255 thinking in grayscale). Given that we are drawing Blue into the canvas, we can slice the array in chunks of four and take every second element.", "Finally, let\u2019s load TensorFlow.js and run predictions.", "You should have downloaded the files model.json and group1-shard1of1.bin and save them into a folder called model in the same folder where you have your HTML file.", "Once loaded, we can load the trained model by simply doing:", "And upon mouseup, once we have the data, we can just feed it into the model:", "It\u2019s straightforward to test things locally, and you can easily set up an HTTP server for testing with Python:", "If then you want to test things using your phone, you can take advantage of this nifty tool called ngrok.", "That opens a tunnel to a URL that you can access from through phone.", "Once you are happy with the result, you can deploy your HTML into a web hosting site. A simple place is Github. If you have never created a static website with Github, you need to create a repository named \u201c{username}.github.io\u201d. For example, my repository is:", "And then you can access it via:", "Notice how easily we can train a model in Google Colab, export the trained model, and query it within JavaScript without ever leaving the browser!", "I\u2019m Director of Software Development and Machine Learning Engineer at Appian. I\u2019ve worked at Appian for the last 15 years, and I keep having a blast. Send me a message if you would like to know how we craft software, please our customers and have fun!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Director, Software Development. Machine Learning Engineer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3609c297fb04&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3609c297fb04--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3609c297fb04--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://carlosaguayo81.medium.com/?source=post_page-----3609c297fb04--------------------------------", "anchor_text": ""}, {"url": "https://carlosaguayo81.medium.com/?source=post_page-----3609c297fb04--------------------------------", "anchor_text": "Carlos Aguayo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c778cbdfd0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&user=Carlos+Aguayo&userId=9c778cbdfd0d&source=post_page-9c778cbdfd0d----3609c297fb04---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3609c297fb04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3609c297fb04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://carlos-aguayo.github.io/tfjs.html", "anchor_text": "https://carlos-aguayo.github.io/tfjs.html"}, {"url": "https://colab.research.google.com/gist/carlos-aguayo/e56a341190c4a252c4f66289b9228a69/mnist-on-gpu.ipynb", "anchor_text": "Google Colab Notebook to generate the Machine Learning Model"}, {"url": "https://github.com/carlos-aguayo/carlos-aguayo.github.io/blob/master/tfjs.html", "anchor_text": "HTML file"}, {"url": "https://en.wikipedia.org/wiki/MNIST_database", "anchor_text": "MNIST dataset"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0", "anchor_text": "CC BY-SA"}, {"url": "https://colab.research.google.com/notebooks/intro.ipynb", "anchor_text": "Google Colab"}, {"url": "https://jupyter.org/", "anchor_text": "Jupyter Notebook"}, {"url": "https://en.wikipedia.org/wiki/One-hot", "anchor_text": "One-Hot Encode"}, {"url": "https://github.com/carlos-aguayo/carlos-aguayo.github.io/blob/master/tfjs.html", "anchor_text": "HTML page"}, {"url": "https://www.html5canvastutorials.com/labs/html5-canvas-paint-application/", "anchor_text": "this website"}, {"url": "https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API", "anchor_text": "HTML5 Canvas"}, {"url": "http://bencentra.com/code/2014/12/05/html5-canvas-touch-events.html", "anchor_text": "this site"}, {"url": "https://en.wikipedia.org/wiki/RGBA_color_model", "anchor_text": "RGBA"}, {"url": "https://ngrok.com/", "anchor_text": "ngrok"}, {"url": "https://github.com/carlos-aguayo/carlos-aguayo.github.io", "anchor_text": "https://github.com/carlos-aguayo/carlos-aguayo.github.io"}, {"url": "https://carlos-aguayo.github.io/tfjs.html", "anchor_text": "https://carlos-aguayo.github.io/tfjs.html"}, {"url": "https://www.linkedin.com/in/carlosaguayo", "anchor_text": "Director of Software Development and Machine Learning Engineer"}, {"url": "https://www.appian.com/", "anchor_text": "Appian"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3609c297fb04---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflowjs?source=post_page-----3609c297fb04---------------tensorflowjs-----------------", "anchor_text": "Tensorflowjs"}, {"url": "https://medium.com/tag/google-colab?source=post_page-----3609c297fb04---------------google_colab-----------------", "anchor_text": "Google Colab"}, {"url": "https://medium.com/tag/programming?source=post_page-----3609c297fb04---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----3609c297fb04---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3609c297fb04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&user=Carlos+Aguayo&userId=9c778cbdfd0d&source=-----3609c297fb04---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3609c297fb04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&user=Carlos+Aguayo&userId=9c778cbdfd0d&source=-----3609c297fb04---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3609c297fb04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3609c297fb04--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3609c297fb04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3609c297fb04---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3609c297fb04--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3609c297fb04--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3609c297fb04--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3609c297fb04--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3609c297fb04--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3609c297fb04--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3609c297fb04--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3609c297fb04--------------------------------", "anchor_text": ""}, {"url": "https://carlosaguayo81.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://carlosaguayo81.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Carlos Aguayo"}, {"url": "https://carlosaguayo81.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "101 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c778cbdfd0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&user=Carlos+Aguayo&userId=9c778cbdfd0d&source=post_page-9c778cbdfd0d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F17d6a4165ff4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-simple-machine-learning-model-into-a-webapp-using-tensorflow-js-3609c297fb04&newsletterV3=9c778cbdfd0d&newsletterV3Id=17d6a4165ff4&user=Carlos+Aguayo&userId=9c778cbdfd0d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}