{"url": "https://towardsdatascience.com/natural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8", "time": 1683001622.031043, "path": "towardsdatascience.com/natural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8/", "webpage": {"metadata": {"title": "An intro to text classification with Facebook\u2019s fastText (Natural Language Processing) | by Sunny Srinidhi | Towards Data Science", "h1": "An intro to text classification with Facebook\u2019s fastText (Natural Language Processing)", "description": "Text classification is a pretty common application of machine learning. In such an application, machine learning is used to categorise a piece of text into two or more categories. There are both\u2026"}, "outgoing_paragraph_urls": [{"url": "https://dl.fbaipublicfiles.com/fasttext/data/cooking.stackexchange.tar.gz", "anchor_text": "https://dl.fbaipublicfiles.com/fasttext/data/cooking.stackexchange.tar.gz", "paragraph_index": 7}, {"url": "https://medium.com/@contactsunny/how-to-split-your-dataset-to-train-and-test-datasets-using-scikit-learn-e7cf6eb5e0d", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://fasttext.cc/", "anchor_text": "fastText website", "paragraph_index": 19}, {"url": "https://blog.contactsunny.com/data-science/understanding-word-n-grams-and-n-gram-probability-in-natural-language-processing", "anchor_text": "what is n-gram", "paragraph_index": 20}, {"url": "https://twitter.com/contactsunny", "anchor_text": "Twitter", "paragraph_index": 21}, {"url": "https://blog.contactsunny.com/tag/data-science", "anchor_text": "Data Science", "paragraph_index": 21}, {"url": "https://blog.contactsunny.com/tag/machine-learning", "anchor_text": "Machine Learning", "paragraph_index": 21}, {"url": "https://blog.contactsunny.com/category/tech", "anchor_text": "tech updates", "paragraph_index": 21}, {"url": "https://blog.contactsunny.com/", "anchor_text": "follow my personal blog", "paragraph_index": 21}, {"url": "https://www.patreon.com/bePatron?u=28955887", "anchor_text": "supporting me on Patreon", "paragraph_index": 22}], "all_paragraphs": ["Text classification is a pretty common application of machine learning. In such an application, machine learning is used to categorise a piece of text into two or more categories. There are both supervised and unsupervised learning models for text classification. In this post, we\u2019ll see how we can use Facebook\u2019s fastText library for some simple text classification.", "fastText, developed by Facebook, is a popular library for text classification. The library is an open source project on GitHub, and is pretty active. The library also provides pre-built models for text classification, both supervised and unsupervised. In this post, we\u2019ll check out how we can train the supervised model in the library for some quick text classification. The library can be used as a command line tool, or as a Python package. In order to keep things very simple, we\u2019ll just a see a few CLI commands in this post.", "Installing fastText for command line is as simple as cloning the Git repo and running the make command inside the directory:", "Once you do this, you have the fastText CLI installed, provided you don\u2019t get any errors. You can also install the Python library by running the following command from the same directory:", "You can verify the installation by running the following command:", "You should see something like this in your terminal:", "This indicates that you have the tool installed. The next step is to get our dataset.", "Facebook developers have included a dataset for testing out this library. So we\u2019ll use the same data. It\u2019s a collection of stackexchange questions about cooking. The aim here is to classify the questions automatically. Because we\u2019re using supervised learning, we have to make sure that we mark the categories for the questions we have in the data. And again, fortunately, the data comes with the categories already marked. So let\u2019s download the data first. The data is available as a compressed file here: https://dl.fbaipublicfiles.com/fasttext/data/cooking.stackexchange.tar.gz. We can download the data and unzip it manually, or we can just run the following command to do it from the CLI:", "We\u2019ll have a few files in the directory once we unzip it. But our data is in a file named cooking.stackexchange.txt. If you open up the file or head it, you\u2019ll see something like this:", "As you can see, there\u2019s something unusual with the text. In each line, we have the __label__ text. This is actually the category of the question. So the way you specify the category in the training data is to include the text __label__ followed by the category. We can specify multiple categories for a question as well, as can be seen from the sample above. Now that we have the data ready, let\u2019s split it to training and test data.", "Before we begin training our model, we have to split the data so that we have one dataset for training the model and one for testing the accuracy of the model. If you want to know why this is necessary or how to do it in Python, you can read my post about it here. Usually, we do an 80\u201320 split of the data, 80% of the data for training, and 20% for testing. To do this, we first need to see how many questions we have. There\u2019s one question per line, so getting the number of lines in the file will do it:", "As we can see from the output, we have 15404 lines in the file. 80% of that is 12323.2, so we\u2019ll take the first 12324 lines as the training dataset. And the rest 3080 lines will be our test data. To do this split, we\u2019ll run the following commands:", "We\u2019ll now have two new files, one for training and one for testing. Next, we\u2019ll train the model with our training data.", "This is actually a very simple command with this library. We just run the fastText CLI tool with the supervised command and provide the input file (which is our training data file), and a name for the model which will be generated. The command for this looks like this:", "As you can see, that\u2019s a pretty easy command to understand. The -input option specifies the input file and the -output option specifies the name of the model which will be generated. Once you run this command, you should an output something like this:", "Our model is now trained, and ready to take some questions for classification. Let\u2019s try that now.", "When we trained our model in the previous step, the command generated a couple of new files: cooking_question_classification_model.bin and cooking_question_classification_model.vec. The .bin file, or the binary file of the model, is what we\u2019ll use now. We can start testing the model by running the following command:", "As you can see, we use the predict command to tell our model that we\u2019re going to do some predictions now. The dash (-) at the end of the command indicates that we\u2019re going to type the questions in the command line. We can also give the command a file with multiple questions, but we\u2019ll keep that for the next post. Once you run this command, the model will start listening for questions, and you can type in a question and hit the Enter or return key to get a prediction. Let\u2019s try that now:", "Each of my question is answered with the text __label__ followed by the category that the model thinks the question belongs to. As you can already tell, the model didn\u2019t get all the answers or the categories right. This is expected, as we haven\u2019t really cleaned our data or tuned the model. We can fine tune the model by pre-processing our data a bit, to make it a bit more cleaner for the model to understand.", "This example is what you\u2019ll encounter the first time you try out fastText. You can checkout the fastText website for more info about the library and this tutorial. Because I wanted to limit this post to the basics, I\u2019m not going to talk about validating the model or pre-processing our data for better results.", "Another way we can get better results is by using n-grams and looking at the sentences as sequences of words. Once we start looking at words in this way, we\u2019ll be able to understand a lot more about the patterns in the data we trained on and better our predictions. I\u2019ll write another post about what is n-gram (because it deserves a post of it\u2019s own) and how we can use probability to understand our data better.", "Follow me on Twitter for more Data Science, Machine Learning, and general tech updates. Also, you can follow my personal blog.", "If you like my posts here on Medium or on my personal blog, and would wish for me to continue doing this work, consider supporting me on Patreon.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F11b9771722d8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----11b9771722d8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----11b9771722d8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://contactsunny.medium.com/?source=post_page-----11b9771722d8--------------------------------", "anchor_text": ""}, {"url": "https://contactsunny.medium.com/?source=post_page-----11b9771722d8--------------------------------", "anchor_text": "Sunny Srinidhi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6691923bb149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&user=Sunny+Srinidhi&userId=6691923bb149&source=post_page-6691923bb149----11b9771722d8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11b9771722d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11b9771722d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/the-fasttext-series", "anchor_text": "The fastText Series"}, {"url": "https://blog.contactsunny.com/data-science/an-intro-to-text-classification-with-facebooks-fasttext-natural-language-processing", "anchor_text": "my blog"}, {"url": "https://github.com/facebookresearch/fastText.git", "anchor_text": "https://github.com/facebookresearch/fastText.git"}, {"url": "https://dl.fbaipublicfiles.com/fasttext/data/cooking.stackexchange.tar.gz", "anchor_text": "https://dl.fbaipublicfiles.com/fasttext/data/cooking.stackexchange.tar.gz"}, {"url": "https://dl.fbaipublicfiles.com/fasttext/data/cooking.stackexchange.tar.gz", "anchor_text": "https://dl.fbaipublicfiles.com/fasttext/data/cooking.stackexchange.tar.gz"}, {"url": "https://medium.com/@contactsunny/how-to-split-your-dataset-to-train-and-test-datasets-using-scikit-learn-e7cf6eb5e0d", "anchor_text": "here"}, {"url": "https://fasttext.cc/", "anchor_text": "fastText website"}, {"url": "https://blog.contactsunny.com/data-science/understanding-word-n-grams-and-n-gram-probability-in-natural-language-processing", "anchor_text": "what is n-gram"}, {"url": "https://twitter.com/contactsunny", "anchor_text": "Twitter"}, {"url": "https://blog.contactsunny.com/tag/data-science", "anchor_text": "Data Science"}, {"url": "https://blog.contactsunny.com/tag/machine-learning", "anchor_text": "Machine Learning"}, {"url": "https://blog.contactsunny.com/category/tech", "anchor_text": "tech updates"}, {"url": "https://blog.contactsunny.com/", "anchor_text": "follow my personal blog"}, {"url": "https://www.patreon.com/bePatron?u=28955887", "anchor_text": "supporting me on Patreon"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----11b9771722d8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----11b9771722d8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----11b9771722d8---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/data-science?source=post_page-----11b9771722d8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/the-fasttext-series?source=post_page-----11b9771722d8---------------the_fasttext_series-----------------", "anchor_text": "The Fasttext Series"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F11b9771722d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&user=Sunny+Srinidhi&userId=6691923bb149&source=-----11b9771722d8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F11b9771722d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&user=Sunny+Srinidhi&userId=6691923bb149&source=-----11b9771722d8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11b9771722d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----11b9771722d8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F11b9771722d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----11b9771722d8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----11b9771722d8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----11b9771722d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----11b9771722d8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----11b9771722d8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----11b9771722d8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----11b9771722d8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----11b9771722d8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----11b9771722d8--------------------------------", "anchor_text": ""}, {"url": "https://contactsunny.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://contactsunny.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sunny Srinidhi"}, {"url": "https://contactsunny.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.6K Followers"}, {"url": "http://blog.contactsunny.com", "anchor_text": "blog.contactsunny.com"}, {"url": "http://linkedin.com/in/sunnysrinidhi/", "anchor_text": "linkedin.com/in/sunnysrinidhi/"}, {"url": "http://twitter.com/contactsunny", "anchor_text": "twitter.com/contactsunny"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6691923bb149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&user=Sunny+Srinidhi&userId=6691923bb149&source=post_page-6691923bb149--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d9e5a16cecd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-processing-with-fasttext-part-1-an-intro-to-text-classification-with-fasttext-11b9771722d8&newsletterV3=6691923bb149&newsletterV3Id=1d9e5a16cecd&user=Sunny+Srinidhi&userId=6691923bb149&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}