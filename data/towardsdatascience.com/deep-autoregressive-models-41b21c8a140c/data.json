{"url": "https://towardsdatascience.com/deep-autoregressive-models-41b21c8a140c", "time": 1683006856.3775449, "path": "towardsdatascience.com/deep-autoregressive-models-41b21c8a140c/", "webpage": {"metadata": {"title": "Autoregressive Process Representation in TensorFlow 2.0 | by Rohan Kotwani | Towards Data Science", "h1": "Autoregressive Process Representation in TensorFlow 2.0", "description": "Business-related time series are often non-continuous, or discrete, time-based processes. Operationally, it might be useful for businesses to know, or to be able to quantify when a time series will\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Nyquist_rate", "anchor_text": "Nyquist rate", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_model", "anchor_text": "autoregressive model", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Taylor_series", "anchor_text": "Taylor Series", "paragraph_index": 5}, {"url": "https://datamarket.com/data/set/2324/daily-minimum-temperatures-in-melbourne-australia-1981-1990#!ds=2324&display=line", "anchor_text": "Daily Minimum Temperature and Rainfall in Melbourne, Australia", "paragraph_index": 12}, {"url": "https://github.com/freedomtowin/ml-projects/blob/master/Deep-Autoregressive-Model/deep-autoregressive-model-v1.ipynb", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://facebook.github.io/prophet/docs/quick_start.html#python-api", "anchor_text": "quick start tutorial", "paragraph_index": 21}], "all_paragraphs": ["Business-related time series are often non-continuous, or discrete, time-based processes. Operationally, it might be useful for businesses to know, or to be able to quantify when a time series will be at a peak or trough in the future. The goal is to capture the trend and periodic patterns and to forecast the signal for >1 samples into the future. The example notebook is available in the TensorFlow Formulation section of this article.", "In most business-related applications, the time series have non-constant mean and variance over time, or they can be said to be non-stationary. This is contrasted to stationary signals and systems used in the analysis of electrical circuits, audio systems, and communication systems. The direction in which the mean value changes indicates the trend of the time series. The variation of the noise could also be a function of some random process. This noise can potentially increase or decrease as a function of time.", "There is a granularity time limit to the which periodic, or recurring, patterns can be captured. In digital signal processing, the Nyquist rate is the minimum sampling period required to capture a pattern that reoccurs with period N. Essentially, the sampling rate needs to be less than half of one cycle of the recurring pattern. For example, let us say there is a feature in the data that measures the number of sales every 6 hours. The most granular pattern that can be captured will be one that reoccurs every 12 hours.", "Autoregressive models and open loop feedback systems, a type of control system, have some similarities. Both of these systems depend on the previous output of the model. We would like both of these systems to be stable, i.e., not explode into an exponential output. These systems are different in that autoregressive forecasts can depend on multiple lagged input features. The form of the autoregressive model is shown in equation (0).", "Where T is number of lagged features, w represents the autoregressive weights, y(t-i) represents the lagged time series, and y*(t+1) is the predicted value at t+1.", "The goal is to create a linearized form of the autoregressive model using the 1st order Taylor Series approximation. The autoregressive formula is recursive, meaning the next value depends on a cascade of the previous values. The value at y(t+1) is estimated with a Taylor Series expansion of f(t+1) around time step t. Equation (2) shows the estimated value for y(t+1) using the 1st order Taylor Series approximation. Note, that the -1 constant, on the right hand side of equation (2), will be absorbed by the weights.", "Where f(t) is a recursive dense layer which represents y(t) with some error term, y* is the predicted output, w_t are the weights, and T is number of lagged features. Equation (2) shows the Taylor Series expansion for the simple case where y(t+1) depends on the previous value, i.e., f(t+1). The reason why I used f(t), instead of using y(t), is because y(t) represents the actual lagged data points and not the time-dependent autoregressive function.", "In equation (3.1), the partial derivative of f(t+1) with respect to f(t) is taken with respect to w(t). This partial derivative results in f(t), the previous function\u2019s value, which can be expanded again with the 1st order Taylor Series expansion. Interestingly, this would result in an model formulation similar to the autoregressive formulation. The difference is that the lagged features are finite and discrete instead of infinite.", "(3.2) can be reformulated as linear model by replacing the recursive layer, f(t), with previous time series values for each lagged time step, i.e., the value of f(t) is replaced with y(t). Finally, additional lagged components can be added to create the autoregressive model.", "The final form used to train the autoregressive model is shown in equation (4). The intercept is constrained to be the sum of the autoregressive weights. This allows the model to be unbiased towards a central tendency and to be adaptive over time.", "Where N is the number of data points, T is total number of lagged features, w represents the autoregressive weights, y(t-i) represents the lagged time series, and y*(t+1) is the predicted value at t+1. The objective function, MSE, shown in equation (5), is differentiable with respect to the parameters and can be optimized with TensorFlow.", "Multi-variate time series can be forecasted by applying this same logic. The previous values for all time series are used as covariates to simultaneously predict the next value for all time series. In this case, the intercept is the sum of the output node\u2019s autoregressive weights. The multivariate formulation allows for multiple autoregressive layers to be stacked to create a deep autoregressive model.", "Daily Minimum Temperature and Rainfall in Melbourne, Australia dataset was used to build an autoregressive forecasting model. This dataset includes the Temperature and Rainfall across 3625 days, starting in 1981. There were a few missing values, but these values were interpolated for each series. These series were simultaneously forecasted using a deep autoregressive model.", "The plot below shows Temperature in Melbourne across the time frame. There appears to be a clear periodic component to Temperature over time.", "The plot below shows the Rainfall series, in Melbourne across the time frame. Rainfall is clipped at zero centimeters of rain per day which makes it difficult to model using an autoregressive model. In order to use Rainfall, a 60 rolling average for rainfall, shown in the second plot below, was created.", "The code block below shows the TensorFlow code for the autoregressive model formulated above. The example notebook can be found here.", "The model has and input of size (N,M), where N is the number of data points and M corresponds to the 730 lagged features for both Rain and Temperature. A hidden layer of size 30 was used with autoregressive activation. The model was trained with stochastic gradient descent, mean squared error loss, an Adam optimizer, early stopping, and a small learning rate. While early stopping was utilized, it might not be necessary since the autoregressive model produces should be inherently regularized.", "A forecast can be created by snowballing previous predictions into the autoregressive model. The variance of snowballed time series might have the tendency to increase across time, or become unstable, even if the actual time series is stable. A poorly fit model might become unstable and explode in variance across time. Instability can occur if the forecasted snowballed time series is consistently biased above or below the actual trend. The constrained intercept, in the model formulation, should produce more stability and adaptability over time.", "In order to evaluate forecast stability, the model was trained 100 times on different, random train-validation splits, and 100 models were created. A snowballed time series was generated for each model on the hold-out set. The expected value and the standard deviation were used to create the forecast and confidence intervals, respectively.", "In the plots above, the actual observations, training predictions, and snowballed forecasts are shown by the green, blue, and orange series, respectively. The predicted and forecasted values for Temperature appear to capture the global periodic pattern. However, the variation across time was not captured by the variation across the 100 forecasts. The predicted values for Rainfall (60 rolling average) appear to be overfit on the training dataset. The overfitting might be due to the use of a rolling average feature. The trend , for this series, was accurately captured for ~1 year of forecasted values before collapsing into a periodic pattern. The trend was not accurately captured after ~1 year.", "The 1st order approximation for the autoregressive function was used to formulate the objective function and the model definition. It was found that the intercept for the autoregressive activation layer was constrained to be the sum of the input\u2019s weights. A deep autoregressive model was created using TensorFlow 2.0 by stacking autoregressive layers. The model was used to simultaneously forecast Temperature and Rainfall in Melbourne AU. The autoregressive formulation did not work with clipped time series, and a rolling average transformation was need to forecast Rainfall. The forecasts were created by snowballing the previous predictions back into the model. Small global trends and periodic patterns appeared to be captured by the model.", "How does the model stack up against FB Prophet? Prophet is a complete time series forecasting suite with many tunable parameters. For the comparison, I used the out of the box model from the quick start tutorial.", "Prophet seems to use a periodogram model. It basically picks out the top periodic frequencies, f, and wraps them in sin and cosine functions to create the feature set, i.e., sin(f) and cos(f). The package also seems to also use the output of a logistic regression model. The logistic regression model predicts whether the series will go up or down. The package seems to support adding additional variables to the forecast, but it doesn\u2019t seem to support simultaneous multi-variate forecasting yet. The comparison was added to the example notebook.", "In the plots above, the actual observations, training predictions, and snowballed forecasts are shown by the green, blue, and orange series, respectively. The predicted and forecasted values for Temperature appear to capture the global periodic pattern. The variation across time was captured by the variation across the 100 forecasts. The trend for Temperature seems to trend upward which may not be the actual trend. The predicted values for Rainfall (60 rolling average) appear to capture a general, yearly periodic pattern. The pattern is consistent throughout the validation. The trend for Rainfall seems to trend downward which may not be the actual trend.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F41b21c8a140c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rohankotwani.medium.com/?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": ""}, {"url": "https://rohankotwani.medium.com/?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": "Rohan Kotwani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7db535a7549e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&user=Rohan+Kotwani&userId=7db535a7549e&source=post_page-7db535a7549e----41b21c8a140c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41b21c8a140c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41b21c8a140c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Nyquist_rate", "anchor_text": "Nyquist rate"}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_model", "anchor_text": "autoregressive model"}, {"url": "https://en.wikipedia.org/wiki/Taylor_series", "anchor_text": "Taylor Series"}, {"url": "https://datamarket.com/data/set/2324/daily-minimum-temperatures-in-melbourne-australia-1981-1990#!ds=2324&display=line", "anchor_text": "Daily Minimum Temperature and Rainfall in Melbourne, Australia"}, {"url": "https://github.com/freedomtowin/ml-projects/blob/master/Deep-Autoregressive-Model/deep-autoregressive-model-v1.ipynb", "anchor_text": "here"}, {"url": "https://facebook.github.io/prophet/docs/quick_start.html#python-api", "anchor_text": "quick start tutorial"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----41b21c8a140c---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----41b21c8a140c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----41b21c8a140c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/autoregressive?source=post_page-----41b21c8a140c---------------autoregressive-----------------", "anchor_text": "Autoregressive"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----41b21c8a140c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41b21c8a140c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&user=Rohan+Kotwani&userId=7db535a7549e&source=-----41b21c8a140c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41b21c8a140c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&user=Rohan+Kotwani&userId=7db535a7549e&source=-----41b21c8a140c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41b21c8a140c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F41b21c8a140c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----41b21c8a140c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----41b21c8a140c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----41b21c8a140c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----41b21c8a140c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----41b21c8a140c--------------------------------", "anchor_text": ""}, {"url": "https://rohankotwani.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rohankotwani.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rohan Kotwani"}, {"url": "https://rohankotwani.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "160 Followers"}, {"url": "https://www.linkedin.com/in/rkotwani/", "anchor_text": "https://www.linkedin.com/in/rkotwani/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7db535a7549e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&user=Rohan+Kotwani&userId=7db535a7549e&source=post_page-7db535a7549e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7719c6bbf2fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-autoregressive-models-41b21c8a140c&newsletterV3=7db535a7549e&newsletterV3Id=7719c6bbf2fa&user=Rohan+Kotwani&userId=7db535a7549e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}