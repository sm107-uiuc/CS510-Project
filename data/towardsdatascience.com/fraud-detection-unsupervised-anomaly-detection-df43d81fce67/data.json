{"url": "https://towardsdatascience.com/fraud-detection-unsupervised-anomaly-detection-df43d81fce67", "time": 1683008474.187546, "path": "towardsdatascience.com/fraud-detection-unsupervised-anomaly-detection-df43d81fce67/", "webpage": {"metadata": {"title": "Fraud detection \u2014 Unsupervised Anomaly Detection | by Luis Meazzini | Towards Data Science", "h1": "Fraud detection \u2014 Unsupervised Anomaly Detection", "description": "One of the greatest concerns of many business owners is how to protect their company from fraudulent activity. This concern motivated large companies to save data relative to their past frauds\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Kaggle", "paragraph_index": 5}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Dataset page", "paragraph_index": 6}, {"url": "https://github.com/lmeazzini/Small-projects/blob/master/Credit_fraud.ipynb", "anchor_text": "GitHub", "paragraph_index": 21}], "all_paragraphs": ["One of the greatest concerns of many business owners is how to protect their company from fraudulent activity. This concern motivated large companies to save data relative to their past frauds, however, whoever performs a fraud aims not to be caught then this kind of data usually is unlabeled or partially labeled.", "On this article, we will talk about how to discover frauds on a credit card transaction dataset, unlike most fraud datasets this dataset is completely labeled however, we won\u2019t use the label to discover frauds. Credit card fraud is when someone uses another person\u2019s credit card or account information to make unauthorized purchases or access funds through cash advances. Credit card fraud doesn\u2019t just happen online; it happens in brick-and-mortar stores, too. As a business owner, you can avoid serious headaches \u2014 and unwanted publicity \u2014 by recognizing potentially fraudulent use of credit cards in your payment environment.", "One of the most common approach to find fraudulent transactions was randomly select some transactions and ask and auditor to audit it. This approach was quite unaccurate since the relation between the number of fraudulent transactions and normal transactions is close to 0.1%.", "Then, we aim to leverage machine learning to detect and prevent frauds and make fraud fighters more efficient and effective. Commonly, there are the supervised and the unsupervised approach:", "Also, these models can then be deployed to automatically identify new instances/cases of known fraud patterns/types in the future. Ideally the validation of this type of machine learning algorith sometimes need to be a temporal validation since fraud patterns can change over time, however to simplify this article, the validation will be simplified.", "The project uses a dataset of around 284000 credit card transactions which have been taken from Kaggle.", "The dataset is highly unbalanced, the positive class (frauds) account for 0.172% of all transactions. It contains only numerical input variables which are the result of a PCA transformation. Unfortunately, due to confidentiality issues, the original features and more background information about the data are not provided. Features V1, V2, \u2026, V28 are the principal components obtained with PCA, the only features which have not been transformed with PCA are \u201cTime\u201d and \u201cAmount\u201d, and there are no null values (Dataset page).", "Since just the \u201cTime\u201d and \u201cAmount\u201d features are easely intepreted, we can use some visualizations to see the impact of the features on the target variable (fraud). First, frauds happen more on small transactions or big ones?", "This article proposes an unsupervised approach to detect frauds, the only place the labels are used is to evaluate the algorithm. One of the biggest challenge of this problem is that the target is highly imbalanced as only 0.17% cases are fraudulent transactions. But the advantage of the representation learning approach is that it is still able to handle such imbalance nature of the problems. Using TSNE we can try to see how the transactions are similar:", "The main ideia of this approach is to compress the data making a \u201clatent representation\u201d and then reconstruct the data. If a sample is similar to the rest of the dataset, the reconstructed data will be similar or even equal to the original data. However, if the sample is not similar to the rest, the reconstructed sample will not be similar to the original one.", "In short, we compress the data and reconstruct it. If the reconstructed data is not similar to the original one, we have a fraud.", "Using Principal component analysis (PCA), we managed to compress the data from 30 features to 10 features and calculated the reconstruction score. The histogram for this score is below:", "We can see that most samples have a low reconstruction score and then, probably most frauds have more then 50 reconstruction score. Using TSNE we can compare the original data disposition with the PCA compressed data distribution.", "Now, we need to set a threshold to the reconstruction score. Usualy there domain expertise is used to help to set this threshold since it impacts direcly on the precision and recall trade-off.", "Using the mean and standard deviation of the reconstruction score we can set a reasonable threshold. Then, I choose to set the threshold to mean + 2*std. With this, auditing 0.74% of the transactions we managed to find 87% of the frauds.", "An autoencoder is a type of artificial neural network used to learn efficient data codings in an unsupervised manner. It is composed of a enconding part responsable to compress the data and a decoder to reconstruct the data.", "The aim of an autoencoder is to learn a representation (encoding) for a set of data, typically for the purpose of dimensionality reduction. Analogously to the PCA approach, the reconstrcution score histogram can be seen below:", "We can see that most samples have a low reconstruction score and then, probably most frauds have more then ~60 reconstruction score. Using TSNE we can compare the original data disposition with the Autoencoder compressed data distribution.", "The Autoencoder representation seens to split quite well the frauds from the normal data. Now, we need to set a threshold to the reconstruction score. Usualy there domain expertise is used to help to set this threshold since it impacts direcly on the precision and recall trade-off.", "Using the mean and standard deviation of the reconstruction score we can set a reasonable threshold. Then, I choose to set the threshold to mean + 2*std. With this, auditing 0.85% of the transactions we managed to find 65% of the frauds.", "The objective of the approach was fulfilled, making possible to detect frauds with an 100% unsupervised approach. Nevertheless, there are several ways to make this approach work better, like:", "The code used to perform this approach along with a little more analysis is available on GitHub:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Kunumi, Masters in Computer Science. Philosophy and Anthropology enthusiast."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf43d81fce67&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----df43d81fce67--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df43d81fce67--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@luismeazzini?source=post_page-----df43d81fce67--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@luismeazzini?source=post_page-----df43d81fce67--------------------------------", "anchor_text": "Luis Meazzini"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F335ed336aced&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&user=Luis+Meazzini&userId=335ed336aced&source=post_page-335ed336aced----df43d81fce67---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf43d81fce67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf43d81fce67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@b0rno?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ryan Born"}, {"url": "https://unsplash.com/s/photos/credit-card?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Kaggle"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Credit Card Fraud DetectionAnonymized credit card transactions labeled as fraudulent or genuinewww.kaggle.com"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Dataset page"}, {"url": "https://github.com/lmeazzini/Small-projects/blob/master/Credit_fraud.ipynb", "anchor_text": "GitHub"}, {"url": "https://github.com/lmeazzini/Small-projects/blob/master/Credit_fraud.ipynb", "anchor_text": "lmeazzini/Small-projectsPermalink Dismiss GitHub is home to over 50 million developers working together to host and review code, manage\u2026github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----df43d81fce67---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----df43d81fce67---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/fraud?source=post_page-----df43d81fce67---------------fraud-----------------", "anchor_text": "Fraud"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----df43d81fce67---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----df43d81fce67---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf43d81fce67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&user=Luis+Meazzini&userId=335ed336aced&source=-----df43d81fce67---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf43d81fce67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&user=Luis+Meazzini&userId=335ed336aced&source=-----df43d81fce67---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf43d81fce67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df43d81fce67--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdf43d81fce67&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----df43d81fce67---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----df43d81fce67--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----df43d81fce67--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----df43d81fce67--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----df43d81fce67--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df43d81fce67--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df43d81fce67--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----df43d81fce67--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----df43d81fce67--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@luismeazzini?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@luismeazzini?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luis Meazzini"}, {"url": "https://medium.com/@luismeazzini/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "153 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F335ed336aced&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&user=Luis+Meazzini&userId=335ed336aced&source=post_page-335ed336aced--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1c69cb6038b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffraud-detection-unsupervised-anomaly-detection-df43d81fce67&newsletterV3=335ed336aced&newsletterV3Id=1c69cb6038b1&user=Luis+Meazzini&userId=335ed336aced&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}