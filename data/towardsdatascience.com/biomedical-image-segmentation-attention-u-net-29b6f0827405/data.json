{"url": "https://towardsdatascience.com/biomedical-image-segmentation-attention-u-net-29b6f0827405", "time": 1683001843.427731, "path": "towardsdatascience.com/biomedical-image-segmentation-attention-u-net-29b6f0827405/", "webpage": {"metadata": {"title": "Biomedical Image Segmentation: Attention U-Net | by Jingles (Hong Jing) | Towards Data Science", "h1": "Biomedical Image Segmentation: Attention U-Net", "description": "Improving model sensitivity and accuracy by attaching attention gates on top of the standard U-Net"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1804.03999", "anchor_text": "\u201clearning where to look for the Pancreas\u201d by Oktay et al.", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "Read more about U-Net", "paragraph_index": 2}, {"url": "https://arxiv.org/abs/1804.02391", "anchor_text": "\u201cNeed to pay attention\u201d by Jetley et al.", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1606.02393", "anchor_text": "Seo et al.", "paragraph_index": 7}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S136184151830848X", "anchor_text": "Khened et al.", "paragraph_index": 8}, {"url": "https://www.ncbi.nlm.nih.gov/pubmed/29427897", "anchor_text": "Roth et al.", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "U-Net", "paragraph_index": 8}, {"url": "https://arxiv.org/abs/1804.03999", "anchor_text": "Oktay et al.", "paragraph_index": 11}, {"url": "https://arxiv.org/abs/1409.0473", "anchor_text": "Bahdanau et al.", "paragraph_index": 13}, {"url": "https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/viewFile/16126/16099", "anchor_text": "Shen et al.", "paragraph_index": 13}, {"url": "https://arxiv.org/abs/1804.02391", "anchor_text": "Jetley et al.", "paragraph_index": 13}, {"url": "https://arxiv.org/abs/1704.06904", "anchor_text": "Wang et al.", "paragraph_index": 13}, {"url": "https://arxiv.org/abs/1508.04025", "anchor_text": "Luong et al.", "paragraph_index": 13}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "U-Net", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-unet-a3f43342307b", "anchor_text": "UNet++", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "U-Net", "paragraph_index": 19}, {"url": "http://linkedin.com/in/jingles", "anchor_text": "linkedin.com/in/jingles", "paragraph_index": 25}], "all_paragraphs": ["Medical image segmentation has been actively studied to automate clinical analysis. Deep learning models generally require a large amount of data, but acquiring medical images is tedious and error-prone.", "Attention U-Net aims to automatically learn to focus on target structures of varying shapes and sizes; thus, the name of the paper \u201clearning where to look for the Pancreas\u201d by Oktay et al.", "U-Nets are commonly used for image segmentation tasks because of its performance and efficient use of GPU memory. It aims to achieve high precision that is reliable for clinical usage with fewer training samples because acquiring annotated medical images can be resource-intensive. Read more about U-Net.", "Despite U-Net excellent representation capability, it relies on multi-stage cascaded convolutional neural networks to work. These cascaded frameworks extract the region of interests and make dense predictions. This approach leads to excessive and redundant use of computational resources as it repeatedly extracting low-level features.", "\u201cNeed to pay attention\u201d by Jetley et al. introduced end-to-end-trainable attention module. Attention gates are commonly used in natural image analysis and natural language processing.", "Attention is used to perform class-specific pooling, which results in a more accurate and robust image classification performance. These attention maps can amplify the relevant regions, thus demonstrating superior generalisation over several benchmark datasets.", "How hard attention function works is by use of an image region by iterative region proposal and cropping. But this is often non-differentiable and relies on reinforcement learning (a sampling-based technique called REINFORCE) for parameter updates which result in optimising these models more difficult.", "On the other hand, soft attention is probabilistic and utilises standard back-propagation without need for Monte Carlo sampling. The soft-attention method of Seo et al. demonstrates improvements by implementing non-uniform, non-rigid attention maps which are better suited to natural object shapes seen in real images.", "To improve segmentation performance, Khened et al. and Roth et al. relied on additional preceding object localisation models to separate localisation and subsequent segmentation steps. This can be achieved by integrating attention gates on top of U-Net architecture, without training additional models.", "As a result, attention gates incorporated into U-Net can improve model sensitivity and accuracy to foreground pixels without requiring significant computation overhead. Attention gates can progressively suppress features responses in irrelevant background regions.", "Attention gates are implemented before concatenation operation to merge only relevant activations. Gradients originating from background regions are down-weighted during the backward pass. This allows model parameters in prior layers to be updated based on spatial regions that are relevant to a given task.", "To further improve the attention mechanism, Oktay et al. proposed a grid-attention mechanism. By implementing grid-based gating, the gating signal is not a single global vector for all image pixels, but a grid signal conditioned to image spatial information. The gating signal for each skip connection aggregates image features from multiple imaging scales.", "By using grid-based gating, this allows attention coefficients to be more specific to local regions as it increases the grid-resolution of the query signal. This achieves better performance compared to gating based on a global feature vector.", "Additive soft attention is used in the sentence to sentence translation (Bahdanau et al. and Shen et al.) and in image classification (Jetley et al. and Wang et al.). Although this is computationally more expensive, Luong et al. have shown that soft-attention can achieve higher accuracy than multiplicative attention.", "Below is an illustration of Attention U-Net.", "I will be using the Drishti-GS Dataset, which contains 101 retina images, and annotated mask of the optical disc and optical cup. 50 images will are for training and 51 for validation.", "The experiment setup and the metrics used will be the same as the U-Net.", "The model completed training in 13 minutes; each epoch took approximately 15 seconds.", "The metrics between several U-Net models for comparison, as shown below.", "The test began with the model processing a few unseen samples, to predict optical disc (red) and optical cup (yellow). Here are the test results for Attention U-Net, UNet++ and U-Net for comparison.", "Attention U-Net aims to increase segmentation accuracy further and to work with fewer training samples, by attaching attention gates on top of the standard U-Net.", "Attention U-Net eliminates the necessity of an external object localisation model which some segmentation architecture needs, thus improving the model sensitivity and accuracy to foreground pixels without significant computation overhead.", "Attention U-Net also incorporate grid-based gating, which allows attention coefficients to be more specific to local regions.", "Here is the PyTorch code of Attention U-Net architecture:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Alibaba PhD in machine learning | write about machine learning, neuroscience, healthcare & blockchain | reach me at linkedin.com/in/jingles"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F29b6f0827405&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----29b6f0827405--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29b6f0827405--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jinglesnote.medium.com/?source=post_page-----29b6f0827405--------------------------------", "anchor_text": ""}, {"url": "https://jinglesnote.medium.com/?source=post_page-----29b6f0827405--------------------------------", "anchor_text": "Jingles (Hong Jing)"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F641197e9ee36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=post_page-641197e9ee36----29b6f0827405---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29b6f0827405&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29b6f0827405&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1804.03999", "anchor_text": "\u201clearning where to look for the Pancreas\u201d by Oktay et al."}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "Read more about U-Net"}, {"url": "https://arxiv.org/abs/1804.02391", "anchor_text": "\u201cNeed to pay attention\u201d by Jetley et al."}, {"url": "https://arxiv.org/abs/1606.02393", "anchor_text": "Seo et al."}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S136184151830848X", "anchor_text": "Khened et al."}, {"url": "https://www.ncbi.nlm.nih.gov/pubmed/29427897", "anchor_text": "Roth et al."}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "U-Net"}, {"url": "https://arxiv.org/abs/1804.03999", "anchor_text": "Oktay et al."}, {"url": "https://arxiv.org/abs/1409.0473", "anchor_text": "Bahdanau et al."}, {"url": "https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/viewFile/16126/16099", "anchor_text": "Shen et al."}, {"url": "https://arxiv.org/abs/1804.02391", "anchor_text": "Jetley et al."}, {"url": "https://arxiv.org/abs/1704.06904", "anchor_text": "Wang et al."}, {"url": "https://arxiv.org/abs/1508.04025", "anchor_text": "Luong et al."}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "U-Net"}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-unet-a3f43342307b", "anchor_text": "UNet++"}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "U-Net"}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-u-net-a787741837fa", "anchor_text": "Biomedical Image Segmentation: U-NetWorks with very few training images and yields more precise segmentation.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/biomedical-image-segmentation-unet-991d075a3a4b", "anchor_text": "Biomedical Image Segmentation: UNet++Improve segmentation accuracy with a series of nested, dense skip pathwaystowardsdatascience.com"}, {"url": "https://towardsdatascience.com/data-scientist-the-dirtiest-job-of-the-21st-century-7f0c8215e845", "anchor_text": "Data Scientist: The Dirtiest Job of the 21st Century40% vacuum, 40% janitor, 20% fortune-teller.towardsdatascience.com"}, {"url": "https://www.linkedin.com/in/jingles/", "anchor_text": ""}, {"url": "https://towardsdatascience.com/@jinglesnote", "anchor_text": ""}, {"url": "https://jingles.substack.com/subscribe", "anchor_text": ""}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----29b6f0827405---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----29b6f0827405---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/neuroscience?source=post_page-----29b6f0827405---------------neuroscience-----------------", "anchor_text": "Neuroscience"}, {"url": "https://medium.com/tag/health?source=post_page-----29b6f0827405---------------health-----------------", "anchor_text": "Health"}, {"url": "https://medium.com/tag/technology?source=post_page-----29b6f0827405---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29b6f0827405&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=-----29b6f0827405---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29b6f0827405&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=-----29b6f0827405---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29b6f0827405&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29b6f0827405--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F29b6f0827405&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----29b6f0827405---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----29b6f0827405--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----29b6f0827405--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----29b6f0827405--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----29b6f0827405--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----29b6f0827405--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----29b6f0827405--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----29b6f0827405--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----29b6f0827405--------------------------------", "anchor_text": ""}, {"url": "https://jinglesnote.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jinglesnote.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jingles (Hong Jing)"}, {"url": "https://jinglesnote.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "http://linkedin.com/in/jingles", "anchor_text": "linkedin.com/in/jingles"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F641197e9ee36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=post_page-641197e9ee36--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb9c0df6b9368&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbiomedical-image-segmentation-attention-u-net-29b6f0827405&newsletterV3=641197e9ee36&newsletterV3Id=b9c0df6b9368&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}