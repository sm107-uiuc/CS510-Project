{"url": "https://towardsdatascience.com/how-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b", "time": 1682995731.74768, "path": "towardsdatascience.com/how-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b/", "webpage": {"metadata": {"title": "How to use K-Means clustering in BigQuery ML to understand and describe your data better | by Lak Lakshmanan | Towards Data Science", "h1": "How to use K-Means clustering in BigQuery ML to understand and describe your data better", "description": "BigQuery ML now supports unsupervised learning \u2014 you can apply the K-Means algorithm to group your data into clusters. Unlike supervised machine learning, which is about predictive analytics\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-to-build-a-collaborative-filtering-model-for-personalized-recommendations-using-tensorflow-and-b9a77dc1320", "anchor_text": "a collaborative approach such as WALS", "paragraph_index": 3}], "all_paragraphs": ["BigQuery ML now supports unsupervised learning \u2014 you can apply the K-Means algorithm to group your data into clusters. Unlike supervised machine learning, which is about predictive analytics, unsupervised learning is about descriptive analytics \u2014 it\u2019s about understanding your data so that you can make data-driven decisions.", "First, determine what you are clustering and why you are doing it. Suppose you are a retailer who has data on customer transactions. There are several ways you could do the clustering on this dataset, and it depends on what you want to do with the clusters.", "In both these cases, you are using clustering as a heuristic to help you make decisions \u2014 it\u2019s too hard to design individualized products or understand product interactions, so you design for groups of customers or groups of items.", "Note that for the specific use case of product recommendations (recommending products to customers or targeting customers for a product), it is better train an ML model to do that exact thing, using a collaborative approach such as WALS. But for other decisions for which there is no readily available predictive analytics approach, clustering might give you a way to make a data-driven decision.", "In order to use clustering well, you need to do four things:", "In this article, I\u2019ll demonstrate the clustering approach on London bike share data. Let\u2019s say that we make a lot of decisions around the design and stocking of bike share stations and we would like to understand the different types of stations we have in our system so that we can make these decisions in a data-driven way.", "We need to do these four things:", "But before all that, we first have to gather the data we need.", "The data we will use consists of bike rentals in London and it\u2019s a public dataset in the EU region, so make sure to create a dataset in the EU region called demos_eu if you want to follow along with my queries.", "We want to cluster stations based on these factors:", "We often make decisions such as stocking the station (i.e. making sure the station has bikes for rent) on weekdays differently from weekends. So, we are actually going to cluster instances whose \u201cprimary key\u201d is the combination of station_name and isweekday.", "Here\u2019s a query that\u2019ll pull together the relevant data:", "We are extracting data on cycle hires (start_station_name, weekend/weekday, duration) in 2015 (see the WHERE clause) and joining it against station information (bike count, distance-from-city-center).", "Then, we compute attributes of the station in stationstats (the average duration of rides, number of trips) and pass through the station attributes (bike count, distance-from-city-center). Our dataset looks like this:", "Doing the clustering simply involves adding a CREATE MODEL statement to the SELECT query above and removing the \u201cid\u201d fields in our data:", "This query processed 1.2 GB and took 54 seconds. The model schema lists the 4 factors that were used in the clustering:", "Note that we have specified the desired number of clusters (num_clusters=4) in my CREATE MODEL and removed the factors (station_name and isweekday) that we don\u2019t want to cluster on. Standardizing features is a good option to include if your features have different dynamic ranges (bikes_count is in the 10\u201350 range while num_trips is in the thousands, so I am doing that).", "If we leave out the number of clusters, BigQuery ML will choose a reasonable default based on the total number of rows in the training dataset. We could also do hyperparameter tuning to find a good number. Essentially, we will run the clustering for different values of num_clusters, find the error measure, and pick the point at which the graph plateaus out. The error measure can be obtained using:", "The lower the number, the better the clustering.", "Which cluster does a particular station belong to? You get that using ML.PREDICT. Here\u2019s a query to find the cluster of every station that has \u2018Kennington\u2019 in its name:", "You can look at the cluster centroids \u2014 essentially the values of the 4 factors in the model schema using:", "With a little bit of SQL manipulation, we can pivot the above table:", "To visualize this table, click on \u201cExplore in Data Studio\u201d and select \u201cTable with bars\u201d. Make the centroid column the \u201cdimension\u201d and the remaining columns the metrics. Then you will get:", "This allows us to interpret the clusters. Essentially, Cluster #1 consists of suburban stations from which people go for long rides, Cluster #2 consists of other suburban stations, Cluster #3 consists of busy city stations, and Cluster #4 consists of not-so-busy city stations.", "Based on these characteristics and some knowledge of London, we can come up with descriptive names for these clusters. Cluster 1 would probably be \u201cDay trips\u201d, Cluster 2 would be \u201cBedroom communities\u201d, Cluster 3 would be \u201cTourist areas\u201d, and Cluster 4 would be \u201cBusiness district\u201d.", "Let\u2019s use these clusters to make different decisions.", "Obviously, we could have made these decisions individually by doing custom data analysis each time. But clustering the stations, coming up with descriptive names, and using the names to make decisions is much simpler and more explainable.", "The fact that you can do all this using just SQL? That\u2019s pretty cool.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "articles are personal observations and not investment advice."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc972c6f5733b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lakshmanok.medium.com/?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": "Lak Lakshmanan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F247b0630b5d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&user=Lak+Lakshmanan&userId=247b0630b5d6&source=post_page-247b0630b5d6----c972c6f5733b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc972c6f5733b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc972c6f5733b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/ZaLUzigr0mc?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Randy Fath"}, {"url": "https://unsplash.com/search/photos/peppers?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/how-to-build-a-collaborative-filtering-model-for-personalized-recommendations-using-tensorflow-and-b9a77dc1320", "anchor_text": "a collaborative approach such as WALS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc972c6f5733b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&user=Lak+Lakshmanan&userId=247b0630b5d6&source=-----c972c6f5733b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc972c6f5733b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&user=Lak+Lakshmanan&userId=247b0630b5d6&source=-----c972c6f5733b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc972c6f5733b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc972c6f5733b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c972c6f5733b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c972c6f5733b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c972c6f5733b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c972c6f5733b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c972c6f5733b--------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lak Lakshmanan"}, {"url": "https://lakshmanok.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F247b0630b5d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&user=Lak+Lakshmanan&userId=247b0630b5d6&source=post_page-247b0630b5d6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F44e3f26acd1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-k-means-clustering-in-bigquery-ml-to-understand-and-describe-your-data-better-c972c6f5733b&newsletterV3=247b0630b5d6&newsletterV3Id=44e3f26acd1a&user=Lak+Lakshmanan&userId=247b0630b5d6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}