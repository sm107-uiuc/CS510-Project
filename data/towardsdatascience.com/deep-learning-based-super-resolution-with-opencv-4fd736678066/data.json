{"url": "https://towardsdatascience.com/deep-learning-based-super-resolution-with-opencv-4fd736678066", "time": 1683004861.994981, "path": "towardsdatascience.com/deep-learning-based-super-resolution-with-opencv-4fd736678066/", "webpage": {"metadata": {"title": "Deep Learning based Super Resolution with OpenCV | by Xavier Weber | Towards Data Science", "h1": "Deep Learning based Super Resolution with OpenCV", "description": "OpenCV is an open-source computer vision library that has an extensive collection of great algorithms. Since one of the latest mergers, OpenCV contains an easy-to-use interface for implementing Super\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.opencv.org/master/d7/d9f/tutorial_linux_install.html", "anchor_text": "opencv documentation", "paragraph_index": 2}, {"url": "https://github.com/Saafke/FSRCNN_Tensorflow/blob/master/models/FSRCNN_x2.pb", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://github.com/opencv/opencv_contrib/tree/master/modules/dnn_superres", "anchor_text": "module\u2019s GitHub README", "paragraph_index": 15}, {"url": "https://docs.opencv.org/master/dc/d69/tutorial_dnn_superres_benchmark.html", "anchor_text": "here", "paragraph_index": 15}], "all_paragraphs": ["OpenCV is an open-source computer vision library that has an extensive collection of great algorithms. Since one of the latest mergers, OpenCV contains an easy-to-use interface for implementing Super Resolution (SR) based on deep learning methods. The interface contains pre-trained models that can be used for inference very easily and efficiently. In this post, I will explain what it can do and show step-by-step how to use it. So far, it works with C++ and Python.", "NOTE: You don\u2019t need any knowledge about SR to use this code. I am running this on an Ubuntu 16.04 machine, but it works for any other distributions (it also works on Windows).", "Our first step is to install OpenCV. Some features are released later, so be careful with the version: 4.2.0 for C++, 4.3.0 adds Python wrap, 4.4.0 adds GPU inference. You can follow the instructions from the opencv documentation. It is very important that you also install the contrib modules, because that is where the SR interface code resides. You can choose to install all the contrib modules or just the necessary SR one. The interface or module we will use is called dnn_superres (dnn stands for Deep Neural Network; superres for Super Resolution).", "We need to download the pre-trained models separately, because the OpenCV code-base does not contain them. The reason is some of the models are quite big. So if they were in the standard code-base, people who might not need them still would have to download them. There are several models to choose from (see section Models in this article). All of them are implementations of popular SR papers. For now, let\u2019s choose a small model. You can download it here. This pre-trained model can increase the resolution of an image by 2. For more models and their explanations, see section Models in this post.", "Now we are ready to upscale our own images or even video. I will provide example code for C++ and Python. (If you want to use GPU for inference, please also refer to Notes at the bottom of this page.) Let\u2019s look at C++ first:", "I will explain the important parts of the code.", "This loads all the variables of the chosen model and prepares the neural network for inference. The parameter is the path to your downloaded pre-trained model. When you want to use a different model, just download it (see Models section of this article) and update the path.", "This lets the module know which model you have chosen, so it can choose the correct pre- and post-processing. You have to specify the correct model, because each model uses different processing.", "The first parameter is the name of the model. You can choose between: \u201cedsr\u201d, \u201cfsrcnn\u201d, \u201clapsrn\u201d, \u201cespcn\u201d. It is very important that this model is the correct one for the model you specified in \u2018sr.readModel()\u2019. See the Model section on the bottom of the page for the specifications of each model.", "The second parameter is the upscaling factor, i.e. how many times you will increase the resolution. Again, this needs to match with your chosen model. Each model will have a separate file for the upscaling factor.", "This is the inference part, which runs your image through the neural network and produces your upscaled image.", "Now just compile and run your file to upscale your images!", "It is almost exactly the same as in C++, except for two things.", "2. When upscaling, you can assign the upscaled image directly, instead of creating a placeholder image:", "There are currently 4 different SR models supported in the module. They can all upscale images by a scale of 2, 3 and 4. LapSRN can even upscale by a factor of 8. They differ in accuracy, size and speed.", "For more information and implementations of these models see the module\u2019s GitHub README file. For extensive benchmarks and comparisons go here.", "Let\u2019s look at some results! (If you are on mobile, zoom in to see the difference more clearly.)", "As you can see, the models produce extremely pleasing results that absolutely destroy the performance of simple bilinear interpolation. Especially EDSR gives amazing results, although it is a bit slow (inference of a couple of seconds). Give it a try yourself!", "[1] Bee Lim, Sanghyun Son, Heewon Kim, Seungjun Nah, and Kyoung Mu Lee, \u201cEnhanced Deep Residual Networks for Single Image Super-Resolution\u201d, 2nd NTIRE: New Trends in Image Restoration and Enhancement workshop and challenge on image super-resolution in conjunction with CVPR 2017.", "[2] Shi, W., Caballero, J., Husz\u00e1r, F., Totz, J., Aitken, A., Bishop, R., Rueckert, D. and Wang, Z., \u201cReal-Time Single Image and Video Super-Resolution Using an Efficient Sub-Pixel Convolutional Neural Network\u201d, Proceedings of the IEEE conference on computer vision and pattern recognition CVPR 2016.", "[3] Chao Dong, Chen Change Loy, Xiaoou Tang. \u201cAccelerating the Super-Resolution Convolutional Neural Network\u201d, in Proceedings of European Conference on Computer Vision ECCV 2016.", "[4] Lai, W. S., Huang, J. B., Ahuja, N., and Yang, M. H., \u201cDeep laplacian pyramid networks for fast and accurate super-resolution\u201d, In Proceedings of the IEEE conference on computer vision and pattern recognition CVPR 2017.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Researching AI and computer vision. Interested in science, technology, philosophy and culture."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4fd736678066&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4fd736678066--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4fd736678066--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@xavierweber63?source=post_page-----4fd736678066--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@xavierweber63?source=post_page-----4fd736678066--------------------------------", "anchor_text": "Xavier Weber"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Facf79ddb33c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&user=Xavier+Weber&userId=acf79ddb33c6&source=post_page-acf79ddb33c6----4fd736678066---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fd736678066&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fd736678066&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kathysg?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Kathy Servian"}, {"url": "https://unsplash.com/s/photos/butterfly?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://docs.opencv.org/master/d7/d9f/tutorial_linux_install.html", "anchor_text": "opencv documentation"}, {"url": "https://github.com/Saafke/FSRCNN_Tensorflow/blob/master/models/FSRCNN_x2.pb", "anchor_text": "here"}, {"url": "https://github.com/Saafke/EDSR_Tensorflow/tree/master/models", "anchor_text": "here"}, {"url": "https://github.com/fannymonori/TF-ESPCN/tree/master/export", "anchor_text": "here"}, {"url": "https://github.com/Saafke/FSRCNN_Tensorflow/tree/master/models", "anchor_text": "here"}, {"url": "https://github.com/fannymonori/TF-LapSRN/tree/master/export", "anchor_text": "here"}, {"url": "https://github.com/opencv/opencv_contrib/tree/master/modules/dnn_superres", "anchor_text": "module\u2019s GitHub README"}, {"url": "https://docs.opencv.org/master/dc/d69/tutorial_dnn_superres_benchmark.html", "anchor_text": "here"}, {"url": "https://unsplash.com/@randyfath?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Randy Fath"}, {"url": "https://unsplash.com/s/photos/vegetable?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/opencv/opencv_contrib/pull/2599", "anchor_text": "See the related Pull Request."}, {"url": "https://gist.github.com/Saafke/3e53662286ac3254d34b1d6b9e5b1604", "anchor_text": "link to opencv build command"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----4fd736678066---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/super-resolution?source=post_page-----4fd736678066---------------super_resolution-----------------", "anchor_text": "Super Resolution"}, {"url": "https://medium.com/tag/opencv?source=post_page-----4fd736678066---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4fd736678066---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----4fd736678066---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4fd736678066&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&user=Xavier+Weber&userId=acf79ddb33c6&source=-----4fd736678066---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4fd736678066&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&user=Xavier+Weber&userId=acf79ddb33c6&source=-----4fd736678066---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fd736678066&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4fd736678066--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4fd736678066&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4fd736678066---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4fd736678066--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4fd736678066--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4fd736678066--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4fd736678066--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4fd736678066--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4fd736678066--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4fd736678066--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4fd736678066--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@xavierweber63?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@xavierweber63?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Xavier Weber"}, {"url": "https://medium.com/@xavierweber63/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "75 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Facf79ddb33c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&user=Xavier+Weber&userId=acf79ddb33c6&source=post_page-acf79ddb33c6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbfd6c630eb7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-based-super-resolution-with-opencv-4fd736678066&newsletterV3=acf79ddb33c6&newsletterV3Id=bfd6c630eb7c&user=Xavier+Weber&userId=acf79ddb33c6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}