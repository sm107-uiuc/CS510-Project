{"url": "https://towardsdatascience.com/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1", "time": 1683009731.209001, "path": "towardsdatascience.com/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1/", "webpage": {"metadata": {"title": "How to transform variables in a pandas DataFrame | by Zolzaya Luvsandorj | Towards Data Science", "h1": "How to transform variables in a pandas DataFrame", "description": "Whether it\u2019s for preparing data to extract insights or for engineering features for a model, I think one of the fundamental skills for individuals working with data is their ability to reliably\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.python.org/about/gettingstarted/", "anchor_text": "this", "paragraph_index": 1}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html", "anchor_text": "this documentation", "paragraph_index": 35}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html", "anchor_text": "this documentation", "paragraph_index": 42}, {"url": "https://pandas.pydata.org/pandas-docs/stable/getting_started/basics.html#basics-dt-accessors", "anchor_text": "this documentation", "paragraph_index": 46}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html", "anchor_text": "here", "paragraph_index": 47}, {"url": "https://zluvsand.medium.com/membership", "anchor_text": "my referral link", "paragraph_index": 51}, {"url": "https://towardsdatascience.com/introduction-to-nlp-part-1-preprocessing-text-in-python-8f007d44ca96", "anchor_text": "Introduction to NLP \u2014 Part 1: Preprocessing text in Python", "paragraph_index": 52}, {"url": "https://medium.com/@zluvsand/introduction-to-nlp-part-2-difference-between-lemmatisation-and-stemming-3789be1c55bc", "anchor_text": "Introduction to NLP \u2014 Part 2: Difference between lemmatisation and stemming", "paragraph_index": 52}, {"url": "https://medium.com/@zluvsand/introduction-to-nlp-part-3-tf-idf-explained-cedb1fc1f7dc", "anchor_text": "Introduction to NLP \u2014 Part 3: TF-IDF explained", "paragraph_index": 52}, {"url": "https://medium.com/@zluvsand/introduction-to-nlp-part-4-supervised-text-classification-model-in-python-96e9709b4267", "anchor_text": "Introduction to NLP \u2014 Part 4: Supervised text classification model in Python", "paragraph_index": 52}, {"url": "https://zluvsand.github.io/", "anchor_text": "https://zluvsand.github.io/", "paragraph_index": 55}], "all_paragraphs": ["Whether it\u2019s for preparing data to extract insights or for engineering features for a model, I think one of the fundamental skills for individuals working with data is their ability to reliably transform data to the desired format. As part of data cleaning, data preparation, data munging, data manipulation, data wrangling, data enriching, data preprocessing (whew! \ud83d\ude05), there is often a need to transform variables/columns/features to a more suitable form . In other words, raw data often needs a makeover \u2728 to be more useful.", "I assume the reader (\ud83d\udc40 yes, you!) has access to and is familiar with Python including installing packages, defining functions and other basic tasks. If you are new to Python, this is a good place to get started.", "I have used and tested the scripts in Python 3.7.1 in Jupyter Notebook. Let\u2019s make sure you have the right tools before we start deriving.", "We will use the following powerful third party packages:", "To keep things manageable, we will create a small dataframe which will allow us to monitor inputs and outputs for each task in the next section. In a hypothetical world where I have a collection of marbles \ud83d\udd2e, let\u2019s assume the dataframe below contains the details for each kind of marble I own. (Psst! You may have to copy over the code to your Jupyter Notebook or code editor for a better format.)", "Each row represents a kind of marble. Columns are defined as:\u25fc name: Name for each marble (first part is the model name and second is the version)\u25fc purchase_date: Date I purchased a kind of marbles\u25fc count: How many marbles I own for a particular kind\u25fc colour: Colour of the kind\u25fc radius: Radius measurement of the kind (yup, some are quite big \ud83d\ude4a)\u25fc unit: A unit for radius", "If this doesn\u2019t make much sense, don\u2019t worry too much as it\u2019s only a toy data.", "In this section, we will look at some examples on transforming different data types. We will be creating new columns containing the transformation so that the original variables are not overwritten. Alternative codes to achieve the same transformation are provided for reference where possible. From these list of alternatives, hope you will find a trick or two for take away for your day-to-day data manipulation. Now, it\u2019s time for a makeover! \u2728", "Please note that the underlying logic for some methods shown can be applied to any data types.", "\ud83d\udd26 Type: Create a conditional variable based on 2 conditions.", "\ud83d\udd12 Task: Radius is not directly comparable across kinds as they are expressed in different units. Let\u2019s create a variable showing radius in cm for consistency.", "\ud83d\udd11 Answer: We will call the new variable radius_cm. Given that 1 inch equals 2.54 cm, we can summarise the conditions as follows:1) If unit is \u2018cm\u2019 then radius_cm = radius2) If unit is \u2018inch\u2019 then radius_cm = 2.54 * radius", "We can create radius_cm using the script below:", "\ud83d\udca1 Quick tip: To comment or decomment code in a Jupyter Notebook, select a chunk of code and use [Ctrl/Cmd + /] shortcut if you don\u2019t already know.", "\ud83d\udd12 Task: Create a variable describing marble size based on its radius in cm.", "\ud83d\udd11 Answer: We will call the new variable size. Let\u2019s define \u2018big\u2019 as marbles with radius of 5 cm or higher, and anything lower as \u2018small\u2019. Therefore, the conditions are:1) If radius_cm \u2265 5 then size = \u2018big\u20192) If radius_cm < 5 then size = \u2018small\u2019", "We can create size using the script below:", "I haven\u2019t provided any alternative for this task to avoid repetition as any method from the first task can be used here.", "\ud83d\udccc Exercise: Try doing the same transformation using a different method by referencing methods shown in the first task.", "\ud83d\udd26 Type: Create a calculated variable.", "\ud83d\udd12 Task: Calculate sphere volume for marbles.", "\ud83d\udd11 Answer: We can create volume using the script below:", "\ud83d\udd12 Task: Create a variable that splits the marbles into 2 bins of equal width based on their counts.", "\ud83d\udd11 Answer: We will call the new variable cut.\u25fc min count = 10\u25fc max count = 80\u25fc range count = max \u2014 min = 70\u25fc bin width = range / number of bins = 70 / 2 = 35As count ranges from 10 to 80 marbles, having 2 bins would mean that the first bin would be 10 to 45 and the second 45 to 80, each with an equal width of 35. Currently, we have defined bins to be inclusive of the rightmost edge with the default setting: right=True. This means if we had 45 marbles for a kind, it would fall into the lower bin (i.e. 10\u201345). We could easily change this behaviour to be exclusive of the rightmost edge by adding right=False inside the function below. Please also see my note in the next task.", "We can create cut using the script below:", "\ud83d\udd26 Type: Segment numerical values into equal sized bins (Discritise).", "\ud83d\udd12 Task: Create a variable that splits the marbles into 2 equal sized buckets (i.e. quantiles) based on their counts.", "Of note, if you are interested to view the exact cut-off points for either the equal width or equal sized bins, one way to do so is to leave out label argument from the function. Viewing the exact cut-off points will provide clarity on how the points that are on the edge are treated when discretizing.", "So anyway\u2026 getting back to qcut, we can create it using the script below:", "Notice the difference between cut and qcut?", "\ud83d\udd26 Type: Create a conditional variable based on 3+ conditions (Group).", "\ud83d\udd12 Task: Create a variable that abbreviates pink into \u2018PK\u2019, teal into \u2018TL\u2019 and all other colours (velvet and green) into \u2018OT\u2019.", "\ud83d\udd11 Answer: We will call the new variable colour_abr. So the conditions are:1) If colour is \u2018pink\u2019 then colour_abr = \u2018PK\u20192) If colour is \u2018teal\u2019 then colour_abr = \u2018TL\u20193) If colour is either \u2018velvet\u2019 or \u2018green\u2019 then colour_abr = \u2018OT\u2019.", "We can create colour_abr using the script below:", "If we were just renaming the categories instead of grouping, we could also use either of the following method from .cat accessor in addition to the methods shown above:", "See this documentation for more information on .cat accessor. \ud83d\udc31", "\ud83d\udd26 Type: Parse a string (Extract a part from a string).", "\ud83d\udd12 Task: Parse name such that we have new columns for model and version.", "\ud83d\udd11 Answer: We will now use a method from .str accessor to extract parts:", "\ud83d\udd26 Type: Concatenate or combine columns (Opposite of task above).", "\ud83d\udd12 Task: Combine values in model (make it uppercase) and radius in a new column.", "\ud83d\udd11 Answer: We will now use the script below to concatenate:", "See this documentation for more information on .str accessor. \ud83c\udfbb", "\ud83d\udd26 Type: Parse a datetime (Extract a part from a datetime).", "\ud83d\udd12 Task: Extract the days of the week, and years of purchase.", "\ud83d\udd11 Answer: We will now use method from .dt accessor to extract parts:", "See this documentation for more information on .dt accessor. \ud83d\udd5f", "By scrolling the pane on the left here, you could browse available methods for the accessors discussed earlier. Look out for pandas.Series.xxx.yyy where xxx can be substituted with either cat, str or dt, and yyy refers to the method.", "Now we will get familiar with assign, which allows us to create multiple variables at one go. Once tested, we can combine the steps like below:", "Does this script look a bit hectic? If you focus line by line, you will see that each line is a slightly transformed version of the code that we have learned from section 2.", "As a final note, when creating variables, if you make a mistake, you could always overwrite the incorrect variable with the correct one or delete it using the script below \u26d4\ufe0f:", "Would you like to access more content like this? Medium members get unlimited access to any articles on Medium. If you become a member using my referral link, a portion of your membership fee will directly go to support me.", "Thank you for reading my post. I hope that you have learned something \u2702\ufe0f. In case you are interested, here are links to the some of my other posts:\u25fc\ufe0f\ufe0f Introduction to NLP \u2014 Part 1: Preprocessing text in Python\u25fc\ufe0f Introduction to NLP \u2014 Part 2: Difference between lemmatisation and stemming\u25fc\ufe0f Introduction to NLP \u2014 Part 3: TF-IDF explained\u25fc\ufe0f Introduction to NLP \u2014 Part 4: Supervised text classification model in Python", "Keep transforming! Keep, keep transforming variables! \ud83c\udfa4 (sing along! \ud83d\ude4b)You keep transforming! You keep, keep transforming variables! \ud83c\udfb6Keep transforming! Keep, keep transforming variables! \ud83c\udfb5Go transform your data\u2026 \ud83c\udfbc", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist \ud83d\udca1| Growth Mindset \ud83d\udd11 | Math Lover \ud83d\udd22 | Melbourne, AU \ud83d\udc28 | https://zluvsand.github.io/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbce2c6ef91a1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zluvsand.medium.com/?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": ""}, {"url": "https://zluvsand.medium.com/?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": "Zolzaya Luvsandorj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bca2b935223&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=post_page-5bca2b935223----bce2c6ef91a1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbce2c6ef91a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbce2c6ef91a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@fempreneurstyledstock?utm_source=medium&utm_medium=referral", "anchor_text": "Leone Venter"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.python.org/about/gettingstarted/", "anchor_text": "this"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html", "anchor_text": "this documentation"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html", "anchor_text": "this documentation"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/getting_started/basics.html#basics-dt-accessors", "anchor_text": "this documentation"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html", "anchor_text": "here"}, {"url": "https://unsplash.com/@stilclassics?utm_source=medium&utm_medium=referral", "anchor_text": "STIL"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://zluvsand.medium.com/membership", "anchor_text": "my referral link"}, {"url": "https://towardsdatascience.com/introduction-to-nlp-part-1-preprocessing-text-in-python-8f007d44ca96", "anchor_text": "Introduction to NLP \u2014 Part 1: Preprocessing text in Python"}, {"url": "https://medium.com/@zluvsand/introduction-to-nlp-part-2-difference-between-lemmatisation-and-stemming-3789be1c55bc", "anchor_text": "Introduction to NLP \u2014 Part 2: Difference between lemmatisation and stemming"}, {"url": "https://medium.com/@zluvsand/introduction-to-nlp-part-3-tf-idf-explained-cedb1fc1f7dc", "anchor_text": "Introduction to NLP \u2014 Part 3: TF-IDF explained"}, {"url": "https://medium.com/@zluvsand/introduction-to-nlp-part-4-supervised-text-classification-model-in-python-96e9709b4267", "anchor_text": "Introduction to NLP \u2014 Part 4: Supervised text classification model in Python"}, {"url": "https://cheatography.com/davechild/cheat-sheets/regular-expressions/", "anchor_text": "L[a-z]{4}"}, {"url": "https://medium.com/tag/python?source=post_page-----bce2c6ef91a1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----bce2c6ef91a1---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-manipulation?source=post_page-----bce2c6ef91a1---------------data_manipulation-----------------", "anchor_text": "Data Manipulation"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----bce2c6ef91a1---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----bce2c6ef91a1---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbce2c6ef91a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=-----bce2c6ef91a1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbce2c6ef91a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=-----bce2c6ef91a1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbce2c6ef91a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbce2c6ef91a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bce2c6ef91a1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bce2c6ef91a1--------------------------------", "anchor_text": ""}, {"url": "https://zluvsand.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zluvsand.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Zolzaya Luvsandorj"}, {"url": "https://zluvsand.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.3K Followers"}, {"url": "https://zluvsand.github.io/", "anchor_text": "https://zluvsand.github.io/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bca2b935223&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=post_page-5bca2b935223--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fea8899bb3fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransforming-variables-in-a-pandas-dataframe-bce2c6ef91a1&newsletterV3=5bca2b935223&newsletterV3Id=ea8899bb3fba&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}