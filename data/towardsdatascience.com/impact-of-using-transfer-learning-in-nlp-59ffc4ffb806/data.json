{"url": "https://towardsdatascience.com/impact-of-using-transfer-learning-in-nlp-59ffc4ffb806", "time": 1683001305.349497, "path": "towardsdatascience.com/impact-of-using-transfer-learning-in-nlp-59ffc4ffb806/", "webpage": {"metadata": {"title": "Impact of using transfer learning in NLP | by Gabriel Naya | Towards Data Science", "h1": "Impact of using transfer learning in NLP", "description": "In different classification works with NLP, we have used ULMFiT. We can find two excellent articles on this methodology in Transfer Learning in NLP for Tweet Stance Classification and Universal\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "ULMFiT", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/transfer-learning-in-nlp-for-tweet-stance-classification-8ab014da8dde", "anchor_text": "Transfer Learning in NLP for Tweet Stance Classification", "paragraph_index": 0}, {"url": "https://medium.com/bitbroker-labs/universal-language-model-fine-tuning-for-text-classification-ulmfit-73ea2b383926", "anchor_text": "Universal Language Model Fine-tuning for Text Classification-ULMFiT", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "original paper", "paragraph_index": 2}, {"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "dataset", "paragraph_index": 8}, {"url": "http://ruder.io/nlp-imagenet/", "anchor_text": "In his post", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/pre-trained-language-model-in-any-language-7531ea7217d4", "anchor_text": "an article", "paragraph_index": 19}, {"url": "https://einstein.ai/research/blog/the-wikitext-long-term-dependency-language-modeling-dataset", "anchor_text": "wikitext-103", "paragraph_index": 23}, {"url": "https://fast.ai course/", "anchor_text": "fastai course", "paragraph_index": 31}, {"url": "https://course.fast.ai/", "anchor_text": "fast.ai course", "paragraph_index": 33}, {"url": "https://gnaya73.glitch.me/", "anchor_text": "https://gnaya73.glitch.me/", "paragraph_index": 35}], "all_paragraphs": ["In different classification works with NLP, we have used ULMFiT. We can find two excellent articles on this methodology in Transfer Learning in NLP for Tweet Stance Classification and Universal Language Model Fine-tuning for Text Classification-ULMFiT.", "ULMFiT has implemented in version1 of the fastai\u00b9 library, and they have developed some techniques that make it very convenient to do transfer learning.", "In the original paper, ULMFiT consists of three stages:", "The main objective of this article is to measure the difference and impact between starting at stage three(classifier), from a pre-trained language model (stage two) or directly from scratch.", "In other words, the stage two model is created with and without transfer learning, comparing the initial results.", "In the first part of this article, we are going to import the dataset and carry out the necessary data transformation operations.", "Then we will measure the impact of using a language model that receives transfer-learning from another already trained model, or of creating the language model directly from the dataset, and compare both results.", "Finally, we are going to use the best of the language models created in the previous section to develop a sentiment classifier on NLP.", "The dataset for binary sentiment classification has been curated by Andrew Maas\u00b2 et al. and contains a total of 100,000 reviews on IMDB\u00b3 . 25,000 of them labeled as positive and negative for training; another 25,000 labeled for testing.", "There are other 50,000 additional unlabeled data that we will use for creating our model language learning.", "\u201cSince a text is composed of words, and can\u2019t apply mathematical functions to them directly, we first have to convert them to numbers. In fastai, this is done in two different steps: tokenization and numericalization. In fastai API, TextDataBunch does it for us *.\u201d", "Once we have tokens from our texts, TextDataBunch converts to integers by creating a list of all the words used. The maximum vocabulary size by default is 60,000 and replace the ones that don\u2019t cut by the unknown token UNK.", "The correspondence from ids to tokens is store in the vocab attribute, in a dictionary called itos.", "Now if we look at our datasets, we\u2019ll see the tokenized text as:", "And if we look al train_ds, all are numbers:", "\u201cA language model attempts to learn the structure of natural language through hierarchical representations, and thus contains both low-level features (word representations) and high-level features (semantic meaning). A key feature of language modelling is that it is generative, meaning that it aims to predict the next word given a previous sequence of words. It is able to do this because language models are typically trained on very large datasets in an unsupervised manner, and hence the model can \u2018learn\u2019 the syntactic features of language in a much deeper way than word embeddings.", "In his post, Sebastian Ruder does a very elegant job of highlighting why language modelling is so powerful for a broad range of NLP tasks. Unlabelled language data is relatively easy to obtain (it is freely available in the form of large text corpora), so by feeding a language model a sufficiently large dataset, it is now possible to perform unsupervised pre-training on billions of words while incorporating a deeper knowledge of language syntax.\u201d\u2074", "We will use from the API of fastai, the language_model_learner that is a type of learner \u2075, that assume a language model from a dataset, taking a set of configurations.", "Language_model_learner admits the property \u201cpre-trained (Bool)\u201d, whose default option is True and assumes a model as transfer learning for each language.", "This technique has been used to create a language model for differents idioms, here is an article with an excellent example in Vietnamese\u2076.", "\u201cWe have to use a special kind of TextDataBunch for the language model, that ignores the labels (that's why we put 0 everywhere), will shuffle the texts at each epoch before concatenating them all together (only for training, we don't shuffle for the validation set) and will send batches that read that text in order with targets that are the next word in the sentence.*\u201d", "Here is where we indicate to the API that we intend the \u201clearn\u201d model not to take the default weights from the pre-trained transfer learning, but to start without assuming pre-training:", "After adjusting the learning rate and training, we obtain an accuracy of 0.284114", "The model pre-trained on a bigger dataset used in fastai, is a cleaned subset of Wikipedia called wikitext-103.", "\u201cWe are going to use that \u2018knowledge\u2019 of the English language to build our classifier, but first, like for computer vision, we need to fine-tune the pretrained model to our particular dataset. Because the English of the reviews left by people on IMDB isn\u2019t the same as the English of wikipedia, we\u2019ll need to adjust the parameters of our model by a little bit. Plus there might be some words that would be extremely common in the reviews dataset but would be barely present in wikipedia, and therefore might not be part of the vocabulary the model was trained on. *\u201d", "Not only should the model be saved for the next part, but also its encoder. This part is essential because to reuse this model, the list of words and their Ids must be the same.", "We create the classifier, and assign it the encoder of the previous stage.", "On left, model language from scratch, on right, the model with transfer learning:", "Finally, after adjustments of learning rate and some additional pieces of training we obtain a classifier of sentiments on the dataset of movie reviews with an accuracy of 0.943960.", "We have experimented with the application of a pre-trained language model from a previous data body and a language model from scratch, obtaining better results when using transfer learning.", "Using the tools of fastai and UMLFiT, we can apply this through the data corpus of Wikipedia, to pre-train in any language, which in NLP is a great advantage due to the bias of tools and datasets in English.", "Finally, remember that it is essential to keep the encoder between the language model and the text classifier. The basis of this exercise was token from the fastai course, lesson3 and 4, where you can find the complete code and access to the dataset.", "I hope that the article has been useful to see the positive impact of using transfer learning in NLP, similar to that used in computer vision. Any correction, comment or idea will be welcome.", "[*] Many concepts from this article were directly token from lesson 3 and lesson 4 in fast.ai course", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine learning enthusiast and research at Kreilabs Uruguay. My profile: https://gnaya73.glitch.me/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F59ffc4ffb806&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://gabriel-naya73.medium.com/?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": ""}, {"url": "https://gabriel-naya73.medium.com/?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": "Gabriel Naya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4213edda07c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&user=Gabriel+Naya&userId=4213edda07c&source=post_page-4213edda07c----59ffc4ffb806---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F59ffc4ffb806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F59ffc4ffb806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pavement_special?utm_source=medium&utm_medium=referral", "anchor_text": "Riccardo Annandale"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "ULMFiT"}, {"url": "https://towardsdatascience.com/transfer-learning-in-nlp-for-tweet-stance-classification-8ab014da8dde", "anchor_text": "Transfer Learning in NLP for Tweet Stance Classification"}, {"url": "https://medium.com/bitbroker-labs/universal-language-model-fine-tuning-for-text-classification-ulmfit-73ea2b383926", "anchor_text": "Universal Language Model Fine-tuning for Text Classification-ULMFiT"}, {"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "original paper"}, {"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "dataset"}, {"url": "https://unsplash.com/@opticonor?utm_source=medium&utm_medium=referral", "anchor_text": "Conor Luddy"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://ruder.io/nlp-imagenet/", "anchor_text": "In his post"}, {"url": "https://towardsdatascience.com/pre-trained-language-model-in-any-language-7531ea7217d4", "anchor_text": "an article"}, {"url": "https://einstein.ai/research/blog/the-wikitext-long-term-dependency-language-modeling-dataset", "anchor_text": "wikitext-103"}, {"url": "https://unsplash.com/@georgiavagim?utm_source=medium&utm_medium=referral", "anchor_text": "Georgia Vagim"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://fast.ai course/", "anchor_text": "fastai course"}, {"url": "https://course.fast.ai/", "anchor_text": "https://course.fast.ai/"}, {"url": "http://ai.stanford.edu/~amaas/", "anchor_text": "http://ai.stanford.edu/~amaas/"}, {"url": "https://www.imdb.com/", "anchor_text": "https://www.imdb.com/"}, {"url": "https://towardsdatascience.com/transfer-learning-in-nlp-for-tweet-stance-classification-8ab014da8dde", "anchor_text": "https://towardsdatascience.com/transfer-learning-in-nlp-for-tweet-stance-classification-8ab014da8dde"}, {"url": "https://docs.fast.ai/basic_train.html#Learner", "anchor_text": "https://docs.fast.ai/basic_train.html#Learner"}, {"url": "https://towardsdatascience.com/pre-trained-language-model-in-any-language-7531ea7217d4", "anchor_text": "https://towardsdatascience.com/pre-trained-language-model-in-any-language-7531ea7217d4"}, {"url": "https://course.fast.ai/", "anchor_text": "fast.ai course"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----59ffc4ffb806---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----59ffc4ffb806---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----59ffc4ffb806---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----59ffc4ffb806---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----59ffc4ffb806---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F59ffc4ffb806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&user=Gabriel+Naya&userId=4213edda07c&source=-----59ffc4ffb806---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F59ffc4ffb806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&user=Gabriel+Naya&userId=4213edda07c&source=-----59ffc4ffb806---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F59ffc4ffb806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F59ffc4ffb806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----59ffc4ffb806---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----59ffc4ffb806--------------------------------", "anchor_text": ""}, {"url": "https://gabriel-naya73.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://gabriel-naya73.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gabriel Naya"}, {"url": "https://gabriel-naya73.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "78 Followers"}, {"url": "https://gnaya73.glitch.me/", "anchor_text": "https://gnaya73.glitch.me/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4213edda07c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&user=Gabriel+Naya&userId=4213edda07c&source=post_page-4213edda07c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F4213edda07c%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimpact-of-using-transfer-learning-in-nlp-59ffc4ffb806&user=Gabriel+Naya&userId=4213edda07c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}