{"url": "https://towardsdatascience.com/introduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42", "time": 1682995775.890719, "path": "towardsdatascience.com/introduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42/", "webpage": {"metadata": {"title": "Introduction to Image Augmentations using the fastai library | by Sanyam Bhutani | Towards Data Science", "h1": "Introduction to Image Augmentations using the fastai library", "description": "A detailed walk through and examples of real world use cases of data aug supported by fastai"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/init27/introduction-to-image-augmentation-using-fastai", "anchor_text": "You can also find the executable code of this blog in this kaggle kernel", "paragraph_index": 0}, {"url": "http://course-v3.fast.ai", "anchor_text": "website", "paragraph_index": 1}, {"url": "https://docs.fast.ai/", "anchor_text": "docs", "paragraph_index": 1}, {"url": "https://hackernoon.com/tagged/learning", "anchor_text": "Learning", "paragraph_index": 10}, {"url": "https://hackernoon.com/tagged/network", "anchor_text": "Network", "paragraph_index": 12}, {"url": "https://www.youtube.com/watch?v=4u0NRgMyzEM", "anchor_text": "\u201cit just works\u201d", "paragraph_index": 15}, {"url": "https://www.kaggle.com/init27/introduction-to-image-augmentation-using-fastai", "anchor_text": "With augmentations (default ones) enabled, you can see that the model performs better.", "paragraph_index": 16}, {"url": "https://youtu.be/U9BwWKXjVaI?t=55", "anchor_text": "I\u2019ll bet if your taking photos of your puppy at such angles", "paragraph_index": 48}, {"url": "https://docs.fast.ai/vision.transform.html#_symmetric_warp", "anchor_text": "Here\u2019s the definition, from the docs", "paragraph_index": 56}, {"url": "https://play.google.com/store/apps/details?id=com.google.ar.lens&hl=en_IN", "anchor_text": "Ever heard of Google Lens?", "paragraph_index": 59}, {"url": "https://hackernoon.com/launching-my-company-a-scholarship-and-a-webinar-277e3b66e351", "anchor_text": "My Learning Path", "paragraph_index": 66}, {"url": "http://twitter.com/bhutanisanyam1", "anchor_text": "here", "paragraph_index": 66}, {"url": "http://tinyletter.com/sanyambhutani/", "anchor_text": "newsletter here", "paragraph_index": 67}, {"url": "https://hackernoon.com/interviews-with-machine-learning-heroes-504762ba5dd6", "anchor_text": "Please click here", "paragraph_index": 68}, {"url": "http://H2O.ai", "anchor_text": "H2O.ai", "paragraph_index": 70}, {"url": "http://Fast.ai", "anchor_text": "Fast.ai", "paragraph_index": 70}, {"url": "https://twitter.com/bhutanisanyam1", "anchor_text": "https://twitter.com/bhutanisanyam1", "paragraph_index": 70}], "all_paragraphs": ["You can also find the executable code of this blog in this kaggle kernel .", "For more details on the fastai course, or library: please checkout the course website and library docs.", "The aim of this writeup is to give you a walkthrough of all of the image augmentations in fastai. I\u2019ll start by introducing data augmentation followed by image augmentation.", "Then we\u2019ll make a case of why fastai defaults \u201cjust works\u201d.", "Next, we\u2019ll look at a few real-world use-cases where this transforms will be super useful:", "We\u2019ll look at a base image of a cute puppy and first apply the transforms to use it as a reference and then I\u2019ll show the examples of the real world use-cases of the same.", "Note that these definitions and explanations are heavily derived from the fastai docs, I\u2019d encourage to you to check it out.", "Also, this is not meant to be a code heavy writeup, rather a higher level discussion of where to use the code or when to.", "If you want to run the kernel, please follow the link in the sub-title space.", "Data Augmentation is one of the most common regularisation techniques, especially common in image processing tasks.", "When you\u2019re working on a Machine Learning model, your model\u2019s performance is only as good as your data. Depending on what model and problem you\u2019re trying to solve, you\u2019d require a different amount of data.", "However, data collection and cleaning is a resource consuming process and might not be always feasible.", "A Neural Network, or as typically used for Image processing related purposes: Convolutional Neural Networks, learns about \u201cfeatures\u201d inside of your images.", "Our goal with any machine learning project is to ensure that our code or \u201cmodel\u201d is able to generalize to real-world data. However, the opposite of this is \u201coverfitting\u201d where your model just learns to recognize features inside of your training dataset.", "To avoid this, we \u201caugment\u201d or add slight variations while feeding in our images to the model. Even though rotation of 2 degrees might not make a huge difference to the human eye, such little variations are useful enough to allow the model to generalize well.", "To give you an \u201cit just works\u201d example let's try running training a ResNet 50 on the CIFAR-10 dataset with the Image Augmentation ON/OFF.", "With augmentations (default ones) enabled, you can see that the model performs better.", "Next, I\u2019ll do a deep dive of the image augmentations supported by fastai, and giving the possible example use-cases of where this might be useful.", "To apply \u201ctransforms\u201d to your dataset, we pass the list of transforms when creating the \u201cImageDataBunch\u201d objects.", "fastai has a list of default recommended transforms which have been derived from intense experimentation by the team, so for starters, I\u2019d recommend trusting these:", "This returns a tuple of length 2, containing 2 lists: One for the training dataset and the other for validation dataset.", "The default parameters for the get_transforms function (Source: fastai docs) are:", "The default tuple this generates is:", "It\u2019s okay if you don\u2019t understand all of the words indexed there. Let\u2019s do a deep dive and try to explore some of these. The case I make by sharing these is: the defaults are always a good starting point unless you\u2019re working on very different data. For ex: Point mutations or inter-galactic images.", "That is a long list! Let\u2019s try and explore these case by case.", "I\u2019ve (stolen) borrowed some helper code from the docs:", "This will allow us to look at dog pictures. These will be the base case for comparison. So further, I\u2019ll share the transform, what it does to the base dog picture and where you might find it useful in the real world since our doggy picture might not serve as the best example for all the cases as we\u2019ll see.", "(max_rotate=angle) toggles random rotations between -angle to + angle specified here.", "Since no one would click pictures of their doggy in these angles. Let\u2019s consider another case:", "You\u2019re tasked with finding swimming pools in your neighborhood. You download satellite images but since your region is small, your model overfits.", "In this case, image augmentation might be useful:", "At first looks, I could have lied to you about these being different pictures, isn\u2019t it? I believe this would definitely serve as a good purpose to our model.", "Images as we know, have 3 channels (red, green, blue AKA RGB). This transform randomizes one of the channels of the input image.", "This might be useful in a case where your dataset is supposed to help you detect cars but your interns (or Graduate Student Turk \ud83d\ude1b) did a bad job and only collected images of red cars. You can randomize the colors and help the learner generalize better.", "We can vary the brightness from 0 to 1, 0.5 is the default.", "Let\u2019s look at our doggy picture with all variations across the brightness scale. Since the original image was taken pretty perfectly, the augmentation didn\u2019t help here. This is another example of where augmenting your image might ruin your model. So be careful when applying transforms to your data.", "With the warning out of our way. Here\u2019s an example from my work: The task is to extract text from this image. Even to the human eyes, this is easier to do when the difference between the background and text is most pronounced. So for ex: Look at 0.3 value-this is the best result for this case.", "As the name suggests, it allows us to vary the contrast, from a scale of 0 to 2. 1 being the default/original picture.", "Here\u2019s our poor doggy image going through yet another set of augmentation:", "Personally, I\u2019d vote for the most \u201ccontrasted\u201d picture to be the best. Blame it on Instagram filters.", "Let\u2019s pick up the previous challenge again. We are tasked to create a character reader that reads characters from the medicine\u2019s image. This works best when the contrast is maximum.", "Don\u2019t believe me? Take a look:", "Crop helps crop into mentioned sectors of the image.", "You are tasked to build a parking lot billing machine. Since our camera would be fixed at an angle and we can expect mostly sedans to enter in a lot, the number plate would be most probably in a fixed region (Lower middle). Cropping into there will allow our model to focus just on that region, making our and the model\u2019s job easier.", "Crop_pad, crops, and pads based on the set mode. The one recommended by fastai dev(s) is \u201creflection padding\u201d. See the examples below for zero and reflection padding.", "Dihedral transforms rotates the images in the 8 possible directions/angles of a dihedron.", "Lets first look at what a dihedral angle is:", "As you might imagine, it will rotate the image in all such possible orientations. Enough definitions, let's look at our innocent puppy in bad angles:", "Now, I\u2019ll bet if your taking photos of your puppy at such angles, your on Instagram or a bad parent. Either way, it's not a good example.", "Back to our original summer camp mission, we\u2019re spying on the neighborhood using google maps and looking for swimming pools.", "As you can see, in such a case it might make much more sense to rotate the image in these angles. If you didn\u2019t know, these might even look as completely different images in the first glance. Isn\u2019t it?", "Jitter adds random noise to the image. I\u2019m not sure what the best practical best use-case for the same might be, the magnitude can be set from -x to +x with 0 being the original image.", "Behind the scenes, the jitter is random pixel replacement from the neighborhood. Which means, that it might help avoid overfitting (Think its similar to dropout)", "This transform changes the perspective of the image as if our object was moved around.", "For reference, lets again look at our puppy first.", "A use-case where this might be useful is, suppose you\u2019re creating a medicine detector where you want the customer to take pictures of the medicine and your \u201ctech\u201d should be able to detect/read all details. Now the customer might not click the photos in the best angles and you\u2019d hate to teach them the same. Rather, you\u2019d just use this transform.", "Here\u2019s the definition, from the docs:", "Apply the four tilts at the same time, each with a strength given in the vector magnitude.", "Let\u2019s look at our pup for reference.", "Okay, now for a real-world example. Ever heard of Google Lens?Its also known as a content retrieval engine/image search engine in the tech clubs. Now, if you think about it, your use of such services really doesn\u2019t care about the right angles. So it's your job to take care of that.", "For example, if you\u2019re tasked with building a SOTA cereal detector image engine, the transform will really stand out here:", "Tilt allows \u201ctilting\u201d a field to a random direction and a specified magnitude.", "direction is a number (0: left, 1: right, 2: top, 3: bottom). A positive magnitude is a tilt forward (toward the person looking at the picture), a negative magnitude a tilt backward.", "I\u2019ll spare our cute puppy and get back to the important task of building a world-class cereal box detector. You can see the transform is really useful again for this use-case:", "This was a looong list of transforms and examples. If you\u2019re interested in trying these out, I\u2019d encourage you to checkout my starter kernel.", "If you\u2019ve any questions, please shoot me a tweet or leave a comment below.", "If you found this interesting and would like to be a part of My Learning Path, you can find me on Twitter here.", "If you\u2019re interested in reading about Deep Learning and Computer Vision news, you can checkout my newsletter here.", "If you\u2019re interested in reading a few best advice from Machine Learning Heroes: Practitioners, Researchers, and Kagglers. Please click here", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer and AI Content Creator at H2O.ai, Fast.ai Fellow, Kaggle x3 Expert (Ranked in Top 1%), Twitter: https://twitter.com/bhutanisanyam1"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F692dfaa2da42&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@init_27?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@init_27?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": "Sanyam Bhutani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa08b1e531f9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&user=Sanyam+Bhutani&userId=a08b1e531f9c&source=post_page-a08b1e531f9c----692dfaa2da42---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F692dfaa2da42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F692dfaa2da42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tcwillmott?utm_source=medium&utm_medium=referral", "anchor_text": "Thomas Willmott"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/init27/introduction-to-image-augmentation-using-fastai", "anchor_text": "You can also find the executable code of this blog in this kaggle kernel"}, {"url": "http://course-v3.fast.ai", "anchor_text": "website"}, {"url": "https://docs.fast.ai/", "anchor_text": "docs"}, {"url": "https://hackernoon.com/tagged/learning", "anchor_text": "Learning"}, {"url": "https://hackernoon.com/tagged/network", "anchor_text": "Network"}, {"url": "https://www.youtube.com/watch?v=4u0NRgMyzEM", "anchor_text": "\u201cit just works\u201d"}, {"url": "https://www.kaggle.com/init27/introduction-to-image-augmentation-using-fastai", "anchor_text": "With augmentations (default ones) enabled, you can see that the model performs better."}, {"url": "https://docs.fast.ai/vision.image.html#Image", "anchor_text": "Image"}, {"url": "https://docs.fast.ai/vision.image.html#TfmPixel", "anchor_text": "TfmPixel"}, {"url": "https://youtu.be/U9BwWKXjVaI?t=55", "anchor_text": "I\u2019ll bet if your taking photos of your puppy at such angles"}, {"url": "https://docs.fast.ai/vision.transform.html#_symmetric_warp", "anchor_text": "Here\u2019s the definition, from the docs"}, {"url": "https://play.google.com/store/apps/details?id=com.google.ar.lens&hl=en_IN", "anchor_text": "Ever heard of Google Lens?"}, {"url": "https://hackernoon.com/launching-my-company-a-scholarship-and-a-webinar-277e3b66e351", "anchor_text": "My Learning Path"}, {"url": "http://twitter.com/bhutanisanyam1", "anchor_text": "here"}, {"url": "http://tinyletter.com/sanyambhutani/", "anchor_text": "newsletter here"}, {"url": "https://hackernoon.com/interviews-with-machine-learning-heroes-504762ba5dd6", "anchor_text": "Please click here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----692dfaa2da42---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----692dfaa2da42---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----692dfaa2da42---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----692dfaa2da42---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/data-science?source=post_page-----692dfaa2da42---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F692dfaa2da42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&user=Sanyam+Bhutani&userId=a08b1e531f9c&source=-----692dfaa2da42---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F692dfaa2da42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&user=Sanyam+Bhutani&userId=a08b1e531f9c&source=-----692dfaa2da42---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F692dfaa2da42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F692dfaa2da42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----692dfaa2da42---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----692dfaa2da42--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----692dfaa2da42--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----692dfaa2da42--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----692dfaa2da42--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@init_27?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@init_27?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sanyam Bhutani"}, {"url": "https://medium.com/@init_27/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.1K Followers"}, {"url": "http://H2O.ai", "anchor_text": "H2O.ai"}, {"url": "http://Fast.ai", "anchor_text": "Fast.ai"}, {"url": "https://twitter.com/bhutanisanyam1", "anchor_text": "https://twitter.com/bhutanisanyam1"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa08b1e531f9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&user=Sanyam+Bhutani&userId=a08b1e531f9c&source=post_page-a08b1e531f9c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbc6801994d1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-image-augmentations-using-the-fastai-library-692dfaa2da42&newsletterV3=a08b1e531f9c&newsletterV3Id=bc6801994d1c&user=Sanyam+Bhutani&userId=a08b1e531f9c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}