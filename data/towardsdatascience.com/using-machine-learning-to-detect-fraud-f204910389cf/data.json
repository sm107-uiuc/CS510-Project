{"url": "https://towardsdatascience.com/using-machine-learning-to-detect-fraud-f204910389cf", "time": 1683014168.065141, "path": "towardsdatascience.com/using-machine-learning-to-detect-fraud-f204910389cf/", "webpage": {"metadata": {"title": "Using Machine Learning To Detect Fraud | by Kurtis Pykes | Towards Data Science", "h1": "Using Machine Learning To Detect Fraud", "description": "Machine Learning is a subset of Artificial Intelligence (AI) that provides systems with the ability to automatically learn and improve from experience without being explicitly programmed. In saying\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.crowe.com/uk/croweuk/insights/financial-cost-of-fraud-2019#:~:text=The%20latest%20data%20from%20around%20the%20world&text=It%20reveals%20that%20fraud%20is,56%25%20in%20the%20past%20decade.", "anchor_text": "Crowe UK", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/oversampling-and-undersampling-5e2bbaf56dcf", "anchor_text": "Oversampling and Undersampling", "paragraph_index": 6}, {"url": "https://towardsdatascience.com/structuring-machine-learning-projects-be473775a1b6", "anchor_text": "Structuring Machine Learning Projects", "paragraph_index": 6}, {"url": "https://cis.ieee.org/", "anchor_text": "IEEE Computational Intelligence Society", "paragraph_index": 7}, {"url": "https://www.kaggle.com/c/ieee-fraud-detection/data", "anchor_text": "Kaggle Data", "paragraph_index": 8}, {"url": "https://www.kaggle.com/c/ieee-fraud-detection/discussion/101203", "anchor_text": "this post by the competition host", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/cross-validation-c4fae714f1c5", "anchor_text": "Cross Validation", "paragraph_index": 12}, {"url": "https://github.com/abhishekkrthakur/mlframework", "anchor_text": "Github", "paragraph_index": 13}, {"url": "https://towardsdatascience.com/algorithms-from-scratch-logistic-regression-7bacdfd9738e", "anchor_text": "Logistic Regression", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/random-forest-overview-746e7983316", "anchor_text": "Random Forest", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/comprehension-of-the-auc-roc-curve-e876191280f9", "anchor_text": "ROC_AUC", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/data-scientist-should-know-software-engineering-best-practices-f964ec44cada", "anchor_text": "Software Engineering Best Practices", "paragraph_index": 30}], "all_paragraphs": ["Machine Learning is a subset of Artificial Intelligence (AI) that provides systems with the ability to automatically learn and improve from experience without being explicitly programmed. In saying that, it has been made possible for us (humans) to supply a large set of data to a computer for the computer to learn patterns so that it may learn how to make a decision when faced with a new instance or instances \u2014 When I discovered this insight I instantly knew the world is about to change.", "It reveals that fraud is costing the global economy \u00a33.89 trillion, with losses rising by 56% in the past decade. \u2014 Crowe UK", "Having been a victim of fraud, coming up with ideas to prevent it from ever happening to me (and anyone else for that matter) again essentially contributed to me wondering into a totally different field from what I was accustomed to.", "In Machine Learning terminology, problems such as the Fraud Detection problem may be framed as a classification problem, of which the goal is to predict the discrete label 0 or 1 where 0 generally suggest that a transaction is non-fraudulent and 1 suggest that the transaction seems to be fraudulent.", "Hence, this problem requires practitioners to build models that are intelligent enough to be capable of accurately detecting fraudulent and non-fraudulent transactions given various users transaction data \u2014 which is often anonymous to protect users privacy.", "Since depending exclusively on rule-based systems is not the most effective strategy, Machine learning has been the approach many financial institutes are taking to combat the problem.", "What makes this problem (fraud detection) so challenging is that when we model it in the real world, the majority of transactions that occur are genuine transactions and only a very small portion account for fraudulent behavior. This means we deal with the problem of imbalanced data \u2014 My post on Oversampling and Undersampling is one approach to dealing with this problem. However, for this post our main focus will be on beginning our machine learning framework to detect fraud \u2014 If you are unfamiliar with building your own framework you may want to read through Structuring Machine Learning Projects before completing this post.", "The data was put together by researchers from IEEE Computational Intelligence Society (IEEE-CIS) for the task of predicting the probability that an online transaction is fraudulent, as denoted by the binary target isFraud.", "Note: The data section is copied from Kaggle Data section for this competition.", "The data is broken into two files identity and transaction, which are joined by TransactionID. Not all transactions have corresponding identity information.", "The TransactionDT feature is a timedelta from a given reference datetime (not an actual timestamp).", "You can read more about the data from this post by the competition host.", "The first step of when working on any machine learning task is to build a reliable Cross Validation strategy.", "Note: The general idea behind the framework was taken from no other than Abhishek Thakur \u2014 Github", "A general approach to take when facing a imbalanced data problem is to use StratifiedKFold which splits the data randomly in such a way that we maintain the same class distribution.", "I implemented out create folds as part of preprocessing.py.", "This code merges the identity and transaction data from the train and test set then renames the columns names in the merged_test data since the id columns use \u201c-\u201d instead of \u201c_\u201d \u2014 which will cause problems later when we check to ensure we have the exact same column names in our test. Next, we add a column name called kfold to our training data and set the index in accordance with the fold it is in then save to a csv file.", "You may of noticed that we import config and use it as a path to various things. All config is, is variables in another script so that we don\u2019t have to repeatedly call those variables in different scripts.", "It is very important to build your pipeline fast and in a manner that allows for fast iterations when working on a machine learning problem, so the next script we will build is our model_dispatcher.py of which we call our classifiers and train.py where we train our model.", "Here, we have simply imported a Logistic Regression and Random Forest that and created a dictionary so we can call the algorithms into our train script by doing models[\"logistic_regression\"] which will run the Logistic Regression model.", "The train script is as follows\u2026", "Hopefully you can read code but if you can not, to sum up what is going on, we set training data as the values in the column kfold that and the values that are equal to the fold we passed is the test set. Then we do Label encoding to the categorical variables, and fill all missing values with 0 before training our data on a logistic regression model.", "We get predictions on the current fold and print the ROC_AUC.", "Note: As things stand, the code is does not run itself, so we\u2019d have to pass the values for fold and model when we run each fold.", "Let\u2019s see the outputs of our Logistic Regression Model.", "Those are pretty decent results to start with, but let\u2019s use the more powerful random forest model and see if we can improve.", "It\u2019s pretty clear the random forest model is yielding much better results. Let\u2019s do a late submission on to Kaggle and see where we rank on the leaderboards. This is of the most important parts \u2014 To do this we must run inference.py.", "Note: The process of submitting to Kaggle is beyond the scope of this discussion so I will the score model gets and how that does on the Leaderboard.", "Given this score translated to Kaggle\u2019s private leaderboard (since it is the score on the public leaderboard), we would of ranked 3875/6351 (Top 61%) on Kaggle\u2019s private leaderboard. Although, It doesn\u2019t look so good from a Kaggle perspective, in a real world scenario we\u2019d probably settle with this score depending on the task.", "However, the goal of this project is not to come up with the best model, it is to create our own API which we will come back to in later post.", "For building a quick pipeline for fast iteration, the code we have is okay but if we want to deploy this model we\u2019d have to do plenty of clean up work so that we follow the Software Engineering Best Practices.", "Detecting Fraud is a very common and challenging problem in the real world and increasing the accuracy is very important to prevent the embarrassment of customers cards being declined when making a genuine transaction at a store. We\u2019ve have built a very simple approach using label encoding for categorical variables, filling all missing values with 0, and a random forest without any tuning or methods to handle the imbalance in data but our model still scores pretty highly. To improve the model, we may want to first look at the important features from the Random Forest model and drop less important features, or we can use other more powerful models like Light Gradient Boosting Machine and Neural Networks", "Note: At the time of writing this script, the modules aren\u2019t the best but it is in a format that would allow me to quickly iterate. In future work, I plan on deploying this model as an API on a cloud server.", "Let\u2019s continue the conversation on LinkedIn\u2026", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff204910389cf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f204910389cf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f204910389cf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kurtispykes.medium.com/?source=post_page-----f204910389cf--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=post_page-----f204910389cf--------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877----f204910389cf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff204910389cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff204910389cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@maxwbender?utm_source=medium&utm_medium=referral", "anchor_text": "Max Bender"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.crowe.com/uk/croweuk/insights/financial-cost-of-fraud-2019#:~:text=The%20latest%20data%20from%20around%20the%20world&text=It%20reveals%20that%20fraud%20is,56%25%20in%20the%20past%20decade.", "anchor_text": "Crowe UK"}, {"url": "https://towardsdatascience.com/oversampling-and-undersampling-5e2bbaf56dcf", "anchor_text": "Oversampling and Undersampling"}, {"url": "https://towardsdatascience.com/structuring-machine-learning-projects-be473775a1b6", "anchor_text": "Structuring Machine Learning Projects"}, {"url": "https://towardsdatascience.com/oversampling-and-undersampling-5e2bbaf56dcf", "anchor_text": "Oversampling and UndersamplingA technique for Imbalanced Classificationtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/structuring-machine-learning-projects-be473775a1b6", "anchor_text": "Structuring Machine Learning projectsA template guide for structuring ML projectstowardsdatascience.com"}, {"url": "https://cis.ieee.org/", "anchor_text": "IEEE Computational Intelligence Society"}, {"url": "https://www.kaggle.com/c/ieee-fraud-detection/data", "anchor_text": "Kaggle Data"}, {"url": "https://www.kaggle.com/c/ieee-fraud-detection/discussion/101203", "anchor_text": "this post by the competition host"}, {"url": "https://towardsdatascience.com/cross-validation-c4fae714f1c5", "anchor_text": "Cross Validation"}, {"url": "https://towardsdatascience.com/cross-validation-c4fae714f1c5", "anchor_text": "Cross-ValidationValidating your Machine Learning Models Performancetowardsdatascience.com"}, {"url": "https://github.com/abhishekkrthakur/mlframework", "anchor_text": "Github"}, {"url": "https://towardsdatascience.com/algorithms-from-scratch-logistic-regression-7bacdfd9738e", "anchor_text": "Logistic Regression"}, {"url": "https://towardsdatascience.com/random-forest-overview-746e7983316", "anchor_text": "Random Forest"}, {"url": "https://towardsdatascience.com/comprehension-of-the-auc-roc-curve-e876191280f9", "anchor_text": "ROC_AUC"}, {"url": "https://towardsdatascience.com/comprehension-of-the-auc-roc-curve-e876191280f9", "anchor_text": "Comprehension of the AUC-ROC curveA deeper look into AUC-ROC\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/data-scientist-should-know-software-engineering-best-practices-f964ec44cada", "anchor_text": "Software Engineering Best Practices"}, {"url": "https://towardsdatascience.com/data-scientist-should-know-software-engineering-best-practices-f964ec44cada", "anchor_text": "Data Scientists Should Know Software Engineering Best PracticesBecoming an indispensable Data Scientisttowardsdatascience.com"}, {"url": "https://www.linkedin.com/in/kurtispykes/", "anchor_text": "Kurtis Pykes - AI Writer - Towards Data Science | LinkedInView Kurtis Pykes' profile on LinkedIn, the world's largest professional community. Kurtis has 2 jobs listed on their\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f204910389cf---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f204910389cf---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f204910389cf---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f204910389cf---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----f204910389cf---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff204910389cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&user=Kurtis+Pykes&userId=5ba760786877&source=-----f204910389cf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff204910389cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&user=Kurtis+Pykes&userId=5ba760786877&source=-----f204910389cf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff204910389cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f204910389cf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff204910389cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f204910389cf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f204910389cf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f204910389cf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f204910389cf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f204910389cf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f204910389cf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f204910389cf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f204910389cf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f204910389cf--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://kurtispykes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://www.fullstackfreelancershub.com/wisdom-wednesday", "anchor_text": "https://www.fullstackfreelancershub.com/wisdom-wednesday"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffde3d752d24c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-machine-learning-to-detect-fraud-f204910389cf&newsletterV3=5ba760786877&newsletterV3Id=fde3d752d24c&user=Kurtis+Pykes&userId=5ba760786877&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}