{"url": "https://towardsdatascience.com/linear-regression-model-with-python-481c89f0f05b", "time": 1683016820.549401, "path": "towardsdatascience.com/linear-regression-model-with-python-481c89f0f05b/", "webpage": {"metadata": {"title": "Linear Regression Model with Python | by Idil Ismiguzel | Towards Data Science", "h1": "Linear Regression Model with Python", "description": "Regression models are widely used machine learning tools allowing us to make predictions from data by learning the relationship between features and continuous-valued outcomes. Checking model\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/Idilismiguzel/Machine-Learning/blob/master/Regression/Linear-Regression-Model.ipynb", "anchor_text": "Jupyter Notebook", "paragraph_index": 2}, {"url": "https://www.investopedia.com/terms/e/errorterm.asp#:~:text=An%20error%20term%20represents%20the,and%20the%20actual%20observed%20results.", "anchor_text": "error term", "paragraph_index": 5}, {"url": "https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "Boston housing dataset", "paragraph_index": 8}, {"url": "https://www.statsmodels.org/stable/index.html", "anchor_text": "Statsmodels", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/supervised_learning.html#supervised-learning", "anchor_text": "Scikit-learn", "paragraph_index": 10}, {"url": "https://www.datarobot.com/wiki/overfitting/", "anchor_text": "overfitting", "paragraph_index": 11}, {"url": "https://www.datarobot.com/wiki/underfitting/", "anchor_text": "underfitting", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "root mean squared error", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Coefficient_of_determination", "anchor_text": "R-squared", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic", "anchor_text": "Durbin-Watson test", "paragraph_index": 31}, {"url": "https://www.investopedia.com/terms/v/variance-inflation-factor.asp", "anchor_text": "variance inflation factor", "paragraph_index": 34}, {"url": "https://www.investopedia.com/terms/v/variance-inflation-factor.asp", "anchor_text": "VIF", "paragraph_index": 37}, {"url": "https://www.statsmodels.org/stable/examples/notebooks/generated/regression_plots.html", "anchor_text": "Influence plots", "paragraph_index": 42}, {"url": "https://medium.com/@idilismiguzel", "anchor_text": "read my other articles here", "paragraph_index": 47}, {"url": "http://medium.com/@idilismiguzel/follow", "anchor_text": "follow me on Medium.", "paragraph_index": 47}, {"url": "https://idilismiguzel.medium.com/membership", "anchor_text": "Become a member for more!", "paragraph_index": 48}, {"url": "https://de.linkedin.com/in/idilismiguzel", "anchor_text": "https://de.linkedin.com/in/idilismiguzel", "paragraph_index": 50}], "all_paragraphs": ["Regression models are widely used machine learning tools allowing us to make predictions from data by learning the relationship between features and continuous-valued outcomes. Checking model assumptions and understanding whether they are satisfied or not is as important as checking the accuracy and goodness of the model.", "In this article you will learn:", "While following the article, I encourage you to check out the Jupyter Notebook on my GitHub for the full analysis and code.", "Regression analysis is used to model the relationship between a single dependent variable Y (aka response, target, or outcome) and one or more independent variables X (aka predictor or feature).", "When we have one predictor it is \u201csimple\u201d linear regression and when we have more than one predictors it is \u201cmultiple\u201d linear regression.", "In general, data does not fall exactly on a linear line, so the regression equation should include an error term(\u03f5).", "The fitted (predicted) values typically denoted by Y-hat, and \u03b2-hat coefficients are chosen by the model as they minimize the squared distance (aka residuals) between the actual Y value and the best fit (Y-hat) minimizing the following expression:", "The method of minimizing the sum of the squared residuals is called Ordinary Least Squares (OLS) regression.", "We will be building the multiple linear regression model on the Boston housing dataset from the late 1970s. Data consists of a total of 506 cases with 14 attributes. Let\u2019s have a look at it!", "We will be predicting house prices (\u201cMEDV\u201d) by using all the other variables.", "We will use the Statsmodels library for linear regression. (Scikit-learn can also be used as an alternative but here I preferred statsmodels to reach a more detailed analysis of the regression model). Having said that, we will still be using Scikit-learn for train-test split. Details below!", "We will split our dataset into train and test sets (80% for training, and 20% for testing). The regression model will learn from training data where the output is known, and later we will generalize the model on the test set. We will predict the test set\u2019s y values output and comparing these predictions with the actual values. This is done to detect overfitting or underfitting problems.", "We will use model.predict on the test_X and compare the predictions with the actual test_y values.", "One of the most important metrics is root mean squared error; the square root of the average squared error in the predicted y values (y-hat). It measures the overall accuracy of the model.", "Another important metric is R-squared ranging from 0 to 1; measures the proportion of variation in the data that is accounted in the regression model. It tells how well the model fits the data and R-squared=1 indicates that the regression predictions perfectly fit the data.", "Let\u2019s find RMSE and R-squared for the predictions.", "As we see our model performance dropped from 0.75 (on training data) to 0.66 (on test data), and we are expecting to be 4.92 far off on our next predictions using this model.", "Before we built a linear regression model, we make the following assumptions:", "Before being confused about the model performance, it is crucial to check whether the assumptions are strongly satisfied or not. It could be difficult to fulfill all the assumptions perfectly with the real-world data, however, it is crucial to understand how far our model being interpreted correctly.", "We assumed that there is a linear relationship between the predictors and the outcome, but this may not be correct. When we do modeling, we are trying to fit our data to a function that explains our data, but linear regression might not be the fitting estimator in this case.", "We will test linearity with a scatter plot to see predicted values versus the actual values. Ideally, the data points should lie around the diagonal line on the plot.", "In the Boston dataset, we can see that there is not a perfect relationship. On the lower and higher-end values, our predictions are biased.", "We assumed that the error terms (residuals) of the model are normally distributed. This assumption might be violated due to the linearity assumption not been hold or due to outliers in the dataset.", "We will test normality by checking with the quantile-quantile plot, Q-Q plot.", "The ideal match on the left shows data distribution follows the red line from the bottom left to the top right. In Boston dataset, we can see that our model biasing towards under-estimating.", "You can go further and plot a histogram of residuals or perform normality tests such as Anderson-Darling or Shapiro-Wilk Test.", "We assumed that the variance of error terms (residuals) is constant for all values of X. However, heteroscedasticity, the violation of homoscedasticity happens when we do not have the same variance across the error terms.", "This violation can happen when the model gives different weights to the subsets of the data.", "We will test homoscedasticity by plotting the residuals and checking if the variance is uniform.", "The ideal plot on the left shows a uniform distribution of the residuals however, we can\u2019t say the same for Boston Dataset. We need to be careful about heteroscedasticity, which indicates that the prediction errors are different for a different range of predicted values meaning that our model could be incomplete.", "Autocorrelation occurs when the residuals are not independent of each other, in other words, when the value of y_t is not independent of y_t-1. This is generally the case for time series data such as stock prices. To learn more on this you can check my article about time series forecasting.", "We will perform the Durbin-Watson test to determine if the no autocorrelation assumption holds.", "The Durbin-Watson statistic ranges between 0 and 4. A value of 2.0 means that there is no autocorrelation. Values between 0 and 2 indicate positive and values between 2 and 4 indicate negative autocorrelation. In our case, Durbin-Watson statistic is very close to 2.0 therefore we can say that no autocorrelation assumption is not violated.", "We assumed that the predictor variables in the regression are not correlated with each other. Having this assumption violated does not make our model unusable but it is still important to understand and get rid of some unnecessary predictors if they are highly correlated with others.", "We will plot a heatmap to see the correlation between predictors visually and we will also calculate the variance inflation factor (VIF), which measures the multicollinearity among the independent variables.", "As we can see between some variables we have a high (negative/positive) correlation in Boston Dataset.", "Variance inflation factor for CRIM: 1.79Variance inflation factor for ZN: 2.3Variance inflation factor for INDUS: 3.99Variance inflation factor for CHAS: 1.07Variance inflation factor for NOX: 4.39Variance inflation factor for RM: 1.93Variance inflation factor for AGE: 3.1Variance inflation factor for DIS: 3.96Variance inflation factor for RAD: 7.48Variance inflation factor for TAX: 9.01Variance inflation factor for PTRATIO: 1.8Variance inflation factor for B: 1.35Variance inflation factor for LSTAT: 2.94", "A VIF of 1 indicates two variables are not correlated, a VIF between 1 and 5 indicates a moderate correlation, and a VIF above 5 indicates a high correlation.", "As result shows we have 2 high correlated and 5 moderately correlated variables. It is better if we get rid of some of them.", "Outlier detection using Cook\u2019s distance plot", "Cook\u2019s distance determines the effect of deletion of a given observation from the dataset. We can leverage Cook\u2019s distance while examining if an observation is a potential outlier or an influential variable. Here is how to plot Cook\u2019s distance.", "From Cook\u2019s plot, we can understand which are the observations we need to pay more attention to and decide whether to drop them or not. (As a rule, the observation has a high influence if the Cook\u2019s distance is greater than 4/N-k-1 ( N=number of observations, k= number of predictors, yellow horizontal line in the plot)", "Influence plots show the studentized residuals versus the leverage of each observation as measured by the hat matrix.", "In contrast to the ideal plot, in Boston Dataset we can see that some data points have low leverage but large residuals. These highly influential data points need a delicate evaluation before including in the model.", "In this analysis, we found out that some of the assumptions we made before building a linear regression model have been violated and caused significant problems in the model performance and outcome predictions. Even though meeting with the assumptions with real-world data sounds a bit superficial, we still need to check and know the flaws of our model and if a possible fix or improve them, before making important decisions based on the outputs.", "If you have outcomes like here we have with the Boston dataset, I would suggest you to try modeling with Random Forest Regressor or XGBoost to understand if you can improve model performance. You can enrich with principal component analysis-PCA for feature extraction to drop the least important predictors while still keeping the most valuable parts of all the variables. Moreover, you can also perform K-fold Cross Validation(CV) by dividing entire dataset into k folds and being sure that each fold is used as a testing set.", "I hope you enjoyed reading the article and find it useful for your analyses!", "If you liked this article, you can read my other articles here and follow me on Medium. Let me know if you have any questions or suggestions.\u2728", "Enjoy this article? Become a member for more!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist @ Kolibri Games | Writing on Data Science & Machine Learning | Top 2000 Writer on Medium | MSc, MBA | https://de.linkedin.com/in/idilismiguzel"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F481c89f0f05b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@idil", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://idilismiguzel.medium.com/?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": ""}, {"url": "https://idilismiguzel.medium.com/?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": "Idil Ismiguzel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6d965c736f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&user=Idil+Ismiguzel&userId=6d965c736f2&source=post_page-6d965c736f2----481c89f0f05b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F481c89f0f05b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F481c89f0f05b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://www.pexels.com/photo/scenic-view-of-snow-capped-mountains-during-night-3408744/", "anchor_text": "Source"}, {"url": "https://github.com/Idilismiguzel/Machine-Learning/blob/master/Regression/Linear-Regression-Model.ipynb", "anchor_text": "Jupyter Notebook"}, {"url": "https://github.com/Idilismiguzel/Machine-Learning/blob/master/Regression/Linear-Regression-Model.ipynb", "anchor_text": "Idilismiguzel/Machine-LearningPermalink GitHub is home to over 50 million developers working together to host and review code, manage projects, and\u2026github.com"}, {"url": "https://www.investopedia.com/terms/e/errorterm.asp#:~:text=An%20error%20term%20represents%20the,and%20the%20actual%20observed%20results.", "anchor_text": "error term"}, {"url": "https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "Boston housing dataset"}, {"url": "https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "dataset"}, {"url": "https://www.statsmodels.org/stable/index.html", "anchor_text": "Statsmodels"}, {"url": "https://scikit-learn.org/stable/supervised_learning.html#supervised-learning", "anchor_text": "Scikit-learn"}, {"url": "https://www.datarobot.com/wiki/overfitting/", "anchor_text": "overfitting"}, {"url": "https://www.datarobot.com/wiki/underfitting/", "anchor_text": "underfitting"}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "root mean squared error"}, {"url": "https://en.wikipedia.org/wiki/Coefficient_of_determination", "anchor_text": "R-squared"}, {"url": "https://towardsdatascience.com/hands-on-time-series-forecasting-with-python-d4cdcabf8aac", "anchor_text": "Hands-on Time Series Forecasting with PythonBox-Jenkins modeling strategy for building SARIMA modeltowardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic", "anchor_text": "Durbin-Watson test"}, {"url": "https://www.investopedia.com/terms/v/variance-inflation-factor.asp", "anchor_text": "variance inflation factor"}, {"url": "https://www.investopedia.com/terms/v/variance-inflation-factor.asp", "anchor_text": "VIF"}, {"url": "https://www.statsmodels.org/stable/examples/notebooks/generated/regression_plots.html", "anchor_text": "Influence plots"}, {"url": "https://medium.com/@idilismiguzel", "anchor_text": "read my other articles here"}, {"url": "http://medium.com/@idilismiguzel/follow", "anchor_text": "follow me on Medium."}, {"url": "https://idilismiguzel.medium.com/membership", "anchor_text": "Become a member for more!"}, {"url": "https://medium.com/tag/data-science?source=post_page-----481c89f0f05b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----481c89f0f05b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----481c89f0f05b---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----481c89f0f05b---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----481c89f0f05b---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F481c89f0f05b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&user=Idil+Ismiguzel&userId=6d965c736f2&source=-----481c89f0f05b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F481c89f0f05b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&user=Idil+Ismiguzel&userId=6d965c736f2&source=-----481c89f0f05b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F481c89f0f05b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F481c89f0f05b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----481c89f0f05b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----481c89f0f05b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----481c89f0f05b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----481c89f0f05b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----481c89f0f05b--------------------------------", "anchor_text": ""}, {"url": "https://idilismiguzel.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://idilismiguzel.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Idil Ismiguzel"}, {"url": "https://idilismiguzel.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "890 Followers"}, {"url": "https://de.linkedin.com/in/idilismiguzel", "anchor_text": "https://de.linkedin.com/in/idilismiguzel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6d965c736f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&user=Idil+Ismiguzel&userId=6d965c736f2&source=post_page-6d965c736f2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F515eb8e2184b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-python-481c89f0f05b&newsletterV3=6d965c736f2&newsletterV3Id=515eb8e2184b&user=Idil+Ismiguzel&userId=6d965c736f2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}