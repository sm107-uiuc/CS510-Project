{"url": "https://towardsdatascience.com/what-makes-a-wine-good-ea370601a8e4", "time": 1683015539.5802538, "path": "towardsdatascience.com/what-makes-a-wine-good-ea370601a8e4/", "webpage": {"metadata": {"title": "What Makes Great Wine\u2026 Great?. Using Machine Learning and Partial\u2026 | by Travis Tang | Towards Data Science", "h1": "What Makes Great Wine\u2026 Great?", "description": "I don\u2019t know about you, but I\u2019m sure in the mood for some wine right now. But not just any wine \u2014 but good wine. Wine that tastes balanced, complex and long. It\u2019s hard to say what each of those\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/wine+quality", "anchor_text": "Wine Quality Data Set from UCI", "paragraph_index": 4}, {"url": "https://winefolly.com/deep-dive/what-is-residual-sugar-in-wine/", "anchor_text": "The amount of sugar left after yeast ferments the wine is called residual sugar.", "paragraph_index": 6}, {"url": "http://www.oiv.org/public/medias/2604/oiv-ma-d1-03.pdf", "anchor_text": "different geographic, geologic and climatic conditions", "paragraph_index": 8}, {"url": "https://archive.ics.uci.edu/ml/datasets/wine+quality", "anchor_text": "UCI site", "paragraph_index": 25}, {"url": "https://github.com/SauceCat/PDPbox", "anchor_text": "PDPBox package", "paragraph_index": 32}, {"url": "https://towardsdatascience.com/interpreting-black-box-ml-models-using-lime-4fa439be9885", "anchor_text": "LIME to explain black box model\u2019s predictions on breast cancer data", "paragraph_index": 45}, {"url": "http://www3.dsi.uminho.pt/pcortez", "anchor_text": "http://www3.dsi.uminho.pt/pcortez", "paragraph_index": 46}, {"url": "http://linkedin.com/in/travistang", "anchor_text": "linkedin.com/in/travistang", "paragraph_index": 48}], "all_paragraphs": ["I don\u2019t know about you, but I\u2019m sure in the mood for some wine right now. But not just any wine \u2014 but good wine. Wine that tastes balanced, complex and long. It\u2019s hard to say what each of those actually means, and these guys from Buzzfeed sure have a hard time describing good wine in words.", "Sure, the concepts of the wine\u2019s complexity and depth are elusive. But what if we can characterize what makes wine so enjoyable exactly \u2014 with numbers?", "In this blog post, I will", "So I did a little bit of research and saw the world of wine tasting from the eye of a chemist.", "To understand what makes a wine good, I used the Wine Quality Data Set from UCI [1]. The data set is related to contains the chemical properties and the taste test results of 1599 wine samples. The wine in this study is the red and white variants of the Portugese Vinho Verde wine, though I will only use the data of the red variant in this post.", "Wine is made up of the following components, among others.", "3. Residual Sugar. During fermentation, yeast consumes sugar to produce alcohol. The amount of sugar left after yeast ferments the wine is called residual sugar. Unsurprisingly, the higher the residual sugar, the sweeter the wine tastes. On the other end of the spectrum, a wine that does not taste sweet is considered as dry.", "4. Sulfur compounds. Sulfur dioxide is a common compound used in wine-making. It prevents the wine from oxidation and infiltration by bad bacteria, making it an amazing preservative for wine. These sulfur compounds can be further divided into the following:", "5. chlorides. The amount of chloride salts present in the wine. This varies among wine produced from different geographic, geologic and climatic conditions. For instance, wines that are produced in vineyards near the sea have higher chlorides than those produced far away from the sea.", "With such an understanding of what makes wine desirable, we can build a machine learning model to predict wine is of high quality and low quality based on their chemical properties. The result of the machine learning model can be explained using the partial dependence plot, which \u2018isolates\u2019 individual features among all features in the machine learning model, and tells us how the individual features affect the wine quality prediction.", "More formally, a partial dependence plot visualizes the marginal effect of a feature on the predicted outcomes of the machine learning model [2].", "This might seem a little daunting to understand. Let\u2019s break it down visually.", "Imagine we have a trained machine learning model that takes in some features (alcohol %, sulphate content, pH and density) and outputs a prediction on the wine quality, as shown below.", "Let\u2019s suppose we have the following data point in tabular format.", "We feed this into the trained machine learning model. Voila, the model predicts that the wine quality score is 5 based on these features.", "Now, we add the number of data points, such that we have not 1 but 5 data points.", "Let\u2019s say we are interested in how the alcohol content affects the model\u2019s prediction on the wine\u2019s quality.To marginalize the model over the distribution over the feature \u2018alcohol content\u2019, we calculate the mean of all the other features (i.e. sulphate content, pH and density) as seen in the last row of the table below.", "We then feed the alcohol content of each wine, together with the averaged values of sulphate content, pH and density, into the machine learning model, as such.", "Using this logic, we make the following tabular representation of the partial dependence plot.", "We can then plot a graph using of model-predicted wine quality against alcohol-content of the wine. This is called the partial dependence plot.", "The following is a more rigorous definition of the partial dependence plot which can be skipped with no loss in continuity.", "We first assume that the machine learning model is a function f that takes in all the features x and output a prediction, f(xs). We are interested in the finding the effect of one of the input feature xs on prediction, and we are not interested in the effect of all the other input features xc on prediction. In other words, we want to isolate the input feature xs. To do so, we marginalize the machine learning model over the distribution of the features xc, which is seen as P(xc). After such marginalization, we obtain the partial dependence function of the machine learning model on the particular feature xs.", "In statistics, we can approximate the integral over the distribution of xc with a sum over all the values of xc by the law of large number. Here, n is the number of data in the data set, while xc is the actual values from the data set of the features that we are not interested in.", "Let\u2019s apply this formula in our data set. To obtain the partial dependence plot for the feature alcohol on the prediction outcome quality, we use the following equation.", "Note that there is a superscript i over other features (e.g. pH, density, sulphate) but no such superscript i over alcohol. This is because we are summing over other features to obtain the mean value of other features. The mean value of each of these features, together with the ith value of the alcohol, is fed into the machine learning model to produce a prediction, as seen in the example below.", "Now that we understand what is the partial dependence plot, let\u2019s apply it to our data set. First, we download the data the UCI site.", "The data set does not contain any missing data, and is assumed to be clean enough to be used as-is. Thus, we can start with some data exploration:", "3. We see some variables like sulphates , alcohol and citric acid contents seem to be correlated to quality.", "4. We also observe that some variables seem to have a weak correlation with quality, like chlorides and residual sugars content.", "Let\u2019s quickly build a machine learning model that predicts the quality score of the wine based on all the chemical properties of the wine.", "Here, we split the data into train and test data set using a train-test split ratio of 25\u201375.", "We then feed the training data into a Random Forest Regressor. Here, no hyperparameter tuning is done since this is not a focus of this post.", "Now, let\u2019s find out how we can do that using in python! Luckily for us, there is an elegant package \u2014 PDPBox package \u2014 that allows us to easily plot a partial dependence plot, which visualizes the impact of certain features towards model prediction for all SKlearn supervised learning algorithm. Amazing!", "Let\u2019s first install the pdpbox package.", "Next, we plot the partial dependence plots of each variable on the quality score.", "Let\u2019s first understand how to read this graph. The vertical axis is the contribution of to the prediction of the target variable by the feature, while the horizontal axis is the range of the feature in the data set. For instance, we see that a fixed acidity (first graph above) of around 7.8 will contribute about 0.75 to the predicted wine quality score.", "Wine tasters seem to enjoy wine with lower pH (higher acidity) better. In particular, they seem to love citric acid in their wines. This is not surprising, since a good wine should be acidic (i.e. not flat). However, they\u2019re not a fan of volatile acids (volatile acids makes wine tastes like vinegar!)", "One of the main draws of wine is that it helps people relax \u2014 and that\u2019s alcohol doing its job. Wine tasters seem to like a higher alcohol content in their wines.", "Generally, the amount of chlorides and residual sugar doesn\u2019t seem to affect the prediction on the wine quality much. We observe that both graphs have clustered points at small magnitudes of the feature and an outlier at a higher magnitude of the feature. Ignoring the outlier, we see that a change in the feature amount does not seem to change the quality prediction much, i.e. the gradient of the points is relatively small. Thus, a change in the feature does not result in a change in the wine quality prediction.", "I am also interested in the combined effect of sulfur dioxide and pH Level on the predicted quality.", "To investigate that, let\u2019s first split the pH level into 4 bins with equal number of data points. This step is not completely necessary, though it makes the visualization easier in the partial dependence plot.", "Then, we can plot the partial dependence plot of two variables too on the prediction as a contour plot.", "The color of the contour plot shows the predicted quality as we vary pH Level (a categorical variable) on the y-axis and the total sulfur dioxide content (a numerical variable).", "The blue region indicates low predicted quality while the yellow indicates high predicted quality. This tells us that the wine lower pH and the lower sulfur dioxide content, the higher the quality of the wine (this corresponds to the bottom left corner of the chart). On the other hand, beyond a certain threshold of sulfur dioxide content (~66), we see that pH no longer has an impact on the predicted quality score, as there are only vertical lines on the contour plot on the right side of the graph.", "Congratulations for making it so far into the post. Now that you\u2019re a connoisseur in wine tasting, it\u2019s time to put your knowledge to use. Get a drink and see if you can apply the knowledge you learnt from Partial Dependence Plot to good use. (Subtle hint: I\u2019m up for a drink anytime \u2014 just hit me up on LinkedIn!)", "PS/ If you\u2019re interested in model interpretability, be sure to check out my other post on using LIME to explain black box model\u2019s predictions on breast cancer data.", "[1] Paulo Cortez, University of Minho, Guimar\u00e3es, Portugal, http://www3.dsi.uminho.pt/pcortez A. Cerdeira, F. Almeida, T. Matos and J. Reis, Viticulture Commission of the Vinho Verde Region(CVRVV), Porto, Portugal [2] Friedman, Jerome H. \u201cGreedy function approximation: A gradient boosting machine.\u201d Annals of statistics (2001): 1189\u20131232.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Self-taught data scientist | 20k+ followers on LinkedIn linkedin.com/in/travistang"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fea370601a8e4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://travis-tang.medium.com/?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": ""}, {"url": "https://travis-tang.medium.com/?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": "Travis Tang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F169b6a57c01e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&user=Travis+Tang&userId=169b6a57c01e&source=post_page-169b6a57c01e----ea370601a8e4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea370601a8e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea370601a8e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://archive.ics.uci.edu/ml/datasets/wine+quality", "anchor_text": "Wine Quality Data Set from UCI"}, {"url": "https://waterhouse.ucdavis.edu/whats-in-wine/fixed-acidity]", "anchor_text": "tartaric, malic, citric or succinic acid,"}, {"url": "https://rstudio-pubs-static.s3.amazonaws.com/57835_c4ace81da9dc45438ad0c286bcbb4224.html", "anchor_text": "which can make wine taste like vinegar"}, {"url": "https://www.randoxfood.com/why-is-testing-for-citric-acid-important-in-winemaking/", "anchor_text": "acid supplement"}, {"url": "https://unsplash.com/@lee_jay_dee?utm_source=medium&utm_medium=referral", "anchor_text": "Lesley Davidson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://winefolly.com/deep-dive/what-is-residual-sugar-in-wine/", "anchor_text": "The amount of sugar left after yeast ferments the wine is called residual sugar."}, {"url": "https://www.terlatowines.com/knowledge/sulfur-dioxide-and-its-role-winemaking", "anchor_text": "only 35\u201340% is yielded in the free form"}, {"url": "https://www.awri.com.au/industry_support/winemaking_resources/fining-stabilities/microbiological/avoidance/sulfur_dioxide/", "anchor_text": "oxidation or microbial spoilage has happened"}, {"url": "http://www.oiv.org/public/medias/2604/oiv-ma-d1-03.pdf", "anchor_text": "different geographic, geologic and climatic conditions"}, {"url": "https://archive.ics.uci.edu/ml/datasets/wine+quality", "anchor_text": "UCI site"}, {"url": "https://github.com/SauceCat/PDPbox", "anchor_text": "PDPBox package"}, {"url": "https://www.linkedin.com/in/voon-hao-tang/", "anchor_text": "Travis Tang | LinkedInData Analyst at Gojek"}, {"url": "https://towardsdatascience.com/interpreting-black-box-ml-models-using-lime-4fa439be9885", "anchor_text": "LIME to explain black box model\u2019s predictions on breast cancer data"}, {"url": "http://www3.dsi.uminho.pt/pcortez", "anchor_text": "http://www3.dsi.uminho.pt/pcortez"}, {"url": "https://medium.com/tag/wine?source=post_page-----ea370601a8e4---------------wine-----------------", "anchor_text": "Wine"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ea370601a8e4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----ea370601a8e4---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/interpretability?source=post_page-----ea370601a8e4---------------interpretability-----------------", "anchor_text": "Interpretability"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ea370601a8e4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea370601a8e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&user=Travis+Tang&userId=169b6a57c01e&source=-----ea370601a8e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea370601a8e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&user=Travis+Tang&userId=169b6a57c01e&source=-----ea370601a8e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea370601a8e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fea370601a8e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ea370601a8e4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ea370601a8e4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ea370601a8e4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ea370601a8e4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ea370601a8e4--------------------------------", "anchor_text": ""}, {"url": "https://travis-tang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://travis-tang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Travis Tang"}, {"url": "https://travis-tang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "http://linkedin.com/in/travistang", "anchor_text": "linkedin.com/in/travistang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F169b6a57c01e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&user=Travis+Tang&userId=169b6a57c01e&source=post_page-169b6a57c01e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F71f383dd749b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-makes-a-wine-good-ea370601a8e4&newsletterV3=169b6a57c01e&newsletterV3Id=71f383dd749b&user=Travis+Tang&userId=169b6a57c01e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}