{"url": "https://towardsdatascience.com/multi-task-learning-in-language-model-for-text-classification-c3acc1fedd89", "time": 1682995564.8153942, "path": "towardsdatascience.com/multi-task-learning-in-language-model-for-text-classification-c3acc1fedd89/", "webpage": {"metadata": {"title": "Multi-Task Learning in Language Model for Text Classification | by Edward Ma | Towards Data Science", "h1": "Multi-Task Learning in Language Model for Text Classification", "description": "Howard and Ruder propose a new method to enable robust transfer learning for any NLP task by using pre-training embedding, LM fine-tuning and classification fine-tuning. The sample 3-layer of LSTM\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "Universal Language Model Fine-tuning for Text Classification", "paragraph_index": 1}, {"url": "https://github.com/fastai/fastai/blob/master/examples/text.ipynb", "anchor_text": "github", "paragraph_index": 14}, {"url": "https://www.linkedin.com/in/edwardma1026", "anchor_text": "LinkedIn", "paragraph_index": 15}, {"url": "http://medium.com/@makcedward/", "anchor_text": "Medium", "paragraph_index": 15}, {"url": "https://github.com/makcedward", "anchor_text": "Github", "paragraph_index": 15}, {"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "Universal Language Model Fine-tuning for Text Classification", "paragraph_index": 16}, {"url": "https://makcedward.github.io/", "anchor_text": "https://makcedward.github.io/", "paragraph_index": 18}], "all_paragraphs": ["Howard and Ruder propose a new method to enable robust transfer learning for any NLP task by using pre-training embedding, LM fine-tuning and classification fine-tuning. The sample 3-layer of LSTM architecture with same hyperparameters except different dropout demonstrate a outperform and robust model for 6 downstream NLPS tasks. They named it as Universal Language Model Fine-tuning (ULMFiT).", "This story will discuss about Universal Language Model Fine-tuning for Text Classification (Howard and Ruder, 2018) and the following are will be covered:", "As mentioned before ULMFiT has 3 stages. The first stage is using general domain data to build a LM pre-training model. Second stage is fine-tuning LM for target data set while third stage is fine-tuning classification for target data set. The Language Model (LM) is Averaged-Stochastic Gradient Descent Weight-Dropped Long-short-term-memory (AWD-LSTM). It does not use transformer but using a regular LSTM with various tuned dropout hyperparameters.", "It is domain-free problem so we can leverage any data to train the model. In other word, data volume can be very very large. For example, it can use whole content of wikipedia or reddit content. The purpose of that is capturing general features to handle different kind of downstream problems. Significant improvement from transfer learning in NLP is demonstrated by lots of previous experiment.", "Having a general purpose vectors, it may not perform well directly on specific problem as it is too generic. Therefore, fine-tuning is a must action. First of all, model will be fine-tuned by Language Model (LM) problem. Theoretically, it will convergence much faster than general-domain LM training because it only needs to learn the characterise of single source of target tasks. Some tricks are used to boost up the performance of ULMFiT. They are discriminative fine-tuning and slanted triangular learning rates. D", "Discriminative fine-tuning is proposed to use different learning rate for different layers. From the experiment, Howard and Ruder found that choosing the learning rate for last layer only. The learning rate of last 2 layer is last layer / 2.6 and using same formula to setup the learning rate for lower layers.", "Slanted triangular learning rates (STLR) is another approach of using dynamic learning rate is increasing linearly at the beginning and decaying it linearly such that it formed a triangle.", "The parameters in this classifier layer are learned from scratch. Since strong signal can exist anywhere but not limited to last word in the sequence, Howard and Ruder proposed to concatenate all layers by max-polling and mean-polling.", "Besides concatenating last hidden state with max-pooling and mean-polling, some tricks are applied in this stage to boost up the performance. Tricks are gradual unfreezing, BPTT for Text Classification (BPT3C) and bidirectional language mode.", "Gradual unfreezing is that all layers except last layer are frozen in the first epoch and only the last layer is fine-tuned. In the next epoch, last frozen layer will be unfrozen and fine-tuning all unfrozen layer. More and more layer will be unfrozen in coming epoch.", "BPTT for Text Classification (BPT3C) enable gradient propagation if the input sequence is large. A large input sequence (let says a document) will be divided into fixed-length batches. The initial hidden state of each batch is final state of the previous batch. As mentioned before, max-pooling and mean-polling are tracked and back-propagated.", "Bidirectional language model is leveraging both forward and backward LM to learn feature from inputs.", "From IMDb, TREC-6 and AG dataset, you can noticed that it gained a great benefit if target dataset is very small.", "Howard and Ruder proposed many tricks to boost up performance. Below figure demonstrated the result of tricks combination.", "fast.ai provides a sample code from github.", "I am Data Scientist in Bay Area. Focusing on state-of-the-art in Data Science, Artificial Intelligence , especially in NLP and platform related. Feel free to connect with me on LinkedIn or following me on Medium or Github.", "J. Howard and S. Ruder. Universal Language Model Fine-tuning for Text Classification. 2018", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Focus in Natural Language Processing, Data Science Platform Architecture. https://makcedward.github.io/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc3acc1fedd89&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@makcedward?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@makcedward?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": "Edward Ma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fba547bff904f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&user=Edward+Ma&userId=ba547bff904f&source=post_page-ba547bff904f----c3acc1fedd89---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3acc1fedd89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3acc1fedd89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jeremythomasphoto?utm_source=medium&utm_medium=referral", "anchor_text": "Jeremy Thomas"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "Universal Language Model Fine-tuning for Text Classification"}, {"url": "https://github.com/fastai/fastai/blob/master/examples/text.ipynb", "anchor_text": "github"}, {"url": "https://www.linkedin.com/in/edwardma1026", "anchor_text": "LinkedIn"}, {"url": "http://medium.com/@makcedward/", "anchor_text": "Medium"}, {"url": "https://github.com/makcedward", "anchor_text": "Github"}, {"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "Universal Language Model Fine-tuning for Text Classification"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c3acc1fedd89---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c3acc1fedd89---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/nlp?source=post_page-----c3acc1fedd89---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----c3acc1fedd89---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c3acc1fedd89---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3acc1fedd89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&user=Edward+Ma&userId=ba547bff904f&source=-----c3acc1fedd89---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3acc1fedd89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&user=Edward+Ma&userId=ba547bff904f&source=-----c3acc1fedd89---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3acc1fedd89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc3acc1fedd89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c3acc1fedd89---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c3acc1fedd89--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@makcedward?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@makcedward?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Edward Ma"}, {"url": "https://medium.com/@makcedward/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.3K Followers"}, {"url": "https://makcedward.github.io/", "anchor_text": "https://makcedward.github.io/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fba547bff904f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&user=Edward+Ma&userId=ba547bff904f&source=post_page-ba547bff904f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fde3db5912a7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-task-learning-in-language-model-for-text-classification-c3acc1fedd89&newsletterV3=ba547bff904f&newsletterV3Id=de3db5912a7c&user=Edward+Ma&userId=ba547bff904f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}