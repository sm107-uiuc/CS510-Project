{"url": "https://towardsdatascience.com/naive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e", "time": 1682993520.254199, "path": "towardsdatascience.com/naive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e/", "webpage": {"metadata": {"title": "Naive-Bayes Tweet Polarity Predictor on Malaysia\u2019s 14th General Election | by Tan Hao Hao | Towards Data Science", "h1": "Naive-Bayes Tweet Polarity Predictor on Malaysia\u2019s 14th General Election", "description": "I thought of this mini-project when I first learnt about Naive Bayes classifier on Udacity. There are tonnes of tutorials online on NB, but I just don\u2019t know why they are mainly doing spam email\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.udacity.com/course/intro-to-machine-learning--ud120", "anchor_text": "this course", "paragraph_index": 5}, {"url": "https://github.com/gudgud96/polarity-prediction-msia-ge14/blob/master/twitter_scraper.py", "anchor_text": "twitter_scraper.py", "paragraph_index": 6}, {"url": "http://www.tweepy.org/", "anchor_text": "tweepy", "paragraph_index": 7}, {"url": "http://textblob.readthedocs.io/en/dev/", "anchor_text": "TextBlob", "paragraph_index": 8}, {"url": "https://mattyford.com/blog/2014/1/23/the-feynman-technique-model", "anchor_text": "Feynmann technique", "paragraph_index": 31}, {"url": "https://github.com/gudgud96/polarity-prediction-msia-ge14/", "anchor_text": "GitHub Repo", "paragraph_index": 32}], "all_paragraphs": ["I thought of this mini-project when I first learnt about Naive Bayes classifier on Udacity. There are tonnes of tutorials online on NB, but I just don\u2019t know why they are mainly doing spam email classification (like, 9 out of 10 of the blogs are writing about NB spam filtering).", "And at that time, my home country Malaysia was welcoming her most important election in the history, so I came up with this idea and say \u2014 why not we do a tweet analysis prior to the election, using NB as a polarity predictor?", "NB is a well-known algorithm in text classification and sentiment analysis due to its simplicity, but the biggest drawback is for NB in NLP context, it is only interested the occurrence of the words, whilst neglecting the correlation between the words (hence the name \u201cnaive\u201d). So by using NB, we could only be looking at our context in a \u201cbag-of-words\u201d point of view, considering occurrence over correlation.", "In simple words, I would like to explain NB as a \u201cforward-backward\u201d process.", "This is why occurrence matters in NB \u2014 the more the occurrence of a word for a certain class, the greater its influence when we are doing the prediction.", "The NB tutorial in this course of Udacity\u2019s gives a short, concise, yet clear cut explanation on NB.", "Firstly, we need to prepare our raw material \u2014 scrape tweets on our own in this case. So I have a twitter_scraper.py script for tweet scraping.", "I use tweepy for the scraping part, so an API key is needed for authorization and setup. In this project, I simply scrape for tweets related to my dearest Prime Minister (oops, sorry, ex-PM now), so the polarity analysis is mainly on our dear ex-PM.", "You will also need a listener to listen to the stream of tweets scraped and decide how you want to handle them. In my case, I get the tweet and pass it to TextBlob for polarity and subjectivity scoring, and write that out to a .csv file.", "Lastly, attach your listener to the stream and leave it there to scrape the tweets for you! Simply halt the process once you have collect enough tweets (in my case I collected only 300 tweets, haha).", "Lesson learnt: The tweets are mainly in Malay, and the polarity scoring just do BADLY. So in the end I decided to manually annotate the class of each tweet myself on the training and testing data \u2014 and that\u2019s why I only scrape 300 tweets.", "I constructed a few things before moving on to the testing part:", "We do a pre-calculation in the dataset and we know that:", "For each word in a tweet, retrieve its frequency from the table and append the prior probabilities, of each word in each class, in a list:", "Take the product of all the prior probabilities (numpy does a good job here by the prod() method). You get 2 probabilities, p0 and p1.", "Multiply pk with P(C=k) and you get the posterior probabilities. Compare them and the higher probability determines the class of the tweet.", "Repeat this process for each tweet, and you are able to predict the polarity of the tweet using the NB classifier!", "I isolated 20 tweets as the test set, and the NB classifier achieved 90% accuracy (18/20 correct).", "Let\u2019s see which 2 tweets did the classifier make a mistake.", "tgok video tu aku tak kesian dkat tun m tp kesian dkat najib. kesian nampak desperito sgt nak jatuhkan tun m.", "Meaning: Watching at the video, I am not pity of Tun Mahathir but I am pity of Najib, seeing him being so desperate to take down Tun Mahathir.", "For us who understand the context, this tweet is quite obvious to belong to class 0, the anti-Najib class, but our classifier does the opposite.", "Let\u2019s see which words decide the class of this tweet in the classifier:", "video + tu + aku + tak + tun + m + najib + nak + tun + m", "Apparently, the term \u201cTun M\u201d should be grouped together and not separated, as separating it may convey different results. Also, the most important word in the tweet for decision should be \u201ckesian\u201d (pity), which we do not see this in the decisioning words.", "For the other tweet that we fail:", "For us, this should belong to the pro-Najib class due to the hashtag of Barisan Nasional, Najib\u2019s political party. However, hashtags are being sanitized in our implementation, so another lesson to learn here on selecting which contents to be sanitized and which not to.", "The word \u201clahanat\u201d (a rude word for damnation) is the main reason why our classifier groups this to the anti-Najib class. However, I shall conclude that this tweet is hard to classify as we have only 2 meaningful words, one representing each class, and we don\u2019t have any additional information.", "Overall, I should say that the NB classifier still did a fairly good job, provided that we have only 300 training tweets that are manually annotated.", "Of course there is a lot of room for improvement \u2014 the first will be to increase the size of training set, but I can\u2019t think of any other ways available in the field to automate the annotation process for now.", "It is quite shocking to see that the majority of the tweets are being anti-Najib prior to the election. We have always think undoubtedly that the Malay community will still be supportive to Najib and Barisan Nasional, but it turns out that the Malay netizens on Twitter tell us a different story.", "I would say that this is a fun and easy mini-project for me to work and learn, and it is very relevant to me and my home country. Also, writing this post help to clarify the concepts of NB I have learnt, and force me to convey them in simple words, as advised in the Feynmann technique. So, let\u2019s hope for more to come!", "Interested in the code? Check out via my GitHub Repo.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Music enthusiast, seeking music tech solutions with AI / ML."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3a3679094b5e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@helloharry66?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@helloharry66?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": "Tan Hao Hao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2688ae6ed5f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=post_page-2688ae6ed5f4----3a3679094b5e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a3679094b5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a3679094b5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.udacity.com/course/intro-to-machine-learning--ud120", "anchor_text": "this course"}, {"url": "https://github.com/gudgud96/polarity-prediction-msia-ge14/blob/master/twitter_scraper.py", "anchor_text": "twitter_scraper.py"}, {"url": "http://www.tweepy.org/", "anchor_text": "tweepy"}, {"url": "http://textblob.readthedocs.io/en/dev/", "anchor_text": "TextBlob"}, {"url": "https://mattyford.com/blog/2014/1/23/the-feynman-technique-model", "anchor_text": "Feynmann technique"}, {"url": "https://github.com/gudgud96/polarity-prediction-msia-ge14/", "anchor_text": "GitHub Repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3a3679094b5e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/naive-bayes?source=post_page-----3a3679094b5e---------------naive_bayes-----------------", "anchor_text": "Naive Bayes"}, {"url": "https://medium.com/tag/technology?source=post_page-----3a3679094b5e---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/malaysia?source=post_page-----3a3679094b5e---------------malaysia-----------------", "anchor_text": "Malaysia"}, {"url": "https://medium.com/tag/general-election?source=post_page-----3a3679094b5e---------------general_election-----------------", "anchor_text": "General Election"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3a3679094b5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=-----3a3679094b5e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3a3679094b5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=-----3a3679094b5e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a3679094b5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3a3679094b5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3a3679094b5e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3a3679094b5e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3a3679094b5e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3a3679094b5e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3a3679094b5e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@helloharry66?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@helloharry66?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tan Hao Hao"}, {"url": "https://medium.com/@helloharry66/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2688ae6ed5f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=post_page-2688ae6ed5f4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4773228b6731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-tweet-polarity-predictor-on-malaysias-14th-general-election-3a3679094b5e&newsletterV3=2688ae6ed5f4&newsletterV3Id=4773228b6731&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}