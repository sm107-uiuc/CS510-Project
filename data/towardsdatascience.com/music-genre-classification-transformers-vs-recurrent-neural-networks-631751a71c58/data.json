{"url": "https://towardsdatascience.com/music-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58", "time": 1683009220.60665, "path": "towardsdatascience.com/music-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58/", "webpage": {"metadata": {"title": "Music Genre Classification: Transformers vs Recurrent Neural Networks | by Youness Mansar | Towards Data Science", "h1": "Music Genre Classification: Transformers vs Recurrent Neural Networks", "description": "The objective of this post is to implement a music genre classification model by comparing two popular architectures for sequence modeling: Recurrent Neural networks and Transformers. RNNs are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1706.03762.pdf", "anchor_text": "https://arxiv.org/pdf/1706.03762.pdf", "paragraph_index": 2}, {"url": "https://arxiv.org/pdf/1810.04805", "anchor_text": "https://arxiv.org/pdf/1810.04805", "paragraph_index": 2}, {"url": "https://github.com/mdeff/fma/", "anchor_text": "https://github.com/mdeff/fma/", "paragraph_index": 3}], "all_paragraphs": ["The objective of this post is to implement a music genre classification model by comparing two popular architectures for sequence modeling: Recurrent Neural networks and Transformers.", "RNNs are popular for all sorts of 1D sequence processing tasks, they re-use the same weights at each time step and pass information from a time-step to the next by keeping an internal state and using a gating mechanism (LSTM, GRUs \u2026 ). Since they use recurrence, those models can suffer from vanishing/exploding gradients which can make training and learning long-range patterns harder.", "Transformers are a relatively newer architecture that can process sequences without using any recurrence or convolution [https://arxiv.org/pdf/1706.03762.pdf]. The transformer layer is mostly point-wise feed-forward operations and self-attention. These types of networks are having some great success in natural language processing, especially when pre-trained on a large amount of unlabeled data [https://arxiv.org/pdf/1810.04805].", "We will use the Free Music Archive Dataset https://github.com/mdeff/fma/ and more specifically the large version with 106,574 tracks of 30s, 161 unbalanced genres, which sums to a total of 93 Gb of music data. Each track is labeled with a set of genres that best describe it.", "Our target in this project is to predict those tags. Since a song can be attached to more than one tag it can be formulated as a multi-label classification problem with 163 targets, one for each class.", "Some classes are very frequent like Electronic music for example where exists for 22% of the data but some other classes appear very few times like Salsa where it contributes by 0.01% of the dataset. This creates an extreme imbalance in the training and evaluation, which leads us to use the micro-average area under the precision-recall curve as our metric.", "We use Mel-Spectrograms as input to our networks since its a denser representation of the audio input and it fits the transformer architecture better since it turns the raw audio-waves into a sequence of vectors.", "Each 128-D vector on the Time axis is considered an element of the input sequence.", "Loading the audio file and sub-sampling it to 16kHz and then computing the Mel-spectrograms can take a significant amount of time, so we pre-compute and save them on disk as a .npy file using NumPy.save.", "I choose the hyper-parameters so that both the RNNs and Transformers have a similar number of trainable parameters.", "The only difference between the two models is the encoder part being either a transformer or bi-directional GRU. The two models have 700k trainable parameters.", "We will evaluate each genre using the area under the precision-recall curve and then micro-average across classes.", "We can see that the transformer works a little better than GRU. We can improve the performance by doing some Test-Time augmentation and averaging the prediction of multiple crops of the input sequence.", "The results overall seem a little weak, it is probably due to the great number of classes that make the task harder or maybe due to the class imbalance. One possible improvement is to ditch the multi-label approach and work on a ranking approach, since its less sensitive to class imbalance and the big number of classes.", "In this post, we compared two popular architectures for sequence modeling RNNs and Transformers. We saw that transformers slightly over-performs GRUs which shows that Transformers can be a viable option to test even outside Natural Language Processing.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F631751a71c58&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----631751a71c58--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----631751a71c58--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@CVxTz?source=post_page-----631751a71c58--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@CVxTz?source=post_page-----631751a71c58--------------------------------", "anchor_text": "Youness Mansar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F830ca2245343&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&user=Youness+Mansar&userId=830ca2245343&source=post_page-830ca2245343----631751a71c58---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F631751a71c58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F631751a71c58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Recurrent_neural_network", "anchor_text": "Source: https://en.wikipedia.org/wiki/Recurrent_neural_network"}, {"url": "https://commons.wikimedia.org/wiki/User:Ixnay", "anchor_text": "fdeloche"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0", "anchor_text": "CC BY-SA 4.0"}, {"url": "https://arxiv.org/pdf/1706.03762.pdf", "anchor_text": "https://arxiv.org/pdf/1706.03762.pdf"}, {"url": "https://arxiv.org/pdf/1810.04805", "anchor_text": "https://arxiv.org/pdf/1810.04805"}, {"url": "https://github.com/mdeff/fma/", "anchor_text": "https://github.com/mdeff/fma/"}, {"url": "https://freemusicarchive.org/music/Jahzzar/Travellers_Guide/Siesta", "anchor_text": "Siesta by Jahzzar"}, {"url": "https://freemusicarchive.org/music/Jahzzar/Travellers_Guide/Siesta", "anchor_text": "Wise Guy by Yung Kartz"}, {"url": "https://github.com/tensorflow/docs/blob/master/site/en/tutorials/text/transformer.ipynb", "anchor_text": "https://github.com/tensorflow/docs/blob/master/site/en/tutorials/text/transformer.ipynb"}, {"url": "https://github.com/CVxTz/music_genre_classification", "anchor_text": "https://github.com/CVxTz/music_genre_classification"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----631751a71c58---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----631751a71c58---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/transformers?source=post_page-----631751a71c58---------------transformers-----------------", "anchor_text": "Transformers"}, {"url": "https://medium.com/tag/keras?source=post_page-----631751a71c58---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F631751a71c58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&user=Youness+Mansar&userId=830ca2245343&source=-----631751a71c58---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F631751a71c58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&user=Youness+Mansar&userId=830ca2245343&source=-----631751a71c58---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F631751a71c58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----631751a71c58--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F631751a71c58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----631751a71c58---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----631751a71c58--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----631751a71c58--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----631751a71c58--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----631751a71c58--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----631751a71c58--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----631751a71c58--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----631751a71c58--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----631751a71c58--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@CVxTz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@CVxTz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Youness Mansar"}, {"url": "https://medium.com/@CVxTz/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "425 Followers"}, {"url": "https://www.linkedin.com/in/mansar/", "anchor_text": "https://www.linkedin.com/in/mansar/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F830ca2245343&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&user=Youness+Mansar&userId=830ca2245343&source=post_page-830ca2245343--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7e379bdcb386&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-genre-classification-transformers-vs-recurrent-neural-networks-631751a71c58&newsletterV3=830ca2245343&newsletterV3Id=7e379bdcb386&user=Youness+Mansar&userId=830ca2245343&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}