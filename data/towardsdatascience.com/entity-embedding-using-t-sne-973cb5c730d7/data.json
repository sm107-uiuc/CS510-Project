{"url": "https://towardsdatascience.com/entity-embedding-using-t-sne-973cb5c730d7", "time": 1682997465.246304, "path": "towardsdatascience.com/entity-embedding-using-t-sne-973cb5c730d7/", "webpage": {"metadata": {"title": "Entity embedding using t-SNE. The well known dimensionality reduction\u2026 | by Michael Larionov, PhD | Towards Data Science", "h1": "Entity embedding using t-SNE", "description": "We have been discussing some of the possible ways to embed categorical features: Kernel PCA and Spectral Encoding. The goal of such embedding is to map categorical features to vectors in a low\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/entity-embedding-using-pca-and-kernel-pca-798b8b2e8c2f", "anchor_text": "Kernel PCA", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/spectral-encoding-of-categorical-features-b4faebdf4a", "anchor_text": "Spectral Encoding", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "t-distributed stochastic neighbor embedding", "paragraph_index": 1}, {"url": "https://github.com/mlarionov/machine_learning_POC/blob/master/spectral-analysis/t-SNE.ipynb", "anchor_text": "my github repository", "paragraph_index": 12}], "all_paragraphs": ["We have been discussing some of the possible ways to embed categorical features: Kernel PCA and Spectral Encoding. The goal of such embedding is to map categorical features to vectors in a low dimensional space. The advantage is this mapping dramatically reduce overfitting, compared to 1-hot encoding. However we can lose information and make the learning more difficult if the embedding is chosen incorrectly. In order to increase the quality of embedding, we use the category similarity information (that we can set a priori or by computing the similarity of conditional probability distribution). Kernel PCA method is also using the probability distribution of the categorical variable, whereas the Spectral Encoding does not. For completeness, we will also use t-SNE method and we can discuss its advantages and disadvantages.", "t-SNE stands for t-distributed stochastic neighbor embedding, and was originally proposed for visualization of high-dimensional data. As opposed to PCA, it is a non-linear method, and its goal is to preserve similarity between the data points. It introduces a non-linear transformation from the original data x to a low-dimensional vectors y, and it models the similarity between data points using Student t-Distribution:", "The set of points y is found by minimizing KL divergence of the distribution Q from the original distribution P:", "The minimization can be done using Gradient Descent.", "To demonstrate how the method works we will use synthetic data set with only one categorical variable Day of Week, with 0 being Monday and 6 being Sunday:", "Here we deliberately added more data for Saturday and Sunday to see how t-SNE will take into account the probability distribution of the original data. To remind you, Laplacian method is not influenced by the the source data probability distribution, whereas PCA and kernel PCA are.", "The Kernel function is the same as in the previous examples", "Scikit-learn implementation of t-SNE actually wants me to provide metric function instead, so we transform our kernel matrix back to distance matrix", "Sigma here is an important hyperparameter that needs to be tuned. Another important hyperparameter of the t-SNE method is perplexity score, but in our case it can be either left to default or set to sigma.", "In this first example we used t-SNE without a kernel, meaning that the distance between all days of the week is 1. This is what you would get by just using 1-hot encoding. Note, that the embeddings seem to be spread randomly, and this is a difference from PCA, which even in the absence of the kernel uses the initial data probability distribution to embed the data in such a way, that would maximize their linear separability. Let\u2019s see what results we get if we use kernel function:", "Here results are more meaningful. Monday through Thursday are grouped together to preserve their similarity. Friday, Saturday and Sunday are far apart from each other and from the other days. It is interesting to see that Friday is closer to Sunday than Saturday.", "t-SNE is one of the options for category embedding. Generally, t-SNE does not generalize (because it will not be able to map unknown data), but for categorical features it does not matter, because the new data will have one of the existing categories. A bigger problem is that it will not work without a kernel, as opposed to PCA which will give reasonable results even if kernel is not given. Just like Kernel PCA, it is using probability distribution to map the data, even though in a different way. If Kernel PCA is trying to achieve smoothness in the resulting vector space, t-SNE cares more about preserving similarity. This will probably guide your decision which method is more appropriate for your model.", "You can find the code for this story in my github repository.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F973cb5c730d7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@michaellarionov", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://michaellarionov.medium.com/?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": ""}, {"url": "https://michaellarionov.medium.com/?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": "Michael Larionov, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff9158ca11a43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=post_page-f9158ca11a43----973cb5c730d7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F973cb5c730d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F973cb5c730d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@leonkoye?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Leon Koye"}, {"url": "https://unsplash.com/search/photos/dimension?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/entity-embedding-using-pca-and-kernel-pca-798b8b2e8c2f", "anchor_text": "Kernel PCA"}, {"url": "https://towardsdatascience.com/spectral-encoding-of-categorical-features-b4faebdf4a", "anchor_text": "Spectral Encoding"}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "t-distributed stochastic neighbor embedding"}, {"url": "https://github.com/mlarionov/machine_learning_POC/blob/master/spectral-analysis/t-SNE.ipynb", "anchor_text": "my github repository"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----973cb5c730d7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----973cb5c730d7---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/tag/categorical-data?source=post_page-----973cb5c730d7---------------categorical_data-----------------", "anchor_text": "Categorical Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----973cb5c730d7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----973cb5c730d7---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F973cb5c730d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=-----973cb5c730d7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F973cb5c730d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=-----973cb5c730d7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F973cb5c730d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F973cb5c730d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----973cb5c730d7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----973cb5c730d7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----973cb5c730d7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----973cb5c730d7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----973cb5c730d7--------------------------------", "anchor_text": ""}, {"url": "https://michaellarionov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://michaellarionov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Larionov, PhD"}, {"url": "https://michaellarionov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "611 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff9158ca11a43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=post_page-f9158ca11a43--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcf000f0c5fdd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fentity-embedding-using-t-sne-973cb5c730d7&newsletterV3=f9158ca11a43&newsletterV3Id=cf000f0c5fdd&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}