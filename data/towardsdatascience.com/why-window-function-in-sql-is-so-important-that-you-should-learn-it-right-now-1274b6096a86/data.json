{"url": "https://towardsdatascience.com/why-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86", "time": 1683001082.337077, "path": "towardsdatascience.com/why-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86/", "webpage": {"metadata": {"title": "Why window function in SQL is so important that you should learn it right now | by WY Fok | Towards Data Science", "h1": "Why window function in SQL is so important that you should learn it right now", "description": "In my last article, I mentioned that I was asked about how to use a window function many times. And after mastering it, I am sure that I should learn much earlier because it can help me carry out\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In my last article, I mentioned that I was asked about how to use a window function many times. And after mastering it, I am sure that I should learn much earlier because it can help me carry out more in-depth analysis through SQL.", "My last article about using SQL for data analysis", "Not like group by function which will reduce the number of rows, window function can perform the aggregation for each row without reducing. There are a number of different window functions. But today I will tell you basic knowledge on how to use window function and how you can apply in your data analysis.", "The dataset that I will use today is \u201cstudent-mat\u201d from \u201cStudent Alcohol Consumption\u201d obtained from Kaggle. Then the dataset is stored in dataset.student_mat. You can download the dataset from the below link:", "In general, there are two types of window functions; one is built-in function like row_number, dense_rank, lag, and lead; another is aggregation just like usual aggregation function. For window function, there is a significant keyword \u201cover\u201d . Once you notice \u201cover\u201d within a query, you can tell there is a window function.", "In the first part, I will explain how to use the aggregate window function since I believe you already have some knowledge of using normal aggregation function. After knowing the basics of window function it is easier to understand built-in functions.", "The basic syntax for an aggregate window function is a normal aggregation function but following an over clause statement. Here I will use the data to demonstrate. The first three columns in the dataset are school, sex, and age. And now you want to know the age difference for each sex versus overall in each school. Then you can use the window function.", "The first step is to calculate the average age per school. This can be obtained from \u2018avg(age) over (partition by school)\u2019 . The first part before over is the same as the normal average function. The second part after over is called \u201cpartition by\u201d clause which is required to be enclosed by parentheses. \u201cPartition by school\u201d means all records with the same values in school are selected and carry the calculation.", "16.5215 for school equal to \u201cGP\u201d and 18.0217 for school equal to MS match with normal average function group by the school.", "So now you can calculate the difference between each student and the average, as what age_diff_from_shl_avg performs in the query.", "Finally, you can get the average age difference by school and sex.", "From now you can tell the age for females is higher than males in GP but not in MS.", "There is another column address showing whether the student lives in urban or rural areas. Then you can use a window function to calculate the percentage of students living in each area by school and area.", "The first step is to calculate the number of students in each combination of school and address as a usual group by aggregation. Then to calculate the number of students over the total number of students in each school and in each address area by using window functions. \u201csum(student_cnt) over (partition by school)\u201d will return the total numbers of students for GP and MS while \u201cstudent_cnt / sum(student_cnt) over (partition by address)\u201d will return the total numbers of students for urban and rural areas. As a result, you can get the percentage of students by school and address area.", "So you can tell there are more students in GP living in an urban area while there are more students in MS living in a rural area. And if you find a student living in urban area, you are almost certain that this student is from GP since over 93% of urban students study in GP. This already becomes a predictive analysis that you can use to classify the school for the student by its address only.", "The third example of the aggregation window function is a bit more complex. Since the dataset is called \u201cStudent Alcohol Consumption\u201d, of course, we should do some analyses on it. There are two categorical columns \u201cDalc\u201d and \u201cWalc\u201d showing consumption on workday and weekend. Then we can find out if alcohol consumption will impact the final result indicated by column \u201cg3\u201d.", "To simplify, I will just add up two columns together rather than separating them. Then to calculate the overall average of g3 and also the difference between individual g3 and the overall average of g3. To calculate the overall average of g3, here we cannot use group by function since this will reduce the number of rows. Instead, we use the window function to obtain and put the result on each row.", "The second part after over for syntax \u201cavg(g3) over ()\u201d is empty because we don\u2019t need to categorize the dataset. We need the whole dataset to calculate the overall average. Therefore the parentheses are empty inside.", "Now you can calculate the average difference for each wkalc group.", "There is no clear relationship between alcohol consumption and g3 results. So let\u2019s drink (?)", "Now I hope you know basic usage on aggregation window function. Next, I will talk about the built-in window function. Below is the list for 11 built-in window functions :", "I will not explain all in detail. You can get the detailed information from the below link:", "I will use rank() as an example to demonstrate how to use it.", "Similar to the aggregation window function, an over clause statement is required.", "There is a categorical column \u201cstudytime\u201d from 1 to 4. And we want to know if study time is a factor of g3. Apart from calculating the average of g3 by studytime, we can use rank() to get the order.", "After getting the average of g3 for each studytime, we can use the average result to rank the order by descending order. Then we can order the ranking to get the comparison directly. This method is useful especially when there are many groups that it is not possible to get ranking by naked eyes.", "So it is still true the studying more will get better results.", "PS: There are other two built-in functions which also provide a ranking, one is dense_rank(), another is row_number(). The difference is how they return ranks when there are rows with the same values. You can know more from the below link:", "Mastering window functions provides you much more in-depth data analysis and sometimes it can even help you perform predictive analytics. As I said in my last article, mastering SQL is necessary for landing a data analyst position and window function is constantly asked during an interview (I can\u2019t remember how many times I was asked about it during interviews). Therefore you should also start learning window functions after reading my article. I hope you can master it as well and get your dream job. That\u2019s all for today\u2019s article. If you enjoy it, please leave your comment and give me a clap. And share this article to let more people know the importance of window function. See you next time.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Amazonian. Former data science intern in Amazon Germany. Bachelor in Statistics and Master in Operation Research. Love working with number. Python / SQL / SAS"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1274b6096a86&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1274b6096a86--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1274b6096a86--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wyfok?source=post_page-----1274b6096a86--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wyfok?source=post_page-----1274b6096a86--------------------------------", "anchor_text": "WY Fok"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5aaad731c036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&user=WY+Fok&userId=5aaad731c036&source=post_page-5aaad731c036----1274b6096a86---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1274b6096a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1274b6096a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/how-to-use-sql-to-perform-data-analysis-house-property-sales-time-series-bf36cd3c2528", "anchor_text": "How to use SQL to perform data analysis (House Property Sales Time Series)Back to basic and use SQL to get all necessary information from a datasettowardsdatascience.com"}, {"url": "https://www.kaggle.com/uciml/student-alcohol-consumption", "anchor_text": "Student Alcohol ConsumptionDownload Open Datasets on 1000s of Projects + Share Projects on One Platform. Explore Popular Topics Like Government\u2026www.kaggle.com"}, {"url": "https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html", "anchor_text": "MySQL :: MySQL 8.0 Reference Manual :: 12.21.1 Window Function DescriptionsIn the following function descriptions, over_clause represents the OVER clause, described in Section 12.21.2, \"Window\u2026dev.mysql.com"}, {"url": "https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html#function_rank", "anchor_text": "https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html#function_rank"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1274b6096a86---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/sql?source=post_page-----1274b6096a86---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----1274b6096a86---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/tag/programming?source=post_page-----1274b6096a86---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/interview-tips?source=post_page-----1274b6096a86---------------interview_tips-----------------", "anchor_text": "Interview Tips"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1274b6096a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&user=WY+Fok&userId=5aaad731c036&source=-----1274b6096a86---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1274b6096a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&user=WY+Fok&userId=5aaad731c036&source=-----1274b6096a86---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1274b6096a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1274b6096a86--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1274b6096a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1274b6096a86---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1274b6096a86--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1274b6096a86--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1274b6096a86--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1274b6096a86--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1274b6096a86--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1274b6096a86--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1274b6096a86--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1274b6096a86--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wyfok?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wyfok?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "WY Fok"}, {"url": "https://medium.com/@wyfok/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "602 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5aaad731c036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&user=WY+Fok&userId=5aaad731c036&source=post_page-5aaad731c036--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4e5aff4d78e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86&newsletterV3=5aaad731c036&newsletterV3Id=4e5aff4d78e0&user=WY+Fok&userId=5aaad731c036&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}