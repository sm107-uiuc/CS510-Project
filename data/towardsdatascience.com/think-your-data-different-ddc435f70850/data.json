{"url": "https://towardsdatascience.com/think-your-data-different-ddc435f70850", "time": 1682994740.171273, "path": "towardsdatascience.com/think-your-data-different-ddc435f70850/", "webpage": {"metadata": {"title": "Think your Data Different. Learn how node2vec works, and what kind\u2026 | by Yoel Zeldes | Towards Data Science", "h1": "Think your Data Different", "description": "Learn how node2vec works, and what kind of information it captures that word2vec doesn\u2019t \u2014 includes case study"}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/tutorials/representation/word2vec", "anchor_text": "word2vec", "paragraph_index": 6}, {"url": "https://snap.stanford.edu/node2vec/", "anchor_text": "node2vec", "paragraph_index": 9}, {"url": "https://arxiv.org/abs/1607.00653", "anchor_text": "original paper", "paragraph_index": 9}, {"url": "https://github.com/taboola/node2vec-example", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-means", "paragraph_index": 16}, {"url": "https://arxiv.org/abs/cond-mat/0308217", "anchor_text": "Girvan-Newman algorithm", "paragraph_index": 18}, {"url": "https://engineering.taboola.com/think-data-different", "anchor_text": "engineering.taboola.com", "paragraph_index": 28}, {"url": "https://medium.com/u/b21a5bf8ed44?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "Zohar Komarovsky", "paragraph_index": 28}], "all_paragraphs": ["In the last couple of years deep learning (DL) has become a main enabler for applications in many domains such as vision, NLP, audio, click stream data etc. Recently researchers started to successfully apply deep learning methods to graph datasets in domains like social networks, recommender systems and biology, where data is inherently structured in a graphical way.", "So how do Graph Neural Networks work? Why do we need them?", "In machine learning tasks involving graphical data, we usually want to describe each node in the graph in a way that allows us to feed it into some machine learning algorithm. Without DL, one would have to manually extract features, such as the number of neighbors a node has. But this is a laborious job.", "This is where DL shines. It automatically exploits the structure of the graph in order to extract features for each node. These features are called embeddings.", "The interesting thing is, that even if you have absolutely no information about the nodes, you can still use DL to extract embeddings. The structure of the graph, that is \u2014 the connectivity patterns, hold viable information.", "So how can we use the structure to extract information? Can the context of each node within the graph really help us?", "One well known algorithm that extracts information about entities using context alone is word2vec. The input to word2vec is a set of sentences, and the output is an embedding for each word. Similarly to the way text describes the context of each word via the words surrounding it, graphs describe the context of each node via neighbor nodes.", "While in text words appear in linear order, in graphs it\u2019s not the case. There\u2019s no natural order between neighbor nodes. So we can\u2019t use word2vec\u2026 Or can we?", "We can apply reduction from the graphical structure of our data into a linear structure such that the information encoded in the graphical structure isn\u2019t lost. Doing so, we\u2019ll be able to use good old word2vec.", "The key point is to perform random walks in the graph. Each walk starts at a random node, and performs a series of steps, where each step goes to a random neighbor. Each random walk forms a sentence that can be fed into word2vec. This algorithm is called node2vec. There are more details in the process, which you can read about in the original paper.", "Taboola\u2019s content recommender system gathers lots of data, some of which can be represented in a graphical manner. Let\u2019s inspect one type of data as a case study for using node2vec.", "Taboola recommends articles in a widget shown in publishers\u2019 websites:", "Each article has named entities \u2014 the entities described by the title. For example, the item \u201cthe cutest dogs on the planet\u201d contains the entities \u201cdog\u201d and \u201cplanet\u201d. Each named entity can appear in many different items.", "We can describe this relationship using a graph in the following way: each node will be a named entity, and there will be an edge between two nodes if the two named entities appear in the same item:", "Now that we are able to describe our data in a graphical manner, let\u2019s run node2vec to see what insights we can learn out of the data. You can find the working code here.", "After learning node embeddings, we can use them as features for a downstream task, e.g. CTR (Click Through Rate) prediction. Although it could benefit the model, it\u2019ll be hard to understand the qualities learned by node2vec.", "Another option would be to cluster similar embeddings together using K-means, and color the nodes according to their associated cluster:", "Cool! The clusters captured by node2vec seem to be homogeneous. In other words, nodes that are close to each other in the graph are also close to each other in the embedding space. Take for instance the orange cluster \u2014 all of its named entities are related to basketball.", "You might wonder what is the benefit of using node2vec over classical graphical algorithms, such as community detection algorithms (e.g., the Girvan-Newman algorithm). Capturing the community each node belongs to can definitely be done using such algorithms, there\u2019s nothing wrong with it. Actually, that\u2019s exactly feature engineering. And we already know that DL can save you the time of carefully handcrafting such features. So why not enjoy this benefit? We should also keep in mind that node2vec learns high dimensional embeddings. These embeddings are much richer than merely community belonging.", "Using node2vec in this use case might not be the first idea that comes to mind. One might suggest to simply use word2vec, where each sentence is the sequence of named entities inside a single item. In this approach we don\u2019t treat the data as having a graphical structure. So what\u2019s the difference between this approach \u2014 which is valid, and node2vec?", "If we think about it, each sentence we generate in the word2vec approach is a walk in the graph we\u2019ve defined earlier. node2vec also defines walks on the same graph. So they are the same, right? Let\u2019s have a look at the clusters we get by the word2vec approach:", "Now the \u201cbasketball\u201d cluster is less homogenous \u2014 it contains both orange and blue nodes. The named entity \u201cBasketball\u201d for example was colored orange, while the basketball players \u201cLebron James\u201d and \u201cKobe Bryant\u201d were colored blue!", "In this approach each walk in the graph is composed only of named entities that appear together in a single item. It means we are limited to walks that don\u2019t go further than distance 1 from the starting node. In node2vec, we don\u2019t have that limit. Since each approach uses a different kind of walks, the learned embeddings capture a different kind of information.", "To make it more concrete, consider the following example: say we have two items \u2014 one with named entities A, B, C and another with D, B, E. These items induce the following graph:", "In the simple word2vec approach we\u2019ll generate the following sentences: [A, B, C] and [D, B, E]. In the node2vec approach we could also get sentences like [A, B, E]. If we fetch the latter into the training process, we\u2019ll learn that E and C are interchangeable: the prefix [A, B] will be able to predict both C and E. Therefore, C and E will get similar embeddings, and will be clustered together.", "Using the right data structure to represent your data is important. Each data structure implies a different learning algorithm, or in other words \u2014 introduces a different inductive bias.", "Identifying your data has a certain structure, so you can use the right tool for the job, might be challenging.", "Since so many real world datasets are naturally represented as graphs, we think Graph Neural Networks are a must-have in our tool box as data scientists.", "Originally published at engineering.taboola.com by me and Zohar Komarovsky.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fddc435f70850&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ddc435f70850--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yoelzeldes.medium.com/?source=post_page-----ddc435f70850--------------------------------", "anchor_text": ""}, {"url": "https://yoelzeldes.medium.com/?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "Yoel Zeldes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa609ddb637b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&user=Yoel+Zeldes&userId=a609ddb637b2&source=post_page-a609ddb637b2----ddc435f70850---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fddc435f70850&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fddc435f70850&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.tensorflow.org/tutorials/representation/word2vec", "anchor_text": "word2vec"}, {"url": "https://snap.stanford.edu/node2vec/", "anchor_text": "node2vec"}, {"url": "https://arxiv.org/abs/1607.00653", "anchor_text": "original paper"}, {"url": "https://github.com/taboola/node2vec-example", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-means"}, {"url": "https://arxiv.org/abs/cond-mat/0308217", "anchor_text": "Girvan-Newman algorithm"}, {"url": "https://engineering.taboola.com/think-data-different", "anchor_text": "engineering.taboola.com"}, {"url": "https://medium.com/u/b21a5bf8ed44?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "Zohar Komarovsky"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ddc435f70850---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ddc435f70850---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ddc435f70850---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----ddc435f70850---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ddc435f70850---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fddc435f70850&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&user=Yoel+Zeldes&userId=a609ddb637b2&source=-----ddc435f70850---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fddc435f70850&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&user=Yoel+Zeldes&userId=a609ddb637b2&source=-----ddc435f70850---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fddc435f70850&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fddc435f70850&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ddc435f70850---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ddc435f70850--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ddc435f70850--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ddc435f70850--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ddc435f70850--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ddc435f70850--------------------------------", "anchor_text": ""}, {"url": "https://yoelzeldes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yoelzeldes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yoel Zeldes"}, {"url": "https://yoelzeldes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "816 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa609ddb637b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&user=Yoel+Zeldes&userId=a609ddb637b2&source=post_page-a609ddb637b2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffd4674272ff5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthink-your-data-different-ddc435f70850&newsletterV3=a609ddb637b2&newsletterV3Id=fd4674272ff5&user=Yoel+Zeldes&userId=a609ddb637b2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}